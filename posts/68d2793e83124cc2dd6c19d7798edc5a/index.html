<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>最全的OLE操作Excel的完整代码（2） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="最全的OLE操作Excel的完整代码（2）" />
<meta property="og:description" content="/*------------------------------------------------- //目前真正最全的OLE操作Excel的完整代码 //版本：2007.01.15.01 //C&#43;&#43;Builder专家组www.3322ee.com原创文章 //转载请保留本版权信息，谢谢合作 --------------------------------------------------/ //打印设定： //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintTitleRows&#34;,&#34;$2:$2&#34;);//打印标题列 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintTitleColumns&#34;,&#34;$A:$A&#34;);//打印标题栏 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintArea&#34;,&#34;$A$1:$I$15&#34;);//打印范围 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintHeadings&#34;,false);//栏名列号 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintGridlines&#34;,false);//打印网格线 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintComments&#34;,xlPrintNoComments);//批注&#34;无&#34; //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PrintQuality&#34;,300);//打印品质 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;CenterHorizontally&#34;,true);//水平置中 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;CenterVertically&#34;,false);//垂直置中 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;Orientation&#34;,xlLandscape);//横向打印 (xlPortrait 纵向打印) //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;Draft&#34;,false);//草稿品质 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;PaperSize&#34;,xlPaperA4);//纸张大小 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;FirstPageNumber&#34;,xlAutomatic);//起始页码 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;Order&#34;,xlDownThenOver);//循栏打印 (xlOverThenDown 循列打印) //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;BlackAndWhite&#34;,False);//储存格单色打印 //sh.OlePropertyGet(&#34;PageSetup&#34;).OlePropertySet(&#34;Zoom&#34;,100);//缩放比例
//设定单元格背景色： //sh.OlePropertyGet(&#34;Cells&#34;,2,2).OlePropertyGet(&#34;Interior&#34;).OlePropertySet(&#34;ColorIndex&#34;,3);//设定指定单元格的背景色
//设定图样：xlGray50可以是1，2，3等数字 //sh.OlePropertyGet(&#34;Cells&#34;,4,2).OlePropertyGet(&#34;Interior&#34;).OlePropertySet(&#34;Pattern&#34;,xlGray50); //sh.OlePropertyGet(&#34;Range&#34;,&#34;A1:C10&#34;).OlePropertyGet(&#34;Interior&#34;).OlePropertySet(&#34;Pattern&#34;,xlGray50);//在指定区域设置图样
//设置单元格中的文字距左： //sh.OlePropertyGet(&#34;Cells&#34;,1,1).OlePropertySet(&#34;HorizontalAlignment&#34;,xlLeft);//设置单元格中的文字距左 //sh.OlePropertyGet(&#34;Cells&#34;,1,1).OlePropertySet(&#34;VerticalAlignment&#34;,xlCenter);//作用不明(垂直和水平居中?) //设置单元格中的文字距中： sh.OlePropertyGet(&#34;Cells&#34;,1,1).OlePropertySet(&#34;HorizontalAlignment&#34;,xlCenter);//设置单元格中的文字距中 //sh.OlePropertyGet(&#34;Cells&#34;,1,1).OlePropertySet(&#34;VerticalAlignment&#34;,xlCenter);//作用不明 //设置单元格中的文字距右： //sh.OlePropertyGet(&#34;Cells&#34;,1,1).OlePropertySet(&#34;HorizontalAlignment&#34;,xlRight);//设置单元格中的文字距右 //sh.OlePropertyGet(&#34;Cells&#34;,1,1).OlePropertySet(&#34;VerticalAlignment&#34;,xlCenter);//作用不明 /*------------------------------------------------- //目前真正最全的OLE操作Excel的完整代码 //版本：2007.01.15.01 //C&#43;&#43;Builder专家组www.3322ee.com原创文章 //转载请保留本版权信息，谢谢合作 --------------------------------------------------/ //工作表操作： //sh.OlePropertySet(&#34;Name&#34;, &#34;Sheet的新名字&#34;);//重命名当前工作表 //sh.OleFunction(&#34;Delete&#34;);//删除当前工作表
//画单元格单条边框： //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeLeft).OlePropertySet(&#34;Weight&#34;,xlThin);//画单元格左边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeLeft).OlePropertySet(&#34;LineStyle&#34;,xlContinuous);//画单元格左边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeRight).OlePropertySet(&#34;Weight&#34;,xlThin);//画单元格右边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeRight).OlePropertySet(&#34;LineStyle&#34;,xlContinuous);//画单元格右边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeTop).OlePropertySet(&#34;Weight&#34;,xlThin);//画单元格上边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeTop).OlePropertySet(&#34;LineStyle&#34;,xlContinuous);//画单元格上边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeBottom).OlePropertySet(&#34;Weight&#34;,xlThin);//画单元格下边框 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlEdgeBottom).OlePropertySet(&#34;LineStyle&#34;,xlContinuous);//画单元格下边框 //sh.OlePropertyGet(&#34;Range&#34;,&#34;A1:C10&#34;).OlePropertyGet(&#34;Borders&#34;).OlePropertyGet(&#34;Item&#34;,xlDiagonalDown).OlePropertySet(&#34;Weight&#34;,4);//将指定区域的单元格用粗实线划掉
//画单元格完整边框： //sh.OlePropertyGet(&#34;Range&#34;,&#34;A1:C10&#34;).OlePropertyGet(&#34;Borders&#34;).OlePropertySet(&#34;linestyle&#34;,2);//给指定区域的所有单元格加上边框，最后的数字：1=细实线框，2=短距虚线框，3=长距虚线框，4=点划线，5=双点划线，6=粗点划线 //sh.OlePropertyGet(&#34;Range&#34;,&#34;A1:C10&#34;).OlePropertyGet(&#34;Borders&#34;).OlePropertySet(&#34;weight&#34;,1);//给指定区域的所有单元格加上边框，最后的数字不大于4 //sh.OlePropertyGet(&#34;Range&#34;,&#34;A1:C10&#34;).OlePropertyGet(&#34;Borders&#34;).OlePropertySet(&#34;colorindex&#34;,3);//给指定区域的所有单元格加上边框，最后的数字表示颜色 //sh.OlePropertyGet(&#34;Cells&#34;,11,2).OlePropertyGet(&#34;Borders&#34;).OlePropertySet(&#34;LineStyle&#34;,xlContinuous);//给指定单元格四周加上实线边框
//去掉指定区域的边框： //sh.OlePropertyGet(&#34;Range&#34;,&#34;A1:C10&#34;).OlePropertyGet(&#34;Borders&#34;).OlePropertySet(&#34;linestyle&#34;,xlNone);//去掉指定区域的边框
//画单元格单面边框参数说明： //xlDiagonalDown：绘制从左上到右下角的斜线 //xlDiagonalUp：绘制从左下到右上角的斜线 //xlEdgeBottom：画单元格下边框 //xlEdgeLeft：画单元格左边框 //xlEdgeRight：画单元格右边框 //xlEdgeTop：画单元格上边框 /*------------------------------------------------- //目前真正最全的OLE操作Excel的完整代码 //版本：2007." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/68d2793e83124cc2dd6c19d7798edc5a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-04-16T20:10:04+08:00" />
<meta property="article:modified_time" content="2012-04-16T20:10:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">最全的OLE操作Excel的完整代码（2）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">/*-------------------------------------------------<br style="line-height:normal"> //目前真正最全的OLE操作Excel的完整代码<br style="line-height:normal"> //版本：2007.01.15.01<br style="line-height:normal"> //C++Builder专家组<a href="http://www.3322ee.com/" rel="nofollow" style="color:rgb(153,153,153); line-height:normal">www.3322ee.com</a>原创文章<br style="line-height:normal"> //转载请保留本版权信息，谢谢合作<br style="line-height:normal"> --------------------------------------------------/<br style="line-height:normal"> //打印设定：<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintTitleRows","$2:$2");//打印标题列<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintTitleColumns","$A:$A");//打印标题栏<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintArea","$A$1:$I$15");//打印范围<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintHeadings",false);//栏名列号<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintGridlines",false);//打印网格线<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintComments",xlPrintNoComments);//批注"无"<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PrintQuality",300);//打印品质<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("CenterHorizontally",true);//水平置中<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("CenterVertically",false);//垂直置中<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("Orientation",xlLandscape);//横向打印 (xlPortrait 纵向打印)<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("Draft",false);//草稿品质<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("PaperSize",xlPaperA4);//纸张大小<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("FirstPageNumber",xlAutomatic);//起始页码<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("Order",xlDownThenOver);//循栏打印 (xlOverThenDown 循列打印)<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("BlackAndWhite",False);//储存格单色打印<br style="line-height:normal"> //sh.OlePropertyGet("PageSetup").OlePropertySet("Zoom",100);//缩放比例</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//设定单元格背景色：<br style="line-height:normal"> //sh.OlePropertyGet("Cells",2,2).OlePropertyGet("Interior").OlePropertySet("ColorIndex",3);//设定指定单元格的背景色</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//设定图样：xlGray50可以是1，2，3等数字<br style="line-height:normal"> //sh.OlePropertyGet("Cells",4,2).OlePropertyGet("Interior").OlePropertySet("Pattern",xlGray50);<br style="line-height:normal"> //sh.OlePropertyGet("Range","A1:C10").OlePropertyGet("Interior").OlePropertySet("Pattern",xlGray50);//在指定区域设置图样</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//设置单元格中的文字距左：<br style="line-height:normal"> //sh.OlePropertyGet("Cells",1,1).OlePropertySet("HorizontalAlignment",xlLeft);//设置单元格中的文字距左<br style="line-height:normal"> //sh.OlePropertyGet("Cells",1,1).OlePropertySet("VerticalAlignment",xlCenter);//作用不明(垂直和水平居中?)<br style="line-height:normal"> //设置单元格中的文字距中：<br style="line-height:normal"> sh.OlePropertyGet("Cells",1,1).OlePropertySet("HorizontalAlignment",xlCenter);//设置单元格中的文字距中<br style="line-height:normal"> //sh.OlePropertyGet("Cells",1,1).OlePropertySet("VerticalAlignment",xlCenter);//作用不明<br style="line-height:normal"> //设置单元格中的文字距右：<br style="line-height:normal"> //sh.OlePropertyGet("Cells",1,1).OlePropertySet("HorizontalAlignment",xlRight);//设置单元格中的文字距右<br style="line-height:normal"> //sh.OlePropertyGet("Cells",1,1).OlePropertySet("VerticalAlignment",xlCenter);//作用不明<br style="line-height:normal"> /*-------------------------------------------------<br style="line-height:normal"> //目前真正最全的OLE操作Excel的完整代码<br style="line-height:normal"> //版本：2007.01.15.01<br style="line-height:normal"> //C++Builder专家组<a href="http://www.3322ee.com/" rel="nofollow" style="color:rgb(153,153,153); line-height:normal">www.3322ee.com</a>原创文章<br style="line-height:normal"> //转载请保留本版权信息，谢谢合作<br style="line-height:normal"> --------------------------------------------------/<br style="line-height:normal"> //工作表操作：<br style="line-height:normal"> //sh.OlePropertySet("Name", "Sheet的新名字");//重命名当前工作表<br style="line-height:normal"> //sh.OleFunction("Delete");//删除当前工作表</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//画单元格单条边框：<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeLeft).OlePropertySet("Weight",xlThin);//画单元格左边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeLeft).OlePropertySet("LineStyle",xlContinuous);//画单元格左边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeRight).OlePropertySet("Weight",xlThin);//画单元格右边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeRight).OlePropertySet("LineStyle",xlContinuous);//画单元格右边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeTop).OlePropertySet("Weight",xlThin);//画单元格上边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeTop).OlePropertySet("LineStyle",xlContinuous);//画单元格上边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeBottom).OlePropertySet("Weight",xlThin);//画单元格下边框<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertyGet("Item",xlEdgeBottom).OlePropertySet("LineStyle",xlContinuous);//画单元格下边框<br style="line-height:normal"> //sh.OlePropertyGet("Range","A1:C10").OlePropertyGet("Borders").OlePropertyGet("Item",xlDiagonalDown).OlePropertySet("Weight",4);//将指定区域的单元格用粗实线划掉</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//画单元格完整边框：<br style="line-height:normal"> //sh.OlePropertyGet("Range","A1:C10").OlePropertyGet("Borders").OlePropertySet("linestyle",2);//给指定区域的所有单元格加上边框，最后的数字：1=细实线框，2=短距虚线框，3=长距虚线框，4=点划线，5=双点划线，6=粗点划线<br style="line-height:normal"> //sh.OlePropertyGet("Range","A1:C10").OlePropertyGet("Borders").OlePropertySet("weight",1);//给指定区域的所有单元格加上边框，最后的数字不大于4<br style="line-height:normal"> //sh.OlePropertyGet("Range","A1:C10").OlePropertyGet("Borders").OlePropertySet("colorindex",3);//给指定区域的所有单元格加上边框，最后的数字表示颜色<br style="line-height:normal"> //sh.OlePropertyGet("Cells",11,2).OlePropertyGet("Borders").OlePropertySet("LineStyle",xlContinuous);//给指定单元格四周加上实线边框</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//去掉指定区域的边框：<br style="line-height:normal"> //sh.OlePropertyGet("Range","A1:C10").OlePropertyGet("Borders").OlePropertySet("linestyle",xlNone);//去掉指定区域的边框</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//画单元格单面边框参数说明：<br style="line-height:normal"> //xlDiagonalDown：绘制从左上到右下角的斜线<br style="line-height:normal"> //xlDiagonalUp：绘制从左下到右上角的斜线<br style="line-height:normal"> //xlEdgeBottom：画单元格下边框<br style="line-height:normal"> //xlEdgeLeft：画单元格左边框<br style="line-height:normal"> //xlEdgeRight：画单元格右边框<br style="line-height:normal"> //xlEdgeTop：画单元格上边框<br style="line-height:normal"> /*-------------------------------------------------<br style="line-height:normal"> //目前真正最全的OLE操作Excel的完整代码<br style="line-height:normal"> //版本：2007.01.15.01<br style="line-height:normal"> //C++Builder专家组<a href="http://www.3322ee.com/" rel="nofollow" style="color:rgb(153,153,153); line-height:normal">www.3322ee.com</a>原创文章<br style="line-height:normal"> //转载请保留本版权信息，谢谢合作<br style="line-height:normal"> --------------------------------------------------/<br style="line-height:normal">     try{<!-- --><br style="line-height:normal">       //sh.OleFunction("SaveAs", "c:\\123.xls");//保存工作簿，当文件已经存在时会有提示，如果不覆盖会出错，所以正式使用时要预先处理或拦截错误<br style="line-height:normal">       //sh.OleFunction("SaveAs", WideString("c:\\"+ADODataSet1-&gt;FieldByName("creater")-&gt;AsString.Trim()+".xls"));//保存工作簿，当文件已经存在时会有提示，如果不覆盖会出错，所以正式使用时要预先处理或拦截错误<br style="line-height:normal">       //newxls.OleFunction("Close");//关闭表格<br style="line-height:normal">       //ex.OleFunction("Quit");//退出Excel，释放OLE对象<br style="line-height:normal">     }catch(...){<!-- --><br style="line-height:normal">       return;<br style="line-height:normal">     }</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//结束，如果没有如下代码，EXCEL线程直到应用程序退出才结束：<br style="line-height:normal"> Variant Axl,Workbook,AxSheet,nms,bef,aft;<br style="line-height:normal"> Axl=Unassigned;<br style="line-height:normal"> Workbook=Unassigned;<br style="line-height:normal"> AxSheet=Unassigned;<br style="line-height:normal"> bef=Unassigned;<br style="line-height:normal"> aft=Unassigned;<br style="line-height:normal"> nms=Unassigned;<br style="line-height:normal"> //ShowMessage("Well Done boy!");//弹出对话框<br style="line-height:normal"> }</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//图表部分，备用：------------------------------<br style="line-height:normal"> /*-------------------------------------------------<br style="line-height:normal"> //目前真正最全的OLE操作Excel的完整代码<br style="line-height:normal"> //版本：2007.01.15.01<br style="line-height:normal"> //C++Builder专家组<a href="http://www.3322ee.com/" rel="nofollow" style="color:rgb(153,153,153); line-height:normal">www.3322ee.com</a>原创文章<br style="line-height:normal"> //转载请保留本版权信息，谢谢合作<br style="line-height:normal"> --------------------------------------------------/<br style="line-height:normal"> 1)<br style="line-height:normal"> //开一个新的图表工作簿<br style="line-height:normal"> Variant Chart;<br style="line-height:normal"> Chart = ex.Exec(PropertyGet("Charts")).Exec(Function("Add"));<br style="line-height:normal"> ex.Exec(PropertySet("Visible") &lt;&lt; true);<br style="line-height:normal"> Chart.Exec(PropertySet("Type") &lt;&lt; -4100);</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">2)<br style="line-height:normal">     //滚动图表<br style="line-height:normal">     for(int nRotate=5; nRotate &lt;= 180; nRotate += 5){<!-- --><br style="line-height:normal">       Chart.Exec(PropertySet("Rotation") &lt;&lt; nRotate);<br style="line-height:normal">     }<br style="line-height:normal">     for(int nRotate = 175; nRotate &gt;= 0; nRotate -= 5){<!-- --><br style="line-height:normal">       Chart.Exec(PropertySet("Rotation") &lt;&lt; nRotate);<br style="line-height:normal">     }<br style="line-height:normal"> /*-------------------------------------------------<br style="line-height:normal"> //目前真正最全的OLE操作Excel的完整代码<br style="line-height:normal"> //版本：2007.01.15.01<br style="line-height:normal"> //C++Builder专家组<a href="http://www.3322ee.com/" rel="nofollow" style="color:rgb(153,153,153); line-height:normal">www.3322ee.com</a>原创文章<br style="line-height:normal"> //转载请保留本版权信息，谢谢合作<br style="line-height:normal"> --------------------------------------------------/<br style="line-height:normal"> 3)<br style="line-height:normal">       //使用ExcelApp的Exec方法新建一新工作薄<br style="line-height:normal">       newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add");//默认工作簿<br style="line-height:normal">       //newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add",1);//单工作表<br style="line-height:normal">       //newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add",2);//图表<br style="line-height:normal">       //newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add",3);//宏表<br style="line-height:normal">       //newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add",4);//国际通用宏表<br style="line-height:normal">       //newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add",5);//与默认的相同<br style="line-height:normal">       //newxls=(ex.OlePropertyGet("Workbooks")).OleFunction("Add",6);//工作簿且只有一个表<br style="line-height:normal"> ◎ 在工作表最前面插入一行<br style="line-height:normal"> Sheet1.PG("Rows", 1).PR("Insert");</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">◎ 删除一行<br style="line-height:normal"> ExcelApp.PG("Rows", 2).PR("Delete"); //将第2行删除<br style="line-height:normal"> ★窗口属性★</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">◎ 显示属性<br style="line-height:normal"> ExcelApp.PS("Windowstate", 3); //最大化显示<br style="line-height:normal"> 1---------xlNormal //正常显示<br style="line-height:normal"> 2---------xlMinimized //最小化显示<br style="line-height:normal"> 3---------xlMaximized //最大化显示</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">◎ 状态栏属性<br style="line-height:normal"> ExcelApp.PS("StatusBar", "您好,请您稍等。正在查询！");<br style="line-height:normal"> ExcelApp.PS("StatusBar", false); //还原成默认值</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">◎ 标题属性:<br style="line-height:normal"> ExcelApp.PS("Caption", "查询系统");<br style="line-height:normal"> <br style="line-height:normal"> 3、操作图表</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">★添加图表<br style="line-height:normal"> <br style="line-height:normal"> Variant Chart; <br style="line-height:normal"> Chart = ExcelApp.Exec(PropertyGet("Charts")).Exec(Function("Add"));<br style="line-height:normal"> ExcelApp.Exec(PropertySet("Visible") &lt;&lt; true);<br style="line-height:normal"> Chart.Exec(PropertySet("Type") &lt;&lt; -4100);</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">★滚动图表</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">for(int nRotate=5; nRotate &lt;= 180; nRotate += 5)<br style="line-height:normal"> {<!-- --><br style="line-height:normal"> Chart.Exec(PropertySet("Rotation") &lt;&lt; nRotate);<br style="line-height:normal"> }<br style="line-height:normal"> for (int nRotate = 175; nRotate &gt;= 0; nRotate -= 5)<br style="line-height:normal"> {<!-- --><br style="line-height:normal"> Chart.Exec(PropertySet("Rotation") &lt;&lt; nRotate);<br style="line-height:normal"> }<br style="line-height:normal"> </span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> </p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">#include "comobj.hpp"<br style="line-height:normal"> //---------------------------------------------------------------------------<br style="line-height:normal"> // 对指定Excel文件中的指定列进行排序<br style="line-height:normal"> // strExcelFileName : excel文件名<br style="line-height:normal"> // nCol : 指定的列号<br style="line-height:normal"> // nSortStyle : 1:升序，2:降序<br style="line-height:normal"> void SortExcelColumn(String strExcelFileName, int nCol, int nSortStyle)<br style="line-height:normal"> {<!-- --><br style="line-height:normal"> Variant vExcelApp, vWorkbook, vRange;<br style="line-height:normal"> vExcelApp = Variant::CreateObject("Excel.Application");<br style="line-height:normal"> vExcelApp.OlePropertySet("Visible", false);<br style="line-height:normal"> vExcelApp.OlePropertyGet("WorkBooks").OleProcedure("Open", strExcelFileName.c_str());<br style="line-height:normal"> vWorkbook = vExcelApp.OlePropertyGet("ActiveWorkbook");<br style="line-height:normal"> vExcelApp.OlePropertyGet("Columns", nCol).OleProcedure("Select");<br style="line-height:normal"> vExcelApp.OlePropertyGet("ActiveSheet").OlePropertyGet("Cells", 1, nCol).OleProcedure("Select");<br style="line-height:normal"> vRange = vExcelApp.OlePropertyGet("Selection");<br style="line-height:normal"> vRange.Exec(Function("Sort")&lt;&lt;vExcelApp.OlePropertyGet("Selection")&lt;&lt;nSortStyle);<br style="line-height:normal"> vWorkbook.OleProcedure("Save");<br style="line-height:normal"> vWorkbook.OleProcedure("Close");<br style="line-height:normal"> vExcelApp.OleFunction("Quit");<br style="line-height:normal"> vWorkbook = Unassigned;<br style="line-height:normal"> vExcelApp = Unassigned;<br style="line-height:normal"> ShowMessage("ok");<br style="line-height:normal"> }</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">void __fastcall TForm1::Button1Click(TObject *Sender)<br style="line-height:normal"> {<!-- --><br style="line-height:normal"> // 对C:\123\123.xls文件中第一个Sheet的第四列进行升序排序<br style="line-height:normal"> SortExcelColumn("C:\\123\\123.xls", 4, 1);<br style="line-height:normal"> }<br style="line-height:normal"> //</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">EXCEL之Range,cells,offset,end用法 <br style="line-height:normal"> 一.Range属性</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">1.选择单个单元格(例如A5)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range("A5").Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">2.选择一个单元格区域(例如A6:A10)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range("A6:A10").Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">3.选择一些不相邻的单元格(例如A1,B6,C8)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range("A1,B6,C8").Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">4.选择一些不相邻的单元格和单元格区域(例如A11:D11,B7,C9)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range("A11:D11,B7,C9").Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">二.Cells属性</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">1.选择单个单元格(例如A5)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Cells(5,1).Select                   Cells(5,A).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">2.选择一个单元格区域(例如A6:A10)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range(Cells(6,1),Cells(10,1)).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">3.选择工作表中的所有单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Cells.Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">三.Offset属性</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">1.选择单元格A1下面一行和右边三列的单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range("A1").Offset(1,3).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">2.选择单元格D15上面两行和左边一列的单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              Range("D15").Offset(-2,-1).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">3.选择同列单元格(上一行)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              ActiveCell.Offset(-1,0).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">4.重新选取区域</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              ActiveCell.Offset(2,2).Resize(2,4).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">四.END属性(移动到连续有内容的单元格)</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">1.选择任何行的最后一个单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              ActiveCell.End(xlToRight).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">2.选择任何行的最前一个单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              ActiveCell.End(xlToLeft).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">3.选择任何列的最后一个单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              ActiveCell.End(xlDown).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">1.选择任何列的最前一个单元格</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">              ActiveCell.End(xlUp).Select</span></p> 
<p style="font-family:'WenQuanYi Micro Hei Mono','WenQuanYi Micro Hei','Microsoft Yahei Mono','Microsoft Yahei',sans-serif; line-height:20px; color:rgb(102,102,102); font-size:14px"> <span style="background-color:rgb(255,255,255)">//----------------------------------------------------------------------------------------------------------<br style="line-height:normal"> 摘要：利用C++ Builder 5.0可视化的设计工具，强大方便的数据库开发功能和Excel强大的电子表格处理功能，为处理多重报表和复杂报表提供一个良好的方法。 <br style="line-height:normal"> 关键词：OLE 自动化客户程序 电子表格 <br style="line-height:normal"> Abstract: The paper provides a good method to make use of powerful database exploitation function of C++ Builder and powerful electron table management function of Excel 2000. <br style="line-height:normal"> Key words: OLE，automation client programs，electron table <br style="line-height:normal"> 一 引言 <br style="line-height:normal"> C++ builder 5.0是Inprise公司推出的基于C++语言的可视化开发语言，不仅具有新颖的可视化设计工具，还配有数据库引擎，可以通过SQL连接或ODBC访问多种数据库，并具有开发基于Client/Server模式的数据库应用程序的能力。当我们进行数据库软件开发的时候，一般要进行大量报表设计，尤其当涉及到设计多重报表或交叉报表时，我们会觉得力不从心。利用EXCEL强大的电子表格处理功能，可以解决C++ Builder 自带报表工具功能少的缺陷。 <br style="line-height:normal"> C++ Builder调用Excel常用的方法有两种：一种是利用OLE技术调用Excel。OLE（对象的连接和嵌入）是微软公司提出的标准，它提供了一种用源于不同应用程序的信息创建复合文档的强有力方法。第二种是利用ODBC数据库技术调用Excel。第一种方法比较简单，方便，本文讨论的是第一种方法。 <br style="line-height:normal"> 二 系统功能要求 <br style="line-height:normal"> 随着电子化办公的推广和保险业务的全面开展，账本式的管理方法已不能对数据庞大的电子化设备进行合理有效的管理，这就要求电子化的管理方式，通过计算机和公司局域网实现对设备进行管理。我们开发的电子化管理软件由电子化设备管理数据库、电子化设备耗材管理数据库组成，信息技术管理人员可以对本数据库进行添加、删除、修改、查询等操作，并且可以打印各种查询表格，表格按照EXCEL格式进行打印，并且保存归档。 <br style="line-height:normal"> C＋＋Builder软件自带创建报表工具，如QReport控件。但是相对于EXCEL强大的电子表格处理功能和方便的操作而言，QReport控件功能就显得很苍白。在该管理软件中，我们将查询结果自动生成EXCEL表格，然后在EXCEL环境下进行打印或者保存文件。具体函数实现在下面的段落中进行详细说明，并且都给出示例。 <br style="line-height:normal"> 三 函数的实现 <br style="line-height:normal"> 要在应用程序中控制Excel2000的运行，首先必须在编制自动化客户程序时使其头文件要包含Comobj.hpp和Utilcls.h。 <br style="line-height:normal"> 即：#include <br style="line-height:normal"> #include <br style="line-height:normal"> C++ Builder开发者把Excel自动化对象的功能包装在下面的四个Ole Object Class函数中，应用人员可以很方便地进行调用。 <br style="line-height:normal"> 设置对象属性：Variant OlePropertySet（属性名，参数……）； <br style="line-height:normal"> 获得对象属性：void OlePropertyGet（属性名，参数……）； <br style="line-height:normal"> 调用对象方法：1) Variant OleFunction（函数名，参数……）； <br style="line-height:normal"> 2) void OleProcedure（过程名，参数……）； <br style="line-height:normal"> C++ Builder中使用OLE控制Excel2000，必须掌握Excel2000的自动化对象及Microsoft Word Visual Basic帮助文件中的关于Excel的对象、方法和属性。对象是一个Excel元素，属性是对象的一个特性或操作的一个方面，方法是对象可以进行的动作。 <br style="line-height:normal"> 1、Excel中常用的对象是：Application，Workbooks，Worksheets等。 <br style="line-height:normal"> （1） 创建应用对象：如： <br style="line-height:normal"> Variant ex； <br style="line-height:normal"> ex=Variant::CreateObject ("Excel.Application"); <br style="line-height:normal"> 或者 ex=CreateOleObject ("Excel.Application"); <br style="line-height:normal"> （2） 创建工作簿对象： <br style="line-height:normal"> Variant wb； <br style="line-height:normal"> wb=ex.OlePropertyGet("ActiveWorkBook"); <br style="line-height:normal"> （3） 创建工作表对象： <br style="line-height:normal"> Variant sheet； <br style="line-height:normal"> sheet=wb.OlePropertyGet("ActiveSheet"); <br style="line-height:normal"> （4） 创建区域对象： <br style="line-height:normal"> Variant range； <br style="line-height:normal"> range=sheet.OlePropertyGet("Range","A1:A10"); <br style="line-height:normal"> 2、常用的属性操作： <br style="line-height:normal"> （1）新建EXCEL文件： <br style="line-height:normal"> （a）：新建系统模板的工作簿 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add") //默认工作簿 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add"，1) //单工作表 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add"，2) //图表 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add"，3) //宏表 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add"，4) //国际通用宏表 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add"，5) //与默认的相同 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add"，6) //工作簿且只有一个表 <br style="line-height:normal"> （b）：新建自己创建的模板的工作簿 <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("Add","C:\\WINDOWS\\Profiles\\test2\\Application Data\\Microsoft\\Templates\\result.xlt"); // 后面写上模板的完全路径，注意"\\" <br style="line-height:normal"> （2）打开工作簿： <br style="line-height:normal"> ex.OlePropertyGet("workbooks").OleFunction("open"，"路径名.xls") <br style="line-height:normal"> （3）保存工作簿： <br style="line-height:normal"> wb.OleFunction("Save"); //表格保存 <br style="line-height:normal"> wb..OleFunction("SaveAs","文件名"); //表格保存为，文件路径注意用"\\" <br style="line-height:normal"> （4）退出EXCEL： <br style="line-height:normal"> ex.OleFunction ("Quit"); <br style="line-height:normal"> （5）设置字体： <br style="line-height:normal"> （a）：设置单元格字体 <br style="line-height:normal"> sheet.OlePropertyGet("Cells",1,1).OlePropertyGet("Font").OlePropertySet("Name","隶书"); <br style="line-height:normal"> sheet.OlePropertyGet("Cells",2,3).OlePropertyGet("Font").OlePropertySet("size",28); <br style="line-height:normal"> （b）：设置所选区域字体 <br style="line-height:normal"> range.OlePropertyGet("Cells").OlePropertyGet("Font").OlePropertySet("size",28); range.OlePropertyGet("Cells").OlePropertyGet("Font").OlePropertySet("Color", <br style="line-height:normal"> RGB(0,0,255)); <br style="line-height:normal"> 其中参数的设置： <br style="line-height:normal"> Font---Name : "隶书" //字体名称 <br style="line-height:normal"> ----Size : 12 //字体大小 <br style="line-height:normal"> ----Color : RGB(*,*,*) //颜色 <br style="line-height:normal"> -----Underline : true/false //下划线 <br style="line-height:normal"> -----Italic: true/false //斜体 <br style="line-height:normal"> （6）单元格的合并： <br style="line-height:normal"> （a） range1=sheet.OlePropertyGet("Range", "A1:A2"); //A1和A2单元格合并 <br style="line-height:normal"> （b） AnsiString Str="A"+IntToStr(j)+":"+"C"+IntToStr(j); <br style="line-height:normal"> range1=sheet.OlePropertyGet("Range",Str); //可以用变量控制单元格合并 <br style="line-height:normal"> range1.OleFunction("Merge" , false); <br style="line-height:normal"> （7）赋值语句： <br style="line-height:normal"> （a）：指定单元格赋值 <br style="line-height:normal"> sheet.OlePropertyGet("Cells",3,6).OlePropertySet("Value",str); <br style="line-height:normal"> sheet.OlePropertyGet("Cells",j,1).OlePropertySet("Value","共查到记录:"+IntToStr(j-6)); <br style="line-height:normal"> （b）：所选区域单元格赋值 <br style="line-height:normal"> range.OlePropertyGet("Cells").OlePropertySet("Value",10); <br style="line-height:normal"> （c）：所选区域行赋值 <br style="line-height:normal"> range.OlePropertyGet("Rows",1).OlePropertySet("Value",1234); <br style="line-height:normal"> （d）：工作表列赋值 <br style="line-height:normal"> sheet.OlePropertyGet("Columns",1).OlePropertySet("Value",1234); <br style="line-height:normal"> （8）取值语句： <br style="line-height:normal"> AnsiString abc=sheet.OlePropertyGet("Cells",120,1).OlePropertyGet("Value"); <br style="line-height:normal"> （9）区域选择： <br style="line-height:normal"> range.OlePropertyGet("Cells").OleFunction("Select"); <br style="line-height:normal"> （10）窗口属性： <br style="line-height:normal"> （a）显示属性 <br style="line-height:normal"> ex.OlePropertySet("Windowstate",3); //最大化显示 <br style="line-height:normal"> 参数 1---------xlNormal //正常显示 <br style="line-height:normal"> 2---------xlMinimized //最小化显示 <br style="line-height:normal"> 3---------xlMaximized //最大化显示 <br style="line-height:normal"> （b）状态栏属性 <br style="line-height:normal"> ex.OlePropertySet ("StatusBar","您好，请您稍等。正在查询！"); <br style="line-height:normal"> ex.OlePropertySet ("StatusBar", false); //还原成默认值 <br style="line-height:normal"> （c）标题属性： <br style="line-height:normal"> ex.OlePropertySet("Caption","查询系统"); </span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9d680cc972f3a181a566ec69c265fe0e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Nginx模块参考手册：FastCGI模块(FastCGI)(3)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8664b02503422657e806941add00066c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">各种字符串类型之间的转换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>