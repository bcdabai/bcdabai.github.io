<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>elementui Cascader 级联选择使用心得 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="elementui Cascader 级联选择使用心得" />
<meta property="og:description" content="相信大家对于elementui并不陌生，作为适配Vue的优秀UI框架之一，一直被所有的开发者痛并快乐着。今天要记录的就是里边的主角之一Cascader。
首先先介绍一下Cascader ---&gt; 当一个数据集合有清晰的层级结构时，可通过级联选择器逐级查看并选择。
&lt;el-cascader :options=&#34;options&#34; clearable&gt;&lt;/el-cascader&gt; 1、级联选择器经常会用来做地区的选择，在使用过程中发现了第一个有意思的地方----清空，比如我们经常会给元素添加clearable属性 &lt;el-cascader :options=&#34;options&#34; clearable&gt;&lt;/el-cascader&gt; 正常选中没问题 当点击了清空按钮之后 下拉的面板应该回到之前没选中的状态，但没有回到之前的状态
解决办法：
&lt;el-cascader ref=&#34;addressCascader&#34; :props=&#34;addressOptions&#34; filterable clearable v-model=&#34;selectOptions&#34; @change=&#34;addressChange&#34; @visible-change=&#34;visibleChange&#34;&gt;&lt;/el-cascader&gt; addressChange(data){ if(data &amp;&amp; data.length == 0){ this.$refs[&#39;addressCascader&#39;][0].$refs.panel.checkedValue = [] // 清空选中值 this.$refs[&#39;addressCascader&#39;][0].$refs.panel.clearCheckedNodes() // 清空级联选择器选中状态 this.$refs[&#39;addressCascader&#39;][0].$refs.panel.activePath = [] // 清除高亮 this.$refs[&#39;addressCascader&#39;][0].$refs.panel.syncActivePath() // 初始化（只展示一级节点） } } 2、面板展开可直接看到选中的数据 visibleChange(val) { if(val) { if (this.$refs[&#39;addressCascader&#39;]) { if(this.$refs[&#39;addressCascader&#39;][0].getCheckedNodes()[0]){ this.$refs[&#39;addressCascader&#39;][0].$refs.panel.activePath = this.$refs[&#39;addressCascader&#39;][0].getCheckedNodes() } } } } 3、动态加载数据 addressOptions: { lazy: true, lazyLoad: (node, resolve) =&gt; { const { level } = node const nodes = [] let type = level ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1cd18e4f2e2d61b9d1dabfc8fa775867/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-16T16:47:50+08:00" />
<meta property="article:modified_time" content="2023-08-16T16:47:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">elementui Cascader 级联选择使用心得</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>相信大家对于<a class="link-info" href="https://element.eleme.io/2.12/#/zh-CN/component/installation" rel="nofollow" title="elementui">elementui</a>并不陌生，作为适配Vue的优秀UI框架之一，一直被所有的开发者痛并快乐着。今天要记录的就是里边的主角之一<strong>Cascader。</strong></p> 
<p>首先先介绍一下<strong>Cascader ---&gt; </strong>当一个数据集合有清晰的层级结构时，可通过级联选择器逐级查看并选择。</p> 
<p><img alt="" height="259" src="https://images2.imgbox.com/19/7c/8tTAM8Wn_o.png" width="938"></p> 
<p></p> 
<p><img alt="" height="312" src="https://images2.imgbox.com/d7/71/jUwKnwmy_o.png" width="934"></p> 
<p></p> 
<pre><code class="language-html">&lt;el-cascader :options="options" clearable&gt;&lt;/el-cascader&gt;</code></pre> 
<p></p> 
<h4>1、级联选择器经常会用来做地区的选择，在使用过程中发现了第一个有意思的地方----清空，比如我们经常会给元素添加clearable属性</h4> 
<pre><code class="language-html">&lt;el-cascader :options="options" clearable&gt;&lt;/el-cascader&gt;</code></pre> 
<p> <img alt="" height="252" src="https://images2.imgbox.com/b6/7c/9yTbauOU_o.png" width="905"></p> 
<p></p> 
<p><img alt="" height="212" src="https://images2.imgbox.com/de/ea/THhumP1h_o.png" width="948"></p> 
<p> <strong>正常选中没问题 当点击了清空按钮之后  下拉的面板应该回到之前没选中的状态，但没有回到之前的状态</strong></p> 
<p><img alt="" height="322" src="https://images2.imgbox.com/96/b7/SpzxPYrt_o.png" width="690"></p> 
<p>解决办法：</p> 
<pre><code class="language-html">&lt;el-cascader ref="addressCascader" :props="addressOptions" filterable clearable v-model="selectOptions" @change="addressChange" @visible-change="visibleChange"&gt;&lt;/el-cascader&gt;</code></pre> 
<pre><code class="language-javascript">addressChange(data){
    if(data &amp;&amp; data.length == 0){
        this.$refs['addressCascader'][0].$refs.panel.checkedValue = [] // 清空选中值
		this.$refs['addressCascader'][0].$refs.panel.clearCheckedNodes() // 清空级联选择器选中状态
		this.$refs['addressCascader'][0].$refs.panel.activePath = [] // 清除高亮
		this.$refs['addressCascader'][0].$refs.panel.syncActivePath() // 初始化（只展示一级节点）
	}
}</code></pre> 
<h4> 2、面板展开可直接看到选中的数据 </h4> 
<pre><code class="language-javascript">visibleChange(val) {
	if(val) {
		if (this.$refs['addressCascader']) {
			if(this.$refs['addressCascader'][0].getCheckedNodes()[0]){
				this.$refs['addressCascader'][0].$refs.panel.activePath = this.$refs['addressCascader'][0].getCheckedNodes()
			}
		}
	}
}</code></pre> 
<h4> 3、动态加载数据</h4> 
<pre><code class="language-javascript">addressOptions: {
	lazy: true,
	lazyLoad: (node, resolve) =&gt; {
		const { level } = node
		const nodes = []
		let type = level ? level + 1 : 1
		this.$http({
			url:this.$http.adornUrl('/business', '/dictprovince/selectList'),
			method: 'post',
			data: { level: type , parentCode: node.value }
		}).then(res =&gt; {
		    //console.log("保单归属地", res.data.data)
			res.data.data.map(item =&gt; {
			let area = {
				    value: item.code,
					label: item.name,
					leaf: item.level &gt;= 3,
			    };
			    nodes.push(area)
		    })
			resolve(nodes)
	    })
    }
}</code></pre> 
<p><strong>动态加载数据需要注意的是leaf的值  如果是二级菜单level&gt;=2，三级菜单level&gt;=3</strong></p> 
<h4><strong>4、后台返回的省市区直辖市选择的时候，针对一、二级的code可能是相同的的情况</strong></h4> 
<p><img alt="" height="83" src="https://images2.imgbox.com/56/97/0ubvSaOy_o.png" width="461"></p> 
<p>code ['110000', '110000', '110107']，这样的情况在数据新增的时候是没有问题，但是在页面回显的时候例如查看或者修改，el-casder是无法正确的显示选中值的。<strong>问题的原因是cascader的每一项id都不能重复</strong></p> 
<p> 解决办法：例如将props中的value替换为省市区返回数据中的主键id。这种方法可以解决不回显的问题，但是在给后端传值的时候需要见选中的主键id 转换为对应的省市区code。相对比较繁琐</p> 
<pre><code class="language-javascript">addressOptions: {
    value: item.id,
	label: item.name,
	code: item.code							
}</code></pre> 
<p><strong>使用如下代码将id转换为对应的code</strong></p> 
<pre><code class="language-javascript">let pathNodeArray = this.$refs['addressCascader'][0].getCheckedNodes()[0].pathNodes
let pathNodeCodes = []
pathNodeArray.forEach(n =&gt; {
	pathNodeCodes.push(n.data.code)
})</code></pre> 
<p><strong>记录使用当中遇到的问题，不定期更新~</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02754f4447a620ba0e2932a15a863640/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android设备通过蓝牙HID技术模拟键盘实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c7af49eb6065a7373b6a7c51690cd4f7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MyBatis多表查询</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>