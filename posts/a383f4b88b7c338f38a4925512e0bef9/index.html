<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu16.04 NVDLA环境搭建 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu16.04 NVDLA环境搭建" />
<meta property="og:description" content="Download the Virtual Simulator
$ git clone https://github.com/nvdla/vp.git
$ cd vp
$ git submodule update --init --recursive
Install Dependencies
1. Install required tools and libraries
$ sudo apt-get install g&#43;&#43; cmake libboost-dev python-dev libglib2.0-dev libpixman-1-dev liblua5.2-dev swig libcap-dev libattr1-dev
2. Download and install SystemC 2.3.0
$ wget -O systemc-2.3.0a.tar.gz http://www.accellera.org/images/downloads/standards/systemc/systemc-2.3.0a.tar.gz
$ tar -xzvf systemc-2.3.0a.tar.gz
$ cd systemc-2.3.0a
$ sudo mkdir -p /usr/local/systemc-2.3.0/
$ mkdir objdir
$ cd objdir
$ ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a383f4b88b7c338f38a4925512e0bef9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-10T21:26:50+08:00" />
<meta property="article:modified_time" content="2018-12-10T21:26:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu16.04 NVDLA环境搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>Download the Virtual Simulator<br> $ git clone https://github.com/nvdla/vp.git<br> $ cd vp<br> $ git submodule update --init --recursive</p> 
<p>Install Dependencies<br> 1. Install required tools and libraries<br> $ sudo apt-get install g++ cmake libboost-dev python-dev libglib2.0-dev libpixman-1-dev liblua5.2-dev swig libcap-dev libattr1-dev<br> 2. Download and install SystemC 2.3.0<br> $ wget -O systemc-2.3.0a.tar.gz http://www.accellera.org/images/downloads/standards/systemc/systemc-2.3.0a.tar.gz<br> $ tar -xzvf systemc-2.3.0a.tar.gz<br> $ cd systemc-2.3.0a<br> $ sudo mkdir -p /usr/local/systemc-2.3.0/<br> $ mkdir objdir<br> $ cd objdir<br> $ ../configure --prefix=/usr/local/systemc-2.3.0<br> $ make<br> $ sudo make install<br> 如果遇到make install没有安装到制定目录的问题，查看Makefile中prefix变量赋值<br> prefix = /usr/local/systemc-2.3.0</p> 
<p><br> 3. Download and build NVDLA CMOD<br> $ git clone https://github.com/nvdla/hw.git<br> $ cd hw<br> $ make<br> 如果遇到make install没有安装到制定目录的问题，查看Makefile中prefix变量赋值<br> prefix = /usr/local/systemc-2.3.0</p> 
<p><br> 3. Download and build NVDLA CMOD<br> $ git clone https://github.com/nvdla/hw.git<br> $ cd hw<br> $ make<br> 这步按照提示输入对应工具路径，以下为参考：</p> 
<p>DEFAULT_CPP := /usr/bin/cpp<br> DEFAULT_GCC := /usr/bin/g++<br> DEFAULT_PERL := /usr/bin/perl<br> DEFAULT_JAVA := /usr/bin/java<br> DEFAULT_SYSTEMC := /usr/local/systemc-2.3.0<br> DEFAULT_VERILATOR := verilator<br> DEFAULT_CLANG := clang<br> DEFAULT_PROJ := nv_full<br> $ tools/bin/tmake -build cmod_top<br> 4. Cmake build</p> 
<p>$ cd vp</p> 
<p>$ cmake -DCMAKE_INSTALL_PREFIX=build -DSYSTEMC_PREFIX=/usr/local/systemc-2.3.0/ -DNVDLA_HW_PREFIX=/path/to/nvdla/hw -DNVDLA_HW_PROJECT=nv_full</p> 
<p>$ make</p> 
<p> </p> 
<p>编译vp中会遇到一些问题，参考以下解决方法</p> 
<p>Can't locate YAML.pm/Tee.pm error<br> 安装YAML.pm<br> downloading from url: http://search.cpan.org/CPAN/authors/id/T/TI/TINITA/YAML-1.24.tar.gz<br> perl Makefile.PL<br> make;<br> sudo make install</p> 
<p><br> 安装IO/Tee.pm<br> downloading from url: http://search.cpan.org/CPAN/authors/id/N/NE/NEILB/IO-Tee-0.65.tar.gz<br> perl Makefile.PL<br> make;<br> sudo make install</p> 
<p>Deprecated Error<br> /usr/local/systemc-2.3.0/include/sysc/packages/boost/get_pointer.hpp:21:40: error: ‘template&lt;class&gt; class std::auto_ptr’ is deprecated [-Werror=deprecated-declarations]<br>  template&lt;class T&gt; T * get_pointer(std::auto_ptr&lt;T&gt; const&amp; p)<br> 修改vp/CMakeLists.txt<br> 注释下面三行：<br> # set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall -Werror ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> # set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall -Werror -DDEBUG_LOG=1 ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> # set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall -Werror ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> 添加如下：<br> set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall  ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall  -DDEBUG_LOG=1 ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall  ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> 将子目录下CMakeList.txt中的 CMAKE_CXX_FLAGS语句中的-Werror删除<br> ./models/nvdla/CMakeLists.txt +87<br> ./models/nvdla/CMakeLists.txt +88<br> ./models/nvdla/CMakeLists.txt +89</p> 
<p><br> ./fpga/aws-fpga/fpga_sc_wrapper/CMakeLists.txt +91<br> ./fpga/aws-fpga/fpga_sc_wrapper/CMakeLists.txt +92<br> ./fpga/aws-fpga/fpga_sc_wrapper/CMakeLists.txt +93</p> 
<p>./fpga/aws-fpga/cosim_sc_wrapper/CMakeLists.txt +82<br> ./fpga/aws-fpga/cosim_sc_wrapper/CMakeLists.txt +83<br> ./fpga/aws-fpga/cosim_sc_wrapper/CMakeLists.txt +84</p> 
<p>安装YAML.pm<br> downloading from url: http://search.cpan.org/CPAN/authors/id/T/TI/TINITA/YAML-1.24.tar.gz<br> perl Makefile.PL<br> make;<br> sudo make install</p> 
<p><br> 安装IO/Tee.pm<br> downloading from url: http://search.cpan.org/CPAN/authors/id/N/NE/NEILB/IO-Tee-0.65.tar.gz<br> perl Makefile.PL<br> make;<br> sudo make install</p> 
<p>Deprecated Error<br> /usr/local/systemc-2.3.0/include/sysc/packages/boost/get_pointer.hpp:21:40: error: ‘template&lt;class&gt; class std::auto_ptr’ is deprecated [-Werror=deprecated-declarations]<br>  template&lt;class T&gt; T * get_pointer(std::auto_ptr&lt;T&gt; const&amp; p)<br> 修改vp/CMakeLists.txt<br> 注释下面三行：<br> # set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall -Werror ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> # set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall -Werror -DDEBUG_LOG=1 ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> # set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall -Werror ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> 添加如下：<br> set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall  ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> set(CMAKE_CXX_FLAGS_DEBUG "${CMAKE_CXX_FLAGS_DEBUG} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall  -DDEBUG_LOG=1 ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -DSC_INCLUDE_DYNAMIC_PROCESSES -Wall  ${AWS_FPGA_CFLAGS} ${TRACE_CFLAGS}")<br> 将子目录下CMakeList.txt中的 CMAKE_CXX_FLAGS语句中的-Werror删除<br> ./models/nvdla/CMakeLists.txt +87<br> ./models/nvdla/CMakeLists.txt +88<br> ./models/nvdla/CMakeLists.txt +89</p> 
<p><br> ./fpga/aws-fpga/fpga_sc_wrapper/CMakeLists.txt +91<br> ./fpga/aws-fpga/fpga_sc_wrapper/CMakeLists.txt +92<br> ./fpga/aws-fpga/fpga_sc_wrapper/CMakeLists.txt +93</p> 
<p>./fpga/aws-fpga/cosim_sc_wrapper/CMakeLists.txt +82<br> ./fpga/aws-fpga/cosim_sc_wrapper/CMakeLists.txt +83<br> ./fpga/aws-fpga/cosim_sc_wrapper/CMakeLists.txt +84</p> 
<p><br> Python库不是2.x，导致PyString_* 找不到</p> 
<p>/home/bg193/works/nvdla/vp/libs/greenlib/greenscript/src/greenscript.cpp: In member function ‘void gs::script::GreenScriptModule::load(const char*)’:<br> /home/bg193/works/nvdla/vp/libs/greenlib/greenscript/src/greenscript.cpp:221:46: error: ‘PyString_AsString’ was not declared in this scope<br>        std::string s(PyString_AsString(path_py));<br> 修改vp/libs/greenlib/CMakeLists.txt<br>   # set(EXTERNAL_INCLUDE_DIRS ${EXTERNAL_INCLUDE_DIRS} ${PYTHON_INCLUDE_DIRS})<br>   set(EXTERNAL_INCLUDE_DIRS ${EXTERNAL_INCLUDE_DIRS} "/usr/include/python2.7")</p> 
<p><br> 5.运行模拟器<br> VP编译完毕后，复制aarch64_toplevel到sw/prebuild/linux</p> 
<p><br> 修改aarch64_nvdla.lua</p> 
<p>-kernel /home/bg193/works/nvdla/sw/prebuilt/linux/Image<br> -drive file=/home/bg193/works/nvdla/sw/prebuilt/linux/rootfs.ext4</p> 
<p><br> 在sw/prebuild/linux下执行：<br> $ export SC_SIGNAL_WRITE_CHECK=DISABLE<br> $ ./build/bin/aarch64_toplevel -c conf/aarch64_nvdla.lua</p> 
<p>执行test测试<br> 将vp/test目录下文件复制到sw/prebuild/linux,命令中r代表模拟器执行目录<br> # mount -t 9p -o trans=virtio r /mnt<br> # cd /mnt/tests/hello<br> # ./aarch64_hello<br> 修改vp/libs/greenlib/CMakeLists.txt<br>   # set(EXTERNAL_INCLUDE_DIRS ${EXTERNAL_INCLUDE_DIRS} ${PYTHON_INCLUDE_DIRS})<br>   set(EXTERNAL_INCLUDE_DIRS ${EXTERNAL_INCLUDE_DIRS} "/usr/include/python2.7")</p> 
<p><br> 5.运行模拟器<br> VP编译完毕后，复制aarch64_toplevel到sw/prebuild/linux</p> 
<p><br> 修改aarch64_nvdla.lua</p> 
<p>-kernel /home/bg193/works/nvdla/sw/prebuilt/linux/Image<br> -drive file=/home/bg193/works/nvdla/sw/prebuilt/linux/rootfs.ext4</p> 
<p><br> 在sw/prebuild/linux下执行：<br> $ export SC_SIGNAL_WRITE_CHECK=DISABLE<br> $ ./build/bin/aarch64_toplevel -c conf/aarch64_nvdla.lua</p> 
<p>执行test测试<br> 将vp/test目录下文件复制到sw/prebuild/linux,命令中r代表模拟器执行目录<br> # mount -t 9p -o trans=virtio r /mnt<br> # cd /mnt/tests/hello<br> # ./aarch64_hello</p> 
<p><br> --------------------- <br> 作者：hywcogost <br> 来源：CSDN <br> 原文：https://blog.csdn.net/hywCogost/article/details/82114529 <br> 版权声明：本文为博主原创文章，转载请附上博文链接！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a6be7f4d4821f93c25d3d180b8609e28/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Permission denied (publickey,gssapi-keyex,gssapi-with-mic) 解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5a61d5e10317ced0a0b275727f2061d2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">汽车上的电源模块：BAT、ACC、IGN、ST</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>