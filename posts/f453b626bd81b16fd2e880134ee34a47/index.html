<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【饥荒】介绍一些组件 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【饥荒】介绍一些组件" />
<meta property="og:description" content="介绍一些组件 原文：[Introduction to some Components] (http://forums.kleientertainment.com/topic/47542-introduction-to-some-components)
翻译: @czfshine Prefabs(预设物）, Components（组件）, Stategraphs（状态图）, 这一些名词意味着是什么呢？我希望它们像XYZ一样简单。
目录： 介绍一些组件目录General一般Armor护甲 重要的变量重要的函数例子 Beard胡子 重要变量重要函数例子 Burnable可燃的 重要的变量重要的函数例子 Container容器 重要的变量重要的函数例子 Cookable烹饪 重要的变量例子 Dapperness衣衫褴褛 重要的变量例子 Eater吃者 重要的变量重要的函数基本的食物类型例子 Edible可食用的 重要的变量例子 Equippable可装备的 重要的变量例子 Finite Uses耐久 重要的变量重要的函数例子 Harvestable收获 重要的变量重要的函数例子 Health生命 重要的变量重要的函数例子 Hunger饥饿 重要的变量例子 Insulator保暖 重要的变量例子 Inventory-Item可存放 重要的变量重要的函数例子 Perishable腐败 重要的变量重要的函数例子 Pickable可采摘 重要的变量重要的函数例子 Propagator传播算子 重要的变量重要的函数 Repairable可修理 重要的变量例子 Sanity-Aurasan光环 重要的变量 Talker话语者 重要的函数例子 Tool工具 重要的函数例子 Tradable交易 例子 Useable Item可使用的 重要的变量例子 Workable能工作的 重要的变量重要的函数例子 Light亮 使用重要的函数例子 General（一般） 假设你已经熟悉基本的Lua" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f453b626bd81b16fd2e880134ee34a47/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-02-17T16:10:35+08:00" />
<meta property="article:modified_time" content="2015-02-17T16:10:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【饥荒】介绍一些组件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="介绍一些组件">介绍一些组件</h2> 
<p>原文：[Introduction to some Components] <br> (<a href="http://forums.kleientertainment.com/topic/47542-introduction-to-some-components" rel="nofollow">http://forums.kleientertainment.com/topic/47542-introduction-to-some-components</a>)</p> 
<p>翻译: @czfshine </p> 
<blockquote> 
 <p><strong>Prefabs</strong>(预设物）, <strong>Components</strong>（组件）, <strong>Stategraphs</strong>（状态图）, 这一些名词意味着是什么呢？我希望它们像XYZ一样简单。</p> 
</blockquote> 
<h2 id="目录">目录：</h2> 
<p></p> 
<div class="toc"> 
 <ul><li><a href="#%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%BA%9B%E7%BB%84%E4%BB%B6" rel="nofollow">介绍一些组件</a></li><li><a href="#%E7%9B%AE%E5%BD%95" rel="nofollow">目录</a></li><li><a href="#general%E4%B8%80%E8%88%AC" rel="nofollow">General一般</a></li><li><a href="#armor%E6%8A%A4%E7%94%B2" rel="nofollow">Armor护甲</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90" rel="nofollow">例子</a></li></ul> </li><li><a href="#beard%E8%83%A1%E5%AD%90" rel="nofollow">Beard胡子</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E5%8F%98%E9%87%8F" rel="nofollow">重要变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E5%87%BD%E6%95%B0" rel="nofollow">重要函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-1" rel="nofollow">例子</a></li></ul> </li><li><a href="#burnable%E5%8F%AF%E7%87%83%E7%9A%84" rel="nofollow">Burnable可燃的</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-1" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-1" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-2" rel="nofollow">例子</a></li></ul> </li><li><a href="#container%E5%AE%B9%E5%99%A8" rel="nofollow">Container容器</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-2" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-2" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-3" rel="nofollow">例子</a></li></ul> </li><li><a href="#cookable%E7%83%B9%E9%A5%AA" rel="nofollow">Cookable烹饪</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-3" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-4" rel="nofollow">例子</a></li></ul> </li><li><a href="#dapperness%E8%A1%A3%E8%A1%AB%E8%A4%B4%E8%A4%9B" rel="nofollow">Dapperness衣衫褴褛</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-4" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-5" rel="nofollow">例子</a></li></ul> </li><li><a href="#eater%E5%90%83%E8%80%85" rel="nofollow">Eater吃者</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-5" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-3" rel="nofollow">重要的函数</a></li><li><a href="#%E5%9F%BA%E6%9C%AC%E7%9A%84%E9%A3%9F%E7%89%A9%E7%B1%BB%E5%9E%8B" rel="nofollow">基本的食物类型</a></li><li><a href="#%E4%BE%8B%E5%AD%90-6" rel="nofollow">例子</a></li></ul> </li><li><a href="#edible%E5%8F%AF%E9%A3%9F%E7%94%A8%E7%9A%84" rel="nofollow">Edible可食用的</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-6" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-7" rel="nofollow">例子</a></li></ul> </li><li><a href="#equippable%E5%8F%AF%E8%A3%85%E5%A4%87%E7%9A%84" rel="nofollow">Equippable可装备的</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-7" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-8" rel="nofollow">例子</a></li></ul> </li><li><a href="#finite-uses%E8%80%90%E4%B9%85" rel="nofollow">Finite Uses耐久</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-8" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-4" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-9" rel="nofollow">例子</a></li></ul> </li><li><a href="#harvestable%E6%94%B6%E8%8E%B7" rel="nofollow">Harvestable收获</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-9" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-5" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-10" rel="nofollow">例子</a></li></ul> </li><li><a href="#health%E7%94%9F%E5%91%BD" rel="nofollow">Health生命</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-10" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-6" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-11" rel="nofollow">例子</a></li></ul> </li><li><a href="#hunger%E9%A5%A5%E9%A5%BF" rel="nofollow">Hunger饥饿</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-11" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-12" rel="nofollow">例子</a></li></ul> </li><li><a href="#insulator%E4%BF%9D%E6%9A%96" rel="nofollow">Insulator保暖</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-12" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-13" rel="nofollow">例子</a></li></ul> </li><li><a href="#inventory-item%E5%8F%AF%E5%AD%98%E6%94%BE" rel="nofollow">Inventory-Item可存放</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-13" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-7" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-14" rel="nofollow">例子</a></li></ul> </li><li><a href="#perishable%E8%85%90%E8%B4%A5" rel="nofollow">Perishable腐败</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-14" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-8" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-15" rel="nofollow">例子</a></li></ul> </li><li><a href="#pickable%E5%8F%AF%E9%87%87%E6%91%98" rel="nofollow">Pickable可采摘</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-15" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-9" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-16" rel="nofollow">例子</a></li></ul> </li><li><a href="#propagator%E4%BC%A0%E6%92%AD%E7%AE%97%E5%AD%90" rel="nofollow">Propagator传播算子</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-16" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-10" rel="nofollow">重要的函数</a></li></ul> </li><li><a href="#repairable%E5%8F%AF%E4%BF%AE%E7%90%86" rel="nofollow">Repairable可修理</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-17" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-17" rel="nofollow">例子</a></li></ul> </li><li><a href="#sanity-aurasan%E5%85%89%E7%8E%AF" rel="nofollow">Sanity-Aurasan光环</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-18" rel="nofollow">重要的变量</a></li></ul> </li><li><a href="#talker%E8%AF%9D%E8%AF%AD%E8%80%85" rel="nofollow">Talker话语者</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-11" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-18" rel="nofollow">例子</a></li></ul> </li><li><a href="#tool%E5%B7%A5%E5%85%B7" rel="nofollow">Tool工具</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-12" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-19" rel="nofollow">例子</a></li></ul> </li><li><a href="#tradable%E4%BA%A4%E6%98%93" rel="nofollow">Tradable交易</a> 
   <ul><li><a href="#%E4%BE%8B%E5%AD%90-20" rel="nofollow">例子</a></li></ul> </li><li><a href="#useable-item%E5%8F%AF%E4%BD%BF%E7%94%A8%E7%9A%84" rel="nofollow">Useable Item可使用的</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-19" rel="nofollow">重要的变量</a></li><li><a href="#%E4%BE%8B%E5%AD%90-21" rel="nofollow">例子</a></li></ul> </li><li><a href="#workable%E8%83%BD%E5%B7%A5%E4%BD%9C%E7%9A%84" rel="nofollow">Workable能工作的</a> 
   <ul><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F-20" rel="nofollow">重要的变量</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-13" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-22" rel="nofollow">例子</a></li></ul> </li><li><a href="#light%E4%BA%AE" rel="nofollow">Light亮</a> 
   <ul><li><a href="#%E4%BD%BF%E7%94%A8" rel="nofollow">使用</a></li><li><a href="#%E9%87%8D%E8%A6%81%E7%9A%84%E5%87%BD%E6%95%B0-14" rel="nofollow">重要的函数</a></li><li><a href="#%E4%BE%8B%E5%AD%90-23" rel="nofollow">例子</a></li></ul> </li></ul> 
</div> 
<p></p> 
<h2 id="general一般">General（一般）</h2> 
<p><strong>假设你已经熟悉基本的Lua</strong></p> 
<p>一个组件(component)是一些为预设件（prefabs）准备的代码, <br> 通常组件是来描述一个单一的属性（例：生命，饥饿，攻击）, <br> 允许在一个预设件上用各种各样的创意组合各种组件， <br> 仍然困惑于这段句话吗?<a href="http://forums.kleientertainment.com/topic/25850-wots-the-diff-prefabs-components-stategraphs-and-brains/" rel="nofollow">去看它们的不同点</a></p> 
<p>要使用一个组件,你首先需要将它添加到你的预设件:</p> 
<pre class="prettyprint"><code class="language-lua hljs ">inst:AddComponent(<span class="hljs-string">"MyComponent"</span>)</code></pre> 
<p>然后你可以自定义具体的细节:</p> 
<pre class="prettyprint"><code class="language-lua hljs ">inst.components.MyComponent.maxvalue = <span class="hljs-number">100</span>
inst.components.MyComponent:SetSomething(<span class="hljs-keyword">true</span>)</code></pre> 
<p>如果组件有提供,当你需要时你可以访问该组件的某个函数，或给组件设置一组函数:</p> 
<pre class="prettyprint"><code class="language-lua hljs ">inst.components.MyComponent:BeFun() <span class="hljs-comment">--prepared function</span>
inst.components.MyComponent.befunfn = BackflipFn <span class="hljs-comment">--set a function</span></code></pre> 
<p>这些只是理论,选择看下面一些有意义的例子! 或者最好直接去看游戏数据!</p> 
<h2 id="armor护甲">Armor（护甲）</h2> 
<p>这个组件可以使你的盔甲,具有减少玩家全部或某些类型的伤害的功能. <br> 遗憾的是,该组件还意味着有耐久性。</p> 
<h3 id="重要的变量">重要的变量</h3> 
<p><code>tags</code>: <br> 标签——盔甲标签只有一个效果，可以抵御有一个的相同的标签的攻击。 <br> （table）</p> 
<p><code>onfinished</code>: <br> 移除护甲–理论上你可以使用这个更换装备或重置属性。 <br> (function)</p> 
<p><code>ontakedamage</code>: <br> 当受到伤害时触发</p> 
<h3 id="重要的函数">重要的函数</h3> 
<p><code>InitCondition(amount, absorb_percent)</code> <br> 初始化护甲，设置耐久度（num amount ），减伤百分比（num absorb_percent)</p> 
<p><code>SetCondition(amount)</code> <br> 设置耐久度（num amount ）</p> 
<h3 id="例子">例子</h3> 
<p><code>hats.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ruinshat_proc</span><span class="hljs-params">(inst, owner)</span></span> <span class="hljs-comment">-- forcefield when hit</span>
    inst:AddTag(<span class="hljs-string">"forcefield"</span>)
    inst.components.armor:SetAbsorption(TUNING.FULL_ABSORPTION)
    [....]

    inst.components.armor.ontakedamage = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(inst, damage_amount)</span></span>
        <span class="hljs-keyword">if</span> owner <span class="hljs-keyword">then</span>
            <span class="hljs-keyword">local</span> sanity = owner.components.sanity
            <span class="hljs-keyword">if</span> sanity <span class="hljs-keyword">then</span>
                <span class="hljs-keyword">local</span> unsaneness = damage_amount * TUNING.ARMOR_RUINSHAT_DMG_AS_SANITY
                sanity:DoDelta(-unsaneness, <span class="hljs-keyword">false</span>)
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>

    inst.active = <span class="hljs-keyword">true</span>

    owner:DoTaskInTime(TUNING.ARMOR_RUINSHAT_DURATION, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
        [...]
        <span class="hljs-keyword">if</span> inst:IsValid() <span class="hljs-keyword">then</span>
            inst:RemoveTag(<span class="hljs-string">"forcefield"</span>)
            inst.components.armor.ontakedamage = <span class="hljs-keyword">nil</span>
            inst.components.armor:SetAbsorption(TUNING.ARMOR_RUINSHAT_ABSORPTION)
            owner:DoTaskInTime(TUNING.ARMOR_RUINSHAT_COOLDOWN, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> inst.active = <span class="hljs-keyword">false</span> <span class="hljs-keyword">end</span>)
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tryproc</span><span class="hljs-params">(inst, owner)</span></span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inst.active <span class="hljs-keyword">and</span> <span class="hljs-built_in">math</span>.random() &lt; TUNING.ARMOR_RUINSHAT_PROC_CHANCE <span class="hljs-keyword">then</span>
       ruinshat_proc(inst, owner)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ruins_onunequip</span><span class="hljs-params">(inst, owner)</span></span>
    [...]
    owner:RemoveEventCallback(<span class="hljs-string">"attacked"</span>, inst.procfn)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ruins_onequip</span><span class="hljs-params">(inst, owner)</span></span>
    [....]
    inst.procfn = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> tryproc(inst, owner) <span class="hljs-keyword">end</span>
    owner:ListenForEvent(<span class="hljs-string">"attacked"</span>, inst.procfn)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ruins</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">local</span> inst = simple()
    inst:AddComponent(<span class="hljs-string">"armor"</span>)
    inst.components.armor:InitCondition(TUNING.ARMOR_RUINSHAT, TUNING.ARMOR_RUINSHAT_ABSORPTION)

    inst.components.equippable:SetOnEquip(ruins_onequip)
    inst.components.equippable:SetOnUnequip(ruins_onunequip)

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="beard胡子">Beard(胡子）</h2> 
<p>这个组件使你的生物有胡子，绝燃和剃须必须自己编码。</p> 
<h3 id="重要变量">重要变量</h3> 
<p><code>callbacks</code>： <br> 回调表–插入每天胡子的变化状态,一个函数 <br> （table）</p> 
<p><code>prize</code>: <br> 剃须奖励物品名，通常是“beardhair” <br> （string）</p> 
<p><code>bits</code>: <br> 奖励数量 <br> （num）</p> 
<p><code>canshavetest</code>: <br> 限制能否剃须，返回布尔值与原因 <br> （fn [ret] bln,str)</p> 
<p><code>onreset</code>: <br> 重置函数，（例：被火烧毁） <br> （fn）</p> 
<h3 id="重要函数">重要函数</h3> 
<p><code>Reset()</code> <br> –重置，状态回到零天</p> 
<h3 id="例子-1">例子</h3> 
<p><code>beefalo.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetStatus</span><span class="hljs-params">(inst)</span></span>
    <span class="hljs-keyword">if</span> inst.components.follower.leader ~= <span class="hljs-keyword">nil</span> <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"FOLLOWER"</span>
    <span class="hljs-keyword">elseif</span> inst.components.beard <span class="hljs-keyword">and</span> inst.components.beard.bits == <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"NAKED"</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [....]
    <span class="hljs-keyword">local</span> hair_growth_days = <span class="hljs-number">3</span>

    inst:AddComponent(<span class="hljs-string">"beard"</span>)
    <span class="hljs-comment">-- assume the beefalo has already grown its hair</span>
    inst.components.beard.bits = <span class="hljs-number">3</span>
    inst.components.beard.daysgrowth = hair_growth_days + <span class="hljs-number">1</span>
    inst.components.beard.onreset = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>
        inst.sg:GoToState(<span class="hljs-string">"shaved"</span>)
    <span class="hljs-keyword">end</span>

    inst.components.beard.canshavetest = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inst.components.sleeper:IsAsleep() <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>, <span class="hljs-string">"AWAKEBEEFALO"</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span> <span class="hljs-keyword">end</span>

    inst.components.beard.prize = <span class="hljs-string">"beefalowool"</span>
    inst.components.beard:AddCallback(<span class="hljs-number">0</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> <span class="hljs-comment">-- same as callbacks[0] = function()</span>
        <span class="hljs-keyword">if</span> inst.components.beard.bits == <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
            anim:SetBuild(<span class="hljs-string">"beefalo_shaved_build"</span>)
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>)
    inst.components.beard:AddCallback(hair_growth_days, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> <span class="hljs-comment">--do that for every individual state</span>
        <span class="hljs-keyword">if</span> inst.components.beard.bits == <span class="hljs-number">0</span> <span class="hljs-keyword">then</span>
            inst.hairGrowthPending = <span class="hljs-keyword">true</span> <span class="hljs-comment">--for stategraph</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>)

    [...]
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="burnable可燃的">Burnable(可燃的）</h2> 
<p>该组件允许你的预设物可以点燃和燃烧。这并不包括蔓延! (参见propagator（传播算子))</p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-comment">--注意,对于标准的物品，可以使用</span>
MakeSmallBurnable(inst, time, offset)
MakeMediumBurnable(inst, time, offset)  
MakeLargeBurnable(inst, time, offset)  
<span class="hljs-comment">--对于标准的动物，可以使用</span>
MakeSmallBurnableCharacter(inst,  sym, offset)
MakeMediumBurnableCharacter(inst, sym, offset)
MakeLargeBurnableCharacter(inst, sym, offset)</code></pre> 
<h3 id="重要的变量-1">重要的变量</h3> 
<p><code>burntime</code>: <br> 默认nil <br> – 要多长时间完全燃烧 <br> （num）</p> 
<p><code>onignite</code>: <br> 默认nil <br> –当着火时调用 <br> （fn）</p> 
<p><code>onextinguish</code>: <br> 默认nil <br> – 当不再着火时调用 <br> （fn）</p> 
<p><code>onburnt</code>: <br> 默认nil <br> – 当燃烧完成时调用 <br> （fn）</p> 
<p><code>canlight</code>: <br> 默认true <br> –能否被点燃 <br> （bln）</p> 
<p><code>burning</code>: <br> –是否在燃烧 <br> （bln）</p> 
<h3 id="重要的函数-1">重要的函数</h3> 
<p><code>AddBurnFX(prefab, offset, followsymbol)</code> <br> –增加特效</p> 
<p><code>SetFXLevel(level, percent)</code> <br> –改变火的强度</p> 
<p><code>Ignite(immediate)</code> <br> – 立即燃烧</p> 
<p><code>Extinguish()</code> <br> –停止燃烧</p> 
<h3 id="例子-2">例子</h3> 
<p><code>firepit.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onignite</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--when you make a fire, you can cook</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inst.components.cooker <span class="hljs-keyword">then</span>
        inst:AddComponent(<span class="hljs-string">"cooker"</span>)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onextinguish</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--remember to un-do the cooking!</span>
    <span class="hljs-keyword">if</span> inst.components.cooker <span class="hljs-keyword">then</span>
        inst:RemoveComponent(<span class="hljs-string">"cooker"</span>)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst.components.burnable:AddBurnFX(<span class="hljs-string">"campfirefire"</span>, Vector3(<span class="hljs-number">0</span>,<span class="hljs-number">.4</span>,<span class="hljs-number">0</span>) ) <span class="hljs-comment">--the firepit has its own fx</span>
    inst:ListenForEvent(<span class="hljs-string">"onextinguish"</span>, onextinguish) <span class="hljs-comment">--this isn't the optimal way to do it, but it works too</span>
    inst:ListenForEvent(<span class="hljs-string">"onignite"</span>, onignite)

    inst.components.fueled:SetUpdateFn( <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span> <span class="hljs-comment">--fueled component handles consumption</span>
        <span class="hljs-keyword">if</span> GetSeasonManager() <span class="hljs-keyword">and</span> GetSeasonManager():IsRaining() <span class="hljs-keyword">then</span>
            inst.components.fueled.rate = <span class="hljs-number">1</span> + TUNING.FIREPIT_RAIN_RATE*GetSeasonManager():GetPrecipitationRate()
        <span class="hljs-keyword">else</span>
            inst.components.fueled.rate = <span class="hljs-number">1</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>)
<span class="hljs-keyword">end</span>
</code></pre> 
<p>注意：<code>firepit</code> 不会在烧焦时明确的移除它自己，不像<code>campfire</code>，如上面所说的，<code>fueled</code> 组件会帮你处理细节.</p> 
<h2 id="container容器">Container（容器）</h2> 
<p>这个组件可以让你的预设物可以接受主角给予物品（就像锅子或箱子一样），此外还有一个库存（<code>inventory</code>）组件，但是那个十分适合角色。</p> 
<h3 id="重要的变量-2">重要的变量</h3> 
<p><code>numslots</code>: <br> 默认0 <br> ——你的预设物能够接受多少项目 <br> (num)</p> 
<p><code>widgetslotpos</code>: <br> 在这里设置的格子的位置(相对位置) <br> （table （Vector3））</p> 
<p><code>canbeopened</code>: <br> 默认true <br> ——能否打开 <br> （bln）</p> 
<p><code>acceptsstacks</code>: <br> 默认true <br> –不接受整堆的物品 <br> （bln）</p> 
<p><code>type</code>: <br> 默认”chest” <br> ——不能同时打开两个相同类型的箱子 <br> （str）</p> 
<p><code>widgetanimbank / widgetanimbuild</code>: <br> 视觉背景 <br> （str）</p> 
<p><code>widgetpos</code>: <br> (相对屏幕)的位置 <br> （ Vector3）</p> 
<p><code>side_align_tip</code>: <br> 未知的效果,但需要 <br> （num）</p> 
<p><code>itemtestfn</code>: <br> 能否进入 <br> （fn）</p> 
<p><code>widgetbuttoninfo</code>: <br> 这是一个交互式按钮 <br> （table（ widget））</p> 
<p><code>onopenfn / onclosefn</code>: <br> 当打开/关闭时调用,只有在这个物品里有效 <br> （fn）</p> 
<h3 id="重要的函数-2">重要的函数</h3> 
<p><code>IsFull()/IsEmpty()</code> <br> –返回true 或 false</p> 
<p><code>DropEverything()</code> <br> – 把箱子里的所有物品弹出</p> 
<p><code>DestroyContents()</code> <br> – 销毁里面所有的物品</p> 
<p><code>GiveItem(item, slot, src_pos, drop_on_fail, skipsound)</code> <br> –把物品给予给箱子，注意参数item是一个实例</p> 
<p><code>GetItemInSlot(slot)</code> <br> –返回slot里的实例</p> 
<p><code>Close()</code> <br> –关闭</p> 
<p><code>FindItems(fn)</code> <br> – 返回能够导致fn返回true的项目</p> 
<p><code>Has(item, amount)</code> <br> – 返回是否具有该数量的物品</p> 
<p><code>ConsumeByName(item, amount)</code> <br> – 删除指定数量的项目</p> 
<h3 id="例子-3">例子</h3> 
<p><code>cookpot.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> slotpos = {    Vector3(<span class="hljs-number">0</span>,<span class="hljs-number">64</span>+<span class="hljs-number">32</span>+<span class="hljs-number">8</span>+<span class="hljs-number">4</span>,<span class="hljs-number">0</span>), <span class="hljs-comment">--this table has the four slots' positions in form of Vector3(x,y,z)</span>
                    Vector3(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>+<span class="hljs-number">4</span>,<span class="hljs-number">0</span>),
                    Vector3(<span class="hljs-number">0</span>,-(<span class="hljs-number">32</span>+<span class="hljs-number">4</span>),<span class="hljs-number">0</span>),
                    Vector3(<span class="hljs-number">0</span>,-(<span class="hljs-number">64</span>+<span class="hljs-number">32</span>+<span class="hljs-number">8</span>+<span class="hljs-number">4</span>),<span class="hljs-number">0</span>)}

<span class="hljs-keyword">local</span> widgetbuttoninfo = { <span class="hljs-comment">--the cook button (optional)</span>
    text = <span class="hljs-string">"Cook"</span>,
    position = Vector3(<span class="hljs-number">0</span>, -<span class="hljs-number">165</span>, <span class="hljs-number">0</span>),
    fn = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--when clicked</span>
        inst.components.stewer:StartCooking()    
    <span class="hljs-keyword">end</span>,

    validfn = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--can it be clicked?</span>
        <span class="hljs-keyword">return</span> inst.components.stewer:CanCook()
    <span class="hljs-keyword">end</span>,
}

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">itemtest</span><span class="hljs-params">(inst, item, slot)</span></span> <span class="hljs-comment">--test whether the item is cookable</span>
    <span class="hljs-keyword">if</span> cooking.IsCookingIngredient(item.prefab) <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onopen</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--some fancy stuff</span>
    inst.AnimState:PlayAnimation(<span class="hljs-string">"cooking_pre_loop"</span>, <span class="hljs-keyword">true</span>)
    inst.SoundEmitter:PlaySound(<span class="hljs-string">"dontstarve/common/cookingpot_open"</span>, <span class="hljs-string">"open"</span>)
    inst.SoundEmitter:PlaySound(<span class="hljs-string">"dontstarve/common/cookingpot"</span>, <span class="hljs-string">"snd"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onclose</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--more fancy stuff</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> inst.components.stewer.cooking <span class="hljs-keyword">then</span>
        inst.AnimState:PlayAnimation(<span class="hljs-string">"idle_empty"</span>)
        inst.SoundEmitter:KillSound(<span class="hljs-string">"snd"</span>)
    <span class="hljs-keyword">end</span>
    inst.SoundEmitter:PlaySound(<span class="hljs-string">"dontstarve/common/cookingpot_close"</span>, <span class="hljs-string">"close"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"container"</span>)
    inst.components.container.itemtestfn = itemtest <span class="hljs-comment">--can it take that item?</span>
    inst.components.container:SetNumSlots(#slotpos) <span class="hljs-comment">--how many slots must it consider?</span>
    inst.components.container.widgetslotpos = slotpos <span class="hljs-comment">--where shall it display those slots?</span>
    inst.components.container.widgetanimbank = <span class="hljs-string">"ui_cookpot_1x4"</span> <span class="hljs-comment">--background</span>
    inst.components.container.widgetanimbuild = <span class="hljs-string">"ui_cookpot_1x4"</span>
    inst.components.container.widgetpos = Vector3(<span class="hljs-number">200</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-comment">--where is the entire GUI?</span>
    inst.components.container.side_align_tip = <span class="hljs-number">100</span> <span class="hljs-comment">--??? just set it anyways</span>
    inst.components.container.widgetbuttoninfo = widgetbuttoninfo <span class="hljs-comment">--this is needed for a button</span>
    inst.components.container.acceptsstacks = <span class="hljs-keyword">false</span> <span class="hljs-comment">--it wants only four ingredients!</span>
    inst.components.container.<span class="hljs-built_in">type</span> = <span class="hljs-string">"cooker"</span> <span class="hljs-comment">--let chests open parallel to it</span>

    inst.components.container.onopenfn = onopen <span class="hljs-comment">--for that fancy stuff</span>
    inst.components.container.onclosefn = onclose
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="cookable烹饪">Cookable(烹饪)</h2> 
<p>该组件能够让你的物品能够被烹饪。</p> 
<h3 id="重要的变量-3">重要的变量</h3> 
<p><code>product</code>: <br> 煮熟时得到什么物品 <br> （str或fn)</p> 
<p><code>oncooked</code>： <br> 在煮熟时调用。 <br> (fn)</p> 
<h3 id="例子-4">例子</h3> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultfn</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">local</span> inst = commonfn()
    [...]

    inst:AddComponent(<span class="hljs-string">"cookable"</span>)
    inst.components.cookable.product = <span class="hljs-string">"tallbirdegg_cooked"</span>

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>


</code></pre> 
<h2 id="dapperness衣衫褴褛">Dapperness(衣衫褴褛)</h2> 
<p>顾名思义，给物品一个不整洁的标签，可以按一定的速度减少人物的san值.</p> 
<h3 id="重要的变量-4">重要的变量</h3> 
<p><code>dapperness</code>: <br> 默认 0 速度 <br> （num）</p> 
<p><code>dapperfn</code>: <br> 每当减少时调用 <br> （fn）</p> 
<h3 id="例子-5">例子</h3> 
<p><code>sweatervest.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]

    inst:AddComponent(<span class="hljs-string">"dapperness"</span>)
    inst.components.dapperness.dapperness = TUNING.DAPPERNESS_MED

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="eater吃者">Eater(吃者)</h2> 
<p>让你的预设物（通常是一个标准的动物）可以食用带有Edible（可食用的）组件的物品。</p> 
<h3 id="重要的变量-5">重要的变量</h3> 
<p><code>strongstomach</code>: <br> 默认false，是否可以吃有毒的东东</p> 
<p><code>foodprefs</code>: <br> 所有能过吃的物品列表 <br> （table ）</p> 
<p><code>oneatfn</code>： <br> 当食用时调用 <br> （fn）</p> 
<p><code>lasteattime</code>： <br> 上一次吃东东是什么时候 <br> （num（GetTime() ））</p> 
<p><code>ignoresspoilage</code>: <br> 默认false，忽略变质 <br> （bln）</p> 
<p><code>caneattest</code>： <br> 指定什么可以吃（返回true时） <br> （fn）</p> 
<h3 id="重要的函数-3">重要的函数</h3> 
<p><code>TimeSinceLastEating()</code> <br> –类似lasteattime，你可以用它来确定什么时候可以开始吃.</p> 
<h3 id="基本的食物类型">基本的食物类型</h3> 
<p>GENERIC, <br> VEGGIE, <br> MEAT, <br> INSECT, <br> SEEDS, <br> WOOD, <br> ELEMENTAL (矿物), <br> HORRIBLE (你不想知道的)</p> 
<h3 id="例子-6">例子</h3> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OnEat</span><span class="hljs-params">(inst, food)</span></span> <span class="hljs-comment">--these are special food-effects</span>
    <span class="hljs-keyword">if</span> food.components.edible
       <span class="hljs-keyword">and</span> food.components.edible.foodtype == <span class="hljs-string">"MEAT"</span> <span class="hljs-comment">--edible food has these types too</span>
       <span class="hljs-keyword">and</span> inst.components.werebeast
       <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> inst.components.werebeast:IsInWereState() <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">if</span> food.components.edible:GetHealth() &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-comment">--monster meat does bad stuff</span>
            inst.components.werebeast:TriggerDelta(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">if</span> food.components.edible <span class="hljs-keyword">and</span> food.components.edible.foodtype == <span class="hljs-string">"VEGGIE"</span> <span class="hljs-keyword">then</span> <span class="hljs-comment">--poop</span>
        <span class="hljs-keyword">local</span> poo = SpawnPrefab(<span class="hljs-string">"poop"</span>)
        poo.Transform:SetPosition(inst.Transform:GetWorldPosition())        
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"eater"</span>)
    inst.components.eater:SetOmnivore() <span class="hljs-comment">-- all standard foodtypes besides wood, elemental and horrible</span>
    inst.components.eater:SetCanEatHorrible() <span class="hljs-comment">--add horrible</span>
    inst.components.eater.strongstomach = <span class="hljs-keyword">true</span> <span class="hljs-comment">-- can eat monster meat</span>
    inst.components.eater:SetOnEatFn(OnEat)

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="edible可食用的">Edible（可食用的）</h2> 
<p>能够让你的物品（通常是标准的物品）可以被食用。</p> 
<h3 id="重要的变量-6">重要的变量</h3> 
<p><code>healthvalue</code>: <br> 默认10 <br> –增加的生命</p> 
<p><code>hungervalue</code>: <br> 默认10 <br> –增加的饥饿</p> 
<p><code>sanityvalue</code>: <br> 默认 0 <br> –增加的san</p> 
<p><code>foodtype</code>: <br> 默认”GENERIC” <br> –孰能孰否</p> 
<h3 id="例子-7">例子</h3> 
<p><code>custom</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst.components.edible.foodtype = <span class="hljs-string">"MyFoodType"</span> <span class="hljs-comment">--there's default ones in eater.lua</span>
    inst.components.edible.healthvalue = -<span class="hljs-number">10</span> <span class="hljs-comment">--can hurt</span>
    inst.components.edible.hungervalue = <span class="hljs-number">0</span>
    inst.components.edible.sanityvalue = <span class="hljs-number">40</span>

    inst.components.edible.stale_health = <span class="hljs-number">2</span> <span class="hljs-comment">--you can set multiplier, in this case it hurts twice as much</span>
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="equippable可装备的">Equippable(可装备的）</h2> 
<p>能够让你的物品（通常是一个标准的装备）可以被持有或者穿戴，当然，你需要一个可交互的动画来显示。</p> 
<h3 id="重要的变量-7">重要的变量</h3> 
<p><code>equipslot</code>: <br> 默认EQUIPSLOTS.HANDS <br> 装备位置 <br> （EQUIPSLOTS.*）</p> 
<p><code>equipstack</code>: <br> 默认false <br> 是否需要投掷（像吹箭） <br> (bln)</p> 
<p><code>isequipped</code>: <br> 装备是否正在装备（只读） <br> （bln）</p> 
<p><code>onequipfn/onunequipfn</code>: <br> 默认nil， <br> 在装备时或者卸装时调用 <br> （fn）</p> 
<p><code>walkspeedmult</code>: <br> 默认nil， <br> 加快或减慢穿戴者 <br> （num）</p> 
<h3 id="例子-8">例子</h3> 
<p><code>axe.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onequip</span><span class="hljs-params">(inst, owner)</span></span> <span class="hljs-comment">--visual stuff</span>
    owner.AnimState:OverrideSymbol(<span class="hljs-string">"swap_object"</span>, <span class="hljs-string">"swap_axe"</span>, <span class="hljs-string">"swap_axe"</span>)
    owner.AnimState:Show(<span class="hljs-string">"ARM_carry"</span>)
    owner.AnimState:Hide(<span class="hljs-string">"ARM_normal"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onunequip</span><span class="hljs-params">(inst, owner)</span></span> <span class="hljs-comment">--visual stuff</span>
    owner.AnimState:Hide(<span class="hljs-string">"ARM_carry"</span>)
    owner.AnimState:Show(<span class="hljs-string">"ARM_normal"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"equippable"</span>)
    <span class="hljs-comment">--don't need equipslot, as it is hands by default</span>
    inst.components.equippable:SetOnEquip(onequip) <span class="hljs-comment">--always remember to set your functions</span>
    inst.components.equippable:SetOnUnequip(onunequip)
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="finite-uses耐久">Finite Uses(耐久）</h2> 
<p>限定物品（通常是一个标准的装备）的使用次数。</p> 
<h3 id="重要的变量-8">重要的变量</h3> 
<p><code>total</code>: <br> 默认100 <br> –最大使用次数</p> 
<p><code>current</code>: <br> 默认100 <br> – 当前还剩多少</p> 
<p><code>onfinished</code>: <br> 当耐久完了之后调用（注意，不会自动的删除它本身，你要显式调用）</p> 
<h3 id="重要的函数-4">重要的函数</h3> 
<p><code>Use(num)</code> <br> 设置当前耐久</p> 
<p><code>SetConsumption(action, uses)</code> <br> 设置各种行动所需的耐久度</p> 
<h3 id="例子-9">例子</h3> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onfinished</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--remember, it doesn't dissappear per default</span>
    inst:Remove()
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"finiteuses"</span>)
    inst.components.finiteuses:SetMaxUses(TUNING.AXE_USES) <span class="hljs-comment">--does the same as total = ...</span>
    inst.components.finiteuses:SetUses(TUNING.AXE_USES) <span class="hljs-comment">--it loads the saved usage afterwards, does the same as current = ...</span>
    inst.components.finiteuses:SetOnFinished( onfinished) <span class="hljs-comment">--does the same as onfinished = ...</span>
    inst.components.finiteuses:SetConsumption(ACTIONS.CHOP, <span class="hljs-number">1</span>) <span class="hljs-comment">--it loses durability for chopping</span>
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="harvestable收获">Harvestable（收获）</h2> 
<p>可以让你的组件可以生产物品。</p> 
<h3 id="重要的变量-9">重要的变量</h3> 
<p><code>produce</code>: <br> 默认0 <br> –当前拥有多少物品 <br> （num）</p> 
<p><code>growtime</code>: <br> 默认nil <br> 多长时间</p> 
<p><code>product</code>: <br> 默认nil <br> 生产什么</p> 
<p><code>maxproduce</code>: <br> 默认1 <br> 可以容纳多少产品</p> 
<h3 id="重要的函数-5">重要的函数</h3> 
<p><code>SetUp(product, max, time, onharvest, ongrow)</code> <br> 初始化</p> 
<p><code>Grow()</code> <br> 立刻生长完成</p> 
<p><code>StartGrowing(time)\StopGrowing()</code> <br> 开始\停止生长</p> 
<h3 id="例子-10">例子</h3> 
<p><code>beebox.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onchildgoinghome</span><span class="hljs-params">(inst, data)</span></span> <span class="hljs-comment">--when the bees come home...</span>
    <span class="hljs-keyword">if</span> data.child <span class="hljs-keyword">and</span> data.child.components.pollinator <span class="hljs-keyword">and</span> data.child.components.pollinator:HasCollectedEnough() <span class="hljs-keyword">then</span> <span class="hljs-comment">--and they bring pollen...</span>
        <span class="hljs-keyword">if</span> inst.components.harvestable <span class="hljs-keyword">then</span>
            inst.components.harvestable:Grow() <span class="hljs-comment">--make honey</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"harvestable"</span>)
    inst.components.harvestable:SetUp(<span class="hljs-string">"honey"</span>, <span class="hljs-number">6</span>, <span class="hljs-keyword">nil</span>, onharvest, updatelevel)
    inst:ListenForEvent(<span class="hljs-string">"childgoinghome"</span>, onchildgoinghome) <span class="hljs-comment">--when the bees bring pollen...</span>

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="health生命">Health（生命）</h2> 
<p>为你的事物（通常是标准的动物或人物）增加一个生命属性。 <br> 如果该事物拥有combat（攻击）组件的话，这个是必须的.</p> 
<h3 id="重要的变量-10">重要的变量</h3> 
<p><code>minhealth</code>: <br> 默认0 <br> – 如果设置这个变量&gt;0，你的动物将不会死亡。</p> 
<p><code>invincible</code>: <br> 默认false <br> – 无敌模式</p> 
<p><code>vulnerabletoheatdamage</code>: <br> 默认true <br> – 能否被烧伤</p> 
<p><code>fire\_damage\_scale</code>: <br> 默认1 <br> – 烧伤的比例</p> 
<p><code>nofadeout</code>: <br> 默认false <br> – 动画效果，死亡时是否直接删除而不会躺下</p> 
<p><code>absorb</code>: <br> 0 <br> –天生的护甲值</p> 
<p><code>canmurder</code>: <br> true <br> – 能否被谋杀</p> 
<p><code>murdersound</code>: <br> string <br> – 当死亡时声音路径</p> 
<p><code>canheal</code>: <br> true <br> – 能否治疗</p> 
<p><code>redirect</code>: <br> function <br> – 在治疗或受伤时调用（重新定义如何受伤或治疗）</p> 
<h3 id="重要的函数-6">重要的函数</h3> 
<p><code>SetMaxHealth(amount)</code> <br> – 设置最大值</p> 
<p><code>DoDelta(amount, overtime, cause, ignore_invincible)</code> <br> –更改状态</p> 
<p><code>Kill()</code> <br> – 杀死它</p> 
<h3 id="例子-11">例子</h3> 
<p><code>slurper.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"health"</span>)
    inst.components.health:SetMaxHealth(<span class="hljs-number">200</span>)
    inst.components.health.canmurder = <span class="hljs-keyword">false</span> <span class="hljs-comment">-- can't kill, eventhough it's in the inventory</span>
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="hunger饥饿">Hunger(饥饿）</h2> 
<p>可以让你的事物（通常是一个标准的动物或者人物）获得饥饿的属性，这个整个饥荒游戏的中心慨念</p> 
<h3 id="重要的变量-11">重要的变量</h3> 
<p><code>max</code>: <br> 默认100 <br> – 你的事物能够食用多少的物品</p> 
<p><code>hungerrate,hurtrate</code>: <br> 默认1 <br> – 饥饿的速度</p> 
<p><code>burning</code>: <br> 默认 true <br> – 是否会饿</p> 
<p><code>period</code>: <br> 默认1 <br> – 减低饥饿值的间隔</p> 
<h3 id="例子-12">例子</h3> 
<p><code>smallbird.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetStatus</span><span class="hljs-params">(inst)</span></span>
    <span class="hljs-keyword">if</span> inst.components.hunger <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">if</span> inst.components.hunger:IsStarving(inst) <span class="hljs-keyword">then</span>
            <span class="hljs-keyword">return</span> <span class="hljs-string">"STARVING"</span>
        <span class="hljs-keyword">elseif</span> inst.components.hunger:GetPercent() &lt; <span class="hljs-number">.5</span> <span class="hljs-keyword">then</span>
            <span class="hljs-keyword">return</span> <span class="hljs-string">"HUNGRY"</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetPeepChance</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--they get louder to show their hunger</span>
    <span class="hljs-keyword">local</span> peep_percent = <span class="hljs-number">0.1</span>
    <span class="hljs-keyword">if</span> inst.components.hunger <span class="hljs-keyword">then</span>
        <span class="hljs-keyword">if</span> inst.components.hunger:IsStarving() <span class="hljs-keyword">then</span>
            peep_percent = <span class="hljs-number">1</span>
        <span class="hljs-keyword">elseif</span> inst.components.hunger:GetPercent() &lt; <span class="hljs-number">.25</span> <span class="hljs-keyword">then</span>
            peep_percent = <span class="hljs-number">0.9</span>
        <span class="hljs-keyword">elseif</span> inst.components.hunger:GetPercent() &lt; <span class="hljs-number">.5</span> <span class="hljs-keyword">then</span>
            peep_percent = <span class="hljs-number">0.75</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">return</span> peep_percent
<span class="hljs-keyword">end</span>


<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"hunger"</span>)

    inst.components.hunger:SetMax(TUNING.SMALLBIRD_HUNGER)
    inst.components.hunger:SetRate(TUNING.SMALLBIRD_HUNGER/TUNING.SMALLBIRD_STARVE_TIME)
    inst.components.hunger:SetKillRate(TUNING.SMALLBIRD_HEALTH/TUNING.SMALLBIRD_STARVE_KILL_TIME)

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>

</code></pre> 
<h2 id="insulator保暖">Insulator(保暖）</h2> 
<p>让你的物品（通常是一个标准的装备）拥有保暖功能。可以降低temperature（温度）组件对人物的影响。</p> 
<h3 id="重要的变量-12">重要的变量</h3> 
<p><code>insulation</code>: <br> 默认 0 <br> –整个组件就是这个变量.</p> 
<h3 id="例子-13">例子</h3> 
<p><code>sweatervest.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
inst:AddComponent(<span class="hljs-string">"insulator"</span>)
inst.components.insulator.insulation = TUNING.INSULATION_SMALL
</code></pre> 
<h2 id="inventory-item可存放">Inventory-Item（可存放）</h2> 
<p>可以让你的物品可以被捡起存放进物品栏。通常这个组件不需要任何的设置，一切保持默认最好。</p> 
<h3 id="重要的变量-13">重要的变量</h3> 
<p><code>canbepickedup</code>: <br> 默认true <br> – 能够被捡起</p> 
<p><code>onpickupfn</code>: <br> function <br> – 当被捡起时调用</p> 
<p>cangoincontainer: <br> true <br> –能够进入容器</p> 
<p>keepondeath: <br> false <br> – 对于十分重要的角色项目或许有用?</p> 
<p>imagename <br> 在物品栏的图片名称</p> 
<p>atlasname <br> 图片的图集文件</p> 
<p>ondropfn <br> 掉落时调用 <br> 参数为 inst它本身</p> 
<p>onpickupfn <br> 捡起时调用</p> 
<p>onputininventoryfn <br> 放入物品栏时调用</p> 
<h3 id="重要的函数-7">重要的函数</h3> 
<p>GetContainer() <br> 返回拥有物品栏或者容器的实例 <br> 要返回它本身使用GetContainer().inst</p> 
<p>ChangeImageName(newname) <br> 改变图片</p> 
<h3 id="例子-14">例子</h3> 
<p>heatrock.lua</p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UpdateImages</span><span class="hljs-params">(inst, range)</span></span> <span class="hljs-comment">--this is called by another component</span>
    inst.currentTempRange = range
    inst.components.inventoryitem:ChangeImageName(<span class="hljs-string">"heat_rock"</span>..<span class="hljs-built_in">tostring</span>(range))
[...]
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inst</span><span class="hljs-params">()</span></span>
    [...]

    inst:AddComponent(<span class="hljs-string">"inventoryitem"</span>) <span class="hljs-comment">-- usually all you need to do...</span>
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="perishable腐败">Perishable(腐败)</h2> 
<p>让你的物品会随着时间的推移慢慢的腐败, <br> 注意,这个组件不会删除物品本身,除非你给它设置一个替换物</p> 
<h3 id="重要的变量-14">重要的变量</h3> 
<p>perishtime: <br> – 要多长时间才会完全的腐败 <br> number</p> 
<p>perishfn: <br> 当腐败后调用(在替换之前) <br> function </p> 
<p>onperishreplacement: <br> 替换物,可为空 <br> string </p> 
<h3 id="重要的函数-8">重要的函数</h3> 
<p>IsFresh(),IsStale(),IsSpoiled() <br> –返回true 或 false取决于当前的百分比</p> 
<p>GetPercent() <br> 返回一个介于0到1 之间的数字</p> 
<p>SetPercent(percent) <br> 设置百分比</p> 
<p>ReducePercent(amount) <br> 减低百分比</p> 
<p>StartPerishing(),StopPerishing() <br> 开始/结束 腐败</p> 
<h3 id="例子-15">例子</h3> 
<p>petals.lua</p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    <span class="hljs-keyword">local</span> inst = CreateEntity()
    [...]

    inst:AddComponent(<span class="hljs-string">"perishable"</span>)
    inst.components.perishable:SetPerishTime(TUNING.PERISH_FAST)
    inst.components.perishable:StartPerishing()
    inst.components.perishable.onperishreplacement = <span class="hljs-string">"spoiled_food"</span>

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="pickable可采摘">Pickable(可采摘)</h2> 
<p>这个组件类似Harvestable,不过可以移植.</p> 
<h3 id="重要的变量-15">重要的变量</h3> 
<p>regentime: <br> 再生需要多长时间 <br> number </p> 
<p>product: <br> 劳动果实 <br> string</p> 
<p>onregenfn,onpickedfn,makeemptyfn,makefullfn,makebarrenfn,ontransplantfn: <br> 当这些事件发生时调用 <br> functions</p> 
<p>max_cycles,cycles_left: <br> – 在缺肥前可以采摘多少 <br> numbers</p> 
<p>caninteractwith: <br> –能否采摘 <br> boolean </p> 
<p>numtoharvest: <br> –每次采摘有多少果实 <br> number</p> 
<p>quickpick: <br> 是否需要快速的采摘 <br> boolean </p> 
<h3 id="重要的函数-9">重要的函数</h3> 
<p>FinishGrowing() <br> 立即可收获</p> 
<p>Pause(),Resume() <br> 暂停/恢复 生长</p> 
<p>SetUp(product, regen, numbertoharvest) <br> 初始化</p> 
<p>IsBarren() <br> 返回需不需要果实</p> 
<p>MakeBarren() <br> 需要肥料!</p> 
<h3 id="例子-16">例子</h3> 
<p>carrot.lua</p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onpickedfn</span><span class="hljs-params">(inst)</span></span>
    inst:Remove()
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
   [....]

    inst:AddComponent(<span class="hljs-string">"pickable"</span>)
    inst.components.pickable.picksound = <span class="hljs-string">"dontstarve/wilson/pickup_plants"</span> <span class="hljs-comment">--you can define a sound</span>
    inst.components.pickable:SetUp(<span class="hljs-string">"carrot"</span>, <span class="hljs-number">10</span>)
    inst.components.pickable.onpickedfn = onpickedfn

    inst.components.pickable.quickpick = <span class="hljs-keyword">true</span> <span class="hljs-comment">-- carrots are picked quickly, not by fumbling around</span>

   <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<p>grass.lua</p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ontransplantfn</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--it starts off barren when planted</span>
    <span class="hljs-keyword">if</span> inst.components.pickable <span class="hljs-keyword">then</span>
        inst.components.pickable:MakeBarren()
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onregenfn</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--fancy stuff</span>
    inst.AnimState:PlayAnimation(<span class="hljs-string">"grow"</span>)
    inst.AnimState:PushAnimation(<span class="hljs-string">"idle"</span>, <span class="hljs-keyword">true</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makefullfn</span><span class="hljs-params">(inst)</span></span>
    inst.AnimState:PlayAnimation(<span class="hljs-string">"idle"</span>, <span class="hljs-keyword">true</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makebarrenfn</span><span class="hljs-params">(inst)</span></span>
    inst.AnimState:PlayAnimation(<span class="hljs-string">"idle_dead"</span>)
<span class="hljs-keyword">end</span>


<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onpickedfn</span><span class="hljs-params">(inst)</span></span>
    inst.SoundEmitter:PlaySound(<span class="hljs-string">"dontstarve/wilson/pickup_reeds"</span>)
    inst.AnimState:PlayAnimation(<span class="hljs-string">"picking"</span>)

    <span class="hljs-keyword">if</span> inst.components.pickable <span class="hljs-keyword">and</span> inst.components.pickable:IsBarren() <span class="hljs-keyword">then</span>
        inst.AnimState:PushAnimation(<span class="hljs-string">"idle_dead"</span>)
    <span class="hljs-keyword">else</span>
        inst.AnimState:PushAnimation(<span class="hljs-string">"picked"</span>)
    <span class="hljs-keyword">end</span>

<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeemptyfn</span><span class="hljs-params">(inst)</span></span>
    inst.AnimState:PlayAnimation(<span class="hljs-string">"picked"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
   [....]
    inst:AddComponent(<span class="hljs-string">"pickable"</span>)
    inst.components.pickable.picksound = <span class="hljs-string">"dontstarve/wilson/pickup_reeds"</span> <span class="hljs-comment">--you can define a sound</span>

    inst.components.pickable:SetUp(<span class="hljs-string">"cutgrass"</span>, TUNING.GRASS_REGROW_TIME)
    inst.components.pickable.onregenfn = onregenfn <span class="hljs-comment">--remember to set your funtions</span>
    inst.components.pickable.onpickedfn = onpickedfn
    inst.components.pickable.makeemptyfn = makeemptyfn
    inst.components.pickable.makebarrenfn = makebarrenfn
    inst.components.pickable.makefullfn = makefullfn
    inst.components.pickable.max_cycles = <span class="hljs-number">20</span> <span class="hljs-comment">--grass can be picked twenty times (that's a lot)</span>
    inst.components.pickable.cycles_left = <span class="hljs-number">20</span>   
    inst.components.pickable.ontransplantfn = ontransplantfn
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="propagator传播算子">Propagator(传播算子)</h2> 
<p>可以让你的物品可以传播火和热,即使它是不可燃的. <br> 注意:可以使用</p> 
<pre class="prettyprint"><code class="language-lua hljs ">MakeSmallPropagator(inst) 
MakeLargePropagator(inst) </code></pre> 
<p>改变传播速度</p> 
<h3 id="重要的变量-16">重要的变量</h3> 
<p>flashpoint: <br> 100 <br> –当它点燃</p> 
<p>currentheat: <br> 0 <br> –有多烫</p> 
<p>decayrate: <br> 1 <br> 冷却速度单位每秒</p> 
<p>propagaterange: <br> 3 <br> –火能传播多远</p> 
<p>heatoutput: <br> 5 <br> –热量损失速度 每秒</p> 
<p>damages: <br> false <br> –火能否伤害人物</p> 
<p>damagerange: <br> 3 <br> –火伤害距离</p> 
<p>acceptsheat: <br> false <br> 能否传播给另外的物品</p> 
<p>onflashpoint: <br> nil <br> –点燃时调用</p> 
<h3 id="重要的函数-10">重要的函数</h3> 
<p>Delay(time) <br> –延时</p> 
<p>StartSpreading() StopSpreading() <br> – 开始/停止传播热量</p> 
<p>AddHeat(amount) <br> 加热</p> 
<p>Flash() <br> 点燃</p> 
<h2 id="repairable可修理">Repairable(可修理)</h2> 
<p>这个组件可以让你的物品(通常是一个标准的装备)可以在使用后修理,恢复耐久. <br> 通常需要一个类似生命的组件来配合,如 Workable, Perishable ,都有这样的效果.</p> 
<h3 id="重要的变量-17">重要的变量</h3> 
<p>repairmaterial: <br> –需要的材料(不是预设物的名字) <br> string</p> 
<p>announcecanfix: <br> –在人物查看时是否可以知道可修理 <br> boolean </p> 
<p>onrepaired: <br> –修理时调用 <br> function </p> 
<h3 id="例子-17">例子</h3> 
<p><code>walls.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onrepaired</span><span class="hljs-params">(inst)</span></span>
    <span class="hljs-keyword">if</span> data.buildsound <span class="hljs-keyword">then</span> <span class="hljs-comment">--these functions are within a function for all types of walls, hence data</span>
        inst.SoundEmitter:PlaySound(data.buildsound)        
    <span class="hljs-keyword">end</span>
    makeobstacle(inst) <span class="hljs-comment">--assure the wall is an obstacle when it gets repaired</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
   [....]
    inst:AddComponent(<span class="hljs-string">"repairable"</span>)
    <span class="hljs-keyword">if</span> data.name == <span class="hljs-string">"ruins"</span> <span class="hljs-keyword">then</span>
        inst.components.repairable.repairmaterial = <span class="hljs-string">"thulecite"</span>
    <span class="hljs-keyword">else</span>
        inst.components.repairable.repairmaterial = data.name <span class="hljs-comment">--wood, stone or hay</span>
    <span class="hljs-keyword">end</span>
    inst.components.repairable.onrepaired = onrepaired
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="sanity-aurasan光环">Sanity-Aura(san光环)</h2> 
<p>可以影响附近人物的san值,这个组件十分容易使用,在装备上时自动调用,参考 <br> dapperness.</p> 
<h3 id="重要的变量-18">重要的变量</h3> 
<p>aura: <br> 0 <br> –速率 每秒 <br> num</p> 
<p>aurafn: <br> 用来限制影响的范围</p> 
<p>penalty: <br> 0 <br> 减少或增加多少san</p> 
<h2 id="talker话语者">Talker(话语者)</h2> 
<p>可以让你的事物(人物或者动物)可以说话,表现为在上方有一行字符.</p> 
<h3 id="重要的函数-11">重要的函数</h3> 
<p>ShutUp() <br> 停止说,做另外一些重要的事情.</p> 
<p>Say(script, time, noanim) <br> 说一些话 <br> script 可以 一个string或者table,包括另外两个变量.</p> 
<h3 id="例子-18">例子</h3> 
<p><code>custom</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greet</span><span class="hljs-params">(inst)</span></span>
    inst.components.talker:Say(<span class="hljs-string">"Good morning!"</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]

    inst.ListenForEvent(<span class="hljs-string">"daytime"</span>,greet)

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="tool工具">Tool(工具)</h2> 
<p>可以让你的物品(通常是装备)可以增加一些工具的功能. <br> 通常与 worker,workable 这两个组件相关.</p> 
<h3 id="重要的函数-12">重要的函数</h3> 
<p>SetAction(act, effectiveness) <br> –设置你的装备能干啥,当 effectiveness = nil是删除这一行动.</p> 
<h3 id="例子-19">例子</h3> 
<p><code>axe_pickaxe.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]

    inst:AddComponent(<span class="hljs-string">"tool"</span>)
    inst.components.tool:SetAction(ACTIONS.CHOP, <span class="hljs-number">1.33</span>)
    inst.components.tool:SetAction(ACTIONS.MINE, <span class="hljs-number">1.33</span>)

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span></code></pre> 
<h2 id="tradable交易">Tradable(交易)</h2> 
<p>这个组件可以让你的物品可以和交易员交易,当然你也可以设置一个黄金价格.</p> 
<h3 id="例子-20">例子</h3> 
<p><code>custom</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]
    inst:AddComponent(<span class="hljs-string">"tradable"</span>)
    inst.components.tradable.goldvalue = <span class="hljs-number">3</span> <span class="hljs-comment">--the pigking buys this</span>
    inst:AddComponent(<span class="hljs-string">"equippable"</span>)
    inst.components.equippable.equipslot = EQUIPSLOTS.HEAD <span class="hljs-comment">--pigmen can wear this</span>

    inst.components.equippable:SetOnEquip( onequip ) <span class="hljs-comment">--pretend this is for visual appearance</span>
    inst.components.equippable:SetOnUnequip( onunequip )

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="useable-item可使用的">Useable Item(可使用的)</h2> 
<p>这个组件可以让你的人物使用带有这个组件的物品,效果取决于你让他干什么,当别的组件不能满足时,才使用这个.</p> 
<h3 id="重要的变量-19">重要的变量</h3> 
<p>onusefn <br> 在人物开始使用时调用</p> 
<p>onstopusefn <br> 在人物停止使用时调用</p> 
<p>caninteractfn <br> 限制人物是否可以使用</p> 
<h3 id="例子-21">例子</h3> 
<p><code>hats.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs "><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stopusingbush</span><span class="hljs-params">(inst, data)</span></span>
    <span class="hljs-keyword">local</span> hat = inst.components.inventory <span class="hljs-keyword">and</span> inst.components.inventory:GetEquippedItem(EQUIPSLOTS.HEAD)
    <span class="hljs-keyword">if</span> hat <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> (data.statename == <span class="hljs-string">"hide_idle"</span> <span class="hljs-keyword">or</span> data.statename == <span class="hljs-string">"hide"</span>) <span class="hljs-keyword">then</span>
        hat.components.useableitem:StopUsingItem()
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onequipbush</span><span class="hljs-params">(inst, owner)</span></span>
    [...]

    inst:ListenForEvent(<span class="hljs-string">"newstate"</span>, stopusingbush, owner) <span class="hljs-comment">--automatic event by stategraph</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onunequipbush</span><span class="hljs-params">(inst, owner)</span></span>
    [...]

    inst:RemoveEventCallback(<span class="hljs-string">"newstate"</span>, stopusingbush, owner)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onusebush</span><span class="hljs-params">(inst)</span></span>
    <span class="hljs-keyword">local</span> owner = inst.components.inventoryitem.owner
    <span class="hljs-keyword">if</span> owner <span class="hljs-keyword">then</span>
        owner.sg:GoToState(<span class="hljs-string">"hide"</span>)
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bush</span><span class="hljs-params">()</span></span>
    <span class="hljs-keyword">local</span> inst = simple()

    inst:AddTag(<span class="hljs-string">"hide"</span>)
    inst.components.inventoryitem.foleysound = <span class="hljs-string">"dontstarve/movement/foley/bushhat"</span>

    inst:AddComponent(<span class="hljs-string">"useableitem"</span>)
    inst.components.useableitem:SetOnUseFn(onusebush)

    inst.components.equippable:SetOnEquip( onequipbush )
    inst.components.equippable:SetOnUnequip( onunequipbush )

    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="workable能工作的">Workable(能工作的)</h2> 
<p>这个组件可以让你的物品(通常是装备)可以挖,锤,砍,…..</p> 
<h3 id="重要的变量-20">重要的变量</h3> 
<p>onwork,onfinish: <br> –在对应事件发生时调用 <br> functions </p> 
<p>action: <br> ACTIONS.CHOP <br> 动作</p> 
<p>workleft: <br> 10 <br> 时间</p> 
<p>savestate: <br> false</p> 
<p>是否保存状态</p> 
<h3 id="重要的函数-13">重要的函数</h3> 
<p>Destroy(destroyer) <br> –销毁</p> 
<p>SetWorkLeft(work) <br> –手动设置工作</p> 
<h3 id="例子-22">例子</h3> 
<p><code>tree_marsh.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chop_down_tree</span><span class="hljs-params">(inst, chopper)</span></span>
    [...]
    inst.components.workable:SetWorkAction(ACTIONS.DIG) <span class="hljs-comment">--now it can no longer be chopped, but dug</span>
    inst.components.workable:SetOnFinishCallback(dig_up_stump)
    inst.components.workable:SetWorkLeft(<span class="hljs-number">1</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">(Sim)</span></span>
    [...]

    inst:AddComponent(<span class="hljs-string">"workable"</span>)
    inst.components.workable:SetWorkAction(ACTIONS.CHOP)
    inst.components.workable:SetWorkLeft(<span class="hljs-number">10</span>)
    inst.components.workable:SetOnWorkCallback(chop_tree) <span class="hljs-comment">--this plays an animation</span>
    inst.components.workable:SetOnFinishCallback(chop_down_tree) <span class="hljs-comment">--this makes a stump</span>

    [...]
    <span class="hljs-keyword">return</span> inst
<span class="hljs-keyword">end</span>
</code></pre> 
<h2 id="light亮">Light(亮)</h2> 
<p>这不是一个组件,但是行为很像,所以在这里介绍它.</p> 
<h3 id="使用">使用</h3> 
<p>inst.entity:AddLight()</p> 
<h3 id="重要的函数-14">重要的函数</h3> 
<p>SetIntensity(percent) <br> –强烈度</p> 
<p>SetRadius(number) <br> – 光照多远</p> 
<p>SetFalloff(percent) <br> –消退速度</p> 
<p>Enable(boolean) <br> –开关</p> 
<p>SetColour(r, b, g) <br> –设置颜色</p> 
<h3 id="例子-23">例子</h3> 
<p><code>mininglantern.lua</code></p> 
<pre class="prettyprint"><code class="language-lua hljs ">
<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnon</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">-- enable light</span>
      inst.Light:Enable(<span class="hljs-keyword">true</span>)
      inst.AnimState:PlayAnimation(<span class="hljs-string">"idle_on"</span>)
[...]
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">turnoff</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--disable light</span>
    inst.Light:Enable(<span class="hljs-keyword">false</span>)
    inst.AnimState:PlayAnimation(<span class="hljs-string">"idle_off"</span>)
[...]
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fuelupdate</span><span class="hljs-params">(inst)</span></span> <span class="hljs-comment">--calculate brightness using math functions</span>
    <span class="hljs-keyword">local</span> fuelpercent = inst.components.fueled:GetPercent()
    inst.Light:SetIntensity(Lerp(<span class="hljs-number">0.4</span>, <span class="hljs-number">0.6</span>, fuelpercent))
    inst.Light:SetRadius(Lerp(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>, fuelpercent))
    inst.Light:SetFalloff(<span class="hljs-number">.9</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">()</span></span>
[...]
    inst.entity:AddLight() <span class="hljs-comment">--light is not a component</span>
    inst.Light:SetColour(<span class="hljs-number">180</span>/<span class="hljs-number">255</span>, <span class="hljs-number">195</span>/<span class="hljs-number">255</span>, <span class="hljs-number">150</span>/<span class="hljs-number">255</span>) <span class="hljs-comment">--clever way you can use the rbg-system</span>

    fuelupdate(inst)
<span class="hljs-keyword">end</span></code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d7c9c2b8655a101b76dbd1063c368cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql 时间date语句用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/85f507521c68a5b786d998ea5eda5e92/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spring是如何管理Bean</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>