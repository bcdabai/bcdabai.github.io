<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python import 详解 全局变量 作用域 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python import 详解 全局变量 作用域" />
<meta property="og:description" content="一、名词 模块:
模块通常是个文件，可以作为module的文件类型有&#34;.py&#34;、“.pyo”、“.pyc”、“.pyd”、“.so”、“.dll”。
包:
包通常是个文件夹，python中约定文件夹中有__init__.py的默认为包，如果包的子目录中也有__init__.py则认为是子包。
Python import 的搜索路径
在当前目录下搜索该模块
在环境变量 PYTHONPATH 中指定的路径列表中依次搜索
# 加入上级路径到PYTHONPATH export PYTHONPATH=../:$PYTHONPATH 在 Python 安装路径的 lib 库中搜索
Python import 的步骤
python 所有加载的模块信息都存放在 sys.modules 结构中，当 import 一个模块时，会按如下步骤来进行
如果是 import A，检查 sys.modules 中是否已经有 A，如果有则不加载，如果没有则为 A 创建 module 对象，并加载 A
如果是 from A import B，先为 A 创建 module 对象，再解析A，从中寻找B并填充到 A 的 dict 中
相对导入与绝对导入
绝对导入的格式为 import A.B 或 from A import B，相对导入格式为 from . import B 或 from …A import B，." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b551cfeb81575df99407f78ca9fa9763/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-08T14:23:28+08:00" />
<meta property="article:modified_time" content="2023-06-08T14:23:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python import 详解 全局变量 作用域</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a><strong>一、名词</strong></h3> 
<p><strong>模块:</strong><br> 模块通常是个文件，可以作为module的文件类型有".py"、“.pyo”、“.pyc”、“.pyd”、“.so”、“.dll”。<br> <strong>包:</strong><br> 包通常是个文件夹，python中约定文件夹中有<code>__init__.py</code>的默认为包，如果包的子目录中也有<code>__init__.py</code>则认为是子包。</p> 
<p><strong>Python import 的搜索路径</strong><br> 在当前目录下搜索该模块<br> 在环境变量 PYTHONPATH 中指定的路径列表中依次搜索</p> 
<pre><code># 加入上级路径到PYTHONPATH
export PYTHONPATH=../:$PYTHONPATH
</code></pre> 
<p>在 Python 安装路径的 lib 库中搜索</p> 
<p><strong>Python import 的步骤</strong><br> python 所有加载的模块信息都存放在 sys.modules 结构中，当 import 一个模块时，会按如下步骤来进行<br> 如果是 import A，检查 sys.modules 中是否已经有 A，如果有则不加载，如果没有则为 A 创建 module 对象，并加载 A<br> 如果是 from A import B，先为 A 创建 module 对象，再解析A，从中寻找B并填充到 A 的 <strong>dict</strong> 中<br> <strong>相对导入与绝对导入</strong><br> 绝对导入的格式为 import A.B 或 from A import B，相对导入格式为 from . import B 或 from …A import B，.代表当前模块，…代表上层模块，…代表上上层模块，依次类推。<br> 相对导入可以避免硬编码带来的维护问题，例如我们改了某一顶层包的名，那么其子包所有的导入就都不能用了。但是 存在相对导入语句的模块，不能直接运行，否则会有异常：</p> 
<pre><code>ValueError: Attempted relative import in non-package
</code></pre> 
<p><a href="https://www.jb51.net/article/102252.htm" rel="nofollow">部分来源</a></p> 
<h3><a id="import_27"></a><strong>二、import</strong></h3> 
<p><strong>直接引入变量使用：</strong></p> 
<pre><code>*uiQt.py:*
# encoding: UTF-8

# 获取操作系统信息模块
import platform
from qtpy import QtWidgets, QtGui, QtCore

# 创建Qt应用对象
qApp = QtWidgets.QApplication([])
</code></pre> 
<pre><code>*main.py:*
//从模块uiQt中引入变量qApp
from vnpy.trader.uiQt（模块文件名） import qApp（变量名）
sys.exit(qApp.exec_())
</code></pre> 
<p><strong>从模块中引入类：</strong></p> 
<pre><code>*eventEngine.py:*
# encoding: UTF-8
class EventEngine(object):
</code></pre> 
<pre><code>*main.py:*
# 事件引擎模块
from vnpy.event.eventEngine（模块文件名） import EventEngine（类名）
# 创建事件引擎
    ee = EventEngine()
</code></pre> 
<p><strong>引入包：</strong><br> 注意包的引入，Python会运行从父包到子包中的<code>__init__.py</code>文件。下图为包目录结构：<br> <img src="https://images2.imgbox.com/dc/85/TAPmk2HH_o.png" alt="这里写图片描述"></p> 
<pre><code>*ctpGateway.py:*
class CtpGateway(VtGateway):
    def __init__(self, eventEngine, gatewayName='CTP'):
        """Constructor"""
        super(CtpGateway, self).__init__(eventEngine, gatewayName)
</code></pre> 
<pre><code>*__init__.py:*
# encoding: UTF-8

from vnpy.trader import vtConstant
from ctpGateway（模块名） import CtpGateway（类名）

gatewayClass = CtpGateway
gatewayName = 'CTP'
gatewayDisplayName = 'CTP'
gatewayType = vtConstant.GATEWAYTYPE_FUTURES
gatewayQryEnabled = True

</code></pre> 
<pre><code>*main.py:*
# 加载底层接口
from vnpy.trader.gateway（子包名） import ctpGateway（子包名）
# 添加交易接口
    me.addGateway(ctpGateway) //包名可作为参数传递
</code></pre> 
<pre><code>    def addGateway(self, gatewayModule):
        """添加底层接口"""
        gatewayName = gatewayModule.gatewayName
        
        # 创建接口实例
        self.gatewayDict[gatewayName] = gatewayModule.gatewayClass(self.eventEngine,                                                    gatewayName)
</code></pre> 
<h3><a id="_101"></a><strong>三、注意</strong></h3> 
<blockquote> 
 <p>如果仅是使用import的话，系统为该模块创建一个命名空间后运行代码，并创建一个该命名空间的引用对象，而如果使用from import则会直接引入当前空间。如下</p> 
</blockquote> 
<pre><code># file : spam.py
a = 37                    # 一个变量
def foo:                  # 一个函数
    print "I'm foo"
class bar:                # 一个类
    def grok(self):
        print "I'm bar.grok"
b = bar()                 # 创建一个实例
</code></pre> 
<pre><code> import spam           # 导入并运行模块 spam，命名空间的引用对象spam
 print spam.a          # 访问模块 spam 的属性
 spam.foo()
 c = spam.bar()
</code></pre> 
<pre><code>import datetime
print(datetime.datetime.now())
引入整个datetime包
from datetime import datetime
print(datetime.now())
只引入datetime包里的datetime类
</code></pre> 
<blockquote> 
 <p>对于from package import *语句，python引入的是 <code>__init__.py</code>中<code>__all__ = ["Module1", "Module2"]</code>中的模块。</p> 
</blockquote> 
<h3><a id="_134"></a><strong>四、全局变量&amp;作用域</strong></h3> 
<p><a href="https://www.cnblogs.com/f-ck-need-u/p/9925021.html" rel="nofollow">Python作用域详述 </a><br> 同一个文件内的全局变量a，如果多线程初始化多个文件内某个类（修改了全局变量a），此时修改的是同一个全局变量a。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8517d286772a5a7538a2a82801a6127f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">WEB网络渗透的基础知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f3b1f9633a6be78087db8307614268ae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【超详细】Pytest全栈自动化测试指南-夹具入门，让你快速提高测试效率！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>