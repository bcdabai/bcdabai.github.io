<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>@Scheduled定时器 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="@Scheduled定时器" />
<meta property="og:description" content="目录
一、基本使用
二、参数详解
1. @Scheduled(fixedDelay = 5000)
2. @Scheduled(fixedRate = 5000)
3. @Scheduled(cron = “0 0 2 * * ?”)
4.cron表达式
案例
配置文件
写配置的时候，没有提示,解决方案
三、@Scheduled注意事项
四、 @Scheduled 的执行原理 1、加载使用 @Scheduled 注解的类及方法
2、解析 @Scheduled 的内容，并将定时任务注册到 ScheduledTaskRegistrar 中
3、执行定时任务 总结
定时任务调度：Unexpected error occurred in scheduled task错误
解决
一、基本使用 @Scheduled注解：任务自动化调度。
启用调度支持：@EnableScheduling
@SpringBootApplication @EnableScheduling public class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); } } 二、参数详解 1. @Scheduled(fixedDelay = 5000) 延迟执行。任务在上个任务完成后达到设置的延时时间就执行。此处，任务会在上个任务完成后经过5s再执行。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cc2fafa295c8fd18edd0bfc90989fda0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-14T14:40:09+08:00" />
<meta property="article:modified_time" content="2022-11-14T14:40:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">@Scheduled定时器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E4%B8%80%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8" rel="nofollow">一、基本使用</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3" rel="nofollow">二、参数详解</a></p> 
<p id="1.%20%40Scheduled(fixedDelay%20%3D%205000)-toc" style="margin-left:40px;"><a href="#1.%20%40Scheduled%28fixedDelay%20%3D%205000%29" rel="nofollow">1. @Scheduled(fixedDelay = 5000)</a></p> 
<p id="2.%20%40Scheduled(fixedRate%20%3D%205000)-toc" style="margin-left:40px;"><a href="#2.%20%40Scheduled%28fixedRate%20%3D%205000%29" rel="nofollow">2. @Scheduled(fixedRate = 5000)</a></p> 
<p id="3.%20%40Scheduled(cron%20%3D%20%E2%80%9C0%200%202%20*%20*%20%3F%E2%80%9D)-toc" style="margin-left:40px;"><a href="#3.%20%40Scheduled%28cron%20%3D%20%E2%80%9C0%200%202%20*%20*%20%3F%E2%80%9D%29" rel="nofollow">3. @Scheduled(cron = “0 0 2 * * ?”)</a></p> 
<p id="4.cron%E8%A1%A8%E8%BE%BE%E5%BC%8F-toc" style="margin-left:40px;"><a href="#4.cron%E8%A1%A8%E8%BE%BE%E5%BC%8F" rel="nofollow">4.cron表达式</a></p> 
<p id="%E6%A1%88%E4%BE%8B-toc" style="margin-left:80px;"><a href="#%E6%A1%88%E4%BE%8B" rel="nofollow">案例</a></p> 
<p id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">配置文件</a></p> 
<p id="%E5%86%99%E9%85%8D%E7%BD%AE%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%8F%90%E7%A4%BA%2C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E5%86%99%E9%85%8D%E7%BD%AE%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%8F%90%E7%A4%BA%2C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" rel="nofollow">写配置的时候，没有提示,解决方案</a></p> 
<p id="%E4%B8%89%E3%80%81%40Scheduled%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%40Scheduled%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" rel="nofollow">三、@Scheduled注意事项</a></p> 
<p id="%E5%9B%9B%E3%80%81%C2%A0%40Scheduled%20%E7%9A%84%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86%C2%A0-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%C2%A0%40Scheduled%20%E7%9A%84%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86%C2%A0" rel="nofollow">四、 @Scheduled 的执行原理 </a></p> 
<p id="1%E3%80%81%E5%8A%A0%E8%BD%BD%E4%BD%BF%E7%94%A8%20%40Scheduled%20%E6%B3%A8%E8%A7%A3%E7%9A%84%E7%B1%BB%E5%8F%8A%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E5%8A%A0%E8%BD%BD%E4%BD%BF%E7%94%A8%20%40Scheduled%20%E6%B3%A8%E8%A7%A3%E7%9A%84%E7%B1%BB%E5%8F%8A%E6%96%B9%E6%B3%95" rel="nofollow">1、加载使用 @Scheduled 注解的类及方法</a></p> 
<p id="%C2%A02%E3%80%81%E8%A7%A3%E6%9E%90%20%40Scheduled%20%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B9%B6%E5%B0%86%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%88%B0%20ScheduledTaskRegistrar%20%E4%B8%AD-toc" style="margin-left:40px;"><a href="#%C2%A02%E3%80%81%E8%A7%A3%E6%9E%90%20%40Scheduled%20%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B9%B6%E5%B0%86%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%88%B0%20ScheduledTaskRegistrar%20%E4%B8%AD" rel="nofollow"> 2、解析 @Scheduled 的内容，并将定时任务注册到 ScheduledTaskRegistrar 中</a></p> 
<p id="3%E3%80%81%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%C2%A0-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%C2%A0" rel="nofollow">3、执行定时任务 </a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:80px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<p id="articleContentId-toc" style="margin-left:0px;"><a href="#articleContentId" rel="nofollow">定时任务调度：Unexpected error occurred in scheduled task错误</a></p> 
<p id="%E8%A7%A3%E5%86%B3-toc" style="margin-left:40px;"><a href="#%E8%A7%A3%E5%86%B3" rel="nofollow">解决</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">一、<strong>基本使用</strong></h2> 
<p>@Scheduled注解：任务自动化调度。</p> 
<p>启用调度支持：@EnableScheduling</p> 
<pre><code>@SpringBootApplication
@EnableScheduling
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}</code></pre> 
<h2 id="%E4%BA%8C%E3%80%81%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3">二、参数详解</h2> 
<h3 id="1.%20%40Scheduled(fixedDelay%20%3D%205000)">1. @Scheduled(fixedDelay = 5000)</h3> 
<p>延迟执行。任务在上个任务完成后达到设置的延时时间就执行。此处，任务会在上个任务完成后经过5s再执行。</p> 
<h3 id="2.%20%40Scheduled(fixedRate%20%3D%205000)">2. @Scheduled(fixedRate = 5000)</h3> 
<p>定时执行。任务间隔规定时间即执行。此处，任务每隔五秒便会执行一次。</p> 
<h3 id="3.%20%40Scheduled(cron%20%3D%20%E2%80%9C0%200%202%20*%20*%20%3F%E2%80%9D)">3. @Scheduled(cron = “0 0 2 * * ?”)</h3> 
<p>自定义规则执行。比较复杂，一般用6或7个标识符(非官方叫法，方便区分记忆这么叫的)表示任务的执行规则。此处的逻辑是每天的凌晨两点开始定时执行任务。</p> 
<h3 id="4.cron%E8%A1%A8%E8%BE%BE%E5%BC%8F">4.cron表达式</h3> 
<blockquote> 
 <pre>  按顺序依次为
  1  秒（0~59）
  2  分钟（0~59）
  3 小时（0~23）
  4  天（0~31）
  5 月（0~11）
  6  星期（1~7 1=SUN 或 SUN，MON，TUE，WED，THU，FRI，SAT）
  7.年份（1970－2099）
  其中每个元素可以是一个值(如6),一个连续区间(9-12),一个间隔时间(8-18/4)(/表示每隔4小时),一个列表(1,3,5),通配符。由于"月份中的日期"和"星期中的日期"这两个元素互斥的,必须要对其中一个设置?.
   0 0 10,14,16 * * ? 每天上午10点，下午2点，4点
   0 0/30 9-17 * * ?   朝九晚五工作时间内每半小时
   0 0 12 ? * WED 表示每个星期三中午12点
   "0 0 12 * * ?" 每天中午12点触发 
   "0 15 10 ? * *" 每天上午10:15触发 
   "0 15 10 * * ?" 每天上午10:15触发 
   "0 15 10 * * ? *" 每天上午10:15触发 
   "0 15 10 * * ? 2005" 2005年的每天上午10:15触发 
   "0 * 14 * * ?" 在每天下午2点到下午2:59期间的每1分钟触发 
   "0 0/5 14 * * ?" 在每天下午2点到下午2:55期间的每5分钟触发 
   "0 0/5 14,18 * * ?" 在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发 
   "0 0-5 14 * * ?" 在每天下午2点到下午2:05期间的每1分钟触发 
   "0 10,44 14 ? 3 WED" 每年三月的星期三的下午2:10和2:44触发 
   "0 15 10 ? * MON-FRI" 周一至周五的上午10:15触发 
   "0 15 10 15 * ?" 每月15日上午10:15触发 
   "0 15 10 L * ?" 每月最后一日的上午10:15触发 
   "0 15 10 ? * 6L" 每月的最后一个星期五上午10:15触发 
   "0 15 10 ? * 6L 2002-2005" 2002年至2005年的每月的最后一个星期五上午10:15触发 
   "0 15 10 ? * 6#3" 每月的第三个星期五上午10:15触发 
   有些子表达式能包含一些范围或列表
   例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”
   “*”字符代表所有可能的值
   “/”字符用来指定数值的增量
   例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟
            在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样
   “？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值
   当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”
   “L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写
   如果在“L”前有具体的内容，它就具有其他的含义了。例如：“6L”表示这个月的倒数第６天
   注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题
   W 字符代表着*日(Mon-Fri)，并且仅能用于日域中。它用来指定离指定日的最*的一个*日。大部分的商业处理都是基于工作周的，所以 W 字符可能是非常重要的。
   例如，日域中的 15W 意味着 "离该月15号的最*一个*日。" 假如15号是星期六，那么 trigger 会在14号(星期五)触发，因为星期四比星期一离15号更*。
   C：代表“Calendar”的意思。它的意思是计划所关联的日期，如果日期没有被关联，则相当于日历中所有日期。例如5C在日期字段中就相当于日历5日以后的第一天。1C在星期字段中相当于星期日后的第一天。
   字段   允许值   允许的特殊字符
   秒           0-59           , - * /
   分           0-59           , - * /
   小时           0-23           , - * /
   日期           1-31           , - * ? / L W C
   月份           1-12 或者 JAN-DEC           , - * /
   星期           1-7 或者 SUN-SAT           , - * ? / L C #
   年（可选）           留空, 1970-2099           , - * /</pre> 
</blockquote> 
<h4 id="%E6%A1%88%E4%BE%8B">案例</h4> 
<blockquote> 
 <p>例1：@scheduled (cron="0 0 2 2 * ? *") 表示：每月二号凌晨两点执行。</p> 
 <p>例2：@scheduled (cron="15,20,40 15-20 2/5 L * ?") 表示：每月的最后一天的凌晨2点开始每隔5小时的第15分钟到第20分钟之间的每分钟的第15,20,40秒执行一次。</p> 
 <p>例3：@scheduled (cron="0 0 0 15W * ?") 表示：每月离15号最近的工作日。</p> 
 <p>例4：@scheduled (cron= "0 0 0 0 * 2#3 ") 表示：每月的第三个周一。</p> 
</blockquote> 
<blockquote> 
 <p>1、fixedRate配置了<strong>上一次任务的开始时间</strong>到<strong>下一次任务的开始时间</strong>的间隔，每次任务都会执行；<br> 2、fixedDelay配置了<strong>上一次任务的结束时间</strong>到<strong>下一次任务的开始时间</strong>的间隔，每次任务都会执行；<br> 3、cron表达式配置了在哪一刻执行任务，会在配置的任务开始时间判断任务是否可以执行，如果能则执行，不能则会跳过本次执行；<br> 4、如果是强调<strong>任务间隔</strong>的定时任务，建议使用fixedRate和fixedDelay，如果是强调任务在某时某分某刻执行的定时任务，建议使用cron表达式。</p> 
</blockquote> 
<h4 id="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">配置文件</h4> 
<p><strong>(1).cron</strong></p> 
<pre><code>@Scheduled(cron = "${erwin.cron:0/2 * * * * ?}")
public void cronTaskYmlDemo() {
    log.info("cron yml demo");
}</code></pre> 
<p>配置文件     yml</p> 
<pre><code>erwin:
  cron: 0/10 * * * * ?</code></pre> 
<p>如果配置文件没有配，就会使用默认的值。</p> 
<p><strong>(2).fixedDelay</strong></p> 
<pre><code>@Scheduled(initialDelay = 5, fixedDelayString = "${erwin.fixed-delay:2}", timeUnit = TimeUnit.SECONDS)
public void fixedDelayTaskYmlDemo() {
    log.info("fixedDelay yml demo");
}</code></pre> 
<p>配置文件     yml</p> 
<pre><code>erwin:
  fixed-delay: 5</code></pre> 
<p>如果在配置文件中没有配置，则每隔2秒执行一次，如果配置了，就每隔5秒执行一次。<code>initialDelay</code> 表示，项目启动后，5秒开始执行第一次任务。</p> 
<p>注意：${erwin.fixed-delay:2}，冒号前后不能有空格。</p> 
<p><strong>(3).fixedRate</strong></p> 
<pre><code>@Scheduled(initialDelay = 5, fixedRateString = "${erwin.fixed-rate:2}", timeUnit = TimeUnit.SECONDS)
public void fixedRateTaskYmlDemo() {
    log.info("fixedRate yml demo");
}</code></pre> 
<p>配置文件     yml</p> 
<pre><code>erwin:
  fixed-rate: 5</code></pre> 
<h4 id="%E5%86%99%E9%85%8D%E7%BD%AE%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%8F%90%E7%A4%BA%2C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">写配置的时候，没有提示,解决方案</h4> 
<p><strong>导入依赖</strong></p> 
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre> 
<p><strong>写配置属性</strong></p> 
<pre><code>@Date
@Configuration
@ConfigurationProperties("erwin")
public class ErwinProperties {

    private String cron;

    private Long fixedDelay;

    private Long fixedRate;

}</code></pre> 
<p><strong>yml</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/52/11/GQLK9oWq_o.png"></p> 
<p></p> 
<h2 id="%E4%B8%89%E3%80%81%40Scheduled%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">三、<strong>@Scheduled注意事项</strong></h2> 
<ul><li>spring的注解@Scheduled 需要写在实现方法上；</li><li>定时器的任务方法不能有返回值（如果有返回值，spring初始化的时候会告诉你有个错误、需要设定一个proxytargetclass的某个值为true），不能指向任何的参数；</li><li>如果该方法需要与应用程序上下文的其他对象进行交互，通常是通过依赖注入来实现；</li><li>实现类上要有组件的注解@Component。</li></ul> 
<h2 id="%E5%9B%9B%E3%80%81%C2%A0%40Scheduled%20%E7%9A%84%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86%C2%A0">四、 @Scheduled 的执行原理 </h2> 
<h3 id="1%E3%80%81%E5%8A%A0%E8%BD%BD%E4%BD%BF%E7%94%A8%20%40Scheduled%20%E6%B3%A8%E8%A7%A3%E7%9A%84%E7%B1%BB%E5%8F%8A%E6%96%B9%E6%B3%95"><strong>1、加载使用 @Scheduled 注解的类及方法</strong></h3> 
<p>Spring 首先会通过类 ScheduledAnnotationBeanPostProcessor 的 postProcessAfterInitialization 方法去初始化 bean，待初始化完 bean 后，就会拦截所有用到“@Scheduled”注解的方法，进行调度处理，具体细节请看下面代码：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/36/83/JKESmBzO_o.png"></p> 
<h3 id="%C2%A02%E3%80%81%E8%A7%A3%E6%9E%90%20%40Scheduled%20%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B9%B6%E5%B0%86%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%88%B0%20ScheduledTaskRegistrar%20%E4%B8%AD"> <strong>2、解析 @Scheduled 的内容，并将定时任务注册到 ScheduledTaskRegistrar 中</strong></h3> 
<p>解析相应的的注解参数，放入“定时任务列表”等待后续处理；之后在“定时任务列表”中统一执行相应的定时任务（定时任务先执行 corn，判断定时任务的执行时间，计算出相应的下次执行时间，放入线程中，到了时间就执行。再执行按“频率”（fixedRate）执行的定时任务，直到所有任务执行结束）。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/40/53/54190kFE_o.png"></p> 
<h3 id="3%E3%80%81%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%C2%A0"><strong>3、执行定时任务</strong> </h3> 
<p>run 方法是调度 task 的核心，task 的执行实际上是 run 方法的执行。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ff/29/SUeDKvP6_o.png"></p> 
<h4 id="%E6%80%BB%E7%BB%93"><strong>总结</strong></h4> 
<p><strong>从上面代码可以看出，如果多个定时任务定义的是同一个时间，会根据程序加载标有 @Scheduled 方法的先后来执行。若某个定时任务一直无法执行完成，则无法设置下次任务执行时间，之后会导致此任务后面的所有定时任务无法继续执行，也就会出现所有的定时任务罢工的现象。所以应用 SpringBoot 的定时任务的方法中，一定不要出现“死循环”、“执行耗费大量时间”、“http持续等待无响应”的现象，否则会导致定时任务直接罢工。针对数据量、查询或者远程调用特别多的场景，推荐把定时任务分段处理</strong></p> 
<p></p> 
<h2 id="articleContentId">定时任务调度：Unexpected error occurred in scheduled task错误</h2> 
<p><strong>这是因为@Scheduled注解方式级别高于资源注入级别,导致了资源注入失败</strong>在代码中使用了<strong>@Autowired注解进行自动注入，但是@Scheduled注解优先级高于@Autowired，导致定时任务启动时自动注入的对象为null</strong></p> 
<h3 id="%E8%A7%A3%E5%86%B3">解决</h3> 
<p><strong>使用ApplicationContextAware,它实现了这个接口的bean，当spring容器初始化的时候，会自动的将ApplicationContext注入进来</strong></p> 
<pre><code>@Component
@Lazy(value = false)
public class AlertTask implements ApplicationContextAware {

    private static ApplicationContext context;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        context = applicationContext;
    }
    public static ApplicationContext getApplicationContext() {
        return context;
    }

    public static Object getBean(String name) {
        return getApplicationContext().getBean(name);
    }

    /**
     * @Description 定时获取数据更新本地数据
     * @Return void
     * @Date 2019-11-01 09:15:17
     **/
    @Scheduled(cron = "0/5 * * * * ?")//每两分钟执行一次0 */2 * * * ?
    public void getEquipmentDataAlert() throws Exception {
        DeviceService DeviceService = (DeviceService)this.getBean("DeviceService");
                DeviceService.findxx();

        }</code></pre> 
<p><strong>或者将implements ApplicationContextAware抽出来,封装一个工具类.</strong></p> 
<pre><code>
/**
 * @Description 定时任务service注入工具
 */
public class TaskUtil implements ApplicationContextAware {

    private static ApplicationContext context;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        context = applicationContext;
    }


    public static ApplicationContext getApplicationContext() {
        return context;
    }

    public static Object getBean(String name) {
        return getApplicationContext().getBean(name);
    }
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8bbc54d5281bb5ffebfa355dcdfd27e6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springbean生命周期源码版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f990704c11df8d20e05a62d76d4b4ac3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mysql 5.7 忘记root密码或重置密码的详细方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>