<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos7 访问php页面显示源码_7、Linux云计算系列CentOS7网络服务—LNMP - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos7 访问php页面显示源码_7、Linux云计算系列CentOS7网络服务—LNMP" />
<meta property="og:description" content="Linux第十七章实验报告
一、准备工作
1. 环境要求：
操作系统：CentOS 7.X 64 位
关闭 SELinux 和 iptables 防火墙
此次试验环境使用网络 yum 源，保证系统能正常连接互联网
2. 网络 yum 源：
先将系统自带的 yum 配置文件移除或者删除，然后下载以下两个配置文件
官方基础：
http://mirrors.163.com/.help/CentOS6-Base-163.repo
http://mirrors.aliyun.com/repo/Centos-6.repo
epel 拓展：http://mirrors.aliyun.com/repo/epel-6.repo
下载完成后，需要使用命令清除掉原有的 yum 缓存，使用新的配置文件建立缓存
# yum clean all #清除掉原有缓存列表
# yum makecache #建立新的缓存列表
# yum update #将所有能更新的软件更新(非必选)
3. 安装编译工具和依赖软件包：
yum -y install gcc* pcre-devel openssl openssl-devel zlib-devel ncurses-devel cmake bison libxml2-devel libpng-devel
4. Nginx、MySQL、PHP 三大软件的源码包下载地址：
Nginx：http://nginx.org/en/download.html
MySQL：https://dev.mysql.com/downloads/mysql/
PHP：http://www.php.net/
版本选用：
Nginx：1.12.* #选用软件的稳定版即可
Mysql：5.5.* #5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/635de5bb535988dbc40a8415b3ad7472/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-28T14:33:45+08:00" />
<meta property="article:modified_time" content="2020-11-28T14:33:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos7 访问php页面显示源码_7、Linux云计算系列CentOS7网络服务—LNMP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="._5ce-wx-style" style="font-size:16px;"> 
 <div class="rich_media_content" id="js_content"> 
  <p>Linux第十七章实验报告</p> 
  <p>一、准备工作</p> 
  <p>1. 环境要求：</p> 
  <p>操作系统：CentOS 7<span lang="en-us">.X   64 位</span></p> 
  <p>关闭 SELinux 和 iptables 防火墙</p> 
  <p>此次试验环境使用网络 yum 源，保证系统能正常连接互联网</p> 
  <p>2. 网络 yum 源：</p> 
  <p>先将系统自带的 yum 配置文件移除或者删除，然后下载以下两个配置文件</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>官方基础：</p><p>http://mirrors.163.com/.help/CentOS6-Base-163.repo</p><p>http://mirrors.aliyun.com/repo/Centos-6.repo</p><p>epel 拓展：http://mirrors.aliyun.com/repo/epel-6.repo</p></td></tr></tbody></table> 
  <p>下载完成后，需要使用命令清除掉原有的 yum 缓存，使用新的配置文件建立缓存</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># yum clean all             #清除掉原有缓存列表</p><p># yum makecache          #建立新的缓存列表</p><p># yum update      #将所有能更新的软件更新(非必选)</p></td></tr></tbody></table> 
  <p>3. 安装编译工具和依赖软件包：</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>yum -y install gcc* pcre-devel openssl openssl-devel zlib-devel ncurses-devel cmake bison  libxml2-devel libpng-devel</p></td></tr></tbody></table> 
  <p>4. Nginx、MySQL、PHP 三大软件的源码包下载地址：</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>Nginx：http://nginx.org/en/download.html</p><p>MySQL：https://dev.mysql.com/downloads/mysql/</p><p>PHP：http://www.php.net/</p></td></tr></tbody></table> 
  <p>版本选用：</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>Nginx：1.12.* #选用软件的稳定版即可</p><p>Mysql：5.5.* #5.5 以上版本需要 1G 以上的内存，否则无法安装</p><p>PHP：7.1.* #我们使用的是 php7</p></td></tr></tbody></table> 
  <p>注意：每次安装 LNMP 时，软件包的小版本都不一样，官方会对其大版本下的小版本进行覆盖式更新，本文内部分链接会失效，切记按照下载版本进行安装。</p> 
  <p>二、源码软件包安装</p> 
  <p>1、Nginx</p> 
  <p>Nginx 是一款轻量级的 Web 服务器/反向代理服务器及电子邮件(IMAP/POP3)代理服务器，在 BSD-like 协议下发行。其特点是占有内存少，并发能力强。</p> 
  <p>1.下载 Nginx 源码包</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># wget http://nginx.org/download/nginx-1.12.2.tar.gz</p></td></tr></tbody></table> 
  <p>2. 创建用于运行 Nginx 的用户</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># useradd -r -s /sbin/nologin nginx</p></td></tr></tbody></table> 
  <p>3. 解压缩 Nginx 并安装</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># ./configure --prefix=/usr/local/nginx --user=nginx --group=nginx  --with-http_stub_status_module --with-http_ssl_module</p><p># make</p><p># make install</p></td></tr></tbody></table> 
  <p>4. 上传编写好的 nginx 启动管理脚本(见文本尾部)</p> 
  <p>2、MySQL</p> 
  <p>下载：https://dev.mysql.com/downloads/mysql/</p> 
  <p>选择：MySQL Community Server 5.5 »</p> 
  <p>选择：  Select Version: 按照自己要求选择</p> 
  <p>        Select Operating System: Source Code</p> 
  <p>        Select OS Version: Generic Linux</p> 
  <p>格式：mysql-N.N.NN.tar.gz</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># wget https://cdn.mysql.com//Downloads/MySQL-5.5/mysql-5.5.62.tar.gz</p></td></tr></tbody></table> 
  <p>1. 创建用于运行 Mysql 的用户：</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># useradd -r -s /sbin/nologin mysql</p></td></tr></tbody></table> 
  <p>2. 解压缩 Mysql 并安装：</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DEXTRA_CHARSETS=all -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_MEMORY_STORAGE_ENGINE=1 -DWITH_READLINE=1 -DENABLED_LOCAL_INFILE=1 -DMYSQL_USER=mysql -DMYSQL_TCP_PORT=3306</p><p># make</p><p># make install</p><p>#<span lang="en-us"> ln -s /usr/local/mysql/bin/*       /usr/local/bin</span></p></td></tr></tbody></table> 
  <p>报错提示：当出现以下编译mysql错误时，原因是由于gcc-c++没有安装，使用yum安装即可</p> 
  <p><img src="https://images2.imgbox.com/90/47/woeNUlQk_o.png" alt="74abac6c473e5bdf3e0effcf8cc3a0f4.png"></p> 
  <p>3. 修改安装后的目录权限</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># cd /usr/local/mysql</p><p># chown -R root .</p><p># chown -R mysql data</p></td></tr></tbody></table> 
  <p>4. 生成 Mysql 配置文件</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># cp -a /lnmp/mysql-5.5.62/support-files/my-medium.cnf /etc/my.cnf</p></td></tr></tbody></table> 
  <p>5. 初始化，生成授权表</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>#<span lang="en-us"> cd /usr/local/mysql       </span></p><p>#一定要先切换到此目录下，然后再执行下一步。</p><p># ./scripts/mysql_install_db --user=mysql</p><p>初始化成功标志：两个 ok</p></td></tr></tbody></table> 
  <p>6. 生成 Mysql 的启动和自启动管理脚本</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># cd /lnmp/mysql-5.5.62/support-files</p><p>切换到 mysql 的源码解压缩目录下的 support-files</p><p># cp -a mysql.server /etc/init.d/mysqld</p><p># chmod +x /etc/init.d/mysqld</p><p># chkconfig --add mysqld</p><p># chkconfig mysqld on</p><p># service mysqld start|stop|restart</p></td></tr></tbody></table> 
  <p>7. 给 mysql 的 root 用户设置密码</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># mysqladmin -uroot password 123456</p><p># mysql -uroot -p123456</p></td></tr></tbody></table> 
  <p>3、PHP</p> 
  <p>下载：http://www.php.net/</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># wget https://www.php.net/distributions/php-7.1.29.tar.gz</p></td></tr></tbody></table> 
  <p>1. 解压缩 PHP 并安装:</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>#./configure --prefix=/usr/local/php/ --with-config-file-path=/usr/local/php/etc/ --with-mysqli=/usr/local/mysql/bin/mysql_config --enable-soap --enable-mbstring=all --enable-sockets --with-pdo-mysql=/usr/local/mysql --with-gd --without-pear --enable-fpm</p><p># make</p><p># make install</p></td></tr></tbody></table> 
  <p>报错提示：若遇到 libpng.so not found .报错(老版本的 PHP 会出现此问题)</p> 
  <p>解决方案： # ln -s /usr/lib64/libpng.so /usr/lib</p> 
  <p>2. 生成 php 配置文件</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># cp -a /lnmp/php-7.1.29/php.ini-production /usr/local/php/etc/php.ini</p></td></tr></tbody></table> 
  <p>复制源码包内的配置文件到安装目录下，并改名即可</p> 
  <p>3. 创建软连接，使用 php 相关命令是更方便</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>ln -s /usr/local/php/bin/* /usr/local/bin/</p><p>ln -s /usr/local/php/sbin/* /usr/local/sbin/</p></td></tr></tbody></table> 
  <p>4、配置 Nginx 连接 PHP(重难点)</p> 
  <p>1. nginx 连接 php 需要启动 php-fpm 服务</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>cd /usr/local/php/etc/</p><p>生成 php-fpm 的配置文件，并修改指定参数</p><p># vim php-fpm.conf </p><p>修改指定条目的参数：</p><p>pid = run/php-fpm.pid</p><p># cd /usr/local/php/etc/php-fpm.d/</p><p># cp -a www.conf.default www.conf</p><p># vim www.conf</p><p>修改用户和组的指定用户</p><p>user = nginx</p><p>group = nginx</p><p>修改 Nginx 启动管理脚本：将 php-fpm 的注释取消掉即可</p></td></tr></tbody></table> 
  <p>2. 修改 Nginx 的配置文件，使其识别.php 后缀的文件</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p># vim /usr/local/nginx/conf/nginx.conf</p><p>取消下列行的注释，并修改 include 选项的后缀为 fastcgi.conf，并注意每一行结尾的分号和大括号</p><p>#   <span lang="en-us">location ~ \.php$ {             </span></p><p>#<span lang="en-us">       root       html;      </span></p><p>#<span lang="en-us">       fastcgi_pass       127.0.0.1:9000;      </span></p><p>#<span lang="en-us">       fastcgi_index       index.php;      </span></p><p>#<span lang="en-us">       fastcgi_param       SCRIPT_FILENAME       /scripts$fastcgi_script_name;</span></p><p>#<span lang="en-us">       include       fastcgi_params;       </span>#修改为 fsatcgi.conf</p><p>#}<span lang="en-us">      </span></p></td></tr></tbody></table> 
  <p>测试：</p> 
  <p>重启 Nginx 服务，创建 php 测试文件，访问并查看是否解析</p> 
  <p>4.3 修改 Nginx 配置文件，使其默认自动加载 php 文件</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>location / {<!-- --></p><p>root html;             #Nginx 的默认网页路径:PREFIX/html</p><p>index  index.php index.html;#设置默认加载的页面，以及优先级</p><p>}</p></td></tr></tbody></table> 
  <p>附件：建议使用时先复制到文本文件中查看下是否有字符集问题</p> 
  <p>vim (/etc/init.d/nginx)</p> 
  <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td><p>#!/bin/bash</p><p>#Author：li</p><p>#chkconfig: 2345 99 33</p><p>#description: nginx server control tools</p><p>ngxc="/usr/local/nginx/sbin/nginx"</p><p>pidf="usr/local/nginx/logs/nginx.pid"</p><p>ngxc_fpm="/usr/local/php/sbin/php-fpm"</p><p>pidf_fpm="/usr/local/php/var/run/php-fpm.pid"</p><p>case "$1" in</p><p>       start)</p><p>              $ngxc -t &amp;&gt; /dev/null</p><p>              if [ $? -eq 0 ];then</p><p>                            $ngxc</p><p>                            $ngxc_fpm</p><p>                            echo "nginx service start success!"</p><p>              else</p><p>                            $ngxc -t</p><p>              fi</p><p>              ;;</p><p>       stop)</p><p>              kill -s QUIT $(cat $pidf)</p><p>              kill -s QUIT $(cat $pidf_fpm)</p><p>                            echo "nginx service stop success!"</p><p>              ;;</p><p>       restart)</p><p>              $0 stop</p><p>              $0 start</p><p>              ;;</p><p>       reload)</p><p>              $ngxc -t &amp;&gt; /dev/null</p><p>              if [ $? -eq 0 ];then</p><p>                            kill -s HUP $(cat $pidf)</p><p>                            kill -s HUP $(cat $pidf_fpm)</p><p>                            echo "reload nginx config success!"</p><p>              else</p><p>                            $ngxc -t</p><p>              fi</p><p>              ;;</p><p>       *)</p><p>              echo "please input stop|start|restart|reload."</p><p>              exit 1</p><p>esac</p></td></tr></tbody></table> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/54b35119f0d0309ddf2535238e56d403/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">canny算子_紫光同创PGL22G开发平台试用连载（3）——驱动OV5640 摄像头实现sobel算子边缘检测算法...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c421a543c2a9972acbc836e95d7de335/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">centos 忘记root密码_CentOS7忘记root密码该怎么办？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>