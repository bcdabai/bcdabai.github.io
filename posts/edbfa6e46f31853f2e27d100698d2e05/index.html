<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>学习 瑞吉外卖项目——总结 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="学习 瑞吉外卖项目——总结" />
<meta property="og:description" content="本文为个人学习黑马《瑞吉外卖》项目后进行的项目总结，更偏向于对自己编写文本能力的锻炼以及对项目知识点的简短记录。因为个人能力问题，其中可行性分析和测试部分只进行了小标题的陈列，并没有进行编辑。对《瑞吉外卖》项目感兴趣的朋友也可以浏览本文后再去学习，可以对该项目架构有大体感知，同时黑马《瑞吉外卖》非常适合做各位朋友的入门项目，大力推荐本项目。
1.1 项目背景 随着我国城镇和农村居民生活水平达到富裕和小康层次，消费在国民经济活动中的比重逐步加大，居民的餐饮消费逐渐从一日三餐的刚需升级到感受餐饮文化以及社交的重要方式，近年来我国餐饮业销售收入逐年攀升，2019年中国餐饮收入达4.67万亿元，较2018年增加了0.40万亿元，同比增长9.38%，受新冠肺炎疫情影响，2020年中国餐饮收入大幅下滑，随着国内疫情的有效控制，中国餐饮市场也逐渐复苏，2021年中国餐饮收入完成4.69万亿元，较2020年增加了0.74万亿元，同比增长18.64%。“新冠疫情”改变了人们的就餐习惯，对于病毒的心理障碍，更多人选择外卖的方式来就餐，截止2021年12月末中国网上外卖用户规模达54416万人，较2020年同期增加了12533万人，同比增长29.92%。“新冠疫情”改变了人们的就餐习惯，对于病毒的心理障碍，更多人选择外卖的方式来就餐，截止2021年12月末中国网上外卖用户规模达54416万人，较2020年同期增加了12533万人，同比增长29.92%。 1.2 项目介绍 本项目（瑞吉外卖）是专门为餐厅、饭店定制的一款软件产品，包括系统管理后台和移动端应用两部分。其中系统管理后台主要提供给餐饮内部员工使用，可以对餐厅的菜品、套餐、订单进行管理和维护。移动端应用主要提供给消费者使用，可以在线浏览菜品、添加购物车、下单等。
1.3 项目亮点 1、使用Redis进行缓存 当用户数量较多时，系统访问量大，频繁的访问数据库，数据库压力大，系统的性能下降，用户体验感差。因此使用Redis对数据进行缓存，从而减小数据库的压力，在数据更新时删除缓存，从而保证数据库和缓存的一致性，同时有效提高系统的性能和访问速度。
2、使用MySQL主从复制，进行读写分离 读和写数据的所有压力全都由一台数据库承担，压力大，数据库服务器磁盘损坏则数据丢失，单点故障。使用MySQL进行主从复制，主库(master)进行写操作（intsert update delete），从库（salve）进行读操作（select），从而减轻数据库负担，增大系统承受能力，提高系统性能。本项目使用Sharding-JDBC在程序中实现读写分离。
注：MySQL主从复制是一个异步的复制过程，底层是基于Mysql数据库目带的二进制日志功能。就是一台或多台MySQL数据库(slave，即从库)从另一台MySQL数据库(master，即主库）进行日志的复制然后再解析日志并应用到自身，最终实现从库的数据和主库的数据保持一致。MySQL主从复制是MysQL数据库自带功能，无需借助第三方工具。
3、前后端分别部署，使用Nginx进行反向代理 前端页面部署到Nginx服务器中，后端代码部署到后端服务器中，使用Nginx对后端服务器进行反向代理，使用户只需要访问Nginx服务器便可获得后端服务器的服务（便于后期扩展集群，提高系统并发量）。
技术 SpringBoot&#43;SSM 企业级项目
SSM=Spring&#43;Spring MVC&#43;MyBatis
nginx 是服务器，主要部署静态资源。前端请求nginx服务器，再分发到多个tomcat服务器。
Spring Session解决集群的session共享问题。
Swagger：前后端分离使用。
Redis：主要用作缓存。
展示 移动端：展示数据，消费者使用
&#43;
后台管理：维护数据，餐饮企业使用
数据表 一个套餐是多个菜品的集合；
一个菜品有多个口味；
一个顾客可以同时把多个菜品和多个套餐放入购物车中。
slf4j
@sl4j是lombok提供的
功能开发： 员工管理 1. 后台登录 登录时，以json格式将数据发送至后端
开启驼峰命名
id是雪花算法自动生成的
mp规范：
通用结果类 R
后端返给前端的响应结果
前端使用的是json数据 数据库存储的密码是加密过的
md5加密 错误时，前端展示 2. 后台退出 3. 完善登录 {}是占位符，将会显示逗号后面的内容
传给前端json数据
4. 新增员工 账号设置了唯一的属性，添加相同账号时，数据库抛了异常 全局异常捕获：注解是xxx的类，异常是xxx时，就会被拦截处理
注解是RestController和Controller
@ResponseBody，返回json数据
5.员工信息分页查询
like的第一个条件是if的判断
page查询不需返回，会自动放入pageInfo对象并返回" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/edbfa6e46f31853f2e27d100698d2e05/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-05T09:57:58+08:00" />
<meta property="article:modified_time" content="2022-10-05T09:57:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">学习 瑞吉外卖项目——总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文为个人学习黑马《瑞吉外卖》项目后进行的项目总结，更偏向于对自己编写文本能力的锻炼以及对项目知识点的简短记录。因为个人能力问题，其中可行性分析和测试部分只进行了小标题的陈列，并没有进行编辑。对《瑞吉外卖》项目感兴趣的朋友也可以浏览本文后再去学习，可以对该项目架构有大体感知，同时黑马《瑞吉外卖》非常适合做各位朋友的入门项目，大力推荐本项目。</p> 
<h3><br> 1.1 项目背景</h3> 
<p><br> 随着我国城镇和农村居民生活水平达到富裕和小康层次，消费在国民经济活动中的比重逐步加大，居民的餐饮消费逐渐从一日三餐的刚需升级到感受餐饮文化以及社交的重要方式，近年来我国餐饮业销售收入逐年攀升，2019年中国餐饮收入达4.67万亿元，较2018年增加了0.40万亿元，同比增长9.38%，受新冠肺炎疫情影响，2020年中国餐饮收入大幅下滑，随着国内疫情的有效控制，中国餐饮市场也逐渐复苏，2021年中国餐饮收入完成4.69万亿元，较2020年增加了0.74万亿元，同比增长18.64%。“新冠疫情”改变了人们的就餐习惯，对于病毒的心理障碍，更多人选择外卖的方式来就餐，截止2021年12月末中国网上外卖用户规模达54416万人，较2020年同期增加了12533万人，同比增长29.92%。“新冠疫情”改变了人们的就餐习惯，对于病毒的心理障碍，更多人选择外卖的方式来就餐，截止2021年12月末中国网上外卖用户规模达54416万人，较2020年同期增加了12533万人，同比增长29.92%。 </p> 
<h4>1.2 项目介绍</h4> 
<p><br> 本项目（瑞吉外卖）是专门为餐厅、饭店定制的一款软件产品，包括系统管理后台和移动端应用两部分。其中系统管理后台主要提供给餐饮内部员工使用，可以对餐厅的菜品、套餐、订单进行管理和维护。移动端应用主要提供给消费者使用，可以在线浏览菜品、添加购物车、下单等。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/1a/50/zTOyGALY_o.png"></p> 
<p> </p> 
<h3>1.3 项目亮点</h3> 
<h4><br> 1、使用Redis进行缓存</h4> 
<p>当用户数量较多时，系统访问量大，频繁的访问数据库，数据库压力大，系统的性能下降，用户体验感差。因此使用Redis对数据进行缓存，从而减小数据库的压力，在数据更新时删除缓存，从而保证数据库和缓存的一致性，同时有效提高系统的性能和访问速度。</p> 
<h4>2、使用MySQL主从复制，进行读写分离</h4> 
<p>读和写数据的所有压力全都由一台数据库承担，压力大，数据库服务器磁盘损坏则数据丢失，单点故障。使用MySQL进行主从复制，主库(master)进行写操作（intsert update delete），从库（salve）进行读操作（select），从而减轻数据库负担，增大系统承受能力，提高系统性能。本项目使用Sharding-JDBC在程序中实现读写分离。</p> 
<p>注：MySQL主从复制是一个异步的复制过程，底层是基于Mysql数据库目带的二进制日志功能。就是一台或多台MySQL数据库(slave，即从库)从另一台MySQL数据库(master，即主库）进行日志的复制然后再解析日志并应用到自身，最终实现从库的数据和主库的数据保持一致。MySQL主从复制是MysQL数据库自带功能，无需借助第三方工具。</p> 
<h4>3、前后端分别部署，使用Nginx进行反向代理</h4> 
<p>前端页面部署到Nginx服务器中，后端代码部署到后端服务器中，使用Nginx对后端服务器进行反向代理，使用户只需要访问Nginx服务器便可获得后端服务器的服务（便于后期扩展集群，提高系统并发量）。</p> 
<h3>技术</h3> 
<p>SpringBoot+<a href="https://so.csdn.net/so/search?q=SSM&amp;spm=1001.2101.3001.7020" title="SSM">SSM</a> 企业级项目<br> SSM=Spring+Spring MVC+MyBatis</p> 
<p><img alt="" src="https://images2.imgbox.com/ac/08/jzWowvUB_o.png"></p> 
<p> nginx 是服务器，主要部署静态资源。前端请求nginx服务器，再分发到多个tomcat服务器。<br> Spring Session解决集群的session共享问题。<br> Swagger：前后端分离使用。<br> Redis：主要用作缓存。</p> 
<h3>展示</h3> 
<p>移动端：展示数据，消费者使用<br> +<br> 后台管理：维护数据，餐饮企业使用</p> 
<p><img alt="" src="https://images2.imgbox.com/da/33/2MwkqPgF_o.png"></p> 
<h3>数据表</h3> 
<p> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/1c/c0/o0WY2SIm_o.png"></p> 
<p></p> 
<p>一个套餐是多个菜品的集合；<br> 一个菜品有多个口味；<br> 一个顾客可以同时把多个菜品和多个套餐放入购物车中。</p> 
<p><a name="t4"></a><a id="sl4j_22"></a>slf4j</p> 
<p>@sl4j是lombok提供的</p> 
<h2><a name="t5"></a><a id="_25"></a>功能开发：</h2> 
<h3><a name="t6"></a><a id="_26"></a>员工管理</h3> 
<h4><a name="t7"></a><a id="1__28"></a>1. 后台登录</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/00/4c/dXXpHUVH_o.png"></p> 
<p>登录时，以json格式将数据发送至后端</p> 
<p>开启驼峰命名<br> id是雪花算法自动生成的</p> 
<p> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/b3/a4/cp1JoxpC_o.png"></p> 
<p>mp规范：</p> 
<p> <img alt="" src="https://images2.imgbox.com/1f/9c/DZwJk4Mk_o.png"></p> 
<p> 通用结果类 R<br> 后端返给前端的响应结果</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/32/86/hlqb2WgE_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/cb/23/mZ7G4CAg_o.png"></p> 
<p>前端使用的是json数据 </p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/08/27/j1AUiMyw_o.png"> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/80/9c/FXJdqhqg_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/61/ec/Z24WIgCI_o.png"></p> 
<p>数据库存储的密码是加密过的<br> md5加密 </p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/0f/06/gUBRQ3eo_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/01/0a/iL4KLC7d_o.png">  </p> 
<p>错误时，前端展示 </p> 
<p> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/8a/13/QmxjEZam_o.png"></p> 
<h4>2. 后台退出</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/42/nmceTGGQ_o.png"></p> 
<h4>3. 完善登录 </h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/31/f3/XNiODFNN_o.png"></p> 
<p> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/33/c4/pfAo71Gb_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/e6/00/x3f9WFsp_o.png"><img alt="在这里插入图片描述" src="https://images2.imgbox.com/14/c1/ubBtxLZw_o.png"></p> 
<p> {}是占位符，将会显示逗号后面的内容</p> 
<p> <img alt="" src="https://images2.imgbox.com/9d/83/dOcFcDYx_o.png"></p> 
<p>传给前端json数据</p> 
<h4><a name="t10"></a><a id="4__70"></a>4. 新增员工</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/e0/c4/9kUjkenk_o.png"></p> 
<p>账号设置了唯一的属性，添加相同账号时，数据库抛了异常 </p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/bd/44/IL1CFi7Q_o.png"></p> 
<p>全局异常捕获：注解是xxx的类，异常是xxx时，就会被拦截处理<br> 注解是RestController和Controller<br> @ResponseBody，返回json数据</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/a7/97/U2hfhrBt_o.png"></p> 
<p>5.员工信息分页查询</p> 
<p><img alt="" src="https://images2.imgbox.com/dc/c9/dD3wc5J1_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/96/82/wDhoZSKK_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/86/47/zdGEKPyb_o.png"></p> 
<p>like的第一个条件是if的判断<br> page查询不需返回，会自动放入pageInfo对象并返回<br> 传给前端的是数字，前端做的解析并展示</p> 
<h4>6. 启用/禁用员工账号 </h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/09/24/BzmnQEdW_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/15/36/qV1aeXkT_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/e3/c6/k8RU46No_o.png"></p> 
<p>消息转换器<img alt="在这里插入图片描述" src="https://images2.imgbox.com/82/20/fwwyOjNj_o.png"> </p> 
<h4>7. 编辑员工信息 </h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/b0/aa/uHWm9emP_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/eb/y7u4gGEW_o.png"></p> 
<h3>分类管理</h3> 
<h4><a name="t15"></a><a id="1__97"></a>1. 公共字段自动填充</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/42/47/4Dppl2qo_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/16/9d/cEodMY69_o.png"></p> 
<p>功能完善：使用ThreadLocal获取当前用户id<br> 一次请求，涉及的所有方法，属于同一个线程<br><img alt="在这里插入图片描述" src="https://images2.imgbox.com/ea/29/bBPLWbOq_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/b9/2e/vcpamRZ8_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/1d/dd/WJ4ouwJv_o.png"></p> 
<h3>2. 新增分类 </h3> 
<p> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/14/0f/u0oVtSBQ_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/80/42/bhqHlNQD_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/15/91/U5pbMvPM_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/33/XFGianWA_o.png"></p> 
<h4>3. 分类信息分页查询</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/66/8b/CImdhvtW_o.png"></p> 
<h4><img alt="在这里插入图片描述" src="https://images2.imgbox.com/5b/f0/uRlT9BDc_o.png"></h4> 
<h4>4. 删除分类</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/9d/b0/C9dvr6vm_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/47/41/bQosqRTt_o.png"></p> 
<p>dish 菜品<br> setmeal 套餐</p> 
<p>自定义业务异常</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/6f/aa/CeRTLaSB_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/fc/56/Kif6kTmG_o.png"></p> 
<p>全局异常处理器捕获自定义异常</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/04/87/96oXIoYZ_o.png"></p> 
<h4>5.修改分类</h4> 
<h3><a name="t20"></a><a id="_126"></a>菜品管理</h3> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/65/e1/0rwzG1gi_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/ff/95/U0U5U31J_o.png"></p> 
<h4>1.文件上传下载</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/c7/05/C98TB6Y0_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/38/58/hUNJpgUV_o.png"></p> 
<p>file首先存储在一个临时文件中，请求完成后会自动删除</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/d6/7b/a9FsRP2x_o.png"></p> 
<p>参数名必须是file，和前端的name=file保持一致</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/85/87/IDjdvlMY_o.png"></p> 
<p>手动改为jpg，其实是同一个文件</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/84/1d/mja67Nn4_o.png"></p> 
<p>配置文件</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/04/bc/urar7tQx_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/a2/a6/ooAWSKss_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/49/66/bgoHlxMQ_o.png"></p> 
<p>使用原始文件名</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/d6/4c/X8SM51jp_o.png"></p> 
<p>使用uuid生成随机文件名<br> 加上原始文件的后缀，lastIndexOf()包括了“点”</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/7f/38/fT2gv694_o.png"></p> 
<p> 配置文件，必须存在配置的目录，所以代码需要首先判断是否存在，不存在则创建<br> File既是文件，又是目录</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/21/a1/NMee3WQ4_o.png"></p> 
<p>目录：配置地址，判断是否存在<br> +<br> 文件：uuid文件名+截取原始后缀</p> 
<p>最后，需要给页面传送文件名</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/7b/2f/jdfM3jde_o.png"></p> 
<p>文件下载<br> 通过流传给浏览器，所以方法无需返回值，是void</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/7f/46/j3ZCGVlF_o.png"></p> 
<p>两个流，一个input流，读完的数据放入数组中，然后再将数据放入output流。最后刷新，关闭两个流。<br> 实际上是：input流，读一节数组的长度，放入数组中，流到output流中；再读一节…</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/d4/15/yAJQMSeO_o.png"></p> 
<p>2. 新增菜品</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/b2/63/L8Rw6WLc_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/c3/fd/OJwde1zR_o.png"></p> 
<p>菜品表</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/a9/20/1oiT3pS7_o.png"></p> 
<p>口味表</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/05/d3/Ul6GAZvg_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/a1/9b/JN8XAA2g_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/66/0e/LO9y6LSN_o.png"></p> 
<p> 菜品的下拉列表，选择菜品分类</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/14/12/VfgFQsxI_o.png"></p> 
<p>新增菜品</p> 
<p></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/9a/5a/B4Edpek2_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/c3/4c/HuqWlld5_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/08/f8/4tNmbtVf_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/99/b4/dOtJCxx6_o.png"></p> 
<h4>3. 菜品信息分页查询 </h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/cf/e6/LG9PEAQR_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/96/9c/bou57OC4_o.png"></p> 
<p>发送了多个请求<br> 此时，菜品分类前端展示有问题，只是id</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/54/e7/kKVuPbQT_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/f7/c9/rbCLfgoi_o.png"></p> 
<p>原始代码：</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/5b/17/SKLx4JrI_o.png"></p> 
<p>页面需要dto</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/d8/e9/e3ZFK8GR_o.png">拷贝属性，第一个属性：源，第二个属性：目标，第三个属性：不拷贝哪些<br> records 单独赋值</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/3e/cc/DRj8tG42_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/ae/80/sXcWdE5m_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/19/7b/yEW6LJg5_o.png"></p> 
<h4>4. 修改菜品 </h4> 
<p>回显数据</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/81/a0/7H95CVIo_o.png"></p> 
<h3>5. 套餐管理</h3> 
<h4><a name="t26"></a><a id="1__202"></a>1. 新增套餐</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/8d/2f/ZMCD38LP_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/1e/b8/IvAUIVKV_o.png"></p> 
<p> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/b4/92/dGmSEags_o.png"></p> 
<h4>2. 套餐信息分页查询</h4> 
<p>在开发代码之前,需要梳理一下套餐分页查询时前端页面和服务端的交互过程:<br> 1、页面(backend/page/combo/list.html)发送ajax请求,将分页查询参数(page、pageSize、name)提交到服务端,获取分页数据<br> 2、页面发送请求,请求服务端进行图片下载,用于页面图片展示<br> 开发套餐信息分页查询功能,其实就是在服务端编写代码去处理前端页面发送的这2次请求即可。</p> 
<p><strong>请求URL: http://127.0.0.1:8080/setmeal/page      </strong></p> 
<p><strong>请求方式：GET                </strong></p> 
<p><strong>参数：page，pageSize，name</strong></p> 
<p><strong>controller.SetmealController</strong></p> 
<pre><code class="hljs">   @Autowired
    private CategoryService categoryService;
@GetMapping("/page")
public R&lt;Page&gt; page(int page,int pageSize,String name){
    //分页构造器对象
    Page&lt;Setmeal&gt; pageInfo = new Page&lt;&gt;(page,pageSize);
    Page&lt;SetmealDto&gt; dtoPage = new Page&lt;&gt;(page,pageSize);
 
    LambdaQueryWrapper&lt;Setmeal&gt; queryWrapper = new LambdaQueryWrapper&lt;&gt;();
    //添加查询条件，根据name进行like模糊查询
    queryWrapper.like(name!= null ,Setmeal::getName,name);
    //添加排序条件，根据跟新时间降序排列
    queryWrapper.orderByDesc(Setmeal::getUpdateTime);
 
    setmealService.page(pageInfo,queryWrapper);
    //拷贝对象
    BeanUtils.copyProperties(pageInfo,dtoPage,"records");
    List&lt;Setmeal&gt; records = pageInfo.getRecords();
 
    List&lt;SetmealDto&gt; list=records.stream().map((item)-&gt;{
        SetmealDto setmealDto = new SetmealDto();
        //对象拷贝
        BeanUtils.copyProperties(item,setmealDto);
        //分类id
        Long categoryId = item.getCategoryId();
        //根据分类id查询分类对象
        Category category = categoryService.getById(categoryId);
        if(category != null){
            String categoryName = category.getName();
            setmealDto.setCategoryName(categoryName);
        }
        return setmealDto;
    }).collect(Collectors.toList());
 
    dtoPage.setRecords(list);
return R.success(dtoPage);
 
}</code></pre> 
<h4><a name="t28"></a><a id="3__208"></a>3. 删除套餐</h4> 
<p>套餐菜品关系表的原因：因为一个菜品可能不属于任何一个套餐啊！所以没有在菜品表中增加一个字段，而是新增了一整张表。</p> 
<p>在套餐管理列表页面点击删除按钮,可以删除对应的套餐信息。也可以通过复选框选择多个套餐，点击批量删除按钮一次删除多个套餐。注意,对于状态为售卖中的套餐不能删除，需要先停售，然后才能删除。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/55/f4/6wX1uMbW_o.png"> </p> 
<p> </p> 
<p>请求URL：http://127.0.0.1:8080/setmeal                  </p> 
<p>⚝ 请求方式：DELETE              </p> 
<p>⚝ 参数：ids    </p> 
<p>参数说明：ids：被删除的id之间用“,”间隔        </p> 
<p>如：ids:1415580119015145474,1556280893128380418</p> 
<p>service.SetmealService<br>  </p> 
<pre><code class="hljs">/**
 * 删除套餐，同时需要删除套餐和菜品的关联数据
 * **/
 
public void removeWithDish(List&lt;Long&gt; ids);</code></pre> 
<p> <strong>SetmealServiceImpl</strong></p> 
<pre><code class="hljs">/**
 * 删除套餐，同时需要删除套餐和菜品的关联数据
 * **/
@Override
@Transactional
public void removeWithDish(List&lt;Long&gt; ids) {
 
    //查询套餐状态，确定是否可用删除（套餐的 status=1，表示套餐正在售卖，不能删除，如果非要删除需要停售套餐）
    //select count(*) from setmeal where id in (1,2,3) and status=1;
    LambdaQueryWrapper&lt;Setmeal&gt; queryWrapper = new LambdaQueryWrapper&lt;&gt;();
    queryWrapper.in(Setmeal::getId,ids);
    queryWrapper.eq(Setmeal::getStatus,1);
 
    int count = this.count(queryWrapper);
    if(count &gt;0){
        //如果不能删除，抛出一个业务异常
        throw  new CustomException("套餐正在售卖中，删除失败");
    }
    //如果可以删除，先删除套餐表中的数据--setmeal
    this.removeByIds(ids);
 
    //删除关系表中的数据--setmeal_dish
    //delete from setmeal_dish where setmeal_id in (1,2,3)
    LambdaQueryWrapper&lt;SetmealDish&gt; lambdaQueryWrapper = new LambdaQueryWrapper&lt;&gt;();
    lambdaQueryWrapper.in(SetmealDish::getSetmealId,ids);
    //删除关系表中的数据----setmeal_dish
    setmealDishService.remove(lambdaQueryWrapper);
}</code></pre> 
<p><strong>controller.SetmealController</strong></p> 
<pre><code class="hljs">//删除与批量删除套餐
@DeleteMapping
public R&lt;String&gt; delete(@RequestParam List&lt;Long&gt; ids){
    log.info("ids: {}",ids);
    setmealService.removeWithDish(ids);
 
    return R.success("套餐数据删除成功");
}</code></pre> 
<p>我们进入数据库手动将字段status=0使其停售。以便测试删除功能。</p> 
<p>以上就基础版的吉瑞外卖后台管理系统内容！！！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f575ef23b925b7736447e42da552ae38/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[Vue]计算属性</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/29841858ff282780b5b32ecc5d76b01f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">研一Python基础课程第一周课后习题分享（含代码）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>