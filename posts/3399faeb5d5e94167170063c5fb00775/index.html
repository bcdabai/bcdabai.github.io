<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows下安装flink服务 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows下安装flink服务" />
<meta property="og:description" content="下载 点击链接到下载页 https://flink.apache.org/zh/downloads.html
选择对应文件
下载后解压
启动 下载包中没有启动bat文件, 所以需要创建对应文件
flink.bat 用于执行task
::############################################################################### :: Licensed to the Apache Software Foundation (ASF) under one :: or more contributor license agreements. See the NOTICE file :: distributed with this work for additional information :: regarding copyright ownership. The ASF licenses this file :: to you under the Apache License, Version 2.0 (the :: &#34;License&#34;); you may not use this file except in compliance :: with the License." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3399faeb5d5e94167170063c5fb00775/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-08T17:27:39+08:00" />
<meta property="article:modified_time" content="2021-07-08T17:27:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows下安装flink服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>下载</h3> 
<ol><li> <p>点击链接到下载页 <a href="https://flink.apache.org/zh/downloads.html" rel="nofollow">https://flink.apache.org/zh/downloads.html</a></p> </li><li> <p>选择对应文件<br> <img src="https://images2.imgbox.com/f5/4e/e1KA8KkJ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>下载后解压</p> </li></ol> 
<h3><a id="_7"></a>启动</h3> 
<p>下载包中没有启动bat文件, 所以需要创建对应文件</p> 
<p><strong>flink.bat</strong> 用于执行task</p> 
<pre><code class="prism language-bash">::<span class="token comment">###############################################################################</span>
::  Licensed to the Apache Software Foundation <span class="token punctuation">(</span>ASF<span class="token punctuation">)</span> under one
::  or <span class="token function">more</span> contributor license agreements.  See the NOTICE <span class="token function">file</span>
::  distributed with this work <span class="token keyword">for</span> additional information
::  regarding copyright ownership.  The ASF licenses this <span class="token function">file</span>
::  to you under the Apache License, Version <span class="token number">2.0</span> <span class="token punctuation">(</span>the
::  <span class="token string">"License"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> you may not use this <span class="token function">file</span> except <span class="token keyword">in</span> compliance
::  with the License.  You may obtain a copy of the License at
::
::      http://www.apache.org/licenses/LICENSE-2.0
::
::  Unless required by applicable law or agreed to <span class="token keyword">in</span> writing, software
::  distributed under the License is distributed on an <span class="token string">"AS IS"</span> BASIS,
::  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
::  See the License <span class="token keyword">for</span> the specific language governing permissions and
:: limitations under the License.
::<span class="token comment">###############################################################################</span>

@echo off
setlocal

SET <span class="token assign-left variable">bin</span><span class="token operator">=</span>%~dp0
SET <span class="token assign-left variable">FLINK_HOME</span><span class="token operator">=</span>%bin%<span class="token punctuation">..</span>
SET <span class="token assign-left variable">FLINK_LIB_DIR</span><span class="token operator">=</span>%FLINK_HOME%<span class="token punctuation">\</span>lib
SET <span class="token assign-left variable">FLINK_PLUGINS_DIR</span><span class="token operator">=</span>%FLINK_HOME%<span class="token punctuation">\</span>plugins

SET <span class="token assign-left variable">JVM_ARGS</span><span class="token operator">=</span>-Xmx512m

SET <span class="token assign-left variable">FLINK_JM_CLASSPATH</span><span class="token operator">=</span>%FLINK_LIB_DIR%<span class="token punctuation">\</span>*

java %JVM_ARGS% -cp <span class="token string">"%FLINK_JM_CLASSPATH%"</span><span class="token punctuation">;</span> org.apache.flink.client.cli.CliFrontend %*

endlocal
</code></pre> 
<p><strong>start-cluster.bat</strong> 启动批处理文件</p> 
<pre><code class="prism language-bash">::<span class="token comment">###############################################################################</span>
::  Licensed to the Apache Software Foundation <span class="token punctuation">(</span>ASF<span class="token punctuation">)</span> under one
::  or <span class="token function">more</span> contributor license agreements.  See the NOTICE <span class="token function">file</span>
::  distributed with this work <span class="token keyword">for</span> additional information
::  regarding copyright ownership.  The ASF licenses this <span class="token function">file</span>
::  to you under the Apache License, Version <span class="token number">2.0</span> <span class="token punctuation">(</span>the
::  <span class="token string">"License"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> you may not use this <span class="token function">file</span> except <span class="token keyword">in</span> compliance
::  with the License.  You may obtain a copy of the License at
::
::      http://www.apache.org/licenses/LICENSE-2.0
::
::  Unless required by applicable law or agreed to <span class="token keyword">in</span> writing, software
::  distributed under the License is distributed on an <span class="token string">"AS IS"</span> BASIS,
::  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
::  See the License <span class="token keyword">for</span> the specific language governing permissions and
:: limitations under the License.
::<span class="token comment">###############################################################################</span>

@echo off
setlocal EnableDelayedExpansion

SET <span class="token assign-left variable">bin</span><span class="token operator">=</span>%~dp0
SET <span class="token assign-left variable">FLINK_HOME</span><span class="token operator">=</span>%bin%<span class="token punctuation">..</span>
SET <span class="token assign-left variable">FLINK_LIB_DIR</span><span class="token operator">=</span>%FLINK_HOME%<span class="token punctuation">\</span>lib
SET <span class="token assign-left variable">FLINK_PLUGINS_DIR</span><span class="token operator">=</span>%FLINK_HOME%<span class="token punctuation">\</span>plugins
SET <span class="token assign-left variable">FLINK_CONF_DIR</span><span class="token operator">=</span>%FLINK_HOME%<span class="token punctuation">\</span>conf
SET <span class="token assign-left variable">FLINK_LOG_DIR</span><span class="token operator">=</span>%FLINK_HOME%<span class="token punctuation">\</span>log

SET <span class="token assign-left variable">JVM_ARGS</span><span class="token operator">=</span>-Xms1024m -Xmx1024m

SET <span class="token assign-left variable">FLINK_CLASSPATH</span><span class="token operator">=</span>%FLINK_LIB_DIR%<span class="token punctuation">\</span>*

SET <span class="token assign-left variable">logname_jm</span><span class="token operator">=</span>flink-%username%-jobmanager.log
SET <span class="token assign-left variable">logname_tm</span><span class="token operator">=</span>flink-%username%-taskmanager.log
SET <span class="token assign-left variable">log_jm</span><span class="token operator">=</span>%FLINK_LOG_DIR%<span class="token punctuation">\</span>%logname_jm%
SET <span class="token assign-left variable">log_tm</span><span class="token operator">=</span>%FLINK_LOG_DIR%<span class="token punctuation">\</span>%logname_tm%
SET <span class="token assign-left variable">outname_jm</span><span class="token operator">=</span>flink-%username%-jobmanager.out
SET <span class="token assign-left variable">outname_tm</span><span class="token operator">=</span>flink-%username%-taskmanager.out
SET <span class="token assign-left variable">out_jm</span><span class="token operator">=</span>%FLINK_LOG_DIR%<span class="token punctuation">\</span>%outname_jm%
SET <span class="token assign-left variable">out_tm</span><span class="token operator">=</span>%FLINK_LOG_DIR%<span class="token punctuation">\</span>%outname_tm%

SET <span class="token assign-left variable">log_setting_jm</span><span class="token operator">=</span>-Dlog.file<span class="token operator">=</span><span class="token string">"%log_jm%"</span> -Dlogback.configurationFile<span class="token operator">=</span>file:<span class="token string">"%FLINK_CONF_DIR%/logback.xml"</span> -Dlog4j.configuration<span class="token operator">=</span>file:<span class="token string">"%FLINK_CONF_DIR%/log4j.properties"</span>
SET <span class="token assign-left variable">log_setting_tm</span><span class="token operator">=</span>-Dlog.file<span class="token operator">=</span><span class="token string">"%log_tm%"</span> -Dlogback.configurationFile<span class="token operator">=</span>file:<span class="token string">"%FLINK_CONF_DIR%/logback.xml"</span> -Dlog4j.configuration<span class="token operator">=</span>file:<span class="token string">"%FLINK_CONF_DIR%/log4j.properties"</span>

:: Log rotation <span class="token punctuation">(</span>quick and dirty<span class="token punctuation">)</span>
CD <span class="token string">"%FLINK_LOG_DIR%"</span>
<span class="token keyword">for</span> /l %%x <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">5</span>, -1, <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span> 
SET /A y <span class="token operator">=</span> %%x+1 
RENAME <span class="token string">"%logname_jm%.%%x"</span> <span class="token string">"%logname_jm%.!y!"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
RENAME <span class="token string">"%logname_tm%.%%x"</span> <span class="token string">"%logname_tm%.!y!"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
RENAME <span class="token string">"%outname_jm%.%%x"</span> <span class="token string">"%outname_jm%.!y!"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
RENAME <span class="token string">"%outname_tm%.%%x"</span> <span class="token string">"%outname_tm%.!y!"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
<span class="token punctuation">)</span>
RENAME <span class="token string">"%logname_jm%"</span> <span class="token string">"%logname_jm%.0"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
RENAME <span class="token string">"%logname_tm%"</span> <span class="token string">"%logname_tm%.0"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
RENAME <span class="token string">"%outname_jm%"</span> <span class="token string">"%outname_jm%.0"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
RENAME <span class="token string">"%outname_tm%"</span> <span class="token string">"%outname_tm%.0"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
DEL <span class="token string">"%logname_jm%.6"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
DEL <span class="token string">"%logname_tm%.6"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
DEL <span class="token string">"%outname_jm%.6"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul
DEL <span class="token string">"%outname_tm%.6"</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> nul

<span class="token keyword">for</span> %%X <span class="token keyword">in</span> <span class="token punctuation">(</span>java.exe<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>set <span class="token assign-left variable">FOUND</span><span class="token operator">=</span>%%~<span class="token environment constant">$PATH</span>:X<span class="token punctuation">)</span>
<span class="token keyword">if</span> not defined FOUND <span class="token punctuation">(</span>
    <span class="token builtin class-name">echo</span> java.exe was not found <span class="token keyword">in</span> <span class="token environment constant">PATH</span> variable
    goto :eof
<span class="token punctuation">)</span>

<span class="token builtin class-name">echo</span> Starting a <span class="token builtin class-name">local</span> cluster with one JobManager process and one TaskManager process.

<span class="token builtin class-name">echo</span> You can terminate the processes via CTRL-C <span class="token keyword">in</span> the spawned shell windows.

<span class="token builtin class-name">echo</span> Web interface by default on http://localhost:8081/.

start java %JVM_ARGS% %log_setting_jm% -cp <span class="token string">"%FLINK_CLASSPATH%"</span><span class="token punctuation">;</span> org.apache.flink.runtime.entrypoint.StandaloneSessionClusterEntrypoint --configDir <span class="token string">"%FLINK_CONF_DIR%"</span> <span class="token operator">&gt;</span> <span class="token string">"%out_jm%"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
start java %JVM_ARGS% %log_setting_tm% -cp <span class="token string">"%FLINK_CLASSPATH%"</span><span class="token punctuation">;</span> org.apache.flink.runtime.taskexecutor.TaskManagerRunner --configDir <span class="token string">"%FLINK_CONF_DIR%"</span> <span class="token operator">&gt;</span> <span class="token string">"%out_tm%"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>

endlocal
</code></pre> 
<p><strong>双击start-cluster.bat文件</strong></p> 
<p>启动, 期望结果会有两个执行框, 但是有一个会默认闪现, 因为部分参数没有设置, 一个一个报错.</p> 
<p><strong>编辑conf/flink-conf.yaml文件</strong></p> 
<pre><code class="prism language-yaml"><span class="token key atrule">taskmanager.cpu.cores</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token key atrule">taskmanager.memory.task.heap.size</span><span class="token punctuation">:</span> 1024M
<span class="token key atrule">taskmanager.memory.managed.size</span><span class="token punctuation">:</span> 1000M

<span class="token key atrule">taskmanager.memory.network.min</span><span class="token punctuation">:</span> 300M
<span class="token key atrule">taskmanager.memory.network.max</span><span class="token punctuation">:</span> 300M
</code></pre> 
<h3><a id="_143"></a>测试</h3> 
<p>执行命令 <strong>flink.bat run …/examples/batch</strong></p> 
<pre><code class="prism language-bash">D:<span class="token punctuation">\</span>data<span class="token punctuation">\</span>flink-1.12.4<span class="token punctuation">\</span>bin<span class="token operator">&gt;</span>flink.bat run <span class="token punctuation">..</span>/examples/batch/WordCount.jar
ERROR StatusLogger No Log4j <span class="token number">2</span> configuration <span class="token function">file</span> found. Using default configuration <span class="token punctuation">(</span>logging only errors to the console<span class="token punctuation">)</span>, or user programmatically provided configurations. Set system property <span class="token string">'log4j2.debug'</span> to show Log4j <span class="token number">2</span> internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html <span class="token keyword">for</span> instructions on how to configure Log4j <span class="token number">2</span>
Executing WordCount example with default input data set.
Use --input to specify <span class="token function">file</span> input.
Printing result to stdout. Use --output to specify output path.
Job has been submitted with JobID 7548c2981f26630a52575fb20f39a68e
Program execution finished
Job with JobID 7548c2981f26630a52575fb20f39a68e has finished.
Job Runtime: <span class="token number">3616</span> ms
Accumulator Results:
- 5c5d6bde4d73d599bb2fb7e28b1f6cd1 <span class="token punctuation">(</span>java.util.ArrayList<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">170</span> elements<span class="token punctuation">]</span>


<span class="token punctuation">(</span>a,5<span class="token punctuation">)</span>
<span class="token punctuation">(</span>action,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>after,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>against,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>all,2<span class="token punctuation">)</span>
<span class="token punctuation">(</span>and,12<span class="token punctuation">)</span>
<span class="token punctuation">(</span>arms,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>arrows,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>awry,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>ay,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>bare,1<span class="token punctuation">)</span>
<span class="token punctuation">(</span>be,4<span class="token punctuation">)</span>
<span class="token punctuation">(</span>bear,3<span class="token punctuation">)</span>
</code></pre> 
<p>启动成功!!!</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0926d246577923997a9960921f53d1f5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">html css中margin的用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6c227327fdb6f1ea650bc01f0de132fc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Constructor：构造器，this 关键字,static:静态的,block 块,debug 调试工具</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>