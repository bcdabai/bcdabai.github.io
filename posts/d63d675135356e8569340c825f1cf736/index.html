<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>大型数据库（1）--- Hive安装与配置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="大型数据库（1）--- Hive安装与配置" />
<meta property="og:description" content="安装说明 安装环境 虚拟机：VirtualBox-6.1.18
操作系统：Ubuntu16.04LTS
基础软件 JDK：jdk-8u281-linux-x64.tar.gz
hadoop：hadoop2.7.3
MySQL：Server version: 5.7.33-0ubuntu0.16.04.1 (Ubuntu)
集群情况：
主机名称Hadoop版本IP地址hadoop-master2.7.3192.168.56.1hadoop-slave12.7.3192.168.56.2hadoop-slave22.7.3192.168.56.3 本次安装的Hive Hive版本：3.1.2
下载地址：apache-hive-3.1.2-bin.tar.gz.
其他：Hive官网 、查看不同版本.
都准备就绪后，我们就接着往下开始安装吧！
不知道怎么准备的，我之前的文章 也许可以给你带来一些参考哦 - - - ☞ 传送门
开始安装 我的两个基础软件Hadoop、Java 分别是在/usr/hadoop 和 /usr/java下
其他的都安装在 ~/Hadoop 的文件夹下
Hive的安装仅在hadoop-master下安装即可，无需在slave机上部署
配置MySQL 没安装的直接用apt install安装即可，一搜一大把
当前是root用户登录mysql
1.创建hadoop用户
grant all on *.* to hadoop@&#39;%&#39; identified by &#39;hadoop&#39;; grant all on *.* to hadoop@&#39;localhost&#39; identified by &#39;hadoop&#39;; grant all on *.* to hadoop@&#39;hadoop-master&#39; identified by &#39;hadoop&#39;; // mysql&gt; grant all on *." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d63d675135356e8569340c825f1cf736/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-18T03:44:45+08:00" />
<meta property="article:modified_time" content="2021-09-18T03:44:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">大型数据库（1）--- Hive安装与配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>安装说明</h2> 
<h3><a id="_2"></a>安装环境</h3> 
<p>虚拟机：VirtualBox-6.1.18<br> 操作系统：Ubuntu16.04LTS</p> 
<h3><a id="_7"></a>基础软件</h3> 
<p>JDK：jdk-8u281-linux-x64.tar.gz<br> hadoop：hadoop2.7.3<br> MySQL：Server version: 5.7.33-0ubuntu0.16.04.1 (Ubuntu)</p> 
<p>集群情况：</p> 
<table><thead><tr><th>主机名称</th><th>Hadoop版本</th><th>IP地址</th></tr></thead><tbody><tr><td>hadoop-master</td><td>2.7.3</td><td>192.168.56.1</td></tr><tr><td>hadoop-slave1</td><td>2.7.3</td><td>192.168.56.2</td></tr><tr><td>hadoop-slave2</td><td>2.7.3</td><td>192.168.56.3</td></tr></tbody></table> 
<h3><a id="Hive_19"></a>本次安装的Hive</h3> 
<p>Hive版本：3.1.2<br> 下载地址：<a href="https://apache.website-solution.net/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz" rel="nofollow">apache-hive-3.1.2-bin.tar.gz</a>.<br> 其他：<a href="https://hive.apache.org/" rel="nofollow">Hive官网</a> 、<a href="https://apache.website-solution.net/hive/" rel="nofollow">查看不同版本</a>.</p> 
<p>都准备就绪后，我们就接着往下开始安装吧！<br> 不知道怎么准备的，我之前的文章 也许可以给你带来一些参考哦 - - - ☞ <a href="https://blog.csdn.net/li1055107552/article/details/114767752">传送门</a></p> 
<hr> 
<h2><a id="_29"></a>开始安装</h2> 
<p>我的两个基础软件Hadoop、Java 分别是在/usr/hadoop 和 /usr/java下<br> 其他的都安装在 ~/Hadoop 的文件夹下<br> Hive的安装仅在<strong>hadoop-master</strong>下安装即可，无需在slave机上部署</p> 
<br> 
<h3><a id="MySQL_36"></a>配置MySQL</h3> 
<p>没安装的直接用<code>apt install</code>安装即可，一搜一大把<br> 当前是root用户登录mysql</p> 
<p>1.创建hadoop用户</p> 
<pre><code class="prism language-sql"><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> hadoop<span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'hadoop'</span><span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> hadoop<span class="token variable">@'localhost'</span> identified <span class="token keyword">by</span> <span class="token string">'hadoop'</span><span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> hadoop<span class="token variable">@'hadoop-master'</span> identified <span class="token keyword">by</span> <span class="token string">'hadoop'</span><span class="token punctuation">;</span>

<span class="token comment">// mysql&gt; grant all on *.* to 'hadoop'@'%' identified by 'hadoop' with grant option;</span>
</code></pre> 
<p>2.刷新权限</p> 
<pre><code class="prism language-sql">flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.创建Hive数据库</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> hive
</code></pre> 
<p>重启mysql服务：<code>$ sudo service mysql restart</code></p> 
<br> 
<h3><a id="Hive_62"></a>安装并配置Hive</h3> 
<h4><a id="1__63"></a>1. 解压</h4> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span> ~/下载
$ <span class="token function">cp</span> apache-hive-3.1.2-bin.tar.gz ~/Hadoop
$ <span class="token builtin class-name">cd</span> ~/Hadoop
$ <span class="token function">tar</span> -zxvf apache-hive-3.1.2-bin.tar.gz
$ <span class="token function">mv</span> apache-hive-3.1.2-bin hive-3.1.2
$ <span class="token builtin class-name">cd</span> hive-3.1.2/conf
</code></pre> 
<br> 
<h4><a id="2__74"></a>2. 配置</h4> 
<h5><a id="21_hiveenvsh_75"></a>2.1 hive-env.sh</h5> 
<pre><code class="prism language-shell">// 复制一份 hive-env.sh 的模版	
$ <span class="token function">cp</span> hive-env.sh.template hive-env.sh

// hive-env.sh 将第48行注释去掉，改为
<span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/usr/hadoop	（你hadoop安装的位置）
</code></pre> 
<h5><a id="22_hivesitexml_84"></a>2.2 hive-site.xml</h5> 
<pre><code class="prism language-xml">// 创建一个新文件 hive-site.xml
$ gedit hive-site.xml

// 添加以下内容
<span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token prolog">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.local<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://192.168.56.1:3306/hive?createDatabaseIfNotExist=true<span class="token entity named-entity" title="&amp;">&amp;amp;</span>characterEncoding=UTF-8<span class="token entity named-entity" title="&amp;">&amp;amp;</span>serverTimezone=GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionDriverName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionUserName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionPassword<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>datanucleus.schema.autoCreateAll<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.schema.verification<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>

// 注意这里本机(hadoop-master)的ip是192.168.56.1
// 连接mysql时用的hadoop用户和密码
</code></pre> 
<h5><a id="23__127"></a>2.3 环境变量</h5> 
<pre><code class="prism language-shell">// 这里直接是 /etc/profile，当然你也可以加到 .bash_profile 下也行
$ <span class="token function">sudo</span> gedit /etc/profile

// 然后在里面加入下面两句

<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_HOME</span><span class="token operator">=</span>/home/xld/Hadoop/hive
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$HIVE_HOME</span>/bin:<span class="token environment constant">$PATH</span>

// 保存并退出，然后使其生效
$ <span class="token builtin class-name">source</span> /etc/profile

</code></pre> 
<br> 
<h4><a id="3_mysqlconnector_144"></a>3. 导入mysql-connector</h4> 
<p>直接将mysql-connector的jar包丢到 <code>~/Hadoop/hive-3.1.2/lib</code> 目录下就好了<br> 这里用的是 mysql-connector-java-5.1.27-bin.jar，当然很多版本都可以啦，支持当前mysql版本都行<br> 下载地址：<a href="https://cdn.mysql.com/archives/mysql-connector-java-5.1/mysql-connector-java-5.1.27.tar.gz" rel="nofollow">mysql-connector-java-5.1.27.tar.gz</a></p> 
<br> 
<h4><a id="4_hive_151"></a>4. 启动hive</h4> 
<pre><code class="prism language-shell">$ <span class="token builtin class-name">cd</span>
$ hive

// 成功进入到hive页面后
hive<span class="token operator">&gt;</span> show databases<span class="token punctuation">;</span>

</code></pre> 
<blockquote> 
 <p>成功启动<br> <img src="https://images2.imgbox.com/5a/9f/B8ImX53N_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<hr> 
<h2><a id="_166"></a>其他错误</h2> 
<h3><a id="1_hiveFailed_to_get_schema_version_167"></a>1. hive启动Failed to get schema version报错</h3> 
<p>推荐参考：<a href="https://blog.csdn.net/liliblue/article/details/102594664">hive安装Failed to get schema version报错</a><br> 解决方法：注释掉 /etc/mysql/mysql.conf.d/mysqld.cnf 里面的这一句 bind-address = 127.0.0.1</p> 
<br> 
<h3><a id="2__173"></a>2. 显示有“拒绝连接”</h3> 
<p>推荐参考：<a href="https://blog.csdn.net/weixin_45627031/article/details/104554136">Exception in thread “main” java.lang.RuntimeException: java.net.ConnectException错误问题</a><br> 解决方法：启动Hadoop集群</p> 
<br> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/83bb380f914cdbe4b55c84f857f60cd8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">按关键字爬取网页信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fd0eca54b812baee9e749749ec06fd1e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git中的submodule操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>