<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python android 多国翻译提取整合工具 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python android 多国翻译提取整合工具" />
<meta property="og:description" content="Python android 多国翻译提取整合工具 前提功能 1功能 2代码实现 前提 使用了 BeautifulSoup, 我很懒
功能 1 提取 string.xml 资源文件的内容
&lt;string name=&#34;app_name&#34;&gt;App Name&lt;/string&gt; -&gt; App Name
功能 2 整合 翻译文件到源文件, 翻译文件每行代表一个翻译，不能有空行, 原理就是 按行替换资源文件的内容
&lt;string name=&#34;app_name&#34;&gt;App Name&lt;/string&gt; &#43; 应用名 -&gt; &lt;string name=&#34;app_name&#34;&gt;应用名&lt;/string&gt;
代码实现 from bs4 import BeautifulSoup is_write_translate = False source_path = &#34;strings.xml&#34; source_string_path = &#34;资源文件.txt&#34; translate_path = &#34;xxxx.txt&#34; source_translate_path = &#34;new_string.xml&#34; def write_to_file(path, text): with open(path, &#39;a&#39;, encoding=&#39;utf-8&#39;) as f: f.writelines(text &#43; &#39;\n&#39;) def get_xml_string_to_file(): file = open(source_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) soup = BeautifulSoup(file, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/91fe91eab3384608b194501012e4d8a9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-12T17:39:10+08:00" />
<meta property="article:modified_time" content="2018-11-12T17:39:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python android 多国翻译提取整合工具</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Python android 多国翻译提取整合工具</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">前提</a></li><li><a href="#_1_4" rel="nofollow">功能 1</a></li><li><a href="#_2_9" rel="nofollow">功能 2</a></li><li><a href="#_13" rel="nofollow">代码实现</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>前提</h3> 
<p>使用了 BeautifulSoup, 我很懒</p> 
<h3><a id="_1_4"></a>功能 1</h3> 
<p>提取 <code>string.xml</code> 资源文件的内容</p> 
<p><code>&lt;string name="app_name"&gt;App Name&lt;/string&gt;</code> -&gt; <code>App Name</code></p> 
<h3><a id="_2_9"></a>功能 2</h3> 
<p>整合 翻译文件到源文件, 翻译文件每行代表一个翻译，不能有空行, 原理就是 按行替换资源文件的内容<br> <code>&lt;string name="app_name"&gt;App Name&lt;/string&gt;</code> + <code>应用名</code> -&gt; <code>&lt;string name="app_name"&gt;应用名&lt;/string&gt;</code></p> 
<h3><a id="_13"></a>代码实现</h3> 
<pre><code>from bs4 import BeautifulSoup

is_write_translate = False
source_path = "strings.xml"
source_string_path = "资源文件.txt"
translate_path = "xxxx.txt"
source_translate_path = "new_string.xml"

def write_to_file(path, text):
    with open(path, 'a', encoding='utf-8') as f:
        f.writelines(text + '\n')

def get_xml_string_to_file():
    file = open(source_path, 'r', encoding='utf-8')
    soup = BeautifulSoup(file, "html.parser")
    soup.contains_replacement_characters = False
    string_tag = soup.find_all('string')
    for content in string_tag:
        write_to_file(source_string_path, content.string)

def write_translate_to_file():
    file = open(source_path, 'r', encoding='utf-8')
    soup = BeautifulSoup(file, "html.parser")
    soup.contains_replacement_characters = False
    string_tag = soup.find_all('string')
    write_to_file(source_translate_path, "&lt;resources&gt;")
    with open(translate_path, 'r', encoding='utf-8') as file_object:
        lines = file_object.readlines()
        i = 0
        line_len = len(lines)
        while i &lt; line_len:
            s = lines[i]
            if i &lt; line_len - 1:
                s = s[:-1]
            content = string_tag[i]
            content.string = s
            write_to_file(source_translate_path, str(content))
            i += 1
    write_to_file(source_translate_path, "&lt;/resources&gt;")

if __name__ == '__main__':
    temp_source_path = input("程序未做判空处理，确保输入有效，请输入原始文件路径:\n")
    if temp_source_path:
        source_path = temp_source_path
    flag = input("提取资源字符串请输入1， 整合翻译字符串请输入2: \n")
    if flag == '1':
        is_write_translate = False
    elif flag == '2':
        is_write_translate = True
    else:
        is_write_translate = False

    if is_write_translate:
        temp_translate_path = input("请输入翻译文件路径(txt 格式，不能有空行):\n")
        if temp_translate_path:
            translate_path = temp_translate_path
        temp_source_translate_path = input("请输入输出路径(xml):\n")
        if temp_source_translate_path:
            source_translate_path = temp_source_translate_path
        write_translate_to_file()
    else:
        temp_source_string_path = input("请输入输出路径(txt):\n")
        if temp_source_string_path:
            source_string_path = temp_source_string_path
        get_xml_string_to_file()
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fd62d1929d0701f2de2d528f6f3e51ab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ZUC密码算法 - Python实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8db8f77508e1fe2a7eeaf84db9a018de/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">日志工具logAPI 及 logback的使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>