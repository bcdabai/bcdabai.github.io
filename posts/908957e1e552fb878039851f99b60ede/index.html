<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>完全搞懂java中的时间戳，时区，日期格式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="完全搞懂java中的时间戳，时区，日期格式" />
<meta property="og:description" content="相关概念 【写在最前】
我们平时会接触各种计算机时间的概念，最常见的有GMT,UTC,CST等。
很多小白傻傻分不清楚他们之间的区别与联系，通过本文知识，让我们花5分钟时间彻底搞懂他，相信聪明的你，看完一定会有收获！
GMT 即：格林尼治时间（另有格林威治时间一说）
以本初子午线为基础，精确度相对低。
注意事项：
因为地球每天的自转是不规则的（正在缓慢减速）所以，格林尼治时间的精确度会越来越低。
UTC 即：世界协调时（Universal Time Coordinated的缩写）
以原子时钟长为基础，比GMT格林威治时更加科学更加精确。
UTC是国际无线电咨询委员会制定和推荐的，若与GMT时差大于0.9秒，则由位于巴黎的国际地球自转事务中央局发布闰秒，使UTC与地球自转周期一致。
UTC时间格式为：YYYY-MM-DDThh:mm:ssZ。例如，2014-11-11T12:00:00Z（为北京时间2014年11月11日20点0分0秒）
中国大陆、中国香港、中国澳门、中国台湾、蒙古国、新加坡、马来西亚、菲律宾、西澳大利亚州的时间与UTC的时差均为&#43;8，也就是UTC&#43;8。
注意事项：
1）目前UTC与GMT 相差为0.9秒，故二者可以基本视为一致。
我们一般认为GMT和UTC是一样的，都与英国伦敦的本地时相同。
2）早期的XP系统中，默认时间格式是GMT。而到了Win7之后，默认时间格式已经改成了UTC
3）阿里云API接口编程中，全部都是UTC
UNIX时间戳（timestamp） 计算机中的UNIX时间戳，是以GMT/UTC时间「1970-01-01T00:00:00」为起点，到当前具体时间的秒数(不考虑闰秒)。这样做的目的，主要是通过“整数计算”来简化计算机对时间操作的复杂度。
无论何种编程语言，基本都有获取unix时间戳的系统方法。
注意事项：
如果开发的软件系统仅仅在国内用，用timestamp没有太大问题（因为大家的linux服务器的时区是一样的）
如果软件系统需要跨国服务，则必须用UTC（比如阿里云API），否则就会因为服务器的UTC时区不同,导致timestamp结果值混乱
CST 这个代号缩写，并不是一个统一标准，目前，可以同时代表如下 4 个不同版本的时区概念（要根据上下文语义加以区分）：
1）China Standard Time 中国标准时区 (UTC&#43;8)
2）Cuba Standard Time 古巴标准时区 (UTC-4)
3）Central Standard Time (USA) 美国中央时区 (UTC-6)
4）Central Standard Time (Australia) 澳大利亚中央时区(UTC&#43;9)
总结 我们一般都认为UTC和GMT时间是相同的，时间戳的含义是 从本初子午线1970年1月1日至今所过去的毫秒数，时间戳与时区无关，如果再不同的时区，先通过时间戳得到一个时间之后，再加上时区的偏移量
Date 构造
public Date() { this(System.currentTimeMillis()); } public Date(long date) { fastTime = date; } 构造很简单，就是设置了一个long类型的时间戳" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/908957e1e552fb878039851f99b60ede/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-09T16:53:03+08:00" />
<meta property="article:modified_time" content="2022-07-09T16:53:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">完全搞懂java中的时间戳，时区，日期格式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/22/72/8x998uwy_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_2"></a>相关概念</h2> 
<p><img src="https://images2.imgbox.com/a1/81/wNynjhPU_o.png" alt="在这里插入图片描述"></p> 
<p>【写在最前】<br> 我们平时会接触各种计算机时间的概念，最常见的有GMT,UTC,CST等。<br> 很多小白傻傻分不清楚他们之间的区别与联系，通过本文知识，让我们花5分钟时间彻底搞懂他，相信聪明的你，看完一定会有收获！</p> 
<h3><a id="GMT_8"></a>GMT</h3> 
<p>即：格林尼治时间（另有格林威治时间一说）<br> 以本初子午线为基础，精确度相对低。<br> <strong>注意事项：</strong><br> 因为地球每天的自转是不规则的（正在缓慢减速）所以，格林尼治时间的精确度会越来越低。</p> 
<h3><a id="UTC_13"></a>UTC</h3> 
<p>即：世界协调时（Universal Time Coordinated的缩写）<br> 以原子时钟长为基础，比GMT格林威治时更加科学更加精确。</p> 
<p>UTC是国际无线电咨询委员会制定和推荐的，若与GMT时差大于0.9秒，则由位于巴黎的国际地球自转事务中央局发布闰秒，使UTC与地球自转周期一致。<br> UTC时间格式为：YYYY-MM-DDThh:mm:ssZ。例如，2014-11-11T12:00:00Z（为北京时间2014年11月11日20点0分0秒）<br> 中国大陆、中国香港、中国澳门、中国台湾、蒙古国、新加坡、马来西亚、菲律宾、西澳大利亚州的时间与UTC的时差均为+8，也就是UTC+8。<br> <strong>注意事项：</strong><br> 1）目前UTC与GMT 相差为0.9秒，故二者可以基本视为一致。<br> 我们一般认为GMT和UTC是一样的，都与英国伦敦的本地时相同。<br> 2）早期的XP系统中，默认时间格式是GMT。而到了Win7之后，默认时间格式已经改成了UTC<br> 3）阿里云API接口编程中，全部都是UTC</p> 
<h3><a id="UNIXtimestamp_25"></a>UNIX时间戳（timestamp）</h3> 
<p>计算机中的UNIX时间戳，是以GMT/UTC时间「1970-01-01T00:00:00」为起点，到当前具体时间的秒数(不考虑闰秒)。这样做的目的，主要是通过“整数计算”来简化计算机对时间操作的复杂度。<br> 无论何种编程语言，基本都有获取unix时间戳的系统方法。<br> <strong>注意事项：</strong><br> 如果开发的软件系统仅仅在国内用，用timestamp没有太大问题（因为大家的linux服务器的时区是一样的）<br> 如果软件系统需要跨国服务，则必须用UTC（比如阿里云API），否则就会因为服务器的UTC时区不同,导致timestamp结果值混乱</p> 
<h3><a id="CST_31"></a>CST</h3> 
<p>这个代号缩写，并不是一个统一标准，目前，可以同时代表如下 4 个不同版本的时区概念（要根据上下文语义加以区分）：<br> 1）China Standard Time 中国标准时区 (UTC+8)<br> 2）Cuba Standard Time 古巴标准时区 (UTC-4)<br> 3）Central Standard Time (USA) 美国中央时区 (UTC-6)<br> 4）Central Standard Time (Australia) 澳大利亚中央时区(UTC+9)</p> 
<h3><a id="_38"></a>总结</h3> 
<p>我们一般都认为UTC和GMT时间是相同的，时间戳的含义是 从本初子午线1970年1月1日至今所过去的毫秒数，时间戳与时区无关，如果再不同的时区，先通过时间戳得到一个时间之后，再加上时区的偏移量</p> 
<h2><a id="Date_40"></a>Date</h2> 
<p>构造</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token keyword">long</span> date<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    fastTime <span class="token operator">=</span> date<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>构造很简单，就是设置了一个long类型的时间戳<br> 时间戳转换为日期<br> java.util.Date#normalize()</p> 
<pre><code class="prism language-java">  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BaseCalendar<span class="token punctuation">.</span>Date</span> <span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    
            <span class="token class-name">BaseCalendar</span> cal <span class="token operator">=</span> <span class="token function">getCalendarSystem</span><span class="token punctuation">(</span>fastTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cdate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseCalendar<span class="token punctuation">.</span>Date</span><span class="token punctuation">)</span> cal<span class="token punctuation">.</span><span class="token function">getCalendarDate</span><span class="token punctuation">(</span>fastTime<span class="token punctuation">,</span>
                                                            <span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getDefaultRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> cdate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>获取日历，要么是格林尼治日历，要么是儒略日历，我们用到的正常都还是格林尼治时间，补研究儒略日历</p> 
<pre><code class="prism language-java">   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">BaseCalendar</span> <span class="token function">getCalendarSystem</span><span class="token punctuation">(</span><span class="token keyword">long</span> utc<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Quickly check if the time stamp given by `utc' is the Epoch</span>
        <span class="token comment">// or later. If it's before 1970, we convert the cutover to</span>
        <span class="token comment">// local time to compare.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>utc <span class="token operator">&gt;=</span> <span class="token number">0</span>
            <span class="token operator">||</span> utc <span class="token operator">&gt;=</span> <span class="token class-name">GregorianCalendar</span><span class="token punctuation">.</span>DEFAULT_GREGORIAN_CUTOVER
                        <span class="token operator">-</span> <span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getDefaultRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOffset</span><span class="token punctuation">(</span>utc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> gcal<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">getJulianCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>继续向下看，获取timeZone后进入</p> 
<pre><code class="prism language-java">  <span class="token keyword">public</span> <span class="token class-name">CalendarDate</span> <span class="token function">getCalendarDate</span><span class="token punctuation">(</span><span class="token keyword">long</span> var1<span class="token punctuation">,</span> <span class="token class-name">CalendarDate</span> var3<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> var4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> var5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> var6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> var7 <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
        <span class="token class-name">TimeZone</span> var9 <span class="token operator">=</span> var3<span class="token punctuation">.</span><span class="token function">getZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>var9 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var10 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>var9 <span class="token keyword">instanceof</span> <span class="token class-name">ZoneInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                var5 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ZoneInfo</span><span class="token punctuation">)</span>var9<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOffsets</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var10<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                var5 <span class="token operator">=</span> var9<span class="token punctuation">.</span><span class="token function">getOffset</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                var10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> var9<span class="token punctuation">.</span><span class="token function">getRawOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                var10<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> var5 <span class="token operator">-</span> var10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            var7 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var5 <span class="token operator">/</span> <span class="token number">86400000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            var4 <span class="token operator">=</span> var5 <span class="token operator">%</span> <span class="token number">86400000</span><span class="token punctuation">;</span>
            var6 <span class="token operator">=</span> var10<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        var3<span class="token punctuation">.</span><span class="token function">setZoneOffset</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        var3<span class="token punctuation">.</span><span class="token function">setDaylightSaving</span><span class="token punctuation">(</span>var6<span class="token punctuation">)</span><span class="token punctuation">;</span>
        var7 <span class="token operator">+=</span> var1 <span class="token operator">/</span> <span class="token number">86400000L</span><span class="token punctuation">;</span>
        var4 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var1 <span class="token operator">%</span> <span class="token number">86400000L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>var4 <span class="token operator">&gt;=</span> <span class="token number">86400000</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            var4 <span class="token operator">-=</span> <span class="token number">86400000</span><span class="token punctuation">;</span>
            <span class="token operator">++</span>var7<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>var4 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                var4 <span class="token operator">+=</span> <span class="token number">86400000</span><span class="token punctuation">;</span>
                <span class="token operator">--</span>var7<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        var7 <span class="token operator">+=</span> <span class="token number">719163L</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCalendarDateFromFixedDate</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> var7<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setTimeOfDay</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        var3<span class="token punctuation">.</span><span class="token function">setLeapYear</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isLeapYear</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        var3<span class="token punctuation">.</span><span class="token function">setNormalized</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> var3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/1b/Kt6gV4lF_o.png" alt="在这里插入图片描述"></p> 
<p>初始日期为全0<br> 依次求出时间戳的总天数 = 时间戳/86400000(一天的毫秒数)<br> 除去天出以外的时间毫秒数时间戳%86400000+偏移时区的毫秒数，例如上海是东八区，那就是再加上8<em>1000</em>60*60 = 28800000，这样小时的时间就加上了时区的偏移量。<br> 这样就根据时间戳得到了 年月日时分秒时区偏移后的日期。<br> <strong>toString</strong><br> <img src="https://images2.imgbox.com/32/0e/ZFnHFCHO_o.png" alt="在这里插入图片描述"></p> 
<p>最终打印结果</p> 
<h3><a id="TimeZone_132"></a>TimeZone</h3> 
<p>时区类，能够根据系统设置的时区获取偏移量（相对于本初子午线的0偏移）</p> 
<h3><a id="_134"></a>一个错误用法</h3> 
<p>目的时获取当天十天的0时0分0秒，比如现在时间时间是2022-07-07 18:13:33<br> 那么结果应该是2022-07-07 00:00:00</p> 
<pre><code class="prism language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> current<span class="token operator">=</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当前时间毫秒数</span>
        <span class="token comment">//获取今天0时的时间</span>
        <span class="token keyword">long</span> zero<span class="token operator">=</span>current<span class="token operator">/</span><span class="token number">86400000</span><span class="token operator">*</span><span class="token number">86400000</span><span class="token operator">-</span><span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRawOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Date</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<ol><li>获取到的当前时间戳</li><li>通过除86400000再乘86400000得到 整天的时间戳，时分秒的时间戳被舍弃，但是我们知道，时间戳的0时0分0秒，在中国的东八区会在加上8小时，这里他又减去了这偏移的8小时毫秒。看起来似乎没什么问题</li><li>但是他忘了，在0点-8点之间，对于时间戳来说，其本初子午线时间仍然在前一天，那么这个时候，他直接舍弃时分秒，再减去时区偏移8小时得到的时前一天的0时0分0秒，这种情况下的结果时错误的</li></ol> 
<h2><a id="Calendar_151"></a>Calendar</h2> 
<p>日历类</p> 
<pre><code class="prism language-java"> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Calendar</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">createCalendar</span><span class="token punctuation">(</span><span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token class-name">Locale<span class="token punctuation">.</span>Category</span><span class="token punctuation">.</span>FORMAT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>创建日历类，这里我们看格林尼治日历，可以对日期进行设置操作。针对的是日期<br> 构造</p> 
<pre><code class="prism language-java"> <span class="token class-name">GregorianCalendar</span><span class="token punctuation">(</span><span class="token class-name">TimeZone</span> zone<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">,</span> <span class="token keyword">boolean</span> flag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>zone<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gdate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseCalendar<span class="token punctuation">.</span>Date</span><span class="token punctuation">)</span> gcal<span class="token punctuation">.</span><span class="token function">newCalendarDate</span><span class="token punctuation">(</span><span class="token function">getZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>父类构造</p> 
<pre><code class="prism language-java">    <span class="token keyword">protected</span> <span class="token class-name">Calendar</span><span class="token punctuation">(</span><span class="token class-name">TimeZone</span> zone<span class="token punctuation">,</span> <span class="token class-name">Locale</span> aLocale<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        fields <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>FIELD_COUNT<span class="token punctuation">]</span><span class="token punctuation">;</span>
        isSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>FIELD_COUNT<span class="token punctuation">]</span><span class="token punctuation">;</span>
        stamp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>FIELD_COUNT<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>zone <span class="token operator">=</span> zone<span class="token punctuation">;</span>
        <span class="token function">setWeekCountData</span><span class="token punctuation">(</span>aLocale<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>共有17个字段</p> 
<pre><code class="prism language-java">
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> ERA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> YEAR <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MONTH <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> WEEK_OF_YEAR  <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

 
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> WEEK_OF_MONTH <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DATE <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

   
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DAY_OF_MONTH <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DAY_OF_YEAR <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>

  
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DAY_OF_WEEK <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>

  
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DAY_OF_WEEK_IN_MONTH <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> AM_PM <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>

   
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> HOUR <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

  
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> HOUR_OF_DAY <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>

   
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MINUTE <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>

   
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> SECOND <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>

  
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MILLISECOND <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>

  
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> ZONE_OFFSET <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>

  
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> DST_OFFSET <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java"> <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setWeekCountData</span><span class="token punctuation">(</span><span class="token class-name">Locale</span> desiredLocale<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">/* try to get the Locale data from the cache */</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> cachedLocaleData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>desiredLocale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">/* cache miss */</span>
            data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">CalendarDataUtility</span><span class="token punctuation">.</span><span class="token function">retrieveFirstDayOfWeek</span><span class="token punctuation">(</span>desiredLocale<span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">CalendarDataUtility</span><span class="token punctuation">.</span><span class="token function">retrieveMinimalDaysInFirstWeek</span><span class="token punctuation">(</span>desiredLocale<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cachedLocaleData<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>desiredLocale<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        firstDayOfWeek <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        minimalDaysInFirstWeek <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>默认，firstDayOfWeek和minimalDaysInFirstWeek都是1</p> 
<pre><code class="prism language-java">   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> SUNDAY <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MONDAY <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> TUESDAY <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> WEDNESDAY <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> THURSDAY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> FRIDAY <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> SATURDAY <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre> 
<p>默认一周的第一天为SUNDAY周日</p> 
<h3><a id="firstDayOfWeekminimalDaysInFirstWeek_259"></a>firstDayOfWeek和minimalDaysInFirstWeek含义</h3> 
<p>getFirstDayOfWeek()<br> 获取一星期的第一天；例如，在美国，这一天是 SUNDAY，而在法国，这一天是 MONDAY<br> getMinimalDaysInFirstWeek<br> getMinimalDaysInFirstWeek()<br> 获取一年中第一个星期所需的最少天数，例如，如果定义第一个星期包含一年第一个月的第一天，则此方法将返回 1。<br> 以上是JDK的解释，getFirstDayOfWeek还好理解，即，一周的第一天是周日，还是周一的问题。<br> getMinimalDaysInFirstWeek就显示比较难懂了。它的意思是指，一周里的天数。<br> 来看个例子吧，比如我想得到，2017年的第3周的周一，是哪一天。好了，看代码吧。</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Calendar</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CalendarTest02</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> weeks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"星期天"</span><span class="token punctuation">,</span> <span class="token string">"星期一"</span><span class="token punctuation">,</span> <span class="token string">"星期二"</span><span class="token punctuation">,</span> <span class="token string">"星期三"</span><span class="token punctuation">,</span> <span class="token string">"星期四"</span><span class="token punctuation">,</span> <span class="token string">"星期五"</span><span class="token punctuation">,</span> <span class="token string">"星期六"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">/**

     * @param args

     */</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Calendar</span> cale <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"现在是"</span> <span class="token operator">+</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cale<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getFirstDayOfWeek默认值--&gt;"</span> <span class="token operator">+</span> cale<span class="token punctuation">.</span><span class="token function">getFirstDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getFirstDayOfWeek默认值--&gt;"</span> <span class="token operator">+</span> weeks<span class="token punctuation">[</span>cale<span class="token punctuation">.</span><span class="token function">getFirstDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//切换年，保持年月日时分秒不变</span>
        cale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>YEAR<span class="token punctuation">,</span> <span class="token number">2017</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//切换周，周几不会变</span>
        cale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>WEEK_OF_YEAR<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>DAY_OF_WEEK<span class="token punctuation">,</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>MONDAY<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cale<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"--------------------------我是分割线------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**

 * #####################################

 */</span>

        <span class="token class-name">Calendar</span> cale2 <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"现在是"</span> <span class="token operator">+</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cale2<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale2<span class="token punctuation">.</span><span class="token function">setFirstDayOfWeek</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>MONDAY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 星期一</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getFirstDayOfWeek值--&gt;"</span> <span class="token operator">+</span> weeks<span class="token punctuation">[</span>cale2<span class="token punctuation">.</span><span class="token function">getFirstDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale2<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>YEAR<span class="token punctuation">,</span> <span class="token number">2017</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale2<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>WEEK_OF_YEAR<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale2<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>DAY_OF_WEEK<span class="token punctuation">,</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>MONDAY<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cale2<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"--------------------------我是分割线------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**

 * #####################################

 */</span>

        <span class="token class-name">Calendar</span> cale3 <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"现在是"</span> <span class="token operator">+</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cale3<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale3<span class="token punctuation">.</span><span class="token function">setFirstDayOfWeek</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>MONDAY<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 星期一</span>

        cale3<span class="token punctuation">.</span><span class="token function">setMinimalDaysInFirstWeek</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 7天为一周</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getFirstDayOfWeek值--&gt;"</span> <span class="token operator">+</span> weeks<span class="token punctuation">[</span>cale3<span class="token punctuation">.</span><span class="token function">getFirstDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>YEAR<span class="token punctuation">,</span> <span class="token number">2017</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>WEEK_OF_YEAR<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        cale3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>DAY_OF_WEEK<span class="token punctuation">,</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>MONDAY<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cale3<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

现在是<span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span>
getFirstDayOfWeek默认值<span class="token operator">--</span><span class="token operator">&gt;</span><span class="token number">1</span>
getFirstDayOfWeek默认值<span class="token operator">--</span><span class="token operator">&gt;</span>星期天
<span class="token number">2017</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>我是分割线<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
现在是<span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span>
getFirstDayOfWeek值<span class="token operator">--</span><span class="token operator">&gt;</span>星期一
<span class="token number">2017</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">09</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>我是分割线<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
现在是<span class="token number">2022</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">08</span>
getFirstDayOfWeek值<span class="token operator">--</span><span class="token operator">&gt;</span>星期一
<span class="token number">2017</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span>

</code></pre> 
<p>对着日历看看就明白了<br> <img src="https://images2.imgbox.com/a3/d1/VhenXVQC_o.png" alt="在这里插入图片描述"></p> 
<p>对FirstDayOfWeek和MinimalDaysInFirstWeek有一个认识这十分重要<br> 有了这个个认识看几个很容易混淆的字段</p> 
<h4><a id="1CalendarMONTH_378"></a>1、Calendar.MONTH</h4> 
<p>月份从0-11，获取之后需要加1才能得到真正的月份</p> 
<h4><a id="2CalendarDAY_OF_WEEK_380"></a>2、Calendar.DAY_OF_WEEK</h4> 
<p>本周的第几天，从星期天开始算，因为其对应的就是一周七天的枚举，无论FirstDayOfWeek设置成什么，周日都返回1</p> 
<pre><code class="prism language-java">   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> SUNDAY <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MONDAY <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>


   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> TUESDAY <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

  
   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> WEDNESDAY <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>

  
   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> THURSDAY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

  
   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> FRIDAY <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>


   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> SATURDAY <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3CalendarWEEK_OF_MONTHCalendarDAY_OF_WEEK_IN_MONTH_402"></a>3、Calendar.WEEK_OF_MONTH和Calendar.DAY_OF_WEEK_IN_MONTH的区别</h4> 
<p>DAY_OF_WEEK_IN_MONTH：第一周从1号开始算，1-7号为第一周，8-14号为第二周…<br> WEEK_OF_MONTH：第一周不按1号算，1号该是周几就是周几</p> 
<h4><a id="4CalendarHOURCalendarHOUR_OF_DAY_405"></a>4、Calendar.HOUR和Calendar.HOUR_OF_DAY的区别</h4> 
<p>HOUR：12小时制<br> HOUR_OF_DAY24小时制<br> 回到刚刚的构造函数</p> 
<pre><code class="prism language-java"><span class="token class-name">GregorianCalendar</span><span class="token punctuation">(</span><span class="token class-name">TimeZone</span> zone<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">,</span> <span class="token keyword">boolean</span> flag<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>zone<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        gdate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseCalendar<span class="token punctuation">.</span>Date</span><span class="token punctuation">)</span> gcal<span class="token punctuation">.</span><span class="token function">newCalendarDate</span><span class="token punctuation">(</span><span class="token function">getZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<p>初始化一个日期，初始为为0000-00-00T00:00:00.000Z<br> 后再build方法中设置时间为当前时间戳然后填充GregorianCalendar的字段。实际上就是当前时间</p> 
<h3><a id="setTime_419"></a>setTime</h3> 
<pre><code class="prism language-java">   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token class-name">Date</span> date<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeInMillis</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-java">  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTimeInMillis</span><span class="token punctuation">(</span><span class="token keyword">long</span> millis<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// If we don't need to recalculate the calendar field values,</span>
        <span class="token comment">// do nothing.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">==</span> millis <span class="token operator">&amp;&amp;</span> isTimeSet <span class="token operator">&amp;&amp;</span> areFieldsSet <span class="token operator">&amp;&amp;</span> areAllFieldsSet
            <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>zone <span class="token keyword">instanceof</span> <span class="token class-name">ZoneInfo</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ZoneInfo</span><span class="token punctuation">)</span>zone<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isDirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        time <span class="token operator">=</span> millis<span class="token punctuation">;</span>
        isTimeSet <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        areFieldsSet <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token function">computeFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        areAllFieldsSet <span class="token operator">=</span> areFieldsSet <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>与初始化相同，就又根据时间戳生成日期并填充Calendar的各个字段</p> 
<h3><a id="set_442"></a>set字段方法</h3> 
<pre><code class="prism language-java"> <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> date<span class="token punctuation">,</span> <span class="token keyword">int</span> hourOfDay<span class="token punctuation">,</span> <span class="token keyword">int</span> minute<span class="token punctuation">,</span>
                          <span class="token keyword">int</span> second<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">set</span><span class="token punctuation">(</span>YEAR<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">set</span><span class="token punctuation">(</span>MONTH<span class="token punctuation">,</span> month<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">set</span><span class="token punctuation">(</span>DATE<span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">set</span><span class="token punctuation">(</span>HOUR_OF_DAY<span class="token punctuation">,</span> hourOfDay<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">set</span><span class="token punctuation">(</span>MINUTE<span class="token punctuation">,</span> minute<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">set</span><span class="token punctuation">(</span>SECOND<span class="token punctuation">,</span> second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-java">      calendar<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>YEAR<span class="token punctuation">,</span><span class="token number">1998</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java">   <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">internalSet</span><span class="token punctuation">(</span><span class="token keyword">int</span> field<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        fields<span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>设置字段，简单的设置对应字段</p> 
<h3><a id="get_467"></a>get</h3> 
<pre><code class="prism language-java">   calendar<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>YEAR<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">internalGet</span><span class="token punctuation">(</span><span class="token keyword">int</span> field<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> fields<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>直接从数组中取值</p> 
<h3><a id="add_478"></a>add</h3> 
<pre><code class="prism language-java">   calendar<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Calendar</span><span class="token punctuation">.</span>YEAR<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>按照日历的规则，给指定字段添加或者减少时间</p> 
<h3><a id="getTime_483"></a>getTime</h3> 
<pre><code class="prism language-java"> <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Date</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token function">getTimeInMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTimeInMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isTimeSet<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">updateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>毫秒为单位，返回该日历的时间值。</p> 
<h3><a id="SimpleDateFormat_497"></a>SimpleDateFormat</h3> 
<p>日期和时间格式由 日期和时间模式字符串 指定。在 日期和时间模式字符串 中，未加引号的字母 ‘A’ 到 ‘Z’ 和 ‘a’ 到 ‘z’ 被解释为模式字母，用来表示日期或时间字符串元素。文本可以使用单引号 (') 引起来，以免进行解释。所有其他字符均不解释；只是在格式化时将它们简单复制到输出字符串</p> 
<p>白话文的讲：这些A——Z，a——z这些字母(不被单引号包围的)会被特殊处理替换为对应的日期时间，其他的字符串还是原样输出。<br> 日期和时间模式(注意大小写，代表的含义是不同的)</p> 
<pre><code class="prism language-java">yyyy：年
MM：月
dd：日
hh：<span class="token number">1</span><span class="token operator">~</span><span class="token number">12</span>小时制<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">)</span>
HH：<span class="token number">24</span>小时制<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">)</span>
mm：分
ss：秒
<span class="token class-name">S</span>：毫秒
<span class="token class-name">E</span>：星期几
<span class="token class-name">D</span>：一年中的第几天
<span class="token class-name">F</span>：一月中的第几个星期<span class="token punctuation">(</span>会把这个月总共过的天数除以<span class="token number">7</span><span class="token punctuation">)</span>
w：一年中的第几个星期
<span class="token class-name">W</span>：一月中的第几星期<span class="token punctuation">(</span>会根据实际情况来算<span class="token punctuation">)</span>
a：上下午标识
k：和HH差不多，表示一天<span class="token number">24</span>小时制<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">)</span>。
<span class="token class-name">K</span>：和hh差不多，表示一天<span class="token number">12</span>小时制<span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">)</span>。
z：表示时区  

</code></pre> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * Created by lxk on 2016/11/4
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Format</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Date</span> ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"一般日期输出："</span> <span class="token operator">+</span> ss<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"时间戳："</span> <span class="token operator">+</span> ss<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleDateFormat</span> format0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> time <span class="token operator">=</span> format0<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>ss<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//这个就是把时间戳经过处理得到期望格式的时间</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"格式化结果0："</span> <span class="token operator">+</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleDateFormat</span> format1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy年MM月dd日 HH时mm分ss秒"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        time <span class="token operator">=</span> format1<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>ss<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"格式化结果1："</span> <span class="token operator">+</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_543"></a>前后端日期传递</h2> 
<hr> 
<p>首先简单介绍下常见的几种时间：<br> CST<br> 北京时间，China Standard Time,又名中国标准时间</p> 
<p>中部标准时间（北美洲），Central Standard Time (USA) UT-6:00<br> 澳州中部时间，Central Standard Time (Australia) UT+9:30<br> 中国时间，China Standard Time UT+8:00<br> 古巴标准时间，Cuba Standard Time UT-4:00</p> 
<p>CST可以表示美国。澳大利亚，中国。古巴四个国家的时间</p> 
<p>示例：<br> Sun Aug 30 2020 23:07:43 GMT+0800 (中国标准时间)</p> 
<p>GMT<br> 格林尼治标准时间，Greenwich Mean Time</p> 
<p>示例：<br> Sun, 30 Aug 2020 15:09:23 GMT</p> 
<p>UTC<br> 国际协调时间，Coordinated Universal Time</p> 
<p>ISO<br> 标准时间</p> 
<p>示例：<br> 2020-08-30T15:09:23.786Z</p> 
<p>CST 中国标准时间（东八区）= UTC/GMT + 8小时</p> 
<hr> 
<p>一般前端传值可能传的时GMT时间格式，也可能时ISO格式，也可能是常见的yyyy-MM-dd HH:mm:ss这种格式。那么就要求后端接收不同的格式都处理成CST时间（东八区时间）<br> <strong>那么后端要能保证对不同日期格式都进行正确处理</strong></p> 
<p><strong>以springMvc处理日期类型为例</strong></p> 
<pre><code class="prism language-java"> <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/register"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"用户注册接口"</span><span class="token punctuation">,</span> httpMethod <span class="token operator">=</span><span class="token string">"POST"</span> <span class="token punctuation">,</span> response <span class="token operator">=</span> <span class="token class-name">UserRegisterResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">"...."</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@ResponseJsonFormat</span>
    <span class="token keyword">public</span> <span class="token class-name">UserRegisterResponse</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">UserRegisterRequest</span> userRegisterRequest<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//用户信息要用aop拦截，登录肯定不用拦截了。</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>userRegisterRequest<span class="token punctuation">.</span><span class="token function">getPassward</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            userRegisterRequest<span class="token punctuation">.</span><span class="token function">setPassward</span><span class="token punctuation">(</span>passwordEncoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>userRegisterRequest<span class="token punctuation">.</span><span class="token function">getPassward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span>  userReadFacade<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>userRegisterRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>实体类字段birthday为Date类型</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@ApiModel</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRegisterRequest</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> nickName<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> gender<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> passward<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>springMvc再处理请求绑定到实体类时将日期字符串转换成Date对象<br> <strong>学过springMvc处理流程的知道对于注解@RequestBody对类，将会由RequestResponseBodyMethodProcessor进行处理 json格式的请求会交给MappingJackson2HttpMessageConverter处理</strong><br> 对于Date类型由DateDeserializer处理····<br> 上面都不清楚也没关系。直接看重要的代码<br> com.fasterxml.jackson.databind.DeserializationContext#parseDate</p> 
<pre><code class="prism language-java"> <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">parseDate</span><span class="token punctuation">(</span><span class="token class-name">String</span> dateStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalArgumentException</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DateFormat</span> df <span class="token operator">=</span> <span class="token function">getDateFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> df<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ParseException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
                    <span class="token string">"Failed to parse Date value '%s': %s"</span><span class="token punctuation">,</span> dateStr<span class="token punctuation">,</span>
                    <span class="token class-name">ClassUtil</span><span class="token punctuation">.</span><span class="token function">exceptionMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    

</code></pre> 
<p>com.fasterxml.jackson.databind.util.StdDateFormat#_parseDate</p> 
<pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token class-name">Date</span> <span class="token function">_parseDate</span><span class="token punctuation">(</span><span class="token class-name">String</span> dateStr<span class="token punctuation">,</span> <span class="token class-name">ParsePosition</span> pos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ParseException</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">looksLikeISO8601</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// also includes "plain"</span>
            <span class="token keyword">return</span> <span class="token function">parseAsISO8601</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Also consider "stringified" simple time stamp</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> dateStr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">char</span> ch <span class="token operator">=</span> dateStr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;</span> <span class="token char">'0'</span> <span class="token operator">||</span> ch <span class="token operator">&gt;</span> <span class="token char">'9'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 07-Aug-2013, tatu: And [databind#267] points out that negative numbers should also work</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">||</span> ch <span class="token operator">!=</span> <span class="token char">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token comment">// let's just assume negative numbers are fine (can't be RFC-1123 anyway); check length for positive</span>
                <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>dateStr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'-'</span> <span class="token operator">||</span> <span class="token class-name">NumberInput</span><span class="token punctuation">.</span><span class="token function">inLongRange</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">_parseDateFromLong</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Otherwise, fall back to using RFC 1123. NOTE: call will NOT throw, just returns `null`</span>
        <span class="token keyword">return</span> <span class="token function">parseAsRFC1123</span><span class="token punctuation">(</span>dateStr<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>looksLikeISO8601就是国标的情况2022-07-09T07:18:00.144Z这种格式<br> 默认一共能处理这几种格式</p> 
<pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ALL_FORMATS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        DATE_FORMAT_STR_ISO8601<span class="token punctuation">,</span>
        <span class="token string">"yyyy-MM-dd'T'HH:mm:ss.SSS"</span><span class="token punctuation">,</span> <span class="token comment">// ISO-8601 but no timezone</span>
        DATE_FORMAT_STR_RFC1123<span class="token punctuation">,</span>
        DATE_FORMAT_STR_PLAIN
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-java">  <span class="token comment">//国标，日期时间最全毫秒，时区偏移量都有</span>
   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> DATE_FORMAT_STR_ISO8601 <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd'T'HH:mm:ss.SSSX"</span><span class="token punctuation">;</span>
  <span class="token comment">//年月日</span>
    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> DATE_FORMAT_STR_PLAIN <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">;</span>
   
    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> DATE_FORMAT_STR_RFC1123 <span class="token operator">=</span> <span class="token string">"EEE, dd MMM yyyy HH:mm:ss zzz"</span><span class="token punctuation">;</span>
</code></pre> 
<p>前端请求示例<br> <img src="https://images2.imgbox.com/14/4b/bzSOhD4B_o.png" alt="在这里插入图片描述"></p> 
<p><strong>经测试这几种格式如果不指定时区都认为前端传来的时间时区在偏移为0的本初子午线，后端转换后都加了8小时</strong><br> <strong>经过debug找到了原因。</strong><br> <strong>原来</strong>jackson<strong>在将字符串处理成日期时</strong>SimpleDateFormat<strong>使用的时区偏移为0</strong><br> <img src="https://images2.imgbox.com/50/bd/tbmtr6nt_o.png" alt="在这里插入图片描述"></p> 
<p>处理完毕之后，在使用new Date转换对象，这里因为new Date使用本机时区而后又加了8小时</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Date</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token function">getTimeInMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>因此我这里因为前端使用是的是本机的东八区，到了后端按照0时区处理，而后又转成本地时区，导致时间快了八个小时。</strong><br> <strong>这种情况要么前端传递时间时-8小时，要么前后端统一时区进行处理</strong></p> 
<p><strong>除了默认的几种格式还可以利用jackson自定义日期格式和时区</strong></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">,</span> timezone <span class="token operator">=</span> <span class="token string">"GMT+8"</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c489b7202cf9643349cd89f8742f9fa4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言实现扫雷【超详细讲解】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2995fc56d9c06d697c8b36030942a9f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Pdf&#43;Word&#43;Visio&#43;MATLAB输出的3维图像不清晰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>