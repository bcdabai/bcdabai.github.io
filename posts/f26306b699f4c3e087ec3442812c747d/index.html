<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python：实现日历到excel文档 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python：实现日历到excel文档" />
<meta property="og:description" content="背景 日历是一种常见的工具，用于记录事件和显示日期。在编程中，可以使用Python编码来制作日历。
Python提供了一些内置的模块和函数，使得制作日历变得更加简单。
在本文，我们将探讨如何使用Python制作日历，并将日历输出到excel文档中。
效果展示 实现 在代码中会用到calendar模块和openpyxl模块，其中calendar模块是python自带的，而openpyxl模块需要自行下载“pip install openpyxl”。
import calendar
import openpyxl
from openpyxl.styles import Alignment, PatternFill, Font
from openpyxl.utils import get_column_letter
from openpyxl.drawing.image import Image
from openpyxl.styles import Side, Border
#year = int(input(“请输入年份：”))
#calendar.setfirstweekday(firstweekday=6)
###设置表头所在起始行
table_head_row = 3
##设置表内容所在起始行
table_comment_row = table_head_row &#43; 1
# 创建一个工作䈬
wb = openpyxl.Workbook()
# 遍历12个月
for i in range(1, 13):
# 添加工作表
sheet = wb.create_sheet(index=0, title=str(i) &#43; &#39;月&#39;)
# 获取具体日期时间，设置表内容
for j in range(len(calendar." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f26306b699f4c3e087ec3442812c747d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-25T23:01:48+08:00" />
<meta property="article:modified_time" content="2023-10-25T23:01:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python：实现日历到excel文档</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>背景</h2> 
<p>        日历是一种常见的工具，用于记录事件和显示日期。在编程中，可以使用Python编码来制作日历。</p> 
<p>        Python提供了一些内置的模块和函数，使得制作日历变得更加简单。</p> 
<p>        在本文，我们将探讨如何使用Python制作日历，并将日历输出到excel文档中。</p> 
<h2>效果展示</h2> 
<p><img alt="" height="653" src="https://images2.imgbox.com/c5/a1/6hsmy2BL_o.png" width="852"></p> 
<h2>实现</h2> 
<p>        在代码中会用到calendar模块和openpyxl模块，其中calendar模块是python自带的，而openpyxl模块需要自行下载“pip install openpyxl”。</p> 
<blockquote> 
 <p>import calendar</p> 
 <p>import openpyxl</p> 
 <p></p> 
 <p>from openpyxl.styles import Alignment, PatternFill, Font</p> 
 <p>from openpyxl.utils import get_column_letter</p> 
 <p>from openpyxl.drawing.image import Image</p> 
 <p>from openpyxl.styles import Side, Border</p> 
 <p></p> 
 <p>#year = int(input(“请输入年份：”))</p> 
 <p><br>  </p> 
 <p>#calendar.setfirstweekday(firstweekday=6)</p> 
 <p></p> 
 <p>###设置表头所在起始行</p> 
 <p>table_head_row = 3</p> 
 <p>##设置表内容所在起始行</p> 
 <p>table_comment_row = table_head_row + 1</p> 
 <p><br>  </p> 
 <p># 创建一个工作䈬</p> 
 <p>wb = openpyxl.Workbook()</p> 
 <p></p> 
 <p># 遍历12个月</p> 
 <p>for i in range(1, 13):</p> 
 <p>    # 添加工作表</p> 
 <p>    sheet = wb.create_sheet(index=0, title=str(i) + '月')</p> 
 <p></p> 
 <p>    # 获取具体日期时间，设置表内容</p> 
 <p>    for j in range(len(calendar.monthcalendar(2023, i))):</p> 
 <p>        for k in range(len(calendar.monthcalendar(2023, i)[j])):</p> 
 <p>            value = calendar.monthcalendar(2023, i)[j][k]</p> 
 <p></p> 
 <p>            # 将0值变为空值</p> 
 <p>            if value == 0:</p> 
 <p>                value = ''</p> 
 <p>                sheet.cell(row=j + table_comment_row, column=k + 1).value = value</p> 
 <p>            else:</p> 
 <p>                sheet.cell(row=j + table_comment_row, column=k + 1).value = value</p> 
 <p></p> 
 <p>            # 设置字体</p> 
 <p>            sheet.cell(row=j + table_comment_row, column=k + 1).font = Font(u'微软雅黑', size=11)</p> 
 <p></p> 
 <p>    # 单元格文字设置,右对齐,垂直居中</p> 
 <p>    align = Alignment(horizontal='right', vertical='center')</p> 
 <p></p> 
 <p>    # 单元格填充色属性设置</p> 
 <p>    fill = PatternFill("solid", fgColor="B9EBF7")</p> 
 <p></p> 
 <p>    # 对单元格进行颜色填充</p> 
 <p>    for k1 in range(1, 10):</p> 
 <p>        for k2 in range(1, 8):</p> 
 <p>            sheet.cell(row=k1, column=k2).fill = fill</p> 
 <p><br>  </p> 
 <p>    # 设置表头</p> 
 <p>    days = ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六','星期日']</p> 
 <p>    num = 0</p> 
 <p>    for k3 in range(1, 8):</p> 
 <p>        sheet.cell(row=table_head_row, column=k3).value = days[num]</p> 
 <p>        sheet.cell(row=table_head_row, column=k3).alignment = align</p> 
 <p>        sheet.cell(row=table_head_row, column=k3).font = Font(u'微软雅黑', size=16)</p> 
 <p></p> 
 <p>        # 设置列宽12</p> 
 <p>        c_char = get_column_letter(k3)</p> 
 <p>        sheet.column_dimensions[get_column_letter(k3)].width = 18</p> 
 <p></p> 
 <p>        num += 1</p> 
 <p>    # 设置表头行高50</p> 
 <p>    sheet.row_dimensions[table_head_row].height = 50</p> 
 <p></p> 
 <p>    # 设置内容行高30</p> 
 <p>    for k4 in range(table_comment_row, table_comment_row + 6):</p> 
 <p>        sheet.row_dimensions[k4].height = 70</p> 
 <p><br>  </p> 
 <p>    # 设置表线条的样式和颜色 style=medium, thin, thick</p> 
 <p>    side = Side(style="thin", color="FF0000")</p> 
 <p>    # 设置表单元格的边框线条</p> 
 <p>    border = Border(top=side, bottom=side, left=side, right=side)</p> 
 <p>    for k5 in range(table_head_row, table_head_row + 7):</p> 
 <p>        for k6 in range(1, 8):</p> 
 <p>            sheet.cell(row=k5, column=k6).border = border</p> 
 <p><br>  </p> 
 <p>    # 添加年份及月份</p> 
 <p>    sheet.cell(row=1, column=1).value = '2023年' + str(i) + '月'</p> 
 <p><br>  </p> 
 <p>    # 设置年份及月份文本属性</p> 
 <p>    sheet.cell(row=1, column=1).font = Font(u'微软雅黑', size=14, bold=True, color='FF7887')</p> 
 <p>    sheet.cell(row=1, column=1).alignment = align</p> 
 <p><br>  </p> 
 <p># 保存文档</p> 
 <p>wb.save('日历.xlsx')</p> 
 <p></p> 
 <p>print("calendar finished!!")</p> 
</blockquote> 
<h2>帮助</h2> 
<p>        如果在windows上没有安装pip，安装时可能会报错。</p> 
<p>请参照文章<a class="link-info" href="https://blog.csdn.net/hhd1988/article/details/133932895" title="pip时报错：ImportError: cannot import name ‘InvalidSchemeCombination’">pip时报错：ImportError: cannot import name ‘InvalidSchemeCombination’</a>解决</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d1f031e76ad9cce4ef074d605e09393/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">每日5道面试题之并发编程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f37bde02072302d3ad406d751dc902f5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python：实现日历功能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>