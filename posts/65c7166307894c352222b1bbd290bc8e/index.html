<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python极简讲义一本书入门机器学习和数据分析--自学笔记 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python极简讲义一本书入门机器学习和数据分析--自学笔记" />
<meta property="og:description" content="0 前言 本书有的知识点之前说，过了几节后再解释。有几个错误但是影响不大。作者自己找补说，有的没讲正常，主要靠自学。
我这里对一些没讲的作了一些补充。
这里是这本书和源码的百度链接，分享给大家。
链接： https://pan.baidu.com/s/1d4-gC7kzRvIxilWmbayrSg?pwd=ciav
提取码：ciav
还不完善: 有几章的题还没写.
1 初识python和jupyter MAKE 最小必要知识(MAKE),迅速掌握MAKE,然后缺啥补啥.
jupyter jupyter脱胎于ipython项目。ipython是一个python交互式shell，它比默认的python shell 要好用很多。而ipython正式jupyter的内核所在，我们可以理解为，jupyter是网页版的ipython。
esc 退出编辑模式
d d删除 l 显示行数 a 向上增加行 b 向下增加行
魔法函数 jupyter的魔法函数，脱离ipython的使用环境，如pycharm是用不了的。
魔法函数分为面向行和面向块的。
%matplotlib inline 内嵌
%matplotlib qt 单独
想知道用法直接%timeit? 最后追加问号
%%timeit针对代码块 两个百分号是针对整个代码块的
建议 把测试运行时长单独放置一个单元格中
%%writefile name.py 对代码块生产 .py文件
2 结构类型与程序控制结构 . 调用的是方法
不用 . 调用是内置函数
基本数据类型 数值 布尔 and 优先级比 or 高 会先运算
复数a&#43;bj
type()只能输出一个变量的类型
多个变量同时赋值 a, b, c = 1, 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/65c7166307894c352222b1bbd290bc8e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-03T19:19:30+08:00" />
<meta property="article:modified_time" content="2023-05-03T19:19:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python极简讲义一本书入门机器学习和数据分析--自学笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="0__1"></a>0 前言</h2> 
<p>本书有的知识点之前说，过了几节后再解释。有几个错误但是影响不大。作者自己找补说，有的没讲正常，主要靠自学。<br> 我这里对一些没讲的作了一些补充。<br> 这里是这本书和源码的百度链接，分享给大家。<br> 链接： https://pan.baidu.com/s/1d4-gC7kzRvIxilWmbayrSg?pwd=ciav<br> 提取码：ciav<br> 还不完善: 有几章的题还没写.</p> 
<h2><a id="1_pythonjupyter_8"></a>1 初识python和jupyter</h2> 
<h3><a id="MAKE_9"></a>MAKE</h3> 
<p>最小必要知识(MAKE),迅速掌握MAKE,然后缺啥补啥.</p> 
<h3><a id="jupyter_11"></a>jupyter</h3> 
<p>jupyter脱胎于ipython项目。ipython是一个python交互式shell，它比默认的python shell 要好用很多。而ipython正式jupyter的内核所在，我们可以理解为，jupyter是网页版的ipython。<br> esc 退出编辑模式<br> d d删除 l 显示行数 a 向上增加行 b 向下增加行</p> 
<h3><a id="_15"></a>魔法函数</h3> 
<p>jupyter的魔法函数，脱离ipython的使用环境，如pycharm是用不了的。<br> 魔法函数分为面向行和面向块的。<br> %matplotlib inline 内嵌<br> %matplotlib qt 单独<br> 想知道用法直接%timeit? 最后追加问号<br> %%timeit针对代码块 两个百分号是针对整个代码块的<br> 建议 把测试运行时长单独放置一个单元格中<br> %%writefile name.py 对代码块生产 .py文件</p> 
<h2><a id="2__24"></a>2 结构类型与程序控制结构</h2> 
<p>. 调用的是方法<br> 不用 . 调用是内置函数</p> 
<h3><a id="_27"></a>基本数据类型</h3> 
<h4><a id="_28"></a>数值</h4> 
<h4><a id="_29"></a>布尔</h4> 
<p>and 优先级比 or 高 会先运算<br> 复数a+bj<br> type()只能输出一个变量的类型<br> 多个变量同时赋值 a, b, c = 1, 0.5, 1+1j</p> 
<h4><a id="_34"></a>字符串</h4> 
<p>方框调用<br> split(" ")依据空格分片为列表<br> title() 首字母大写其余小写</p> 
<pre><code class="prism language-python">str1 <span class="token operator">=</span> <span class="token string">"i love you beijing"</span>
str1<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>
<span class="token comment"># ['i', 'love', 'you', 'beijing']</span>
</code></pre> 
<p>strip(‘abc’)删除字符串两端的abc 默认空格<br> 字符串前缀</p> 
<ul><li>b 后面字符串是bytes类型 网络编程中,只认bytes</li><li>u/U 表示unicode字符串</li><li>r/R 非转义的原始字符串,去掉反斜杠的转义机制</li></ul> 
<p>格式化输出</p> 
<ul><li>%s格式化 ：和c语言类似</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"我叫 %s 今年 %d 岁!"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 我叫 小明 今年 10 岁!</span>
</code></pre> 
<ul><li>format格式化<br> {}内填</li></ul> 
<pre><code class="prism language-python"><span class="token string">"{},{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token string">"world"</span><span class="token punctuation">)</span>
<span class="token string">"{1},{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token string">"world"</span><span class="token punctuation">)</span>
<span class="token string">"{0},{1},{0},{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token string">"world"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">3.1415926</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>f-string格式化</li><li><strong>f-string</strong> 格式化字符串以 f 开头，后面跟着字符串，字符串中的表达式用大括号 {} 包起来，它会将变量或表达式计算后的值替换进去</li><li>{} 相当于c语言的百分号</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'hello world </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>str1<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token comment"># hello world i love you beijing</span>
</code></pre> 
<p>大括号内外不能用同一种引号，需根据情况灵活切换使用单引号、双引号、单三引号、双三引号。<br> 大括号内不能使用 \ 转义<br> 需要显示大括号，则应输入连续两个大括号{<!-- -->{ }}；大括号内需要引号，使用引号即可。</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'i am </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token string">"hua wei"</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'{<!-- -->{5}}</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token string">"apples"</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<dl> 
 
   填充 
  
 <dd>
   冒号后写数据格式 
  <br> 记忆方法：括号口朝左边，就表示左填充；括号口朝右边，就表示右填充 
 </dd> 
</dl> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span><span class="token format-spec">0&gt;4</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token comment"># 输出4个字符，不足补0</span>
<span class="token comment"># 0001</span>
</code></pre> 
<p>数字符号相关格式描述符：仅针对数值有效</p> 
<ul><li>+ 正负数都输出符号</li><li>- 负数输出符号</li><li>空格 正数加空格 负数加负号</li><li>width.precision</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span><span class="token format-spec">+</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token comment">#+1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span><span class="token format-spec"> </span><span class="token punctuation">}</span></span><span class="token string">\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token format-spec"> </span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token comment"># 1</span>
<span class="token comment">#-1</span>
a <span class="token operator">=</span> <span class="token number">123.456</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token comment">#123.46</span>

</code></pre> 
<h4><a id="_107"></a>列表</h4> 
<p>反向索引 -i 表示倒数第 i 个元素 例如-1表示倒数第一个元素，但是0表示第一个元素，要注意。<br> list[0:5],左闭右开，取前五个元素l ist1[::2] 步长为2<br> list1[::-1]步长为-1，即为倒着输出<br> 访问单个元素注意返回的不是列表.</p> 
<pre><code class="prism language-python">testlist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">677</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>testlist<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>testlist<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#&lt;class 'int'&gt; &lt;class 'list'&gt;</span>
</code></pre> 
<p>+ 连接列表, * 整体复制列表</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
a <span class="token operator">+</span> b <span class="token comment"># 连接[1, 2, 3, 4, 5, 6]</span>
a <span class="token operator">*</span> <span class="token number">3</span> <span class="token comment"># 整体复制3次[1, 2, 3, 1, 2, 3, 1, 2, 3]</span>
</code></pre> 
<p>list() 将字符串等可迭代对象转化成列表</p> 
<pre><code class="prism language-python">list_ <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list_<span class="token punctuation">)</span>
<span class="token comment"># ['h', 'e', 'l', 'l', 'o', ' ', 'w', 'o', 'r', 'l', 'd']</span>
</code></pre> 
<p>添加列表元素</p> 
<ul><li>append(): 在列表尾部添加一个新元素</li><li>insert():在指定索引位置插入一个元素</li><li>extend():把一个列表整体添加到另一个列表的尾部</li></ul> 
<pre><code class="prism language-python">a<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> 
<span class="token comment"># 在2号位插入数字0</span>
a<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
</code></pre> 
<p>id(a)返回a的地址<br> 删除列表元素</p> 
<pre><code class="prism language-python"><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment"># 2932207713216</span>
</code></pre> 
<ul><li>pop():默认删除尾部一个元素，或者删除指定索引元素</li><li>remove(x):删除第一个与x相同的元素</li><li>clear():清空列表所有元素</li></ul> 
<pre><code class="prism language-python">stlist<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
stlist<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
stlist<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
stlist<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>del 删除到变量到对象的引用和变量名称本身<br> 注意del语句作用在变量上，而不是数据对象上</p> 
<pre><code class="prism language-python"><span class="token keyword">del</span> stlist<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token comment"># 删除前2个元素</span>
</code></pre> 
<ul><li>count(x)：x出现的个数</li><li>index(x)：x首次出现的位置</li><li>in / not in ：是否存在</li></ul> 
<pre><code class="prism language-python">slist<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
slist<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token number">5</span> <span class="token keyword">not</span> <span class="token keyword">in</span> slist<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"aloha"</span><span class="token punctuation">)</span>
</code></pre> 
<p>列表元素排序</p> 
<ul><li>sort() ：按字典顺序排序<br> 当元素之间的类型不能够互相转换的时候，Python就会报错，例如整数和字符串类型</li><li>reverse() ：倒置</li></ul> 
<pre><code class="prism language-python">fruits<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span>
fruits<span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fruits<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 也可以逆序</span>
</code></pre> 
<ul><li>sort(key = None, reverse = false): key是指定比较的元素，reverse 为 True则逆序，默认顺序。</li><li>sorted(iterable, key=None, reverse=False) ：全局内置函数 复制原始列表的一个副本，再排序。而sort()会改变数据。</li></ul> 
<pre><code class="prism language-python">fruits<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token builtin">cmp</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> reverse <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token builtin">sorted</span><span class="token punctuation">(</span>fruits<span class="token punctuation">,</span>reverse <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p>其他全局内置函数</p> 
<ul><li>cmp(),不可用 operator模块的函数替代之</li><li>len() ：元素个数</li><li>max(),min() ：最大最小值</li><li>list() ：转换成列表</li><li>range(start, stop[, step])返回整数序列的对象，而不是<mark>列表</mark></li><li>zip()：用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回对象，而不是列表。如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，如果只有一个可迭代对象,那么zip()会找到空元素来代替.<br> 利用 * 号操作符，可以将可迭代对象解包。</li><li>enumerate(sequence, [start=0])：用于将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列(索引, 元素)，同时列出数据和数据下标，一般用在 for 循环当中。</li><li>zip()可以完成多个类型的缝合，而enumerate只能提供数值类型</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> operator
operator<span class="token punctuation">.</span>lt<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 是否小于</span>
<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>fruits<span class="token punctuation">,</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
[('apple', 0),
 ('banana', 1),
 ('orange', 2),
 ('watermelon', 3),
 ('apple', 4),
 ('blueberry', 5),
 ('strawberry', 6)]
'''</span>
<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">zip</span><span class="token punctuation">(</span>fruits<span class="token punctuation">,</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>fruits<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[('apple',
  'banana',
  'orange',
  'watermelon',
  'apple',
  'blueberry',
  'strawberry'),
 (0, 1, 2, 3, 4, 5, 6)]
'''</span>
<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">enumerate</span><span class="token punctuation">(</span>fruits<span class="token punctuation">,</span>start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[(1, 'apple'),
 (2, 'banana'),
 (3, 'orange'),
 (4, 'watermelon'),
 (5, 'apple'),
 (6, 'blueberry'),
 (7, 'strawberry')]
'''</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>ele <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>fruits<span class="token punctuation">,</span>start <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>ele<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
1 apple
2 banana
3 orange
4 watermelon
5 apple
6 blueberry
7 strawberry
'''</span>
</code></pre> 
<h4><a id="_258"></a>元组</h4> 
<p>一旦创建便不能修改<br> 如果只有一个元素必须加逗号，必不可少，逗号是一个元组的核心标识<br> 操作与列表类似<br> tuple()将字符串，列表等可迭代对象转化为元组</p> 
<pre><code class="prism language-python"><span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span>
<span class="token comment"># ('h', 'e', 'l', 'l', 'o', ' ', 'w', 'o', 'r', 'l', 'd')</span>
a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> a <span class="token operator">+</span> b
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token comment"># (1, 2, 3, 4, 5, 6)</span>

</code></pre> 
<p>实在想要修改的话</p> 
<pre><code class="prism language-python">c <span class="token operator">=</span> c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token comment"># 但是此时c已经不是之前的c了</span>
</code></pre> 
<h4><a id="_281"></a>字典</h4> 
<p>键值对，键必须要独一无二<br> 列表无法作为字典的键<br> 字典无法作为字典的键或集合的元素</p> 
<ul><li>items()：显示所有键值对，一一封装在元组里</li><li>keys()：显示键</li><li>values()：显示值</li></ul> 
<pre><code class="prism language-python">dict1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2020'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'world'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
dict1<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># dict_items([('a', 1), ('2020', [1, 2, 3]), (100, ('hello', 'world'))])</span>
dict1<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
dict1<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出某个键对应的值</p> 
<ul><li>dict1[x] x是键的名字</li></ul> 
<pre><code class="prism language-python">dict1<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span>
<span class="token comment"># ('hello','world')</span>
</code></pre> 
<p>get(key,default = None)方法</p> 
<pre><code class="prism language-python">dict1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'无此键'</span><span class="token punctuation">)</span>
<span class="token comment"># '无此键'</span>
</code></pre> 
<p>字典可变，修改直接赋值即可<br> 增加元素，直接用方括号给出新键并赋值即可</p> 
<pre><code class="prism language-python">dict1<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"asljdlas"</span>
<span class="token comment"># {'a': 2, '2020': [1, 2, 3], 100: ('hello', 'world'), (1, 2): 'asljdlas'}</span>
</code></pre> 
<p>将一个字典整体增加到另一个字典</p> 
<ul><li>update(x) ：相当于列表或者元组的 +</li></ul> 
<pre><code class="prism language-python">t1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'asd'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token string">'s'</span><span class="token punctuation">}</span>
dict1<span class="token punctuation">.</span>update<span class="token punctuation">(</span>t1<span class="token punctuation">)</span>
<span class="token comment"># {'a': 2, '2020': [1, 2, 3], 100: ('hello', 'world'), (1, 2): 's', 'asd': [1, 2]}</span>
</code></pre> 
<ul><li>pop(x) ：删除键为 x 的字典元素</li><li>popitem()：删除字典最后一个元素</li></ul> 
<pre><code class="prism language-python">dict1<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
dict1<span class="token punctuation">.</span>popitem<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># {'a': 2, '2020': [1, 2, 3], (1, 2): 's'}</span>
</code></pre> 
<h4><a id="_333"></a>集合</h4> 
<p>{}围住，无序，唯一<br> 集合元素只能包括数值，字符串，元组等不可变元素<br> 不能包括列表，字典和集合等可变元素<br> 即使强制重复也会自动去重</p> 
<pre><code class="prism language-python">set1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>
<span class="token comment"># {1, 2, 3}</span>
</code></pre> 
<ul><li>set() 将可迭代对象转换为集合</li></ul> 
<p>可以用 | &amp; - ^ 求两个集合的并，交，差，对称差<br> 也可以用方法</p> 
<h3><a id="_347"></a>程序控制结构</h3> 
<p>python中的数值型非0为真，None、空字符串、空列表、空元组、空字典、空集合都是false。</p> 
<h4><a id="_349"></a>选择</h4> 
<p>if else<br> if elif…<br> if else 三元操作符</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> <span class="token number">10</span>
y <span class="token operator">=</span> <span class="token number">20</span>
small <span class="token operator">=</span> x <span class="token keyword">if</span> x <span class="token operator">&lt;</span> y <span class="token keyword">else</span> y
<span class="token keyword">print</span><span class="token punctuation">(</span>small<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_359"></a>循环</h4> 
<p>对字典d 可以迭代键，不能迭代k，v<br> 或者k,v解包 items()</p> 
<pre><code class="prism language-python">
<span class="token keyword">for</span> k <span class="token keyword">in</span> d<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>d<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token comment"># 或者 print(k,d.get(k,0))</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> d<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">number <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>
even <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
odd <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> number<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> a <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        even<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        odd<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'even: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>even<span class="token punctuation">}</span></span><span class="token string">\nodd: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>odd<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
even: [77, -1, 123, 55, 1]
odd: [8, 44]
'''</span>
</code></pre> 
<h3><a id="_387"></a>推导式</h3> 
<p>[生成表达式 for 变量 in 序列或迭代对象]</p> 
<h4><a id="_389"></a>列表推导式</h4> 
<pre><code class="prism language-python">alist <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> 
<p>过滤不符合条件的元素</p> 
<pre><code class="prism language-python">int_list <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> a <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">]</span>
</code></pre> 
<p>for循环可以嵌套 也可以用多条for if构建</p> 
<h4><a id="_399"></a>字典推导式</h4> 
<pre><code class="prism language-python">dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">}</span>
reverse_dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>v<span class="token punctuation">:</span>k <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token comment"># {'a': 1, 'b': 2, 'c': 3}</span>
</code></pre> 
<h4><a id="_406"></a>集合推导式</h4> 
<pre><code class="prism language-python">sq <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token comment"># {1, 4, 9}</span>
</code></pre> 
<h3><a id="_411"></a>例题</h3> 
<ol><li></ol> 
<pre><code class="prism language-python">list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
liste <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> list1<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> list2<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">!=</span> j<span class="token punctuation">:</span>
<span class="token comment">#             t = [i,j]</span>
            liste<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 或者</span>
difflist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> list1 <span class="token keyword">for</span> b <span class="token keyword">in</span> list2 <span class="token keyword">if</span> a <span class="token operator">!=</span> b<span class="token punctuation">]</span>
</code></pre> 
<p>3.删除列表中的重复元素</p> 
<ul><li>set()最方便</li></ul> 
<pre><code class="prism language-python">duplist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
list3 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>duplist<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>利用字典的键</li></ul> 
<pre><code class="prism language-python">dict4 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> duplist<span class="token punctuation">:</span>
    dict4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
list5 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dict4<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>dict4<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>dict4<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># &lt;class 'dict_keys'&gt; &lt;class 'list'&gt;</span>
<span class="token comment"># 注意keys()方法不是列表类型</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list5<span class="token punctuation">)</span>
</code></pre> 
<p>4.删除小于3个字符的姓名 ,相同的名字合并</p> 
<pre><code class="prism language-python">names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'alice'</span><span class="token punctuation">,</span><span class="token string">'bob'</span><span class="token punctuation">,</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token string">'Alice'</span><span class="token punctuation">,</span><span class="token string">'J'</span><span class="token punctuation">,</span><span class="token string">'JOHN'</span><span class="token punctuation">,</span><span class="token string">'Bob'</span><span class="token punctuation">]</span>
<span class="token comment"># uni_names = {i.title() for i in names if len(i) &gt; 2}</span>
uni_names <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> name<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> names <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">}</span>
<span class="token comment"># 花括号是集合</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>uni_names<span class="token punctuation">)</span>
</code></pre> 
<p>5 键不分大小写，将值合并</p> 
<pre><code class="prism language-python">mcase <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'Z'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span>
fcase <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>key<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>mcase<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> mcase<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">for</span> key <span class="token keyword">in</span> mcase<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token comment"># {'a': 17, 'b': 34, 'z': 3}</span>
<span class="token comment"># </span>

<span class="token comment"># 法二</span>
f2case <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> key <span class="token keyword">in</span> mcase<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    f2case<span class="token punctuation">[</span>key<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> mcase<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> mcase<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment"># 没有则返回0</span>
    <span class="token comment">#     f2case[key.lower()] = mcase[key.lower()] + mcase[key.upper()]</span>
    <span class="token comment"># 直接读取不存在的键会报错</span>
</code></pre> 
<p>注：upper和lower是字符串的方法<br> get是字典的方法<br> keys()整体是dict_keys类型，每个键的类型各有不同。</p> 
<h2><a id="3_Python_469"></a>3 自建Python模块与第三方模块</h2> 
<h3><a id="Python_470"></a>导入Python标准库</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> 模块名 <span class="token keyword">as</span> 别名
<span class="token keyword">from</span> 模块名 <span class="token keyword">import</span> 对象名 <span class="token keyword">as</span> 别名
模块名<span class="token punctuation">.</span>函数名
别名<span class="token punctuation">.</span>函数名
导入某个特定对象后 可以直接使用函数 全局变量等
</code></pre> 
<h3><a id="_478"></a>编写自己的模块</h3> 
<p>一个.py文件就可以称为一个模块。<br> 假设当前模块声明了这个内置变量,如果本模块直接执行,那么这个__name__的值就为__main__.<br> 如果它被第三方引用(即通过import导入),那么它的值就是这个模块名,即它所在python文件的文件名.</p> 
<pre><code class="prism language-python">__name__ 为模块名
</code></pre> 
<p>parameters模块</p> 
<pre><code class="prism language-python">PI <span class="token operator">=</span> <span class="token number">3.1415926</span>
<span class="token keyword">def</span> <span class="token function">paraTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'PI = '</span><span class="token punctuation">,</span>PI<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span> <span class="token punctuation">:</span>
    paraTest<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> parameters <span class="token keyword">import</span> PI
<span class="token keyword">def</span> <span class="token function">circleArea</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> radius <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> PI
<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'圆的面积为: '</span><span class="token punctuation">,</span>circleArea<span class="token punctuation">(</span>radius<span class="token punctuation">)</span><span class="token punctuation">)</span>
run<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> sys
sys<span class="token punctuation">.</span>path
</code></pre> 
<h3><a id="Package_508"></a>包(Package)</h3> 
<p>模块一般就是我们日常随手用的一些规模较小的代码，而在比较大规模的任务一般需要用到大量的模块，此时我们可以使用包(Package)来管理这些模块。我们平时下载的第三方包也就是这个，如Numpy,<br> 2.1 什么是包？包，就是里面装了一个__init__.py文件的文件夹。<strong>init</strong>.py脚本有下列性质：（1）它本身是一个模块；（2）模块名不是__init__，而是包的名字，也就是装着__init__.py文件的文件夹名。（3）它的作用是将一个文件夹变为一个Python模块（4）它可以不包含代码，不过一般会包含一些Python初始化代码(例如批量导入需要的模块)，在这个包被import的时候，这些代码会自动被执行。<br> 导入包的方法和导入模块比较类似，只不过由于层级比一般模块多了一级，所以多了一条导入形式.<br> import 包名.模块名import 包名.模块名 as 模块别名</p> 
<h3><a id="_515"></a>常用的内建模块</h3> 
<h4><a id="collections_516"></a>collections模块</h4> 
<h5><a id="namedtuple_517"></a>namedtuple</h5> 
<p>第二个参数 [“x”,“y”]也可以写成 “x y"或者"x,y”<br> 变量名不一定要和第一个参数相同<br> 不同属性用逗号隔开，用属性来访问命名元组中的某个元素。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
Point <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'Point'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>x<span class="token punctuation">,</span> p<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token comment">#3 4</span>
p <span class="token operator">=</span> p<span class="token punctuation">.</span>_replace<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment"># p[0] 第一个元素 索引调用完全可以</span>
<span class="token comment"># 修改需要调用_replace方法</span>

x<span class="token punctuation">,</span>y <span class="token operator">=</span> p
<span class="token comment"># 解包 把一个包含多个元素的对象赋给多个变量</span>
</code></pre> 
<h5><a id="deque__534"></a>deque 双向队列</h5> 
<p>和list形式上很像，都是方括号，但是list的写操作当列表元素数据量很大时，效率低。<br> 没有sort方法。</p> 
<ul><li>append 右边增加元素</li><li>appendleft 左边增加元素</li><li>pop 弹出最右边元素</li><li>popleft 弹出最左边元素</li><li>insert(index,x)插入到index号 元素为x</li><li>remove(x) 移除第一个为x的元素</li><li>reverse 颠倒</li><li>rotate(x) 循环整体向右移动x位</li><li>extend(iterable)可迭代对象添加到尾部</li><li>字符串也是可迭代对象，如直接添加字符串’ABC’，会将’A’、‘B’、'C’添加到队列中</li><li>extendleft 添加到首部</li><li>copy 列表元组都有此方法</li><li>count</li><li>index</li><li>maxlen</li><li>指定队列的长度后，如果队列已经达到最大长度，此时从队尾添加数据，则队头的数据会自动出队。队头的数据相等于被队尾新加的数据“挤”出了队列，以保证队列的长度不超过指定的最大长度。反之，从队头添加数据，则队尾的数据会自动出队。</li></ul> 
<pre><code class="prism language-python">dq<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token string">'qbc'</span><span class="token punctuation">)</span>
<span class="token comment"># deque(['a', 'aa', 'c', 'b', 'x', 'abc', 'q', 'b', 'c'])</span>

mdq <span class="token operator">=</span> deque<span class="token punctuation">(</span>maxlen <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
mdq<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># deque(['b', 'c', 'd', 'e', 'f'], maxlen=5)</span>
</code></pre> 
<h5><a id="OrderedDict_562"></a>OrderedDict</h5> 
<p>有序字典，底层双向链表<br> update()<br> move_to_end(x)将键为x的元素移到尾部</p> 
<h5><a id="defaultdict_567"></a>defaultdict</h5> 
<pre><code class="prism language-python">dd <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span> <span class="token string">'N/A'</span><span class="token punctuation">)</span>
dd<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token string">'china'</span>
dd<span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span>
dd<span class="token punctuation">[</span><span class="token string">'z'</span><span class="token punctuation">]</span>
<span class="token comment"># {'a': 'china', 'c': 'N/A', 'z': 'N/A', 'b': 'N/A'}</span>
</code></pre> 
<h5><a id="Counter_576"></a>Counter</h5> 
<p>统计每个单词出现的次数</p> 
<pre><code class="prism language-python">colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'yellow'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'black'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'yellow'</span><span class="token punctuation">]</span>
dict1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> _ <span class="token keyword">in</span> colors<span class="token punctuation">:</span>
    <span class="token keyword">if</span> dict1<span class="token punctuation">.</span>get<span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        dict1<span class="token punctuation">[</span>_<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        dict1<span class="token punctuation">[</span>_<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dict1<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">dict2 <span class="token operator">=</span> Counter<span class="token punctuation">(</span>colors<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">(</span>dict2<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>most_common(n)求出现频率最高的n个单词</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>dict2<span class="token punctuation">.</span>most_common<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 出现频率最高的1个单词</span>
</code></pre> 
<h4><a id="datetime_598"></a>datetime模块</h4> 
<p>一个模块可以有很多类</p> 
<p>datetime模块的datetime类</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
</code></pre> 
<p>获取当前时间日期</p> 
<pre><code class="prism language-python">datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>利用datetime构造方法生成时间</p> 
<pre><code class="prism language-python">date1 <span class="token operator">=</span> datetime<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date1<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>date1<span class="token punctuation">)</span><span class="token punctuation">)</span>
date1<span class="token punctuation">.</span>day
<span class="token comment"># 0021-01-05 00:00:00 &lt;class 'datetime.datetime'&gt;</span>
<span class="token comment"># &gt;&gt;&gt; 5</span>
</code></pre> 
<p>纪元时间<br> 1970年1月1日00:00:00 UTC+00:00 在计算机里记为0.<br> 当前时间就是相对于纪元时间流逝的秒数，称为timestamp</p> 
<p>时间日期调用timestamp()方法</p> 
<pre><code class="prism language-python">datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>将字符串转换为datetime<br> strptime方法<br> datetime.strptime(‘日期时间’,‘格式’)</p> 
<pre><code class="prism language-python">cday <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2023 4 16 Sun 11:30:00'</span><span class="token punctuation">,</span><span class="token string">'%Y %m %d %a %H:%M:%S'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cday<span class="token punctuation">)</span>
<span class="token comment"># 2023-04-16 11:30:00</span>
</code></pre> 
<blockquote> 
 <p>%Y 四个数字表示的年份 %y 两个数字表示的年份<br> %m 月份<br> %M 分钟数<br> %H 24小时 %I 12小时<br> %d 天<br> %S 秒<br> %a 星期缩写 %A 星期全写<br> %b 月份缩写 %B 月份全写</p> 
</blockquote> 
<p>将datetime转换为字符串<br> 对象.strftime(格式)</p> 
<pre><code class="prism language-python">date1 <span class="token operator">=</span> now<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d %a'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date1<span class="token punctuation">)</span>
<span class="token comment"># 20230416 Sun</span>
</code></pre> 
<p>datetime加减<br> 引入timedelta时间差类,参数英文要加s.</p> 
<pre><code class="prism language-python">date2 <span class="token operator">=</span> cday <span class="token operator">-</span> timedelta<span class="token punctuation">(</span>days <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> hours <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date2<span class="token punctuation">)</span>
<span class="token comment"># 2023-04-13 23:30:00</span>
</code></pre> 
<p>求两个日期相差的天数<br> 两个datetime变量相减自动成为timedelta类型</p> 
<pre><code class="prism language-python">list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'2023 4 16'</span><span class="token punctuation">,</span><span class="token string">'2022-1-1'</span><span class="token punctuation">]</span>
lday1 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>list1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'%Y %m %d'</span><span class="token punctuation">)</span>
lday2 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>list1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
deltadays <span class="token operator">=</span> lday1 <span class="token operator">-</span> lday2
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>deltadays<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>deltadays<span class="token punctuation">)</span>
<span class="token comment"># &lt;class 'datetime.timedelta'&gt;</span>
<span class="token comment"># 470 days, 0:00:00</span>
</code></pre> 
<h4><a id="json_673"></a>json模块</h4> 
<p>JSON书写格式类似于字典</p> 
<ul><li>json.dumps() 将python序列化为JSON格式字符串</li><li>json.loads() 将JSON格式字符串反序列化为python对象</li></ul> 
<h4><a id="random_678"></a>random模块</h4> 
<ul><li>random() 同名方法,生成0-1之间的随机数 范围[0,1)</li><li>uniform(x,y)生成[x,y]之内的随机数</li><li>seed(n) 设置随机数种子,后续每次生成随机数都是相同的</li><li>randoint(x,y)生成x,y之内的整型数</li><li>randrange(start,end,step) 就是从range(start,end,step)中随机选一个</li><li>choice(x)从x(列表,元祖,字典)中随便选一个</li><li>choices(it, y)从it中选取多个,放回采样</li><li>sample(it,y)从it中选取多个,不重复</li><li>shuffle(x)打乱原有排序</li></ul> 
<pre><code class="prism language-python">random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="4_Python_694"></a>4 Python函数</h2> 
<h3><a id="Python_695"></a>Python中的函数</h3> 
<h4><a id="_696"></a>函数返回多个值</h4> 
<p>实际上函数返回的是一个元组的引用</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">increase</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">+=</span> <span class="token number">1</span>
    y <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> x<span class="token punctuation">,</span>y
a<span class="token punctuation">,</span>b <span class="token operator">=</span> increase<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>increase<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token triple-quoted-string string">'''
(2, 3)
&lt;class 'tuple'&gt;
'''</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">return</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span>
<span class="token comment"># 也可以输出列表</span>
</code></pre> 
<h4><a id="_716"></a>函数文档</h4> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
一个问号看文档 两个问号看代码
help(函数名)
函数名.__doc__
'''</span>
increase?? 
<span class="token triple-quoted-string string">'''
Signature: increase(x, y)
Source:   
def increase(x,y):
    '''</span>
    功能<span class="token punctuation">,</span>对输入的两个数字自增<span class="token number">1</span> 并返回增加后的数
    <span class="token triple-quoted-string string">'''
    x += 1
    y += 1
    return x,y
File:      c:\users\2021\appdata\local\temp\ipykernel_10168\799339069.py
Type:      function
'''</span>
<span class="token builtin">help</span><span class="token punctuation">(</span>increase<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
Help on function increase in module __main__:

increase(x, y)
    功能,对输入的两个数字自增1 并返回增加后的数
'''</span>
increase<span class="token punctuation">.</span>__doc__
<span class="token triple-quoted-string string">'''
'\n    功能,对输入的两个数字自增1 并返回增加后的数\n    '
'''</span>
</code></pre> 
<h3><a id="_749"></a>函数参数的花式传递</h3> 
<h4><a id="_751"></a>关键字参数</h4> 
<p>指定参数</p> 
<pre><code class="prism language-python">参数为 word <span class="token operator">=</span> <span class="token string">'hello world'</span>
</code></pre> 
<h4><a id="_756"></a>可变参数</h4> 
<p>在形参前面加* ,不管实参有多少个,在内部它们都存放在以形参名为标识符的元组中</p> 
<blockquote> 
 <p>*args</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">varPara</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token operator">*</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>
varPara<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'das'</span><span class="token punctuation">,</span><span class="token string">'sadasd'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
5
('das', 'sadasd')
'''</span>
</code></pre> 
<p>可变参数例子</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">mySum</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">sum</span> <span class="token operator">+=</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mySum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1.0</span> <span class="token operator">+</span> <span class="token number">1j</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mySum<span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span><span class="token number">1.2</span><span class="token punctuation">,</span><span class="token number">6.6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># (10+1j)</span>
<span class="token comment"># 9.0</span>
</code></pre> 
<h4><a id="_781"></a>可变关键字参数</h4> 
<p>两个星号</p> 
<blockquote> 
 <p>**kwargs</p> 
</blockquote> 
<p>会把可变参数打包成字典<br> 调用函数需要采用arg1 = value1,arg2 = value2的形式</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">varFun</span><span class="token punctuation">(</span><span class="token operator">**</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
<span class="token comment">#         print('None')</span>
        <span class="token keyword">return</span> <span class="token string">'None'</span>
    <span class="token keyword">else</span> <span class="token punctuation">:</span>
<span class="token comment">#         print(args)</span>
        <span class="token keyword">return</span> args
<span class="token keyword">print</span><span class="token punctuation">(</span>varFun<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>varFun<span class="token punctuation">(</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>varFun<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
None
{'a': 1, 'b': 2}

---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
~\AppData\Local\Temp\ipykernel_14840\2103809882.py in &lt;module&gt;
      1 print(varFun())
      2 print(varFun(a = 1,b = 2))
----&gt; 3 print(varFun(1,2))

TypeError: varFun() takes 0 positional arguments but 2 were given
'''</span>
</code></pre> 
<p>除了用等号给可变关键字参数赋值,还可以直接用字典给可变关键字参数赋值</p> 
<h4><a id="_814"></a>默认参数</h4> 
<p>设定一个默认值,有就覆盖,没有就用默认的<br> 如果列表L作为默认参数,列表是一个可变量,每次调用函数时,如果改变了L的内容,则下次调用时,默认参数就会改变,不再是函数刚开始定义时的那个空列表了.<br> 定义默认参数的时候务必让这个默认参数是不可变对象,例如数值,元组,字符串,不可变集合(frozenset),None等</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">add_end</span><span class="token punctuation">(</span>L <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> L <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    L<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'END'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> L
</code></pre> 
<h4><a id="_827"></a>参数序列的打包与解包</h4> 
<p>打包:多个变量赋值给一个,会被打包成一个元组<br> 解包:将一个可迭代对象元素分别赋值给分散对象</p> 
<p>在可迭代对象前加一个*号,就可以解包了<br> 对字典加一个星号,只能解包键(输出形参)<br> 加二个星号,就可以正常解包了(输出values)</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span>
list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
fun<span class="token punctuation">(</span><span class="token operator">*</span>list1<span class="token punctuation">)</span>
dict1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">}</span>
fun<span class="token punctuation">(</span><span class="token operator">*</span>dict1<span class="token punctuation">)</span>
<span class="token comment"># a x y d</span>
fun<span class="token punctuation">(</span><span class="token operator">**</span>dict1<span class="token punctuation">)</span>
<span class="token comment"># 1 2 3 4</span>
</code></pre> 
<h4><a id="_845"></a>传值还是传引用</h4> 
<p>python中所有的函数参数传递,统统都是基于传递对象的引用进行的.这是因为,在python中,一切皆对象.而传对象,实质上传的是对象的内存地址,而地址即引用.<br> 对象大致分为两大类,可变和不可变对象.可变包括字典,列表及集合等.不可变对象包括数值,字符串,元组等.<br> 可变对象,传递的就是地址.就不需要return一个可变对象了.<br> 不可变对象,为了维护它的不可变属性,函数不得不重构一个实参的副本,相当于值传递.</p> 
<h3><a id="_850"></a>函数的递归</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">recursive_fact</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">return</span> n <span class="token operator">*</span> recursive_fact<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
num <span class="token operator">=</span> <span class="token number">5</span>
result <span class="token operator">=</span> recursive_fact<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'递归方法: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span></span><span class="token string">! = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>result<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_861"></a>函数式编程的高阶函数</h3> 
<p>函数也是对象,因此函数(对象)可以作为参数,也可以返回一个函数(对象)</p> 
<h4><a id="lambda_863"></a>lambda表达式</h4> 
<p>只有一行代码的函数,由于其太过短小,用后即焚,不值得起名字<br> <mark>lambda 参数:对参数实施的操作</mark><br> 可以把lambda表达式赋值给一个变量,由于<mark>赋值可以决定被赋值对象的类型</mark>,所以这个变量在本质上也是一个函数,当我们使用这个变量时,实际上就是在调用lambda表达式.也就是说,上述操作,让一个原本匿名的函数变得"有名"了.</p> 
<pre><code class="prism language-python">new_add <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">+</span>y
<span class="token keyword">print</span><span class="token punctuation">(</span>new_add<span class="token punctuation">(</span><span class="token number">3.2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">5j</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>new_add<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># (4.2+5j) &lt;class 'function'&gt;</span>
</code></pre> 
<h4><a id="filter_874"></a>filter()函数</h4> 
<p>filter(function,iterable)<br> 两个参数,第一个为判断函数,用于制定筛选规则,第二个为序列,作为第一个参数的数据.<br> 序列中每个元素都将作为参数传递给函数进行判断,符合条件的(即判定为True的)留下,否则就淘汰出局</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token punctuation">:</span>
    letters <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'aeiou'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> var <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

sequence <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'sadasdwecsadisd'</span><span class="token punctuation">)</span>
filtered <span class="token operator">=</span> <span class="token builtin">filter</span><span class="token punctuation">(</span>fun<span class="token punctuation">,</span>sequence<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>filtered<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># ['i', 'a', 'e']</span>
</code></pre> 
<p>如果第一个函数参数功能非常简单,可以使用lambda表达式来描述</p> 
<pre><code class="prism language-python">a_list  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">136</span><span class="token punctuation">,</span><span class="token number">314</span><span class="token punctuation">,</span><span class="token number">212</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span>a_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [12, 54, 9]</span>
</code></pre> 
<h4><a id="map_901"></a>map()函数</h4> 
<p>map(function, iterable, …)<br> 参数：<br> function是映射函数<br> iterable是一个或多个可迭代序列<br> 返回值：<br> 迭代器<br> 在第一个参数代表的函数加工下，第二个参数代表的数据源就会转换成一个新的序列</p> 
<pre><code class="prism language-python"><span class="token comment"># 求字符串组成的列表的每个字符串的长度序列</span>
<span class="token keyword">def</span> <span class="token function">lenstr</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
list2  <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>lenstr<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'sad'</span><span class="token punctuation">,</span><span class="token string">'byebye'</span><span class="token punctuation">,</span><span class="token string">'china'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list2<span class="token punctuation">)</span>
<span class="token comment">#[5, 3, 6, 5]</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># lambda改写</span>
list3 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'asd'</span><span class="token punctuation">,</span><span class="token string">'qwewqeq'</span><span class="token punctuation">,</span><span class="token string">'12334'</span><span class="token punctuation">,</span><span class="token string">'xzcx'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list3<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">myFunc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token comment"># str_cat = map(myFunc,('1','ss','wxs'),('2','sda','wwww'))</span>
str_cat <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">+</span>y<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'ss'</span><span class="token punctuation">,</span><span class="token string">'wxs'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'sda'</span><span class="token punctuation">,</span><span class="token string">'wwww'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>str_cat<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># ['12', 'sssda', 'wxswwww']</span>
</code></pre> 
<p>注:使用列表推导式也能完成类似功能.但是map()函数的出现,使得效率高很多.</p> 
<h4><a id="reduce_935"></a>reduce()函数</h4> 
<p>reduce的本意就是规约或减少<br> reduce(function,iterable,[,initializer])<br> function 实现规约功能的二元函数<br> iterable 可迭代对象<br> initializer 初试参数</p> 
<p>reduce对一个可迭代对象中的所有数据执行下列操作,取前两个参数,利用function代表的规则进行计算,得到的结果再与iterable的第三个数据拼成一堆,然后再利用function代表的规则进行运算.得到下一个结果…以此类推.直到计算出最后一个结果.<br> reduce函数在python3的内建函数移除了，放入了functools模块</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x<span class="token operator">+</span>y<span class="token punctuation">,</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 5050</span>
</code></pre> 
<p>利用reduce函数求最大最小值</p> 
<pre><code class="prism language-python">a_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">888</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span>x <span class="token keyword">if</span> x <span class="token operator">&gt;</span> y <span class="token keyword">else</span> y<span class="token punctuation">,</span>a_list<span class="token punctuation">)</span>
<span class="token comment"># 888</span>
</code></pre> 
<h4><a id="sorted_956"></a>sorted()函数</h4> 
<p>sorted(iterable, key=None, reverse=False)<br> 如果指定了<code>key</code>参数，排序时会让<code>key</code>参数指定的函数作用于序列中的每一个元素，对作用后的结果进行比较，来决定排序的顺序。</p> 
<pre><code class="prism language-python">a_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">888</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token builtin">sorted</span><span class="token punctuation">(</span>a_list<span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">,</span> reverse <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># [-888, -234, 5, 2, 1, 1, 0]</span>
<span class="token comment"># abs是函数名,不写圆括号</span>

<span class="token comment"># key = len</span>
<span class="token comment"># key = str.lower</span>

<span class="token builtin">sorted</span><span class="token punctuation">(</span>a_list<span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 对列表的每一个元素,模2,按照结果(要么0要么1)排序</span>
<span class="token comment"># 因此实现了把偶数,奇数分离开</span>
<span class="token comment"># [-234, -888, 2, 0, 1, 5, 1]</span>

<span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>a_list<span class="token punctuation">)</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># [-888, -234, 0, 2, 1, 1, 5]</span>

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Cindy'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'David'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token builtin">sorted</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token keyword">lambda</span> item<span class="token punctuation">:</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 按年龄排序</span>
<span class="token comment"># [['David', 23], ['Bob', 24], ['Alice', 25], ['Cindy', 28]]</span>

</code></pre> 
<h3><a id="_982"></a>例题</h3> 
<h4><a id="zip_983"></a>zip()</h4> 
<ul><li>zip()：用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回对象，而不是列表。如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，如果只有一个可迭代对象,那么zip()会找到空元素来代替.<br> 利用 * 号操作符，可以将可迭代对象解包。</li></ul> 
<p>matrix = [[1,2,3],[4,5,6]] list(zip(*matrix)) 和 list(zip(matrix))的结果分别是什么</p> 
<pre><code class="prism language-python">matrix <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>matrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>matrix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[(1, 4), (2, 5), (3, 6)] *将matrix解包成[1,2,3]和[4,5,6]然后zip函数一一缝合成元组
[([1, 2, 3],), ([4, 5, 6],)] 只有一个可迭代对象，zip找到空元素来代替. (,)必不可少,这是第二个可迭代对象缺位的标志.
'''</span>
</code></pre> 
<h4><a id="itemgetter_997"></a>itemgetter()</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> operator <span class="token keyword">import</span> itemgetter
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> itemgetter<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 定义函数b, 获取对象第0个,第2个域的值</span>
b<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment"># 获取列表a的第0个,第2个域的值</span>
<span class="token comment"># (1, 3)</span>
</code></pre> 
<pre><code class="prism language-python">x <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{<!-- --></span><span class="token string">"语文"</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">:</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">:</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token string">"物理"</span><span class="token punctuation">:</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token string">"化学"</span><span class="token punctuation">:</span><span class="token number">83</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{<!-- --></span><span class="token string">"语文"</span><span class="token punctuation">:</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">:</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">:</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token string">"物理"</span><span class="token punctuation">:</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token string">"化学"</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{<!-- --></span><span class="token string">"语文"</span><span class="token punctuation">:</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">:</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">:</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token string">"物理"</span><span class="token punctuation">:</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token string">"化学"</span><span class="token punctuation">:</span><span class="token number">88</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{<!-- --></span><span class="token string">"语文"</span><span class="token punctuation">:</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token string">"数学"</span><span class="token punctuation">:</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token string">"英语"</span><span class="token punctuation">:</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token string">"物理"</span><span class="token punctuation">:</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token string">"化学"</span><span class="token punctuation">:</span><span class="token number">79</span><span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token comment">#使用itemgetter,按照语文成绩排序</span>
x_yuwen <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> key <span class="token operator">=</span> itemgetter<span class="token punctuation">(</span><span class="token string">"语文"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#使用itemgetter,按照数学成绩排序</span>
x_shuxue <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> key <span class="token operator">=</span> itemgetter<span class="token punctuation">(</span><span class="token string">"数学"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#使用匿名函数按照物理成绩排序</span>
x_wuli <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token string">"物理"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> key <span class="token operator">=</span> itemgetter<span class="token punctuation">(</span><span class="token string">'数学'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
[
{'语文': 76, '数学': 86, '英语': 60, '物理': 82, '化学': 79}, 
{'语文': 80, '数学': 90, '英语': 70, '物理': 92, '化学': 83}, 
{'语文': 82, '数学': 70, '英语': 78, '物理': 90, '化学': 80}, 
{'语文': 86, '数学': 89, '英语': 73, '物理': 82, '化学': 88}
]
[
{'语文': 82, '数学': 70, '英语': 78, '物理': 90, '化学': 80}, 
{'语文': 76, '数学': 86, '英语': 60, '物理': 82, '化学': 79}, 
{'语文': 86, '数学': 89, '英语': 73, '物理': 82, '化学': 88}, 
{'语文': 80, '数学': 90, '英语': 70, '物理': 92, '化学': 83}
]
[
{'语文': 86, '数学': 89, '英语': 73, '物理': 82, '化学': 88}, 
{'语文': 76, '数学': 86, '英语': 60, '物理': 82, '化学': 79}, 
{'语文': 82, '数学': 70, '英语': 78, '物理': 90, '化学': 80}, 
{'语文': 80, '数学': 90, '英语': 70, '物理': 92, '化学': 83}
]"""</span>
</code></pre> 
<h4><a id="print_1041"></a>print()</h4> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span>objects<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">' '</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token operator">=</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
objects – 复数，表示可以一次输出多个对象。输出多个对象时，需要用 , 分隔。  
sep – 用来间隔多个对象，默认值是一个空格。  
end – 用来设定以什么结尾。默认值是换行符 \n，我们可以换成其他字符串。  
file – 要写入的文件对象。
'''</span>
</code></pre> 
<h2><a id="5_Python_1052"></a>5 Python高级特性</h2> 
<h3><a id="_1053"></a>面向对象程序设计</h3> 
<h4><a id="_1054"></a>面向过程和面向对象</h4> 
<ul><li>面向过程设计POP 程序 = 算法 + 数据结构</li><li>面向对象设计OOP 程序 = 对象 + 消息传递</li></ul> 
<p>OOP,用户首先自定义一个数据结构----类,然后用该类下的对象组装程序. 对象之间通过’‘消息’'进行通信. 每个对象中既包括数据,又包括对数据的处理. 每个对象都像一个封闭的小型机器,彼此协作,又不相互干扰.<br> 但是执行效率可能比POP低 , 复杂度高<br> POP 怎么做<br> OOP 谁来做<br> 对象 = 数据 + 方法<br> 因此 OOP 程序 = 数据 + 方法 + 消息传递</p> 
<h4><a id="_1065"></a>类的定义与使用</h4> 
<p>将具有相同属性和相同行为封装在一起,便创造了新的类,这大大扩充了数据类型的概念.<br> 类是对某一类事物的描述,它是抽象的,概念上的定义.而对象是实际存在的该类事物中的个体,因此对象也被称为实例(instance).<br> 在python中,方法是于特定实例绑定的函数,因此我们常把类中的函数称为方法,而把不于实例绑定的普通功能块称为函数<br> 类中的数据成员(属性)可大致分为两类:属于对象的数据成员和属于类的数据成员.<br> 对象.属性名<br> 对象.方法名</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    height <span class="token operator">=</span> <span class="token number">140</span> <span class="token comment"># 定义类的数据成员</span>
    <span class="token comment"># 定义构造方法</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> weight<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token comment"># 定义对象的数据成员属性</span>
        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age
        <span class="token comment"># 定义私有属性,私有属性在类外部无法访问</span>
        self<span class="token punctuation">.</span>__weight <span class="token operator">=</span> weight
    <span class="token keyword">def</span> <span class="token function">speak</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s 说: 我 %d 岁, 我体重为 %d kg, 身高为 %d cm"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>age<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__weight<span class="token punctuation">,</span> Person<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>构造方法__init__必须以self为前缀,用于对象的初始化.<br> 属于类的数据成员为所有对象共享,类似于java的静态数据成员. 在__init__方法中,三个数据成员都以self.作为访问修饰,这表明他们是属于对象的数据成员.__weight 代表它是一个私有成员.<br> 私有数据成员在类外通常不能被直接访问的.如果想访问需要借助公有成员函数(相当于类的外部接口).同样,如果某个方法是由两个下划线开始的,则表明它是一个私有方法.也只能在类的内部被调用.<br> python可以为对象添加新的临时属性,但该属性和其他对象无关.</p> 
<pre><code class="prism language-python">p1 <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">60</span> <span class="token comment"># 给实例绑定了一个实例属性。</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>_Person__weight<span class="token punctuation">)</span>
<span class="token comment"># Alice 说: 我 10 岁, 我体重为 30 kg, 身高为 140 cm</span>
<span class="token comment"># 60</span>
<span class="token comment"># 30</span>
<span class="token comment"># print(p1.__weight)</span>
<span class="token comment"># 报错</span>

p1<span class="token punctuation">.</span>asad <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>asad<span class="token punctuation">)</span>
<span class="token comment"># 1</span>
</code></pre> 
<p>dir(对象)可以查看对象的属性的方法<br> 我们可以看到,p1的属性weight和asadp2没有.<br> 其次私有变量的形式是: _类名__私有属性名</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">dir</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
_Person__weight
__class__
__delattr__
__dict__
__dir__
__doc__
__eq__
__format__
__ge__
__getattribute__
__gt__
__hash__
__init__
__init_subclass__
__le__
__lt__
__module__
__ne__
__new__
__reduce__
__reduce_ex__
__repr__
__setattr__
__sizeof__
__str__
__subclasshook__
__weakref__
age
asad
height
name
speak
weight
'''</span>
p2 <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span>

p2<span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">dir</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">,</span>sep <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
Bob 说: 我 11 岁, 我体重为 40 kg, 身高为 140 cm
_Person__weight
__class__
__delattr__
__dict__
__dir__
__doc__
__eq__
__format__
__ge__
__getattribute__
__gt__
__hash__
__init__
__init_subclass__
__le__
__lt__
__module__
__ne__
__new__
__reduce__
__reduce_ex__
__repr__
__setattr__
__sizeof__
__str__
__subclasshook__
__weakref__
age
height
name
speak
'''</span>
</code></pre> 
<p>千万不要在实例上修改类属性，它实际上并没有修改类属性，而是给实例绑定了一个实例属性。</p> 
<pre><code class="prism language-python">p1<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">150</span>
p1<span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>
Person<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">150</span>
p1<span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>
p2<span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># Alice 说: 我 10 岁, 我体重为 30 kg, 身高为 140 cm</span>
<span class="token comment"># Alice 说: 我 10 岁, 我体重为 30 kg, 身高为 150 cm</span>
<span class="token comment"># Bob 说: 我 11 岁, 我体重为 40 kg, 身高为 150 cm</span>
</code></pre> 
<p>_xxx 保护成员,只对自己和子类开放访问权限<br> __xxx__ python系统自定义的特殊成员<br> __xxx 私有成员,这类成员只能供类内部使用,不能被继承,但可以通过<br> 对象名._类名__xxx 的方式调用. 因此,严格意义上, python不存在私有成员.</p> 
<h4><a id="_1203"></a>类的继承</h4> 
<p>既有的类叫基类,超类或父类 派生出的叫子类或派生类<br> python支持多继承,容易导致菱形继承(两个子类继承一个父类,又有子类同时继承这两个子类,最后子类的很多成员存在二义性问题,不知道它们来自哪个父类)<br> class 子类([模块.]父类)</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">:</span>
    grad <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> weight<span class="token punctuation">,</span> grad<span class="token punctuation">)</span><span class="token punctuation">:</span>
	    <span class="token comment"># 调用父类构造方法,初始化父类数据成员</span>
        Person<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>weight<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grad <span class="token operator">=</span> grad
    <span class="token comment"># 重写父类同名方法</span>
    <span class="token keyword">def</span> <span class="token function">speak</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
	    <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s 说: 我 %d 岁了, 我在读 %d 年级"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>age<span class="token punctuation">,</span> self<span class="token punctuation">.</span>grad<span class="token punctuation">)</span><span class="token punctuation">)</span>

s1 <span class="token operator">=</span> Student<span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span>speak<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># Alice 说: 我 11 岁, 我体重为 40 kg, 身高为 150 cm</span>
<span class="token comment"># Alice 说: 我 11 岁了, 我在读 5 年级</span>
</code></pre> 
<p>如果想在子类中调用父类的方法,可以使用内置方法super().方法 或者 父类名.方法</p> 
<h3><a id="_1227"></a>生成器与迭代器</h3> 
<h4><a id="_1228"></a>生成器</h4> 
<p>这些元素能不能按照某种算法推算出来,然后在后续循环过程中,根据这些元素不断推算出其他被访问的元素?生成器可以.<br> 本质上生成器就是一个生成元素的函数.<br> 生成器表达式 圆括号不是元组推导式,而更像是某个函数的标志</p> 
<pre><code class="prism language-python">gen <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># &lt;class 'generator'&gt;</span>
</code></pre> 
<p>next(generator)输出生成器的下一个元素</p> 
<p>利用yield创建生成器<br> 如果推算的规则比较复杂,难以利用列表推导式来生成,这时候就可以使用含yield关键字的函数.</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">fib</span><span class="token punctuation">(</span>xterms<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token number">0</span>
    a<span class="token punctuation">,</span>b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
    <span class="token keyword">while</span> n <span class="token operator">&lt;</span> xterms<span class="token punctuation">:</span>
<span class="token comment">#         print(b,end = ' ')</span>
        <span class="token keyword">yield</span> b <span class="token comment"># 表明这个函数是一个生成器</span>
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">+</span> b
        n <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> <span class="token string">'成功输出'</span>
f1 <span class="token operator">=</span> fib<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span>
</code></pre> 
<p>生成器的函数,调用next()时候,遇到yield就’半途而废’,再次执行时,会从上次返回的yield语句接着往下执行. 如果生成器还有return语句,也不是用来正常返回的.而是StopIteration的异常说明</p> 
<h4><a id="_1253"></a>迭代器</h4> 
<p>字符串,列表,元组,字典,集合等更确切的说实存储数据的容器.<br> 迭代器内部维护着一个状态,该状态用来记录当前迭代指针所在的位置,以方便下次迭代时获取正确的元素.一旦所有的元素都被遍历,那么迭代器就会指向容器对象的尾部,并触发停止迭代的异常.<br> 只有当迭代至某个值时,该元素才会被计算并获取.因此迭代器特别适合用于遍历大文件或无限集合,因为我们不用一次性将它们全部预存到内存之中,用哪个再临时拿来即可.</p> 
<p>next()输出迭代器的下一个元素</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token comment"># next(x) 报错</span>
y <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token comment"># 1</span>
</code></pre> 
<p>迭代器实际上是某个迭代类定义的对象</p> 
<pre><code class="prism language-python">__iter__
__next__
</code></pre> 
<p>islice(iterable,start,stop[,step]) 迭代分片<br> f 是一个可迭代对象,因为实现了__iter__方法,又是一个迭代器,因为实现了__next__方法</p> 
<ul><li>next会为下次调用next()修改状态</li><li>为当前调用生成返回结果</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> itertools <span class="token keyword">import</span> islice
<span class="token keyword">class</span> <span class="token class-name">Fib</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>previous <span class="token operator">=</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self
    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        value <span class="token operator">=</span> self<span class="token punctuation">.</span>current
        self<span class="token punctuation">.</span>previous<span class="token punctuation">,</span>self<span class="token punctuation">.</span>current <span class="token operator">=</span> self<span class="token punctuation">.</span>current<span class="token punctuation">,</span>self<span class="token punctuation">.</span>previous <span class="token operator">+</span> self<span class="token punctuation">.</span>current
        <span class="token comment"># 多变量同时赋值 分开就错 </span>
        <span class="token keyword">return</span> value

f <span class="token operator">=</span> Fib<span class="token punctuation">(</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>islice<span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token comment"># [1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</span>
</code></pre> 
<h3><a id="_1295"></a>文件操作</h3> 
<h4><a id="_1296"></a>打开文件</h4> 
<p>打开模式<br> 'r’只读 不存在会报错<br> 'w’只写 不存在则创建<br> 'a’新内容写到尾部,不存在文件则创建<br> 't’以文本文件模式打开,默认<br> 'b’以二进制打开,图片,音频等<br> '+'打开文件并允许更新,可读可写<br> 以上模式可以组合</p> 
<p>加入encoding = 'utf-8’参数 以utf-8编码读入</p> 
<pre><code class="prism language-python">fhand <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap05-Python-advanced\python.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> fhand<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
In this tutorial, you鈥檒l learn about Python operator precedence and associativity. 

This topic is crucial for programmers to understand the semantics of Python operators.

After reading it, you should be able to know how Python evaluates the order of its operators. 

Some operators have higher precedence than others such as the multiplication operator has higher priority than the addition operator, 

so do multiplication before addition.
'''</span>
fhand<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># ''</span>
</code></pre> 
<p>read()方法,将文本文件一次性读取出来.如果文件太大,那么内存就爆了<br> 此时文件指针指向文件末尾,再用read方法,指针进无可进</p> 
<p>利用seek()方法<br> 0代表文件开头,1代表从当前位置算起,2表示从文件末尾算起</p> 
<pre><code class="prism language-python">fhand<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># 0</span>
fhand<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token string">'In this tutorial, you鈥檒l learn about Python operator precedence and associativity. \nThis topic is crucial for programmers to understand the semantics of Python operators.\nAfter reading it, you should be able to know how Python evaluates the order of its operators. \nSome operators have higher precedence than others such as the multiplication operator has higher priority than the addition operator, \nso do multiplication before addition.'</span>
</code></pre> 
<p>tell方法返回文件指针的当前位置</p> 
<pre><code class="prism language-python">fhand<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token comment"># 444</span>
</code></pre> 
<p>由于文件指针在末尾,因此给出整个文本的字节数.</p> 
<p>read(x)表示读取x个字节的数据</p> 
<h4><a id="_1348"></a>读取一行与全部行</h4> 
<p>readline()读取一行包括换行符(‘\n’)本身.<br> readlines()读取全部行 以行为单位的 最方便<br> read() 以字节为单位的</p> 
<pre><code class="prism language-python">fhand<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
lines <span class="token operator">=</span> fhand<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
lines<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token punctuation">[</span><span class="token string">'In this tutorial, you鈥檒l learn about Python operator precedence and associativity. \n'</span><span class="token punctuation">,</span>
 <span class="token string">'This topic is crucial for programmers to understand the semantics of Python operators.\n'</span><span class="token punctuation">]</span>
</code></pre> 
<p>close()关闭文件 回收资源<br> 文件读写会产生异常,建议try finally</p> 
<p>避免忘记关文件 使用with语句自动close.</p> 
<pre><code class="prism language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'python.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment"># 其他语句</span>
</code></pre> 
<h4><a id="_1371"></a>写入文件</h4> 
<p>write()</p> 
<pre><code class="prism language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap05-Python-advanced\python.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'test1'</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">'''
    文件内容都被清空了,只剩下test1.
    '''</span>
</code></pre> 
<h3><a id="_1380"></a>异常处理</h3> 
<p>try-except-finally<br> try管住代码,发生异常则进入except语句块,没有异常则不进入.最终都要进入finally语句块.</p> 
<pre><code class="prism language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> ZeroDivisionError <span class="token keyword">as</span> err<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'发生'</span><span class="token punctuation">,</span>err<span class="token punctuation">,</span><span class="token string">' 异常'</span><span class="token punctuation">)</span>
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'演示代码'</span><span class="token punctuation">)</span>
</code></pre> 
<p>抛出异常</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'x应该小于5,当前值为%d'</span> <span class="token operator">%</span> x<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_1399"></a>错误调试</h3> 
<p>断言<br> 如果条件不成立则抛出异常</p> 
<pre><code class="prism language-python"><span class="token keyword">assert</span> 条件
等同于
<span class="token keyword">if</span> <span class="token keyword">not</span> 条件<span class="token punctuation">:</span>
	<span class="token keyword">raise</span> AssertionError
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">avg</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'列表为空!'</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token comment"># list1 = []</span>
<span class="token comment"># print(avg(list1))</span>
list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3.2</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>avg<span class="token punctuation">(</span>list2<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_1418"></a>视图与副本</h3> 
<p><code>a[1:3]</code>得到的是原数组的视图，而<code>a[[1, 2]]</code>得到的是原数组的副本。具体来说：</p> 
<ul><li>视图是对原数组的引用，或者自身没有数据，与原数组<mark>共享数据</mark>；</li><li>副本是对原数组的完整拷贝，虽然经过拷贝后的数组中的数据来自于原数组，但是它相对于原数组是<mark>独立</mark>的；</li></ul> 
<h2><a id="6_NumPy_1423"></a>6 NumPy向量计算</h2> 
<h3><a id="61_NumPy_1424"></a>6.1 为何需要NumPy</h3> 
<p>机器学习经常要用到矩阵（向量）和数组运算。python中的列表，为了区分彼此，要保存列表中每个元素的指针，非常低效。python的array模块只支持一维数组。<br> numpy支持多维数组ndarray与矩阵运算，提供大量数学函数库。<br> 对scipy，pandas等库提供了底层支持。</p> 
<h3><a id="62_NumPy_1428"></a>6.2 如何导入NumPy</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre> 
<h3><a id="63_NumPy_1432"></a>6.3 生成NumPy数组</h3> 
<h4><a id="631__1434"></a>6.3.1 利用序列生成</h4> 
<p>如果numpy数组精度不一, numpy会将数据转成精度更高的数据.<br> dtype属性, 描述数组的数据类型.</p> 
<pre><code class="prism language-python">data1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8.5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
arr1 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">,</span>arr1<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span>
<span class="token comment"># [1.  8.5 3.  0.  2. ] &lt;class 'numpy.ndarray'&gt; float64</span>
</code></pre> 
<p>astype()显示指定被转换数组的数据类型<br> 如果字符串数组表示的全是数字，也可以用astype转化为数值类型；如果字符串数组里不是以数字存储，则不能转换。</p> 
<pre><code class="prism language-python">arr2 <span class="token operator">=</span> arr1<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>
<span class="token comment"># arr1.astype('int32')</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">data2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3.2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
arr2 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data2<span class="token punctuation">)</span> <span class="token comment"># 转换成二维数组</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[ 1.   2.   4.   5.   2. ]
 [21.   2.   7.   3.2  1. ]]
'''</span>
</code></pre> 
<h4><a id="632__1462"></a>6.3.2 利用特定函数生成</h4> 
<p>arange(start, stop, step, dtype) 左闭右开,step默认为1,dtype默认输入数据的类型<br> 类似range()函数<br> arange步长可以为任意实数,range不可以.</p> 
<pre><code class="prism language-python">arr3 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr3<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>arr3<span class="token punctuation">)</span><span class="token punctuation">,</span>arr3<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span>
<span class="token comment"># [0 1 2 3 4 5 6 7 8 9] &lt;class 'numpy.ndarray'&gt; int32</span>
</code></pre> 
<pre><code class="prism language-python">arr4 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr4<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[0.  0.5 1.  1.5 2.  2.5 3.  3.5 4.  4.5 5.  5.5 6.  6.5 7.  7.5 8.  8.5
 9.  9.5]
'''</span>
</code></pre> 
<p>arr3是一个向量,能和标量1相加,是利用了"广播"机制.广播机制将标量1扩展为等长向量[1,1,1,1,1,1,1,1,1,1,]因此才实现了加法.</p> 
<pre><code class="prism language-python">arr3 <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr3<span class="token punctuation">)</span>
<span class="token comment"># [ 1  2  3  4  5  6  7  8  9 10]</span>
</code></pre> 
<p>当我们想在指定区间内生成指定个数的数组时,如果利用np.arange()来生成,则需要手动计算步长.<br> 其实可以用np.linspace()函数来解决.</p> 
<ul><li>linspace(start, stop, num)<br> 左闭右闭,num指定均匀等分的数据个数. 注意arange是左闭右开.<br> 我们也可以指定endpoint = False来使区间变为左闭右开区间.</li></ul> 
<pre><code class="prism language-python">arr5 <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr5<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[ 0.          0.52631579  1.05263158  1.57894737  2.10526316  2.63157895
  3.15789474  3.68421053  4.21052632  4.73684211  5.26315789  5.78947368
  6.31578947  6.84210526  7.36842105  7.89473684  8.42105263  8.94736842
  9.47368421 10.        ]
'''</span>
</code></pre> 
<h4><a id="633_NumPy_1503"></a>6.3.3 NumPy数组的其他常用函数</h4> 
<ul><li>zeros(), ones()生成的数组由0或1来填充. shape参数指定数组维度, dtype指定数据精度.</li><li>full()生成任何形状</li></ul> 
<pre><code class="prism language-python">zeros <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># (3,4)实际上是一个匿名的元组.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>zeros<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[1. 1. 1. 1.]
 [1. 1. 1. 1.]
 [1. 1. 1. 1.]]
'''</span>
 
</code></pre> 
<pre><code class="prism language-python">ones <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>shape <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ones<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[1 1 1]
 [1 1 1]
 [1 1 1]
 [1 1 1]]
'''</span>
</code></pre> 
<ul><li>zeros_like(), ones_like()利用某个给定数组的类型尺寸,但所有元素都被替换为0或1</li><li>empty_like()数组元素没有被初始化.</li><li>full_like(a,value) 该数组a元素都被初始化为某个定值value,默认一维,shape参数指定类型</li></ul> 
<pre><code class="prism language-python">data2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">3.2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
data2_zeros <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>data2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data2_zeros<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0.]]
'''</span>
data3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
arr6 <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data3<span class="token punctuation">)</span>
data3_ones <span class="token operator">=</span> np<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>arr6<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data3_ones<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[1 1 1 1]
 [1 1 1 1]
 [1 1 1 1]]
'''</span>
</code></pre> 
<pre><code class="prism language-python">np<span class="token punctuation">.</span>full_like<span class="token punctuation">(</span>arr5<span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>shape <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
array([[9., 9., 9., 9., 9.],
       [9., 9., 9., 9., 9.],
       [9., 9., 9., 9., 9.],
       [9., 9., 9., 9., 9.]])
'''</span>
</code></pre> 
<p>将数组重构的方法</p> 
<ul><li>arr.reshape((2,3))</li><li>arr.shape = (3,4)</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>data3_ones<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
data3_ones<span class="token punctuation">.</span>shape <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data3_ones<span class="token punctuation">)</span>
<span class="token comment"># print(data3_ones.shape = (1,12))</span>
<span class="token triple-quoted-string string">'''
[[1 1 1 1 1 1]
 [1 1 1 1 1 1]]
[[1 1 1 1 1 1 1 1 1 1 1 1]]
'''</span>
</code></pre> 
<h3><a id="64_N_1576"></a>6.4 N维数组的属性</h3> 
<ul><li>ndim维度</li><li>shape形状</li><li>size大小(数组元素个数)</li></ul> 
<p>张量(Tensor)是矩阵在任意维度上的推广,张量的维度通常称为轴(axis)<br> 多个矩阵可以构成一个新的3D向量,多个3D向量可以构成一个4D向量.<br> 表达上,张量的方括号层次有多深,就表示这是多少维张量.</p> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''一维数组 又称1D张量 向量
形状用只含一个元素的元组表示

'''</span>
my_array <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_array<span class="token punctuation">.</span>ndim<span class="token punctuation">,</span> my_array<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> my_array<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token comment"># 1 (10,) 10</span>
<span class="token triple-quoted-string string">'''二维数组 又称2D张量 矩阵
形状第一个数字表示行,第二个数字表示列
'''</span>
my_array <span class="token operator">=</span> my_array<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>my_array<span class="token punctuation">.</span>ndim<span class="token punctuation">,</span> my_array<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> my_array<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token comment"># 2 (2, 5) 10</span>

<span class="token triple-quoted-string string">'''三维数组 又称3D张量
如果我们想创建两个三行五列的数组,它的形状参数为(2,3,5)
'''</span>
a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[[ 0  1  2  3  4]
  [ 5  6  7  8  9]
  [10 11 12 13 14]]

 [[15 16 17 18 19]
  [20 21 22 23 24]
  [25 26 27 28 29]]]
'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>ndim<span class="token punctuation">,</span>a<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>a<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token comment"># 3 (2, 3, 5) 30</span>
</code></pre> 
<h3><a id="65_NumPy_1617"></a>6.5 NumPy数组中的运算</h3> 
<h4><a id="651__1618"></a>6.5.1 向量运算</h4> 
<h4><a id="652__1619"></a>6.5.2 算术运算</h4> 
<p>对相同形状的数组<mark>逐元素</mark>进行 + - * / % ** 运算<br> 统计函数sum(), min(),average(),等 和 数学函数 sin(),cos()等</p> 
<p>注:对于二维数组,维度信息必须一模一样.而矩阵乘法,不需要一模一样.我们可以将数组转换为矩阵来实现矩阵乘法.</p> 
<pre><code class="prism language-python">arr_1 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
arr_2 <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr_1 <span class="token operator">/</span> arr_2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr_1 <span class="token operator">*</span> arr_2<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[0.         0.5        0.66666667 0.75      ]
 [0.8        0.83333333 0.85714286 0.875     ]
 [0.88888889 0.9        0.90909091 0.91666667]]
[[  0.   2.   6.  12.]
 [ 20.  30.  42.  56.]
 [ 72.  90. 110. 132.]]
'''</span>
</code></pre> 
<h4><a id="653__1638"></a>6.5.3 逐元素运算与张量点乘运算</h4> 
<p>数学上,不同形状的矩阵是可以进行乘法运算的,只要第一个矩阵的列和第二个矩阵的行相同就可以了. 矩阵乘法在NumPy里被称为dot()点乘</p> 
<ul><li>dot(a, b)两个数组进行点乘运算 或者 a @ b 实现两个元素的矩阵乘法</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
a <span class="token operator">=</span> np<span class="token punctuation">.</span>full_like<span class="token punctuation">(</span>arr_1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string">\n*\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>b<span class="token punctuation">}</span></span><span class="token string">\n=\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
*
[[ 1.  2.  3.]
 [ 4.  5.  6.]
 [ 7.  8.  9.]
 [10. 11. 12.]]
=
[[44. 52. 60.]
 [44. 52. 60.]
 [44. 52. 60.]]
'''</span>
</code></pre> 
<ul><li>mat()<br> 将数组转化成矩阵 然后直接相乘即可</li></ul> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
a <span class="token operator">*</span> b
<span class="token triple-quoted-string string">'''
matrix([[44., 52., 60.],
        [44., 52., 60.],
        [44., 52., 60.]])
'''</span>
</code></pre> 
<pre><code class="prism language-python">rand <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#创建0,1内随机数矩阵</span>
<span class="token triple-quoted-string string">'''
array([[0.74022509, 0.78820696, 0.26449078],
       [0.51691894, 0.03262771, 0.97027281],
       [0.47603836, 0.73180702, 0.20492381]])
'''</span>
</code></pre> 
<ul><li>其他<br> 矩阵r.I 返回逆矩阵, r.T 返回转置矩阵, r.A, 返回矩阵对应的数组.<br> np.eye()生成单位矩阵, np.diag()生成对角矩阵.</li></ul> 
<pre><code class="prism language-python">r <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>rand<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'逆矩阵:\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>r<span class="token punctuation">.</span>I<span class="token punctuation">}</span></span><span class="token string">\n转置矩阵\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>r<span class="token punctuation">.</span>T<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
逆矩阵:
[[ 4.87988147 -0.22224735 -5.24606218]
 [-2.46959989 -0.17887277  4.03438606]
 [-2.51674143  1.15505666  2.65920689]]
转置矩阵
[[0.74022509 0.51691894 0.47603836]
 [0.78820696 0.03262771 0.73180702]
 [0.26449078 0.97027281 0.20492381]]
'''</span>
</code></pre> 
<p>注意:如果矩阵的逆和矩阵相乘不是单位矩阵,很可能是矩阵不可逆.<br> 如果np.linalg.det(矩阵)接近0则代表矩阵不可逆.</p> 
<h3><a id="66__1706"></a>6.6 爱因斯坦求和约定</h3> 
<h4><a id="661__1708"></a>6.6.1 不一样的标记法</h4> 
<h4><a id="662_einsum_1709"></a>6.6.2 einsum()方法</h4> 
<p>用einsum()就能实现求和, 求外积, 求内积, 矩阵乘法, 矩阵转置, 求迹等操作.<br> 如果我们用sum(), mat(), trace(), tensordot()来实现的话, 名称复杂, 进行高维度张量计算时容易出错.</p> 
<p>输入格式字符-&gt;输出格式字符<br> 格式字符串的字符数和张量的维数对应.ij代表二维张量,j表示一维张量,为空则表示0维张量即标量.</p> 
<pre><code class="prism language-python">arr1 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span>
sum_col <span class="token operator">=</span> np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij-&gt;j'</span><span class="token punctuation">,</span>arr1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sum_col<span class="token punctuation">)</span>
sum_row <span class="token operator">=</span> np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ab-&gt;a'</span><span class="token punctuation">,</span>arr1<span class="token punctuation">)</span>
<span class="token comment"># sum_row = np.einsum('...a-&gt;...',arr1)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sum_row<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[30 34 38 42 46]
[10 35 60 85]
'''</span>
</code></pre> 
<p>按照字符出现的顺序,i表示行j表示列,字符减少为1个,说明输出变量被降维了.而j被保留,它代表列,这说明行这个维度被消灭了.于是,这说明通过求和的方式达到维度约减.也就是上述操作实现了按列求和.<br> 在格式字符串用什么字母不重要.ab-&gt;a完全没问题.<br> 可以把没被约减掉的字母用…代替</p> 
<p>einsum实现矩阵乘法</p> 
<pre><code class="prism language-python">A <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
B <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>list1<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># print(A @ B)</span>
<span class="token triple-quoted-string string">'''
[[10  7 16]
 [25 22 46]
 [40 37 76]]
'''</span>
result <span class="token operator">=</span> np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij,jk-&gt;ik'</span><span class="token punctuation">,</span>A<span class="token punctuation">,</span>B<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[10  7 16]
 [25 22 46]
 [40 37 76]]
'''</span>
</code></pre> 
<p>A,B对应格式字符串为ij,jk. 他们有相同的字符j,而j是A的列,B的行,说明j降维了,只有矩阵乘法才有类似的功效.</p> 
<p>einsum()其他用法.</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># a,b</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token comment"># 对应元素相乘</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij,ij-&gt;ij'</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 对应元素相乘</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 矩阵乘法</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij,ij-&gt;'</span><span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 向量内积</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ii-&gt;i'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 矩阵的迹</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij-&gt;ji'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 矩阵转置</span>
<span class="token triple-quoted-string string">'''
[[1. 2.]
 [3. 4.]]
[[1. 2.]
 [3. 4.]]
[[3. 3.]
 [7. 7.]]
10.0
[1 4]
[[1 3]
 [2 4]]
'''</span>
</code></pre> 
<h3><a id="67_NumPy_1777"></a>6.7 NumPy中的轴方向</h3> 
<p>约减:并非减法之意,而是元素的减少.例如加法就是一种约减,因为他对众多元素按照加法指令实施操作,最后合并为少数的一个或几个值.例如sum,max,mean都是一种约减.<br> 有的时候我们需要对某一维度的值进行统计,就需要给约减指定方向.</p> 
<p>默认全维度约减, axis = 0竖直方向, axis = 1水平方向.<br> 对于高维度数组而言,约减可以有先后顺序,因此axis的值还可以是一个向量,例如,axis = [0,1]表示先垂直后水平方向约减.</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 6.0</span>
a<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># array([2., 2., 2.]) 0代表垂直方向</span>
a<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># array([3., 3.]) 1代表水平方向</span>
</code></pre> 
<p>对于高维数组, 应该是按括号层次来理解.括号由内到外,对应从小到大的维数.比如,对于一个三维的数组, 其维度由外到内分别为0,1,2.</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>当我们指定sum()的axis = 0时,就是在第0个维度的元素之间进行求和操作,即拆掉最外层括号后对应的两个元素(在同一个层次)</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> 和 
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>然后对同一个括号层次下的两个张量实施逐元素约减操作, 结果为</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>若axis = 1 在第1个维度的元素之间进行求和操作<br> [1,1,1]和[2,2,2]在同一个括号(同一个维度)内相加,[3,3,3]和[4,4,4]在同一个括号内相加</p> 
<pre><code class="prism language-python">剩下<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>若axis = 2 在第2个维度的元素之间进行求和操作</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>1,1,1在同一个维度,2,2,2在同一个维度…</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
a<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
a<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
b<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
b<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
b<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
b<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>其他可实施约减的函数 如max,min和mean等,轴方向的约减也是类似的.</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'\n\n'</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'\n\n'</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'\n\n'</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[3 3 3]
 [4 4 4]] 

 [[2 2 2]
 [4 4 4]] 

 [[1 2]
 [3 4]] 

 4
'''</span>
</code></pre> 
<h3><a id="68__1887"></a>6.8 操作数组元素</h3> 
<h4><a id="681__1889"></a>6.8.1 通过索引访问数组元素</h4> 
<p>通过方括号访问,可反向访问.<br> 访问二维数组的两种方法</p> 
<ul><li>像c/c++一样用两个方括号分别写出维度信息</li><li>在一个方括号内, 给出两个维度信息, 用逗号分割.</li></ul> 
<pre><code class="prism language-python">two_dim <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

Out<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">5.</span><span class="token punctuation">,</span> <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">7.</span><span class="token punctuation">,</span> <span class="token number">8.</span><span class="token punctuation">,</span> <span class="token number">9.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
two_dim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">11</span>
two_dim

Out<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">11.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token number">8.</span><span class="token punctuation">,</span>  <span class="token number">9.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
two_dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span>
two_dim

Out<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token number">2.</span><span class="token punctuation">,</span>  <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">4.</span><span class="token punctuation">,</span> <span class="token number">11.</span><span class="token punctuation">,</span>  <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span> <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token number">8.</span><span class="token punctuation">,</span> <span class="token number">22.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="682_NumPy_1920"></a>6.8.2 NumPy中的切片访问</h4> 
<ul><li>和列表类似的操作</li><li>采取slice()函数实例化一个切片参数</li></ul> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> <span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> a<span class="token punctuation">[</span>s<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>s<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token comment">#&lt;class 'slice'&gt; &lt;class 'numpy.ndarray'&gt;</span>
<span class="token comment">#[0 1 2 3 4 5 6 7 8 9] slice(0, 9, 2) [0 2 4 6 8]</span>
</code></pre> 
<h4><a id="683__1933"></a>6.8.3 二维数组的转置与展平</h4> 
<p>转置</p> 
<ul><li>transpose()方法或T属性</li></ul> 
<p>展平</p> 
<ul><li>ravel() 返回视图 原数组没有改变</li><li>flatten() 深拷贝 原数组没有改变</li><li>显示变形 shape = (1,-1), -1表示列数是系统自动推导出来的,很常用.实际上还是二维数组,只是形状变了.</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#[ 1.  2.  3.  4. 11.  6.  7.  8. 22.]</span>
<span class="token comment">#[ 1.  2.  3.  4. 11.  6.  7.  8. 22.]</span>
two_dim<span class="token punctuation">.</span>shape <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">)</span>
<span class="token comment">#[[ 1.  2.  3.  4. 11.  6.  7.  8. 22.]]</span>
</code></pre> 
<h3><a id="69_NumPy_1952"></a>6.9 NumPy中的广播</h3> 
<p><img src="https://images2.imgbox.com/66/c6/i4xECbrl_o.png" alt="广播"></p> 
<h3><a id="610_NumPy_1955"></a>6.10 NumPy数组的高级索引</h3> 
<h4><a id="6101__1956"></a>6.10.1 '‘花式’'索引</h4> 
<p>如果我们想访问多个元素, 而它们又没什么规律可循,就可以采用花式索引.</p> 
<p>[0,0,0,4,5]为索引数组再作为数组a的下标, 达到访问多个元素的目的, 还可以访问重复的元素.</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
fancy_array <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fancy_array<span class="token punctuation">)</span>
<span class="token comment">#[ 1  1  1 43  8]</span>
index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 可读性更强</span>
</code></pre> 
<p>花式索引访问二维数组的行</p> 
<pre><code class="prism language-python">two_dim<span class="token punctuation">.</span>shape <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[ 1.  2.  3.]
 [ 4. 11.  6.]
 [ 7.  8. 22.]]
[[ 1.  2.  3.]
 [ 4. 11.  6.]
 [ 1.  2.  3.]]
'''</span>
</code></pre> 
<p>访问二维数组的列<br> 需要用冒号添加一个维度.two_dim[:,col_index]表示所有行都涉及, 但列的访问范围由col_index来限定.这里冒号的用法来自数组切片.</p> 
<pre><code class="prism language-python">col_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>col_index<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[ 1.  2.  1.]
 [ 4. 11.  4.]
 [ 7.  8.  7.]]
'''</span>
</code></pre> 
<p>其他花式访问</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># [ 4. 11.  4.]</span>
row_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
col_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>two_dim<span class="token punctuation">[</span>row_index<span class="token punctuation">,</span>col_index<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># [2. 6. 1.]</span>
</code></pre> 
<p>掩码<br> 有时候我们想要过滤一些不想要的元素.<br> 列的掩码,是一个布尔类型,由于非零为真,因此np.array([1,0,1,0,1], dtype = bool)等价于<br> np.array([True,False,True,False,True])<br> 下面使用了np.newaxis 相当于None.这里是为数组增加一个轴.</p> 
<pre><code class="prism language-python">two_dim_arr <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
two_dim_arr
<span class="token triple-quoted-string string">'''
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19]])
'''</span>
row_index <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#花式访问的行</span>
col_mask <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> <span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token comment">#列的掩码</span>
two_dim_arr<span class="token punctuation">[</span>row_index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span><span class="token punctuation">,</span>col_mask<span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
array([[ 0,  2,  4],
       [10, 12, 14],
       [ 5,  7,  9]])
'''</span>
</code></pre> 
<p>row_index[:,np.newaxis]将row_index从(3, )变成一个(3,1)<mark>伪</mark>二维数组,这样就相当于告诉numpy第一个参数无须和后面的参数拼接形成(行, 列)坐标对.<br> 如果不这样写,row就是个一维的索引,numpy会把它和后面的参数进行拼接.形成二维数组的访问坐标.<br> 再考虑到col_mask的站位和布尔属性,它实际上表示了哪些列可以取,哪些被过滤了.</p> 
<pre><code class="prism language-python">row_index
Out<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">:</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span>row_index<span class="token punctuation">.</span>shape
Out<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span>row_index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
		array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		       <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		       <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">:</span>row_index<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span><span class="token punctuation">.</span>shape
Out<span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">two_dim_arr<span class="token punctuation">[</span>row_index<span class="token punctuation">,</span>col_mask<span class="token punctuation">]</span>
<span class="token comment"># array([ 0, 12,  9])</span>
</code></pre> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
a<span class="token punctuation">[</span>a <span class="token operator">&gt;</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token comment">#array([10, 11, 12, 13, 14])</span>
</code></pre> 
<p>a是一个数组，9是标量，之所以能比较是因为广播技术。</p> 
<pre><code class="prism language-python">a <span class="token operator">&gt;</span> <span class="token number">9</span>
<span class="token triple-quoted-string string">'''
array([[False, False, False, False, False],
       [False, False, False, False, False],
       [ True,  True,  True,  True,  True]])
'''</span>
</code></pre> 
<p>这个尺度与原始数组相同的数组，叫作布尔数组。布尔数组可以整体作为索引，形成一个布尔索引，然后numpy会根据逐元素规则, 返回对应位置布尔值为True的元素. 因此, a[a &gt;9]的含义，就是返回数组中大于9的元素.</p> 
<h3><a id="611__2066"></a>6.11 数组的堆叠操作</h3> 
<h4><a id="6111_hstack_2067"></a>6.11.1 水平方向堆叠hstack()</h4> 
<p>hstack(tup),接收一个元组<br> concatenate(axis = 1), 可以完成同样的操作.</p> 
<pre><code class="prism language-python">arr1 <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype <span class="token operator">=</span> <span class="token builtin">int</span> <span class="token punctuation">)</span>
arr2 <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype <span class="token operator">=</span> <span class="token builtin">int</span> <span class="token punctuation">)</span>
np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span>arr2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
array([[0, 0, 1, 1, 1],
       [0, 0, 1, 1, 1]])
'''</span>
</code></pre> 
<h4><a id="6112_vstack_2079"></a>6.11.2 垂直方向堆叠vstack()</h4> 
<p>vstack(tup)垂直方向<br> concatenate(axis = 0)默认为0,即垂直方向</p> 
<h4><a id="6113_dstack_2082"></a>6.11.3 深度方向堆叠dstack()</h4> 
<p>在第三个维度堆叠</p> 
<pre><code class="prism language-python">red <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
blue <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
green <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>red<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>blue<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>green<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>dstack<span class="token punctuation">(</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span>blue<span class="token punctuation">,</span>green<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[0 1 2]
 [3 4 5]
 [6 7 8]]
[[ 9 10 11]
 [12 13 14]
 [15 16 17]]
[[18 19 20]
 [21 22 23]
 [24 25 26]]
[[[ 0  9 18]
  [ 1 10 19]
  [ 2 11 20]]

 [[ 3 12 21]
  [ 4 13 22]
  [ 5 14 23]]

 [[ 6 15 24]
  [ 7 16 25]
  [ 8 17 26]]]
'''</span>
</code></pre> 
<h4><a id="6114__2115"></a>6.11.4 列堆叠与行堆叠</h4> 
<p>column_stack() 增加列 row_stack()增加行<br> 列堆叠不等同于vstack垂直方向堆叠</p> 
<p>一维数组堆叠</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>row_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[0 1 2]
[3 4 5]
[[0 3]
 [1 4]
 [2 5]]
[[0 1 2]
 [3 4 5]]
[[0 1 2]
 [3 4 5]]
[0 1 2 3 4 5]
'''</span>
</code></pre> 
<p>二维数组堆叠<br> column_stack == hstack<br> row_stack == vstack</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span>blue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>vstack<span class="token punctuation">(</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span>blue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>row_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span>blue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span>blue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[ 0  1  2  9 10 11]
 [ 3  4  5 12 13 14]
 [ 6  7  8 15 16 17]]
[[ 0  1  2]
 [ 3  4  5]
 [ 6  7  8]
 [ 9 10 11]
 [12 13 14]
 [15 16 17]]
[[ 0  1  2]
 [ 3  4  5]
 [ 6  7  8]
 [ 9 10 11]
 [12 13 14]
 [15 16 17]]
[[ 0  1  2  9 10 11]
 [ 3  4  5 12 13 14]
 [ 6  7  8 15 16 17]]
'''</span>
</code></pre> 
<h4><a id="6115__2172"></a>6.11.5 数组的分割操作</h4> 
<p>split, hsplit, vsplit, dsplit</p> 
<p>hsplit(array, indices_or_sections)水平方向分割(列分割)等价于split(axis = 1)<br> 第一个参数表示被分割的数组, 第二个参数可为一个数或一个列表.<br> 数表示等分的份数, 列表(矩阵)表示位置.<br> hsplit返回列表, 每个元素都是一个数组.</p> 
<pre><code class="prism language-python">c <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
list1 <span class="token operator">=</span> np<span class="token punctuation">.</span>hsplit<span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment"># type(list1) list</span>
list1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
array([[ 1],
       [ 5],
       [ 9],
       [13]])
'''</span>
</code></pre> 
<p>vsplit垂直方向或行方向上的分割.等同于split(axis = 0)<br> dsplit深度方向分割 等同于split(axis = 2)</p> 
<pre><code class="prism language-python">array3 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
array3
Out<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
np<span class="token punctuation">.</span>dsplit<span class="token punctuation">(</span>array3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 分成了两个三维数组</span>
Out<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
<span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span> <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
 np<span class="token punctuation">.</span>dsplit<span class="token punctuation">(</span>array3<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 <span class="token punctuation">[</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

</code></pre> 
<h3><a id="612_NumPy_2224"></a>6.12 NumPy中的随机数模块</h3> 
<pre><code class="prism language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">213</span><span class="token punctuation">)</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 随机整数</span>

Out<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># 生成均匀分布的随机数</span>

Out<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.91588577</span><span class="token punctuation">,</span> <span class="token number">0.48486025</span><span class="token punctuation">,</span> <span class="token number">0.87004422</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token number">0.46589434</span><span class="token punctuation">,</span> <span class="token number">0.86203022</span><span class="token punctuation">,</span> <span class="token number">0.81577491</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># 生成标准正态分布的随机数</span>

Out<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.35993274</span><span class="token punctuation">,</span>  <span class="token number">0.16770878</span><span class="token punctuation">,</span>  <span class="token number">0.69561962</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.05569746</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.6872611</span> <span class="token punctuation">,</span>  <span class="token number">0.9953465</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
       
<span class="token comment"># Two-by-four array of samples from N(3, 6.25):</span>
<span class="token comment"># 生成均值为3,方差为6.25的随机数</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">2.5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4.49401501</span><span class="token punctuation">,</span>  <span class="token number">4.00950034</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.81814867</span><span class="token punctuation">,</span>  <span class="token number">7.29718677</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment"># random</span>
       <span class="token punctuation">[</span> <span class="token number">0.39924804</span><span class="token punctuation">,</span>  <span class="token number">4.68456316</span><span class="token punctuation">,</span>  <span class="token number">4.99394529</span><span class="token punctuation">,</span>  <span class="token number">4.84057254</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># random</span>
</code></pre> 
<h3><a id="614__2260"></a>6.14 思考与提高</h3> 
<ul><li>csv 文本格式, 数据用逗号分割.行尾有\n</li><li>join() 将序列中的元素以指定字符串连接生成一个新的字符串<br> str.join(sequence)</li><li>生成文件需要加上encoding = 'utf-8’否则会出错</li></ul> 
<pre><code class="prism language-python">symbol <span class="token operator">=</span> <span class="token string">"-"</span>
seq <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">)</span> <span class="token comment"># 字符串序列 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>symbol<span class="token punctuation">.</span>join<span class="token punctuation">(</span> seq <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># ','.join(seq)+'\n'</span>
<span class="token comment"># 'a,b,c\n'</span>
</code></pre> 
<ul><li>重塑为二维数组</li></ul> 
<pre><code class="prism language-python">two_dim_arr <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
two_dim_arr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment"># array([ 0,  5, 10, 15])</span>
two_dim_arr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
array([[ 0],
       [ 5],
       [10],
       [15]])
'''</span>
</code></pre> 
<pre><code class="prism language-python">data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># 重塑成了二维数组</span>
<span class="token triple-quoted-string string">'''
array([['2019/3/1 00:00'],
       ['2019/3/1 00:15'],
       ['2019/3/1 00:30'],
       ...,
       ['2019/5/31 22:30'],
       ['2019/5/31 22:45'],
       ['2019/5/31 23:00']], dtype='&lt;U16')
'''</span>
</code></pre> 
<ul><li>np.column_stack(tup)</li></ul> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
会先把一维数组按列堆叠为二维数组
'''</span>
<span class="token triple-quoted-string string">'''
Stack 1-D arrays as columns into a 2-D array.

Take a sequence of 1-D arrays and stack them as columns
to make a single 2-D array. 2-D arrays are stacked as-is,
just like with `hstack`.  1-D arrays are turned into 2-D columns
first.
'''</span>
</code></pre> 
<p>按照NY, Ausin, Boulder三个城市, 将数据划分为三个文件,并以csv形式存储.</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'Grid, solar, and EV data from three homes.csv'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    lines <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
        temp <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
<span class="token comment"># 分割表头</span>
header <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment"># 花式访问默认访问行</span>
<span class="token comment">#分割数据</span>
data_np <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 提取日期列(二维数组花式访问列)</span>
date <span class="token operator">=</span> data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment"># 构建表头</span>
NY_header <span class="token operator">=</span> header<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
Austin_header <span class="token operator">=</span> header<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> header<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span>
<span class="token comment"># header[0]取出的是字符串而非列表</span>
<span class="token comment"># 注意字符串和列表无法相加 </span>
<span class="token comment"># 用header[0:1]的方式取出仅包含一个元素的列表,然后相加</span>
Boulder_header <span class="token operator">=</span> <span class="token punctuation">[</span>header<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> header<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token comment"># 分割NY数据</span>
NY_data <span class="token operator">=</span> data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token comment"># 二维数组,行全取,列取前四</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1-NY.csv'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>NY_header<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span> <span class="token comment"># 先把表头连起来</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> NY_data<span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
Austin_data <span class="token operator">=</span> np<span class="token punctuation">.</span>hstack<span class="token punctuation">(</span><span class="token punctuation">(</span>data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># array不能像列表一样直接用+号相连,可以采用水平堆叠.</span>
<span class="token comment"># np.hstack((data_np[:,0], data_np[:, 4:7]))</span>
<span class="token comment"># all the input arrays must have same number of dimensions, but the array at index 0 has 1 dimension(s) and the array at index 1 has 2 dimension(s)</span>

<span class="token comment"># np.hstack((data_np[:,[0]],data_np[:, 4:7])) # 这样也可以</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1-Austin.csv'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>Austin_header<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> Austin_data<span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
Boulder_data <span class="token operator">=</span> np<span class="token punctuation">.</span>column_stack<span class="token punctuation">(</span><span class="token punctuation">(</span>data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># column_stack会先把一维数组按列堆叠为二维数组,这样就不用转换了</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1-Boulder.csv'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>Boulder_header<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> Boulder_data<span class="token punctuation">:</span>
        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>问题三个文件的数据都输出了12遍,(重新执行了一遍,好了)<br> 第三个还有空行.(写文件的时候不加回车就好了)</p> 
<ul><li>reader = csv.reader(f) 读文件对象</li><li>writer = csv.writer(f) 写文件对象</li><li>writer.writerows(out)写成csv文件自动加逗号回车</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> csv
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">def</span> <span class="token function">power_stats</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 读取文件数据</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
        <span class="token comment"># 跳过空行</span>
        data <span class="token operator">=</span> <span class="token punctuation">[</span>line <span class="token keyword">for</span> line <span class="token keyword">in</span> reader <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span>
        
    <span class="token comment">#除掉表头,提取数据</span>
    np_array <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">#分割日期</span>
    dates_str <span class="token operator">=</span> np_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment">#分割用电数据</span>
    elec_data <span class="token operator">=</span> np_array<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    
    <span class="token comment">#数据预处理, 否则类型转换会出错</span>
    elec_data<span class="token punctuation">[</span>elec_data <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0'</span>
    <span class="token comment">#转换数据类型</span>
    elec_data <span class="token operator">=</span> elec_data<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>
    

    <span class="token comment">#转换为日期对象</span>
    dates <span class="token operator">=</span> <span class="token punctuation">[</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>date<span class="token punctuation">,</span><span class="token string">'%Y/%m/%d %H:%M'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> date <span class="token keyword">in</span> dates_str<span class="token punctuation">]</span>
<span class="token comment">#     print(dates) dates是datetime类型的列表</span>
    <span class="token comment">#提取三个月份的数据索引</span>
    index_m3 <span class="token operator">=</span> <span class="token punctuation">[</span>date<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">3</span> <span class="token keyword">for</span> date <span class="token keyword">in</span> dates<span class="token punctuation">]</span> <span class="token comment"># 布尔数组</span>
    index_m4 <span class="token operator">=</span> <span class="token punctuation">[</span>date<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">4</span> <span class="token keyword">for</span> date <span class="token keyword">in</span> dates<span class="token punctuation">]</span>
    index_m5 <span class="token operator">=</span> <span class="token punctuation">[</span>date<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">5</span> <span class="token keyword">for</span> date <span class="token keyword">in</span> dates<span class="token punctuation">]</span>
<span class="token comment">#     print(index_m3)</span>
    elec3 <span class="token operator">=</span> elec_data<span class="token punctuation">[</span>index_m3<span class="token punctuation">]</span> <span class="token comment"># 每个月的电费列表</span>
    elec4 <span class="token operator">=</span> elec_data<span class="token punctuation">[</span>index_m4<span class="token punctuation">]</span>
    elec5 <span class="token operator">=</span> elec_data<span class="token punctuation">[</span>index_m5<span class="token punctuation">]</span>
<span class="token comment">#     print(elec3)</span>
<span class="token comment">#     m3_ratio = np.sum(elec3,axis = 0) / np.sum(elec3) # 列表 默认全维度约减, axis = 0竖直方向,</span>
    m3_ratio <span class="token operator">=</span> np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij-&gt;j'</span><span class="token punctuation">,</span>elec3<span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>einsum<span class="token punctuation">(</span><span class="token string">'ij-&gt;'</span><span class="token punctuation">,</span>elec3<span class="token punctuation">)</span>
    m4_ratio <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>elec4<span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>elec4<span class="token punctuation">)</span>
    m5_ratio <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>elec5<span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>elec5<span class="token punctuation">)</span>
<span class="token comment">#     print(np.sum(elec3),np.sum(elec3,axis = 0),m3_ratio)</span>
    <span class="token triple-quoted-string string">'''
    
    总量     每个部分的用电数据            占比
    4305.369 [1189.59  1073.14  2042.639] [0.27630384 0.24925622 0.47443994]
3192.221 [ 905.145  644.881 1642.195] [0.2835471 0.2020164 0.5144365]
2261.5 [1558.867  622.252   80.381] [0.68930665 0.27515012 0.03554322]
    '''</span>
    <span class="token keyword">return</span> m3_ratio<span class="token punctuation">,</span>m4_ratio<span class="token punctuation">,</span>m5_ratio


filename <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'1-NY.csv'</span><span class="token punctuation">,</span><span class="token string">'1-Austin.csv'</span><span class="token punctuation">,</span><span class="token string">'1-Boulder.csv'</span><span class="token punctuation">]</span>
out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># [out.extend(power_stats(file)) for file in filename] b写法可读性太差</span>
<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> filename<span class="token punctuation">:</span>
    out<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>power_stats<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># out</span>
<span class="token triple-quoted-string string">'''
[array([0.27630384, 0.24925622, 0.47443994]),
 array([0.18993516, 0.26238493, 0.54767991]),
 array([-0.14939335,  0.19007388,  0.95931948]),
 array([0.2835471, 0.2020164, 0.5144365]),
 array([0.27165157, 0.21153016, 0.51681827]),
 array([0.45301318, 0.15492749, 0.39205933]),
 array([0.68930665, 0.27515012, 0.03554322]),
 array([0.29504936, 0.19449082, 0.51045982]),
 array([0.32425077, 0.24613855, 0.42961069])]
'''</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./3.csv'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    writer<span class="token punctuation">.</span>writerows<span class="token punctuation">(</span>out<span class="token punctuation">)</span>
</code></pre> 
<p>问题 生成的文件会有空行.<br> 解决方法</p> 
<ol><li>: dialect = ‘unix’</li><li>: newline = ‘’</li></ol> 
<p>在Windows中：</p> 
<p>‘\r’ 回车，回到当前行的行首，而不会换到下一行，如果接着输出的话，本行以前的内容会被逐一覆盖；</p> 
<p>‘\n’ 换行，换到当前位置的下一行，而不会回到行首；</p> 
<p>Unix系统里，每行结尾只有“&lt;换行&gt;”，即"\n"；Windows系统里面，每行结尾是“&lt;回车&gt;&lt;换行&gt;”，即“\r\n”；Mac系统里，每行结尾是“&lt;回车&gt;”，即"\r"；。一个直接后果是，Unix/Mac系统下的文件在Windows里打开的话，所有文字会变成一行；而Windows里的文件在Unix/Mac下打开的话，在每行的结尾可能会多出一个^M符号。<br> 解决方法1</p> 
<p>在输出时，如果换行是None，则写入的任何’\ n’字符都被转换为系统默认行分隔符，os.linesep。 如果换行符是’‘(空字符)或’\ n’，不进行转换。 如果换行符是任何其他合法值【注意：不能将其随心所意地设置为其他英文字母，大家可以自行实验】，所有’\ n’字符都将被转换为给定的字符串。</p> 
<p>如果newline采用默认值None（即不进行指定任何指定），在Windows系统下，os.linesep即为’\r\n’，那么此时就会将’\n’转换为’\r\n’（即CRLF），所以会多一个’\r’（回车）出来，即’\r\r\n’。在csv中打开就会多一行。</p> 
<h3><a id="_2455"></a>其他</h3> 
<ul><li>np.argsort(a)<br> <strong>注意</strong>：返回的是元素值从小到大排序后的索引值的数组</li></ul> 
<pre><code class="prism language-python">In <span class="token punctuation">:</span>       	a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Out<span class="token punctuation">:</span> 		<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token comment"># 排序后 1 1 2 3 3 5 </span>
		<span class="token comment">#索引0,1,2,3,4,5 #排序后索引1 3 2 0 4 5</span>
In <span class="token punctuation">:</span> 		b <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>a<span class="token punctuation">)</span>                        <span class="token comment"># 对a按升序排列        </span>
Out<span class="token punctuation">:</span> 		<span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">3</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">]</span>      

In <span class="token punctuation">:</span> 		b <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token operator">-</span>a<span class="token punctuation">)</span>                       <span class="token comment"># 对a按降序排列        </span>
Out<span class="token punctuation">:</span> 		<span class="token punctuation">[</span><span class="token number">5</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">2</span> <span class="token number">1</span> <span class="token number">3</span><span class="token punctuation">]</span>               	

</code></pre> 
<ul><li>dtype = ‘&lt;U1’</li></ul> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
   `&lt;`表示字节顺序，小端（最小有效字节存储在最小地址中）
   
   `U`表示Unicode，数据类型
   
   `1`表示元素位长，数据大小
'''</span>
</code></pre> 
<h2><a id="7_Pandas_2480"></a>7 Pandas数据分析</h2> 
<p>Pandas基于NumPy但是有比ndarray更为高级的数据结构Series(类似一维数组)和DataFrame(类似二维数组).<br> Panel(类似三维数组)不常用已经被列为过时的数据结构.</p> 
<h3><a id="73_Series_2483"></a>7.3 Series类型数据</h3> 
<h4><a id="731_Series_2484"></a>7.3.1 Series的创建</h4> 
<p>series基于ndarray,因此必须类型相同.<br> pd.Series(data,index = index) index如果不写,默认从0~n-1</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0     1
1     0
2     2
3    55
dtype: int64
'''</span>
b <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5.3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
1    1.0
2    4.0
3    5.3
4    2.0
5    1.0
dtype: float64
'''</span>
</code></pre> 
<p>通过Series的index和values属性,分别获取索引和数组元素值.</p> 
<pre><code class="prism language-python">a<span class="token punctuation">.</span>values
Out<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>int64<span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span>a<span class="token punctuation">.</span>index
Out<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span>RangeIndex<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>修改索引</p> 
<pre><code class="prism language-python">a<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
a     1
b     0
c     2
d    55
dtype: int64
'''</span>
</code></pre> 
<p>利用字典创建Series<br> 区别:字典无序,series有序. series的index和value之间相互独立.Series的index可变,字典的key不可变.</p> 
<pre><code class="prism language-python">dict1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span>
c <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>dict1<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
a    1
b    2
c    3
dtype: int64
'''</span>
</code></pre> 
<p>describe()方法</p> 
<pre><code class="prism language-python">c<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
count    3.0个数
mean     2.0均值
std      1.0均方差
min      1.0最小值
25%      1.5前25%的数据的分位数
50%      2.0
75%      2.5
max      3.0最大值
dtype: float64
'''</span>
</code></pre> 
<h4><a id="732_Series_2556"></a>7.3.2 Series中的数据访问</h4> 
<p>采用方括号访问<br> 索引号访问<br> 索引值访问<br> 用列表一次访问多个</p> 
<pre><code class="prism language-python">c<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">99</span>
c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">77</span>
c
<span class="token triple-quoted-string string">'''
a    99
b     2
c    77
dtype: int64
'''</span>  
c<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
a    99
b     2
dtype: int64
'''</span>
</code></pre> 
<p>两个Series用append()方法叠加(append过时了,即将被移除,改用concat)<br> ignore_index=True重新添加索引</p> 
<pre><code class="prism language-python">s1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># s1.append(s2) </span>
<span class="token comment"># FutureWarning: The series.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    1
1    2
2    3
0    4
1    5
2    6
dtype: int64
'''</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">]</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    1
1    2
2    3
3    4
4    5
5    6
dtype: int64
'''</span>
</code></pre> 
<h4><a id="733_Series_2607"></a>7.3.3 Series中的向量化操作和布尔索引</h4> 
<pre><code class="prism language-python">c <span class="token operator">&gt;</span> c<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
a     True
b    False
c     True
dtype: bool
'''</span>
</code></pre> 
<p>Series对象也可以作为numpy参数,因为本质上,Series就是一系列数据,类似数组向量.</p> 
<pre><code class="prism language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="734_Series_2623"></a>7.3.4 Series中的切片操作</h4> 
<p>基于数字的切片左闭右开,基于标签的切片左闭右闭.</p> 
<pre><code class="prism language-python">s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
b    0.508859
c    0.524076
dtype: float64
'''</span>
s<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
a    0.585969
b    0.508859
c    0.524076
dtype: float64
'''</span>
</code></pre> 
<h4><a id="735_Series_2640"></a>7.3.5 Series中的缺失值</h4> 
<p>在 Pandas 中, 对于缺失值, 默认会以 NaN 这个 pandas 专属的标志来表示. 但它并不是一个 数字, 或字符串 或 None, 因此, 是 不能和空字符串 “” 来比较的.<br> pandas 中, 只能用 pd.isnull(), … 等几个相关的方法来判断 ‘空值’ NaN</p> 
<pre><code class="prism language-python">arr <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">)</span>
t <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0      1
1      a
2      3
3    nan
dtype: object
'''</span>

t<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    False
1    False
2    False
3    False
dtype: bool
'''</span>
</code></pre> 
<p>object类型数据的数组 isnull都会被判断为false, 改成float64也会被判断为false.只能重新赋值t[3] = np.nan</p> 
<h4><a id="736_Series_2665"></a>7.3.6 Series中的删除与添加操作</h4> 
<p>不会删除原有数据</p> 
<pre><code class="prism language-python">t<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
t<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
2    3.0
dtype: float64
'''</span>
t
<span class="token triple-quoted-string string">'''
0    1.0
1    2.0
2    3.0
3    NaN
dtype: float64
'''</span>
</code></pre> 
<p>如果我们想删除原有的数据加入inplace = True即可(本地)</p> 
<pre><code class="prism language-python">t<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    1.0
1    2.0
2    3.0
dtype: float64
'''</span>
</code></pre> 
<h4><a id="737_Seriesname_2694"></a>7.3.7 Series中的name属性</h4> 
<p>name与index.name 分别为数值列和索引列的名称</p> 
<pre><code class="prism language-python">t<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'salary'</span>
t<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'num'</span>
<span class="token triple-quoted-string string">'''
num
0    1.0
1    2.0
2    3.0
Name: salary, dtype: float64
'''</span>
</code></pre> 
<h3><a id="74_DataFrame_2707"></a>7.4 DataFrame类型数据</h3> 
<p>如果我们把Series看作Excel表中的一列, 那么DataFrame就是Excel中的一张表.从数据结构的角度看,Series好比一个带标签的一维数组,而DataFrame就是一个带标签的二维数组,它可以由若干一维数组(Series)构成.</p> 
<h4><a id="741_DataFrame_2709"></a>7.4.1 构建DataFrame</h4> 
<p>DataFrame不仅有行索引还有列索引.</p> 
<ul><li>构建DataFrame最常用的方法是构建一个字典,<br> 再将字典作为DataFrame的参数.<br> 字典的key是DataFrame的列名称,字典的value是一个列表.列表的长度就是行数.</li></ul> 
<pre><code class="prism language-python">df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'alpha'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	alpha
0	a
1	b
2	c
'''</span>
</code></pre> 
<p>每个key都作为一列</p> 
<pre><code class="prism language-python">dict2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'address'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'saddsa'</span><span class="token punctuation">,</span><span class="token string">'aswww'</span><span class="token punctuation">,</span><span class="token string">'xccc'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dict2<span class="token punctuation">)</span>
df2
<span class="token triple-quoted-string string">'''
	name	age	address
0	a	12	saddsa
1	b	54	aswww
2	c	22	xccc
'''</span>
</code></pre> 
<ul><li>利用二维数组构建DataFrame<br> 此时DataFrame的行和列都是自然数序列</li></ul> 
<pre><code class="prism language-python">data1 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
df3
<span class="token triple-quoted-string string">'''
	0	1	2
0	0	1	2
1	3	4	5
2	6	7	8
'''</span>
</code></pre> 
<p>显示指定列名和index行名</p> 
<pre><code class="prism language-python">df4 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data1<span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df4
<span class="token triple-quoted-string string">'''
	one	two	three
a	0	1	2
b	3	4	5
c	6	7	8
'''</span>
</code></pre> 
<p>读取index和columns行名和列名</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>index

Out<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span>Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span>df4<span class="token punctuation">.</span>columns

Out<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span>Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>利用Series构建</li></ul> 
<pre><code class="prism language-python">row1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
row2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'j'</span><span class="token punctuation">,</span><span class="token string">'q'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
row1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'series1'</span>
row2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'series2'</span>
df5 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span>row1<span class="token punctuation">,</span> row2<span class="token punctuation">]</span><span class="token punctuation">)</span>
df5
<span class="token triple-quoted-string string">'''
	a	b	c	j	q	k
series1	0.0	1.0	2.0	NaN	NaN	NaN
series2	NaN	NaN	NaN	3.0	4.0	5.0
'''</span>
</code></pre> 
<p>series的index(行)变成了DataFrame的列索引.数据缺失的地方用NaN代替了.</p> 
<p>我们可以对DataFrame进行转置</p> 
<pre><code class="prism language-python">df5<span class="token punctuation">.</span>T
<span class="token triple-quoted-string string">'''
series1	series2
a	0.0	NaN
b	1.0	NaN
c	2.0	NaN
j	NaN	3.0
q	NaN	4.0
k	NaN	5.0
'''</span>
</code></pre> 
<h4><a id="742_DataFrame_2802"></a>7.4.2 访问DataFrame中的列与行</h4> 
<p>常见访问方法<br> [ ]默认访问列<br> loc[ ]默认行<br> loc[: , ]逗号后面访问列<br> 常用参数<br> index = 0 指定行<br> columns = 0 指定列<br> axis = 0 轴方向 默认行<br> inplace = False 是否本地操作<br> axis = ‘columns’ 或 axis = 1 列<br> axis = ‘index’ 或 axis = 0 行<br> ignore_index = False 默认忽略行索引</p> 
<h5><a id="7421__2816"></a>7.4.2.1 访问列</h5> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">''' df4
	one	two	three
a	0	1	2
b	3	4	5
c	6	7	8
'''</span>
df4<span class="token punctuation">.</span>columns
<span class="token comment"># Index(['one', 'two', 'three'], dtype='object')</span>
df4<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>values
<span class="token comment"># array(['one', 'two', 'three'], dtype=object)</span>
</code></pre> 
<p>df4.columns返回的是index对象, df4.columns.values返回的是array对象.我们就可以访问数组下标了.</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment"># 'one'</span>
</code></pre> 
<p>如果我们已经知道DataFrame的列名,就可以以它作为索引读取对应的列.</p> 
<pre><code class="prism language-python">  
df4<span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
a    1
b    4
c    7
Name: two, dtype: int32
'''</span>
</code></pre> 
<p>DataFrame可以将列名作为DataFrame对象的属性来访问数据.</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>three
<span class="token triple-quoted-string string">'''
a    2
b    5
c    8
Name: three, dtype: int32
'''</span>
</code></pre> 
<p>但要注意 如果列名的字符串包含空格,或者名称不符合规范,那么就不能通过访问对象属性的方式来访问某个特定的列.</p> 
<p>如果想要访问多个列, 还是得将列名打包到列表里,</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two
a	0	1
b	3	4
c	6	7
'''</span>
</code></pre> 
<h5><a id="7422__2870"></a>7.4.2.2 访问行</h5> 
<p>切片技术依据数字索引</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two	three
a	0	1	2
'''</span>
<span class="token comment"># df4[0]会报错</span>
</code></pre> 
<h5><a id="7423_lociloc_2881"></a>7.4.2.3 loc[]和iloc[]</h5> 
<p>loc[ ] 值索引访问<br> 使用类似[ ]切片访问, 但是左闭右闭<br> 访问索引为’a’的行</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
one      0
two      1
three    2
Name: a, dtype: int32
'''</span>
</code></pre> 
<p>访问两行数据</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two	three
a	0	1	2
b	3	4	5
'''</span>
</code></pre> 
<p>切片访问两行</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two	three
b	3	4	5
c	6	7	8
'''</span>
</code></pre> 
<p>访问行列</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'one'</span><span class="token punctuation">:</span><span class="token string">'two'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two
b	3	4
c	6	7
'''</span>
</code></pre> 
<p>iloc[ ] 按照数字索引访问</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two
b	3	4
c	6	7
'''</span>
</code></pre> 
<p>访问第1行</p> 
<pre><code class="prism language-python">df4<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
one      3
two      4
three    5
Name: b, dtype: int32
'''</span>
</code></pre> 
<h4><a id="743_DataFrame_2941"></a>7.4.3 DataFrame中的删除操作</h4> 
<p>和Series类似的drop()方法<br> index = 0 指定行<br> columns = 0 指定列<br> axis = 0 轴方向 默认行<br> inplace = False 是否本地操作<br> axis = ‘columns’ 或 axis = 1 删除列<br> axis = ‘index’ 或 axis = 0 删除行<br> 注意仅返回视图</p> 
<pre><code class="prism language-python">df5 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'int64'</span><span class="token punctuation">)</span>

c3 <span class="token operator">=</span> df5<span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">]</span>
r3 <span class="token operator">=</span> df5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token comment"># (pandas.core.series.Series, pandas.core.frame.DataFrame)</span>

df5<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'three'</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	one	two
0	1	2
1	4	5
2	7	8
'''</span>
<span class="token comment"># df5.drop('three',axis = 1)</span>

df5<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token string">'index'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	one	two
1	4	5
2	7	8
'''</span>
df5<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'two'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	three
2	9
'''</span>
</code></pre> 
<p>全局内置函数del 本地删除</p> 
<pre><code class="prism language-python"><span class="token keyword">del</span> df5<span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	one	two
0	1	2
1	4	5
2	7	8
'''</span>
</code></pre> 
<h4><a id="744_DataFrame_2990"></a>7.4.4 DataFrame中的轴方向</h4> 
<p>axis = 1表示水平方向 (跨越不同的列columns, 列操作)<br> axis = 0表示垂直方向 (跨越不同的行index, 行操作)<br> 类似numpy中的hstack等同于 column_stack</p> 
<pre><code class="prism language-python">dff <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'ABCD'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	A	B	C	D
0	4	2	9	7
1	1	7	5	2
2	6	10	6	9
'''</span>
dff<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0     9
1     7
2    10
dtype: int32
'''</span>
dff<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token string">'index'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
A     6
B    10
C     9
D     9
dtype: int32
'''</span>
</code></pre> 
<h4><a id="745_DataFrame_3019"></a>7.4.5 DataFrame中的添加操作</h4> 
<h5><a id="7451_3020"></a>7.4.5.1添加行</h5> 
<p>为一个原来没有的行索引赋值,实际上就是添加新行.</p> 
<pre><code class="prism language-python">df6 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'属性1'</span><span class="token punctuation">,</span><span class="token string">'属性2'</span><span class="token punctuation">,</span><span class="token string">'属性3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    df6<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'name'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 添加行 必须将字符串转换为列表 加方括号或者list函数均可</span>
<span class="token triple-quoted-string string">'''
	属性1	属性2	属性3
0	name0	2	6
1	name1	0	1
2	name2	1	4
3	name3	3	1
4	name4	8	8
'''</span>
df6<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'new_row'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'www'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	属性1	属性2	属性3
0	name0	2	6
1	name1	0	1
2	name2	1	4
3	name3	3	1
4	name4	8	8
new_row	www	12	44
'''</span>
</code></pre> 
<p>添加多行数据</p> 
<pre><code class="prism language-python">pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df6<span class="token punctuation">,</span>df5<span class="token punctuation">]</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	one	two	three
0	name0	2	6.0
1	name1	0	1.0
2	name2	1	4.0
3	name3	3	1.0
4	name4	8	8.0
5	www	12	44.0
6	1	2	NaN
7	4	5	NaN
8	7	8	NaN
'''</span>
</code></pre> 
<h5><a id="7452_3063"></a>7.4.5.2添加列</h5> 
<pre><code class="prism language-python">df5<span class="token punctuation">[</span><span class="token string">'three2'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>
<span class="token triple-quoted-string string">'''
	one	two	three2
0	1	2	3
1	4	5	3
2	7	8	3
'''</span>
df5<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>size <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
one	two	three2	four
0	1	2	3	2
1	4	5	3	5
2	7	8	3	8
'''</span>
pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df6<span class="token punctuation">,</span>df5<span class="token punctuation">]</span><span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token string">'columns'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	one	two	three	one	two	three2	four
0	name0	2	6	1.0	2.0	3.0	2.0
1	name1	0	1	4.0	5.0	3.0	5.0
2	name2	1	4	7.0	8.0	3.0	8.0
3	name3	3	1	NaN	NaN	NaN	NaN
4	name4	8	8	NaN	NaN	NaN	NaN
new_row	www	12	44	NaN	NaN	NaN	NaN
'''</span>
<span class="token comment"># 也可以采用ignore_index = True 忽略列索引,重新赋值</span>
</code></pre> 
<h3><a id="75_Pandas_3092"></a>7.5 基于Pandas的文件读取与分析</h3> 
<p>Pandas支持多种文件的读写</p> 
<table><thead><tr><th>文件类型</th><th>读取函数</th><th>写入函数</th></tr></thead><tbody><tr><td>csv</td><td>read_csv</td><td>to_csv</td></tr><tr><td>sql</td><td>read_sql</td><td>to_sql</td></tr></tbody></table> 
<h4><a id="751_Pandas_3098"></a>7.5.1 利用Pandas读取文件</h4> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap07-pandas\Salaries.csv'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
rank	discipline	phd	service	sex	salary
0	Prof	B	56	49	Male	186960
1	Prof	A	12	6	Male	93000
2	Prof	A	23	20	Male	110515
3	Prof	A	40	31	Male	131205
4	Prof	B	20	18	Male	104800
...	...	...	...	...	...	...
73	Prof	B	18	10	Female	105450
74	AssocProf	B	19	6	Female	104542
75	Prof	B	17	17	Female	124312
76	Prof	A	28	14	Female	109954
77	Prof	A	23	15	Female	109646
'''</span>
</code></pre> 
<p>read_csv方法的其他参数<br> sep = ‘,’ 默认逗号分割<br> index_col 指定某个列(比如ID,日期)作为行索引. 如果这个参数被设置为包含多个列的列表, 则表示设定多个行索引. 如果不设置则默认自然数0~n-1索引<br> delimiter 定界符(如果指定该参数,前面的sep失效)支持使用正则表达式来匹配某些不标准的csv文件.delimiter可视为sep的别名<br> converters 用一个字典数据类型指名将某些列转换为指定数据类型.在字典中,key用于指定特定的列, value用于指定特定的数据类型.<br> parse_dates 指定是否对某些列的字符串启用日期解析.如果字符串被原样加载,该列的数据类型就是object. 如果设置为True, 则这一列的字符串会被解析为日期类型.<br> header:指定行数作为列名 header = None 就是用自然数序列作为列名。这样就可以不把第一行数作为列名了。</p> 
<h4><a id="752_DataFrame_3123"></a>7.5.2 DataFrame中的常用属性</h4> 
<ul><li>df.dtypes<br> 注:一列是Series要用dtype属性</li></ul> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>dtypes
<span class="token triple-quoted-string string">'''
rank          object
discipline    object
phd            int64
service        int64
sex           object
salary         int64
dtype: object
'''</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dtypes
<span class="token triple-quoted-string string">'''
salary     int64
sex       object
dtype: object
'''</span>
</code></pre> 
<blockquote> 
 <p>在pandas ,object本质是字符串</p> 
</blockquote> 
<pre><code class="prism language-python">In <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

df<span class="token punctuation">.</span>columns <span class="token comment"># 查看DataFrame对象中各个列的名称</span>

Out<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span> <span class="token string">'discipline'</span><span class="token punctuation">,</span> <span class="token string">'phd'</span><span class="token punctuation">,</span> <span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'sex'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

df<span class="token punctuation">.</span>axes <span class="token comment"># 返回行标签和列标签</span>

Out<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

<span class="token punctuation">[</span>RangeIndex<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token number">78</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span> <span class="token string">'discipline'</span><span class="token punctuation">,</span> <span class="token string">'phd'</span><span class="token punctuation">,</span> <span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'sex'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

In <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

df<span class="token punctuation">.</span>ndim <span class="token comment"># 返回维度数</span>

Out<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

<span class="token number">2</span>

In <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

df<span class="token punctuation">.</span>shape <span class="token comment"># 返回维度信息</span>

Out<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

<span class="token punctuation">(</span><span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

df<span class="token punctuation">.</span>size <span class="token comment"># 返回DataFrame元素个数</span>

Out<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

<span class="token number">468</span>

In <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

df<span class="token punctuation">.</span>values <span class="token comment"># 返回数值部分, 类似于一个没有行标签和列标签的numpy数组</span>

Out<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">:</span>

array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">186960</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">93000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">110515</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">131205</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">104800</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">122400</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">81285</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">126300</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">94350</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">57800</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">128250</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">134778</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">88000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">162200</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">153750</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">150480</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">75044</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">92000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">107300</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">150500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">92000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">103106</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">73000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">85000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">91100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">99418</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">148750</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">155865</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">91300</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">123683</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">107008</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">155750</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">103275</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">120000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">119800</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">126933</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">146856</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">102000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Male'</span><span class="token punctuation">,</span> <span class="token number">91000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">129000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">137000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">74830</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">80225</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">77000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">151768</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">140096</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">74692</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">103613</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">111512</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">122960</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">97032</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">127512</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">105000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">73500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">62884</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">72500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">77500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">72500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">144651</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">103994</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">92000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">103750</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">109650</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">91000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">73300</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">117555</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">63100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">90450</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">77500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">116450</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AsstProf'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">78500</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">71065</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">161101</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">105450</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'AssocProf'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">104542</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">124312</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">109954</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token punctuation">[</span><span class="token string">'Prof'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">'Female'</span><span class="token punctuation">,</span> <span class="token number">109646</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">object</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="753_DataFrame_3275"></a>7.5.3 DataFrame中的常用方法</h4> 
<p>head([n])返回前n行记录 默认为5<br> tail([n])返回后n行记录<br> describe(), max(), min(), mean(), median(), std()标准差<br> sample([n])随机抽n个样本, dropna() 将数据集合中所有含有缺失值的记录删除<br> value_counts() 查看某列中有多少个不同类别, 并可计算出每个不同类别在该列中有多少次重复出现, 实际上就是分类计数. ascending = True表示按升序排序. normalize = True可以看占比而非计数.<br> groupby()按给定条件进行分组</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>sex<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
Male      39
Female    39
Name: sex, dtype: int64
'''</span>
df<span class="token punctuation">.</span>discipline<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> normalize <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
A    0.461538
B    0.538462
Name: discipline, dtype: float64
'''</span>
</code></pre> 
<h4><a id="754_DataFrame_3296"></a>7.5.4 DataFrame的条件过滤</h4> 
<p>利用布尔索引获取DataFrame的子集.</p> 
<pre><code class="prism language-python"><span class="token comment"># df[df.salary &gt;= 130000][df.sex == 'Female']</span>
<span class="token comment"># UserWarning: Boolean Series key will be reindexed to match DataFrame index.</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>salary <span class="token operator">&gt;=</span> <span class="token number">130000</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">'Female'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
	rank	discipline	phd	service	sex	salary
40	Prof	A	39	36	Female	137000
44	Prof	B	23	19	Female	151768
45	Prof	B	25	25	Female	140096
58	Prof	B	36	26	Female	144651
72	Prof	B	24	15	Female	161101
'''</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>salary <span class="token operator">&gt;=</span> <span class="token number">130000</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">'Female'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>salary<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 在DataFrame必须用&amp; 不能用and</span>
<span class="token comment"># and可能会报错</span>
<span class="token comment"># 146923.2</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">100000</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'discipline'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 77500.0</span>
</code></pre> 
<h4><a id="755_DataFrame_3319"></a>7.5.5 DataFrame的切片操作</h4> 
<p>DataFrame的切片操作和numpy的切片操作类型<br> 之前的访问行和列就是一种切片.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span>
<span class="token triple-quoted-string string">'''
rank	discipline	phd	service	sex	salary
5	Prof	A	20	20	Male	122400
6	AssocProf	A	20	17	Male	81285
7	Prof	A	18	18	Male	126300
8	Prof	A	29	19	Male	94350
9	Prof	A	51	51	Male	57800
10	Prof	B	39	33	Male	128250
11	Prof	B	23	23	Male	134778
12	AsstProf	B	1	0	Male	88000
13	Prof	B	35	33	Male	162200
14	Prof	B	25	19	Male	153750
'''</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># df[5:15]['discipline':'sex']</span>
<span class="token comment"># 报错cannot do slice indexing on RangeIndex with these indexers [discipline] of type str</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">'discipline'</span><span class="token punctuation">:</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token comment"># loc读取特定行和列的交叉左闭右闭</span>
<span class="token comment"># loc可以这样写</span>
<span class="token triple-quoted-string string">'''
	discipline	phd	service	sex
5	A	20	20	Male
6	A	20	17	Male
7	A	18	18	Male
8	A	29	19	Male
9	A	51	51	Male
10	B	39	33	Male
11	B	23	23	Male
12	B	1	0	Male
13	B	35	33	Male
14	B	25	19	Male
15	B	17	3	Male
'''</span>
df<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'discipline'</span><span class="token punctuation">,</span><span class="token string">'phd'</span><span class="token punctuation">,</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># 切片左闭右开</span>
<span class="token triple-quoted-string string">'''
	discipline	phd	service	sex
5	A	20	20	Male
6	A	20	17	Male
7	A	18	18	Male
8	A	29	19	Male
9	A	51	51	Male
10	B	39	33	Male
11	B	23	23	Male
12	B	1	0	Male
13	B	35	33	Male
14	B	25	19	Male
'''</span>
</code></pre> 
<h4><a id="756_DataFrame_3374"></a>7.5.6 DataFrame的排序操作</h4> 
<ul><li>df.sort_values()<br> by 指定按什么排序<br> ascending = True 默认升序</li></ul> 
<pre><code class="prism language-python">df_sorted <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by <span class="token operator">=</span> <span class="token string">'salary'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
rank	discipline	phd	service	sex	salary
9	Prof	A	51	51	Male	57800
54	AssocProf	A	25	22	Female	62884
66	AsstProf	A	7	6	Female	63100
71	AssocProf	B	12	9	Female	71065
57	AsstProf	A	3	1	Female	72500
'''</span>
</code></pre> 
<p>按service升序 salary降序</p> 
<pre><code class="prism language-python">df_sorted <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df_sorted<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
rank	discipline	phd	service	sex	salary
52	Prof	A	12	0	Female	105000
17	AsstProf	B	4	0	Male	92000
12	AsstProf	B	1	0	Male	88000
23	AsstProf	A	2	0	Male	85000
43	AsstProf	B	5	0	Female	77000
55	AsstProf	A	2	0	Female	72500
57	AsstProf	A	3	1	Female	72500
28	AsstProf	B	7	2	Male	91300
42	AsstProf	B	4	2	Female	80225
68	AsstProf	A	4	2	Female	77500
'''</span>
</code></pre> 
<h4><a id="757_Pandas_3407"></a>7.5.7 Pandas的聚合和分组运算</h4> 
<h5><a id="7571__3408"></a>7.5.7.1 聚合</h5> 
<p>在pandas中聚合更侧重于描述将多个数据按照某种规则(即特定函数)聚合在一起, 变成一个标量的数据转换过程. 它与张量的约减(规约, reduce)有相通之处.</p> 
<ul><li>agg()方法实现聚合操作,如果函数名是官方提供的则以字符串的形式给出,如果来自第三方(如numpy)或自己定义的,则直接给出函数的名称(不得用引号括起来).</li></ul> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'max'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>median<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
max       186960.000000
amin       57800.000000
mean      108023.782051
median    104671.000000
Name: salary, dtype: float64
'''</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'max'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>median<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
salary
max	186960.000000
amin	57800.000000
mean	108023.782051
median	104671.000000
'''</span>
</code></pre> 
<p>其他统计函数</p> 
<ul><li>mode()众数</li><li>skew() 偏度</li><li>kurt() 峰度</li></ul> 
<p>偏度和峰度用于检测数据集是否满足正态分布<br> 偏度的衡量是相对于正态分布来说的, 正态分布的偏度为0.若带分析的数据分布是对称的, 那么偏度接近于0, 若偏度大于0, 则说明数据分布右偏, 即分布有一条长尾在右. 若偏度小于0, 则数据分布左偏.<br> 峰度是体现数据分布陡峭或平坦的统计量.正态分布的峰度为0.若峰度大于0.表示该数据分布与正态分布相比较为陡峭, 有尖顶峰. 若峰度小于0, 表示该数据分布与正态分布相比较为平坦, 曲线有平顶峰.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'skew'</span><span class="token punctuation">,</span><span class="token string">'kurt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
		service	    salary
skew	0.913750	0.452103
kurt	0.608981	-0.401713
'''</span>
</code></pre> 
<p>agg可以针对不同的列给出不同的统计, 这时, agg()方法内的参数是一个字典对象.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'salary'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'max'</span><span class="token punctuation">,</span><span class="token string">'min'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'service'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span><span class="token string">'std'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	salary	service
max	186960.0	NaN
min	57800.0	    NaN
mean	NaN	15.051282
std	    NaN	12.139768
'''</span>
</code></pre> 
<h5><a id="7572__3456"></a>7.5.7.2 分组</h5> 
<ul><li>groupby()<br> 生成DataFrameGroupBy对象, 要想让其发挥作用, 还需要将特定方法应用在这个对象上, 这些方法包括但不限于 mean(), count(), median()等</li></ul> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	phd	service	salary
rank			
AssocProf	196	147	1193221
AsstProf	96	42	1545893
Prof	1245	985	5686741
'''</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回按rank分组的描述</span>
</code></pre> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 单层方括号是Series</span>
<span class="token triple-quoted-string string">'''
rank
AssocProf     91786.230769
AsstProf      81362.789474
Prof         123624.804348
Name: salary, dtype: float64
'''</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 双层方括号括起来是DataFrame</span>
<span class="token triple-quoted-string string">'''
	salary
rank	
AssocProf	91786.230769
AsstProf	81362.789474
Prof	123624.804348
'''</span>
</code></pre> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span> <span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'sum'</span><span class="token punctuation">,</span><span class="token string">'mean'</span><span class="token punctuation">,</span><span class="token string">'skew'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	service	salary
sum	mean	skew	sum	mean	skew
rank						
AssocProf	147	11.307692	1.462083	1193221	91786.230769	-0.151200
AsstProf	42	2.210526	0.335521	1545893	81362.789474	0.030504
Prof	985	21.413043	0.759933	5686741	123624.804348	0.070309
'''</span>
</code></pre> 
<p>犯的错误和测试</p> 
<pre><code class="prism language-python"><span class="token comment"># type(df.groupby('rank'))</span>
<span class="token comment"># pandas.core.groupby.generic.DataFrameGroupBy</span>

<span class="token comment"># type(df.groupby('rank').agg('mean'))</span>
<span class="token comment"># pandas.core.frame.DataFrame</span>

<span class="token comment"># type(df.groupby('rank').agg(['mean','sum']))</span>
<span class="token comment"># FutureWarning: ['discipline', 'sex'] did not aggregate successfully. If any error is raised this will raise in a future version of pandas. Drop these columns/ops to avoid this warning.</span>

<span class="token comment"># type(df.groupby('rank')['sex'])</span>
<span class="token comment"># pandas.core.groupby.generic.SeriesGroupBy</span>

<span class="token comment"># type(df.groupby('rank')[['sex','salary']])</span>
<span class="token comment"># pandas.core.groupby.generic.DataFrameGroupBy</span>

<span class="token comment"># df.groupby('rank')[['service','salary']].agg(['mean','kurt'])</span>
<span class="token comment"># 如果要用统计方法mean,max等,要确保选取的列都是数值型的</span>
<span class="token comment"># 因为每一列都是一个series 而series没有kurt方法</span>

df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
			service	salary
			mean	mean
rank		
AssocProf	11.307692	91786.230769
AsstProf	2.210526	81362.789474
	Prof	21.413043	123624.804348
'''</span>
<span class="token comment"># 不一样 虽然我也说不出来为什么</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'skew'</span><span class="token punctuation">,</span><span class="token string">'kurt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
		service	    salary
skew	0.913750	0.452103
kurt	0.608981	-0.401713
'''</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>kurt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 这样可以</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>kurt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 这会报错</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'rank'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'service'</span><span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 这样也可以</span>
</code></pre> 
<h4><a id="758__DataFrame_3544"></a>7.5.8 DataFrame的透视表</h4> 
<p>透视表(pivot table)是一种常见的数据汇总工具, 可以根据一个键或多个键对数据进行聚合, 并根据行和列上的分组键将数据分配到不同的矩形区域中. 之所以称为透视表, 是因为我们可以动态地改变数据的位置分布, 以便按照不同方式分析数据, 它也支持重新安排行号, 列标和字段.<br> pd.pivot_table() pandas的全局函数<br> data 数据源<br> values 用于聚合操作的列<br> index 行层次的分组依据 一个值或多个值<br> columns 列层次的分组依据<br> aggfunc 对数据执行聚合操作时所用的函数, 默认 aggfunc = ‘mean’<br> <strong>注</strong>: 对象df本身就有成员方法, df.pivot_table(index = ‘rank’)<br> 把职称作为index而非自然数序列</p> 
<pre><code class="prism language-python">pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token string">'rank'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
				phd	salary	service
	rank			
AssocProf	15.076923	91786.230769	11.307692
AsstProf	5.052632	81362.789474	2.210526
	Prof	27.065217	123624.804348	21.413043
'''</span>
</code></pre> 
<p>看看不同职称男女教师的薪资差异, 设置二级index来完成数据透视.<br> index就是数据划分的层次字段(key)</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
							phd	salary	service
	rank	sex			
AssocProf	Female	15.500000	88512.800000	11.500000
			Male	13.666667	102697.666667	10.666667
AsstProf	Female	5.636364	78049.909091	2.545455
			Male	4.250000	85918.000000	1.750000
	Prof	Female	23.722222	121967.611111	17.111111
			Male	29.214286	124690.142857	24.178571
'''</span>
</code></pre> 
<p>将行列实施转置</p> 
<ul><li>df.unstack()将行转为列</li><li>df.stack()将列转为行<br> 如果不指定索引级别,stack()和unstack()默认对最内层进行操作(即level = -1, 这里的 -1表示倒数第一层).<br> stack()和unstack()为一组逆运算操作.<br> 将内层索引sex转置为列</li></ul> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
			phd	salary	service
sex	Female	Male	Female	Male	Female	Male
rank						
AssocProf	15.500000	13.666667	88512.800000	102697.666667	11.500000	10.666667
AsstProf	5.636364	4.250000	78049.909091	85918.000000	2.545455	1.750000
	Prof	23.722222	29.214286	121967.611111	124690.142857	17.111111	24.178571
'''</span>
</code></pre> 
<p>values用来指定特定字段,从而筛选列.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token string">'salary'</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
			salary
rank	sex	
AssocProf	Female	88512.800000
			Male	102697.666667
AsstProf	Female	78049.909091
			Male	85918.000000
	Prof	Female	121967.611111
			Male	124690.142857
'''</span>
</code></pre> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">,</span> <span class="token string">'service'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc <span class="token operator">=</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
			sum	            mean
			salary	service	salary	service
rank	sex				
AssocProf	Female	885128	115	88512.800000	11.500000
			Male	308093	32	102697.666667	10.666667
AsstProf	Female	858549	28	78049.909091	2.545455
			Male	687344	14	85918.000000	1.750000
	Prof	Female	2195417	308	121967.611111	17.111111
			Male	3491324	677	124690.142857	24.178571
'''</span>
</code></pre> 
<p>透视表和groupby在很多方面的功能都是等价的.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">,</span><span class="token string">'service'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'sum'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 上面写法和此句几乎完全等价</span>
<span class="token triple-quoted-string string">'''略有不同
					salary	service
				sum	mean	sum	mean
rank	sex				
AssocProf	Female	885128	88512.800000	115	11.500000
			Male	308093	102697.666667	32	10.666667
AsstProf	Female	858549	78049.909091	28	2.545455
			Male	687344	85918.000000	14	1.750000
	Prof	Female	2195417	121967.611111	308	17.111111
			Male	3491324	124690.142857	677	24.178571
'''</span>
</code></pre> 
<h4><a id="759_DataFrameSQL_3645"></a>7.5.9 DataFrame的类SQL操作</h4> 
<p>query(查询字符串)方法实现 对行操作, 注意要加引号, 而且查询的是字符串还要加不同的引号.包括单引号,双引号,三单引号,三双引号.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'rank'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Prof'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 等价于</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"rank == 'Prof'"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># df.query('''rank == "Prof"''').head(10)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'phd == 5'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'rank == "Prof" and discipline == "A" and sex == "Male" '</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用外部定义的变量 @必不可少</p> 
<pre><code class="prism language-python">dis <span class="token operator">=</span> <span class="token string">'B'</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">"discipline == @dis "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="7510_3662"></a>7.5.10</h4> 
<p>缺失值检测isnull 和notnull<br> 缺失值填充fillna(x) 默认填充0 <mark>na表示缺失值</mark><br> 缺失值丢弃dropna() 丢弃含空值的行列.<br> 函数形式：dropna(axis=0, how=‘any’, thresh=None, subset=None, inplace=False)<br> 参数：<br> axis：轴。0或’index’，表示按行删除；1或’columns’，表示按列删除。<br> how：筛选方式。‘any’，表示该行/列只要有一个以上的空值，就删除该行/列；‘all’，表示该行/列全部都为空值，就删除该行/列。<br> thresh：非空元素最低数量。int型，默认为None。如果该行/列中，非空元素数量小于这个值，就删除该行/列。<br> subset：子集。列表，元素为行或者列的索引。如果axis=0或者‘index’，subset中元素为列的索引；如果axis=1或者‘column’，subset中元素为行的索引。由subset限制的子区域，是判断是否删除该行/列的条件判断区域。<br> inplace：是否原地替换。布尔值，默认为False。如果为True，则在原DataFrame上进行操作，返回值为None。</p> 
<pre><code class="prism language-python">a <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>nan
 
d <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data <span class="token operator">=</span> a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
    0    1    2    3    4    5    6    7    8    9
0   1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0
1   NaN  1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0
2   NaN  NaN  1.0  1.0  1.0  1.0  1.0  1.0  1.0  1.0
3   NaN  NaN  NaN  1.0  1.0  1.0  1.0  1.0  1.0  1.0
4   NaN  NaN  NaN  NaN  1.0  1.0  1.0  1.0  1.0  1.0
5   NaN  NaN  NaN  NaN  NaN  1.0  1.0  1.0  1.0  1.0
6   NaN  NaN  NaN  NaN  NaN  NaN  1.0  1.0  1.0  1.0
7   NaN  NaN  NaN  NaN  NaN  NaN  NaN  1.0  1.0  1.0
8   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  1.0  1.0
9   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  1.0
10  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN 
'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis <span class="token operator">=</span> <span class="token string">'columns'</span><span class="token punctuation">,</span> thresh<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	  4    5    6    7    8    9
0   1.0  1.0  1.0  1.0  1.0  1.0
1   1.0  1.0  1.0  1.0  1.0  1.0
2   1.0  1.0  1.0  1.0  1.0  1.0
3   1.0  1.0  1.0  1.0  1.0  1.0
4   1.0  1.0  1.0  1.0  1.0  1.0
5   NaN  1.0  1.0  1.0  1.0  1.0
6   NaN  NaN  1.0  1.0  1.0  1.0
7   NaN  NaN  NaN  1.0  1.0  1.0
8   NaN  NaN  NaN  NaN  1.0  1.0
9   NaN  NaN  NaN  NaN  NaN  1.0
10  NaN  NaN  NaN  NaN  NaN  NaN
'''</span>
</code></pre> 
<h3><a id="76__3710"></a>7.6 泰坦尼克幸存者数据预处理</h3> 
<h4><a id="762__3711"></a>7.6.2 数据集的拼接</h4> 
<p>训练集 train.csv 测试集 test.csv</p> 
<pre><code class="prism language-python">train_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./titanic/train.csv'</span><span class="token punctuation">)</span>
train_df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
train_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./titanic/test.csv'</span><span class="token punctuation">)</span>
full_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>train_df<span class="token punctuation">,</span> test_df<span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> sort<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p>concat 参数join默认外连接(没有为NaN), 内连接是只取交集<br> axis = 0 默认垂直方向合并<br> 测试集没有Survived(因为这是留给训练好的模型来预测的)这一列, 所以会被设置为NaN. 之后可以依据此进行分割.</p> 
<h4><a id="763__3725"></a>7.6.3 缺失值的处理</h4> 
<p>fillna()<br> value填充值, 默认为None.<br> method 填充策略 ‘backfill’或’bfill’ 则表示在填充时会按照指定的轴方向, 向回找到上一个合法有效的值,然后填充之. 如果为’ffill’或’pad’ 则表示按照指定的轴方向,向前找到一个有效值来填充.<br> axis 轴方向 inplace 本地</p> 
<p>full_df[‘Embarked’]返回一个Series对象, 我们这里mode()求众数,由于众数有可能有多个,因此采用mode()[0]获取列表第一个元素.<br> 对于Age列采用平均值填充, 怎么填充取决于你对数据处理的偏好, 并无好坏之分.</p> 
<pre><code class="prism language-python">full_df<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 2</span>
full_df<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>full_df<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
full_df<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 0</span>
full_df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 263</span>
full_df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>full_df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
full_df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 0</span>
</code></pre> 
<pre><code class="prism language-python">full_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
PassengerId       0
Survived        418
Pclass            0
Name              0
Sex               0
Age               0
SibSp             0
Parch             0
Ticket            0
Fare              1
Cabin          1014
Embarked          0
dtype: int64
'''</span>
full_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 不要被误解了, count只是计数 不管是否为0</span>
<span class="token triple-quoted-string string">'''
PassengerId    1309
Survived       1309
Pclass         1309
Name           1309
Sex            1309
Age            1309
SibSp          1309
Parch          1309
Ticket         1309
Fare           1309
Cabin          1309
Embarked       1309
dtype: int64
'''</span>
</code></pre> 
<p>看看哪些字段还缺失</p> 
<pre><code class="prism language-python">percent_1 <span class="token operator">=</span> full_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> full_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token comment"># 缺失率</span>
percent_2 <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>percent_1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment"># round python内置函数 也可以用pandas 的round方法</span>
<span class="token comment"># 按降序排列</span>
<span class="token comment"># percent_2就是将percent_1 四舍五入再排序了一下 代表为空的占总个数的比例</span>
full_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
total <span class="token operator">=</span> full_df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># 代表为空的个数</span>
missing_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>total<span class="token punctuation">,</span> percent_2<span class="token punctuation">]</span><span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
                         keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Total'</span><span class="token punctuation">,</span><span class="token string">'%'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
missing_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">full_df<span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>full_df<span class="token punctuation">[</span><span class="token string">'Fare'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<p>Cabin缺失较多, 我们可以抛弃, 但是这可能是一个有用的特征, 我们要将其保留, 处理为有或没有房间号两大类, 没有房间号的用’NA’ 填充 NA表示not available</p> 
<pre><code class="prism language-python">full_df<span class="token punctuation">[</span><span class="token string">'Cabin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 1014</span>
<span class="token comment"># Cabin不能丢弃 保留 分为有房间和无房间</span>
full_df<span class="token punctuation">[</span><span class="token string">'Cabin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'NA'</span><span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
full_df<span class="token punctuation">[</span><span class="token string">'Cabin'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 0</span>
</code></pre> 
<p>将处理完后的数据分别存起来.</p> 
<pre><code class="prism language-python">train_clean <span class="token operator">=</span> full_df<span class="token punctuation">[</span>full_df<span class="token punctuation">[</span><span class="token string">'Survived'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># 利用布尔索引 仅保留Survived不为NaN的行</span>
train_clean<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'train_clean.csv'</span><span class="token punctuation">)</span>
test_clean <span class="token operator">=</span> full_df<span class="token punctuation">[</span>full_df<span class="token punctuation">[</span><span class="token string">'Survived'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># 保留为NaN的行</span>
test_clean<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'test_clean.csv'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="78__3808"></a>7.8 思考与提高</h3> 
<p>1将数据进行转置， 转置后形如eg.csv, 缺失值用NAN代替.</p> 
<pre><code class="prism language-python"><span class="token comment"># 标准写法</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">,</span> parse_dates <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> index_col <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
					KWH
CONS_NO	DATA_DATE	
1	    2015-01-01	6.68
		2015-01-02	2.50
		2015-01-03	5.20
		2015-01-04	4.17
		2015-01-05	4.89
'''</span>
<span class="token comment"># 将行索引转成列,默认最内(level = -1) 可不能转置,转置和题目要求就不一样了</span>
<span class="token comment"># 这里.KWH是因为只有KWH属性,就没必要显示了,按题目的要求.</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>KWH
<span class="token triple-quoted-string string">'''
DATA_DATE	2015-01-01	2015-01-02	2015-01-03	2015-01-04	2015-01-05	...
CONS_NO																	
1	6.68	2.50	5.20	4.17	4.89	5.26	4.11	3.70	...
2	1.22	0.65	1.14	1.04	1.33	1.02	0.08	0.09	...
3	7.35	6.65	7.76	4.02	4.68	7.06	6.51	7.00	...
4	0.62	1.92	0.65	1.30	0.71	1.36	0.89	1.24	...
5	2.58	2.60	2.36	1.83	2.05	1.97	1.98	1.44	...
'''</span>
<span class="token comment"># 缺失值用nan填充</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="8_MatplotlibSeaborn_3841"></a>8 Matplotlib与Seaborn可视化分析</h2> 
<h3><a id="81_Matplotlib_3842"></a>8.1 Matplotlib与图形绘制</h3> 
<p>matplotlib可以很轻松的分析条形图, 散点图, 饼图等专业图形. 但是不够细腻, 比较底层.<br> Seaborn绘图库 图形更加细腻,更加高大上.</p> 
<h3><a id="82__3845"></a>8.2 绘制简单图形</h3> 
<p>Pyplot是Matplotlib的子库, 很方便的让用户绘制2D图.</p> 
<p>np中的sin函数,向量进向量出 给进去一个向量x,sin(x)批量产生一个相同维度的向量y<br> plot用于绘制线图和散点图<br> 画单条线<br> plot([x], y, [fmt], *, data=None, **kwargs)<br> 画多条线<br> plot([x], y, [fmt], [x2], y2, [fmt2], …, **kwargs)</p> 
<pre><code class="prism language-python">nbSamples <span class="token operator">=</span> <span class="token number">64</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span>math<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> math<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> nbSamples<span class="token punctuation">)</span>
y1 <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
y2 <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> <span class="token string">'r+:'</span><span class="token punctuation">)</span>
</code></pre> 
<p>A format string consists of a part for color, marker and line:<br> fmt = ‘[marker][line][color]’<br> 颜色<br> 线形 - 代表实线, --短划线 -.点画线 : 电线</p> 
<pre><code class="prism language-python">color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">]</span>
linestyle<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">'--'</span><span class="token punctuation">,</span><span class="token string">'-.'</span><span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">]</span>
</code></pre> 
<p>点形</p> 
<pre><code class="prism language-python">marker<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'^'</span><span class="token punctuation">,</span><span class="token string">'&lt;'</span><span class="token punctuation">,</span><span class="token string">'&gt;'</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'p'</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">,</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'H'</span><span class="token punctuation">,</span><span class="token string">'+'</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'D'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'|'</span><span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">,</span><span class="token string">'.'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0c/7a/1eoRz5LF_o.png" alt=""></p> 
<p>其他</p> 
<pre><code class="prism language-python"><span class="token comment"># 蓝色,线宽20,圆点,点尺寸50,点填充红色,点边缘宽度6,点边缘灰色</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">,</span>linewidth<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">,</span>markersize<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>
         markerfacecolor<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span>markeredgewidth<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>markeredgecolor<span class="token operator">=</span><span class="token string">"grey"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="83_pyplot_3885"></a>8.3 pyplot的高级功能</h3> 
<h4><a id="831_3886"></a>8.3.1添加图例与注释</h4> 
<ul><li>plt.legend() 添加注释<br> 对不同的图添加图例legend, loc是位置的缩写, best表示最佳位置, 也可以设置upper right(右上) center(中)等等.<br> label是轴的标题, title是图像的标题, legend是图像的图例 两个$包裹公式, 生成latex风格的公式<br> 字符串前的r表示raw,即后面的字符串不需要转义</li></ul> 
<pre><code class="prism language-python">plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">,</span> linestyle <span class="token operator">=</span> <span class="token string">'--'</span><span class="token punctuation">,</span> linewidth <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">r'y = sin(x)'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> markersize <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> markerfacecolor <span class="token operator">=</span> <span class="token string">'r'</span><span class="token punctuation">,</span> markeredgecolor <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">r'$y = cos(x)$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token string">'best'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>显示坐标点<br> plt.text(a, b, (a, b), ha = ‘center’, va = ‘bottom’, fontsize = 10)<br> 显示文本注释<br> 前两个参数表示x轴和y轴的坐标位置, 第三个参数表示标注的文本内容, 我们在这里打算显示的是坐标点.<br> 可以调整前两个参数的位置以优化文本的位置.<br> ha, va分别是水平对齐(horizontal alignment)和垂直对齐.<br> ha可选的参数有 center, right, left,<br> va可选的参数有 center, top, bottom, baseline, center_baseline</p> 
<pre><code class="prism language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> x
<span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> ha <span class="token operator">=</span> <span class="token string">'center'</span><span class="token punctuation">,</span> va <span class="token operator">=</span> <span class="token string">'bottom'</span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'bo-'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="832_3915"></a>8.3.2设置图形标题及坐标轴</h4> 
<ul><li>rcParams rc配置或rc参数<br> 可以修改默认的属性，包括窗体大小、每英寸的点数、线条宽度、颜色、样式、坐标轴、坐标和网络属性、文本、字体等。<code>rc参数</code>存储在字典变量中，通过字典的方式进行访问。</li><li>plt.title() 设置图形标题</li><li>plt.xticks() 设置x轴刻度</li><li>plt.xlim() 设置x轴的区间范围</li><li>plt.xlabel() 设置x轴名称</li></ul> 
<pre><code class="prism language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span>
y1 <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
y2 <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># 为在matplotlib中显示中文, 设置特殊字体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> <span class="token comment"># 正常显示中文标签</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token comment"># 正常显示负号</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'双曲线'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">)</span><span class="token comment"># 比-1,1大一点就可以了</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>ticks <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">,</span>
          labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'$-\\frac{3}{2}\pi$'</span><span class="token punctuation">,</span><span class="token string">'$-\pi$'</span><span class="token punctuation">,</span><span class="token string">'$-\\frac{1}{2}\pi$'</span><span class="token punctuation">,</span>
                   <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'$\\frac{1}{2}\pi$'</span><span class="token punctuation">,</span> <span class="token string">'$\pi$'</span><span class="token punctuation">,</span><span class="token string">'$\\frac{3}{2}\pi$'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># ticks设置坐标轴的刻度,labels设置坐标轴的标签</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>ticks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#设置刻度</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'我是$x$轴'</span><span class="token punctuation">)</span><span class="token comment">#设置轴标签名</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'我是$y$轴'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span>label <span class="token operator">=</span> <span class="token string">'$y_1 = sin(x)$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y2<span class="token punctuation">,</span> <span class="token string">'b:'</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'$y_2 = cos(x)$'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token string">'best'</span><span class="token punctuation">)</span>
<span class="token comment"># plt.show()</span>
<span class="token comment"># plt.savefig('sincos.jpg',dpi = 600)</span>
<span class="token comment"># 把图片保存起来,dpi是分辨率 不是必须的</span>
</code></pre> 
<h4><a id="833__3950"></a>8.3.3 添加网格线</h4> 
<p>grid() 参数visible表示网格是否可见, which = [‘major’|‘minor’|‘both’](大网格|小网格|大网格套小网格)<br> axis = ‘x’|‘y’|‘both’ 表示在哪个轴添加网格线</p> 
<pre><code class="prism language-python">data <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token string">'r-.'</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> data<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'bs'</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> data<span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'g^'</span><span class="token punctuation">)</span>
<span class="token comment"># plt.show()</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>visible <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token string">'y'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="834__3959"></a>8.3.4 绘制多个子图</h4> 
<ul><li>plt.subplot(nrow,ncols,plot_number)</li><li>fig.add_subplot()画布添加子图</li></ul> 
<p>nrows行ncols列的第plot_number个子图<br> 例如 subplot(2,1,1)表示两行一列的第一个子图可简写为 subplot(211) （从 1 开始）</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>t<span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi <span class="token operator">*</span> t<span class="token punctuation">)</span>

t1 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.02</span><span class="token punctuation">)</span>
<span class="token comment"># 第一种绘制子图的方法</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 创建一个画布</span>
sub_fig1 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">)</span> <span class="token comment"># 在画布上创建一个子图</span>
sub_fig1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>t1<span class="token punctuation">,</span> f<span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'bo'</span><span class="token punctuation">,</span> t2<span class="token punctuation">,</span> f<span class="token punctuation">(</span>t2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">)</span>

<span class="token comment">#第二种绘制子图的方法</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>t2<span class="token punctuation">,</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token operator">*</span>t2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r--'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="835_AxesSubplot_3981"></a>8.3.5 Axes与Subplot的区别</h4> 
<p>figure画布最大.在画布里,我们可以创建各种子图, 子图主要有两类,一类是规矩排列整齐的子图,叫做Subplot,另一类是可以不那么规则摆放的子图,叫做Axes<br> 本质上,axes更加底层,事实上,subplot也是调用axes来实现的,不过是子图排列的更加规范罢了,因为subplot某种程度上是axes的特例.<br> 可能matplotlib的设计者认为,任何一个子图都要通过多个轴来呈现,所以就用Axes来表示子图,但切不可认为axes是多个轴的意思.<br> axes.set_xlabel()</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
left1<span class="token punctuation">,</span> bottom1<span class="token punctuation">,</span> width1<span class="token punctuation">,</span> height1 <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.8</span>
<span class="token comment"># 在画布上添加一个子图 必须给出子图的位置用四个点的列表确定</span>
<span class="token comment">#左下角的位置即图原点的x,y坐标和图的宽度和高度</span>
axes_1 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span>left1<span class="token punctuation">,</span> bottom1<span class="token punctuation">,</span> width1<span class="token punctuation">,</span> height1<span class="token punctuation">]</span><span class="token punctuation">)</span>
axes_1<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
axes_1<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>
axes_1<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
axes_1<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span>

left2<span class="token punctuation">,</span> bottom2<span class="token punctuation">,</span> width2<span class="token punctuation">,</span> height2 <span class="token operator">=</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.25</span>
<span class="token comment"># 添加另一个子图</span>
axes_2 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span>left2<span class="token punctuation">,</span> bottom2<span class="token punctuation">,</span> width2<span class="token punctuation">,</span> height2<span class="token punctuation">]</span><span class="token punctuation">)</span>
axes_2<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
axes_2<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'title_inside'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>fig.add_axes([left1, bottom1, width1, height1])<br> 左下角的位置即图原点的x,y坐标和图的宽度和高度<br> 这四个值都用占整个figure坐标系的百分比来表示, 即都是小于1的小数.<br> 用add_axes()方法生成子图更加灵活,完全可以实现add_subplot()方法的功能, 且更容易控制子图的显示位置, 甚至实现相互重叠的效果.</li></ul> 
<pre><code class="prism language-python">x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
left<span class="token punctuation">,</span> bottom<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span>
axes_1 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span>left<span class="token punctuation">,</span> bottom<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">]</span><span class="token punctuation">)</span>
axes_2 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span>left <span class="token operator">+</span> <span class="token number">0.1</span><span class="token punctuation">,</span> bottom <span class="token operator">+</span> <span class="token number">0.1</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">]</span><span class="token punctuation">)</span>
axes_3 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span>left<span class="token operator">+</span><span class="token number">0.2</span><span class="token punctuation">,</span> bottom<span class="token operator">+</span><span class="token number">0.2</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">]</span><span class="token punctuation">)</span>
axes_4 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span>left<span class="token operator">+</span><span class="token number">0.3</span><span class="token punctuation">,</span> bottom<span class="token operator">+</span><span class="token number">0.3</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">]</span><span class="token punctuation">)</span>
axes_4<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="84__4022"></a>8.4 散点图</h3> 
<p>scatter的参数s就是plot函数中的markersize(点尺寸),<br> c表示点的颜色 alpha 表示透明度,不超过1</p> 
<pre><code class="prism language-python"><span class="token comment"># 产生50对服从正态分布的样本点</span>
nbPointers <span class="token operator">=</span> <span class="token number">50</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>standard_normal<span class="token punctuation">(</span>nbPointers<span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>standard_normal<span class="token punctuation">(</span>nbPointers<span class="token punctuation">)</span>

<span class="token comment"># 固定种子, 以便实验结果具有可重复性</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">19680801</span><span class="token punctuation">)</span>
colors <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>nbPointers<span class="token punctuation">)</span>

area <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">30</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>nbPointers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span> s <span class="token operator">=</span> area<span class="token punctuation">,</span> c <span class="token operator">=</span> colors<span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="85__4040"></a>8.5 条形图与直方图</h3> 
<h4><a id="851__4041"></a>8.5.1 垂直条形图</h4> 
<p>bar()和barh()函数都可以用于绘制一般的条形图.<br> 但是barh只能用于绘制水平条形图.<br> plt.bar(x, height, width=0.8, bottom=None,*, align=‘center’, data=None, **kwargs)<br> x x轴的位置序列(数组,列表元组等) 例如y_pos = np.arange(len(objects))<br> height y轴的数值序列, 条形图的高度<br> width 条形图的宽度0~1 默认0.8<br> bottom 条形图的起始位置 也是y轴的起始坐标.默认值为None即以x轴作为起点. 如果为叠状条形图, 该值通常为次一级条形图的高度.<br> alpha 透明度<br> color 或 facecolor 条形图填充的颜色 取值可以为rbg#123465等,默认为b 表示蓝色<br> label 标签 ,当有多个条形图并列时, 可以区分不同条形图表示的含义<br> edgecolor 边缘颜色, linewidth 线宽,<br> tick_label 设置每个刻度处的标签相当于 plt.xticks(ticks=None, labels=None, **kwargs)</p> 
<p>位置 条形图高度 label都是对应的</p> 
<pre><code class="prism language-python">objects <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Python'</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'Java'</span><span class="token punctuation">,</span> <span class="token string">'Perl'</span><span class="token punctuation">,</span> <span class="token string">'Scala'</span><span class="token punctuation">,</span> <span class="token string">'Lisp'</span><span class="token punctuation">)</span>
y_pos <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># array([0, 1, 2, 3, 4, 5])</span>
performance <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>y_pos<span class="token punctuation">,</span> performance<span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>y_pos<span class="token punctuation">,</span> objects<span class="token punctuation">)</span>
<span class="token comment"># plt.xticks(label = objects)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'用户量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'数据分析程序语言使用分布情况'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="852__4070"></a>8.5.2 水平条形图</h4> 
<pre><code class="prism language-python">objects <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Python'</span><span class="token punctuation">,</span> <span class="token string">'C++'</span><span class="token punctuation">,</span> <span class="token string">'Java'</span><span class="token punctuation">,</span> <span class="token string">'Perl'</span><span class="token punctuation">,</span> <span class="token string">'Scala'</span><span class="token punctuation">,</span> <span class="token string">'Lisp'</span><span class="token punctuation">)</span>
y_pos <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># array([0, 1, 2, 3, 4, 5])</span>
performance <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>barh<span class="token punctuation">(</span>y_pos<span class="token punctuation">,</span> performance<span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">,</span> tick_label <span class="token operator">=</span> objects<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'用户量'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'数据分析程序语言使用分布情况'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="853__4081"></a>8.5.3 并列条形图</h4> 
<pre><code class="prism language-python"><span class="token comment">#设置字体以便支持中文</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>

<span class="token comment"># 用于绘制图形的数据</span>
n_groups <span class="token operator">=</span> <span class="token number">4</span>
means_frank <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span>
means_guido <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>

<span class="token comment"># 创建图形</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#定义条形图在横坐标上的分类位置</span>
index <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>n_groups<span class="token punctuation">)</span>

bar_width <span class="token operator">=</span> <span class="token number">0.35</span>
opacity <span class="token operator">=</span> <span class="token number">0.8</span>
<span class="token comment">#画第一个条形图</span>
rects1 <span class="token operator">=</span> plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>index<span class="token punctuation">,</span>      <span class="token comment">#定义第一个条形图的X坐标信息</span>
                 means_frank<span class="token punctuation">,</span> <span class="token comment">#定义第一个条形图的Y轴信息</span>
                 bar_width<span class="token punctuation">,</span>   <span class="token comment">#定义条形图的宽度</span>
                 alpha <span class="token operator">=</span> opacity<span class="token punctuation">,</span>    <span class="token comment">#定义图形透明度</span>
                 color <span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">,</span>      <span class="token comment">#定义图形颜色为蓝色（blue）</span>
                 label <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span>    <span class="token comment">#定义第一个条形图的标签信息</span>
<span class="token comment">#画第二个条形图</span>
rects2 <span class="token operator">=</span> plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>index <span class="token operator">+</span> bar_width<span class="token punctuation">,</span> <span class="token comment"># 与第一个条形图在X周上无缝“肩并肩”</span>
                 means_guido<span class="token punctuation">,</span> 
                 bar_width<span class="token punctuation">,</span>
	             alpha <span class="token operator">=</span> opacity<span class="token punctuation">,</span>
                 color <span class="token operator">=</span> <span class="token string">'g'</span><span class="token punctuation">,</span>       <span class="token comment">#定义第二个图形演示为绿色（green）</span>
                 label <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">)</span> <span class="token comment">#定义第二个条形图的标签信息</span>

plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'课程'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'分数'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'分数对比图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>index <span class="token operator">+</span> bar_width<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>第二个图的x坐标 通过了一个位移操作index + bar_width(index是一个数组 + 标量), 使xticks放置在右条形图下.<br> 为了区分两组图,使用了label参数</p> 
<p>设置纹理<br> 将图形的填充色设置为白色:color = ‘w’, 同时把图形的边界设置为黑色,edgecolor = ‘k’.生成的是黑框白底的条形图.<br> 参数hatch可设置填充的纹理类型, 可取值为<code>/ \\ | - + x o O . *</code>. 这些符号表示图形中填充的符号.<br> 注: <code>.</code>和 <code>\</code> 越多越密 <code>hatch='\\\\\'</code>会出错,是因为转义字符而且填充的得是双斜线导致的.</p> 
<pre><code class="prism language-python"><span class="token comment">#设置字体以便支持中文</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
<span class="token comment"># 用于绘制图形的数据</span>
n_groups <span class="token operator">=</span> <span class="token number">4</span>
means_frank <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span>
means_guido <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment"># 创建图形</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#定义条形图在横坐标上的分类位置</span>
index <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>n_groups<span class="token punctuation">)</span>
bar_width <span class="token operator">=</span> <span class="token number">0.35</span>
opacity <span class="token operator">=</span> <span class="token number">0.8</span>
<span class="token comment">#画第一个条形图</span>
rects1 <span class="token operator">=</span> plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>index<span class="token punctuation">,</span>      <span class="token comment">#定义第一个条形图的X坐标信息</span>
                 means_frank<span class="token punctuation">,</span> <span class="token comment">#定义第一个条形图的Y轴信息</span>
                 bar_width<span class="token punctuation">,</span>   <span class="token comment">#定义条形图的宽度</span>
                 alpha <span class="token operator">=</span> opacity<span class="token punctuation">,</span>    <span class="token comment">#定义图形透明度</span>
                 color<span class="token operator">=</span><span class="token string">"w"</span><span class="token punctuation">,</span>edgecolor<span class="token operator">=</span><span class="token string">"k"</span><span class="token punctuation">,</span>
                 hatch<span class="token operator">=</span><span class="token string">'.....'</span><span class="token punctuation">,</span>
                 label <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span>    <span class="token comment">#定义第一个条形图的标签信息</span>
<span class="token comment">#画第二个条形图</span>
rects2 <span class="token operator">=</span> plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>index <span class="token operator">+</span> bar_width<span class="token punctuation">,</span> <span class="token comment"># 与第一个条形图在X周上无缝“肩并肩”</span>
	             means_guido<span class="token punctuation">,</span> 
                 bar_width<span class="token punctuation">,</span>
                 alpha <span class="token operator">=</span> opacity<span class="token punctuation">,</span>
                 color<span class="token operator">=</span><span class="token string">"w"</span><span class="token punctuation">,</span>edgecolor<span class="token operator">=</span><span class="token string">"k"</span><span class="token punctuation">,</span>
                 hatch<span class="token operator">=</span><span class="token string">'\\\\'</span><span class="token punctuation">,</span>
                 label <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">)</span> <span class="token comment">#定义第二个条形图的标签信息</span>

plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'课程'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'分数'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'分数对比图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>index <span class="token operator">+</span> bar_width<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="854__4167"></a>8.5.4 叠加条形图</h4> 
<p>主要区别是两个图x (index)是相同的, 设置bottom参数(条形图起始位置), 让一个图放置在另一个图的上面.</p> 
<pre><code class="prism language-python"><span class="token comment">#设置字体以便支持中文</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
<span class="token comment"># 用于绘制图形的数据</span>
n_groups <span class="token operator">=</span> <span class="token number">4</span>
means_frank <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span>
means_guido <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment"># 创建图形</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#定义条形图在横坐标上的分类位置</span>
index <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>n_groups<span class="token punctuation">)</span>
bar_width <span class="token operator">=</span> <span class="token number">0.35</span>
opacity <span class="token operator">=</span> <span class="token number">0.8</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>index<span class="token punctuation">,</span> means_frank<span class="token punctuation">,</span> width <span class="token operator">=</span> bar_width<span class="token punctuation">,</span> 
        alpha <span class="token operator">=</span> opacity<span class="token punctuation">,</span>
        color <span class="token operator">=</span> <span class="token string">'w'</span><span class="token punctuation">,</span> edgecolor <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> 
        hatch <span class="token operator">=</span> <span class="token string">r'\\'</span><span class="token punctuation">,</span>
        tick_label <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>index<span class="token punctuation">,</span> means_guido<span class="token punctuation">,</span> width <span class="token operator">=</span> bar_width<span class="token punctuation">,</span> 
        alpha <span class="token operator">=</span> opacity<span class="token punctuation">,</span>
        bottom <span class="token operator">=</span> means_frank<span class="token punctuation">,</span>
        color <span class="token operator">=</span> <span class="token string">'w'</span><span class="token punctuation">,</span> edgecolor <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> 
        hatch <span class="token operator">=</span> <span class="token string">'--'</span><span class="token punctuation">,</span>
        tick_label <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">)</span>
       <span class="token punctuation">)</span>
<span class="token comment"># plt.xlabel = 'course'</span>
<span class="token comment"># plt.ylabel = 'score'</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#plt.title = '分数对比图'</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'course'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'score'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'分数对比图'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>plt.xlabel ‘str’ object is not callable<br> 原理在于,plt.xlabel = 'course’赋值的时候, xlabel 被变成了一个 string 类型<br> 而这时候再 plt.xlabel(‘course’)也无法正确输出了，需要重启 kernel 删掉赋值语句。</p> 
<h4><a id="855__4206"></a>8.5.5 直方图</h4> 
<p>hist (<br> x, bins=None, range=None, density=None, weights=None,<br> Cumulative=False, bottom=None, histtype=‘bar’, align=‘mid’,<br> Orientation=‘vertical’, rwidth=None, log=False, color=None,<br> Label=None, stacked=False, normed=None, *, data=None,<br> **kwargs)<br> x : 指定要在 x 轴上绘制直方图所需的数据，形式上，可以是一个数组，也可以是数组序列。如果是数组序列，数组的长度不需要相同。<br> bins：指定直方图条形的个数，如果此处的值为正数，就会产生 bins+1 个分割边界。默认为 10，即将属性值 10 等分。如果为序列例如[1,3,4,6]就会被分割为[1,3), [3,4),[4,6]<br> range: 设置直方图的上下边界。边界之外的数据将被舍弃。<br> density：布尔值，如果为 True，则直方图的面积总和为 1. 如果为 false 则显示频数<br> weights 为每个数据点设置权重。<br> cumulative：表明是否需要计算累积频数或频率。<br> bottom：为每个条形添加基准线，默认为 0.<br> histtype：指名直方图的类型，可选 bar，barstacked，step，stepfilled 中的一种。默认为 bar 即条形图。<br> align：设置对齐方式。<br> oritention：设置呈现方式，默认垂直。<br> rwidth：设置各条线宽度的百分比，默认 0<br> log：指名是否需要对数变换<br> color 直方图的填充色<br> label：设置直方图的标签，可展示图例。<br> stacked：当有多个数据时，是否需要将直方图呈堆叠拜访，默认水平摆放。</p> 
<p>返回值：<br> n：直方图每个间隔内的样本个数，数据形式为数组或数组列表<br> bins：返回直方图中各个条形的区间范围，数据形式为数组<br> patches：返回直方图中各个间隔的相关信息（如颜色，透明度，高度，角度等），数据形式为列表或嵌套列表。</p> 
<pre><code class="prism language-python">mu <span class="token operator">=</span> <span class="token number">100</span>
sigma <span class="token operator">=</span> <span class="token number">15</span>
x <span class="token operator">=</span> mu <span class="token operator">+</span> sigma <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
num_bins <span class="token operator">=</span> <span class="token number">25</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
n<span class="token punctuation">,</span>bins<span class="token punctuation">,</span>patches <span class="token operator">=</span> plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> num_bins<span class="token punctuation">,</span> 
                          color<span class="token operator">=</span><span class="token string">"w"</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"k"</span><span class="token punctuation">,</span>
                          hatch<span class="token operator">=</span><span class="token string">r'ooo'</span><span class="token punctuation">,</span>
<span class="token comment">#                           density = 1,</span>
                          label <span class="token operator">=</span> <span class="token string">'频率'</span><span class="token punctuation">,</span>
                          histtype  <span class="token operator">=</span> <span class="token string">'barstacked'</span>
                          <span class="token punctuation">)</span>
<span class="token comment"># n,bins,patches</span>
<span class="token comment"># 正态分布概率密度函数</span>
y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span> <span class="token operator">*</span> sigma<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
     np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> sigma <span class="token operator">*</span> <span class="token punctuation">(</span>bins <span class="token operator">-</span> mu<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>bins<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'--'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'概率密度函数'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
<span class="token comment"># plt.xlabel = '聪明度'</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'聪明度'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'概率密度'</span><span class="token punctuation">)</span>
<span class="token comment"># plt.ylabel = '概率密度'</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'IQ直方图:$\mu=100$,$\sigma=15$'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>                               

</code></pre> 
<p><strong>美化直方图</strong></p> 
<ul><li>annotate ()<br> 参数<br> xy=(横坐标，纵坐标) 箭头尖端坐标<br> xytext=(横坐标，纵坐标) 文字的坐标，指的是最左边的坐标<br> arrowprops= { 接收字典类型}</li><li>plt. style. use 设置绘图风格</li><li>plt.cm.viridis(X, alpha=None, bytes=False)设置渐变色</li></ul> 
<p>X : float or int, ndarray or scalar<br> The data value (s) to convert to RGBA.<br> For floats, X should be in the interval <code>[0.0, 1.0]</code> to<br> return the RGBA values <code>X*100</code> percent along the Colormap line.<br> For integers, X should be in the interval <code>[0, Colormap.N)</code> to<br> return RGBA values <em>indexed</em> from the Colormap with index <code>X</code>.</p> 
<ul><li>set_fc () 英文指定参数（八种类型例‘k’）或者 rgb 码 <code>#66ccff</code> 或者（0.1, 0.2, 0.5）<br> 其他颜色格式</li><li>RGB 或者 RGBA 元组格式颜色<br> 元组中浮点型数值位于 [0, 1] 之间，e.g(0.1, 0.2, 0.5) 或 (0.1, 0.2, 0.5, 0.3). RGA即Red, Green, Blue；RGBA即Red, Green, Blue, Alpha;</li><li>RGB or RGBA对应的hex 格式颜色<br> (e.g., ‘#0F0F0F’ or ‘#0F0F0F0F’);</li><li>[0,1]之间的任意浮点数<br> (e.g., ‘0.5’)，其中0为纯黑色，1为白色;</li><li>{‘b’, ‘g’, ‘r’, ‘c’, ‘m’, ‘y’, ‘k’, ‘w’}几种基本色;</li><li>X11/CSS4中的颜色<br> e.g. “blue”;</li><li>xkcd中的颜色<br> e.g., ‘purple (#7e1e9c)’;</li><li>‘Cn’格式颜色<br> matplotlib.rcParams[‘axes.prop_cycle’]可输出所有颜色，[’#1f77b4’, ‘#ff7f0e’, ‘#2ca02c’, ‘#d62728’, ‘#9467bd’, ‘#8c564b’, ‘#e377c2’, ‘#7f7f7f’, ‘#bcbd22’, ‘#17becf’]，‘C0’对应’#1f77b4’,依次类推；</li><li>Tableau 的colormap中颜色<br> e.g. ‘tab: blue’;</li></ul> 
<p>n 是每个间隔的样本个数，patches 是每个条形的对象，可以操作设置颜色等。</p> 
<pre><code class="prism language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span> <span class="token comment"># 生成符合正态分布的5000个随机样本</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#设置图片大小 14x7 inch</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'seaborn-whitegrid'</span><span class="token punctuation">)</span> <span class="token comment"># 设置绘图风格</span>
n<span class="token punctuation">,</span> bins<span class="token punctuation">,</span> patches <span class="token operator">=</span> plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span> facecolor <span class="token operator">=</span> <span class="token string">'#2ab0ff'</span><span class="token punctuation">,</span> 
                            edgecolor<span class="token operator">=</span><span class="token string">'#169acf'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> n<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span> <span class="token comment"># 返回值n必须是整型</span>
<span class="token comment"># 设置显式中文的字体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>   <span class="token comment"># 显式负号'-'</span>
<span class="token comment">#为每个条形图设置颜色</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>patches<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    patches<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>viridis<span class="token punctuation">(</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span><span class="token builtin">max</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#对某个特定条形（如第50个）做特别说明   </span>
patches<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_fc<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span> <span class="token comment"># 设置颜色</span>
<span class="token comment"># patches[49].set_fc((1, 0.2, 0.5)) # 设置颜色</span>
patches<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_alpha<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 设置透明度</span>
<span class="token comment">#添加注释</span>
plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token string">'这是一个重要条形!'</span><span class="token punctuation">,</span> xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> 
             arrowprops<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'width'</span><span class="token punctuation">:</span><span class="token number">0.4</span><span class="token punctuation">,</span><span class="token string">'headwidth'</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">:</span><span class="token string">'#66ccff'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># 设置X和Y轴标题和字体大小</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'正态分布'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'不同的间隔（bins）'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'频度大小'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="86__4326"></a>8.6 饼图</h3> 
<p>matplotlib.pyplot.pie (x, explode=None, labels=None, colors=None, autopct=None, pctdistance=0.6, shadow=False, labeldistance=1.1, startangle=0, radius=1, counterclock=True, wedgeprops=None, textprops=None, center=0, 0, frame=False, rotatelabels=False, *, normalize=None, data=None)<br> 参数说明：</p> 
<p>x：浮点型数组或列表，用于绘制饼图的数据，表示每个扇形的面积。</p> 
<p>explode：数组，表示各个扇形之间的间隔，默认值为 0。为了突出某一个饼块。</p> 
<p>labels：列表，各个扇形的标签，默认值为 None。</p> 
<p>colors：数组，表示各个扇形的颜色，默认值为 None。</p> 
<p>autopct：设置饼图内各个扇形百分比显示格式，%d%% 整数百分比，%0.1 f 一位小数， %0.1 f%% 一位小数百分比， %0.2 f%% 两位小数百分比。</p> 
<p>labeldistance：标签标记的绘制位置，相对于半径的比例，默认值为 1.1，如 &lt;1 则绘制在饼图内侧。</p> 
<p>pctdistance：：类似于 labeldistance，指定 autopct 的位置刻度，默认值为 0.6。</p> 
<p>shadow：：布尔值 True 或 False，设置饼图的阴影，默认为 False，不设置阴影。</p> 
<p>radius：：设置饼图的半径，默认为 1。</p> 
<p>startangle：：用于指定饼图的起始角度，默认为从 x 轴正方向逆时针画起，如设定 =90 则从 y 轴正方向画起。</p> 
<p>counterclock：布尔值，用于指定是否逆时针绘制扇形，默认为 True，即逆时针绘制，False 为顺时针。</p> 
<p>wedgeprops ：字典类型，默认值 None。用于指定扇形的属性，比如边框线颜色、边框线宽度等。例如：wedgeprops={‘linewidth’: 5} 设置 wedge 线宽为 5。<br> textprops ：字典类型，用于指定文本标签的属性，比如字体大小、字体颜色等，默认值为 None。<br> center ：浮点类型的列表，用于指定饼图的中心位置，默认值：(0,0)。<br> frame ：布尔类型，用于指定是否绘制饼图的边框，默认值：False。如果是 True，绘制带有表的轴框架。<br> rotatelabels ：布尔类型，用于指定是否旋转文本标签，默认为 False。如果为 True，旋转每个 label 到指定的角度。<br> data：用于指定数据。如果设置了 data 参数，则可以直接使用数据框中的列作为 x、labels 等参数的值，无需再次传递。</p> 
<p>除此之外，pie () 函数还可以返回三个参数：</p> 
<p>wedges：一个包含扇形对象的列表。</p> 
<p>texts：一个包含文本标签对象的列表。</p> 
<p>autotexts：一个包含自动生成的文本标签对象的列表。</p> 
<h3><a id="87__4367"></a>8.7 箱形图</h3> 
<p>由 6 个数值点组成，异常值，最小值，下四分位数（Q1，即第 25%分位数），中位数（第 50%分位数），上四分位数（Q3 第 75%分位数），最大值。</p> 
<pre><code>        Q1-1.5IQR   Q1   median  Q3   Q3+1.5IQR
                       |-----:-----|
       o      |--------|     :     |--------|    o  o
                       |-----:-----|
     flier             &lt;-----------&gt;            fliers
                            IQR
</code></pre> 
<p>IQR = Q3 - Q1<br> 异常值 &lt; Q 1 - 1.5 * IQR 或 &gt; Q3 + 1.5 * IQR</p> 
<p>参数 x 如果是二维数组, boxplot 会把每一列画成一个箱图.<br> notch 布尔值 带凹口</p> 
<pre><code class="prism language-python"><span class="token comment">#读取数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-11\iris.csv'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span> <span class="token punctuation">:</span>
    lines <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#读取数据行的数据</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>        <span class="token comment">#对于每行数据进行分析</span>
        temp <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>

<span class="token comment">#转换为Numpy数组，方便后续处理</span>
data_np <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token comment"># data_np[:,:-1] </span>
<span class="token comment">#不读取最后一列，并将数值部分转换为浮点数</span>
data_np <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>data_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>
<span class="token comment">#特征名称</span>
labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'sepal length'</span><span class="token punctuation">,</span><span class="token string">'sepal width'</span><span class="token punctuation">,</span><span class="token string">'petal length'</span><span class="token punctuation">,</span><span class="token string">'petal width'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>data_np<span class="token punctuation">,</span>labels<span class="token operator">=</span>labels<span class="token punctuation">)</span>
<span class="token comment"># plt.show()</span>
</code></pre> 
<p>利用 pandas 读取 csv<br> <strong>注意</strong>：values 方法获取除行列索引的数据部分，返回二维数组。<br> read_csv 设置 header = None 可以不把第一行设置为列名, 而是自然数序列为列名.<br> boxplot 要指定参数</p> 
<pre><code class="prism language-python">data1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-11\iris.csv'</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment"># plt.boxplot(data[:,:-1],labels)</span>
<span class="token comment"># data1.iloc[:,:-1].values</span>

labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'sepal length'</span><span class="token punctuation">,</span><span class="token string">'sepal width'</span><span class="token punctuation">,</span><span class="token string">'petal length'</span><span class="token punctuation">,</span><span class="token string">'petal width'</span><span class="token punctuation">]</span>
<span class="token comment"># plt.boxplot(data1.iloc[:,:-1].values,labels) # 不显示标签 而且内凹， 因为没有指定labels参数</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>data1<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span>labels <span class="token operator">=</span> labels<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="88__4415"></a>8.8 误差条</h3> 
<pre><code class="prism language-python"><span class="token comment">#正确显示负号</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment">#生成正弦曲线</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span>math<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> math<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> num <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">0.05</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>standard_normal<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y_error <span class="token operator">=</span> <span class="token number">0.1</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>standard_normal<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

 <span class="token comment">#Axis setup</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
axis <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span> 

<span class="token comment">#绘制图形</span>
axis<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> <span class="token number">0.5</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>    <span class="token comment">#Set the y-axis view limits.</span>
<span class="token comment">#plt.figure(figsize=(9, 6), dpi=100)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">'r--'</span><span class="token punctuation">,</span> label<span class="token operator">=</span> <span class="token string">'sin(x)'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>errorbar<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> yerr <span class="token operator">=</span> y_error<span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token string">'best'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>我们用 np.random.standard_normal (size)来模拟测量误差.<br> <strong>注意</strong>: np.random.standard_normal 接收的是序列或 int ,如果我们写<br> (m, n, k)则会返回 m*n*k 个元素组成的 3 维数组 因此不能写 np.random.standard_normal (x)因为 x 是有 48 个元素的列表, 会返回一个 48 维数组 (但是最高 32 维). 因此会报错.<br> normal(loc=0.0, scale=1.0, size=None)，<br> 更一般的形式，返回均值为 loc，标准差为 scale 的正态分布，shape 由 size 参数决定。</p> 
<h3><a id="89__4442"></a>8.9 绘制三维图形</h3> 
<p>实例化子图时, 指定 projection 为 ‘3d’</p> 
<ul><li>np.meshgrid(x,y) 生成网格点坐标矩阵 然后才能对 z 轴取样.</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt 
<span class="token comment">#导入绘制三维图形模块</span>
<span class="token keyword">from</span> mpl_toolkits<span class="token punctuation">.</span>mplot3d <span class="token keyword">import</span> Axes3D

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#绘制三维曲线图</span>
ax1 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">221</span><span class="token punctuation">,</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>
theta <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> z<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span>
x <span class="token operator">=</span> r<span class="token operator">*</span>np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
y <span class="token operator">=</span> r<span class="token operator">*</span>np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
<span class="token comment">#方法与绘制二维曲线图相同</span>
ax1<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
ax1<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax1<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax1<span class="token punctuation">.</span>set_zlabel<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>

<span class="token comment">#绘制三维点图</span>
ax2 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">,</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
<span class="token comment">#方法同二维散点图</span>
ax2<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>
ax2<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax2<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax2<span class="token punctuation">.</span>set_zlabel<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>

<span class="token comment">#绘制三维曲面图</span>
ax3 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">223</span><span class="token punctuation">,</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span>y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
z <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> y<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
ax3<span class="token punctuation">.</span>plot_surface<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>winter<span class="token punctuation">)</span>
ax3<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax3<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax3<span class="token punctuation">.</span>set_zlabel<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>

<span class="token comment">#绘制三维柱状图</span>
ax4 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> z <span class="token keyword">in</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax4<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>zs<span class="token operator">=</span>z<span class="token punctuation">,</span>zdir<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">)</span>
ax4<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax4<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
ax4<span class="token punctuation">.</span>set_zlabel<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="810__Pandas__4503"></a>8.10 与 Pandas 协作绘图----以谷歌流感趋势数据为例</h3> 
<p>Matplotlib 是一个相当底层的绘图工具. 为了方便地对数据进行分析, Matplotlib 还被有机集成到了 Pandas 之中.</p> 
<h4><a id="8101__4505"></a>8.10.1 谷歌流感趋势数据描述</h4> 
<h4><a id="8102__4506"></a>8.10.2 导入数据与数据预处理</h4> 
<ul><li>Series.map(arg, na_action=None)<br> map()方法, 可以用于 Series 对象或 DataFrame 对象的一列，接收<strong>函数</strong>作为或<strong>字典</strong>对象作为参数，返回经过函数或字典映射处理后的值。<br> 参数：<br> arg : function, dict, or Series<br> Mapping correspondence.<br> na_action : {None, ‘ignore’}, default None<br> If ‘ignore’, propagate NaN values, without passing them to the mapping<br> correspondence.</li><li>df1.set_index(<br> keys, # 用已有的列作为列, 或者用 Series 类型或 Index 类型序列<br> drop: ‘bool’ = True, # 若为 False 则不删除设置为索引的列<br> append: ‘bool’ = False, # 若为 True 则不删除原有索引的列<br> inplace: ‘bool’ = False, # 原样更改<br> verify_integrity: ‘bool’ = False, # 检查有无重复 影响性能 谨慎使用<br> )</li></ul> 
<h5><a id="_1___pandas__map__object__datetime__4522"></a>法 1 先接收文件 再用 pandas 的 map 方法将 object 类型转化成 datetime 类型</h5> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">r'D:\study\code\Python\srcs\chap08-matplotlib\us.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%Y/%m/%d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_2__read_csv__4528"></a>法 2 直接用 read_csv 的参数直接转换类型和将列转换为行索引</h5> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">r'D:\study\code\Python\srcs\chap08-matplotlib\us.csv'</span><span class="token punctuation">,</span> parse_dates <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> index_col <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># index_col为0也可以,为列表是多重索引</span>
<span class="token comment">#index_col = 'Date'也可以</span>
</code></pre> 
<h4><a id="8103__4533"></a>8.10.3 绘制时序曲线图</h4> 
<ul><li>df.plot</li></ul> 
<p>df 为 Series 或 DataFrame</p> 
<pre><code class="prism language-python">style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>Illinois<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 相当于df['Illinois'].plot()</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在背后 Pandas 为我们提供了很多语法糖, 我们只需要给出 y 轴的数据, 实际上就是 Illinois 所代表的列<br> 而 x 轴默认使用行索引</p> 
<p><em>画多张图</em></p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token string">'Illinois'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>Idaho<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8104__4555"></a>8.10.4 选择合适的数据可视化表达</h4> 
<p><em>设置标签</em></p> 
<pre><code class="prism language-python">style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'Illinois'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">'illinois'</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>Idaho<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">'idaho'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc <span class="token operator">=</span> <span class="token string">'best'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><em>分别给不同曲线设置不同的风格</em></p> 
<pre><code class="prism language-python">fig<span class="token punctuation">,</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># ax</span>
temp_df <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Illinois'</span><span class="token punctuation">,</span><span class="token string">'Idaho'</span><span class="token punctuation">,</span><span class="token string">'Indiana'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
styles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'bs-'</span><span class="token punctuation">,</span><span class="token string">'ro-'</span><span class="token punctuation">,</span><span class="token string">'y^-'</span><span class="token punctuation">]</span>
linewidths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Illinois'</span><span class="token punctuation">,</span><span class="token string">'Idaho'</span><span class="token punctuation">,</span><span class="token string">'Indiana'</span><span class="token punctuation">]</span>
<span class="token comment">#temp_df.columns -&gt; Index(['Illinois', 'Idaho', 'Indiana'], dtype='object')</span>
<span class="token comment"># list(zip(temp_df.columns, styles, linewidths,labels))</span>
<span class="token triple-quoted-string string">'''
[('Illinois', 'bs-', 2, 'Illinois'),
 ('Idaho', 'ro-', 1, 'Idaho'),
 ('Indiana', 'y^-', 1, 'Indiana')]
'''</span>
<span class="token comment"># type(temp_df.Illinois)pandas.core.series.Series</span>
<span class="token keyword">for</span> col<span class="token punctuation">,</span> style<span class="token punctuation">,</span> lw <span class="token punctuation">,</span>label <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>temp_df<span class="token punctuation">.</span>columns<span class="token punctuation">,</span> styles<span class="token punctuation">,</span> linewidths<span class="token punctuation">,</span>labels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp_df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>style <span class="token operator">=</span> style<span class="token punctuation">,</span> lw <span class="token operator">=</span> lw<span class="token punctuation">,</span> ax <span class="token operator">=</span> ax<span class="token punctuation">,</span> label <span class="token operator">=</span> label<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><em>plot 的 kind 参数</em></p> 
<p>line 默认曲线.<br> bar 垂直条形图, 如果设置 stacked=‘True’ 则可以绘制叠加条形图.<br> barh 水平条形图, 可设置 bins 的值控制分割数量.<br> box 箱形图<br> kde 核密度估计图, 对条形图添加核概率密度线<br> density 等同于 kde<br> area 面积图<br> pie 饼图<br> scatter 散点图<br> hexbin 六角分箱图 类似热力图.</p> 
<pre><code class="prism language-python">df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Illinois'</span><span class="token punctuation">,</span><span class="token string">'Idaho'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind <span class="token operator">=</span> <span class="token string">'area'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8105__4605"></a>8.10.5 基于条件判断的图形绘制</h4> 
<h3><a id="811__Seaborn_4606"></a>8.11 惊艳的 Seaborn</h3> 
<h4><a id="8111_pairplot__4607"></a>8.11.1 pairplot 对图</h4> 
<p>用于呈现数据集中不同特征数据两两成对比较的结果</p> 
<ul><li>sns.set(style=“ticks”)等同于 sns.set_style(‘ticks’) Seaborn 中预设好了五种主题风格: darkgrid, whitegrid, dark, white, ticks</li><li>pairplot ()</li></ul> 
<p>第一个参数 data. 表示绘图的数据源, 注意 iris. csv 没有列名, 因此应该加上列名. 因为 后面使用pairplot ()函数会以某一列为分类标准, 从而给不同的图形上色.<br> 第二个参数 hue, 它用于从 data 中指定某个属性, 据此区分不同的类别标签, 从而对不同类型的图形上色, 在这个例子中, 我们通过 hue 参数指定 species 为类别标签<br> kind：用于控制非对角线上的图的类型，可选"scatter"与"reg"<br> 参数 diag_kind 用于指定对角线上图形的类别. 因为在主对角线上, 对于某一属性自身而言, 自然无法画出如散点图之类的图形. 于是, 我们有两种类型可选: 频率分布直方图, 核密度估计图.<br> 参数 palette (调色板), 我们可以选择不同的调色板来给图形上色. 除了预设好的调色板, 我们也可以自己制作.<br> markers：控制散点的样式<br> <code>vars</code>,<code>x_vars</code>,<code>y_vars</code>：选择数据中的特定字段，以<code>list</code>形式传入</p> 
<pre><code class="prism language-python">sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">)</span>

iris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
iris<span class="token punctuation">.</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span>
              <span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>

sns<span class="token punctuation">.</span>pairplot<span class="token punctuation">(</span>iris<span class="token punctuation">,</span>hue<span class="token operator">=</span><span class="token string">"species"</span><span class="token punctuation">,</span>diag_kind<span class="token operator">=</span><span class="token string">"kde"</span><span class="token punctuation">,</span>
             palette<span class="token operator">=</span><span class="token string">"muted"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8112_heatmap__4631"></a>8.11.2 heatmap (热力图)</h4> 
<ul><li>df. corr () 生成相关系数矩阵. 返回一个 DataFrame</li><li>sns.heatmap(wine_corr,annot=True,square=True,fmt=‘.2f’)<br> annot 是布尔参数, 若为 True 则热力图中的每个方格内都会写入注释数据 (相关系数), square 是布尔参数, 表示是否将输出的图形转化为正方形, 默认输出长方形.</li></ul> 
<pre><code class="prism language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">)</span>
wine <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-23\wine.csv'</span><span class="token punctuation">)</span>
wine_corr <span class="token operator">=</span> wine<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>wine_corr<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">'.2f'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8113_boxplot__4643"></a>8.11.3 boxplot (箱形图)</h4> 
<ul><li>sns. boxplot ()<br> x: x 轴的数据, 若不设置 默认为 None. 同理 y.<br> hue: 字符串类型, 它是某个代表类别的列名. boxplot ()方法会将这个列中包含的不同属性值作为分类依据, 不同分类对应不同颜色的箱体.<br> data 设置输入的数据集, 可以是 DataFrame 也可以是数组, 数组列表等<br> palette 调色板<br> order, hue_order : 控制箱体的顺序<br> orient: 取值为 v, h 控制垂直还是水平</li></ul> 
<pre><code class="prism language-python"><span class="token comment">#方案1：利用pandas读取数据</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>style <span class="token operator">=</span> <span class="token string">"ticks"</span><span class="token punctuation">)</span>
iris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span> header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

iris<span class="token punctuation">.</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span><span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>

sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data <span class="token operator">=</span> iris<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 方案2：用Seaborn导入数据</span>
<span class="token comment"># df = sns.load_dataset('iris')</span>
 
<span class="token comment"># 绘制一维箱体图</span>
<span class="token comment"># sns.boxplot( x = df["sepal_length"] )</span>
<span class="token comment">#plt.show()</span>
</code></pre> 
<p>Seaborn 内部集成了很多常见的经典数据集合</p> 
<ul><li>sns.load_dataset () 可能需要连外网</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 方案2：用Seaborn导入数据</span>
df <span class="token operator">=</span> sns<span class="token punctuation">.</span>load_dataset<span class="token punctuation">(</span><span class="token string">'iris'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 绘制一维箱体图</span>
sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span> x <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"sepal_length"</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
<span class="token comment"># &lt;urlopen error [Errno 11004] getaddrinfo failed&gt;</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><em>绘制每个特征的箱图</em></p> 
<pre><code class="prism language-python"><span class="token comment">#用来正常显示中文标签</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> 
<span class="token comment">#导入数据集合</span>
<span class="token comment"># df = sns.load_dataset("iris")</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span><span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>
<span class="token comment">#设置x轴、y轴及数据源</span>
ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"species"</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">"sepal_length"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>df<span class="token punctuation">)</span>
<span class="token comment"># 返回子图</span>
<span class="token comment"># 计算每组的数据量和中位数显示的位置</span>

<span class="token comment">#medians = df.groupby(['species'])['sepal_length'].median().values #和下面的语句等价</span>

medians <span class="token operator">=</span> df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"species"</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">"sepal_length"</span><span class="token punctuation">,</span>aggfunc<span class="token operator">=</span><span class="token string">"median"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
<span class="token comment"># 求median是为了控制文本的位置</span>
<span class="token comment"># 透视表返回的是DataFrame,我们只要数据部分</span>

<span class="token comment">#形成要显示的文本：每个子类的数量</span>
nobs <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'species'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values <span class="token comment"># array([50,50,50],dtype = int64)</span>
nobs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> nobs<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">#tolist()方法将array转化为列表 ['50', '50', '50']</span>
nobs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"数量: "</span> <span class="token operator">+</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> nobs<span class="token punctuation">]</span> <span class="token comment"># 字符串对象可以相加 </span>
<span class="token comment"># 设置要显示的箱体图的数量</span>
pos <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>nobs<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#将文本分别显示在中位数线条的上方</span>
<span class="token keyword">for</span> tick<span class="token punctuation">,</span>label <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> ax<span class="token punctuation">.</span>get_xticklabels<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax<span class="token punctuation">.</span>text<span class="token punctuation">(</span>pos<span class="token punctuation">[</span>tick<span class="token punctuation">]</span><span class="token punctuation">,</span> medians<span class="token punctuation">[</span>tick<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.03</span><span class="token punctuation">,</span> nobs<span class="token punctuation">[</span>tick<span class="token punctuation">]</span><span class="token punctuation">,</span>
            horizontalalignment<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token string">'x-small'</span><span class="token punctuation">,</span>
            color<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> weight<span class="token operator">=</span><span class="token string">'semibold'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>**<br> subplots 设置了参数 sharey 以共享 y 轴</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token punctuation">,</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment">#导入数据集合</span>
df <span class="token operator">=</span> sns<span class="token punctuation">.</span>load_dataset<span class="token punctuation">(</span><span class="token string">"iris"</span><span class="token punctuation">)</span>

fig<span class="token punctuation">,</span>axes<span class="token operator">=</span>plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>sharey <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment">#一行两列共两个子图</span>

sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"species"</span><span class="token punctuation">,</span>y <span class="token operator">=</span> <span class="token string">"petal_width"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> df<span class="token punctuation">,</span>ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#左图</span>

<span class="token comment">#sns.boxplot(x = "species",y = "petal_width",data = df, palette="Set3", ax = axes[1]) #右图</span>

sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"species"</span><span class="token punctuation">,</span>y <span class="token operator">=</span> <span class="token string">"petal_length"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> df<span class="token punctuation">,</span> palette<span class="token operator">=</span><span class="token string">"Set2"</span><span class="token punctuation">,</span> ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#右图</span>
</code></pre> 
<p>设置上下结构 orient 控制箱形图方向</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token punctuation">,</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment">#导入数据集合</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span><span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>
fig<span class="token punctuation">,</span>axes<span class="token operator">=</span>plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#2行1列共两个子图</span>

sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">"species"</span><span class="token punctuation">,</span>y <span class="token operator">=</span> <span class="token string">"petal_width"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> df<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">"v"</span><span class="token punctuation">,</span> ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#上子图垂直显示</span>

sns<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token string">"species"</span><span class="token punctuation">,</span>x <span class="token operator">=</span> <span class="token string">"petal_length"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> df<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">"h"</span><span class="token punctuation">,</span> palette<span class="token operator">=</span><span class="token string">"Set2"</span><span class="token punctuation">,</span> ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#下子图水平显示</span>
</code></pre> 
<h4><a id="8114_violin_plot__4740"></a>8.11.4 violin plot (小提琴图)</h4> 
<p>小提琴图集合了箱形图和密度图的特征. 图形像一把小提琴.<br> 图像的宽度代表密度. 横向越胖, 这个值出现得越频繁.</p> 
<ul><li>violinplot ()<br> scale 取值为 area, count, width 其中之一, 主要用于调整小提琴图的缩放. area 表示每个小提琴拥有相同的面积, count 根据样本数量来调节宽度, width 表示每个小提琴拥有相同的宽度.<br> inner 取值为 box, quartile, point, stick, None. 用于控制小提琴图数据点的形态, box 表示绘制微型小提琴图, quartile 表示显示四分位分布, point, stick 表示绘制点或小竖条, None 表示绘制朴素的小提琴图.<br> split 布尔值, 表示是否将小提琴图从中间分开.</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 导入数据</span>
iris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

iris<span class="token punctuation">.</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span><span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>
<span class="token comment"># 绘图</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">)</span>
<span class="token comment">#sns.violinplot(x='species', y = 'sepal_length', data = iris, scale='width', inner='quartile')</span>

sns<span class="token punctuation">.</span>violinplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'species'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'sepal_length'</span><span class="token punctuation">,</span> data <span class="token operator">=</span> iris<span class="token punctuation">,</span> split <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token string">'width'</span><span class="token punctuation">,</span> inner<span class="token operator">=</span><span class="token string">"box"</span><span class="token punctuation">)</span>

<span class="token comment"># 输出显示</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Violin Plot'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>绘制多个小提琴图</p> 
<ul><li>plt.subplots() 的参数 figsize 表示子图大小 sharex 表示上下子图共享 x 轴 (这样能让上下子图中相同类别的小提琴图对齐)<br> 当子图布局为二维时, 需要用一个列表描述给定子图的相对位置.</li><li>sns.violinplot() 的参数 ax = axes[0, 0]表示第 0 行第 0 列的子图</li></ul> 
<p>spieces 和四种不同的属性的小提琴图</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入数据</span>
iris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>

iris<span class="token punctuation">.</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span><span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>

<span class="token comment"># 绘图设置</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sharex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

sns<span class="token punctuation">.</span>violinplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'species'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'sepal_length'</span><span class="token punctuation">,</span> 
               data <span class="token operator">=</span> iris<span class="token punctuation">,</span> split <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> 
               scale<span class="token operator">=</span><span class="token string">'width'</span><span class="token punctuation">,</span> inner<span class="token operator">=</span><span class="token string">"box"</span><span class="token punctuation">,</span> 
               ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>violinplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'species'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'sepal_width'</span><span class="token punctuation">,</span> 
               data <span class="token operator">=</span> iris<span class="token punctuation">,</span> split <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token string">'width'</span><span class="token punctuation">,</span> 
               inner<span class="token operator">=</span><span class="token string">"box"</span><span class="token punctuation">,</span> 
               ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>violinplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'species'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'petal_length'</span><span class="token punctuation">,</span> 
               data <span class="token operator">=</span> iris<span class="token punctuation">,</span> split <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token string">'width'</span><span class="token punctuation">,</span> 
               inner<span class="token operator">=</span><span class="token string">"box"</span><span class="token punctuation">,</span> 
               ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>violinplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'species'</span><span class="token punctuation">,</span> 
               y <span class="token operator">=</span> <span class="token string">'petal_width'</span><span class="token punctuation">,</span> 
               data <span class="token operator">=</span> iris<span class="token punctuation">,</span> split <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> 
               scale<span class="token operator">=</span><span class="token string">'width'</span><span class="token punctuation">,</span> inner<span class="token operator">=</span><span class="token string">"box"</span><span class="token punctuation">,</span> 
               ax <span class="token operator">=</span> axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 输出显示</span>
plt<span class="token punctuation">.</span>setp<span class="token punctuation">(</span>axes<span class="token punctuation">,</span> yticks<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8115_Density_Plot__4800"></a>8.11.5 Density Plot (密度图)</h4> 
<ul><li>sns.kdeplot ()<br> data, data2: 用于指定绘图的数据源, 如果除了 x 轴的数据, 还想用 y 轴数据就要启用 data2.<br> shade 指名是否添加阴影<br> vertical 指定密度图的方向</li></ul> 
<pre><code class="prism language-python"><span class="token comment">#用来正常显示中文标签</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> 
<span class="token comment"># 导入数据</span>
iris <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'D:\study\code\Python\srcs\chap08-matplotlib\范例8-10\iris.csv'</span><span class="token punctuation">,</span>header <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
iris<span class="token punctuation">.</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'sepal_length'</span><span class="token punctuation">,</span><span class="token string">'sepal_width'</span><span class="token punctuation">,</span><span class="token string">'petal_length'</span><span class="token punctuation">,</span><span class="token string">'petal_width'</span><span class="token punctuation">,</span><span class="token string">'species'</span><span class="token punctuation">]</span>

<span class="token comment">#plt.figure(figsize=(16,10), dpi= 80)</span>
<span class="token comment">#绘图</span>
sns<span class="token punctuation">.</span>kdeplot<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>iris<span class="token punctuation">[</span><span class="token string">'species'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Iris-versicolor'</span><span class="token punctuation">,</span> <span class="token string">'sepal_length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
             shade<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> 
<span class="token comment">#             vertical = True, </span>
            color<span class="token operator">=</span><span class="token string">"g"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Iris-versicolor"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">.7</span><span class="token punctuation">)</span>

sns<span class="token punctuation">.</span>kdeplot<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>iris<span class="token punctuation">[</span><span class="token string">'species'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Iris-virginica'</span><span class="token punctuation">,</span> <span class="token string">'sepal_length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
             shade<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> 
<span class="token comment">#             vertical = True, </span>
            color<span class="token operator">=</span><span class="token string">"deeppink"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Iris-virginica"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">.7</span><span class="token punctuation">)</span>

sns<span class="token punctuation">.</span>kdeplot<span class="token punctuation">(</span>iris<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>iris<span class="token punctuation">[</span><span class="token string">'species'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Iris-setosa'</span><span class="token punctuation">,</span> <span class="token string">'sepal_length'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
             shade<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> 
<span class="token comment">#             vertical = True, </span>
            color<span class="token operator">=</span><span class="token string">"dodgerblue"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Iris-setosa"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">.7</span><span class="token punctuation">)</span>

<span class="token comment"># Decoration</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'鸢尾花花瓣长度的密度图'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="9__4834"></a>9 机器学习初步</h2> 
<h3><a id="91__4835"></a>9.1 机器学习定义</h3> 
<h4><a id="911__4836"></a>9.1.1 什么是机器学习</h4> 
<p>学习的核心就是改善性能. 机器学习提供了从数据中提取知识的方法.</p> 
<h4><a id="912__4838"></a>9.1.2 机器学习的三个步骤</h4> 
<p>每个具体输入都是一个实例, 它通常由特征向量构成, 所有特征向量存在的空间称为特征空间, 特征空间的每一个维度对应实例的一个特征.</p> 
<ol><li>如何找到一系列的函数来实现预期功能, 这是一个建模问题.</li><li>如何找到一系列评价标准来评价函数的好坏, 这是一个评价问题.</li><li>如何快速找到性能最优的函数, 这是一个优化问题.</li></ol> 
<h4><a id="913__4843"></a>9.1.3 传统编程与机器学习的差别</h4> 
<p>传统编程: 编写程序, 给定输入得到预期结果<br> 机器学习: 在给定输入和预期结果的基础之上, 经过计算得到模型参数, 这些模型参数反过来将构成程序中很重要的一部分.</p> 
<h4><a id="914__4846"></a>9.1.4 为什么机器学习不容易</h4> 
<h3><a id="92__4847"></a>9.2 监督学习</h3> 
<h4><a id="921__4848"></a>9.2.1 感性认识监督学习</h4> 
<p>监督学习相当于分类. 从有标签的训练数据中学习模型, 然后对某个给定的新数据利用模型预测它的标签.</p> 
<h4><a id="922__4850"></a>9.2.2 监督学习的形式化描述</h4> 
<p>监督学习就是先利用有标签的训练数据学习得到一个模型, 然后使用这个模型对新样本进行预测.<br> 监督学习的目标在于, 构建一个由输入到输出的映射, 该映射由模型来表示. 模型属于由输入空间到输出空间的映射集合, 这个集合就是假设空间. 假设空间的确定, 就意味着学习范围的确定. 而如何在假设空间中找到最好的映射, 这就是监督学习的最大动机所在.</p> 
<p>流程: 输入数据-抽取所需的特征形成特征向量-把特征向量和输入数据的标签信息送到学习模型-经过反复打磨出一个可用的预测模型-再采用同样的特征抽取方法作用于新样本, 得到新样本的特征向量.<br> 最后, 把这些新样本的特征向量作为输入, 使用预测模型实施预测, 并给出新样本的预测标签 (分类).</p> 
<h4><a id="923__4856"></a>9.2.3 损失函数</h4> 
<p>对于给定的 x, 相应的输出 y_bar 和 y 可能不一致, 于是我们需要定义一个损失函数来度量二者之间的落差 L (Y, Y_bar) = L (Y, f (X)) 为了方便这个函数的值为非负数.<br> 常见的损失函数有如下四类</p> 
<ol><li>0-1 损失</li><li>绝对损失</li><li>平方损失</li><li>对数损失</li></ol> 
<h3><a id="93__4863"></a>9.3 非监督学习</h3> 
<p>本质上就是聚类</p> 
<p>在非标签数据集中做归纳, 对未知数据集做归类 (预测)<br> 比较有名的非监督学习算法有 K 均值聚类 (K-Means), 层次聚类, 主成分分析, DBSCAN, 深度信念网络</p> 
<h3><a id="94__4868"></a>9.4 半监督学习</h3> 
<p>从已知的标签化的分类信息, 扩大到未知 (通过聚类思想将未知事物归类为已知事物领域).<br> 核心: 相似的样本有相似的输出.<br> 常见半监督学习算法: 生成式方法, 半监督支持向量机 (S^3VM, 是 SVM 在半监督学习上的推广应用), 图半监督学习, 半监督聚类等.</p> 
<h3><a id="95__4872"></a>9.5 机器学习的哲学视角</h3> 
<p>归纳 (从众多个体中抽象出一般特征), 演绎 (从一般到个体, 实施预测)</p> 
<h3><a id="96__4874"></a>9.6 模型性能评估</h3> 
<h4><a id="961__4875"></a>9.6.1 经验误差与测试误差</h4> 
<p>m 个样本, a 个被错误分类. 分类错误率为 a / m.<br> 我们将模型在训练集上的误差称为训练误差, 在测试集上的误差称为测试误差, 在新样本上的误差称为泛化误差. 泛化是指模型在新情况新样本上的性能表现, 也可以理解为通用. 泛化能力是机器学习算法对于新样本的适应能力.</p> 
<p>我们通常把数据集一分为二, 一部分用作训练, 一部分用作测试. 而这里用作测试的数据在功能上相当于新样本.</p> 
<p>训练模型时, 一开始的训练误差和测试误差都比较高, 随着训练的次数增加 (模型的复杂度也因此提升), 训练误差会越来越小, 但测试误差可能会越来越大, 因此我们需要平衡 (tradeoff)训练误差和测试误差, 让他们达到一个取舍均衡点.</p> 
<h4><a id="962__4883"></a>9.6.2 过拟合与欠拟合</h4> 
<p>欠拟合: 样本不够, 训练不精, 连已有数据集 (训练集)中的特征都没有学好的一种表现. 当它面对新样本做预测时, 自然预测效果也好不到哪去. 也称高偏差.<br> 过拟合: 模型一丝不苟的反映训练数据的特征, 表现非常卓越, 而对新样本的预测能力就会比较差. 也称高方差. 说明模型的泛化能力很差.<br> 过于精确的拟合, 可能会把这些数据的误差当作特征来学习, 从而导致在训练集上拟合越精确, 面对新样本时的预测效果反而越糟糕.<br> 欠拟合比较好克服, 比如在决策树算法中扩展分枝, 再比如在神经网络中增加训练的轮数, 这样就可以更细腻地学习样本中蕴含的特征.<br> 而克服过拟合就困难得多, 主要是模型过于复杂, 则我们需要一个更为简化的模型, 学习蕴含在数据中的特征. 而这种返璞归真的纠正策略, 就是正则化.</p> 
<h4><a id="963__4889"></a>9.6.3 模型选择与数据拟合</h4> 
<p>原则: 避免过拟合并提高泛化能力.<br> 当代价函数取得最小值时, w0,…, wn 便是最优的拟合参数.</p> 
<h3><a id="97__4892"></a>9.7 性能度量</h3> 
<h4><a id="971__4893"></a>9.7.1 二分类的混淆矩阵</h4> 
<p>二值分类器</p> 
<h4><a id="972__F1__4895"></a>9.7.2 查全率与查准率与 F1 分数</h4> 
<p>查全率: 分类准确的正类样本占所有正类样本的比例<br> 查准率: 预测准确的正类样本占所有被判定为正类样本的比例<br> 查准率高查全率往往偏低, 反之亦然.<br> F1分数</p> 
<h4><a id="973_PR__4901"></a>9.7.3 P-R 曲线</h4> 
<p>如果算法一的曲线完全包括了算法二的曲线, 则算法一性能更高.<br> 如果不好判断, 就比谁的面积大.<br> 平衡点 BEP (Break-Even Point) 当 P = R 时这条直线会与各个分类算法的 P-R 曲线产生交点 (即 BEP)哪个算法的 BEP 大, 哪个算法的分类性能就更优.</p> 
<h4><a id="974_ROC__4905"></a>9.7.4 ROC 曲线</h4> 
<p>很多时候, 我们不能确定某个样本是正类还是负类.<br> 如果分类概率大于截断点 (阈值概率), 则判断为正类, 否则为负类<br> 每确定一个截断点, 则会生成一个 (TPR, FPR)坐标, 只要截断点足够密集, 则 ROC 就会是光滑的曲线.</p> 
<h4><a id="975_AUC_4909"></a>9.7.5 AUC</h4> 
<p>表示曲线下的面积, 曲线是 ROC 曲线, 通过 ROC 曲线都位于 y=x 这条线的上方. 如果不是则把 P 反转成 1-P 即可.<br> 因此 AUC 的取值范围一般是 0.5 ~ 1.</p> 
<h3><a id="99__4912"></a>9.9 思考与提高</h3> 
<p>准确性的局限性, 如果负类样本太多, 分类器会把所有样本全预测为负类样本, 而实际上我们想要的是正类样本.</p> 
<h2><a id="10_sklearn__4914"></a>10 sklearn 与经典机器学习算法</h2> 
<h3><a id="101_sklearn_4915"></a>10.1 sklearn</h3> 
<h4><a id="1011_sklearn__4916"></a>10.1.1 sklearn 简介</h4> 
<p>基于 numpy 和 scipy, 提供了大量用于数据挖掘和分析的工具, 以及支持多种算法的一系列接口. sklearn 非常稳重, 只做机器学习领域的究竟考研的算法.<br> 流程:<br> 1 数据处理<br> 读取数据, 并对数据进行预处理, 如归一化, 标准化等<br> 2 分割数据<br> 将数据随机分割成三组: 训练集, 验证集 (可选), 测试集<br> 3 训练模型<br> 针对选取好的特征, 使用训练数据来构建模型, 即拟合数据,寻找最优的模型参数. 这里的拟合数据, 主要是指使用各种机器学习算法来学习数据中的特征, 拟合出损失函数最小化参数.<br> 4 验证模型<br> 使用验证集测试<br> 5 测试模型<br> 如果我们不设置验证模型, 久而久之, 测试集就慢慢变成了训练集.<br> 6 使用模型<br> 在全新的数据集上进行预测.<br> 7 调优模型</p> 
<h3><a id="102__4932"></a>10.2 线性回归</h3> 
<h4><a id="1021__4933"></a>10.2.1 线性回归的概念</h4> 
<p>找到自变量和因变量之间的关系, 并用某个模型描述出来.<br> 自变量即为特征.<br> 最小二乘法可以使实际值与预测值之差的平方和达到最小.<br> 通常利用数值计算的方法进行求解 (如随机梯度下降法, 牛顿迭代法)</p> 
<h4><a id="1022__sklearn__4938"></a>10.2.2 使用 sklearn 实现波士顿房价预测</h4> 
<p>波士顿住房价格有关信息. 该数据集统计了当地城镇人均犯罪率, 城镇非零售业务比例等共计 13 个指标 (特征), 第十四个特征相当于标签信息给出了住房的中位数报价.</p> 
<h5><a id="10221__sklearn__4940"></a>10.2.2.1 利用 sklearn 加载数据</h5> 
<p>sklearn 有一些内置的数据集例如波士顿房价, 鸢尾花, 红酒品类, 手写数字等.</p> 
<pre><code class="prism language-python">boston<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#dict_keys(['data', 'target', 'feature_names', 'DESCR', 'filename', 'data_module'])</span>
</code></pre> 
<p>data 特指除了标签之外的特征数据, 这里指前 13 个特征.<br> target 本意是目标, 这里指标签 (label)数据, 针对波士顿房价数据集, 就是指房价.<br> feature_names 实际上是 data 对应的 13 个特征的名称.<br> DESCR 是 description 的缩写. 即对当前数据集的详细描述</p> 
<pre><code class="prism language-python"><span class="token builtin">type</span><span class="token punctuation">(</span>boston<span class="token punctuation">)</span>
<span class="token comment">#sklearn.utils.Bunch</span>
</code></pre> 
<p>bunch 可以通过点访问属性也可以用键值对.</p> 
<pre><code class="prism language-python">boston<span class="token punctuation">.</span>data
<span class="token comment"># 或</span>
boston<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">boston<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token comment"># 相当于</span>
boston<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">boston<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token comment"># 获取形状</span>
boston<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment">#记录个数</span>
boston<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">#属性个数</span>
</code></pre> 
<h5><a id="10222__pandas__4975"></a>10.2.2.2 利用 pandas 处理数据</h5> 
<pre><code class="prism language-python"><span class="token comment"># 取数据，并设置列名</span>
bos <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
bos<span class="token punctuation">.</span>columns <span class="token operator">=</span> boston<span class="token punctuation">.</span>feature_names
bos<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>由于 sklearn 是把 data 和 target 分开存的，如果我们两个都要用，利用 pandas 可以很方便的实现。</p> 
<pre><code class="prism language-python">bos<span class="token punctuation">[</span><span class="token string">'PRICE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> boston<span class="token punctuation">.</span>target
</code></pre> 
<h5><a id="10223__4987"></a>10.2.2.3 分割数据集</h5> 
<ul><li>train_test_split () 用于将数据集分割为训练集和测试集。<br> train_test_split ()要求特征数据和标签数据必须是分开的.</li></ul> 
<p>分开操作</p> 
<pre><code class="prism language-python">X <span class="token operator">=</span> bos<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'PRICE'</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#将PRICE列删除并将剩余特征赋值给X</span>
y <span class="token operator">=</span> bos<span class="token punctuation">[</span><span class="token string">'PRICE'</span><span class="token punctuation">]</span><span class="token comment">#将PRICE列赋值给y</span>
</code></pre> 
<p>当然如果我们仅操作 sklearn 自带的数据集, 则可以这么写.</p> 
<pre><code class="prism language-python">X <span class="token operator">=</span> boston<span class="token punctuation">.</span>data
y <span class="token operator">=</span> boston<span class="token punctuation">.</span>target

</code></pre> 
<p>分割 X 和 y</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p>由于 X 和 y 被分为两个部分, 则需要四个变量接收.<br> 第三个参数 test_size = 0.3 表示测试集占 30%, 第四个参数 random_state 表示配合随机抽取数据的种子.<br> 我们希望每次得到的都是固定的训练集和测试集, 这就为我们调参提供了方便. 默认值为 None. 就启用 np. random 作为随机种子.<br> train_test_split 返回四个值, 四个变量的逻辑顺序要正确.<br> 训练集的特征数据, 测试集的特征数据, 训练集的标签数据, 测试集的标签数据.</p> 
<h5><a id="10224__5014"></a>10.2.2.4 导入线性回归模型</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression
LR <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
LR<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> LR<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre> 
<p>导入线性回归模型, 然后创建了一个线性回归模型实例 LR, 然后用于在训练集上拟合数据, 在 sklearn 中训练模型的方法统称为 fit (). 由于回归模型属于监督学习, 所以 fit 提供两个参数, 前者是特征后者是标签.<br> 第四行作用是在测试集上实施模型预测.</p> 
<h5><a id="10225__5023"></a>10.2.2.5 查看线性回归模型的系数</h5> 
<p>查看各个特征的权值 (<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          1 
         
        
       
         , 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         , 
        
        
        
          w 
         
        
          n 
         
        
       
      
        w_1,..., w_n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>), 截距 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          0 
         
        
       
      
        w_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0269em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p> 
<pre><code class="prism language-python">np<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>precision <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> suppress <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'W = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>LR<span class="token punctuation">.</span>coef_<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'w0 = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>LR<span class="token punctuation">.</span>intercept_<span class="token punctuation">:</span><span class="token format-spec">.3f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
W = [ -0.121   0.044   0.011   2.511 -16.231   3.859  -0.01   -1.5     0.242   -0.011  -1.018   0.007  -0.487]
w0 = 37.937
'''</span>
</code></pre> 
<p>np.set_printoptions(precision = 3, suppress = True) 将小数点后最多显示 3 位，suppress = True 用于取消使用科学计数法。<br> 注意无法对 LR. coef_ 直接使用格式化输出因为它是数组.</p> 
<pre><code class="prism language-python"><span class="token comment">#TypeError: unsupported format string passed to numpy.ndarray.__format__</span>
</code></pre> 
<p>注: sklearn 的参数都以下划线结尾, 这是为了避免命名雷同.</p> 
<p>通常来说权值为负则代表, 它和房价负相关, 对这个数据集来说, 这样的权值会抑制房价. 负值的绝对值越大则表示他对房价的抑制程度就越大. 反之如果他为正, 则代表它和房价是正相关的, 值越大表明对房价的提升效果就越好.</p> 
<pre><code class="prism language-python">Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'CRIM'</span><span class="token punctuation">,</span> <span class="token string">'ZN'</span><span class="token punctuation">,</span> <span class="token string">'INDUS'</span><span class="token punctuation">,</span> <span class="token string">'CHAS'</span><span class="token punctuation">,</span> <span class="token string">'NOX'</span><span class="token punctuation">,</span> <span class="token string">'RM'</span><span class="token punctuation">,</span> <span class="token string">'AGE'</span><span class="token punctuation">,</span> <span class="token string">'DIS'</span><span class="token punctuation">,</span> <span class="token string">'RAD'</span><span class="token punctuation">,</span> <span class="token string">'TAX'</span><span class="token punctuation">,</span> <span class="token string">'PTRATIO'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'LSTAT'</span><span class="token punctuation">,</span> <span class="token string">'PRICE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>
</code></pre> 
<p>w1 = -0.121 表示犯罪率越高的城市, 房价越低.<br> 随后三个权值, 说明都能提高房价, 抑制最明显的就是 NOX, 他表示一氧化氮的浓度. 一氧化氮浓度越高, 说明住房所在地的环境污染越严重.<br> RM 是对房价提升最明显的特征, 每处住房的平均房间数量越多 (房屋面积越大), 自然房价越高.</p> 
<p>因此作为数据分析工程师, 我们可以构建出模型, 拟合出参数, 但要想对数据进行解读, 还需要领域背景知识, 否则就容易贻笑大方.</p> 
<h5><a id="10226__5054"></a>10.2.2.6 绘制预测结果</h5> 
<pre><code class="prism language-python"><span class="token comment"># 可视化</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Price:$Y_i$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Predicted prices:$\hat{Y}_i$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Prices vs Predicted prices:$Y_i$ vs $\hat{Y}_i$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>

x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> x
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>lw <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'Predict line'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>利用实际的房价和预测房价得到了散点图<br> 如果预测和实际一致, 那么所有的点都应该落在 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         x 
        
       
      
        y = x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span> 上. 但这并不是现实, 我们可以看到大部分点散落在 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         x 
        
       
      
        y = x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span> 上, 说明预测的结果还不错.</p> 
<p>利用 seaborn 绘制图</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'实际房价'</span><span class="token punctuation">,</span> <span class="token string">'预测房价'</span><span class="token punctuation">]</span>
<span class="token comment">#data.head()</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
sns<span class="token punctuation">.</span>lmplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'实际房价'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">'预测房价'</span><span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>lmplot ()<br> lmplot 的 data 参数是 DataFrame 类型.<br> lmplot 返回的是一个散点图, 线性回归曲线, 95%置信区间的组合图. 如果我们设置 ci = 60 则表示置信区间为 60%.<br> concat 参数是 Series 或 DataFrame.</li></ul> 
<h5><a id="10227__5091"></a>10.2.2.7 预测效果的评估</h5> 
<p>利用均方根误差评估预测结果</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
mse <span class="token operator">=</span> metrics<span class="token punctuation">.</span>mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mse<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="103_k_5099"></a>10.3 k-近邻算法</h3> 
<h4><a id="1031__5100"></a>10.3.1 算法简介</h4> 
<p>给定某个测试样本, 根据某种距离 (欧式距离等), 找到训练集中与测试集最接近的 k 个训练样本, 然后基于这 k 个最近的邻居进行预测分类.<br> 将这 k 个训练样本中出现最多的类别标记为预测结果.</p> 
<h4><a id="1032_k__5103"></a>10.3.2 k 值的选取</h4> 
<p>k 值小, 相当于利用较小邻域训练, 学习的近似误差, 但预测的结果对训练样本非常敏感. 也就是说, k 值较小, 分类算法的鲁棒性也较差, 很容易发生过拟合现象. k 值大了, 分类错误率又会很快回升.<br> 人们通常采取交叉验证的方式来选取最优的 k 值, 即对于每个 k 值都做若干次交叉验证, 然后计算出它们各自的平均误差, 最后择其小者定之.</p> 
<h4><a id="1033__5106"></a>10.3.3 特征数据的归一化</h4> 
<p>不同特征对于距离计算的影响可谓大相径庭. 归一化就是将特征值映射到 0,1 范围之内进行处理.<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           x 
          
         
           ′ 
          
         
        
          = 
         
         
          
          
            x 
           
          
            − 
           
          
            m 
           
          
            i 
           
          
            n 
           
          
          
          
            m 
           
          
            a 
           
          
            x 
           
          
            − 
           
          
            m 
           
          
            i 
           
          
            n 
           
          
         
        
       
         x' = \frac{x-min}{max-min} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1059em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3365em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">min</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<pre><code class="prism language-python">X_normal <span class="token operator">=</span> <span class="token punctuation">(</span>X_train <span class="token operator">-</span> X_min<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>X_max <span class="token operator">-</span> X_min<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X_normal<span class="token punctuation">)</span>
<span class="token comment"># [0.4   0.267 1.    0.    0.533]</span>
</code></pre> 
<p>要做最大最小归一化, 先生成 min_max_scaler对象.</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler
X_train <span class="token operator">=</span> X_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
min_max_scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
min_max_scaler<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_normal <span class="token operator">=</span> min_max_scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token punctuation">.</span>T
<span class="token comment"># array([[0.4  , 0.267, 1.   , 0.   , 0.533]])</span>
</code></pre> 
<p>fit 并不是求前面案例的模型训练, 而是求数据最大值和最小值的方法. 有了这两个值, 我们就可以利用归一化公式进行操作, sklearn 中将这种改变原始数据大小的行为, 称为变换 (transform).</p> 
<p>将拟合和变换可以合并为一个方法 fit_transform</p> 
<pre><code class="prism language-python">min_max_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token punctuation">.</span>T
<span class="token comment"># array([[0.4  , 0.267, 1.   , 0.   , 0.533]])</span>
</code></pre> 
<h4><a id="1034__5132"></a>10.3.4 邻居距离的度量</h4> 
<p>对于非连续变量, 欧式距离和马氏距离表现出了一定的局限性. 在这种情况下, 海明距离应用得更广.</p> 
<h4><a id="1035__5134"></a>10.3.5 分类原则的制定</h4> 
<p>距离越近的邻居的权重越大.</p> 
<h4><a id="1036__sklearn__k_5136"></a>10.3.6 基于 sklearn 的 k-近邻算法实战</h4> 
<p>我们将 k (n_neighbors)设置为 3, 这是来源于经验的参数, 称为超参数.</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token comment"># 1 加载鸢尾花数据集</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data
y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target
<span class="token comment"># 2 分割数据</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>
                                                    random_state <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">)</span>
<span class="token comment"># 3 选择模型</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier
<span class="token comment"># 4 生成模型对象</span>
knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 5 训练模型(数据拟合)</span>
knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># 6 模型预测</span>
<span class="token comment"># 单个数据预测</span>
knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#array([2])</span>
<span class="token comment"># 大集合数据预测</span>
y_predict_on_train <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
y_predict_on_test <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
<span class="token comment"># 7 模型评估</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'训练集的准确率为: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_predict_on_train<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">%'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'测试集的准确率为: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_predict_on_test<span class="token punctuation">)</span><span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">%'</span></span><span class="token punctuation">)</span>
<span class="token comment">#训练集的准确率为: 97.14%</span>
<span class="token comment">#测试集的准确率为: 93.33%</span>
</code></pre> 
<p>将训练集和测试集准确率都输出出来, 是因为如果训练集中的准确率大大超过了测试集就有理由怀疑我们的模型可能陷入了过拟合状态.<br> k 的设置, 随机数种子的设置都会影响准确率.</p> 
<ul><li>accuracy_score ()</li></ul> 
<pre><code class="prism language-python">accuracy_score<span class="token punctuation">(</span>y_true<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> sample_weight<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre> 
<p>y_true 表示真实的分类向量, y_pred 表示预测正确的向量, sample_weight 表示样本的权值向量.</p> 
<ul><li>k 近邻分类器</li></ul> 
<pre><code class="prism language-python">KNeighborsClassifier<span class="token punctuation">(</span>
    n_neighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token punctuation">,</span>
    weights<span class="token operator">=</span><span class="token string">'uniform'</span><span class="token punctuation">,</span>
    algorithm<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">,</span>
    leaf_size<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>
    p<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>
    metric<span class="token operator">=</span><span class="token string">'minkowski'</span><span class="token punctuation">,</span>
    metric_params<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    n_jobs<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>weights 用于指定投票权重类型, 如果选择 uniform 就表示众生平等, 即所有最近邻样本权重都一样. 若取值为 distance 表明权重和距离成反比. 即距离预测目标更近的近邻有更高的权重. 我们也可以自定义权重.</p> 
<h3><a id="104_Logistic__5195"></a>10.4 Logistic 回归</h3> 
<h5><a id="1041__Logistic__5196"></a>10.4.1 为什么需要 Logistic 回归</h5> 
<p>虽然这个算法带回归, 但却是分类算法<br> 分类在于输出离散的标签值, 而回归输出的是连续的实数.<br> 我们观察到的样本特征, 往往是连续的实数值, 而我们的输出目标却是"非 0 即 1", 而我们又没法直接把连续值映射为离散值.<br> 我们不再考虑二分类 (买不买), 而是考虑买不买的概率, 于是我们就回到了连续值到连续值的映射上了.<br> 我们用阈值 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         θ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span></span></span></span></span>,一旦概率大于 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         θ 
        
       
      
        \theta 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span></span></span></span></span> 就表示购买的可能性大. 反之表示可能性小.<br> 我们假设购买的概率为 P 不购买的概率就是 1-P 我们只要保证购买的概率大于不购买的概率就好了, 即 <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           P 
          
          
          
            1 
           
          
            − 
           
          
            P 
           
          
         
        
          &gt; 
         
        
          1 
         
        
       
         {P\over{1-P}}&gt;1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span></span></p> 
<h4><a id="1042_Logistic__5205"></a>10.4.2 Logistic 源头初探</h4> 
<p>odds (可能性, 几率)指的是事件发生与不发生的比例.<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          o 
         
        
          d 
         
        
          d 
         
        
          s 
         
        
          ( 
         
        
          A 
         
        
          ) 
         
        
          = 
         
         
          
          
            P 
           
          
            ( 
           
          
            A 
           
          
            ) 
           
          
          
          
            1 
           
          
            − 
           
          
            P 
           
          
            ( 
           
          
            A 
           
          
            ) 
           
          
         
        
       
         odds(A) = \frac{P(A)}{1-P(A)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">dd</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> 而 logit 指的是对 it (也就是 odds 取对数 log)<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          o 
         
        
          g 
         
        
          i 
         
        
          t 
         
        
          ( 
         
        
          o 
         
        
          d 
         
        
          d 
         
        
          s 
         
        
          ) 
         
        
          = 
         
        
          l 
         
        
          o 
         
        
          g 
         
        
          ( 
         
         
         
           P 
          
          
          
            1 
           
          
            − 
           
          
            P 
           
          
         
        
          ) 
         
        
       
         logit(odds) = log({<!-- -->{P}\over{1-P}}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">o</span><span class="mord mathnormal">dd</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.0359em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 这个公式也就是所谓的 logit 变换<br> 通常写成<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          z 
         
        
          = 
         
        
          l 
         
        
          n 
         
        
          ( 
         
         
         
           P 
          
          
          
            1 
           
          
            − 
           
          
            P 
           
          
         
        
          ) 
         
        
       
         z = ln({\frac{P}{1-P}}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 反之<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          = 
         
         
          
          
            e 
           
          
            z 
           
          
          
          
            1 
           
          
            + 
           
           
           
             e 
            
           
             z 
            
           
          
         
        
       
         P = {<!-- -->{e^z}\over{1+e^z}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1107em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3414em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.5904em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></span><br> 我们将上面的式子按分布函数的格式写出来可得<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          = 
         
        
          ( 
         
        
          Z 
         
        
          ≤ 
         
        
          z 
         
        
          ) 
         
        
          = 
         
         
         
           1 
          
          
          
            1 
           
          
            + 
           
           
           
             e 
            
           
             z 
            
           
          
         
        
       
         P = (Z \leq z) = {1\over{1+e^z}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.044em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0908em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.5904em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.044em;">z</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></span></p> 
<p>Z 为随机变量, 取值为实数.<br> 上式就是在 Logistic 回归和神经网络中广泛使用的 Sigmoid 函数(又称 Logistic 函数), 该函数单调递增, 处处可导.<br> 也因此 Logistic regression 应该被翻译为对数几率回归.<br> Logistic 函数是一个 S 型的曲线, 他可以将任意实数映射为 0~1 之间的数. 我们可以设置阈值为 0.5, 然后概率小于 0.5, 则用 0 表示, 大于 0.5, 则用 1 表示. 当然根据不同情况也可以设置不同的阈值.<br> 此外, 分类的标识 0 或 1 和概率的边界 0 或 1 是没有任何关系的, 我们完全可以用-1 和 1 来表示两个类, 只要他们有区分度就行.</p> 
<h4><a id="1043_Logistic__5233"></a>10.4.3 Logistic 回归实战</h4> 
<p>Logistic 主要就是基于二分类的.<br> 数据集是皮马印第安人糖尿病数据集. 我们要预测一年后患者还有没有糖尿病, 有标识为 1, 没有标识为 0.</p> 
<pre><code class="prism language-python">col_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'pregnant'</span><span class="token punctuation">,</span> <span class="token string">'glucose'</span><span class="token punctuation">,</span> <span class="token string">'bp'</span><span class="token punctuation">,</span> <span class="token string">'skin'</span><span class="token punctuation">,</span> <span class="token string">'insulin'</span><span class="token punctuation">,</span> <span class="token string">'bmi'</span><span class="token punctuation">,</span> <span class="token string">'pedigree'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'label'</span><span class="token punctuation">]</span>
<span class="token comment"># load dataset</span>
pima <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">r"D:\study\code\Python\srcs\chap10-machine\10-3-logistics\diabetes.csv"</span><span class="token punctuation">,</span> 
                   header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span>col_names<span class="token punctuation">)</span>
y <span class="token operator">=</span> pima<span class="token punctuation">.</span>label
X <span class="token operator">=</span> pima<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'label'</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 拆分模型</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
X_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># 导入Logistic回归模型</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression
<span class="token comment"># 创建模型实例</span>
logreg <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span>solver <span class="token operator">=</span> <span class="token string">'newton-cg'</span><span class="token punctuation">)</span>
<span class="token comment"># 用数据拟合模型,即训练</span>
logreg<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
<span class="token comment"># 模型预测</span>
y_pred <span class="token operator">=</span> logreg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre> 
<p>在 LogisticRegression () 函数参数中, 对应的 solver (解决方案共有四个)</p> 
<ul><li>liblinear 使用开源的 liblinear 库适合小数据集</li><li>lbfgs 采用拟准牛顿法实现, 利用损失函数二阶导数矩阵 (即海森矩阵)来迭代优化损失函数</li><li>newton-cg, 采用非线性共轭梯度算法实现, 他需要通过事先预处理让各个特征处于同一个尺度之下</li><li>sag 随机平均梯度下降法</li></ul> 
<p>采用混淆矩阵来评价算法的性能<br> 对角线为分类正确的样本数</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
cnf_matrix <span class="token operator">=</span> metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cnf_matrix<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'准确率为: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>metrics<span class="token punctuation">.</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'查准率为: {:.2f}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>precision_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'查全率为: %.2f'</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>recall_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
[[98  9]
 [18 29]]
准确率为: 0.82
查准率为: 0.76
查全率为: 0.62
'''</span>
</code></pre> 
<p>ROC 曲线</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 为在Matplotlib中显示中文，设置特殊字体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span>
y_pred_proba <span class="token operator">=</span> logreg<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">#两个冒号一个冒号一个意思</span>
fpr<span class="token punctuation">,</span> tpr<span class="token punctuation">,</span> _ <span class="token operator">=</span> metrics<span class="token punctuation">.</span>roc_curve<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>  y_pred_proba<span class="token punctuation">)</span>
auc <span class="token operator">=</span> metrics<span class="token punctuation">.</span>roc_auc_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_proba<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>fpr<span class="token punctuation">,</span>tpr<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"pima糖尿病, auc={:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>auc<span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>shadow<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">13</span><span class="token punctuation">,</span> loc <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>predict_proba</li></ul> 
<p>总的来说，predict 返回的是一个预测的值，predict_proba 返回的是对于预测为各个类别的概率。predict_proba 返回的是一个 n 行 k 列的数组， 第 i 行 j 列的数值是模型预测 第 i 个预测样本为某个标签的概率，并且每一行的概率和为1。</p> 
<pre><code class="prism language-python">logreg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">,</span> logreg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">.</span>shape
<span class="token triple-quoted-string string">'''
(array([1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0,
        0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1,
        1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1,
        1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1,
        0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
       dtype=int64),
 (154,))
 '''</span>
logreg<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">,</span> logreg<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token punctuation">.</span>shape
<span class="token triple-quoted-string string">'''
(array([[0.04011816, 0.95988184],
        [0.83481094, 0.16518906],
        ......
        [0.82457904, 0.17542096]]),
 (154, 2))
'''</span>
</code></pre> 
<h3><a id="105__5321"></a>10.5 神经网络学习算法</h3> 
<p>本质上, 深度学习网络就是层数较多的神经网络. sklearn 不支持深度学习, 但是支持多层感知机 (浅层神经网络).</p> 
<h4><a id="1051__5323"></a>10.5.1 人工神经网络的定义</h4> 
<p>人工神经网络是一种由具有自适应的简单单元构成的广泛并行互联的网络, 它的组织结构能够模拟生物神经网络系统对真实世界所作出的交互反映.<br> 作为处理数据的一种新模式, 神经网络有很强大的学习能力. 在得到一个训练集后, 他能通过学习提取所观察事物的各个部分的特征, 将特征之间用不同网络节点连接, 通过训练链接的网络权重, 改变每一个连接的强度, 直到顶层的输出得到正确的答案.</p> 
<h4><a id="1052__5326"></a>10.5.2 神经网络中的’‘学习’'本质</h4> 
<p>学习的核心是调整权重 (即不同神经元细胞之间的连接强度)</p> 
<h4><a id="1053__5328"></a>10.5.3 神经网络结构的设计</h4> 
<p>神经: 即神经元, 什么是神经元<br> 网络: 即连接权重和偏置 (bias), 他们是怎么连接的</p> 
<p>隐含层: 负责实现输入和输出之间的非线性映射变化. 层数不固定, 每层的神经元个数也不固定, 是人们根据实际情况不断调整选取的.<br> 偏置表明神经网络是否更容易被激活.<br> 设计神经网络结构的目的在于, 让神经网络以更佳的性能来学习. 也即找到合适的权重和偏置, 让损失函数的值最小.</p> 
<h4><a id="1054__sklearn__5335"></a>10.5.4 利用 sklearn 搭建多层神经网络</h4> 
<h5><a id="10541__5336"></a>10.5.4.1 认识所分析的数据集</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_wine
wine <span class="token operator">=</span> load_wine<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> wine<span class="token punctuation">.</span>data
y <span class="token operator">=</span> wine<span class="token punctuation">.</span>target
</code></pre> 
<h5><a id="10542__5345"></a>10.5.4.2 分割数据集</h5> 
<pre><code class="prism language-python">X <span class="token operator">=</span> wine<span class="token punctuation">.</span>data
y <span class="token operator">=</span> wine<span class="token punctuation">.</span>target
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="10543__5352"></a>10.5.4.3 构建多层神经网络</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier <span class="token comment"># 导入多层感知机分类器</span>
<span class="token comment"># 构建多层感知分类器模型</span>
model <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>solver <span class="token operator">=</span> <span class="token string">'lbfgs'</span><span class="token punctuation">,</span> hidden_layer_sizes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>solver 意为解题者, 表示为某种快速找到解的算法<br> hidden_layer_sizes 决定了神经网络的拓扑结构, 神经网络通常由三部分组成, 输入层隐含层和输出层. 设置这个参数是有技巧的, 因为输入层和输出层神经元的数量取决于特征和目标的数量. 比如这个例子有 13 个特征, 那么输入层就要设置为 13 个神经元. 而输出的是红酒的品类, 因此输出层神经元的个数为 1 即可.<br> hidden_layer_sizes 是一个元组对象. 元组内的元素个数就是隐含层的层数, 每个元素的具体值就是某个隐含层神经元的个数, 元素的先后顺序表示隐含层的先后顺序.<br> hidden_layer_sizes = (100,)表示隐含层有 1 层, 该层有 100 个神经元. 加上输入层和输出层, 这个神经网络就有三层. 再如 hidden_layer_sizes = (5,2,)表示隐含层有 2 个, 第一个隐含层有 5 个神经元, 第二个隐含层有 2 个神经元, 加上输入层和输出层, 共有 4 个层.</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier <span class="token comment"># 导入多层感知机分类器</span>
<span class="token comment"># 构建多层感知分类器模型</span>
model <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>solver <span class="token operator">=</span> <span class="token string">'lbfgs'</span><span class="token punctuation">,</span> hidden_layer_sizes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span>max_iter<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
<span class="token comment"># 在训练集和测试集上进行预测</span>
y_predict_on_train <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
y_predict_on_test <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
<span class="token comment"># 模型评估</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> accuracy_score
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'测试集的准确率为%.2f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>accuracy_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span>y_predict_on_train<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'训练集的准确率为%.2f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>accuracy_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_predict_on_test<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>我试的准确率可高了, 都 90 多.</p> 
<p>尝试采用两层隐含层</p> 
<pre><code class="prism language-python">model <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>solver <span class="token operator">=</span> <span class="token string">'lbfgs'</span><span class="token punctuation">,</span> hidden_layer_sizes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>对数据进行预处理<br> 导入标准缩放模块 StandardScaler</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
scaler<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
<span class="token comment">#对训练集和测试集均做缩放处理</span>
X_train <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre> 
<p>最终得到训练集和测试集的准确率均为 100 %</p> 
<p>特征工程: 将原始数据转化为有用的特征, 以便更好地表示预测模型处理的实际问题, 提升对未知数据的预测准确性.</p> 
<h5><a id="10545__5395"></a>10.5.4.5 查看模型参数</h5> 
<pre><code class="prism language-python">model<span class="token punctuation">.</span>coefs_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 输出偏置参数权重</span>
<span class="token triple-quoted-string string">'''
array([[-0.15766675,  0.02168737,  0.12008143, ..., -0.02750502,
         0.09755366,  0.19004723],
       ...,
       [-0.02802077,  0.03800487,  0.1869057 , ..., -0.11605714,
         0.21470717, -0.07172915]])
'''</span>
model<span class="token punctuation">.</span>coefs_<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># 输出特征参数权重 共13组,每组100个</span>
<span class="token triple-quoted-string string">'''
array([[-1.47798400e-01,  5.10610191e-01, -3.90715477e-01],
		...,
       [ 1.45191397e-01, -1.70913407e-04, -1.24056580e-01]])
'''</span>
</code></pre> 
<h3><a id="106_k__5415"></a>10.6 非监督学习的代表----k 均值聚类</h3> 
<h4><a id="1061__5416"></a>10.6.1 聚类的基本概念</h4> 
<p>聚类关键是如何度量对象间的相似性<br> 簇 (Cluster)是一组数据对象的集合, 同一个簇内对象彼此相似, 不同簇直接尽可能相异, 且没有预先定义的类.</p> 
<h4><a id="1062__5419"></a>10.6.2 簇的划分</h4> 
<h4><a id="1063_k__5420"></a>10.6.3 k 均值聚类算法核心</h4> 
<p>初始簇中心 (也称质心)的选取及距离的度量.</p> 
<ol><li>随机选取 k 个点作为初始中心,</li><li>把每个对象分配给距离中心最近的簇</li><li>更近簇的均值, 选定新中心</li><li>重新分配各个点的簇归属</li><li>更新簇的均值, 选定新中心</li><li>重新分配各个点的簇归属</li><li>不断迭代<br> 直到满足条件才停止计算, 一般为函数收敛 (比如前后两次迭代的簇中心足够接近)或计算达到一定迭代次数.</li></ol> 
<p>其他常用方法挑选初始簇中心</p> 
<ul><li>多次运行调优, 每次使用一组不同的随机初始簇中心, 最后从中选取具有最小平方误差的簇集. 方法简单, 但效果难料, 主要取决于数据集的大小和簇的个数 k.</li><li>根据历史经验来决定 k</li></ul> 
<p>我们可以用欧式距离来度量两个样本之间的距离, 对于非欧式空间, 可以选择 Jaccard 距离, Cosine 距离, 或 Edit 距离等</p> 
<h4><a id="1064_k__5436"></a>10.6.4 k 均值聚类算法优缺点</h4> 
<p>优点: 原理简单, 易于操作, 执行效率高.<br> 缺点:</p> 
<ol><li>k 值需要事先给出<br> 极端情况: 每个样本各自为一个单独的簇, 此时样本的整体误差为 0. 我们可以引入结构风险, 对模型的复杂度进行惩罚.</li><li>聚类质量对初始簇中心的选取有很强的依赖性<br> 目标函数是求各个点到簇中心的距离平方和最小, 是一个凸函数, 往往会导致聚类出现很多局部最小值, 进而导致聚类陷入局部最小而非全局最小的局面.</li><li>对噪音数据比较敏感, 聚类结果容易受噪音数据的影响.</li><li>只能发现球形簇, 对于其他形状的簇无能为力</li></ol> 
<h4><a id="1065__sklearn__k__5445"></a>10.6.5 基于 sklearn 的 k 均值聚类实战</h4> 
<ul><li>make_blobs 聚类数据生成器<br> 先用 make_blobs 来合成所需的数据. 它常被用来生成聚类算法的测试数据.</li></ul> 
<pre><code class="prism language-python">make_blobs<span class="token punctuation">(</span>
    n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>
    n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">#默认两个特征</span>
    <span class="token operator">*</span><span class="token punctuation">,</span>
    centers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    cluster_std<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span><span class="token comment"># 每个簇(类别)的方差</span>
    center_box<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    random_state<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    return_centers<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>n_samples 是待生成的样本总数<br> n_features 是每个样本的特征数量<br> centers 表示要生成的样本中心 (类别)数, 或是确定的中心点数量, 默认为 3<br> 该方法有两个返回值. X 返回维度为 <code>[n_samples, n_features]</code> 的特征数据, y 返回维度为 <code>[n_samples]</code> 的标签数据. 该方法也可以运用在监督学习的分类算法中, 因为他也提供了标签 (分类)信息.</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs 
blobs <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>centers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment"># blobs是一个包含(X,y)的元组,默认两个特征</span>
X_blobs <span class="token operator">=</span> blobs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
y_blobs <span class="token operator">=</span> blobs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c <span class="token operator">=</span> y_blobs<span class="token punctuation">)</span><span class="token comment"># 取第一列第二列样本</span>
<span class="token comment"># X_blobs有两个特征</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>返回的标签信息, 可以在绘图时用于区分不同簇</p> 
<p>KMeans 原型</p> 
<pre><code class="prism language-python">KMeans<span class="token punctuation">(</span>
    n_clusters<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment"># 代表簇中心的个数</span>
    <span class="token operator">*</span><span class="token punctuation">,</span>
    init<span class="token operator">=</span><span class="token string">'k-means++'</span><span class="token punctuation">,</span> <span class="token comment"># 初始化方法</span>
    n_init<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment"># 初始化的次数.模型会根据多次初始化不同的簇中心得到不同的结果,并择优选定</span>
    max_iter<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token comment"># 得到最终簇中心的迭代次数</span>
    tol<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">,</span>
    verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
    random_state<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
    copy_x<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    algorithm<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>meshgrid 函数测试</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'r-.'</span><span class="token punctuation">,</span>marker <span class="token operator">=</span> <span class="token string">'.'</span><span class="token punctuation">,</span>markerfacecolor <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">,</span>markersize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>

x2<span class="token punctuation">,</span>y2 <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span>marker <span class="token operator">=</span> <span class="token string">'.'</span><span class="token punctuation">,</span>markersize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span>linestyle <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token comment">#线形为空,点与点之间不用线连接</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>导入 kmeans 工具包实施聚类分析</p> 
<pre><code class="prism language-python"><span class="token comment"># 导入kmeans工具包</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans
kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token comment"># 设置k = 4</span>
kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_blobs<span class="token punctuation">)</span>
<span class="token comment"># 绘制可视化图</span>
x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span>
y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span>
<span class="token comment"># 生成网格点矩阵</span>
xx<span class="token punctuation">,</span>yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span>x_max<span class="token punctuation">,</span><span class="token number">0.02</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span>y_max<span class="token punctuation">,</span><span class="token number">0.02</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 这里的x和y实际上是聚类的第一和第二个特征</span>
<span class="token comment"># xx.shape,yy.shape((872, 670), (872, 670))</span>
Z <span class="token operator">=</span> kmeans<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 将xx和yy展开成一维矩阵</span>
<span class="token comment"># c_相当于按列堆叠</span>

<span class="token comment"># 测试 np.c_[xx.ravel(), yy.ravel()].shape # (584240, 2)</span>
<span class="token comment"># 测试 872 * 670 = 584240</span>
Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment">#将Z重新塑造成xx的形状</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>clf<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>Z<span class="token punctuation">,</span>interpolation<span class="token operator">=</span><span class="token string">'hermite'</span><span class="token punctuation">,</span> extent<span class="token operator">=</span><span class="token punctuation">(</span>xx<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>xx<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>yy<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>yy<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           cmap <span class="token operator">=</span> plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>winter<span class="token punctuation">,</span>aspect <span class="token operator">=</span> <span class="token string">'auto'</span><span class="token punctuation">,</span> origin <span class="token operator">=</span> <span class="token string">'lower'</span><span class="token punctuation">)</span>
<span class="token comment"># interpolation：插值方法。用于控制图像的平滑程度和细节程度。可以选择nearest、bilinear、bicubic等插值方法。</span>
<span class="token comment"># extent：控制显示的数据范围。可以设置为[xmin, xmax, ymin, ymax]</span>
<span class="token comment"># cmap：颜色映射。用于控制图像中不同数值所对应的颜色。可以选择内置的颜色映射，如gray、hot、jet等，也可以自定义颜色映射。</span>
<span class="token comment"># aspect调整为auto,就可以自适应大小</span>
<span class="token comment"># origin：坐标轴原点的位置。可以设置为upper或lower。</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_blobs<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'w.'</span><span class="token punctuation">,</span>markersize <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment"># 生成点</span>
<span class="token comment"># 用红色的x表示簇中心</span>
centroids <span class="token operator">=</span> kmeans<span class="token punctuation">.</span>cluster_centers_ <span class="token comment"># 获取中心点的数组</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centroids<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>centroids<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">,</span>s <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">,</span>linewidths<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>color <span class="token operator">=</span> <span class="token string">'r'</span><span class="token punctuation">,</span>zorder <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 没写参数没有用</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/217355c3534de27db5368f2dfd230d4a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Apollo配置中心搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9414cbbd5109e7ae6edc1b3f88125d22/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu20.04安装ROS2&#43;ROS2-PX4框架搭建</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>