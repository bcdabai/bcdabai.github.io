<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>网络编程中常见问题以及解决思路 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="网络编程中常见问题以及解决思路" />
<meta property="og:description" content=" 最近在帮老师做一个P2P的项目，客户端包含注册以及登陆功能，关于数据库的选择，尝鲜采用了最新的mongoDB，但是在运行简单的demo的时候依然出现了许多的问题。文章会逐渐跟新，在我有时间的前提下：
关于RST ACK 本地测试正常，部署到服务器发现TCP通信出现故障，本机操作系统win10，服务器内核版本如下图所示： 在windows powershell运行程序发现出现socket.send()方法的错误，凡是网络问题就少不了抓包分析了~，本机采用wireshark进行抓包如下所示： 这里可以看到本机发送SYN（请问你有空么？）立马收到了服务器的回绝RST（没有！）。服务器上采用TCPDUMP指令进行抓包的时候也发现了问题的所在，能收到WINDOWS发来的SYN包，但是立马进行了不暇思索的回绝。 我们常见发送RST的情况有以下几种： 1、服务器端口没有打开 2、超时 3、缓存区中有内容未读取完全
这里的问题很容易定位，因为包中并未包含时间异常信息，直接在Windows10 上telnet检测端口通不通就好，（然后发现不通。 SYN(有空吗？)——&gt;ACK,SYN（有空啊，你呢？）——&gt;SYN（我也有空~）
最近还有一个很坑的地方就是多线程了~多线程中1、锁与2、阻塞 都是十分重要的概念，对应于python的join()方法以及lock()锁机制。最近一个常见的EOF报错就是因为主线程线性退出，留下子线程在独自运行，获取不到读入数据。这里可以采用join()方法，将子线程加入其中：
def Send(sock): while True: data = raw_input(&#39;&gt;&#39;) sock.send(data) if data ==&#39;exit&#39;: print &#39;连接结束&#39; break sock.close() def Recv(sock): while True: data = sock.recv(BUFFSIZE) if data == &#39;exit&#39;: break print data sock.close() def main(): s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect(ADDR) ts=Thread(target=Recv,args=(s,)) ts.start() tr=Thread(target=Send,args=(s,)) tr.start() tr.join() if __name__=``` &#34;__main__&#34;: main() " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e5bad5b9a2df969a37a73d63e90b7f9f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-09-08T10:37:14+08:00" />
<meta property="article:modified_time" content="2017-09-08T10:37:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">网络编程中常见问题以及解决思路</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>最近在帮老师做一个P2P的项目，客户端包含注册以及登陆功能，关于数据库的选择，尝鲜采用了最新的mongoDB，但是在运行简单的demo的时候依然出现了许多的问题。文章会逐渐跟新，在我有时间的前提下：</p> 
<h4 id="关于rst-ack">关于RST ACK</h4> 
<pre><code>本地测试正常，部署到服务器发现TCP通信出现故障，本机操作系统win10，服务器内核版本如下图所示：
</code></pre> 
<p><img title="" alt="这里写图片描述" src="https://images2.imgbox.com/17/b3/8BAvAHtH_o.png"></p> 
<pre><code>在windows powershell运行程序发现出现socket.send()方法的错误，凡是网络问题就少不了抓包分析了~，本机采用wireshark进行抓包如下所示：
</code></pre> 
<p><img title="" alt="抓包问题" src="https://images2.imgbox.com/1f/fc/aFLDS1Ue_o.png"></p> 
<pre><code>这里可以看到本机发送SYN（请问你有空么？）立马收到了服务器的回绝RST（没有！）。服务器上采用TCPDUMP指令进行抓包的时候也发现了问题的所在，能收到WINDOWS发来的SYN包，但是立马进行了不暇思索的回绝。
</code></pre> 
<p><img title="" alt="抓包" src="https://images2.imgbox.com/8b/f0/U6CPA2N1_o.png"></p> 
<p>我们常见发送RST的情况有以下几种： <br> 1、服务器端口没有打开 <br> 2、超时 <br> 3、缓存区中有内容未读取完全</p> 
<pre><code>这里的问题很容易定位，因为包中并未包含时间异常信息，直接在Windows10 上telnet检测端口通不通就好，（然后发现不通。
</code></pre> 
<p><img title="" alt="这里写图片描述" src="https://images2.imgbox.com/4f/df/ObaHol3a_o.png"></p> 
<p>SYN(有空吗？)——&gt;ACK,SYN（有空啊，你呢？）——&gt;SYN（我也有空~）</p> 
<p>最近还有一个很坑的地方就是多线程了~多线程中1、锁与2、阻塞 都是十分重要的概念，对应于python的join()方法以及lock()锁机制。最近一个常见的EOF报错就是因为主线程线性退出，留下子线程在独自运行，获取不到读入数据。这里可以采用join()方法，将子线程加入其中：</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Send</span><span class="hljs-params">(sock)</span>:</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        data = raw_input(<span class="hljs-string">'&gt;'</span>)
        sock.send(data)
        <span class="hljs-keyword">if</span> data ==<span class="hljs-string">'exit'</span>:
            <span class="hljs-keyword">print</span> <span class="hljs-string">'连接结束'</span>
            <span class="hljs-keyword">break</span>
    sock.close()
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Recv</span><span class="hljs-params">(sock)</span>:</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        data = sock.recv(BUFFSIZE)
        <span class="hljs-keyword">if</span> data == <span class="hljs-string">'exit'</span>:
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">print</span> data
    sock.close()


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span> 
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(ADDR)
    ts=Thread(target=Recv,args=(s,))
    ts.start()

    tr=Thread(target=Send,args=(s,))
    tr.start()
    tr.join()
<span class="hljs-keyword">if</span> __name__=```
<span class="hljs-string">"__main__"</span>:
    main()</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ef10457f8bf050e170a5231285c9af89/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">h5新特性localstorage的简单应用（记住登录名和密码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1dd1d19aa9e6c5c8d62be77e0f23c522/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Tortoise小乌龟SVN回滚到之前的提交版本，即如何撤销此次提交操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>