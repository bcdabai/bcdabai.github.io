<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一起学ORBSLAM2（5）ORBSLAM的单目视觉处理方式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一起学ORBSLAM2（5）ORBSLAM的单目视觉处理方式" />
<meta property="og:description" content="转载请注明原创地址： https://blog.csdn.net/qq_30356613/article/category/6897125 单目相机由于深度是未知的，因此我们需要对其进行初始化，在 ORB-SLAM 中将其用单独的类来表示，并将它写成单独的文件 initializer.cc，注意单目相机即使在进行初始化之后，仍然存在尺度问题，初始化将第一帧的位移作为单位长度，后面的深度和位移都是依据这一标准进行的，所以尺度问题是单目 slam 的理论缺点。 单目 slam 初始化需要两帧进行，第一帧作为参考初始化帧，第二帧作为当前帧。在第一帧来临时建立初始化器，并将该帧的特征点存储起来，初始化器Initializer的构造函数中有三个参数，分别是初始化参考帧的引用，标准差 sigma 和 RANSAC 迭代次数 iterations （选择 8 点时使用）， initializer.cc 只存在一个外部调用函数 initialize() ，此函数通过计算当前帧的相机位姿和匹配点对应的 3D 点来对单目 slam 初始化。初始化中通过 RANSAC 的方法来优化初始化的效果，用 8 点法来同步计算单应性矩阵 H 和基础矩阵 F ，从而计算出两者分别的得分，得分方式是通过计算投影误差的和来确定。得分越高证明当下模型下的矩阵越可信，然后选择得分高的矩阵进行分解，从而得到相机位姿和三维匹配点。 其中主要涉及到的算法分别是：8点-DLT方法计算基础矩阵，8点-DLT方法计算单应矩阵，根据基础矩阵分解得到相机位姿和3D匹配点，根据单应矩阵分解得到相机位姿和3D匹配点。
一、8点DLT方法计算基础矩阵：
（参考高翔slam14讲）
首先应明白基础矩阵的几何意义是什么？它解决的问题是如何通过两幅图像中的像素匹配点来估算两幅图像点的变换矩阵F（基础矩阵）。
设的空间位置为：,在两帧图像中的像素坐标分别为：
则有：，这里K为相机内参数矩阵，R，t为旋转矩阵和平移矩阵。
取齐次坐标有: 取，这里x1，x2是两个像素点的归一化平面上的坐标。代入上式得：
两边同时左乘，得到：
两边同时左乘，得到：
将p1，p2带入上式得到：
从而得到对极约束的代数表示，其中为基础矩阵F，为本质矩阵E
然后根据8点法求解本质矩阵E，进而求解基础矩阵F
设,分别是匹配点的归一化坐标，，并将E写成向量形式则有：
用SVD方法求解上述方程，E的解对应的是最小奇异值对应的奇异向量，证明过程参考《Multiple view geometry in computer vision》.page592 A5.3
由此求得本质矩阵E，进而求取基础矩阵F
二、本质矩阵分解得到旋转矩阵R和平移向量t
（参考 multiple view geometry in computer vision 9.6节的相关知识）
上个算法中通过8点法得到了本质矩阵E，但实际上本质矩阵需要满足自身的约束，对于一个本质矩阵E来讲，它的奇异值有两个相等，并且第三个为零。证明如下：
上面可以看出，其中S是向量t对应的反对称矩阵，形式如下：设t(t1,t2,t3)
则，而却对于任意的反对称矩阵S，我们都有如下结论：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/adeb42383901914501bec16c943e0d6d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-06-05T21:49:25+08:00" />
<meta property="article:modified_time" content="2018-06-05T21:49:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一起学ORBSLAM2（5）ORBSLAM的单目视觉处理方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="text-align:left;"> 
 <span style="font-size:18px;">转载请注明原创地址：</span> 
 <span style="font-size:18px;">https://blog.csdn.net/qq_30356613/article/category/6897125</span> 
 <br> 
</div> 
<div style="text-align:left;">
  单目相机由于深度是未知的，因此我们需要对其进行初始化，在 
 <span style="font-family:Calibri;">ORB</span>-SLAM 
 <span style="font-family:'宋体';">中将其用单独的类来表示</span>，并将它写成单独的文件 
 <span style="font-family:Calibri;">initializer.cc</span>，注意单目相机即使在进行初始化之后，仍然存在尺度问题，初始化将第一帧的位移作为单位长度，后面的深度和位移都是依据这一标准进行的，所以尺度问题是单目 
 <span style="font-family:Calibri;">slam</span> 
 <span style="font-family:'宋体';">的理论缺点。</span> 
</div> 
<div style="text-align:left;">
  单目 
 <span style="font-family:Calibri;">slam</span> 
 <span style="font-family:'宋体';">初始化需要两帧进行</span>，第一帧作为参考初始化帧，第二帧作为当前帧。在第一帧来临时建立初始化器，并将该帧的特征点存储起来，初始化器Initializer的构造函数中有三个参数，分别是初始化参考帧的引用，标准差 
 <span style="font-family:Calibri;">sigma</span> 
 <span style="font-family:'宋体';">和</span> 
 <span style="font-family:Calibri;">RANSAC</span> 
 <span style="font-family:'宋体';">迭代次数</span> 
 <span style="font-family:Calibri;">iterations</span> 
 <span style="font-family:'宋体';">（选择</span> 
 <span style="font-family:Calibri;">8</span> 
 <span style="font-family:'宋体';">点时使用），</span> 
 <span style="font-family:Calibri;">initializer</span>.cc 
 <span style="font-family:'宋体';">只存在一个外部调用函数</span> 
 <span style="font-family:Calibri;">initialize</span>() 
 <span style="font-family:'宋体';">，此函数通过计算当前帧的相机位姿和匹配点对应的</span> 
 <span style="font-family:Calibri;">3D</span> 
 <span style="font-family:'宋体';">点来对单目</span> 
 <span style="font-family:Calibri;">slam</span> 
 <span style="font-family:'宋体';">初始化。初始化中通过</span> 
 <span style="font-family:Calibri;">RANSAC</span> 
 <span style="font-family:'宋体';">的方法来优化初始化的效果，用</span> 
 <span style="font-family:Calibri;">8</span> 
 <span style="font-family:'宋体';">点法来同步计算单应性矩阵</span> 
 <span style="font-family:Calibri;">H</span> 
 <span style="font-family:'宋体';">和基础矩阵</span> 
 <span style="font-family:Calibri;">F</span> 
 <span style="font-family:'宋体';">，从而计算出两者分别的得分，得分方式是通过计算投影误差的和来确定。得分越高证明当下模型下的矩阵越可信，然后选择得分高的矩阵进行分解，从而得到相机位姿和三维匹配点。</span> 
</div> 
<p></p> 
<p style="text-align:left;">其中主要涉及到的算法分别是：<span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">点</span><span style="font-family:Calibri;">-</span>DLT<span style="font-family:'宋体';">方法计算基础矩阵</span>，<span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">点</span><span style="font-family:Calibri;">-</span>DLT<span style="font-family:'宋体';">方法计算单应矩阵</span>，根据基础矩阵分解得到相机位姿和<span style="font-family:Calibri;">3D</span><span style="font-family:'宋体';">匹配点</span>，根据单应矩阵分解得到相机位姿和3D<span style="font-family:'宋体';">匹配点。</span></p> 
<p></p> 
<p style="text-align:left;"><strong>一、<span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">点</span><span style="font-family:Calibri;">DLT</span><span style="font-family:'宋体';">方法计算基础矩阵：</span></strong></p> 
<p style="text-align:left;">（参考高翔slam14讲）</p> 
<p style="text-align:left;">首先应明白基础矩阵的几何意义是什么？它解决的问题是如何通过两幅图像中的像素匹配点来估算两幅图像点的变换矩阵<span style="font-family:Calibri;">F</span><span style="font-family:'宋体';">（基础矩阵）。</span></p> 
<p style="text-align:left;">设的空间位置为：<img src="https://images2.imgbox.com/1f/e9/BLnZm0Mi_o.png" alt="">,<span style="font-family:'宋体';">在两帧图像中的像素坐标分别为</span>：<img src="https://images2.imgbox.com/c8/20/HtohkVnt_o.png" alt=""></p> 
<p style="text-align:left;">则有：<img src="https://images2.imgbox.com/f4/4d/5b4gY5oF_o.png" alt="">，这里K<span style="font-family:'宋体';">为相机内参数矩阵，</span><span style="font-family:Calibri;">R</span><span style="font-family:'宋体';">，</span><span style="font-family:Calibri;">t</span><span style="font-family:'宋体';">为旋转矩阵和平移矩阵。</span></p> 
<p style="text-align:left;">取齐次坐标有: <img src="https://images2.imgbox.com/42/65/tSnvGqhX_o.png" alt=""></p> 
<p></p> 
<p style="text-align:left;">取<img src="https://images2.imgbox.com/a5/9f/CPWCzRIt_o.png" alt="">，这里<span style="font-family:Calibri;">x1</span>，x2<span style="font-family:'宋体';">是两个像素点的归一化平面上的坐标</span>。代入上式得：<img src="https://images2.imgbox.com/2b/ad/ViENiO9I_o.png" alt=""></p> 
<p style="text-align:left;">两边同时左乘<img src="https://images2.imgbox.com/d2/ac/UiL3Xe9L_o.png" alt="">，得到：<img src="https://images2.imgbox.com/7d/db/d6qUgs9X_o.png" alt=""></p> 
<p style="text-align:left;">两边同时左乘<img src="https://images2.imgbox.com/ef/1f/VXxeNvX4_o.png" alt="">，得到：<img src="https://images2.imgbox.com/23/fa/SjpcuTrw_o.png" alt=""></p> 
<p style="text-align:left;">将<span style="font-family:Calibri;">p1</span>，p2<span style="font-family:'宋体';">带入上式得到</span>：<img src="https://images2.imgbox.com/1b/da/SIg7n1AG_o.png" alt=""></p> 
<p style="text-align:left;">从而得到对极约束的代数表示，其中<img src="https://images2.imgbox.com/87/ce/lea0AMRk_o.png" alt="">为基础矩阵F<span style="font-family:'宋体';">，<img src="https://images2.imgbox.com/65/4c/2mAVY0c2_o.png" alt=""></span>为本质矩阵E</p> 
<p style="text-align:left;">然后根据8<span style="font-family:'宋体';">点法求解本质矩阵</span><span style="font-family:Calibri;">E</span><span style="font-family:'宋体';">，进而求解基础矩阵</span><span style="font-family:Calibri;">F</span></p> 
<p style="text-align:left;">设<img src="https://images2.imgbox.com/40/5c/679s0y7H_o.png" alt="">,<img src="https://images2.imgbox.com/9f/5e/ePoGaXuF_o.png" alt="">分别是匹配点的归一化坐标，<img src="https://images2.imgbox.com/0c/a5/dqG0jWxa_o.png" alt="">，并将<span style="font-family:Calibri;">E</span><span style="font-family:'宋体';">写成向量形式<img src="https://images2.imgbox.com/ff/04/Hvn4NRHn_o.png" alt=""></span>则有：</p> 
<p style="text-align:left;"><img src="https://images2.imgbox.com/ec/51/lJhlM34E_o.png" alt=""></p> 
<p></p> 
<div style="text-align:left;">
    
</div> 
<p style="text-align:left;">用<span style="font-family:Calibri;">SVD</span><span style="font-family:'宋体';">方法求解上述方程，</span>E<span style="font-family:'宋体';">的解对应的是最小奇异值对应的奇异向量</span>，证明过程参考《Multiple view geometry in computer vision》.page592 A5.3</p> 
<div style="text-align:left;"> 
 <img src="https://images2.imgbox.com/7d/00/w8YLHa3Q_o.png" alt=""> 
 <br> 
</div> 
<div style="text-align:left;"> 
 <p>由此求得本质矩阵<span style="font-family:Calibri;">E</span><span style="font-family:'宋体';">，进而求取基础矩阵</span><span style="font-family:Calibri;">F</span></p> 
 <p><strong>二、本质矩阵分解得到旋转矩阵<span style="font-family:Calibri;">R</span><span style="font-family:'宋体';">和平移向量</span><span style="font-family:Calibri;">t</span></strong></p> 
 <p>（参考 <span style="font-family:Calibri;">multiple</span> view geometry in computer vision 9.6<span style="font-family:'宋体';">节的相关知识）</span></p> 
 <p>上个算法中通过<span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">点法得到了本质矩阵</span><span style="font-family:Calibri;">E</span><span style="font-family:'宋体';">，但实际上本质矩阵需要满足自身的约束，对于一个本质矩阵</span><span style="font-family:Calibri;">E</span><span style="font-family:'宋体';">来讲，它的奇异值有两个相等，并且第三个为零。证明如下：</span></p> 
 <p>上面可以看出<img src="https://images2.imgbox.com/50/9f/pKXWrRbu_o.png" alt="">，其中S<span style="font-family:'宋体';">是向量</span><span style="font-family:Calibri;">t</span><span style="font-family:'宋体';">对应的反对称矩阵，形式如下：设</span><span style="font-family:Calibri;">t</span>(t1,t2,t3)</p> 
 <p>则<img src="https://images2.imgbox.com/94/bb/vhtPBLzy_o.png" alt="">，而却对于任意的反对称矩阵S<span style="font-family:'宋体';">，我们都有如下结论：</span></p> 
 <p>如果一个实反对称矩阵<span style="font-family:Calibri;">S</span>，则可以将S分解为<img src="https://images2.imgbox.com/e9/3e/iSCLSE6T_o.png" alt="">,B<span style="font-family:'宋体';">是一个对角块矩阵</span>，<img src="https://images2.imgbox.com/af/39/erv4H4AO_o.png" alt="">,<span style="font-family:'宋体';">这里<img src="https://images2.imgbox.com/8e/4e/Lv2j4kP4_o.png" alt=""></span>,<span style="font-family:'宋体';">并且</span>S<span style="font-family:'宋体';">的特征值是纯虚数，奇数阶的反对称矩阵是奇异的。</span></p> 
 <p>因此，<span style="font-family:Calibri;">S</span><span style="font-family:'宋体';">可以分解为：<img src="https://images2.imgbox.com/c5/bb/cS6dDU0O_o.png" alt=""></span>（<span style="font-family:Calibri;">1</span><span style="font-family:'宋体';">）</span>,<span style="font-family:'宋体';">这里的</span>U<span style="font-family:'宋体';">是正交的，<img src="https://images2.imgbox.com/ed/dd/tYCytGGL_o.png" alt=""></span></p> 
 <p>引入正交矩阵<img src="https://images2.imgbox.com/f4/d3/beLPzWFa_o.png" alt="">，可以得到<img src="https://images2.imgbox.com/58/52/MahuUTe6_o.png" alt="">（<span style="font-family:Calibri;">2</span><span style="font-family:'宋体';">）</span></p> 
 <p>不计尺度得到：<img src="https://images2.imgbox.com/4f/31/vNCeWjwL_o.png" alt="">，从而有<img src="https://images2.imgbox.com/0c/96/AKXBXpyr_o.png" alt=""></p> 
 <p>由于W,U,R<span style="font-family:'宋体';">都是正交矩阵</span>，因此<img src="https://images2.imgbox.com/e9/31/UMcudrdR_o.png" alt="">也为正交矩阵，故可以令<img src="https://images2.imgbox.com/5a/80/gASf4SR7_o.png" alt=""></p> 
 <p>从而得到<img src="https://images2.imgbox.com/b5/5b/8fJrtDEP_o.png" alt="">，故本质矩阵的奇异值为<span style="font-family:Calibri;">1</span>,1,0</p> 
 <p>其中根据（<span style="font-family:Calibri;">1</span><span style="font-family:'宋体';">）可得<img src="https://images2.imgbox.com/8f/31/LZD23uv1_o.png" alt=""></span></p> 
 <p>R<span style="font-family:'宋体';">是一个旋转矩阵可以被写成<img src="https://images2.imgbox.com/97/e3/LEuED1YR_o.png" alt=""></span>,<span style="font-family:'宋体';">从而有</span>：<img src="https://images2.imgbox.com/50/5c/3TrcWDSU_o.png" alt=""></p> 
 <p>其中<img src="https://images2.imgbox.com/54/d1/WoWiwc50_o.png" alt="">，由上式（<span style="font-family:Calibri;">2</span><span style="font-family:'宋体';">）得到<img src="https://images2.imgbox.com/d0/f9/jaP4tW8s_o.png" alt=""></span>所以<img src="https://images2.imgbox.com/8b/27/PRknzFt0_o.png" alt="">或者<img src="https://images2.imgbox.com/70/d7/1byo221P_o.png" alt=""></p> 
 <p>由此可得到：<img src="https://images2.imgbox.com/78/17/4CBM9ZTF_o.png" alt="">或<img src="https://images2.imgbox.com/8d/41/FFFiGFR5_o.png" alt=""></p> 
 <p>由于<img src="https://images2.imgbox.com/eb/c9/B9KPmEqy_o.png" alt="">，并且有<img src="https://images2.imgbox.com/ed/1e/SprtmJyX_o.png" alt="">,<span style="font-family:'宋体';">因此存在<img src="https://images2.imgbox.com/ef/02/ulXf7K9H_o.png" alt=""></span>的约束</p> 
 <p>同时<img src="https://images2.imgbox.com/89/bf/tlCsvKBy_o.png" alt="">，在<img src="https://images2.imgbox.com/74/b7/WvUN80bL_o.png" alt="">约束下计算该方程的解，用SVD<span style="font-family:'宋体';">方法可以得到</span><span style="font-family:Calibri;">t</span><span style="font-family:'宋体';">对应的解是</span><span style="font-family:Calibri;">S</span><span style="font-family:'宋体';">最小特征值对应的特征向量，即<img src="https://images2.imgbox.com/c8/76/XcJQYxrN_o.png" alt=""></span></p> 
 <p>证明参考<span style="font-family:Calibri;">multiple view geometry in computer vision A5.3 P592  </span><span style="font-family:'宋体';">如下</span>：</p> 
 <p>由于U<span style="font-family:'宋体';">是酉矩阵，根据范数的酉不变性因此存在<img src="https://images2.imgbox.com/8d/4b/SKJR7L2Q_o.png" alt=""></span>，并且存在<img src="https://images2.imgbox.com/9d/9c/ploO7Wxu_o.png" alt="">，我们需要极小化<img src="https://images2.imgbox.com/a2/93/aJyPPMTS_o.png" alt="">，在遵从<img src="https://images2.imgbox.com/d4/4d/b4vnJpza_o.png" alt="">的情况下，令<img src="https://images2.imgbox.com/84/c2/SPNwtKON_o.png" alt="">，因此有<img src="https://images2.imgbox.com/b4/23/vy1cWPsR_o.png" alt="">，由于<img src="https://images2.imgbox.com/30/1e/2GEbuRWk_o.png" alt="">，并且<img src="https://images2.imgbox.com/cc/d2/wvk1Hio4_o.png" alt="">，所以有<img src="https://images2.imgbox.com/4c/70/dzXA7ml7_o.png" alt="">，<img src="https://images2.imgbox.com/93/73/DQ1xLhtG_o.png" alt="">，得到<img src="https://images2.imgbox.com/6f/b2/u8k2IQQJ_o.png" alt=""></p> 
 <p>因此得到<span style="font-family:Calibri;">x</span><span style="font-family:'宋体';">的解为</span>U<span style="font-family:'宋体';">的最后一行，即</span><span style="font-family:Calibri;">U</span><span style="font-family:'宋体';">的最小向量。证闭。</span></p> 
 <p>上述可以得到<img src="https://images2.imgbox.com/c3/28/mdyfBXOL_o.png" alt="">，但是符号并不能确定，所以<span style="font-family:Calibri;">t</span>，<span style="font-family:Calibri;">-</span>t</p> 
 <p>综上可得，<span style="font-family:Calibri;">E</span><span style="font-family:'宋体';">可以被分解为四种结果，分别为：</span></p> 
 <p> <img src="https://images2.imgbox.com/dc/2f/HSm94PZa_o.png" alt=""></p> 
 <p>将其用几何的形式表示得到：</p> 
 <p><img src="https://images2.imgbox.com/47/b4/g4buTHl9_o.png" alt=""> </p> 
 <p>其中<span style="font-family:Calibri;">bcd</span><span style="font-family:'宋体';">图有负的深度值</span>，因此可以舍去，只要<span style="font-family:Calibri;">a</span><span style="font-family:'宋体';">图符合要求</span>。</p> 
 <p>所以根据在两个相机坐标系下坐标点的深度可以筛选出正确的结果，从而得到唯一正确R<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">t</span></p> 
 <p><strong>三、<span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">点</span><span style="font-family:Calibri;">DLT</span><span style="font-family:'宋体';">方法计算单应矩阵</span><span style="font-family:Calibri;">H</span><span style="font-family:'宋体';">：</span></strong></p> 
 <p>（参考<span style="font-family:Calibri;">multiple</span> view geometry in computer vision <span style="font-family:'宋体';">第四章</span> P89<span style="font-family:'宋体';">）</span></p> 
 <p>单应性矩阵与基础矩阵的不同在于，单应性矩阵是针对平面上点集合来讲的，而基础矩阵基于三维点集合来讲</p> 
 <p>对于二维到二维的点集<img src="https://images2.imgbox.com/39/ec/hw3R9eGq_o.png" alt="">，有<img src="https://images2.imgbox.com/d5/90/7CtNfLPd_o.png" alt="">，注意到这里的齐次性，因此我们有：<img src="https://images2.imgbox.com/ec/02/EXwDdZ7d_o.png" alt=""></p> 
 <p><img src="https://images2.imgbox.com/99/c8/cqkqodSB_o.png" alt="">，<img src="https://images2.imgbox.com/68/9e/iTNVcYnH_o.png" alt="">  所以存在：<img src="https://images2.imgbox.com/b0/c0/yRbjMhz7_o.png" alt="">，提取为矩阵的形式为：<img src="https://images2.imgbox.com/6c/f4/MnrtrI8u_o.png" alt=""></p> 
 <p>由于上式矩阵质为2<span style="font-family:'宋体';">，因此只有两个不相关的向量，因此针对每一对匹配点，都有：</span></p> 
 <p><img src="https://images2.imgbox.com/2b/52/OlsIBYyS_o.png" alt="">，<img src="https://images2.imgbox.com/77/77/AAN6TAkP_o.png" alt="">注意到到这里的为9<span style="font-family:'宋体';">维向量，</span><span style="font-family:Calibri;">9</span><span style="font-family:'宋体';">个自由度，由于尺度因此有</span><span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">个自由度，</span>因此4<span style="font-family:'宋体';">个点对就能得到</span><span style="font-family:Calibri;">h</span><span style="font-family:'宋体';">的解，根据</span><span style="font-family:Calibri;">SVD</span><span style="font-family:'宋体';">方法可以得出。参考上面</span><span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">点法求基础矩阵中</span><span style="font-family:Calibri;">SVD</span><span style="font-family:'宋体';">方法。由此求得单应矩阵</span><span style="font-family:Calibri;">H</span></p> 
 <p><strong>四、单应矩阵分解得到旋转矩阵<span style="font-family:Calibri;">R</span><span style="font-family:'宋体';">和平移向量</span><span style="font-family:Calibri;">t</span></strong></p> 
 <p>（参考文章：<span style="font-family:Calibri;">Motion and Structure from Motion in a Piecewise Planar Environment</span><span style="font-family:'宋体';">）</span></p> 
 <p>（同时参考吴博注释版的<span style="font-family:Calibri;">ORBSLAM</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">PPT</span><span style="font-family:'宋体';">）</span></p> 
 <p> <img src="https://images2.imgbox.com/c0/a4/xAinmlau_o.png" alt=""></p> 
 <p> <img src="https://images2.imgbox.com/89/3b/ljrOFXX6_o.png" alt=""></p> 
 <p><img src="https://images2.imgbox.com/8e/df/yIqq5Tvm_o.png" alt=""><br></p> 
 <p><img src="https://images2.imgbox.com/51/45/aWReVLjc_o.png" alt=""><br></p> 
 <p> <img src="https://images2.imgbox.com/69/19/9k5feWZy_o.png" alt=""></p> 
 <p><img src="https://images2.imgbox.com/d4/b8/su5gJXKk_o.png" alt=""> </p> 
 <p><img src="https://images2.imgbox.com/a2/a8/7qpnf3w5_o.png" alt=""> </p> 
 <p><img src="https://images2.imgbox.com/1e/75/okyNGAhK_o.png" alt=""> </p> 
 <p><br></p> 
 <p>从而得到R<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">t</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">8</span><span style="font-family:'宋体';">种组合，然后根据匹配点在相机坐标系下的深度值以及重投影误差来得到一组最优值，从而结算出当前相机位姿。</span></p> 
 <p> </p> 
 <p><strong>五、三角测量得到匹配三维点坐标</strong></p> 
 <p>通过基础矩阵和单应性矩阵求解相机位姿过程中并没有利用到匹配点的三维点坐标，但在SLAM<span style="font-family:'宋体';">中的建图下计算匹配点的三维坐标是必要的，因此，我们用三角测量的方式来得到三维点坐标，如上所示，已经得到了相机的位姿</span><span style="font-family:Calibri;">R,t</span><span style="font-family:'宋体';">，而且相机的内参数矩阵是已知的，结合两者，我们可以得到由相机像素坐标到三维点坐标点的变换矩阵</span><span style="font-family:Calibri;">P=T*K</span><span style="font-family:'宋体';">，其中</span><span style="font-family:Calibri;">T</span><span style="font-family:'宋体';">是由</span><span style="font-family:Calibri;">R</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">t</span><span style="font-family:'宋体';">决定的相机位姿变换矩阵，</span><span style="font-family:Calibri;">K</span><span style="font-family:'宋体';">为相机的内参数矩阵。</span></p> 
 <p>因此对于每一匹配点我们都有<span style="font-family:Calibri;">x</span>=P*X，<span style="font-family:Calibri;">x</span>’=P’*X，x，x’<span style="font-family:'宋体';">分别为匹配点在帧</span>1<span style="font-family:'宋体';">和帧</span><span style="font-family:Calibri;">2</span><span style="font-family:'宋体';">的</span>像素坐标，<span style="font-family:Calibri;">P</span>,P’<span style="font-family:'宋体';">分别</span>为相机变换矩阵，由于存在尺度问题，因此，我们用齐次坐标进行求解，对于齐次坐标存在<span style="font-family:Calibri;">x</span><span style="font-family:'宋体';">叉乘</span>P*X，即：</p> 
 <p><img src="https://images2.imgbox.com/a6/60/ytNPkKdz_o.png" alt="">,<span style="font-family:'宋体';">其中<img src="https://images2.imgbox.com/39/da/X5gdrWmH_o.png" alt=""></span>，<img src="https://images2.imgbox.com/b6/b9/Jslj9EFV_o.png" alt="">，<img src="https://images2.imgbox.com/b1/49/4XnIpeSy_o.png" alt=""></p> 
 <p>令<img src="https://images2.imgbox.com/4d/d8/ruYDI2Oi_o.png" alt="">，从而得到：<img src="https://images2.imgbox.com/57/87/0MTFqpft_o.png" alt="">，即：<img src="https://images2.imgbox.com/11/17/KwU5x3UQ_o.png" alt=""></p> 
 <p>同理可以得到<img src="https://images2.imgbox.com/3e/e0/tUBUexxg_o.png" alt="">的表达式，结合两者得到：</p> 
 <p><img src="https://images2.imgbox.com/e1/e1/vlqtCNJ3_o.png" alt="">，通过SVD<span style="font-family:'宋体';">方法求解该方程组得到三维点坐标的齐次形式，然后将齐次坐标转化为非齐次坐标就得到了匹配点的三维点坐标。</span></p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <br> 
</div> 
<p style="text-align:left;"><br></p> 
<p style="text-align:left;"><br></p> 
<p style="text-align:left;"><br></p> 
<p style="text-align:left;"><br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/81ef2157053ae600ac8b0b07b7732756/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何判断微信公众号是否二次开发（一）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bee388ec09a679e6e0866482ae73c5d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一起学ORBSLAM2（6）ORBSLAM中的特征匹配</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>