<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>EasyExcel 批量导出 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="EasyExcel 批量导出" />
<meta property="og:description" content="文章目录 前言一、EasyExcel 导出封装二、食用步骤1.自定义excel样式2.导出数据 三、复杂excel导出3.1. 自定义复杂表头2. 多sheet 前言 上篇写了数据导入，本文补充一下EasyExcel 批量导出
包括常规excel和复杂excel
一、EasyExcel 导出封装 import com.alibaba.excel.EasyExcel; import com.alibaba.excel.ExcelWriter; import com.alibaba.excel.support.ExcelTypeEnum; import com.alibaba.excel.write.builder.ExcelWriterSheetBuilder; import com.alibaba.excel.write.handler.WriteHandler; import com.alibaba.excel.write.metadata.WriteSheet; import com.google.common.base.Charsets; import com.gsafety.bg.gsdss.common.contants.CommonConstants; import com.gsafety.bg.gsdss.common.exception.BusinessException; import lombok.extern.slf4j.Slf4j; import org.apache.commons.collections4.CollectionUtils; import org.apache.commons.lang3.StringUtils; import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor; import javax.servlet.http.HttpServletResponse; import java.io.OutputStream; import java.net.URLEncoder; import java.util.List; import java.util.Objects; import java.util.concurrent.CompletableFuture; import java.util.concurrent.atomic.AtomicReference; /** * AbstractExcelView */ @Slf4j public abstract class AbstractExcelView&lt;T&gt; { private String excelName; private ExcelTypeEnum excelType; private HttpServletResponse response; public AbstractExcelView(HttpServletResponse response, String excelName, ExcelTypeEnum excelType) { this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/995d6eca1ea3c69f1643cbc3be22b735/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-15T11:58:25+08:00" />
<meta property="article:modified_time" content="2023-06-15T11:58:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">EasyExcel 批量导出</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#EasyExcel__8" rel="nofollow">一、EasyExcel 导出封装</a></li><li><a href="#_148" rel="nofollow">二、食用步骤</a></li><li><ul><li><a href="#1excel_149" rel="nofollow">1.自定义excel样式</a></li><li><a href="#2_208" rel="nofollow">2.导出数据</a></li></ul> 
  </li><li><a href="#excel_258" rel="nofollow">三、复杂excel导出</a></li><li><ul><li><a href="#31__260" rel="nofollow">3.1. 自定义复杂表头</a></li><li><a href="#2_sheet_342" rel="nofollow">2. 多sheet</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_4"></a>前言</h2> 
<p>上篇写了数据导入，本文补充一下EasyExcel 批量导出<br> 包括常规excel和复杂excel</p> 
<h2><a id="EasyExcel__8"></a>一、EasyExcel 导出封装</h2> 
<pre><code>import com.alibaba.excel.EasyExcel;
import com.alibaba.excel.ExcelWriter;
import com.alibaba.excel.support.ExcelTypeEnum;
import com.alibaba.excel.write.builder.ExcelWriterSheetBuilder;
import com.alibaba.excel.write.handler.WriteHandler;
import com.alibaba.excel.write.metadata.WriteSheet;
import com.google.common.base.Charsets;
import com.gsafety.bg.gsdss.common.contants.CommonConstants;
import com.gsafety.bg.gsdss.common.exception.BusinessException;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.collections4.CollectionUtils;
import org.apache.commons.lang3.StringUtils;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import javax.servlet.http.HttpServletResponse;
import java.io.OutputStream;
import java.net.URLEncoder;
import java.util.List;
import java.util.Objects;
import java.util.concurrent.CompletableFuture;
import java.util.concurrent.atomic.AtomicReference;

/**
 * AbstractExcelView
 */
@Slf4j
public abstract class AbstractExcelView&lt;T&gt; {

    private String excelName;

    private ExcelTypeEnum excelType;

    private HttpServletResponse response;

    public AbstractExcelView(HttpServletResponse response, String excelName, ExcelTypeEnum excelType) {
        this.excelName = excelName;
        this.excelType = excelType;
        this.response = response;
    }

    protected OutputStream prepareResponse(HttpServletResponse response) throws Exception {
        response.setContentType(CommonConstants.CONTENT_TYPE_EXCEL);
        response.setCharacterEncoding(Charsets.UTF_8.name());
        response.setHeader("content-disposition", "attachment;filename=" + URLEncoder.encode(excelName, Charsets.UTF_8.name()) + excelType.getValue());
        return response.getOutputStream();
    }

    public void exportExcel() {
        ExcelWriter excelWriter = null;
        try {
            List&lt;Sheet&lt;T&gt;&gt; sheets = this.sheets();
            if (CollectionUtils.isEmpty(sheets)) {
                return;
            }
            excelWriter = EasyExcel.write(this.prepareResponse(response)).excelType(excelType).build();
            for (Sheet s : sheets) {
                ExcelWriterSheetBuilder sb = EasyExcel.writerSheet(s.getIndex(), s.getName()).head(s.getClz());
                if (CollectionUtils.isNotEmpty(s.getHandlers())) {
                    List&lt;WriteHandler&gt; l = s.getHandlers();
                    l.forEach(h -&gt; sb.registerWriteHandler(h));
                }
                if (CollectionUtils.isNotEmpty(this.sheetDynamicHead(s.getIndex()))){
                    sb.head(this.sheetDynamicHead(s.getIndex()));
                }
                excelWriter.write(this.sheetData(s.getIndex()), sb.build());
            }
        } catch (Exception e) {
            log.error(" 导出失败! ", e);
            throw new BusinessException(" 导出失败! ");
        } finally {
            if (Objects.nonNull(excelWriter)) {
                excelWriter.finish();
            }
        }
    }

    public String asyncExport(ThreadPoolTaskExecutor executor) {
        AtomicReference&lt;String&gt; result = new AtomicReference&lt;&gt;(StringUtils.EMPTY);
        ExcelWriter excelWriter = null;
        try {
            List&lt;Sheet&lt;T&gt;&gt; sheets = this.sheets();
            if (CollectionUtils.isEmpty(sheets)) {
                return result.get();
            }
            excelWriter = EasyExcel.write(this.prepareResponse(response)).excelType(excelType).build();
            WriteSheet[] writeSheets = sheets.stream().map(sheet -&gt; {
                ExcelWriterSheetBuilder sb = EasyExcel.writerSheet(sheet.getIndex(), sheet.getName())
                        .head(sheet.getClz());
                if (CollectionUtils.isNotEmpty(sheet.getHandlers())) {
                    List&lt;WriteHandler&gt; l = sheet.getHandlers();
                    l.forEach(h -&gt; sb.registerWriteHandler(h));
                }
                if (CollectionUtils.isNotEmpty(this.sheetDynamicHead(sheet.getIndex()))){
                    sb.head(this.sheetDynamicHead(sheet.getIndex()));
                }
                return sb.build();
            }).toArray(WriteSheet[]::new);
            ExcelWriter finalExcelWriter = excelWriter;
            CompletableFuture[] cfs = sheets.stream()
                    .map(sheet -&gt; CompletableFuture.runAsync(
                            () -&gt; {
                                log.info(" 当前sheet {} {} ", sheet.getIndex(), sheet.getName());

                                log.info(" 当前sheet {} ", writeSheets[sheet.getIndex()]);
                                finalExcelWriter.write(this.sheetData(sheet.getIndex()), writeSheets[sheet.getIndex()]);
                            }, executor)
                                    .exceptionally((e) -&gt; {
                                                result.set(sheet.getName() + " 导出失败 ");
                                                log.error(sheet.getName() + " 导出失败 ", e);
                                                return null;
                                            }
                                    )
                    ).toArray(CompletableFuture[]::new);

            CompletableFuture.allOf(cfs).join();
        } catch (Exception e) {
            log.error(" 导出失败! ", e);
            throw new BusinessException(" 导出失败! ");
        } finally {
            if (Objects.nonNull(excelWriter)) {
                excelWriter.finish();
            }
        }
        return result.get();
    }

    protected abstract List&lt;Sheet&lt;T&gt;&gt; sheets();

    protected abstract List&lt;T&gt; sheetData(int sheetIndex);

    protected List&lt;List&lt;String&gt;&gt; sheetDynamicHead(int sheetIndex){
        return null;
    }

}

</code></pre> 
<h2><a id="_148"></a>二、食用步骤</h2> 
<h3><a id="1excel_149"></a>1.自定义excel样式</h3> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteCellStyle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">WriteFont</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span></span><span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>usermodel<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description excel样式策略类
 */</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExcelCustomStyleStrategy</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HorizontalCellStyleStrategy</span> <span class="token function">getSimpleStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 头的策略</span>
        <span class="token class-name">WriteCellStyle</span> headWriteCellStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置对齐</span>
        headWriteCellStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 背景色</span>
        headWriteCellStyle<span class="token punctuation">.</span><span class="token function">setFillForegroundColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span>WHITE1<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 字体策略</span>
        <span class="token class-name">WriteFont</span> headWriteFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headWriteFont<span class="token punctuation">.</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headWriteFont<span class="token punctuation">.</span><span class="token function">setFontName</span><span class="token punctuation">(</span><span class="token string">"微软雅黑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headWriteFont<span class="token punctuation">.</span><span class="token function">setFontHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        headWriteCellStyle<span class="token punctuation">.</span><span class="token function">setWriteFont</span><span class="token punctuation">(</span>headWriteFont<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 内容的策略</span>
        <span class="token class-name">WriteCellStyle</span> contentWriteCellStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setFillPatternType</span><span class="token punctuation">(</span><span class="token class-name">FillPatternType</span><span class="token punctuation">.</span>SOLID_FOREGROUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 背景色</span>
        <span class="token comment">// 这里需要指定 FillPatternType 为FillPatternType.SOLID_FOREGROUND 不然无法显示背景颜色。头默认了 FillPatternType所以可以不指定。</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setFillPatternType</span><span class="token punctuation">(</span><span class="token class-name">FillPatternType</span><span class="token punctuation">.</span>SOLID_FOREGROUND<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//背景设置白色</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setFillForegroundColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span>WHITE1<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 字体策略</span>
        <span class="token class-name">WriteFont</span> contentWriteFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WriteFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//contentWriteFont.setFontHeightInPoints((short) 12);</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setWriteFont</span><span class="token punctuation">(</span>contentWriteFont<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置 自动换行</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setWrapped</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置 垂直居中</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置 水平居中</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span>CENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置边框样式</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setBorderLeft</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span>THIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setBorderTop</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span>THIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setBorderRight</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span>THIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentWriteCellStyle<span class="token punctuation">.</span><span class="token function">setBorderBottom</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span>THIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HorizontalCellStyleStrategy</span> horizontalCellStyleStrategy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HorizontalCellStyleStrategy</span><span class="token punctuation">(</span>headWriteCellStyle<span class="token punctuation">,</span> contentWriteCellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> horizontalCellStyleStrategy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="2_208"></a>2.导出数据</h3> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span>column<span class="token punctuation">.</span></span><span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>collect<span class="token punctuation">.</span></span><span class="token class-name">Lists</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>gsdss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>out<span class="token punctuation">.</span></span><span class="token class-name">AbstractExcelView</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>gsdss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>out<span class="token punctuation">.</span></span><span class="token class-name">Sheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>sv<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>strategy<span class="token punctuation">.</span></span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>sv<span class="token punctuation">.</span>model<span class="token punctuation">.</span>dto<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccidentEduExcelView</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractExcelView</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//导出数据list对象 对象属性用@ExcelProperty("事故名称")即可生成表头</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">AccidentEduExcelView</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">,</span> <span class="token class-name">String</span> excelName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> excelName<span class="token punctuation">,</span> <span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
	<span class="token comment">//定义excel样式、sheet名称等</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Sheet</span><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span></span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"事故警示教育"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">handlers</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">.</span><span class="token function">getSimpleStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clz</span><span class="token punctuation">(</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
	<span class="token comment">//指定sheet页</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheetData</span><span class="token punctuation">(</span><span class="token keyword">int</span> sheetIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"列表导出"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/v1/list/export"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downLoadList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">AccidentEduQO</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">//查询导出数据list 对象</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduExcelResp</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">AccidentEduExcelView</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span>data<span class="token punctuation">,</span><span class="token string">"事故警示教育"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h2><a id="excel_258"></a>三、复杂excel导出</h2> 
<h3><a id="31__260"></a>3.1. 自定义复杂表头</h3> 
<p>通过重写<code>sheetDynamicHead</code>方法自定义复杂表头<br> <code>@ExcelProperty(order = 0)</code>注解指定excel列即可填充到指定单元格<br> <img src="https://images2.imgbox.com/44/e0/OrazgLe4_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span>column<span class="token punctuation">.</span></span><span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>collect<span class="token punctuation">.</span></span><span class="token class-name">Lists</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>gsdss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>out<span class="token punctuation">.</span></span><span class="token class-name">AbstractExcelView</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>gsdss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>out<span class="token punctuation">.</span></span><span class="token class-name">Sheet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>sv<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>strategy<span class="token punctuation">.</span></span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>sv<span class="token punctuation">.</span>model<span class="token punctuation">.</span>dto<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">AccidentEduSLResp</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>sv<span class="token punctuation">.</span>model<span class="token punctuation">.</span>dto<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">AccidentEduStatisticResp</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccidentEduSExcelView</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractExcelView</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduSLResp</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">AccidentEduStatisticResp</span> data<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> total<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">AccidentEduSExcelView</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">AccidentEduStatisticResp</span> data<span class="token punctuation">,</span> <span class="token class-name">String</span> excelName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> excelName<span class="token punctuation">,</span> <span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Sheet</span><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduSLResp</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduSLResp</span><span class="token punctuation">&gt;</span></span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"警示教育信息"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">handlers</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">.</span><span class="token function">getSimpleStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clz</span><span class="token punctuation">(</span><span class="token class-name">AccidentEduSLResp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AccidentEduSLResp</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheetData</span><span class="token punctuation">(</span><span class="token keyword">int</span> sheetIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> data<span class="token punctuation">.</span><span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
	<span class="token comment">//这里是动态表头，需要读取数据库计算数据数量做表头，所以中间走了一层，如果不是动态数据可直接返回sheetDynamicHead(Integer total)方法的内容</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheetDynamicHead</span><span class="token punctuation">(</span><span class="token keyword">int</span> sheetIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">sheetDynamicHead</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheetDynamicHead</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> total<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> head <span class="token operator">=</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        head<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        head<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"参与执法持证人员数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"参与执法持证人员数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"参与执法持证人员数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        head<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"执法检查次数(次)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"合计"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"合计"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        head<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"执法检查次数(次)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"检查"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"检查"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        head<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"执法检查次数(次)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"复查"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"复查"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> head<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="2_sheet_342"></a>2. 多sheet</h3> 
<p>protected List sheets() 方法内返回多个sheet<br> protected List sheetData(int sheetIndex)方法内指定sheet填充的数据</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>write<span class="token punctuation">.</span>style<span class="token punctuation">.</span>column<span class="token punctuation">.</span></span><span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>common<span class="token punctuation">.</span>collect<span class="token punctuation">.</span></span><span class="token class-name">Lists</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>emis<span class="token punctuation">.</span>base<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>emis<span class="token punctuation">.</span>euip<span class="token punctuation">.</span>model<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">EuipExcelListResp</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>emis<span class="token punctuation">.</span>fpln<span class="token punctuation">.</span>model<span class="token punctuation">.</span>dto<span class="token punctuation">.</span>resp<span class="token punctuation">.</span></span><span class="token class-name">UavInfoResp</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>gsdss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>out<span class="token punctuation">.</span></span><span class="token class-name">AbstractExcelView</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>gsafety<span class="token punctuation">.</span>bg<span class="token punctuation">.</span>gsdss<span class="token punctuation">.</span>common<span class="token punctuation">.</span>excel<span class="token punctuation">.</span>out<span class="token punctuation">.</span></span><span class="token class-name">Sheet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EuipExcelView</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractExcelView</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EuipExcelListResp</span><span class="token punctuation">&gt;</span></span> euip<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UavInfoResp</span><span class="token punctuation">&gt;</span></span> uva<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">EuipExcelView</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EuipExcelListResp</span><span class="token punctuation">&gt;</span></span> euip<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UavInfoResp</span><span class="token punctuation">&gt;</span></span> uav<span class="token punctuation">,</span> <span class="token class-name">String</span> excelName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> excelName<span class="token punctuation">,</span> <span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span>XLSX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>euip <span class="token operator">=</span> euip<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>uva <span class="token operator">=</span> uav<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Sheet</span><span class="token punctuation">&gt;</span></span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">Sheet</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EuipExcelListResp</span><span class="token punctuation">&gt;</span></span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"通讯装备信息"</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">handlers</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">.</span><span class="token function">getSimpleStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clz</span><span class="token punctuation">(</span><span class="token class-name">EuipExcelListResp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Sheet</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UavInfoResp</span><span class="token punctuation">&gt;</span></span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"无人机信息"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">handlers</span><span class="token punctuation">(</span><span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">newArrayList</span><span class="token punctuation">(</span><span class="token class-name">ExcelCustomStyleStrategy</span><span class="token punctuation">.</span><span class="token function">getSimpleStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SimpleColumnWidthStyleStrategy</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clz</span><span class="token punctuation">(</span><span class="token class-name">UavInfoResp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">List</span> <span class="token function">sheetData</span><span class="token punctuation">(</span><span class="token keyword">int</span> sheetIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> sheetIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> euip<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> uva<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/44/b3/vnvChBDh_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab8f92a6663db7b33f684ca11fe36dac/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">GET https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.m net::ERR_CONNECTION_TIMED_OUT</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b0e75d38eaade0331df58628df6d29e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MinIO快速入门</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>