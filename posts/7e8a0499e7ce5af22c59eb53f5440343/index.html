<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>iMX6ULL EC20 4G连网 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="iMX6ULL EC20 4G连网" />
<meta property="og:description" content="iMX6ULL EC20 4G连网 1. 介绍2. 配置Linux内核3. 配置Buildroot4. 测试 我移植的板子是讯为的TERMINATOR_V1.1开发板，参考板为官方 i.MX6ULL EVK开发板。
1. 介绍 EC20是移远一款带有GPS功能的LTE模块支持4G上网，本文将利用官方提供linux-ppp-scripts_V1.2.zip包实现ppp拨号上网，更多详细的指令操作细节、参数、示例可参考官网提供的手册：Quectel_EC20_GNSS_AT_Commands_Manual_V1.1.pdf。
2. 配置Linux内核 因为我使用的内核已经支持了EC20，所以这里无需修改内核代码。如果自己使用的内核不支持EC20只需要修改drivers/usb/serial/option.c文件，添加EC20设备信息即可。接下来只需要配置内核。
Device Drivers ---&gt; [*] Network device support ---&gt; &lt;*&gt; PPP (point-to-point protocol) support &lt;*&gt; PPP BSD-Compress compression &lt;*&gt; PPP Deflate compression [*] PPP filtering &lt;*&gt; PPP MPPE compression (encryption) [*] PPP multilink support &lt;*&gt; PPP over Ethernet &lt;*&gt; PPP support for async serial ports &lt;*&gt; PPP support for sync tty ports &lt;*&gt; USB Network Adapters ---&gt; &lt;*&gt; Multi-purpose USB Networking Framework [*] USB support ---&gt; &lt;*&gt; USB Serial Converter support ---&gt; &lt;*&gt; USB driver for GSM and CDMA modems 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7e8a0499e7ce5af22c59eb53f5440343/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-13T10:43:22+08:00" />
<meta property="article:modified_time" content="2023-01-13T10:43:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">iMX6ULL EC20 4G连网</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>iMX6ULL EC20 4G连网</h4> 
 <ul><li><a href="#1__3" rel="nofollow">1. 介绍</a></li><li><a href="#2_Linux_5" rel="nofollow">2. 配置Linux内核</a></li><li><a href="#3_Buildroot_27" rel="nofollow">3. 配置Buildroot</a></li><li><a href="#4__37" rel="nofollow">4. 测试</a></li></ul> 
</div> 
<p></p> 
<p>我移植的板子是讯为的TERMINATOR_V1.1开发板，参考板为官方 i.MX6ULL EVK开发板。</p> 
<h2><a id="1__3"></a>1. 介绍</h2> 
<p>EC20是移远一款带有GPS功能的LTE模块支持4G上网，本文将利用官方提供linux-ppp-scripts_V1.2.zip包实现ppp拨号上网，更多详细的指令操作细节、参数、示例可参考官网提供的手册：Quectel_EC20_GNSS_AT_Commands_Manual_V1.1.pdf。</p> 
<h2><a id="2_Linux_5"></a>2. 配置Linux内核</h2> 
<p>因为我使用的内核已经支持了EC20，所以这里无需修改内核代码。如果自己使用的内核不支持EC20只需要修改drivers/usb/serial/option.c文件，添加EC20设备信息即可。接下来只需要配置内核。</p> 
<pre><code class="prism language-bash">Device Drivers  ---<span class="token operator">&gt;</span>
	<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Network device support  ---<span class="token operator">&gt;</span> 
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>   PPP <span class="token punctuation">(</span>point-to-point protocol<span class="token punctuation">)</span> support
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>     PPP BSD-Compress compression
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>     PPP Deflate compression
		<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     PPP filtering
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>     PPP MPPE compression <span class="token punctuation">(</span>encryption<span class="token punctuation">)</span>
		<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     PPP multilink support
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>     PPP over Ethernet
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>     PPP support <span class="token keyword">for</span> async serial ports
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>     PPP support <span class="token keyword">for</span> <span class="token function">sync</span> <span class="token function">tty</span> ports
		
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>   USB Network Adapters  ---<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>   Multi-purpose USB Networking Framework
			
	<span class="token punctuation">[</span>*<span class="token punctuation">]</span> USB support  ---<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>   USB Serial Converter support  ---<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>*<span class="token operator">&gt;</span>   USB driver <span class="token keyword">for</span> GSM and CDMA modems
</code></pre> 
<h2><a id="3_Buildroot_27"></a>3. 配置Buildroot</h2> 
<p>使用ppp拨号上网需要pppd工具包，直接从Buildroot中添加这个工具。</p> 
<pre><code class="prism language-bash">Target packages  ---<span class="token operator">&gt;</span>
	Networking applications  ---<span class="token operator">&gt;</span> 
		<span class="token punctuation">[</span>*<span class="token punctuation">]</span> pppd
		<span class="token punctuation">[</span> <span class="token punctuation">]</span>   filtering
		<span class="token punctuation">[</span> <span class="token punctuation">]</span>   radius
		<span class="token punctuation">[</span>*<span class="token punctuation">]</span>   overwrite /etc/resolv.conf
</code></pre> 
<h2><a id="4__37"></a>4. 测试</h2> 
<p>将修改好的内核和根文件系统下载到开发板，并启动开发板。在根目录的etc目录中新建ppp文件夹，并在ppp目录中新建 peers文件夹。解压linux-ppp-scripts_V1.2.zip包，将ip-up文件复制到ppp目录中并添加可执行权限，再将quectel-chat-connect、quectel-chat-disconnect、quectel-ppp-kill、quectel-ppp四个文件复制到peers目录中。需要将quectel-ppp文件中/dev/ttyUSB3改为/dev/ttyUSB2，并将quectel-chat-connect文件中<code>OK ATI;+CSUB;+CSQ;+CPIN?;+COPS?;+CGREG?;&amp;D2</code>一行注释掉（具体原因不清楚，可能是因为我的EC20不是全功能版）。</p> 
<pre><code class="prism language-bash">ppp
├── ip-up
└── peers
    ├── quectel-chat-connect
    ├── quectel-chat-disconnect
    ├── quectel-ppp
    └── quectel-ppp-kill
</code></pre> 
<p>执行<code>pppd call quectel-ppp &amp;</code>命令，ifconfig可以看到出现了一个ppp0的网卡，使用<code>sh /etc/ppp/peers/quectel-ppp-kill</code>断开连接。</p> 
<pre><code class="prism language-bash">root@imx6ull:~<span class="token comment"># pppd call quectel-ppp &amp;</span>
pppd options <span class="token keyword">in</span> effect:
debug           <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
nodetach                <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
dump            <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
noauth          <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
user <span class="token function">test</span>               <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
password ??????         <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
remotename 3gppp                <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
/dev/ttyUSB2            <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
115200          <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
lock            <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
connect chat -s -v -f /etc/ppp/peers/quectel-chat-connect               <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
disconnect chat -s -v -f /etc/ppp/peers/quectel-chat-disconnect         <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
nocrtscts               <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
modem           <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
hide-password           <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
novj            <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
novjccomp               <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
ipcp-accept-local               <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
ipcp-accept-remote              <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
ipparam 3gppp           <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
noipdefault             <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
ipcp-max-failure 30             <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
defaultroute            <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
usepeerdns              <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
noccp           <span class="token comment"># (from /etc/ppp/peers/quectel-ppp)</span>
abort on <span class="token punctuation">(</span>BUSY<span class="token punctuation">)</span>
abort on <span class="token punctuation">(</span>NO CARRIER<span class="token punctuation">)</span>
abort on <span class="token punctuation">(</span>NO DIALTONE<span class="token punctuation">)</span>
abort on <span class="token punctuation">(</span>ERROR<span class="token punctuation">)</span>
abort on <span class="token punctuation">(</span>NO ANSWER<span class="token punctuation">)</span>
<span class="token function">timeout</span> <span class="token keyword">set</span> to 30 seconds
send <span class="token punctuation">(</span>AT^M<span class="token punctuation">)</span>
<span class="token function">expect</span> <span class="token punctuation">(</span>OK<span class="token punctuation">)</span>
^M
OK
 -- got it

send <span class="token punctuation">(</span>ATE0^M<span class="token punctuation">)</span>
<span class="token function">expect</span> <span class="token punctuation">(</span>OK<span class="token punctuation">)</span>
^M
^M
OK
 -- got it

send <span class="token punctuation">(</span>AT+CGDCONT<span class="token operator">=</span>1,<span class="token string">"IP"</span>,<span class="token string">"3gnet"</span>,,0,0^M<span class="token punctuation">)</span>
<span class="token function">expect</span> <span class="token punctuation">(</span>OK<span class="token punctuation">)</span>
^M
^M
OK
 -- got it

send <span class="token punctuation">(</span>ATD*99<span class="token comment">#^M)</span>
<span class="token function">expect</span> <span class="token punctuation">(</span>CONNECT<span class="token punctuation">)</span>
^M
^M
CONNECT
 -- got it

Script chat -s -v -f /etc/ppp/peers/quectel-chat-connect finished <span class="token punctuation">(</span>pid 456<span class="token punctuation">)</span>, status <span class="token operator">=</span> 0x0
Serial connection established.
using channel 3
Using interface ppp0
Connect: ppp0 <span class="token operator">&lt;</span>--<span class="token operator">&gt;</span> /dev/ttyUSB2
sent <span class="token punctuation">[</span>LCP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>asyncmap 0x0<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>magic 0x5c165b7<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>pcomp<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>accomp<span class="token operator">&gt;</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>LCP ConfReq id<span class="token operator">=</span>0x12 <span class="token operator">&lt;</span>asyncmap 0x0<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>auth chap MD5<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>magic 0xe617ceb8<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>pcomp<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>accomp<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>LCP ConfAck id<span class="token operator">=</span>0x12 <span class="token operator">&lt;</span>asyncmap 0x0<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>auth chap MD5<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>magic 0xe617ceb8<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>pcomp<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>accomp<span class="token operator">&gt;</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>LCP ConfAck id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>asyncmap 0x0<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>magic 0x5c165b7<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>pcomp<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>accomp<span class="token operator">&gt;</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>LCP DiscReq id<span class="token operator">=</span>0x13 magic<span class="token operator">=</span>0xe617ceb8<span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>CHAP Challenge id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>07c88a9e69c25977a34113740e059ecd<span class="token operator">&gt;</span>, name <span class="token operator">=</span> <span class="token string">"UMTS_CHAP_SRVR"</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>CHAP Response id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>636b4c1439fdfce10be9c185e81f6b49<span class="token operator">&gt;</span>, name <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>CHAP Success id<span class="token operator">=</span>0x1 <span class="token string">""</span><span class="token punctuation">]</span>
CHAP authentication succeeded
CHAP authentication succeeded
sent <span class="token punctuation">[</span>IPCP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr 0.0.0.0<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns1 0.0.0.0<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns2 0.0.0.0<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>IPCP ConfReq id<span class="token operator">=</span>0x12<span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPCP ConfNak id<span class="token operator">=</span>0x12 <span class="token operator">&lt;</span>addr 0.0.0.0<span class="token operator">&gt;</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>IPCP ConfNak id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr 10.113.60.94<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns1 211.137.130.18<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns2 211.137.130.2<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPCP ConfReq id<span class="token operator">=</span>0x2 <span class="token operator">&lt;</span>addr 10.113.60.94<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns1 211.137.130.18<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns2 211.137.130.2<span class="token operator">&gt;</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>IPCP ConfReq id<span class="token operator">=</span>0x13<span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPCP ConfAck id<span class="token operator">=</span>0x13<span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>IPCP ConfAck id<span class="token operator">=</span>0x2 <span class="token operator">&lt;</span>addr 10.113.60.94<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns1 211.137.130.18<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>ms-dns2 211.137.130.2<span class="token operator">&gt;</span><span class="token punctuation">]</span>
Could not determine remote IP address: defaulting to 10.64.64.64
not replacing default route to wlan0 <span class="token punctuation">[</span>192.168.0.1<span class="token punctuation">]</span>
local  IP address 10.113.60.94
remote IP address 10.64.64.64
primary   DNS address 211.137.130.18
secondary DNS address 211.137.130.2
Script /etc/ppp/ip-up started <span class="token punctuation">(</span>pid 457<span class="token punctuation">)</span>
Script /etc/ppp/ip-up finished <span class="token punctuation">(</span>pid 457<span class="token punctuation">)</span>, status <span class="token operator">=</span> 0x0
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
sent <span class="token punctuation">[</span>IPV6CP ConfReq id<span class="token operator">=</span>0x1 <span class="token operator">&lt;</span>addr fe80::1025:52f0:02b9:2325<span class="token operator">&gt;</span><span class="token punctuation">]</span>
IPV6CP: <span class="token function">timeout</span> sending Config-Requests
root@imx6ull:~<span class="token comment"># ifconfig</span>
can0      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00
          UP RUNNING NOARP  MTU:16  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:10
          RX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>  TX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>
          Interrupt:32

can1      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00
          UP RUNNING NOARP  MTU:16  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:10
          RX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>  TX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>
          Interrupt:33

eth0      Link encap:Ethernet  HWaddr B2:D1:FB:30:9E:0C
          inet addr:192.168.0.75  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::b0d1:fbff:fe30:9e0c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:222 errors:0 dropped:0 overruns:0 frame:0
          TX packets:918 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:39130 <span class="token punctuation">(</span>38.2 KiB<span class="token punctuation">)</span>  TX bytes:87879 <span class="token punctuation">(</span>85.8 KiB<span class="token punctuation">)</span>

eth1      Link encap:Ethernet  HWaddr C6:59:22:F7:61:C4
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>  TX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>  TX bytes:0 <span class="token punctuation">(</span>0.0 B<span class="token punctuation">)</span>

ppp0      Link encap:Point-to-Point Protocol
          inet addr:10.113.60.94  P-t-P:10.64.64.64  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1500  Metric:1
          RX packets:4 errors:0 dropped:0 overruns:0 frame:0
          TX packets:14 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3
          RX bytes:52 <span class="token punctuation">(</span>52.0 B<span class="token punctuation">)</span>  TX bytes:198 <span class="token punctuation">(</span>198.0 B<span class="token punctuation">)</span>

wlan0     Link encap:Ethernet  HWaddr 34:20:03:3E:67:0B
          inet addr:192.168.0.19  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::3620:3ff:fe3e:670b/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:438 errors:0 dropped:0 overruns:0 frame:0
          TX packets:24 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:51126 <span class="token punctuation">(</span>49.9 KiB<span class="token punctuation">)</span>  TX bytes:3012 <span class="token punctuation">(</span>2.9 KiB<span class="token punctuation">)</span>

root@imx6ull:~<span class="token comment"># sh /etc/ppp/peers/quectel-ppp-kill</span>
Terminating on signal 15
Connect <span class="token function">time</span> 3.4 minutes.
Sent 126 bytes, received 0 bytes.
sent <span class="token punctuation">[</span>LCP TermReq id<span class="token operator">=</span>0x2 <span class="token string">"User request"</span><span class="token punctuation">]</span>
rcvd <span class="token punctuation">[</span>LCP TermAck id<span class="token operator">=</span>0x2<span class="token punctuation">]</span>
Connection terminated.
abort on <span class="token punctuation">(</span>ERROR<span class="token punctuation">)</span>
abort on <span class="token punctuation">(</span>NO DIALTONE<span class="token punctuation">)</span>

Sending <span class="token keyword">break</span> to the modem
send <span class="token punctuation">(</span>+++^M<span class="token punctuation">)</span>
send <span class="token punctuation">(</span>+++^M<span class="token punctuation">)</span>
send <span class="token punctuation">(</span>+++^M<span class="token punctuation">)</span>

Goodbay
Script chat -s -v -f /etc/ppp/peers/quectel-chat-disconnect finished <span class="token punctuation">(</span>pid 469<span class="token punctuation">)</span>, status <span class="token operator">=</span> 0x0
Serial <span class="token function">link</span> disconnected.
killall: pppd: no process killed
killall: pppd: no process killed
<span class="token punctuation">[</span>1<span class="token punctuation">]</span>+  Done<span class="token punctuation">(</span>5<span class="token punctuation">)</span>                    pppd call quectel-ppp
root@imx6ull:~<span class="token comment">#</span>
</code></pre> 
<p>设置开机启动，在/etc/network/interfaces文件中加入以下几行。</p> 
<pre><code class="prism language-bash">auto ppp0
iface ppp0 inet manual
pre-up pppd call quectel-ppp <span class="token operator">&gt;</span> /dev/null <span class="token operator">&amp;</span>
</code></pre> 
<p>重启开发板，使用ppp0网卡ping百度（ping通后可以看到板子上的4G模块LED闪动变快），联网成功。<br> <img src="https://images2.imgbox.com/ea/fb/L4lebkqj_o.png" alt="在这里插入图片描述"></p> 
<p>移植源码获取：</p> 
<pre><code class="prism language-bash"><span class="token function">git</span> clone https://github.com/Sonboy97/linux.git -b imx
版本：b0b488843d7ff3ae06dae6e95e29f4064abae1c0
<span class="token function">git</span> clone https://github.com/Sonboy97/buildroot.git -b imx
版本：29e18d881c91b8f6080e93cc8158fa08de2d7d78
<span class="token function">git</span> clone https://github.com/Sonboy97/learning.git -b imx6ull_topeet
版本：be31a402800808f7c5cf76085a78656b33da6d85
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/92e0d08d1983d2c4aa7eb1e4b6683ccd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">TypeError: Cannot set properties of undefined (setting &#39;type&#39;)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7611d3437449465615fb8b9e42c81c75/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决ubuntu虚拟机安装QT没有图标启动麻烦问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>