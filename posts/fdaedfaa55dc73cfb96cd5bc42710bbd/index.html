<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>线性基(求抑或最值) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="线性基(求抑或最值)" />
<meta property="og:description" content="线性基：对一组数建立线性基得到：一组数a1,a2、、、an,其中ax：存最高位的1在第x位的元素值。
线性基作用：线性基的子集的抑或和的 值域与原数抑或和的值域相同。
性质1：线性基的任意子集的抑或和都不为0
构造线性基： 对原数组的每一个数p,从高位到低位扫描，找到第一位为1的，若该位上的线性基ai不存在，则ai=p,否则p=p^ai,继续扫描下一位。
像如果原数是2,3，则插入线性基中的是1,2 ll b[63], nb[63], tot=0,flag=false; //b为线性基 nb用来求第K小异或值,基线性基中数 tot为nb元素个数,flag为true表示线性基外有数 void insert(ll x) { //插入 for(int i = 62; i &gt;= 0; i--) { if(x &amp; (1ll &lt;&lt; i)) { if(!b[i]) { b[i] = x; return; } x ^= b[i]; } } flag = true; } 查询xor最大、小值： ll Max(ll x) { //求最大值 ll res = x; for(int i = 62; i &gt;= 0; i--) res = max(res, res ^ b[i]); return res; } ll Min(ll x) { //求最小值 ll res = x; for(int i = 0; i &lt;= 62; i&#43;&#43;) if(b[i]) res ^= b[i]; return res; } 验证一个数x能否被xor出 bool fin(ll x) { //验证存在性 if(x == 0 &amp;&amp; b[0]) return 1; for(int i = 62; i &gt;= 1; i--) { int j = i - 1; if(x &amp; (1 &lt;&lt; j)) { x ^= b[i]; if(!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fdaedfaa55dc73cfb96cd5bc42710bbd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-09T13:43:25+08:00" />
<meta property="article:modified_time" content="2019-07-09T13:43:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">线性基(求抑或最值)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>线性基：</strong>对一组数建立线性基得到：一组数a1,a2、、、an,其中ax：存最高位的1在第x位的元素值。</p> 
<p><strong>线性基作用</strong>：线性基的子集的抑或和的 值域与原数抑或和的值域相同。</p> 
<p><strong>性质1：</strong>线性基的任意子集的抑或和都不为0</p> 
<h4>构造线性基：</h4> 
<p>对原数组的每一个数p,从高位到低位扫描，找到第一位为1的，若该位上的线性基ai不存在，则ai=p,否则p=p^ai,继续扫描下一位。</p> 
<p>像如果原数是2,3，则插入线性基中的是1,2 </p> 
<pre class="has"><code class="language-cpp">ll b[63], nb[63], tot=0,flag=false; //b为线性基  nb用来求第K小异或值,基线性基中数 tot为nb元素个数,flag为true表示线性基外有数

void insert(ll  x)
 { //插入
    for(int i = 62; i &gt;= 0; i--) 
    {
        if(x &amp; (1ll &lt;&lt; i)) 
        {
            if(!b[i])
            {
                b[i] = x;
                return;
            }
            x ^= b[i];
        }
    }
    flag = true;
}</code></pre> 
<h4>查询xor最大、小值：</h4> 
<pre class="has"><code class="language-cpp">ll Max(ll x) 
{  //求最大值
    ll res = x;
    for(int i = 62; i &gt;= 0; i--) 
         res = max(res, res ^ b[i]);
    return res;
}

ll Min(ll x) 
{  //求最小值
    ll res = x;
    for(int i = 0; i &lt;= 62; i++) 
        if(b[i])
            res ^= b[i];
    return res;
}</code></pre> 
<h4>验证一个数x能否被xor出</h4> 
<pre class="has"><code class="language-cpp">bool fin(ll x) 
{ //验证存在性
    if(x == 0 &amp;&amp; b[0])
        return 1;
    for(int i = 62; i &gt;= 1; i--) 
    {
        int j = i - 1;
        if(x &amp; (1 &lt;&lt; j)) 
        {
            x ^= b[i];
            if(!x)
                return 1;
        }
    }
    return 0;
}</code></pre> 
<h4>求抑或第k大</h4> 
<p>把k二进制拆分，如果k的第i位上是1，ans^=b[i]</p> 
<pre class="has"><code class="language-cpp">ll b[63], nb[63], tot=0,flag=false; //b为线性基  nb用来求第K小异或值,基线性基中数 tot为nb元素个数,flag为true表示线性基外有数

void insert(ll  x)
 { //插入
    for(int i = 62; i &gt;= 0; i--) 
    {
        if(x &amp; (1ll &lt;&lt; i)) 
        {
            if(!b[i])
            {
                b[i] = x;
                return;
            }
            x ^= b[i];
        }
    }
    flag = true;
}


ll Rebuild() {  //第K大
    for(int i = 62; i &gt;= 0; i--) 
    {
         if(b[i] == 0)
             continue;
         for(int j = i - 1; j &gt;= 0; j--) 
         {
             if(b[j] == 0)
                continue;
             if(b[i] &amp; (1ll &lt;&lt; j))
                b[i] ^= b[j];
         }
     }
     for(int i = 0; i &lt;= 62; i++) 
     {
         if(b[i])
            nb[tot++] = b[i];
     }
}

ll Kth_Max(ll k) {
    if(flag)
         k--; 
    ll res = 0;
    if(k == 0)
        return 0;
    if(k &gt;= (1ll &lt;&lt; tot))
        return -1;
    for(int i = 62; i &gt;= 0; i--) 
    {
        if(k &amp; (1ll &lt;&lt; i))
             res ^= nb[i];
    }
    return res;
}</code></pre> 
<h4>实例</h4> 
<h4><a href="https://vjudge.net/contest/257874#problem/A" rel="nofollow">A - 元素</a></h4> 
<p>theme：给定n个魔石的编号和魔力值，如果一堆魔石中有子串的抑或和为0，则这堆魔石没有魔力。问最多能达到多少魔力值？</p> 
<p>solution：按魔力值排序，依次插入线性基，如果该元素可以插入，说明该数某一为1的位有价值，则该魔石被选。</p> 
<pre class="has"><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
#define far(i,s,n) for(int i=s;i&lt;n;++i)
typedef long long ll;
using namespace std;

ll b[63];
struct _a
{
    ll num;
    ll magic;
    bool operator&lt;(_a b)const
    {
        return magic&gt;b.magic;
    }
}a[2000];

void Insert(ll  x,int &amp;flag)
 { //插入
    for(int i = 62; i &gt;= 0; i--)
    {
        if(x &amp; (1ll &lt;&lt; i))
        {
            if(!b[i])
            {
                flag = 1;
                b[i] = x;
                return;
            }
            x ^= b[i];
        }
    }
}

int main()
{
    int n;
    cin&gt;&gt;n;
    far(i,0,n)
        scanf("%lld%lld",&amp;a[i].num,&amp;a[i].magic);
    sort(a,a+n);
    ll ans=0;
    far(i,0,n)
    {
        int flag=0;
        Insert(a[i].num,flag);
        if(flag)
            ans+=a[i].magic;
    }
    cout&lt;&lt;ans&lt;&lt;endl;
}
</code></pre> 
<h4>实例：求任选元素抑或和第k大</h4> 
<h4><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3949" rel="nofollow">hdu3949:XOR</a></h4> 
<p>theme:给定n个数，q次询问，求任选元素抑或和第k大。</p> 
<p>solution:套上面第k大模板即可，注意每组案例重置b、nb、flag、tot为0</p> 
<pre class="has"><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
#define far(i,s,n) for(int i=s;i&lt;n;++i)
typedef long long ll;
using namespace std;

ll b[63], nb[63], tot=0,flag=false; //b为线性基  nb用来求第K小异或值,基线性基中数 tot为nb元素个数,flag为true表示线性基外有数

void Insert(ll  x)
 { //插入
    for(int i = 62; i &gt;= 0; i--)
    {
        if(x &amp; (1ll &lt;&lt; i))
        {
            if(!b[i])
            {
                b[i] = x;
                return;
            }
            x ^= b[i];
        }
    }
    flag = true;
}


ll Rebuild() {  //第K大
    for(int i = 62; i &gt;= 0; i--)
    {
         if(b[i] == 0)
             continue;
         for(int j = i - 1; j &gt;= 0; j--)
         {
             if(b[j] == 0)
                continue;
             if(b[i] &amp; (1ll &lt;&lt; j))
                b[i] ^= b[j];
         }
     }
     for(int i = 0; i &lt;= 62; i++)
     {
         if(b[i])
            nb[tot++] = b[i];
     }
}

ll Kth_Max(ll k) {
    if(flag)
         k--;
    ll res = 0;
    if(k == 0)
        return 0;
    if(k &gt;= (1ll &lt;&lt; tot))
        return -1;
    for(int i = 62; i &gt;= 0; i--)
    {
        if(k &amp; (1ll &lt;&lt; i))
             res ^= nb[i];
    }
    return res;
}

int main()
{
    int t;
    cin&gt;&gt;t;
    for(int Case=1;Case&lt;=t;++Case)
    {
        printf("Case #%d:\n",Case);
        memset(b,0,sizeof(b));
        memset(nb,0,sizeof(nb));
        tot=0,flag=false;
        int n;
        scanf("%d",&amp;n);
        far(i,0,n)
        {
            ll x;
            scanf("%lld",&amp;x);
            Insert(x);
        }
        Rebuild();
        int q;
        scanf("%d",&amp;q);
        far(i,0,q)
        {
            ll k;
            scanf("%lld",&amp;k);
            ll ans=Kth_Max(k);
            printf("%lld\n",ans);
        }
    }
}
</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/80cb1206738c562b60af64ffa28dc3b9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python webservice  安装suds提示ModuleNotFoundError: No module named &#39;client&#39;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fbc00110e4547b085e015174bab40c90/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">查看IOS-app证书到期时间</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>