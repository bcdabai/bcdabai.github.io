<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 使用 Edge Web.WebView2 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# 使用 Edge Web.WebView2" />
<meta property="og:description" content="WinForms 應用程式中使用 WebView2。Windows 應用 SDK WebView2 公共 WebView2 可在 Windows 應用 SDK 中使用 Edge 與 WinUI 合作，將 WebView2 控件反向移植到 WinUI2 中。Windows UI 程式庫 (WinUI) 2 與 Windows SDK 整合並使用 XAML Islands() 為 UWP 應用程式提供官方原生 Windows UI 控制項和其他使用者介面元素。
Visual Studio C# ASP.NET 的應用，替換應用程式 WebBrowser 改用 Microsoft Edge WebView2 的 WinForms 應用程式中內嵌 Microsoft Edge (Chromium) 平台 Web 內容。永久啟動載入器，根據預設 WebView2 會「永久」並接收自動更新，以保持最新狀態且最安全的平台。這個「永久」看以後的網路變化吧。Internet Explorer 瀏覽器徹底淘汰日期在 2022/06/15 不再支援 IE 11 瀏覽器傳統型應用程式，並推薦移轉至 Microsoft Edge。原本於本機作業的 WebBrowser 亦可使用新的網路技術。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e5bae4d41de237c696fef326d418c332/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-27T06:54:47+08:00" />
<meta property="article:modified_time" content="2023-10-27T06:54:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 使用 Edge Web.WebView2</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>WinForms</strong> 應用程式中使用 <strong>WebView2</strong>。<strong>Windows</strong> 應用 SDK <strong>WebView2</strong> 公共 <strong>WebView2</strong> 可在 Windows 應用 SDK 中使用 <strong>Edge</strong> 與 <strong>WinUI</strong> 合作，將 <strong>WebView2</strong> 控件反向移植到 <strong>WinUI2</strong> 中。<strong>Windows UI</strong> 程式庫 (<strong>WinUI</strong>) <strong>2</strong> 與 <strong>Windows SDK</strong> 整合並使用 <strong>XAML Islands</strong>() 為 <strong>UWP</strong> 應用程式提供官方原生 <strong>Windows UI</strong> 控制項和其他使用者介面元素。</p> 
<p><strong>Visual Studio</strong> C# ASP.NET 的應用，替換應用程式 <strong>WebBrowser</strong> 改用 <strong>Microsoft Edge</strong> <strong>WebView2</strong> 的 <strong>WinForms</strong> 應用程式中內嵌 <strong>Microsoft Edge</strong> (<strong>Chromium</strong>) 平台 Web 內容。永久啟動載入器，根據預設 <strong>WebView2</strong> 會「永久」並接收自動更新，以保持最新狀態且最安全的平台。這個「永久」看以後的網路變化吧。<strong>Internet Explorer</strong> 瀏覽器徹底淘汰日期在 2022/06/15 不再支援 <strong>IE 11</strong> 瀏覽器傳統型應用程式，並推薦移轉至 <strong>Microsoft Edge</strong>。原本於本機作業的 <strong>WebBrowser</strong> 亦可使用新的網路技術。</p> 
<h4><strong>WebView2</strong> <strong>Microsoft Edge</strong></h4> 
<p>新版的 <strong>Microsoft Edge</strong> 瀏覽器採用與 <strong>Google Chrome</strong> 同樣的 <strong>Chromium</strong> 核心，將 Web 技術 HTML、JavaScript、CSS 本機應用中，因此可以提供更好的網頁相容度，同時也提供久違的 macOS 版本。<strong>Chromium</strong> 核心自 2006 年即開始 Google 為發展 <strong>Google Chrome</strong> 瀏覽器而釋出的免費開源軟體專案，為了創建安全、穩定和快速的通用瀏覽器，以 <strong>BSD</strong> 授權條款等數種授權發行並開放原始碼。<strong>Chromium</strong>, <strong>Google Chrome</strong> 共享瀏覽器大部分程式碼和 <strong>JavaScript</strong> 與 <strong>ECMAScript</strong>, <strong>ES6</strong> 語法支持功能。</p> 
<p><strong>Edge</strong> 在官方 <strong>Microsoft</strong> 安裝更新新版 <strong>Chromium</strong> 核心 <strong>Edge</strong> 的預設瀏覽器。通過設定可以調整，決定自己保護自己隱私安全的程度及設定預定搜尋引擎、以及擴充功能，在網頁設計考量時、應該就漸近的擺脫以前相容性的約束。</p> 
<p><br>  </p> 
<h3>首先下載 <strong>WebView2</strong> 執行階段</h3> 
<p>Microsoft Edge <strong>WebView2 Runtime</strong>、<strong>WebView2</strong> 控件可以在由 <strong>Microsoft Edge</strong> (<strong>Chromium</strong>) 提供支持的本機應用程序中嵌入當前 Web 技術 <strong>HTML</strong>, <strong>CSS</strong>, <strong>ECMAScript</strong>, <strong>JavaScript</strong> 少了這個 <strong>Visual Studio 2017</strong> 就沒有辦法顯示指定的 <strong>Source</strong> 網址內容。</p> 
<p><a href="https://developer.microsoft.com/zh-TW/microsoft-edge/webview2/" rel="nofollow" title="WebView2 - Microsoft Edge Developer">WebView2 - Microsoft Edge Developer</a></p> 
<pre><code>MicrosoftEdgeWebview2Setup.exe</code></pre> 
<p></p> 
<p class="img-center"><img alt="" height="280" src="https://images2.imgbox.com/22/d3/kAy33V57_o.png" width="722"></p> 
<p></p> 
<hr> 
<p></p> 
<h3><strong>Visual Studio</strong></h3> 
<p>Microsoft Edge <strong>WebView2</strong> 基於微軟新版本的 <strong>Chromium</strong> 核心 <strong>Edge</strong> 瀏覽器的一部分不斷進行諸多最佳化。該瀏覽器首次預裝在 <strong>Windows 10</strong> 版本 <strong>20H2</strong> 中。原本於本機作業的 C# Windows Forms 更新。<br><strong>Visual Studio</strong> 選單中的 <strong>Tools</strong> 工具(<strong>T</strong>)、<strong>NuGet</strong> 套件管理員、管理方案的 <strong>NuGet</strong> 套件。</p> 
<p></p> 
<p class="img-center"><img alt="" height="880" src="https://images2.imgbox.com/1d/f8/pOyplTvt_o.png" width="780"></p> 
<h4><strong>Microsoft.Web.WebView2</strong></h4> 
<p>設置開發工具並為 WinForms 平台創建初始化 <strong>WebView2</strong> 應用程序。元件開發應用，需要安裝 Microsoft Visual Studio 版本 Visual Studio 2017 或更高版本例如 Visual Studio 2022 Professional。</p> 
<p></p> 
<hr> 
<p></p> 
<h3>更改 <strong>WebView2</strong> 控件的 source 屬性</h3> 
<pre><code>using System.Windows.Forms;</code></pre> 
<p>.NET API 瀏覽器，於 <strong>CoreWebView2</strong> 的初始化完成後顯示當前指定的 <strong>source</strong> 網址內容，獲取該屬性相當於獲取 Source 屬性，設置屬性 <strong>Navigate</strong>(String) 方法。</p> 
<pre><code>this.WebView2.Source = new System.Uri("https://www.microsoft.com", System.UriKind.Absolute);</code></pre> 
<p>Uri 取得關於目前請求的 URL 資訊，提供統一資源識別元 URI 的物件表示，以及對 URI 各部分的簡易存取。</p> 
<p></p> 
<p class="img-center"><img alt="" height="700" src="https://images2.imgbox.com/c1/e4/vh9QiThw_o.png" width="780"></p> 
<h4>步驟參考 <strong>WinForms</strong> 應用程序中開始使用 <strong>WebView2</strong></h4> 
<p><strong>WebView2</strong> 基於 <strong>Microsoft Edge</strong> 的新世代瀏覽器控制項，可以嵌入 <strong>Microsoft Visual Studio</strong> 應用程式中在應用程式中顯示網頁內容，並提供與現代瀏覽器相同的功能和體驗。讓應用程序可以支援新世代的瀏覽器方案，例如 <strong>ECMA-262</strong> 等新的語法。<br><strong>Get started with <strong>WebView2</strong> in WinForms apps</strong></p> 
<pre><code>webView21.CoreWebView2.Navigate("https://www.example.com");</code></pre> 
<p><a href="https://docs.microsoft.com/en-us/microsoft-edge/webview2/get-started/winforms" rel="nofollow" title="Get started with WebView2 in WinForms apps - Microsoft Edge Development | Microsoft Learn">Get started with WebView2 in WinForms apps - Microsoft Edge Development | Microsoft Learn</a></p> 
<p></p> 
<hr> 
<p></p> 
<h3><strong>Chromium</strong> 與 <strong>Google Chrome</strong> 共享大部分程式碼</h3> 
<p>基於 <strong>Chromium</strong> 內核編譯的瀏覽器、並且著重於保護瀏覽器隱私項目 Microsoft Edge 封裝、在 C# 中使用 Edge Web.WebView2，需要確定電腦上已安裝 Microsoft Edge 版本 80 或更高版本、而且在 Visual Studio 工具箱中使用 NuGet 管理器安裝 Microsoft.Edge.WebView2 NuGet 。</p> 
<p></p> 
<hr> 
<p></p> 
<h3>Microsoft <strong>Edge</strong> <strong>Chromium</strong></h3> 
<p>Class 經典版 Edge 正式退役後，Microsoft 微軟將會把大部分中心都放在新版 Edge <strong>Chromium</strong> 提供支持當前 Web 技術。</p> 
<p>未知 Internet Explorer 瀏覽器淘汰後，如果應用於本機的程式會如何，<strong>WebBrowser</strong> 改變為 <strong>WebView2</strong> 例如 document.execCommand("cut") 安全考量，以及細微版面變化，但仍然是應該隨時代進步來跟隨。</p> 
<p></p> 
<hr> 
<p></p> 
<h3>註冊表修改 <strong>webbrowser</strong> 指定內核為 IE11</h3> 
<p>電腦\HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION</p> 
<p>11001(0x2AF9) - Internet Explorer11。無論！DOCTYPE 指令如何，網頁均以 IE11 edge mode 顯示。<br> 11000(0x2AF8) - Internet Explorer11。包含基於標準！DOCTYPE 指令的網頁以 IE11 edge mode 顯示。IE11 的默認值。</p> 
<p>修正的結果仍然不支持當前 Web 技術 HTML、CSS、JavaScript 建議使用 <strong>WebView2</strong> 更換，應用程序亦能升級。</p> 
<p></p> 
<p>网页来源：<a href="http://www.eion.com.tw/Blogger/?Pid=1138" rel="nofollow" title="C# WinForms 使用 Edge Web.WebView2">C# WinForms 使用 Edge Web.WebView2</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7afa34d6704071ad7135c2f6933e7c4c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Hyper-V安装Centos &#43; 配置Centos repo &#43; 解决wifi连接和固定ip访问Cetos问题 &#43; 其它零碎问题 &#43; 远程访问（转载&#43;经过修改版本 &#43; 问题补充版本 &#43; 补充部分）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6c45bd79ce4f49be56f753f86fa68566/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Illuminate\Database\QueryException : SQLSTATE[42000]: Syntax error or access violation: 1071 Speci</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>