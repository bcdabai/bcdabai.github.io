<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NLP自然语言处理：Word2Vector基本介绍 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NLP自然语言处理：Word2Vector基本介绍" />
<meta property="og:description" content="什么是Word2Vecto Word2vec是一种用于将词语表示为向量的技术，它可以将每个词语映射到一个固定长度的向量空间。这些向量可以用于许多自然语言处理应用程序，如词语相似度计算和分类。Word2vec的主要优势在于它可以将相似的词语映射到接近的向量空间中，因此在许多情况下可以更准确地表示语义相似性。
Word2Vector的工作原理 Word2vec的工作原理基于神经网络语言模型，它将词语表示为向量，并学习语料库中的词汇之间的相关性和语义关系。Word2vec通过分析语料库中的词语序列来学习这些关系，并使用这些关系来预测语料库中的下一个词语。在训练过程中，Word2vec会更新每个词语的向量来更好地表示它们的语义。最终，Word2vec会生成一个词语向量空间，其中每个词语都被表示为一个向量。这些向量可以用于许多自然语言处理应用程序，如词语相似度计算和语义分类。
通常，Word2Vec模型都使用词嵌入（word embedding）来表示单词。词嵌入是将单词映射到向量空间中的连续实值向量，能够保留单词之间的相似度和语义信息。
例如，它可以找到相似的单词，或者通过简单的数学运算来推断单词的语义。
例如，如果我们想找到“苹果”和“香蕉”的相似单词，可以在Word2Vec词嵌入空间中找到与这两个单词相似度最高的单词。
或者，如果我们想推断“苹果”和“香蕉”的关系，可以通过计算它们在Word2Vec词嵌入空间中的向量之差来推断它们之间的关系。
例如，如果“苹果”和“香蕉”的词嵌入向量之差较小，那么它们之间的关系就可能比较密切，例如它们都是水果。
Word2Vec算法解决什么问题 Word2Vec算法主要用来解决自然语言处理中的一个重要问题：如何将词语映射到向量空间中。
在自然语言处理中，我们经常需要处理大量文本数据。但是，由于人类语言的复杂性，文本数据往往难以直接处理。
例如，如果我们想要找到两个词语之间的相似度，我们就需要找到一种方法来表示它们。否则，电脑无法理解它们之间的差异，也无法计算它们之间的相似度。
Word2Vec算法就是用来解决这个问题的。它通过学习大量文本数据，来捕捉单词之间的相似度和语义信息。然后，通过词嵌入（word embedding）的方法，将单词映射到向量空间中。
这样，我们就可以使用电脑能够理解的向量数据来表示词语，并计算它们之间的相似度。这样，我们就可以在自然语言处理中，处理大量文本数据，并进行一些有用的操作。
Word2Vector有哪些模型 Word2vec有两种主要模型：一种是基于神经网络的模型，称为Continuous Bag-of-Words (CBOW)模型；另一种是基于深度学习的模型，称为Skip-Gram模型。这两种模型都用于将词语表示为向量，但是它们的训练方法略有不同。CBOW模型通常更快，因为它的训练需要更少的迭代，而Skip-Gram模型通常更准确，因为它能够更好地捕捉上下文语境中的词语关系。
Skip-Gram模型
Skip-Gram模型工作原理是，给定一个词，预测与它相邻的词，使用如下的公式来表示词向量之间的相似度： w i ⋅ w j = ∑ k = 1 n w i k ⋅ w j k w_{i} \cdot w_{j} = \sum_{k=1}^{n} w_{ik} \cdot w_{jk} wi​⋅wj​=k=1∑n​wik​⋅wjk​
其中， w i w_{i} wi​和 w j w_{j} wj​是两个词向量， n n n是词向量的维度， w i k w_{ik} wik​和 w j k w_{jk} wjk​分别表示 w i w_{i} wi​和 w j w_{j} wj​中第 k k k个元素的值。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/161e225891ca127d7e01351990007652/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-08T23:08:27+08:00" />
<meta property="article:modified_time" content="2022-12-08T23:08:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NLP自然语言处理：Word2Vector基本介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Word2Vecto_2"></a>什么是Word2Vecto</h2> 
<blockquote> 
 <p>Word2vec是一种用于将词语表示为向量的技术，它可以将每个词语映射到一个固定长度的向量空间。这些向量可以用于许多自然语言处理应用程序，如词语相似度计算和分类。Word2vec的主要优势在于它可以将相似的词语映射到接近的向量空间中，因此在许多情况下可以更准确地表示语义相似性。</p> 
</blockquote> 
<h2><a id="Word2Vector_7"></a>Word2Vector的工作原理</h2> 
<blockquote> 
 <p>Word2vec的工作原理基于神经网络语言模型，它将词语表示为向量，并学习语料库中的词汇之间的相关性和语义关系。Word2vec通过分析语料库中的词语序列来学习这些关系，并使用这些关系来预测语料库中的下一个词语。在训练过程中，Word2vec会更新每个词语的向量来更好地表示它们的语义。最终，Word2vec会生成一个词语向量空间，其中每个词语都被表示为一个向量。这些向量可以用于许多自然语言处理应用程序，如词语相似度计算和语义分类。</p> 
 <ul><li> <p>通常，Word2Vec模型都使用词嵌入（word embedding）来表示单词。词嵌入是将单词映射到向量空间中的连续实值向量，能够保留单词之间的相似度和语义信息。</p> </li><li> <p>例如，它可以找到相似的单词，或者通过简单的数学运算来推断单词的语义。</p> </li><li> <p>例如，如果我们想找到“苹果”和“香蕉”的相似单词，可以在Word2Vec词嵌入空间中找到与这两个单词相似度最高的单词。</p> </li><li> <p>或者，如果我们想推断“苹果”和“香蕉”的关系，可以通过计算它们在Word2Vec词嵌入空间中的向量之差来推断它们之间的关系。</p> </li><li> <p>例如，如果“苹果”和“香蕉”的词嵌入向量之差较小，那么它们之间的关系就可能比较密切，例如它们都是水果。</p> </li></ul> 
</blockquote> 
<h2><a id="Word2Vec_20"></a>Word2Vec算法解决什么问题</h2> 
<blockquote> 
 <p>Word2Vec算法主要用来解决自然语言处理中的一个重要问题：如何将词语映射到向量空间中。</p> 
 <p>在自然语言处理中，我们经常需要处理大量文本数据。但是，由于人类语言的复杂性，文本数据往往难以直接处理。</p> 
 <p>例如，如果我们想要找到两个词语之间的相似度，我们就需要找到一种方法来表示它们。否则，电脑无法理解它们之间的差异，也无法计算它们之间的相似度。</p> 
 <p>Word2Vec算法就是用来解决这个问题的。它通过学习大量文本数据，来捕捉单词之间的相似度和语义信息。然后，通过词嵌入（word embedding）的方法，将单词映射到向量空间中。<br> 这样，我们就可以使用电脑能够理解的向量数据来表示词语，并计算它们之间的相似度。这样，我们就可以在自然语言处理中，处理大量文本数据，并进行一些有用的操作。</p> 
</blockquote> 
<h2><a id="Word2Vector_33"></a>Word2Vector有哪些模型</h2> 
<p>Word2vec有两种主要模型：一种是基于神经网络的模型，称为Continuous Bag-of-Words (CBOW)模型；另一种是基于深度学习的模型，称为Skip-Gram模型。这两种模型都用于将词语表示为向量，但是它们的训练方法略有不同。CBOW模型通常更快，因为它的训练需要更少的迭代，而Skip-Gram模型通常更准确，因为它能够更好地捕捉上下文语境中的词语关系。</p> 
<ol><li><strong>Skip-Gram模型</strong><br> Skip-Gram模型工作原理是，给定一个词，预测与它相邻的词，使用如下的公式来表示词向量之间的相似度：</li></ol> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           w 
          
         
           i 
          
         
        
          ⋅ 
         
         
         
           w 
          
         
           j 
          
         
        
          = 
         
         
         
           ∑ 
          
          
          
            k 
           
          
            = 
           
          
            1 
           
          
         
           n 
          
         
         
         
           w 
          
          
          
            i 
           
          
            k 
           
          
         
        
          ⋅ 
         
         
         
           w 
          
          
          
            j 
           
          
            k 
           
          
         
        
       
         w_{i} \cdot w_{j} = \sum_{k=1}^{n} w_{ik} \cdot w_{jk} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.59445em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.95351em; vertical-align: -1.30211em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          i 
         
        
       
      
        w_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          j 
         
        
       
      
        w_{j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是两个词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span>是词向量的维度，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
         
         
           i 
          
         
           k 
          
         
        
       
      
        w_{ik} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
         
         
           j 
          
         
           k 
          
         
        
       
      
        w_{jk} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别表示<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          i 
         
        
       
      
        w_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          j 
         
        
       
      
        w_{j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>中第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span></span>个元素的值。</p> 
<p>通过计算两个词向量之间的内积，我们可以得到它们之间的相似度。词向量之间的相似度越大，这两个词之间的相关性也就越大。</p> 
<p>Skip-Gram模型还有另一个重要的公式，它用于表示词向量的预测概率。该公式如下：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          ( 
         
         
         
           w 
          
         
           j 
          
         
        
          ∣ 
         
         
         
           w 
          
         
           i 
          
         
        
          ) 
         
        
          = 
         
         
          
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
           
           
             w 
            
           
             i 
            
           
          
            ⋅ 
           
           
           
             w 
            
           
             j 
            
           
          
            ) 
           
          
          
           
           
             ∑ 
            
            
            
              k 
             
            
              = 
             
            
              1 
             
            
           
             m 
            
           
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
           
           
             w 
            
           
             i 
            
           
          
            ⋅ 
           
           
           
             w 
            
           
             k 
            
           
          
            ) 
           
          
         
        
       
         P(w_{j}|w_{i}) = \frac{exp(w_{i} \cdot w_{j})}{\sum_{k=1}^{m} exp(w_{i} \cdot w_{k})} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">P</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.421em; vertical-align: -0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.30571em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.994002em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          i 
         
        
       
      
        w_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是中心词的词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          j 
         
        
       
      
        w_{j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是预测词的词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         m 
        
       
      
        m 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span>是语料库中不同词的总数。通过计算每个词向量与中心词词向量之间的内积，我们可以得到每个词在给定中心词的情况下的预测概率。</p> 
<p>在训练过程中，Skip-Gram模型的目标是通过最大化每个词的预测概率来学习到最好的词向量。通过这种方式，我们可以得到能够准确表达语言中词与词之间</p> 
<ol start="2"><li><strong>CBOW模型</strong><br> CBOW模型通过预测一个单词来学习词向量，而不是预测多个单词，CBOW模型使用如下的公式来表示词向量之间的相似度：</li></ol> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           w 
          
         
           i 
          
         
        
          ⋅ 
         
         
         
           w 
          
         
           j 
          
         
        
          = 
         
         
         
           ∑ 
          
          
          
            k 
           
          
            = 
           
          
            1 
           
          
         
           n 
          
         
         
         
           w 
          
          
          
            i 
           
          
            k 
           
          
         
        
          ⋅ 
         
         
         
           w 
          
          
          
            j 
           
          
            k 
           
          
         
        
       
         w_{i} \cdot w_{j} = \sum_{k=1}^{n} w_{ik} \cdot w_{jk} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.59445em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.95351em; vertical-align: -1.30211em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30211em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          i 
         
        
       
      
        w_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          j 
         
        
       
      
        w_{j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是两个词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span>是词向量的维度，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
         
         
           i 
          
         
           k 
          
         
        
       
      
        w_{ik} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
         
         
           j 
          
         
           k 
          
         
        
       
      
        w_{jk} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别表示<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          i 
         
        
       
      
        w_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          j 
         
        
       
      
        w_{j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>中第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
      
        k 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span style="margin-right: 0.03148em;" class="mord mathdefault">k</span></span></span></span></span>个元素的值。</p> 
<p>CBOW模型还有另一个重要的公式，它用于表示词向量的预测概率。该公式如下：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          ( 
         
         
         
           w 
          
         
           j 
          
         
        
          ∣ 
         
         
         
           w 
          
         
           i 
          
         
        
          ) 
         
        
          = 
         
         
          
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
           
           
             w 
            
           
             i 
            
           
          
            ⋅ 
           
           
           
             w 
            
           
             j 
            
           
          
            ) 
           
          
          
           
           
             ∑ 
            
            
            
              k 
             
            
              = 
             
            
              1 
             
            
           
             m 
            
           
          
            e 
           
          
            x 
           
          
            p 
           
          
            ( 
           
           
           
             w 
            
           
             i 
            
           
          
            ⋅ 
           
           
           
             w 
            
           
             k 
            
           
          
            ) 
           
          
         
        
       
         P(w_{j}|w_{i}) = \frac{exp(w_{i} \cdot w_{j})}{\sum_{k=1}^{m} exp(w_{i} \cdot w_{k})} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">P</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.421em; vertical-align: -0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.30571em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.804292em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.29971em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.03148em;" class="mord mathdefault mtight">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.994002em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          i 
         
        
       
      
        w_{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是中心词的词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          w 
         
        
          j 
         
        
       
      
        w_{j} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.716668em; vertical-align: -0.286108em;"></span><span class="mord"><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.02691em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是预测词的词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         m 
        
       
      
        m 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span>是语料库中不同词的总数。通过计算每个词向量与中心词词向量之间的内积，我们可以得到每个词在给定中心词的情况下的预测概率。</p> 
<p>在训练过程中，CBOW模型的目标是通过最大化每个词的预测概率来学习到最好的词向量。通过这种方式我们可以得到能够准确表达语言中词与词之间关系的词向量。</p> 
<h3><a id="CBOWSkipGram_68"></a>CBOW模型和Skip-Gram模型两者比较</h3> 
<blockquote> 
 <p>CBOW模型和Skip-Gram模型都是用于学习词向量的机器学习模型。它们的工作原理都是通过预测相邻的词来学习词向量，但它们在实现方式上有一些不同。</p> 
 <p>CBOW模型与Skip-Gram模型相比，有如下几个主要优点：</p> 
 <ul><li> <p>CBOW模型更加高效，因为它只需要通过预测一个单词来学习词向量，而不是预测多个单词。</p> </li><li> <p>CBOW模型更能够捕捉到语言中的上下文信息，因为它会考虑周围的多个词。 CBOW模型在处理长文本时更加稳定，因为它会平均考虑多个词的信息。<br> 但是，CBOW模型也存在一些缺点：</p> </li><li> <p>CBOW模型比Skip-Gram模型难以训练，因为它需要处理更多的词。</p> </li><li> <p>CBOW模型比Skip-Gram模型更容易受到噪声和偏差的影响，因为它会将多个词的信息平均化。</p> </li><li> <p>CBOW模型在处理小型语料库时可能不够准确，因为它需要更多的词才能得到有效的结果。<br> 总之，CBOW模型和Skip-Gram模型都是有效的方法，可以用于学习词向量。它们各有优缺点，应用时要根据实际情况来选择适合的模型。</p> </li></ul> 
 <p>一般来说，在处理大型语料库时，CBOW模型可能更加优秀，因为它更能够捕捉到语言中的上下文信息。但是，在处理小型语料库时，Skip-Gram模型可能更加优秀，因为它更容易训练，并且可以在较少的词数量下得到较好的结果。</p> 
 <p>另外，CBOW模型和Skip-Gram模型还有一个重要的区别，即它们对语言的理解方式不同。CBOW模型更加注重语言的上下文信息，而Skip-Gram模型更加注重语言的结构信息。这意味着，在某些应用场景下，某一种模型可能更加适合，因为它更好地理解了语言中的信息。</p> 
</blockquote> 
<h2><a id="Word2Vector_87"></a>Word2Vector的优点和缺点</h2> 
<blockquote> 
 <p>Word2vec有许多优点，例如它可以将词语表示为向量，并可以计算词语之间的相似度和语义关系；它还可以捕捉上下文语境中的词语关系，因此可以更准确地表示语义相似性；另外，Word2vec还可以用于许多自然语言处理应用程序，如语义相似度计算和情感分析。</p> 
 <p>然而，Word2vec也有一些缺点。例如，它需要大量的语料库来训练模型，并且训练时间可能很长；另外，Word2vec的结果可能受到语料库的偏差的影响，因此需要选择合适的语料库来训练模型。</p> 
</blockquote> 
<h2><a id="Word2Vector_94"></a>实际应用中Word2Vector的例子</h2> 
<blockquote> 
 <p>Word2vec在实际应用中可以用于许多自然语言处理应用程序。例如，它可以用于语义相似度计算，可以用于情感分析，也可以用于语音识别和机器翻译等。例如，在语义相似度计算中，Word2vec可以用来找出语料库中最相似的词语。在情感分析中，Word2vec可以用来识别文本中的情感倾向。在语音识别和机器翻译中，Word2vec可以用来提高准确度。总之，Word2vec在自然语言处理中有着广泛的应用。</p> 
</blockquote> 
<h2><a id="Word2Vector_98"></a>如何训练Word2Vector模型</h2> 
<p>训练Word2vec模型的基本步骤如下：</p> 
<blockquote> 
 <ol><li> <p>首先，需要准备足够大的语料库来训练模型。语料库应该是原始的、有效的、准确的，并且应尽量避免语言偏差和错误。</p> </li><li> <p>然后，需要选择一种Word2vec模型，例如CBOW模型或Skip-Gram模型。这两种模型的训练方法略有不同，但都是基于神经网络的语言模型。</p> </li><li> <p>接下来，需要准备好模型的超参数，例如词向量维度、学习速率、正则化系数等。这些超参数会影响模型的训练过程和结果</p> </li><li> <p>接着，需要选择一种优化算法来更新模型的参数。常用的优化算法包括随机梯度下降法（SGD）、Adam优化器等。</p> </li><li> <p>最后，需要运行模型并训练模型。训练过程中，模型会自动学习语料库中词语之间的相关性和语义关系，并更新词语向量以更准确地表示语义。训练时间可能会比较长，具体取决于语料库的大小和模型的复杂度。</p> </li><li> <p>训练完成后，模型会生成一个词语向量空间，其中每个词语都被表示为一个向量。这些向量可以用于许多自然语言处理应用程序，如词语相似度计算和语义分类。通过使用Word2vec训练的模型，可以更准确地捕捉语料库中的语义信息，并可以用于许多自然语言处理应用程序。</p> </li></ol> 
</blockquote> 
<h2><a id="Word2Vector_114"></a>如何选择合适的语料库来训练Word2Vector模型</h2> 
<blockquote> 
 <p>选择合适的语料库来训练Word2vec模型是非常重要的，因为语料库的质量直接影响Word2vec模型的质量。在选择语料库时，应该考虑以下几个因素：</p> 
 <ul><li>语料库的大小：语料库越大，Word2vec模型越准确。因此，应选择尽可能大的语料库来训练模型。</li><li>语料库的广度和深度：语料库应尽可能涵盖广泛的话题，并深入地探讨每个话题。这样，Word2vec模型才能更准确地表示语义。</li><li>语料库的质量：语料库应该是原始的、有效的、准确的，并且应尽量避免语言偏差和错误。这样，Word2vec模型才能更准确地反映语料库中的语义信息。</li></ul> 
 <p>通过考虑这些因素，可以选择合适的语料库来训练Word2vec模型。</p> 
</blockquote> 
<h2><a id="Word2Vec_125"></a>Word2Vec算法优化有哪些</h2> 
<p>Word2Vec算法主要通过两种方式来进行优化：<strong>负采样</strong>和<strong>层级Softmax</strong>。</p> 
<ul><li><strong>负采样</strong>是Word2Vec算法的一种常用优化方法，它的目的是通过对语料库中的词语进行采样来减少模型训练时的计算量。具体来说，负采样会从语料库中挑选一小部分词语作为“负样本”，模型在训练时只会用这些负样本来计算与相邻词语的关系，而不会用所有词语来计算。这样，模型在训练时的计算量就会大大减少，从而可以提高模型的训练速度。其公式为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           J 
          
         
           ( 
          
         
           θ 
          
         
           ) 
          
         
           = 
          
          
          
            1 
           
          
            T 
           
          
          
          
            ∑ 
           
           
           
             t 
            
           
             = 
            
           
             1 
            
           
          
            T 
           
          
          
          
            ∑ 
           
           
           
             − 
            
           
             m 
            
           
             ≤ 
            
           
             j 
            
           
             ≤ 
            
           
             m 
            
           
             , 
            
           
             j 
            
           
             ≠ 
            
           
             0 
            
           
          
         
           [ 
          
         
           l 
          
         
           o 
          
         
           g 
          
         
           σ 
          
         
           ( 
          
          
          
            u 
           
          
            ⃗ 
           
          
          
          
            o 
           
          
            T 
           
          
          
          
            v 
           
          
            ⃗ 
           
          
          
          
            c 
           
          
            ( 
           
          
            t 
           
          
            + 
           
          
            j 
           
          
            ) 
           
          
         
           ) 
          
         
           − 
          
         
           l 
          
         
           o 
          
         
           g 
          
         
           σ 
          
         
           ( 
          
         
           − 
          
          
          
            u 
           
          
            ⃗ 
           
          
          
          
            o 
           
          
            T 
           
          
          
          
            v 
           
          
            ⃗ 
           
          
          
          
            c 
           
          
            ( 
           
          
            t 
           
          
            + 
           
          
            j 
           
          
            ) 
           
          
         
           ) 
          
         
           ] 
          
         
        
          J(\theta)=\frac{1}{T}\sum_{t=1}^{T}\sum_{-m\leq j\leq m,j\neq 0}[log\sigma(\vec{u}o^T\vec{v}{c(t+j)})-log\sigma(-\vec{u}o^T\vec{v}{c(t+j)})] 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.09618em;" class="mord mathdefault">J</span><span class="mopen">(</span><span style="margin-right: 0.02778em;" class="mord mathdefault">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.26656em; vertical-align: -1.43822em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32144em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.82834em;"><span class="" style="top: -1.88289em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.26711em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.84789em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">m</span><span class="mrel mtight">≤</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span class="mrel mtight">≤</span><span class="mord mathdefault mtight">m</span><span class="mpunct mtight">,</span><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="rlap mtight"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mtight">0</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.43822em;"><span class=""></span></span></span></span></span><span class="mopen">[</span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mord mathdefault">o</span><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
              <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
               <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
              </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
              <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
               <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
              </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mclose">)</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.14133em; vertical-align: -0.25em;"></span><span style="margin-right: 0.01968em;" class="mord mathdefault">l</span><span class="mord mathdefault">o</span><span style="margin-right: 0.03588em;" class="mord mathdefault">g</span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
              <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
               <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
              </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
              <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
               <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
              </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mclose">)</span></span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></span></li></ul> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          u 
         
        
          ⃗ 
         
        
       
         o 
        
       
      
        \vec{u}o 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.714em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord mathdefault">o</span></span></span></span></span>表示目标词语的词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          ⃗ 
         
        
        
        
          c 
         
        
          ( 
         
        
          t 
         
        
          + 
         
        
          j 
         
        
          ) 
         
        
       
      
        \vec{v}{c(t+j)} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mclose">)</span></span></span></span></span></span>表示上下文词语的词向量，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         σ 
        
       
         ( 
        
        
        
          u 
         
        
          ⃗ 
         
        
        
        
          o 
         
        
          T 
         
        
        
        
          v 
         
        
          ⃗ 
         
        
        
        
          c 
         
        
          ( 
         
        
          t 
         
        
          + 
         
        
          j 
         
        
          ) 
         
        
       
         ) 
        
       
      
        \sigma(\vec{u}o^T\vec{v}{c(t+j)}) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.09133em; vertical-align: -0.25em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">σ</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault">u</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">o</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.03588em;" class="mord mathdefault">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">c</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span style="margin-right: 0.05724em;" class="mord mathdefault">j</span><span class="mclose">)</span></span><span class="mclose">)</span></span></span></span></span>表示该词语与上下文词语的关系的概率，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         T 
        
       
      
        T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">T</span></span></span></span></span>表示语料库中的总词语数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         m 
        
       
      
        m 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span>表示相邻词语的数量。</p> 
<ul><li><strong>层级Softmax</strong>也是一种常用的Word2Vec算法优化方法。它的原理是，在计算与相邻词语之间的关系时，模型不再对所有词语进行计算，而是将词语划分为不同的类别，并只计算与类别中的词语之间的关系。这样，模型在计算相邻词语之间的关系时的计算量就会减少，从而可以提高模型的训练速度。<br> 在Word2Vec中，每个单词都有一个相应的词向量。层级Softmax通过计算词向量之间的内积来预测下一个单词。具体来说，层级Softmax将会计算出一个长度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          V 
         
        
       
         V 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span></span></span></span></span>的概率分布，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          V 
         
        
       
         V 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span></span></span></span></span>是语料库中单词总数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>个单词，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          w 
         
        
       
         w 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span></span></span></span></span>表示当前单词，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
       
         c 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span>表示上下文单词，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           u 
          
         
           w 
          
         
        
       
         u_w 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.02691em;" class="mord mathdefault mtight">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           u 
          
         
           c 
          
         
        
       
         u_c 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别表示当前单词<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          w 
         
        
       
         w 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span></span></span></span></span>和上下文单词<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
       
         c 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span>的词向量。</li></ul> 
<p>具体的，层级Softmax的计算公式如下：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          P 
         
        
          ( 
         
        
          i 
         
        
          ∣ 
         
        
          w 
         
        
          , 
         
        
          c 
         
        
          ) 
         
        
          = 
         
         
          
          
            exp 
           
          
            ⁡ 
           
          
            ( 
           
           
           
             u 
            
           
             i 
            
           
             T 
            
           
           
           
             u 
            
           
             c 
            
           
          
            ) 
           
          
          
           
           
             ∑ 
            
            
            
              j 
             
            
              = 
             
            
              1 
             
            
           
             V 
            
           
          
            exp 
           
          
            ⁡ 
           
          
            ( 
           
           
           
             u 
            
           
             j 
            
           
             T 
            
           
           
           
             u 
            
           
             c 
            
           
          
            ) 
           
          
         
        
       
         P(i|w,c)=\frac{\exp(u_i^T u_c)}{\sum_{j=1}^V \exp(u_j^T u_c)} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord">∣</span><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.82538em; vertical-align: -1.30705em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.51833em;"><span class="" style="top: -2.12877em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: -0.000005em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.981231em;"><span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.22222em;" class="mord mathdefault mtight">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.435818em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.823131em;"><span class="" style="top: -2.42314em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.05724em;" class="mord mathdefault mtight">j</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.412972em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.44134em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span style="margin-right: 0.13889em;" class="mord mathdefault mtight">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.258664em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.30705em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>这个公式的意思是：对于当前单词<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         w 
        
       
      
        w 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span></span></span></span></span>和上下文单词<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         c 
        
       
      
        c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span>，给定<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         V 
        
       
      
        V 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span style="margin-right: 0.22222em;" class="mord mathdefault">V</span></span></span></span></span>个不同的单词，预测出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>单词出现的概率为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         P 
        
       
         ( 
        
       
         i 
        
       
         ∣ 
        
       
         w 
        
       
         , 
        
       
         c 
        
       
         ) 
        
       
      
        P(i|w,c) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span style="margin-right: 0.13889em;" class="mord mathdefault">P</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord">∣</span><span style="margin-right: 0.02691em;" class="mord mathdefault">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span></span>。这个概率值是通过计算<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         i 
        
       
      
        i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>单词向量与上下文单词向量的内积并进行归一化处理得到的。</p> 
<p>总的来说，层级Softmax是一种通过计算词向量之间的相似度来预测下一个单词的概率分布的算法。</p> 
<h2><a id="Word2Vector_143"></a>如何评估Word2Vector模型的质量</h2> 
<p>评估Word2vec模型的质量需要通过一些指标来衡量。常用的指标包括准确率、召回率、F1值等。这些指标可以用来衡量模型对于相似度计算或语义分类任务的准确性。</p> 
<p>例如，对于相似度计算任务，可以通过计算模型预测的相似度与人工标注的相似度之间的差异来评估模型的质量。如果差异较小，则表明模型的质量较高；如果差异较大，则表明模型的质量较低。</p> 
<p>对于语义分类任务，可以通过查准率、召回率和F1值来评估模型的质量。查准率衡量的是模型分类的准确性，召回率衡量的是模型分类的覆盖率，而F1值则是查准率和召回率的调和平均值。如果模型的查准率和召回率都较高，则表明模型的质量较高；如果某一项值较低，则表明模型的质量较低。</p> 
<p>需要注意的是，评估Word2vec模型的质量需要根据具体应用场景来确定评估指标和评估方法。例如，对于相似度计算任务，可以使用均方差或相关系数作为评估指标；对于语义分类任务，可以使用查准率、召回率和F1值作为评估指标。</p> 
<p>另外，还可以使用一些常见的评估数据集来评估Word2vec模型的质量。例如，可以使用Google的语义等价类数据集（Google Analogies）来评估模型的语义相似度计算能力；也可以使用常见的语料库，如新闻数据集（20 Newsgroups）或博客数据集（Blog Authorship Corpus），来评估模型的语义分类能力。</p> 
<p>通过这些评估指标和评估数据集，可以对Word2vec模型的质量进行准确的评估。此外，还可以通过交叉验证的方法来评估模型的泛化能力，即模型在未知数据上的表现。通过这些评估方法，可以确定模型的质量，并可以提出改进模型的建议。</p> 
<p>此外，还可以通过可视化技术来评估Word2vec模型的质量。例如，可以通过对词语向量进行降维，并在二维平面上绘制词语向量，来可视化模型学习到的语义信息。这样，可以直观地看到词语之间的相关性和语义关系，并可以快速发现模型学习到的语义信息的特点和问题。</p> 
<p>例如，假设模型学习到的语义信息表示了动物类别和动物属性之间的关系。如果对词语向量进行降维并绘制在二维平面上，则可以看到不同类别的动物词语向量分布在不同的区域，而不同属性的动物词语向量则分布在不同的方向。这样，就可以直观地看到模型学习到的语义信息，并可以快速发现模型学习到的语义信息的特点和问题。</p> 
<p>通过这些评估方法，可以更准确地评估Word2vec模型的质量，并可以提出改进模型的建议。这样，可以保证模型的质量，并且可以有效地应用模型来解决实际问题。</p> 
<p>需要注意的是，评估Word2vec模型的质量需要综合考虑各种指标和方法。例如，可以通过评估指标来衡量模型对于相似度计算或语义分类任务的准确性；也可以通过可视化技术来直观地看到模型学习到的语义信息，并快速发现问题。</p> 
<p>另外，评估Word2vec模型的质量还需要考虑实际应用场景的特点。例如，如果模型用于处理大规模的语料库，则需要注重模型的计算效率和内存占用；如果模型用于处理实时数据，则需要注重模型的处理速度和响应时间。</p> 
<p>综上所述，评估Word2vec模型的质量需要综合考虑各种指标和方法，并需要根据实际应用场景的特点来选择合适的评估方法。通过这些评估方法，可以更准确地评估Word2vec模型的质量，并可以提出改进模型的建议。</p> 
<h2><a id="TfIdfWord2VecBERT_168"></a>「Tf-Idf、Word2Vec和BERT」三种模型比较</h2> 
<blockquote> 
 <p>在自然语言处理(NLP)中，文本分类是一项常见的任务，它涉及将文本文档分配到一个或多个预先定义的类别中。Tf-Idf、Word2Vec和BERT是三种常用的文本分类模型，它们各有其优缺点。</p> 
 <ol><li>Tf-Idf是一种基于词频和逆文档频率的算法，它可以捕捉文档中单词的重要性。这种模型通常用于自动提取文档的关键字，并将文档分配到相应的类别中。它的优点在于简单易用，但缺点在于无法考虑词语之间的语义关系，因此在处理复杂文本时可能效果不佳。</li><li>Word2Vec是一种基于神经网络的模型，它能够将每个单词表示为一个向量，并考虑词语之间的语义关系。这种模型可以用于文本聚类和分类，它的优点在于能够捕捉词语之间的语义关系，但缺点在于训练时间较长，对于长文本的处理效果可能不理想。</li><li>BERT是一种基于双向语言模型的深度学习模型，它能够自动学习文本中的语义和语法结构。这种模型可以用于多种NLP任务，包括文本分类。BERT的优点在于能够对输入文本做出更好的建模，并且可以自动学习语义和语法信息。然而，这种模型的缺点在于训练时间较长，并且对于小型文本数据集效果可能不佳。</li></ol> 
 <p>总的来说，Tf-Idf、Word2Vec和BERT是三种常用的文本分类模型，它们各有优缺点。Tf-Idf简单易用，但无法考虑词语之间的语义关系；Word2Vec能够考虑语义关系，但训练时间较长；BERT能够对文本做出更好的建模，但对于小型数据集可能不够优秀。因此，在选择文本分类模型时，应该根据具体情况选择合适的模型。</p> 
</blockquote> 
<h2><a id="Word2Vec__fastText_179"></a>Word2Vec 和 fastText</h2> 
<p>Word2Vec 和 fastText 都是通过神经网络来训练词向量的方法。它们的目的都是将每个词映射到一个固定大小的向量空间中，使得词与词之间的相似度能够通过向量空间中的距离来表示。</p> 
<p>不同之处在于，Word2Vec 是一种基于滑动窗口的方法，它考虑每个词与其相邻的上下文词之间的关系来训练词向量；而 fastText 则是一种基于 n-gram 的方法，它考虑每个词与它的子词之间的关系来训练词向量。</p> 
<p>举个例子，如果我们要训练一个 Word2Vec 模型，可能会有这样的一个句子：“the cat sat on the mat”。假设我们的滑动窗口大小是 2，那么我们会考虑这些词对：</p> 
<ul><li> <p>(the, cat)</p> </li><li> <p>(cat, sat)</p> </li><li> <p>(sat, on)</p> </li><li> <p>(on, the)</p> </li><li> <p>(the, mat)<br> 如果我们要训练一个 fastText 模型，我们会考虑这些 n-gram：</p> </li><li> <p>(the, cat, sat)</p> </li><li> <p>(cat, sat, on)</p> </li><li> <p>(sat, on, the)</p> </li><li> <p>(on, the, mat)</p> </li><li> <p>(the, mat)</p> </li><li> <p>(cat, sat)</p> </li><li> <p>(sat, on)</p> </li><li> <p>(on, the)</p> </li><li> <p>(the, mat)<br> 通过考虑这些词对和 n-gram，我们就可以训练出每个词的向量表示。</p> </li></ul> 
<h2><a id="Word2VecfastText__Glove__205"></a>Word2Vec、fastText 和 Glove 比较</h2> 
<blockquote> 
 <p>Word2Vec、fastText 和 Glove 是三种用于自然语言处理中的词嵌入方法。</p> 
 <ul><li> <p>Word2Vec 是最早提出的一种词嵌入方法，它通过预测词语上下文来学习词向量。它使用了两种模型：CBOW 和 Skip-gram。CBOW<br> 预测目标词语，通过上下文预测其出现的概率；Skip-gram 预测上下文，通过目标词语预测其出现的概率。</p> </li><li> <p>fastText 是一种由 Facebook 提出的词嵌入方法，它针对短文本进行了优化。fastText不仅会学习词语的词向量，还会学习词语的子词语的词向量，这样能够更好地处理带有外语或非法词的文本。</p> </li><li> <p>Glove是一种由斯坦福大学提出的词嵌入方法，它使用了单词共现矩阵来学习词向量。单词共现矩阵统计了一个词语与其它词语出现在同一上下文中的次数，然后通过矩阵分解来学习词向量。</p> </li></ul> 
 <p>总的来说，这三种词嵌入方法都能够将词语映射到低维空间中的实数向量，并通过这些向量的线性组合来捕捉词语之间的关系。然而，它们之间也有一些不同之处，例如模型构建方式、适用场景等。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/52f83c7637102f348f76513b9ebf45b6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CPU架构与指令集的关系</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6be811a0f94f2ebdf76fb4876f5f19f3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">集成springSecurity遇到的跨域问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>