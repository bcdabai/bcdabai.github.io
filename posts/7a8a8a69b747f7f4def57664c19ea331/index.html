<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>高性能MySQL阅读笔记 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="高性能MySQL阅读笔记" />
<meta property="og:description" content="目录 一：MySQL架构与历史1.1：MySQL逻辑架构优化与执行 1.2：并发控制1：读写锁2：锁粒度3：表锁4：行锁 1.3：事务隔离级别事务日志MySQL中的事务隐式和显示锁定 1.4：多版本并发控制 二：schema与数据类型优化1：选择优化的数据类型1.1:整数类型1.2:实数类型1.3：字符串类型1.4：枚举1.5：日期和时间类型 三：创建高新能的索引1：索引基础1.1：索引的类型 一：MySQL架构与历史 MySQL最重要，最与众不同的特性是它的存储引擎架构，这种架构的设计将查询处理及其他系统任务和数据的存储/提取相分离。
1.1：MySQL逻辑架构 优化与执行 MySQL会解析查询，并创建内部数据结构（解析树），然后对其进行各种优化，包括重写查询，决定表的读取顺序，以及选择合适的索引等。
优化器并不关心表使用什么存储引擎，但存储引擎对于优化查询是有影响的
1.2：并发控制 1：读写锁 2：锁粒度 问题是加锁也需要消耗资源。锁的各种操作，都会增加系统的开销。吴国花费大量的时间来管理锁，而不是存取数据，那么系统的性能会收到影响
mysql提供了多种选择，每种mysql存储引擎都可以实现自己的锁策略和锁粒度
3：表锁 4：行锁 1.3：事务 ACID
原子性，一致性，隔离性，持久性
隔离级别 事务日志 MySQL中的事务 隐式和显示锁定 1.4：多版本并发控制 二：schema与数据类型优化 良好的逻辑设计和物理设计是高性能的基石，应该根据系统要执行的查询语句来设计schema，这往往需要权衡各种因素。
例如反范式的设计 和计数表，汇总表的添加。
1：选择优化的数据类型 几个简单的原则：
更小的通常更好 一般情况下，尽可能的选择可以正确存储数据的最小数据类型。更小的数据类型通常更快，因为它们占用更少的磁盘，内存和CPU缓存，并且处理时需要的CPU周期也更少。但是要确保没有低估需要存储的值的范围。
简单就好 简单的数据类型的操作通常需要更少的CPU周期
尽量避免NULL 列属性可为NULL是一个默认的属性，但是最好指定列NOT NULL，除非真的需要存储NULL值,因为包含NULL的列，在查询中对于MySQL来说更难优化，因为可为NULL的列使得索引，索引统计和值比较都更复杂。
1.1:整数类型 有两种类型的数字：整数 和 实数。整数是其中之一
整数的数据类型：
TINYINT 8位SMALLINT 16位MEDIUMINT 24位INT 32位BIGINT 62位 它们可以存储的值的范围是-2(n-1)到2（n-)-1，其中n是存储空间的位数.
可选用的属性：UNSIGNED。表示不允许有负值，这可以使得正数的上限提高一倍。
1.2:实数类型 实数是带有小数部分的数字。
float和double类型支持使用标准（原生）的浮点近似计算。
decimal类型用于存储精确的小数
由于CPU不支持对DECIMAL的直接计算，所以MySQL5.0后，MySQL服务器自己实现了DECIMAL的高精度计算。相对而言，CPU直接支持的原生浮点计算更快一些。
指定精度：decimal(18,9)表示一共18位数字，小数点后9位。
1.3：字符串类型 在innodb中
varchar：
存储可变长字符串,比定长类型更节省空间。varchar需要使用1或者2个额外的字节记录字符串的长度：如果列的最大长度小于等于255字节，则只用一个字节表示，否则使用两个字节表示。
char:
BLOB与TEXT：
1.4：枚举 枚举：
1.5：日期和时间类型 日期和时间类型" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7a8a8a69b747f7f4def57664c19ea331/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-18T13:48:33+08:00" />
<meta property="article:modified_time" content="2021-06-18T13:48:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">高性能MySQL阅读笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#MySQL_2" rel="nofollow">一：MySQL架构与历史</a></li><li><ul><li><a href="#11MySQL_6" rel="nofollow">1.1：MySQL逻辑架构</a></li><li><ul><li><a href="#_9" rel="nofollow">优化与执行</a></li></ul> 
   </li><li><a href="#12_14" rel="nofollow">1.2：并发控制</a></li><li><ul><li><a href="#1_15" rel="nofollow">1：读写锁</a></li><li><a href="#2_18" rel="nofollow">2：锁粒度</a></li><li><a href="#3_25" rel="nofollow">3：表锁</a></li><li><a href="#4_28" rel="nofollow">4：行锁</a></li></ul> 
   </li><li><a href="#13_31" rel="nofollow">1.3：事务</a></li><li><ul><li><a href="#_38" rel="nofollow">隔离级别</a></li><li><a href="#_41" rel="nofollow">事务日志</a></li><li><a href="#MySQL_43" rel="nofollow">MySQL中的事务</a></li><li><a href="#_46" rel="nofollow">隐式和显示锁定</a></li></ul> 
   </li><li><a href="#14_49" rel="nofollow">1.4：多版本并发控制</a></li></ul> 
  </li><li><a href="#schema_53" rel="nofollow">二：schema与数据类型优化</a></li><li><ul><li><a href="#1_58" rel="nofollow">1：选择优化的数据类型</a></li><li><ul><li><a href="#11_69" rel="nofollow">1.1:整数类型</a></li><li><a href="#12_85" rel="nofollow">1.2:实数类型</a></li><li><a href="#13_96" rel="nofollow">1.3：字符串类型</a></li><li><a href="#14_115" rel="nofollow">1.4：枚举</a></li><li><a href="#15_123" rel="nofollow">1.5：日期和时间类型</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_132" rel="nofollow">三：创建高新能的索引</a></li><li><ul><li><a href="#1_135" rel="nofollow">1：索引基础</a></li><li><ul><li><a href="#11_138" rel="nofollow">1.1：索引的类型</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="MySQL_2"></a>一：MySQL架构与历史</h2> 
<p>MySQL最重要，最与众不同的特性是它的存储引擎架构，这种架构的设计将查询处理及其他系统任务和数据的存储/提取相分离。</p> 
<h3><a id="11MySQL_6"></a>1.1：MySQL逻辑架构</h3> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/67/9e/GLcNJ7wz_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/db/85/VQisktPI_o.png"></p> 
<h4><a id="_9"></a>优化与执行</h4> 
<p>MySQL会解析查询，并创建内部数据结构（解析树），然后对其进行各种优化，包括重写查询，决定表的读取顺序，以及选择合适的索引等。</p> 
<p>优化器并不关心表使用什么存储引擎，但存储引擎对于优化查询是有影响的</p> 
<h3><a id="12_14"></a>1.2：并发控制</h3> 
<h4><a id="1_15"></a>1：读写锁</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/50/7f/DhpGWXgl_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/4a/0a/6EWM01Ec_o.png"></p> 
<h4><a id="2_18"></a>2：锁粒度</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/bd/e6/TRX3tqwX_o.png"></p> 
<blockquote> 
 <p>问题是加锁也需要消耗资源。锁的各种操作，都会增加系统的开销。吴国花费大量的时间来管理锁，而不是存取数据，那么系统的性能会收到影响</p> 
</blockquote> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/9a/e3/D1KuTTyM_o.png"><br> <strong>mysql提供了多种选择，每种mysql存储引擎都可以实现自己的锁策略和锁粒度</strong></p> 
<h4><a id="3_25"></a>3：表锁</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/f1/5a/4Zjal4PR_o.png"></p> 
<h4><a id="4_28"></a>4：行锁</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/c6/e5/wvkRLMed_o.png"></p> 
<h3><a id="13_31"></a>1.3：事务</h3> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/f2/2kWlCFSD_o.png"></p> 
<blockquote> 
 <p>ACID<br> 原子性，一致性，隔离性，持久性</p> 
</blockquote> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/60/pYEcynsQ_o.png"></p> 
<h4><a id="_38"></a>隔离级别</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/28/f9/fPm5J7DX_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/20/cb/7dS6Len9_o.png"></p> 
<h4><a id="_41"></a>事务日志</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/68/82/eIJV1hNY_o.png"></p> 
<h4><a id="MySQL_43"></a>MySQL中的事务</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/4c/c7/HRnxxKle_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/a7/f5/AmlwsKTC_o.png"></p> 
<h4><a id="_46"></a>隐式和显示锁定</h4> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/bc/57/lnrSPLdq_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/63/c3/ikHInNFV_o.png"></p> 
<h3><a id="14_49"></a>1.4：多版本并发控制</h3> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/17/HaamIKXk_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/8b/7e/ATppsLPu_o.png"></p> 
<h2><a id="schema_53"></a>二：schema与数据类型优化</h2> 
<p>良好的逻辑设计和物理设计是高性能的基石，应该根据系统要执行的查询语句来设计schema，这往往需要权衡各种因素。</p> 
<blockquote> 
 <p>例如反范式的设计 和计数表，汇总表的添加。</p> 
</blockquote> 
<h3><a id="1_58"></a>1：选择优化的数据类型</h3> 
<p><strong>几个简单的原则：</strong></p> 
<ul><li>更小的通常更好</li></ul> 
<blockquote> 
 <p>一般情况下，尽可能的选择可以正确存储数据的最小数据类型。更小的数据类型通常更快，因为它们占用更少的磁盘，内存和CPU缓存，并且处理时需要的CPU周期也更少。<strong>但是要确保没有低估需要存储的值的范围</strong>。</p> 
</blockquote> 
<ul><li><strong>简单就好</strong></li></ul> 
<blockquote> 
 <p>简单的数据类型的操作通常需要更少的CPU周期</p> 
</blockquote> 
<ul><li><strong>尽量避免NULL</strong></li></ul> 
<blockquote> 
 <p>列属性可为NULL是一个默认的属性，但是最好指定列NOT NULL，除非真的需要存储NULL值,因为包含NULL的列，在查询中对于MySQL来说更难优化，因为可为NULL的列使得索引，索引统计和值比较都更复杂。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/8c/0f/s5mPuo9t_o.png"></p> 
</blockquote> 
<h4><a id="11_69"></a>1.1:整数类型</h4> 
<p>有两种类型的数字：<mark>整数</mark> 和 <mark>实数</mark>。整数是其中之一</p> 
<p>整数的数据类型：</p> 
<ul><li>TINYINT 8位</li><li>SMALLINT 16位</li><li>MEDIUMINT 24位</li><li>INT 32位</li><li>BIGINT 62位</li></ul> 
<blockquote> 
 <p>它们可以存储的值的范围是-2<sup>(n-1)</sup>到2<sup>（n-)</sup>-1，其中n是存储空间的位数.</p> 
</blockquote> 
<blockquote> 
 <p>可选用的属性：UNSIGNED。表示不允许有负值，这可以使得正数的上限提高一倍。</p> 
</blockquote> 
<h4><a id="12_85"></a>1.2:实数类型</h4> 
<p>实数是带有小数部分的数字。</p> 
<p>float和double类型支持使用标准（原生）的浮点近似计算。</p> 
<p>decimal类型用于存储精确的小数</p> 
<blockquote> 
 <p>由于CPU不支持对DECIMAL的直接计算，所以MySQL5.0后，MySQL服务器自己实现了DECIMAL的高精度计算。相对而言，CPU直接支持的原生浮点计算更快一些。</p> 
</blockquote> 
<p>指定精度：decimal(18,9)表示一共18位数字，小数点后9位。</p> 
<h4><a id="13_96"></a>1.3：字符串类型</h4> 
<p><mark>在innodb中</mark></p> 
<blockquote> 
 <p><strong>varchar：</strong><br> 存储可变长字符串,比定长类型更节省空间。varchar需要使用1或者2个额外的字节记录字符串的长度：如果列的最大长度小于等于255字节，则只用一个字节表示，否则使用两个字节表示。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/37/64/rRbIktTW_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/09/7a/puwbnmn8_o.png"></p> 
</blockquote> 
<blockquote> 
 <p><strong>char:</strong><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/29/00/4pTJUPmG_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/fb/7f/e2DHiQZx_o.png"></p> 
</blockquote> 
<blockquote> 
 <p><strong>BLOB与TEXT</strong>：<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/c1/c7/pFjbTW3n_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/aa/df/E7YmUzaL_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/98/50/733db0dW_o.png"></p> 
</blockquote> 
<h4><a id="14_115"></a>1.4：枚举</h4> 
<blockquote> 
 <p><strong>枚举：</strong><br> <img alt="" src="https://images2.imgbox.com/9b/06/RTFGZT32_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/a1/90/6XOCVH7B_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/26/33/b3VJWFHM_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/dc/49/UTDEwxxN_o.png"></p> 
</blockquote> 
<h4><a id="15_123"></a>1.5：日期和时间类型</h4> 
<blockquote> 
 <p>日期和时间类型<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/6e/74/ZtvTwBUv_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/56/4e/lrsRu26A_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/ca/c1/P7SLN1Hr_o.png"><br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/2b/ea/w4bljsbu_o.png"></p> 
</blockquote> 
<h2><a id="_132"></a>三：创建高新能的索引</h2> 
<p><mark>索引是存储引擎用于快速查找到记录的一种数据结构</mark></p> 
<h3><a id="1_135"></a>1：索引基础</h3> 
<p>在MySQL中，存储引擎在使用索引查询时，先根据索引找到对应值，然后根据匹配的索引记录找到对应的数据和。<br> <img alt="在这里插入图片描述" src="https://images2.imgbox.com/70/3a/03YdaGh4_o.png"></p> 
<h4><a id="11_138"></a>1.1：索引的类型</h4>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/00de6ba4319a7a1b7e45050ba61436bf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">计算机专业912,备战2019清华计算机912考研系列笔记绪论</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/66c8b4a2631e675870f8821f8c35e483/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机用户名密码不知道了怎么改,电脑系统账号administrator设置了密码，密码忘记了怎么办？...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>