<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hdu5393 Falsyta in Tina Town - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="hdu5393 Falsyta in Tina Town" />
<meta property="og:description" content="链接：http://acm.hdu.edu.cn/showproblem.php?pid=5393 题意：给出 k,b,x0,p , xn=(xn−1∗k&#43;b)modp ,求最小的n,使得 xn=x0 ,如果不存在输出-1。 分析：通过简单的数学推导，题目即求最小的n使得 ((k−1)∗x0&#43;b)∗(1&#43;k&#43;k2&#43;k3&#43;...kn−1)≡0modp 根据同余的性质， (a∗g)mod(b∗g) 等价于 amodb ,于是可以消去 gcd(p,(k−1)∗x0&#43;b) ,剩下的就是求最小的n使得 1&#43;k&#43;k2&#43;k3&#43;...kn−1≡0modq 两边同乘 k−1 ,由于 k−1 不一定与q互质，因此由此推出来的式子只是原式的必要条件，我们得到 kn≡1modq 假如k,q不互质，上式恒不成立，原式无解，否则根据欧拉定理，有 kΦ(q)≡1modq 我们只需要检查 Phi(q)的约数，得到最小的n满足条件。 假设真实的答案为ans,根据前面的推导，ans必然为n的倍数，设 ans=g∗n 则 1&#43;k&#43;k2&#43;k3&#43;...kans−1≡g∗(1&#43;k&#43;k2&#43;k3&#43;...kn−1)modq 因此只需要把n带回去，然后求lcm即可,注意带回去算答案可以只用一个log的复杂度，总复杂度就是分解约数的复杂度*powmod的复杂度，大概是 log2p #include&lt;bits/stdc&#43;&#43;.h&gt; using namespace std; typedef long long Int; int getphi(int x) { int ret=1; for(int i=2;i*(Int)i&lt;=x;i&#43;&#43;) if(x%i==0) { ret=ret*(i-1); x/=i; while(x%i==0)x/=i,ret*=i; } if(x&gt;1)ret=ret*(x-1); return ret; } int powmod(int x,int y,int mod) { int ret=1; while(y){if(y&amp;1)ret=ret*(Int)x%mod;y&gt;&gt;=1;x=x*(Int)x%mod;} return ret; } int check(int x,int y,int mod) { vector&lt;int&gt;V; while(y){V." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f6681501231001776a338115de41f0e6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-08-16T13:31:59+08:00" />
<meta property="article:modified_time" content="2015-08-16T13:31:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">hdu5393 Falsyta in Tina Town</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>链接：<a href="http://acm.hdu.edu.cn/showproblem.php?pid=5393" rel="nofollow">http://acm.hdu.edu.cn/showproblem.php?pid=5393</a> <br> 题意：给出<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame"> 
   
   <span class="math" id="MathJax-Span-1" style="width: 4.28em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.028em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.89em 1000.003em 3.148em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">b</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-7" style="padding-left: 0.192em;"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.198em; left: 0.632em;"><span class="mn" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1">k,b,x_0,p</script>,<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame"> 
   
   <span class="math" id="MathJax-Span-12" style="width: 13.274em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.519em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.827em 1000.003em 3.211em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-13"><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 1.198em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.135em; left: 0.632em;"><span class="texatom" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.267em;"></span></span></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.255em;">=</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.255em;">(</span><span class="msubsup" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 2.142em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.198em; left: 0.632em;"><span class="texatom" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">k</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">b</span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-33"><span class="mspace" id="MathJax-Span-34" style="height: 0.003em; vertical-align: 0.003em; width: 0.695em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-36" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-37" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2">x_{n}=(x_{n-1}*k+b )\mod p</script>,求最小的n,使得<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame"> 
   
   <span class="math" id="MathJax-Span-39" style="width: 3.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.651em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(2.142em 1000.003em 3.148em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-40"><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 1.198em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.135em; left: 0.632em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.267em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.255em;">=</span><span class="msubsup" id="MathJax-Span-45" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.198em; left: 0.632em;"><span class="mn" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.803em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-3">x_n=x_0</script>,如果不存在输出-1。 <br> 分析：通过简单的数学推导，题目即求最小的n使得 <br> <span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-4-Frame"> 
   
   <span class="math" id="MathJax-Span-48" style="width: 28.368em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.733em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.701em 1000.003em 3.211em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-49"><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.255em;">−</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.255em;">1</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="msubsup" id="MathJax-Span-57" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.198em; left: 0.632em;"><span class="mn" id="MathJax-Span-59" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">b</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.255em;">(</span><span class="mn" id="MathJax-Span-65" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">k</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-69" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-73" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="msubsup" id="MathJax-Span-80" style="padding-left: 0.192em;"><span style="display: inline-block; position: relative; width: 2.079em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="texatom" id="MathJax-Span-82"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.255em;">≡</span><span class="mn" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.255em;">0</span><span class="TeXmathchoice" id="MathJax-Span-90"><span class="mspace" id="MathJax-Span-91" style="height: 0.003em; vertical-align: 0.003em; width: 1.009em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-93" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-94" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.337em; vertical-align: -0.33em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-4">((k-1)*x_0+b)*(1+k+k^2+k^3+...k^{n-1})\equiv 0\mod p
</script>根据同余的性质， 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-5-Frame"> 
  
  <span class="math" id="MathJax-Span-96" style="width: 9.248em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.682em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.827em 1000.003em 3.211em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-97"><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-103"><span class="mspace" id="MathJax-Span-104" style="height: 0.003em; vertical-align: 0.003em; width: 0.695em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-106" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-107" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-5">(a*g)\mod (b*g)</script>等价于 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-6-Frame"> 
  
  <span class="math" id="MathJax-Span-113" style="width: 4.594em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.343em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.959em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">a</span><span class="TeXmathchoice" id="MathJax-Span-116"><span class="mspace" id="MathJax-Span-117" style="height: 0.003em; vertical-align: 0.003em; width: 0.695em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-119" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-120" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.063em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-6">a\mod b</script>,于是可以消去 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-7-Frame"> 
  
  <span class="math" id="MathJax-Span-122" style="width: 10.758em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.129em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.827em 1000.003em 3.211em -0.563em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.192em;">(</span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.255em;">−</span><span class="mn" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.255em;">1</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.198em; left: 0.632em;"><span class="mn" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">b</span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-7">gcd(p,(k-1)*x_0+b)</script>,剩下的就是求最小的n使得 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-8-Frame"> 
   
   <span class="math" id="MathJax-Span-142" style="width: 18.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.173em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.701em 1000.003em 3.148em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-143"><span class="mn" id="MathJax-Span-144" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">k</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-148" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-152" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="msubsup" id="MathJax-Span-159" style="padding-left: 0.192em;"><span style="display: inline-block; position: relative; width: 2.079em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main; padding-left: 0.255em;">≡</span><span class="mn" id="MathJax-Span-167" style="font-family: MathJax_Main; padding-left: 0.255em;">0</span><span class="TeXmathchoice" id="MathJax-Span-168"><span class="mspace" id="MathJax-Span-169" style="height: 0.003em; vertical-align: 0.003em; width: 1.009em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-171" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-172" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.263em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-8">
1+k+k^2+k^3+...k^{n-1}\equiv 0\mod q
</script>两边同乘 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-9-Frame"> 
  
  <span class="math" id="MathJax-Span-174" style="width: 2.456em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.959em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main; padding-left: 0.255em;">−</span><span class="mn" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.255em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.063em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-9">k-1</script>,由于 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-10-Frame"> 
  
  <span class="math" id="MathJax-Span-179" style="width: 2.456em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.959em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main; padding-left: 0.255em;">−</span><span class="mn" id="MathJax-Span-183" style="font-family: MathJax_Main; padding-left: 0.255em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.063em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-10">k-1</script>不一定与q互质，因此由此推出来的式子只是原式的必要条件，我们得到 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-11-Frame"> 
   
   <span class="math" id="MathJax-Span-184" style="width: 7.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.047em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.827em 1000.003em 3.148em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-185"><span class="msubsup" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 1.135em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.701em; left: 0.569em;"><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 2.267em;"></span></span></span></span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.255em;">≡</span><span class="mn" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.255em;">1</span><span class="TeXmathchoice" id="MathJax-Span-191"><span class="mspace" id="MathJax-Span-192" style="height: 0.003em; vertical-align: 0.003em; width: 1.009em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-194" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-195" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.137em; vertical-align: -0.263em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-11">k^n\equiv 1\mod q
</script>假如k,q不互质，上式恒不成立，原式无解，否则根据欧拉定理，有 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-12-Frame"> 
   
   <span class="math" id="MathJax-Span-197" style="width: 8.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.053em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.638em 1000.003em 3.148em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-198"><span class="msubsup" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 2.142em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">Φ</span><span class="mo" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main; padding-left: 0.255em;">≡</span><span class="mn" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.255em;">1</span><span class="TeXmathchoice" id="MathJax-Span-209"><span class="mspace" id="MathJax-Span-210" style="height: 0.003em; vertical-align: 0.003em; width: 1.009em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-212" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-213" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.337em; vertical-align: -0.263em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-12">k^{\Phi(q)}\equiv 1\mod q
</script>我们只需要检查 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-13-Frame"> 
  
  <span class="math" id="MathJax-Span-215" style="width: 17.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.733em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.764em 1000.003em 3.211em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mo" id="MathJax-Span-225"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">的</span></span></span></span><span class="texatom" id="MathJax-Span-226"><span class="mrow" id="MathJax-Span-227"><span class="mo" id="MathJax-Span-228"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">约</span></span></span></span><span class="texatom" id="MathJax-Span-229"><span class="mrow" id="MathJax-Span-230"><span class="mo" id="MathJax-Span-231"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">数</span></span></span></span><span class="texatom" id="MathJax-Span-232"><span class="mrow" id="MathJax-Span-233"><span class="mo" id="MathJax-Span-234"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">，</span></span></span></span><span class="texatom" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mo" id="MathJax-Span-237"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">得</span></span></span></span><span class="texatom" id="MathJax-Span-238"><span class="mrow" id="MathJax-Span-239"><span class="mo" id="MathJax-Span-240"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">到</span></span></span></span><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mo" id="MathJax-Span-243"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">最</span></span></span></span><span class="texatom" id="MathJax-Span-244"><span class="mrow" id="MathJax-Span-245"><span class="mo" id="MathJax-Span-246"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">小</span></span></span></span><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mo" id="MathJax-Span-249"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">的</span></span></span></span><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="mo" id="MathJax-Span-253"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">满</span></span></span></span><span class="texatom" id="MathJax-Span-254"><span class="mrow" id="MathJax-Span-255"><span class="mo" id="MathJax-Span-256"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">足</span></span></span></span><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mo" id="MathJax-Span-259"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">条</span></span></span></span><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mo" id="MathJax-Span-262"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">件</span></span></span></span><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mo" id="MathJax-Span-265"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">。</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.33em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-13">Phi(q)的约数，得到最小的n满足条件。</script> 
<br> 假设真实的答案为ans,根据前面的推导，ans必然为n的倍数，设 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-14-Frame"> 
  
  <span class="math" id="MathJax-Span-266" style="width: 5.286em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.972em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(2.142em 1000.003em 3.148em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-267"><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.255em;">=</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-14">ans=g*n</script>则 
<br> 
<span class="MathJax_Preview"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-15-Frame"> 
   
   <span class="math" id="MathJax-Span-275" style="width: 32.833em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.947em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.701em 1000.003em 3.211em -0.5em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-276"><span class="mn" id="MathJax-Span-277" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">k</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-281" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-285" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="msubsup" id="MathJax-Span-292" style="padding-left: 0.192em;"><span style="display: inline-block; position: relative; width: 2.833em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="texatom" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.255em;">≡</span><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main; padding-left: 0.255em;">∗</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.255em;">(</span><span class="mn" id="MathJax-Span-305" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic; padding-left: 0.255em;">k</span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-309" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main; padding-left: 0.255em;">+</span><span class="msubsup" id="MathJax-Span-313" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="mn" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main; padding-left: 0.192em;">.</span><span class="msubsup" id="MathJax-Span-320" style="padding-left: 0.192em;"><span style="display: inline-block; position: relative; width: 2.079em; height: 0px;"><span style="position: absolute; clip: rect(1.638em 1000.003em 2.708em -0.5em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.764em; left: 0.569em;"><span class="texatom" id="MathJax-Span-322"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-328"><span class="mspace" id="MathJax-Span-329" style="height: 0.003em; vertical-align: 0.003em; width: 1.009em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Main; padding-left: 0.192em;">mod</span><span class="mspace" id="MathJax-Span-331" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-332" style="height: 0.003em; vertical-align: 0.003em; width: 0.192em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.337em; vertical-align: -0.33em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-15">1+k+k^2+k^3+...k^{ans-1}\equiv g*(1+k+k^2+k^3+...k^{n-1})\mod q
</script>因此只需要把n带回去，然后求lcm即可,注意带回去算答案可以只用一个log的复杂度，总复杂度就是分解约数的复杂度*powmod的复杂度，大概是 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-16-Frame"> 
  
  <span class="math" id="MathJax-Span-334" style="width: 2.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.393em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.513em 1000.003em 2.896em -0.5em); top: -2.513em; left: 0.003em;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">o</span><span class="msubsup" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.89em 1000.003em 2.896em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.701em; left: 0.569em;"><span class="mn" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.27em; vertical-align: -0.263em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-16">log^2p</script> 
<p></p> 
<pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-preprocessor">#include&lt;bits/stdc++.h&gt;</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> Int;
<span class="hljs-keyword">int</span> getphi(<span class="hljs-keyword">int</span> x)
{
    <span class="hljs-keyword">int</span> ret=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>;i*(Int)i&lt;=x;i++)
        <span class="hljs-keyword">if</span>(x%i==<span class="hljs-number">0</span>)
        {
            ret=ret*(i-<span class="hljs-number">1</span>);
            x/=i;
            <span class="hljs-keyword">while</span>(x%i==<span class="hljs-number">0</span>)x/=i,ret*=i;
        }
    <span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">1</span>)ret=ret*(x-<span class="hljs-number">1</span>);
    <span class="hljs-keyword">return</span> ret;
}
<span class="hljs-keyword">int</span> powmod(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y,<span class="hljs-keyword">int</span> mod)
{
    <span class="hljs-keyword">int</span> ret=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span>(y){<!-- --><span class="hljs-keyword">if</span>(y&amp;<span class="hljs-number">1</span>)ret=ret*(Int)x%mod;y&gt;&gt;=<span class="hljs-number">1</span>;x=x*(Int)x%mod;}
    <span class="hljs-keyword">return</span> ret;
}
<span class="hljs-keyword">int</span> check(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y,<span class="hljs-keyword">int</span> mod)
{
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span>V;
    <span class="hljs-keyword">while</span>(y){V.push_back(y&amp;<span class="hljs-number">1</span>);y&gt;&gt;=<span class="hljs-number">1</span>;}
    reverse(V.begin(),V.end());
    <span class="hljs-keyword">int</span> ret=<span class="hljs-number">0</span>,tp=<span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;V.size();i++)
    {
        ret=(ret+ret*(Int)tp%mod)%mod;
        tp=tp*(Int)tp%mod;
        <span class="hljs-keyword">if</span>(V[i])
        {
            tp=tp*(Int)x%mod;
            ret=(ret+tp)%mod;
        }
    }
    <span class="hljs-keyword">return</span> (ret+<span class="hljs-number">1</span>)%mod;
}
<span class="hljs-keyword">int</span> main()
{
    <span class="hljs-keyword">int</span> _;<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>,&amp;_);
    <span class="hljs-keyword">while</span>(_--)
    {
        <span class="hljs-keyword">int</span> k,b,x,p;
        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d%d%d"</span>,&amp;k,&amp;b,&amp;x,&amp;p);
        <span class="hljs-keyword">if</span>(!k){<!-- --><span class="hljs-built_in">puts</span>(b==x?<span class="hljs-string">"1"</span>:<span class="hljs-string">"-1"</span>);<span class="hljs-keyword">continue</span>;}
        <span class="hljs-keyword">if</span>(k==<span class="hljs-number">1</span>)
        {
            <span class="hljs-keyword">if</span>(!b)<span class="hljs-built_in">puts</span>(<span class="hljs-string">"1"</span>);
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>,p/__gcd(b,p));
            }
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">int</span> q=p/__gcd((Int)p,(Int)(k-<span class="hljs-number">1</span>)*x+b);
        <span class="hljs-keyword">if</span>(q==<span class="hljs-number">1</span>){<!-- --><span class="hljs-built_in">puts</span>(<span class="hljs-string">"1"</span>);<span class="hljs-keyword">continue</span>;}
        <span class="hljs-keyword">if</span>(__gcd(k,q)!=<span class="hljs-number">1</span>){<!-- --><span class="hljs-built_in">puts</span>(<span class="hljs-string">"-1"</span>);<span class="hljs-keyword">continue</span>;}
        <span class="hljs-keyword">int</span> t=getphi(q);
        <span class="hljs-keyword">int</span> rep=t;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i*(Int)i&lt;=t;i++)
        {
            <span class="hljs-keyword">if</span>(t%i==<span class="hljs-number">0</span>)
            {
                <span class="hljs-keyword">if</span>(powmod(k,i,q)==<span class="hljs-number">1</span>){rep=i;<span class="hljs-keyword">break</span>;}
                <span class="hljs-keyword">if</span>(powmod(k,t/i,q)==<span class="hljs-number">1</span>)rep=t/i;
            }
        }
        <span class="hljs-keyword">int</span> ans=check(k,rep-<span class="hljs-number">1</span>,q);
        <span class="hljs-keyword">if</span>(!ans){<!-- --><span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>,rep);<span class="hljs-keyword">continue</span>;}
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>,q/__gcd(ans,q)*(Int)rep);
    }
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a52cebad7cac4f8787d013cff52dd13b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">百度UEditor的介绍和图片上传的使用（java）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f58cb7d39b065aec5f586c07ed22b3f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java与C语言的数据类型对应</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>