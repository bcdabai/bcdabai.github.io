<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>excel日期函数技巧：到期时间提醒的几种设置方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="excel日期函数技巧：到期时间提醒的几种设置方法" />
<meta property="og:description" content="在平时的工作应用中，我们都喜欢用Excel表格来记录整理数据，数据里会包含到期时间，比如订单到期日期、合同到期日期、产品到期日期等。对于这类数据，我们希望能够有一个到期提醒功能来帮助我们管理数据，如何在Excel里实现这么一个日期到期提醒功能，就是我们今天要讨论的话题，由浅入深分为五层境界，以下用一个药品的有效期数据为例，下面和大家一层一层来了解，原始数据如图所示。
第一层境界：备注列计算到期天数
这个方法是最简单最初级的，只需要用到一个函数TODAY，该函数不需要参数，可以直接返回当前的系统日期，用到期日期-当前日期即可得到还有多少天到期，公式为：=D4-TODAY()
注意两点：
1.如果输入公式后显示不正确，可以将单元格格式修改为常规；
2.因为使用了TODAY()函数，所以每天打开表格时备注栏的数字都是会发生变化的，表示距到期日还有多少天，如果是负数说明已经过期了。
第二层境界：更加人性化的备注信息
这一次需要用到TEXT来实现我们想要的效果，对负数统一显示为“已过期”，对正数显示为“还有多少天到期”，公式为：=TEXT(D4-TODAY(),&#34;还有0天到期;已过期;;&#34;)
只是利用了TEXT函数对第一层得到的天数做了一些处理。
第三层境界：只显示需要关注的信息
备注栏如果显示全部的结果，其实并不能突出需要关注的重点数据，假如只对未来30天以内到期的数据做提示，超过30天的不显示任何内容，这样的结果看起来会更加直观，此时让IF出马更为合适，公式进一步优化为：=IF(D4-TODAY()&lt;31,TEXT(D4-TODAY(),&#34;还有0天到期;已过期;;&#34;),&#34;&#34;)
使用公式也就只能做到这个程度了，如果还要提升境界，就必须条件格式登场。 第四层境界：条件格式控制显示效果
这一次要实现的效果是让30天内到期的数据整行显示黄色，已过期的整行显示红色，这个要求涉及到两条规则，设置步骤如下。
首先选中数据区域，再打开条件格式中的新建规则，选择使用公式确定要设置格式的单元格，公式输入=$D4&lt;today()，然后设置格式，完成后一直点确定退出，就能看到效果了，操作步骤看动画演示。
操作要点：只选择需要应用条件格式的区域，也就是从第4行开始选。
重复这个过程，再次设置条件格式，区别就是公式变成=$D4-TODAY()&lt;31，再看一次动画演示。
操作要点：设置完成后在条件格式的管理规则中调整一下两条规则的顺序。
公式中的&lt;31也可以改成&lt;=30，这个很好理解。
如果还需要对60天内到期的数据做提醒，对应增加规则就可以了。
比这个效果更高级的那就是增加了按钮来控制到期提醒，这就要用到控件了。
第五层境界：利用按钮控制到期提醒
该设置分为两部分操作，控件按钮的添加和条件格式的设置，先来看看控件怎么用。
添加控件不是很难，选择选项按钮后在表格里拖动一个矩形框就可以完成添加。
添加后修改说明文字，再根据自己的需要复制几个选项按钮，做成这种效果。
在其中一个控件上面点右键，设置控件格式，然后选择表格空白区域的一个单元格。
完整的操作看动画演示。
这一步的原理就是利用控件在单元格得到对应选项的数字，为下一步的设置提供一个条件。
接下来设置条件格式，过程和第四部分的一样，只是公式有所不同，因为这里有三个选项，所以需要设置三次规则，公式分别为：
规则1：=AND($K$2=1,$D4&lt;TODAY())
规则2：=AND($K$2=2,$D4-30&lt;TODAY(),$D4&gt;=TODAY())
规则3：=AND($K$2=3,$D4-60&lt;TODAY(),$D4-30&gt;=TODAY())
如果还需要设置更多选项，按照对应的条件修改公式添加即可。
最终效果如图所示。
小结：任何看上去高大上的应用都是从最基本的功能一点一点优化出来的，而且需要各种功能相互配合才能实现，今天的例子，从最开始很简单的一个公式，到最后应用了条件格式以及控件，就是最好的一个实证。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a9c2d3d410035f7cd2e10482657627b4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-24T08:57:18+08:00" />
<meta property="article:modified_time" content="2022-12-24T08:57:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">excel日期函数技巧：到期时间提醒的几种设置方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在平时的工作应用中，我们都喜欢用Excel表格来记录整理数据，数据里会包含到期时间，比如订单到期日期、合同到期日期、产品到期日期等。对于这类数据，我们希望能够有一个到期提醒功能来帮助我们管理数据，如何在Excel里实现这么一个日期到期提醒功能，就是我们今天要讨论的话题，由浅入深分为五层境界，以下用一个药品的有效期数据为例，下面和大家一层一层来了解，原始数据如图所示。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/05/01/7r608chH_o.png"></p> 
<p><strong>第一层境界：备注列计算到期天数</strong></p> 
<p>这个方法是最简单最初级的，只需要用到一个函数TODAY，该函数不需要参数，可以直接返回当前的系统日期，用到期日期-当前日期即可得到还有多少天到期，公式为：=D4-TODAY()</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e9/bf/MTonjQ8Z_o.png"></p> 
<p>注意两点：</p> 
<p>1.如果输入公式后显示不正确，可以将单元格格式修改为常规；</p> 
<p>2.因为使用了TODAY()函数，所以每天打开表格时备注栏的数字都是会发生变化的，表示距到期日还有多少天，如果是负数说明已经过期了。</p> 
<p><strong>第二层境界：更加人性化的备注信息</strong></p> 
<p>这一次需要用到TEXT来实现我们想要的效果，对负数统一显示为“已过期”，对正数显示为“还有多少天到期”，公式为：=TEXT(D4-TODAY(),"还有0天到期;已过期;;")</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/c0/95/TZNXlP85_o.png"></p> 
<p>只是利用了TEXT函数对第一层得到的天数做了一些处理。</p> 
<p><strong>第三层境界：只显示需要关注的信息</strong></p> 
<p>备注栏如果显示全部的结果，其实并不能突出需要关注的重点数据，假如只对未来30天以内到期的数据做提示，超过30天的不显示任何内容，这样的结果看起来会更加直观，此时让IF出马更为合适，公式进一步优化为：=IF(D4-TODAY()&lt;31,TEXT(D4-TODAY(),"还有0天到期;已过期;;"),"")</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/1c/54/pld1LMpd_o.png"></p> 
<p>使用公式也就只能做到这个程度了，如果还要提升境界，就必须条件格式登场。 </p> 
<p><strong>第四层境界：条件格式控制显示效果</strong></p> 
<p>这一次要实现的效果是让30天内到期的数据整行显示黄色，已过期的整行显示红色，这个要求涉及到两条规则，设置步骤如下。</p> 
<p>首先选中数据区域，再打开条件格式中的新建规则，选择使用公式确定要设置格式的单元格，公式输入=$D4&lt;today()，然后设置格式，完成后一直点确定退出，就能看到效果了，操作步骤看动画演示。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/bf/ac/orrehnfL_o.jpg"></p> 
<p><strong>操作要点：</strong>只选择需要应用条件格式的区域，也就是从第4行开始选。</p> 
<p>重复这个过程，再次设置条件格式，区别就是公式变成=$D4-TODAY()&lt;31，再看一次动画演示。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/45/df/bku0D0SB_o.jpg"></p> 
<p><strong>操作要点：</strong>设置完成后在条件格式的管理规则中调整一下两条规则的顺序。</p> 
<p>公式中的&lt;31也可以改成&lt;=30，这个很好理解。</p> 
<p>如果还需要对60天内到期的数据做提醒，对应增加规则就可以了。</p> 
<p>比这个效果更高级的那就是增加了按钮来控制到期提醒，这就要用到控件了。</p> 
<p><strong>第五层境界：利用按钮控制到期提醒</strong></p> 
<p>该设置分为两部分操作，控件按钮的添加和条件格式的设置，先来看看控件怎么用。</p> 
<p>添加控件不是很难，选择选项按钮后在表格里拖动一个矩形框就可以完成添加。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/01/1e/sGQSIblP_o.png"></p> 
<p>添加后修改说明文字，再根据自己的需要复制几个选项按钮，做成这种效果。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/47/39/H517MI1L_o.png"></p> 
<p>在其中一个控件上面点右键，设置控件格式，然后选择表格空白区域的一个单元格。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/84/af/nZ0xFQrI_o.png"></p> 
<p>完整的操作看动画演示。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ff/92/PnIXRw1s_o.jpg"></p> 
<p></p> 
<p>这一步的原理就是利用控件在单元格得到对应选项的数字，为下一步的设置提供一个条件。</p> 
<p>接下来设置条件格式，过程和第四部分的一样，只是公式有所不同，因为这里有三个选项，所以需要设置三次规则，公式分别为：</p> 
<p>规则1：=AND($K$2=1,$D4&lt;TODAY())</p> 
<p>规则2：=AND($K$2=2,$D4-30&lt;TODAY(),$D4&gt;=TODAY())</p> 
<p>规则3：=AND($K$2=3,$D4-60&lt;TODAY(),$D4-30&gt;=TODAY())</p> 
<p>如果还需要设置更多选项，按照对应的条件修改公式添加即可。</p> 
<p>最终效果如图所示。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/60/9b/jtkrtomZ_o.jpg"></p> 
<p><strong>小结：</strong>任何看上去高大上的应用都是从最基本的功能一点一点优化出来的，而且需要各种功能相互配合才能实现，今天的例子，从最开始很简单的一个公式，到最后应用了条件格式以及控件，就是最好的一个实证。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f24313be203e530971f2148ed27e4a7a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue路由跳转的五种方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b254e53284d61f5fe1f1ea4ed296d37e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">基于Java的宿舍管理系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>