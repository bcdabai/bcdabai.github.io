<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>EasyExcel入门(最简单的读) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="EasyExcel入门(最简单的读)" />
<meta property="og:description" content="官网：EasyExcel官方文档 - 基于Java的Excel处理工具 | Easy Excel (alibaba.com)
因为暂时项目没有用到，所以不急，知道了这个技术。就想着学着用一下！
最简单的读 先看官方文档给的用法和解释！！！
导入依赖 &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;easyexcel&lt;/artifactId&gt; &lt;version&gt;3.3.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.70&lt;/version&gt; &lt;/dependency&gt; 创建实体类 自己准备一个Excel表格。
@Data public class DemoData { private String name; private String sex; private String age; } 测试 官方提供了4种写法
写法一： final String fileName = &#34;C:\\Users\\gong&#39;chao\\Desktop\\58_com_resumes_bj.xls&#34;; /** * 最简单的读 - 01 */ @Test void readExcel01(){ AtomicInteger i = new AtomicInteger(); EasyExcel.read(fileName, DemoData.class, new PageReadListener&lt;DemoData&gt;(dataList -&gt; { for (DemoData demoData : dataList) { System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b77517e7a96b65da5725115de2df838f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-10T14:49:29+08:00" />
<meta property="article:modified_time" content="2023-09-10T14:49:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">EasyExcel入门(最简单的读)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>官网：<a href="https://easyexcel.opensource.alibaba.com/" rel="nofollow" title="EasyExcel官方文档 - 基于Java的Excel处理工具 | Easy Excel (alibaba.com)">EasyExcel官方文档 - 基于Java的Excel处理工具 | Easy Excel (alibaba.com)</a></p> 
<blockquote> 
 <p>因为暂时项目没有用到，所以不急，知道了这个技术。就想着学着用一下！</p> 
</blockquote> 
<h2>最简单的读</h2> 
<p> <span style="color:#ff9900;">先看官方文档给的用法和解释！！！</span></p> 
<h3>导入依赖</h3> 
<pre><code class="language-XML">        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;
            &lt;version&gt;3.3.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
            &lt;version&gt;1.2.70&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<h3>创建实体类</h3> 
<p><span style="color:#38d8f0;"> </span><span style="color:#ff9900;">自己准备一个Excel表格。</span></p> 
<pre><code class="language-java">@Data
public class DemoData {
    private String name;

    private String sex;

    private String age;
}</code></pre> 
<h3>测试</h3> 
<blockquote> 
 <p><span style="color:#ff9900;">官方提供了4种写法</span></p> 
</blockquote> 
<h4>写法一：</h4> 
<pre><code class="language-java">final String fileName = "C:\\Users\\gong'chao\\Desktop\\58_com_resumes_bj.xls";
    /**
     * 最简单的读 - 01
     */
    @Test
    void readExcel01(){
        AtomicInteger i = new AtomicInteger();
        EasyExcel.read(fileName, DemoData.class, new PageReadListener&lt;DemoData&gt;(dataList -&gt; {
            for (DemoData demoData : dataList) {
                System.out.println("读取到一条数据" + JSON.toJSONString(demoData));
                i.getAndIncrement();
            }
            // 输出集合长度
            System.err.println(dataList.size());
        })).sheet().doRead();
        // 输出总行数
        System.out.println(i);
    }</code></pre> 
<p><img alt="" class="left" height="208" src="https://images2.imgbox.com/d6/58/tqTjFLk6_o.png" width="656"><img alt="" class="left" height="149" src="https://images2.imgbox.com/8a/0d/kYPlG3VV_o.png" width="458"></p> 
<p>点击PageReadListener查看源码：</p> 
<p><img alt="" height="1008" src="https://images2.imgbox.com/21/b4/luCwf4XW_o.png" width="1200"></p> 
<blockquote> 
 <p> 默认是一行一行读取。然后可以再点进<span style="color:#ff9900;">ListUtils</span>中查看，可以知道，一行一行的将数据存进集合中，当长度到100时重新new一个集合，则原来的集合对象不被引用交给垃圾回收。这就是 <span style="color:#ff9900;"><span style="background-color:#ffd900;">Easy Excel</span> </span><span style="color:#0d0016;">处理大文件内存溢出的一种方式吧。</span></p> 
 <p><span style="color:#0d0016;">---   </span><span style="color:#ff9900;">个人理解</span></p> 
</blockquote> 
<p>然后可以看出实体类映射的三个字段输出的值不匹配。按照官网给出的注解：</p> 
<pre><code class="language-java">@Data
public class DemoData {
    @ExcelProperty(value = "姓名")
    private String name;

    @ExcelProperty(value = "性别")
    private String sex;

    @ExcelProperty(index = 5)
    private String age;
}</code></pre> 
<p>可以指定列名，也可以指定下标。这样就正确映射了</p> 
<h4>写法二：内部类</h4> 
<pre><code class="language-java">    /**
     * 最简单的读 - 02
     */
    @Test
    void readExcel02(){
        EasyExcel.read(fileName, DemoData.class, new ReadListener&lt;DemoData&gt;(){
            // 单次缓存的数量
            public static int BATCH_COUNT = 200;
            // 临时存储
            private List&lt;DemoData&gt; cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);

            @Override
            public void invoke(DemoData data, AnalysisContext context) {
                cachedDataList.add(data);
                if(cachedDataList.size() &gt;= BATCH_COUNT) {
                    System.err.println(cachedDataList.size());
                    System.err.println("已保存至数据库\n已完成清理 list");
                    cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);
                }
            }

            @Override
            public void doAfterAllAnalysed(AnalysisContext context) {
                System.err.println("已将剩余数据保存至数据库");
            }
        }).sheet().doRead();
    }</code></pre> 
<h4>写法三：外部类</h4> 
<p>定义一个类</p> 
<pre><code class="language-java">public class read03 implements ReadListener&lt;DemoData&gt; {
    // 单次缓存的数量
    public static int BATCH_COUNT = 200;
    // 临时存储
    private List&lt;DemoData&gt; cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);

    public void invoke(DemoData data, AnalysisContext context) {
        cachedDataList.add(data);
        if(cachedDataList.size() &gt;= BATCH_COUNT) {
            System.err.println(cachedDataList.size());
            System.err.println("已保存至数据库\n已完成清理 list");
            cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);
        }
    }

    public void doAfterAllAnalysed(AnalysisContext context) {
        System.err.println("已将剩余数据保存至数据库");
    }
}</code></pre> 
<pre><code class="language-java">    /**
     * 最简单的读 - 03
     */
    @Test
    void readExcel03(){
        EasyExcel.read(fileName, DemoData.class, new read03()).sheet().doRead();
    }</code></pre> 
<h4>写法四：</h4> 
<pre><code class="language-java">   /**
     * 最简单的读 - 04
     */
    @Test
    void readExcel04(){
        try (ExcelReader excelReader = EasyExcel.read(fileName, DemoData.class, new read03()).build()) {
            // 构建一个sheet 这里可以指定名字或者no
            ReadSheet readSheet1 = EasyExcel.readSheet(0).sheetName("员工表").build();
            ReadSheet readSheet2 = EasyExcel.readSheet(1).sheetName("请假表").build();
            System.out.println(readSheet1.toString());
            System.out.println(readSheet2.toString());
            // 读取一个sheet
            excelReader.read(readSheet1);
            excelReader.read(readSheet2);
        }
    }</code></pre> 
<blockquote> 
 <p><span style="color:#ff9900;">写法四中可以通过下标指定工作表和相应的名称。 </span></p> 
</blockquote> 
<h2>总结</h2> 
<p>之后真正要用EasyExcel技术时再研究其他用法，之后再更新！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d5c29d09ca3c407c44a6f41aeaacd165/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">安装Burp suitev过程中出现错误--illegal-access=permit</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f30942b5f771949b456b756541da0ffd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Nginx 转发 404 问题的排查和思考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>