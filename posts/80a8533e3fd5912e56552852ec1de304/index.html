<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>插值法（二次插值法和三次插值法算法分析以及python代码解释） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="插值法（二次插值法和三次插值法算法分析以及python代码解释）" />
<meta property="og:description" content="在学习了之前几期一维搜索算法后，今天我们来分析两种最新的算法，分别是两点三次插值法和两点插值法。之前的几种算法，在整个搜索过程中只对函数值进行了比较，在删除“坏”的区间时，已经计算出的函数值并没有得到充分的利用。今天介绍的两种方法是利用低次多项式P（x）在搜索区间上逼近目标函数，然而用近似多项式P（x）的极小点作为新区间的分割点的方法。近似多项式P（x）取二次多项式，则得二次插值法；取三次多项式，则得三次插值法。
二次插值法： 算法分析: 基本思想：在极小点附近，用二次三项式P（x）逼近目标函数,P（x）与在三点有相同的函数值，并假设：
令 ,
又令 记 ,,
,,
则可得：
令,将P(x)的驻点x记作,则
这样，把作为的极小点的一个估计，再从中选择目标函数值最小的点，以及其左右两点，给予相应的下标，代入上式，求出极小点的新的估计值，以此类推，产生点列{}，满足或者，终止迭代。
例题分析： 下面我们通过例题来进一步探讨：
例题：用二次插值法求函数的极小点，迭代三次给定.
解：由已知三个点，可求出（-1.2，-4.1472），（-1.1，-4.8037），（-0.8，-4.4032）
由迭代公式：
,,
,,
迭代次数第一次x-1.2-1.1-0.8-0.984f-4.147-4.804-4.403-4.996第二次x-1.1-0.984-0.8-0.990f-4.804-4.996-4.403-4.998第三次x-1.1-0.990-0.984-1.008f-4.804-4.998-4.996-4.999 那么我们看这个迭代结果，不难发现，求出的极小点是x=-1的近似值，并不是问题的全局最优解（x=2），由此，我们可以确定二次插值法对于初始点的要求较高，有时求出的并不是全局最优解，而是局部最优解。
算法代码： &#39;&#39;&#39; 二次插值算法(抛物线法） 2023.10.9 &#39;&#39;&#39; def fun(x): return x ** 2 &#43; 2 * x - 10 def run(x1, x2, x3): B1 = (x2 * x2 - x3 * x3) * fun(x1) B2 = (x3 * x3 - x1 * x1) * fun(x2) B3 = (x1 * x1 - x2 * x2) * fun(x3) C1 = (x2 - x3) * fun(x1) C2 = (x3 - x1) * fun(x2) C3 = (x1 - x2) * fun(x3) D = (x1 - x2) * (x2 - x3) * (x3 - x1) if (B1 &#43; B2 &#43; B3) == 0: x0 = 0 else: x0 = (B1 &#43; B2 &#43; B3) / (2 * (C1 &#43; C2 &#43; C3)) Arr = [x0, x1, x2, x3] Arr." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/80a8533e3fd5912e56552852ec1de304/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-29T18:48:03+08:00" />
<meta property="article:modified_time" content="2023-10-29T18:48:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">插值法（二次插值法和三次插值法算法分析以及python代码解释）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在学习了之前几期一维搜索算法后，今天我们来分析两种最新的算法，分别是两点三次插值法和两点插值法。之前的几种算法，在整个搜索过程中只对函数值进行了比较，在删除“坏”的区间时，已经计算出的函数值并没有得到充分的利用。今天介绍的两种方法是利用低次多项式P（x）在搜索区间上逼近目标函数，然而用近似多项式P（x）的极小点作为新区间的分割点的方法。近似多项式P（x）取二次多项式，则得二次插值法；取三次多项式，则得三次插值法。</p> 
<h3>二次插值法：</h3> 
<h4>算法分析:</h4> 
<p>基本思想：在极小点附近，用二次三项式P（x）逼近目标函数<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/f5/85/sYfflu73_o.png">,P（x）与<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/9f/71/ezkW6rBw_o.png">在三点<img alt="x_{1}&lt; x_{2}&lt; x_{3}" class="mathcode" src="https://images2.imgbox.com/32/4b/6V1oXxxE_o.png">有相同的函数值，并假设：</p> 
<p style="text-align:center;"><img alt="f(x_{1})&gt; f(x_{2}),f(x_{2})&lt; f(x_{3})" class="mathcode" src="https://images2.imgbox.com/aa/df/Iv83fUal_o.png"></p> 
<p>令                                                      <img alt="P(x) = a + bx + cx^{2}" class="mathcode" src="https://images2.imgbox.com/5e/bb/1D3k1HIP_o.png">,</p> 
<p>又令                                          <img alt="P(x_{1}) = a + bx_{1} + cx_{1}^{2}= f(x_{1})" class="mathcode" src="https://images2.imgbox.com/25/b6/aQDEVVMO_o.png"></p> 
<p style="text-align:center;"><img alt="P(x_{2}) = a + bx_{2} + cx_{2}^{2}= f(x_{2})" class="mathcode" src="https://images2.imgbox.com/ea/e5/ce9kivkN_o.png"></p> 
<p style="text-align:center;"><img alt="P(x_{3}) = a + bx_{3} + cx_{3}^{2}= f(x_{3})" class="mathcode" src="https://images2.imgbox.com/fb/5d/ipsRaoji_o.png"></p> 
<p>记                <img alt="B_{1}=(x_{2}^{2}-x_{3}^{2})f(x_{1})" class="mathcode" src="https://images2.imgbox.com/4b/f1/T0gLe0dP_o.png">,<img alt="B_{2}=(x_{3}^{2}-x_{1}^{2})f(x_{2})" class="mathcode" src="https://images2.imgbox.com/8c/e7/slwMUVgp_o.png">,<img alt="B_{3}=(x_{1}^{2}-x_{2}^{2})f(x_{3})" class="mathcode" src="https://images2.imgbox.com/d3/52/OeXeRysH_o.png"></p> 
<p style="text-align:center;"><img alt="C_{1}=(x_{2}-x_{3})f(x_{1})" class="mathcode" src="https://images2.imgbox.com/5d/85/iQKHJlap_o.png">,<img alt="C_{2}=(x_{3}-x_{1})f(x_{2})" class="mathcode" src="https://images2.imgbox.com/90/60/Cj6kprnO_o.png">,<img alt="C_{3}=(x_{1}-x_{2})f(x_{3})" class="mathcode" src="https://images2.imgbox.com/02/19/9SRiyJfE_o.png"></p> 
<p style="text-align:center;"><img alt="D=(x_{1}-x_{2})(x_{2}-x_{3})(x_{3}-x_{1})" class="mathcode" src="https://images2.imgbox.com/ab/19/fWpx7k8O_o.png"></p> 
<p>则可得：</p> 
<p style="text-align:center;"><img alt="b=\frac{B_{1}+B_{2}+B_{3}}{D}" class="mathcode" src="https://images2.imgbox.com/ee/d6/c8t6K1zG_o.png"></p> 
<p style="text-align:center;"><img alt="c=-\frac{C_{1}+C_{2}+C_{3}}{D}" class="mathcode" src="https://images2.imgbox.com/e9/47/HPTfXTRA_o.png"></p> 
<p>令<img alt="P'(x)=0\Rightarrow x=-\frac{b}{2c}" class="mathcode" src="https://images2.imgbox.com/60/a9/q6Bedn93_o.png">,将P(x)的驻点x记作<img alt="\bar{x_{k}}" class="mathcode" src="https://images2.imgbox.com/33/a5/Ul1v0M55_o.png">,则<img alt="\bar{x_{k}}=\frac{B_{1}+B_{2}+B_{3}}{2(C_{1}+C_{2}+C_{3})}" class="mathcode" src="https://images2.imgbox.com/67/42/rnCqHq9s_o.png"></p> 
<p>这样，把<img alt="\bar{x_{k}}" class="mathcode" src="https://images2.imgbox.com/df/8e/wtd6IwLa_o.png">作为<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/06/68/vK4KTCli_o.png">的极小点的一个估计，再从<img alt="x_{1}, x_{2}, x_{3},\bar{x_{k}}" class="mathcode" src="https://images2.imgbox.com/b5/90/VwRH6Kwp_o.png">中选择目标函数值最小的点，以及其左右两点，给予相应的下标，代入上式，求出极小点的新的估计值<img alt="\bar{x_{k+1}}" class="mathcode" src="https://images2.imgbox.com/ad/ed/mtPCSP12_o.png">，以此类推，产生点列{<!-- --><img alt="\bar{x_{k}}" class="mathcode" src="https://images2.imgbox.com/bc/b8/b0qLFtgx_o.png">}，满足<img alt="\left | f(\bar{x_{k+1}})- f(\bar{x_{k}})\right |&lt; \epsilon" class="mathcode" src="https://images2.imgbox.com/46/f1/HX4CcJqh_o.png">或者<img alt="\left | \left | \bar{x_{k+1}}-\bar{x_{k}} \right | \right |&lt; \delta" class="mathcode" src="https://images2.imgbox.com/df/18/jrcUEUjv_o.png">，终止迭代。</p> 
<h4>例题分析：</h4> 
<p>下面我们通过例题来进一步探讨：</p> 
<p>例题：用二次插值法求函数<img alt="f(x)=3x^{4}-4x^{3}-12x^{2}" class="mathcode" src="https://images2.imgbox.com/1e/8b/x6buk93Q_o.png">的极小点，迭代三次给定<img alt="x_{1}=-1.2,x_{2}=-1.1,x_{3}=-0.8" class="mathcode" src="https://images2.imgbox.com/3e/02/g1Rk3Nze_o.png">.</p> 
<p>解：由已知三个点，可求出（-1.2，-4.1472），（-1.1，-4.8037），（-0.8，-4.4032）</p> 
<p>由迭代公式：</p> 
<p style="text-align:center;"><img alt="B_{1}=(x_{2}^{2}-x_{3}^{2})f(x_{1})" class="mathcode" src="https://images2.imgbox.com/e7/32/2MQou7CF_o.png">,<img alt="B_{2}=(x_{3}^{2}-x_{1}^{2})f(x_{2})" class="mathcode" src="https://images2.imgbox.com/9e/01/lFc2Unyj_o.png">,<img alt="B_{3}=(x_{1}^{2}-x_{2}^{2})f(x_{3})" class="mathcode" src="https://images2.imgbox.com/40/63/LEjXTcqx_o.png"></p> 
<p style="text-align:center;"><img alt="C_{1}=(x_{2}-x_{3})f(x_{1})" class="mathcode" src="https://images2.imgbox.com/e5/4c/n5CZku9h_o.png">,<img alt="C_{2}=(x_{3}-x_{1})f(x_{2})" class="mathcode" src="https://images2.imgbox.com/55/67/qfDFTp2v_o.png">,<img alt="C_{3}=(x_{1}-x_{2})f(x_{3})" class="mathcode" src="https://images2.imgbox.com/47/9b/GhOyHnSb_o.png"></p> 
<p style="text-align:center;"><img alt="D=(x_{1}-x_{2})(x_{2}-x_{3})(x_{3}-x_{1})" class="mathcode" src="https://images2.imgbox.com/17/83/rBiXpa3N_o.png"></p> 
<p style="text-align:center;"><img alt="\therefore \bar{x_{k}}=\frac{B_{1}+B_{2}+B_{3}}{2(C_{1}+C_{2}+C_{3})}=-0.984" class="mathcode" src="https://images2.imgbox.com/55/09/w9a2s5k0_o.png"></p> 
<table align="center" border="1" cellpadding="1" cellspacing="1" style="width:500px;"><thead><tr><th style="text-align:center;vertical-align:middle;"><span style="color:#0d0016;">迭代次数</span></th><th style="text-align:center;vertical-align:middle;"></th><th style="text-align:center;vertical-align:middle;"><strong><span style="color:#0d0016;"><img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/a9/92/IguXwPPE_o.png"></span></strong></th><th style="text-align:center;vertical-align:middle;"><strong><span style="color:#0d0016;"><img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/83/fc/rsK7F88g_o.png"></span></strong></th><th style="text-align:center;vertical-align:middle;"><strong><span style="color:#0d0016;"><img alt="x_{3}" class="mathcode" src="https://images2.imgbox.com/d2/56/zPGsFedK_o.png"></span></strong></th><th style="text-align:center;vertical-align:middle;"><strong><span style="color:#0d0016;"><img alt="x_{4}" class="mathcode" src="https://images2.imgbox.com/17/b0/wrC5okG8_o.png"></span></strong></th></tr></thead><tbody><tr><th colspan="1" rowspan="2" style="text-align:center;vertical-align:middle;"><strong>第一次</strong></th><td style="text-align:center;vertical-align:middle;"><strong>x</strong></td><td style="text-align:center;vertical-align:middle;">-1.2</td><td style="text-align:center;vertical-align:middle;">-1.1</td><td style="text-align:center;vertical-align:middle;">-0.8</td><td style="text-align:center;vertical-align:middle;"><span style="color:#fe2c24;">-0.984</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><strong>f</strong></td><td style="text-align:center;vertical-align:middle;">-4.147</td><td style="text-align:center;vertical-align:middle;">-4.804</td><td style="text-align:center;vertical-align:middle;">-4.403</td><td style="text-align:center;vertical-align:middle;"><span style="color:#956fe7;">-4.996</span></td></tr><tr><th colspan="1" rowspan="2" style="text-align:center;vertical-align:middle;"><strong>第二次</strong></th><td style="text-align:center;vertical-align:middle;"><strong>x</strong></td><td style="text-align:center;vertical-align:middle;">-1.1</td><td style="text-align:center;vertical-align:middle;">-0.984</td><td style="text-align:center;vertical-align:middle;">-0.8</td><td style="text-align:center;vertical-align:middle;"><span style="color:#fe2c24;">-0.990</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><strong>f</strong></td><td style="text-align:center;vertical-align:middle;">-4.804</td><td style="text-align:center;vertical-align:middle;">-4.996</td><td style="text-align:center;vertical-align:middle;">-4.403</td><td style="text-align:center;vertical-align:middle;"><span style="color:#956fe7;">-4.998</span></td></tr><tr><th colspan="1" rowspan="2" style="text-align:center;vertical-align:middle;"><strong>第三次</strong></th><td style="text-align:center;vertical-align:middle;"><strong>x</strong></td><td style="text-align:center;vertical-align:middle;">-1.1</td><td style="text-align:center;vertical-align:middle;">-0.990</td><td style="text-align:center;vertical-align:middle;">-0.984</td><td style="text-align:center;vertical-align:middle;"><span style="color:#fe2c24;">-1.008</span></td></tr><tr><td style="text-align:center;vertical-align:middle;"><strong>f</strong></td><td style="text-align:center;vertical-align:middle;">-4.804</td><td style="text-align:center;vertical-align:middle;">-4.998</td><td style="text-align:center;vertical-align:middle;">-4.996</td><td style="text-align:center;vertical-align:middle;"><span style="color:#956fe7;">-4.999</span></td></tr></tbody></table> 
<p></p> 
<p>那么我们看这个迭代结果，不难发现，求出的极小点是x=-1的近似值，并不是问题的全局最优解（x=2），由此，我们可以确定二次插值法对于初始点的要求较高，有时求出的并不是全局最优解，而是局部最优解。</p> 
<hr> 
<h4 style="background-color:transparent;">算法代码：</h4> 
<pre><code class="language-python">'''
二次插值算法(抛物线法）
2023.10.9
'''


def fun(x):
    return x ** 2 + 2 * x - 10
def run(x1, x2, x3):
    B1 = (x2 * x2 - x3 * x3) * fun(x1)
    B2 = (x3 * x3 - x1 * x1) * fun(x2)
    B3 = (x1 * x1 - x2 * x2) * fun(x3)
    C1 = (x2 - x3) * fun(x1)
    C2 = (x3 - x1) * fun(x2)
    C3 = (x1 - x2) * fun(x3)
    D = (x1 - x2) * (x2 - x3) * (x3 - x1)
    if (B1 + B2 + B3) == 0:
        x0 = 0
    else:
        x0 = (B1 + B2 + B3) / (2 * (C1 + C2 + C3))
    Arr = [x0, x1, x2, x3]
    Arr.sort()
    if fun(x0) &gt; fun(x2):
        index = Arr.index(x2)
        x1 = Arr[index - 1]
        x3 = Arr[index + 1]
    else:
        index = Arr.index(x0)
        x2 = x0
        x1 = Arr[index - 1]
        x3 = Arr[index + 1]
    return x1, x2, x3
def text(x1, x2, x3, ε):
    count = 0
    while abs(x3 - x1) and abs(x3 - x2) and abs(x2 - x1) &gt; ε:
        count = count + 1
        print("第{}次迭代".format(count))
        Arr2 = run(x1, x2, x3)
        x1 = Arr2[0]
        x2 = Arr2[1]
        x3 = Arr2[2]
        print(Arr2)
    print("该精度下的最优解为：%f" % x2)
    print("函数在该精度上的最小值为",fun(x2))
    return
text(-3, 0.5, 4, 0.0001)
</code></pre> 
<p>用该代码所运算的结果为：</p> 
<pre><code class="language-python">第1次迭代
(-3, -1.0, 0.5)
第2次迭代
(-3, -1.0, -1.0)
该精度下的最优解为：-1.000000
函数在该精度上的最小值为 -11.0</code></pre> 
<h4>总结：</h4> 
<p>二次插值法的优点在于对于局部最优解迭代速度较快，但是缺点也较明显，对于选定的三点，要求较高，有时求出的不是全局最高解而是局部最优解。</p> 
<hr> 
<h3>三次插值法：</h3> 
<h4>算法分析：</h4> 
<p>基本思想：首先选取两个初始点<img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/65/e4/LiB2fSwt_o.png">,<img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/a6/25/zYjIqgnO_o.png">,(<img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/da/e6/fmCANhka_o.png">&lt;<img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/3f/01/S5Tl2c9N_o.png">),使得<img alt="f'(x_{1})&lt; 0,f'(x_{2})&gt; 0" class="mathcode" src="https://images2.imgbox.com/c7/89/LEkI1CSi_o.png">,这样，在区间（<img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/c0/7e/zZzx7IWd_o.png">，<img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/b5/6f/xOUud2L8_o.png">）内存在极小点，然后利用这两点的函数值和导数值，构造一个三次多项式P（x），使它与<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/d2/cc/NUsvgDZj_o.png">在<img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/3d/aa/Sh1AnlnP_o.png">,<img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/f2/fb/ENrWA8s4_o.png">具有相同的函数值和导数值，用P（x)逼近函数<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/f2/c9/zcp1Th8Z_o.png">,进而用P（x)的极小点估计<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/59/7f/ORfiz1ba_o.png">的极小点。</p> 
<p>令                                <img alt="P(x) = a(x-x_{1}) ^{3}+ b(x-x_{1}) ^{2} + c(x-x_{1}) +d" class="mathcode" src="https://images2.imgbox.com/3c/cc/56a7QaOz_o.png"></p> 
<p>满足：            <img alt="P(x_{1}) = f(x_{1})" class="mathcode" src="https://images2.imgbox.com/71/67/GPlD1DST_o.png">，<img alt="P'(x_{1}) = f'(x_{1})" class="mathcode" src="https://images2.imgbox.com/4d/2e/XXBYaB1r_o.png">，<img alt="P(x_{2}) = f(x_{2})" class="mathcode" src="https://images2.imgbox.com/4f/32/mCcf1Smb_o.png">，<img alt="P'(x_{2}) = f'(x_{2})" class="mathcode" src="https://images2.imgbox.com/43/88/UIhFN77S_o.png"></p> 
<p>代入可得：                                                  <img alt="d = f(x_{1})" class="mathcode" src="https://images2.imgbox.com/ae/b7/EBKppSVS_o.png"></p> 
<p style="text-align:center;"><img alt="c = f'(x_{1})" class="mathcode" src="https://images2.imgbox.com/77/fa/ZHZgTEqS_o.png"></p> 
<p style="text-align:center;"><img alt="a(x_{2}-x_{1}) ^{3}+ b(x_{2}-x_{1}) ^{2} + c(x_{2}-x_{1}) +d=f(x_{2})" class="mathcode" src="https://images2.imgbox.com/ec/c9/1kiWyEs4_o.png"></p> 
<p style="text-align:center;"><img alt="3a(x_{2}-x_{1}) ^{2}+ 2b(x_{2}-x_{1}) + c =f'(x_{2})" class="mathcode" src="https://images2.imgbox.com/36/e9/XqILn3dG_o.png"></p> 
<p>解上述方程组，可求出系数a,b,c,d,从而确定三次多项式函数</p> 
<p>求P（x)的极小点，由极小点的必备条件，既求满足<img alt="P'(x)=0,P''(x)&gt; 0" class="mathcode" src="https://images2.imgbox.com/37/ce/lnnEREFr_o.png">的点，</p> 
<p>由                  <img alt="P'(x)=3a(x-x_{1}) ^{2}+ 2b(x-x_{1}) + c,P''(x)=6a(x-x_{1})+2b" class="mathcode" src="https://images2.imgbox.com/c2/f0/P4xImPlS_o.png"></p> 
<p>令<img alt="P'(x)=0" class="mathcode" src="https://images2.imgbox.com/42/b4/tfhkFzDJ_o.png">,                        <img alt="3a(x-x_{1}) ^{2}+ 2b(x-x_{1}) + c=0" class="mathcode" src="https://images2.imgbox.com/62/63/X2V8Rff6_o.png"></p> 
<p>解方程，有两种情形：</p> 
<p style="text-align:center;">（1）当a=0时，<img alt="\bar{x}-x_{1}=-\frac{c}{2b}" class="mathcode" src="https://images2.imgbox.com/f1/f7/6uf02dkE_o.png"></p> 
<p style="text-align:center;">（2）当a<img alt="\neq" class="mathcode" src="https://images2.imgbox.com/d4/ec/0pwEItyn_o.png">0时，<img alt="\bar{x}-x_{1}=\frac{-b\pm \sqrt{b^{2}-3ac}}{3a}" class="mathcode" src="https://images2.imgbox.com/2e/c6/LMdpg9Pb_o.png"></p> 
<p>第一种情况下，由假设<img alt="c = P'(x_{1})" class="mathcode" src="https://images2.imgbox.com/1b/ac/692xef6e_o.png">&lt;0,<img alt="P'(x_{2})" class="mathcode" src="https://images2.imgbox.com/d9/36/wohRLknl_o.png">&gt;0,<img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/79/c4/VTl6v9wv_o.png">&lt;<img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/cc/ff/WhhTAQyi_o.png"></p> 
<p>以及<img alt="3a(x_{2}-x_{1}) ^{2}+ 2b(x_{2}-x_{1}) + c =P'(x_{2})" class="mathcode" src="https://images2.imgbox.com/be/25/ZwQT24br_o.png">，可得b&gt;0,</p> 
<p>因此<img alt="P''(x)=2b&gt; 0" class="mathcode" src="https://images2.imgbox.com/b4/66/68CexjyU_o.png">,故<img alt="\bar{x}" class="mathcode" src="https://images2.imgbox.com/fb/b8/UecnowWd_o.png">是P（x)的极小点。</p> 
<p>第二种情况下，代入，由</p> 
<p style="text-align:center;"><img alt="P''(\bar{x})=6a(\bar{x}-x_{1})+2b=6a\frac{-b\pm \sqrt{b^{2}-3ac}}{3a}+2b=\pm 2\sqrt{b^{2}-3ac}" class="mathcode" src="https://images2.imgbox.com/eb/44/idrFtSYd_o.png"></p> 
<p>要使<img alt="P''(x)&gt; 0" class="mathcode" src="https://images2.imgbox.com/79/fd/1LwCtM4t_o.png">，则取               <img alt="\bar{x}-x_{1}=\frac{-b+\sqrt{b^{2}-3ac}}{3a}=\frac{-c}{b+\sqrt{b^{2}-3ac}}" class="mathcode" src="https://images2.imgbox.com/89/36/3sFOhQkc_o.png"></p> 
<p>故两种情况，极小点可以统一写成            <img alt="\bar{x}-x_{1}=\frac{-c}{b+\sqrt{b^{2}-3ac}}" class="mathcode" src="https://images2.imgbox.com/8e/c3/MhvmzkQL_o.png"></p> 
<p>记：</p> 
<p style="text-align:center;"><span style="color:#956fe7;"><strong><img alt="s=\frac{3[f(x_{2}-f(x_{1}))]}{x_{2}-x_{1}}" class="mathcode" src="https://images2.imgbox.com/55/a5/QQbvn9Gy_o.png">,<img alt="z=s-f'(x_{1})-f'(x_{2})" class="mathcode" src="https://images2.imgbox.com/36/d5/9dID1kuH_o.png">,<img alt="w^{2}=z^{2}-f'(x_{1})f'(x_{2}),(w&gt;0)" class="mathcode" src="https://images2.imgbox.com/d9/a3/t2NP01oY_o.png"></strong></span></p> 
<p>可推断出：</p> 
<p style="text-align:center;"><img alt="s=3[a(x_{2}-x_{1}) ^{2}+ 2b(x_{2}-x_{1}) + c]" class="mathcode" src="https://images2.imgbox.com/44/ee/MHkxmi2h_o.png"></p> 
<p style="text-align:center;"><img alt="z=b(x_{2}-x_{1}) + c" class="mathcode" src="https://images2.imgbox.com/1d/84/fsfyxxor_o.png"></p> 
<p style="text-align:center;"><img alt="w^{2}=(x_{2}-x_{1})^{2}(b^{2}-3ac)" class="mathcode" src="https://images2.imgbox.com/c4/a8/bHeJgi24_o.png"></p> 
<p>继续推导：</p> 
<p style="text-align:center;"><img alt="b=\frac{z-c}{x_{2}-x_{1}}=\frac{z-f'(x_{1})}{x_{2}-x_{1}}" class="mathcode" src="https://images2.imgbox.com/ed/2d/LSzXqpNA_o.png"></p> 
<p style="text-align:center;"><img alt="b^{2}-3ac=\frac{w^{2}}{(x_{2}-x_{1})^{2}}" class="mathcode" src="https://images2.imgbox.com/7f/0a/yorhUVvi_o.png"></p> 
<p>代入得：</p> 
<p style="text-align:center;"><img alt="\bar{x}-x_{1}=\frac{-f'(x_{1})(x_{2}-x_{1})}{z-f'(x_{1})+2w}" class="mathcode" src="https://images2.imgbox.com/42/43/3LzUzjMo_o.png"></p> 
<p>又将等式右端上下同时乘以<img alt="f'(x_{2})" class="mathcode" src="https://images2.imgbox.com/c6/82/9FgGXA3P_o.png">,得到下式：</p> 
<p style="text-align:center;"><img alt="\bar{x}-x_{1}=\frac{-f'(x_{1})(x_{2}-x_{1})f'(x_{2})}{[z-f'(x_{1})+2w]f'(x_{2})}=\frac{(x_{2}-x_{1})(w+z)}{f'(x_{2})+(w-z)}" class="mathcode" src="https://images2.imgbox.com/f1/24/4OsUqPhY_o.png"></p> 
<p>将两个式子相加，我们可以得到：</p> 
<p style="text-align:center;"><img alt="\bar{x}-x_{1}=\frac{(x_{2}-x_{1})[w+z-f'(x_{1})]}{f'(x_{2})-f'(x_{1})+2w}" class="mathcode" src="https://images2.imgbox.com/63/16/SQeMNvfh_o.png"></p> 
<p>化简为：</p> 
<p style="text-align:center;"><img alt="\bar{x}=x_{1}+(x_{2}-x_{1})[1-\frac{w+z+f'(x_{2})}{f'(x_{2})-f'(x_{1})+2w}]" class="mathcode" src="https://images2.imgbox.com/6a/17/G6cfxlIp_o.png"></p> 
<p>其中，<img alt="f'(x_{2})-f'(x_{1})+2w&gt;0" class="mathcode" src="https://images2.imgbox.com/cb/21/eQfdAoB6_o.png">成立。由此，可利用<img alt="f(x_{1})" class="mathcode" src="https://images2.imgbox.com/d6/e0/pUHpkguW_o.png">，<img alt="f'(x_{1})" class="mathcode" src="https://images2.imgbox.com/f9/40/t0VeYHFe_o.png">，<img alt="f(x_{2})" class="mathcode" src="https://images2.imgbox.com/92/3e/8XakdNuJ_o.png">，<img alt="f'(x_{2})" class="mathcode" src="https://images2.imgbox.com/1a/f3/2kR6I3q8_o.png">就可以求出P（x）的极小点。若<img alt="\left | f(\bar{x})\right |" class="mathcode" src="https://images2.imgbox.com/82/4b/LKYoLrBw_o.png">充分小，就可以将P（x)的极小点作为<img alt="f(x)" class="mathcode" src="https://images2.imgbox.com/92/56/QxeFEU6B_o.png">的可接受的极小点；否则，可以从<img alt="x_{1}" class="mathcode" src="https://images2.imgbox.com/bb/bc/CW6dsROI_o.png">,<img alt="x_{2}" class="mathcode" src="https://images2.imgbox.com/8f/ca/tOpFyum1_o.png">，<img alt="\bar{x}" class="mathcode" src="https://images2.imgbox.com/c7/b9/db2H7EGP_o.png">中确定两个点重复以上过程。</p> 
<h4>例题分析：</h4> 
<p>下面我们通过例题来进一步加深对算法的理解，</p> 
<p>例题：用三次插值法求解下列问题：<img alt="min f(x)=x^{3}-3x+1" class="mathcode" src="https://images2.imgbox.com/5d/70/YEvUpI7k_o.png">,<img alt="s.t. 0\leq x\leq 2" class="mathcode" src="https://images2.imgbox.com/d9/ec/7Ttn8vlF_o.png">,初始点取<img alt="x_{1}=0,x_{2}=2" class="mathcode" src="https://images2.imgbox.com/af/7f/AphzeYiC_o.png"></p> 
<p>解：                                          <img alt="x_{1}=0,x_{2}=2" class="mathcode" src="https://images2.imgbox.com/66/b2/lVbtEALs_o.png">，<img alt="x_{2}-x_{1}=2" class="mathcode" src="https://images2.imgbox.com/d1/0b/qYp4O4T5_o.png"></p> 
<p style="text-align:center;"><img alt="f(x)=x^{3}-3x+1,f'(x)=3x^{2}-3,f''(x)=6x" class="mathcode" src="https://images2.imgbox.com/2b/39/Oy7r7XyY_o.png"></p> 
<p style="text-align:center;"><img alt="f(x_{1})=1,f'(x_{1})=-3,f''(x_{1})=0" class="mathcode" src="https://images2.imgbox.com/0f/5f/u3lW2O2n_o.png"></p> 
<p style="text-align:center;"><img alt="f(x_{2})=3,f'(x_{2})=9,f''(x_{2})=12" class="mathcode" src="https://images2.imgbox.com/7b/64/88wjwz6b_o.png"></p> 
<p style="text-align:center;">∴<img alt="s=\frac{3[f(x_{2}-f(x_{1}))]}{x_{2}-x_{1}}=3" class="mathcode" src="https://images2.imgbox.com/23/4f/LBd2mrQC_o.png"></p> 
<p style="text-align:center;"><span style="color:#956fe7;"><strong><img alt="z=s-f'(x_{1})-f'(x_{2})=-3" class="mathcode" src="https://images2.imgbox.com/e2/cc/L7b6TQYA_o.png"></strong></span></p> 
<p style="text-align:center;"><span style="color:#956fe7;"><strong><img alt="w^{2}=z^{2}-f'(x_{1})f'(x_{2})=36" class="mathcode" src="https://images2.imgbox.com/67/4b/DVvfs0Mc_o.png"></strong></span></p> 
<p style="text-align:center;"><img alt="\bar{x}=x_{1}+(x_{2}-x_{1})[1-\frac{w+z+f'(x_{2})}{f'(x_{2})-f'(x_{1})+2w}]=1" class="mathcode" src="https://images2.imgbox.com/8a/2f/hwcUxmlb_o.png"></p> 
<p style="text-align:center;"><img alt="f(\bar{x})=f(1)=-1,f'(\bar{x})=0" class="mathcode" src="https://images2.imgbox.com/cb/a6/n0pF1RC5_o.png"></p> 
<p>经过一次迭代，就可以达到最优解。</p> 
<hr> 
<h4 style="background-color:transparent;">算法代码：</h4> 
<pre><code class="language-python">'''
三次插值算法
2023.10.9
'''
from sympy import *
x = symbols("x")
f_x = x**3-12*x-20

def run(x1,x2,ε):
    count = 0
    # 一阶求导
    first_grad = diff(f_x,x)
    # 判断给定区间内是否存在极小点
    if first_grad.subs({x: x1}) * first_grad.subs({x: x2}) &gt; 0:
        print("该函数在该区间不存在极小点")
    else:
        print("该函数在该区间存在极小点")
        while abs(x2-x1) &gt;= ε:
            count = count+1
            print("第{}次迭代".format(count))
            s = 3*( f_x.subs(x,x2) - f_x.subs(x,x1) )/(x2-x1)
            z = s - first_grad.subs({x: x1})-first_grad.subs({x: x2})
            w = (z * z -first_grad.subs({x: x1})*first_grad.subs({x: x2}))**0.5
            x0 = x1 + (x2-x1)*(1-((first_grad.subs({x: x2}))+w+z)/(first_grad.subs({x: x2})-first_grad.subs({x: x1})+2*w))
            if first_grad.subs({x: x0}) == 0:
                print("该精度下的最优解为：%f"%x0)
                break
            elif first_grad.subs({x: x0}) &gt; 0:
                x1 = x0
            elif first_grad.subs({x: x0}) &lt; 0:
                x2 = x0
        print("该精度下的最优解为：%f" % x0)
        return

run(1,5,0.001)</code></pre> 
<p>用该代码所运算的结果为：</p> 
<pre><code class="language-python">该函数在该区间存在极小点
第1次迭代
该精度下的最优解为：2.000000
该精度下的最优解为：2.000000</code></pre> 
<h4>总结：</h4> 
<p>三次插值法的收敛阶为2，一般认为要优于二次插值法。</p> 
<h3>算法比较：</h3> 
<p>从上面的一些例子，不难看出：在一维搜索方法中，利用导数的算法一般优于不利于导数的直接法，比如两分法，牛顿切线法，三次插值法优于成功—失败法，黄金分割算法和二次插值法；利用二阶导数的算法优于利用一阶导数的算法，如牛顿切线法优于二分法，当然也不尽然。</p> 
<p>（行文中若有纰漏，希望大家指正）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1cb712860b4ef1230b1acb0ae77aa1ab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一篇文章让你数组入门到精通</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/de71a8e9f005250713cfd875dbfbd72f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ZYNQ连载06-EasyLogger日志组件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>