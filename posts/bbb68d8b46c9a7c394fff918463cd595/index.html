<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux系统部署OpenCV环境（java项目使用方式） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux系统部署OpenCV环境（java项目使用方式）" />
<meta property="og:description" content="一、需要的东西 Opencv4.5.2的zip包（OpenCV官网下载）
二、操作步骤 1. 上传opencv4.5.2的zip包到home目录（不一定home目录，根据运维情况决定）
2. 运行解压缩命令
unzip opencv-452.zip 3. 进入opencv-452文件夹，创建文件夹
cd opencv-452 mkdir build 4. 进入文件夹中
cd build 5. 如果没有安装cmake，使用下列命令安装，并且查看版本信息。
sudo yum install cmake cmake -version 需要高一点的版本，我安装的是cmake version 3.7.2版本，如果版本过低会提示升级版本。
解决方法： （1）移除老版本cmake版本并安装依赖包
yum remove cmake -y ; yum install -y gcc gcc-c&#43;&#43; make automake openssl openssl-devel （2）下载cmake-3.7.2.tar.gz安装包并解压 cmake官网地址，或者直接命令安装
wget https://cmake.org/files/v3.7/cmake-3.7.2.tar.gz ; tar -zxf cmake*.tar.gz （3）编译/安装
cd cmake* ; ./bootstrap ; gmake -j `grep &#39;processor&#39; /proc/cpuinfo | wc -l` ; gmake install （4）查看编译后的cmake版本并创建连接" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bbb68d8b46c9a7c394fff918463cd595/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-11T11:26:43+08:00" />
<meta property="article:modified_time" content="2023-05-11T11:26:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux系统部署OpenCV环境（java项目使用方式）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>一、需要的东西</h3> 
<p style="text-align:left;">Opencv4.5.2的zip包（<a class="link-info" href="https://opencv.org/releases/" rel="nofollow" title="OpenCV官网下载">OpenCV官网下载</a>）</p> 
<h3 style="text-align:left;">二、操作步骤</h3> 
<p>1. 上传opencv4.5.2的zip包到home目录（不一定home目录，根据运维情况决定）</p> 
<p>2. 运行解压缩命令</p> 
<pre><code class="hljs">unzip opencv-452.zip</code></pre> 
<p>3. 进入opencv-452文件夹，创建文件夹</p> 
<pre><code class="hljs">cd opencv-452

mkdir build</code></pre> 
<p>4. 进入文件夹中</p> 
<pre><code class="hljs">cd build</code></pre> 
<p>5. 如果没有安装cmake，使用下列命令安装，并且查看版本信息。</p> 
<pre><code class="hljs">sudo yum install cmake

cmake -version</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">需要高一点的版本，我安装的是cmake version 3.7.2版本，如果版本过低会提示升级版本。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="186" src="https://images2.imgbox.com/ce/2f/nJYstaNj_o.png" width="800"></p> 
<h4> 解决方法：</h4> 
<p>（1）移除老版本cmake版本并安装依赖包</p> 
<pre><code class="hljs">yum remove cmake -y ; yum install -y gcc gcc-c++ make automake openssl openssl-devel</code></pre> 
<p>（2）下载cmake-3.7.2.tar.gz安装包并解压  <a class="link-info" href="https://cmake.org/download/" rel="nofollow" title="cmake官网地址">cmake官网地址</a>，或者直接命令安装</p> 
<pre><code class="hljs">wget https://cmake.org/files/v3.7/cmake-3.7.2.tar.gz ; tar -zxf cmake*.tar.gz</code></pre> 
<p>（3）编译/安装</p> 
<pre><code class="hljs">cd cmake* ; ./bootstrap ; gmake -j `grep 'processor' /proc/cpuinfo | wc -l` ; gmake install</code></pre> 
<p>（4）查看编译后的cmake版本并创建连接</p> 
<pre><code class="hljs">/usr/local/bin/cmake --version
ln -s /usr/local/bin/cmake /usr/bin/</code></pre> 
<p>（5）验证新版本</p> 
<pre><code class="hljs">cmake --version</code></pre> 
<p><img alt="" height="105" src="https://images2.imgbox.com/7e/89/OcpnKhjN_o.png" width="495"></p> 
<p>6. 接下来生成和配置cmake在我们的系统中构建可执行文件，输入命令</p> 
<pre><code class="hljs">cmake -D CMAKE_BUILD_TYPE=RELEASE -D CMAKE_INSTALL_PREFIX=/usr/local ..</code></pre> 
<p> 7. 此时注意看执行结果，构建正常则是以下结果</p> 
<p><img alt="" height="152" src="https://images2.imgbox.com/5e/86/r0kxaxar_o.png" width="851"></p> 
<p style="margin-left:.0001pt;text-align:justify;">如果构建失败没有找到ant和java，那么可能会得到以下输出：</p> 
<p><img alt="" height="154" src="https://images2.imgbox.com/a0/e1/eGNUwOgb_o.png" width="495"></p> 
<h4>解决办法：</h4> 
<p style="margin-left:.0001pt;text-align:left;">如果ant和JNI都是（NO）没有具体的路径，那么就是需要安装并设置java和安装ant。</p> 
<p style="margin-left:.0001pt;text-align:left;">执行命令</p> 
<pre><code class="hljs">sudo yum install ant</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">成功后再次执行第 6 步操作，如果还是(NO),就再试一下</p> 
<pre><code class="hljs">sudo snap install ant --classic</code></pre> 
<p>8. 上述操作成功后就开始生成，执行</p> 
<pre><code class="hljs">make -j4</code></pre> 
<p>其中（-j4）里边的4代表有几个核心，根据自己的服务器来写，四核就写4，八核就写8，量力而为，写少了安装慢，写超了服务器可能就崩溃了</p> 
<p> 9. 上述命令执行完成之后继续执行</p> 
<pre><code class="hljs">sudo make install</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">执行结束后查看 /user/local/share/java/opencv4 目录下是否有libopencv_java452.so文件和opencv-452.jar文件，如果有则说明安装成功</p> 
<p style="margin-left:.0001pt;text-align:justify;">10. 将libopencv_java452.so复制到/usr/lib下，执行命令：</p> 
<pre><code class="hljs">cp /usr/local/share/java/opencv4/libopencv_java452.so /usr/lib/</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">然后启动服务即可</p> 
<p style="margin-left:.0001pt;text-align:justify;">增加配置类，不同环境的opencv加载方法</p> 
<pre><code class="hljs">import org.apache.commons.lang3.SystemUtils;
import org.opencv.core.Core;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.net.URL;

@Configuration
public class OpenCVConfig {

    @Bean
    public void openCVLoad(){
        if (SystemUtils.IS_OS_WINDOWS) {
            System.out.println("windows启动OpenCV");
            String libName = "lib/opencv_java452.dll";
            URL url = ClassLoader.getSystemResource(libName);
            System.load(url.getPath());
        } else if (SystemUtils.IS_OS_LINUX) {
            System.out.println("linux启动OpenCV");
            System.loadLibrary(Core.NATIVE_LIBRARY_NAME);
        }
    }
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/90e39f509fb59fb057d971bf90e22e02/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python中的深拷贝和浅拷贝</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6669bee35dcec7f742a72a647050e1c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">从redis哈希数据类型的各种使用场景深刻理解它</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>