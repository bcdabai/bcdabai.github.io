<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Django-admin的基本使用，以及预览显示[object]，自定义显示名问题的处理 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Django-admin的基本使用，以及预览显示[object]，自定义显示名问题的处理" />
<meta property="og:description" content="Django-admin的基本使用，以及预览显示[object]，自定义显示名问题的处理 这里只讲解admin的简单使用,复杂使用请见后续文章 Django-admin是Django本身自带的后台管理工具，可以让开发者方便的通过网页管理数据表，进行相关的数据库增删查改等操作，并且与Django定义的函数等高度依赖。
1. Django-admin使用准备 使用Django-admin需要进行以下几个步骤
1.1 注册admin App 创建Django项目时如果指定了使用Django - admin，则会自动注册该App
setting.py
INSTALLED_APPS = [ &#34;django.contrib.admin&#34;, # -&gt; admin App &#34;django.contrib.auth&#34;, &#34;django.contrib.contenttypes&#34;, &#34;django.contrib.sessions&#34;, &#34;django.contrib.messages&#34;, &#34;django.contrib.staticfiles&#34;, &#34;App01&#34;, &#34;my_user&#34;, ] 1.2 注册admin路由 默认会自动注册admin的路由，即/admin，当然我们可以自定义更改为其他路由。
from django.contrib import admin from django.urls import path, urlpatterns = [ path(&#34;admin/&#34;, admin.site.urls), # Django管理员的入口admin.site.urls ] 1.3 迁移数据库,生成相关的Django管理员表 # 生成数据库迁移文件 python ./manage.py makemigrations # 执行迁移 python ./manage.py migrate 生成完毕后,我们可以发现数据库中多了auth相关的表,这些都是Django-admin相关数据表
1.4 创建Django-admin超级管理员用户 python ./manage.py createsuperuser --&gt; 用户名 (leave blank to use &#39;本机计算机用户名&#39;): # 这里输入用户名,不输入则会用计算机用户名命名 电子邮件地址: # 空即可 Password: # 输入密码和确认密码即可 创建完成后,再去查看auth_user表，就会发现已经创建了一个新用户。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/577e9ee3790d42c36ca85ed10cae71ec/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-02T19:24:16+08:00" />
<meta property="article:modified_time" content="2023-08-02T19:24:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Django-admin的基本使用，以及预览显示[object]，自定义显示名问题的处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Djangoadminobject_0"></a>Django-admin的基本使用，以及预览显示[object]，自定义显示名问题的处理</h2> 
<h2><a id="admin_1"></a>这里只讲解admin的简单使用,复杂使用请见后续文章</h2> 
<p>Django-admin是Django本身自带的后台管理工具，可以让开发者方便的通过网页管理数据表，进行相关的数据库增删查改等操作，并且与Django定义的函数等高度依赖。</p> 
<h2><a id="1_Djangoadmin_8"></a>1. Django-admin使用准备</h2> 
<p>使用Django-admin需要进行以下几个步骤</p> 
<h4><a id="11_admin_App_12"></a>1.1 注册admin App</h4> 
<p>创建Django项目时如果指定了使用Django - admin，则会自动注册该App</p> 
<p><strong>setting.py</strong></p> 
<pre><code class="prism language-python">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"django.contrib.admin"</span><span class="token punctuation">,</span> <span class="token comment"># -&gt; admin App</span>
    <span class="token string">"django.contrib.auth"</span><span class="token punctuation">,</span>
    <span class="token string">"django.contrib.contenttypes"</span><span class="token punctuation">,</span>
    <span class="token string">"django.contrib.sessions"</span><span class="token punctuation">,</span>
    <span class="token string">"django.contrib.messages"</span><span class="token punctuation">,</span>
    <span class="token string">"django.contrib.staticfiles"</span><span class="token punctuation">,</span>
    <span class="token string">"App01"</span><span class="token punctuation">,</span>
    <span class="token string">"my_user"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> 
<h4><a id="12_admin_31"></a>1.2 注册admin路由</h4> 
<p>默认会自动注册admin的路由，即/admin，当然我们可以自定义更改为其他路由。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">"admin/"</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># Django管理员的入口admin.site.urls</span>
    <span class="token punctuation">]</span>
</code></pre> 
<h4><a id="13_Django_44"></a>1.3 迁移数据库,生成相关的Django管理员表</h4> 
<pre><code class="prism language-python"><span class="token comment"># 生成数据库迁移文件</span>
python <span class="token punctuation">.</span><span class="token operator">/</span>manage<span class="token punctuation">.</span>py makemigrations 
<span class="token comment"># 执行迁移</span>
python <span class="token punctuation">.</span><span class="token operator">/</span>manage<span class="token punctuation">.</span>py migrate
</code></pre> 
<p>生成完毕后,我们可以发现数据库中多了auth相关的表,这些都是Django-admin相关数据表<br> <img src="https://images2.imgbox.com/4d/84/HErt6kCc_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="14_Djangoadmin_57"></a>1.4 创建Django-admin超级管理员用户</h4> 
<pre><code class="prism language-python">python <span class="token punctuation">.</span><span class="token operator">/</span>manage<span class="token punctuation">.</span>py createsuperuser
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> 用户名 <span class="token punctuation">(</span>leave blank to use <span class="token string">'本机计算机用户名'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token comment"># 这里输入用户名,不输入则会用计算机用户名命名</span>
电子邮件地址<span class="token punctuation">:</span>  <span class="token comment"># 空即可</span>
Password<span class="token punctuation">:</span> <span class="token comment"># 输入密码和确认密码即可</span>
</code></pre> 
<p>创建完成后,再去查看auth_user表，就会发现已经创建了一个新用户。</p> 
<p><img src="https://images2.imgbox.com/37/cd/s8qzFcU8_o.png" alt="在这里插入图片描述"></p> 
<p>当然，密码是经过hash和加密的。</p> 
<h2><a id="2_modelsadmin_73"></a>2. 将指定的models注册到admin中管理</h2> 
<p>想要使用Django-admin管理，需要先将对应的model在admin中注册，才能够使用admin进行管理。</p> 
<p>在App的admin.py目录中对model进行注册即可</p> 
<p><strong>app / admin.py</strong></p> 
<pre><code class="prism language-admin">from django.contrib import admin
# 语法格式
admin.site.register(Model对象)
</code></pre> 
<h2><a id="3_Djangoadmin_87"></a>3. 访问Django-admin</h2> 
<p><strong>输入刚刚配置的路由地址访问即可，使用刚刚的账号密码登录。</strong></p> 
<p><img src="https://images2.imgbox.com/08/9a/wsY0qLnI_o.png" alt="在这里插入图片描述"></p> 
<p>如果你这里是英文，那么需要在settings.py把语言设置给改下。</p> 
<p><strong>setting.py</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># LANGUAGE_CODE = "en-us" # 默认英文</span>
LANGUAGE_CODE <span class="token operator">=</span> <span class="token string">"zh-hans"</span>
</code></pre> 
<p><strong>通过admin，可以方便的进行增删查改</strong><br> <img src="https://images2.imgbox.com/85/3a/6kZvp24w_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4_Djangoadmin__106"></a>4. Django-admin 字段显示的问题</h2> 
<p>Django-admin常见的显示问题，一般有两个</p> 
<ol><li>预览数据表的时候，显示[object],其实这是定义类的魔法方法 __ str __的问题</li><li>想让他显示中文或者自定义一个名字，而不是字段名（不好读）</li></ol> 
<h3><a id="41_object_113"></a>4.1 显示[object]的解决方案</h3> 
<p>重写我们定义的model的__ str __ 方法，让他返回一个我们想让返回的格式:</p> 
<p><strong>models.py</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models

<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    	<span class="token triple-quoted-string string">"""
    		重写__str__方法，这样只要打印这个相关的都会显示nickname
    	"""</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'昵称:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>nickname<span class="token punctuation">}</span></span><span class="token string">'</span></span>

    nickname <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'昵称'</span><span class="token punctuation">)</span>
    age <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'年龄'</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'姓名'</span><span class="token punctuation">)</span>
    phone <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'手机号'</span><span class="token punctuation">)</span>
    is_admin <span class="token operator">=</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'管理员'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

</code></pre> 
<p><strong>修改后就会正常显示结果</strong><br> <img src="https://images2.imgbox.com/ce/0a/dqUJGZFu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="42__142"></a>4.2 自定义字段名</h3> 
<p>还有人就问了，我图上为什么显示的是 “用户信息”，而不是User表，这就是因为对verbose_name的定义</p> 
<pre><code class="prism language-python"><span class="token comment"># 对于字段而言:</span>
<span class="token comment"># 例如:</span>
nickname <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'nickname'</span><span class="token punctuation">)</span> <span class="token comment"># 这里的nickname,实际定义的是数据库中的字段名,默认是Python我们定义的名字,所以一般不需要额外写</span>
nickname <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'昵称'</span><span class="token punctuation">)</span> <span class="token comment"># 只有我们定义verbose_name才是人所看到的名字,也是admin中所显示的</span>


<span class="token comment"># 对于表而言:</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>

	<span class="token comment"># 我们需要定义model的内部Meta类,这个类中定义的verbose_name就是admin中最后看到的值</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
            Django类的Meta类
            通过Meta类可以指定该model对象的基本信息
            eg:
                db_table:指定模型在数据库中的表名,缺省表名: app名+类名： [app_name]_info.
                indexes:定义在模型上的数据库索引
                verbose_name:定义模型的人类可读名称,一般用于Django-admin系统显示
                ...
        """</span>
        db_table <span class="token operator">=</span> <span class="token string">'User_info'</span>
        verbose_name <span class="token operator">=</span> <span class="token string">'用户信息'</span>
        verbose_name_plural <span class="token operator">=</span> <span class="token string">'用户信息'</span>  <span class="token comment"># 表示复数形式的显示,中文一般不区别</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/41d261591b91353414c7b83165570098/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">单元测试之- mock工具mockito</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4fc16126812186246619eba840730391/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python中for..in语法的原理？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>