<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【STM32CubeMX——PWM配置】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【STM32CubeMX——PWM配置】" />
<meta property="og:description" content=" 使用CubeMX对STM32进行PWM配置 一、使用CubeMX进行基本配置 1、选择定时器通道 随便选择一个为例子，TIM2的channel 1
2、对TIM2 channel1的预分频器、自动重装值等进行设置 时钟配置的是72MHZ的，预分频器就设置的71
关于PWM的模式选择
(1)、PWM mode 1：
在向上计数中，当计数值小于CCR值时输出高电平，计数值大于CCR值时输出低电平；在向下计数中，当计数值小于CCR值时输出低电平，计数值大于CCR值时输出高电平；
(2)、PWM mode 2:
在向上计数中，当计数值小于CCR值时输出低电平，计数值大于CCR值时输出高电平；在向下计数中，当计数值小于CCR值时输出高电平，计数值大于CCR值时输出低电平；
PWM频率：Freq = CK_PSC/(PSC&#43;1)/(ARR&#43;1)
PWM占空比：Duty = CRR/(ARR&#43;1)
PWM分辨率：Reso = 1/(ARR&#43;1)
二、在keil 5 中进一步完善 1、开启定时器1的通道1的PWM输出 在stm32f1xx_hal_tim.c里面找到HAL_TIM_PWM_Start()函数开启定时器1的通道1的PWM输出
/* USER CODE BEGIN TIM2_Init 2 */ HAL_TIM_PWM_Start(&amp;htim2,TIM_CHANNEL_1); /* USER CODE END TIM2_Init 2 */** 在主函数里面或者其它地方都可以，我是在定时器的初始化里面开启的
2、改变CCR的值（改变占空比） 有两种方法，一种是调用hal库里面的__HAL_TIM_SetCompare()函数，还有一种就是直接操作寄存器`
/* USER CODE BEGIN 2 */ int speed=0; __HAL_TIM_SetCompare(&amp;htim2,TIM_CHANNEL_1,speed); TIM2-&gt;CCR1 = speed; 与上方作用相同 /* USER CODE END 2 */ " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/909afcdddcf8fc51739edc6b820f3778/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-19T00:32:38+08:00" />
<meta property="article:modified_time" content="2022-09-19T00:32:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【STM32CubeMX——PWM配置】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="CubeMXSTM32PWM_0"></a>使用CubeMX对STM32进行PWM配置</h2> 
<table><tbody><tr><td bgcolor="yellow"> 一、使用CubeMX进行基本配置</td></tr></tbody></table> 
<h6><a id="1_3"></a>1、选择定时器通道</h6> 
<p>随便选择一个为例子，<code>TIM2</code>的<code>channel 1</code><br> <img src="https://images2.imgbox.com/fd/91/T6KtITV1_o.png" alt="在这里插入图片描述" width="500"></p> 
<h6><a id="2TIM2_channel1_6"></a>2、对<mark>TIM2 channel1</mark>的预分频器、自动重装值等进行设置</h6> 
<p>时钟配置的是72MHZ的，预分频器就设置的71<br> <img src="https://images2.imgbox.com/9a/62/jD9C5Bhi_o.png" alt="在这里插入图片描述" width="500"><br> 关于PWM的模式选择<br> (1)、<mark>PWM mode 1</mark>：<br> 在向上计数中，当计数值小于CCR值时输出高电平，计数值大于CCR值时输出低电平；在向下计数中，当计数值小于CCR值时输出低电平，计数值大于CCR值时输出高电平；<br> (2)、<mark>PWM mode 2</mark>:<br> 在向上计数中，当计数值小于CCR值时输出低电平，计数值大于CCR值时输出高电平；在向下计数中，当计数值小于CCR值时输出高电平，计数值大于CCR值时输出低电平；<br> PWM频率：<code>Freq = CK_PSC/(PSC+1)/(ARR+1)</code><br> PWM占空比：<code>Duty = CRR/(ARR+1)</code><br> PWM分辨率：<code>Reso = 1/(ARR+1)</code></p> 
<table><tbody><tr><td bgcolor="yellow">二、在keil 5 中进一步完善</td></tr></tbody></table> 
<h6><a id="111PWM_19"></a>1、开启定时器1的通道1的PWM输出</h6> 
<p>在<code>stm32f1xx_hal_tim.c</code>里面找到<code>HAL_TIM_PWM_Start()</code>函数开启定时器1的通道1的PWM输出</p> 
<pre><code class="prism language-c"> <span class="token comment">/* USER CODE BEGIN TIM2_Init 2 */</span>
	<span class="token function">HAL_TIM_PWM_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim2<span class="token punctuation">,</span>TIM_CHANNEL_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/* USER CODE END TIM2_Init 2 */</span><span class="token operator">*</span><span class="token operator">*</span>
</code></pre> 
<p>在主函数里面或者其它地方都可以，我是在定时器的初始化里面开启的</p> 
<h6><a id="2CCR_28"></a>2、改变CCR的值（改变占空比）</h6> 
<p>有两种方法，一种是调用hal库里面的<code>__HAL_TIM_SetCompare()</code>函数，还有一种就是直接操作寄存器`</p> 
<pre><code class="prism language-c">  <span class="token comment">/* USER CODE BEGIN 2 */</span>
	<span class="token keyword">int</span> speed<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">__HAL_TIM_SetCompare</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>htim2<span class="token punctuation">,</span>TIM_CHANNEL_1<span class="token punctuation">,</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 TIM2<span class="token operator">-&gt;</span>CCR1 <span class="token operator">=</span> speed<span class="token punctuation">;</span>         与上方作用相同
  <span class="token comment">/* USER CODE END 2 */</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f578e0c56222c0c5a2c422f9f406d9af/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一文带你透析zookeeper原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/99fd23177f84f2c8dd80beb5d557bbca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">DM 数据库初始化工具</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>