<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>爬去高德地图的公司信息 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="爬去高德地图的公司信息" />
<meta property="og:description" content="# _*_ coding:utf-8 _*_ from __future__ import division import requests import sys import json import tkinter as tk from tkinter import * from tkinter import ttk import xlwt import math import time import datetime cityJsonStr = [{&#39;provice&#39;:&#39;安徽&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;340100&#39;,&#39;name&#39;:&#39;合肥&#39;},{&#39;adcode&#39;:&#39;340200&#39;,&#39;name&#39;:&#39;芜湖&#39;},{&#39;adcode&#39;:&#39;340300&#39;,&#39;name&#39;:&#39;蚌埠&#39;},{&#39;adcode&#39;:&#39;340400&#39;,&#39;name&#39;:&#39;淮南&#39;},{&#39;adcode&#39;:&#39;340500&#39;,&#39;name&#39;:&#39;马鞍山&#39;},{&#39;adcode&#39;:&#39;340600&#39;,&#39;name&#39;:&#39;淮北&#39;},{&#39;adcode&#39;:&#39;340700&#39;,&#39;name&#39;:&#39;铜陵&#39;},{&#39;adcode&#39;:&#39;340800&#39;,&#39;name&#39;:&#39;安庆&#39;},{&#39;adcode&#39;:&#39;341000&#39;,&#39;name&#39;:&#39;黄山&#39;},{&#39;adcode&#39;:&#39;341100&#39;,&#39;name&#39;:&#39;滁州&#39;},{&#39;adcode&#39;:&#39;341200&#39;,&#39;name&#39;:&#39;阜阳&#39;},{&#39;adcode&#39;:&#39;341300&#39;,&#39;name&#39;:&#39;宿州&#39;},{&#39;adcode&#39;:&#39;341500&#39;,&#39;name&#39;:&#39;六安&#39;},{&#39;adcode&#39;:&#39;341600&#39;,&#39;name&#39;:&#39;亳州&#39;},{&#39;adcode&#39;:&#39;341700&#39;,&#39;name&#39;:&#39;池州&#39;},{&#39;adcode&#39;:&#39;341800&#39;,&#39;name&#39;:&#39;宣城&#39;}]},{&#39;provice&#39;:&#39;福建&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;350100&#39;,&#39;name&#39;:&#39;福州&#39;},{&#39;adcode&#39;:&#39;350200&#39;,&#39;name&#39;:&#39;厦门&#39;},{&#39;adcode&#39;:&#39;350300&#39;,&#39;name&#39;:&#39;莆田&#39;},{&#39;adcode&#39;:&#39;350400&#39;,&#39;name&#39;:&#39;三明&#39;},{&#39;adcode&#39;:&#39;350500&#39;,&#39;name&#39;:&#39;泉州&#39;},{&#39;adcode&#39;:&#39;350600&#39;,&#39;name&#39;:&#39;漳州&#39;},{&#39;adcode&#39;:&#39;350700&#39;,&#39;name&#39;:&#39;南平&#39;},{&#39;adcode&#39;:&#39;350800&#39;,&#39;name&#39;:&#39;龙岩&#39;},{&#39;adcode&#39;:&#39;350900&#39;,&#39;name&#39;:&#39;宁德&#39;}]},{&#39;provice&#39;:&#39;广东&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;440100&#39;,&#39;name&#39;:&#39;广州&#39;},{&#39;adcode&#39;:&#39;440200&#39;,&#39;name&#39;:&#39;韶关&#39;},{&#39;adcode&#39;:&#39;440300&#39;,&#39;name&#39;:&#39;深圳&#39;},{&#39;adcode&#39;:&#39;440400&#39;,&#39;name&#39;:&#39;珠海&#39;},{&#39;adcode&#39;:&#39;440500&#39;,&#39;name&#39;:&#39;汕头&#39;},{&#39;adcode&#39;:&#39;440600&#39;,&#39;name&#39;:&#39;佛山&#39;},{&#39;adcode&#39;:&#39;440700&#39;,&#39;name&#39;:&#39;江门&#39;},{&#39;adcode&#39;:&#39;440800&#39;,&#39;name&#39;:&#39;湛江&#39;},{&#39;adcode&#39;:&#39;440900&#39;,&#39;name&#39;:&#39;茂名&#39;},{&#39;adcode&#39;:&#39;441200&#39;,&#39;name&#39;:&#39;肇庆&#39;},{&#39;adcode&#39;:&#39;441300&#39;,&#39;name&#39;:&#39;惠州&#39;},{&#39;adcode&#39;:&#39;441400&#39;,&#39;name&#39;:&#39;梅州&#39;},{&#39;adcode&#39;:&#39;441500&#39;,&#39;name&#39;:&#39;汕尾&#39;},{&#39;adcode&#39;:&#39;441600&#39;,&#39;name&#39;:&#39;河源&#39;},{&#39;adcode&#39;:&#39;441700&#39;,&#39;name&#39;:&#39;阳江&#39;},{&#39;adcode&#39;:&#39;441800&#39;,&#39;name&#39;:&#39;清远&#39;},{&#39;adcode&#39;:&#39;441900&#39;,&#39;name&#39;:&#39;东莞&#39;},{&#39;adcode&#39;:&#39;442000&#39;,&#39;name&#39;:&#39;中山&#39;},{&#39;adcode&#39;:&#39;445100&#39;,&#39;name&#39;:&#39;潮州&#39;},{&#39;adcode&#39;:&#39;445200&#39;,&#39;name&#39;:&#39;揭阳&#39;},{&#39;adcode&#39;:&#39;445300&#39;,&#39;name&#39;:&#39;云浮&#39;}]},{&#39;provice&#39;:&#39;广西&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;450100&#39;,&#39;name&#39;:&#39;南宁&#39;},{&#39;adcode&#39;:&#39;450200&#39;,&#39;name&#39;:&#39;柳州&#39;},{&#39;adcode&#39;:&#39;450300&#39;,&#39;name&#39;:&#39;桂林&#39;},{&#39;adcode&#39;:&#39;450400&#39;,&#39;name&#39;:&#39;梧州&#39;},{&#39;adcode&#39;:&#39;450500&#39;,&#39;name&#39;:&#39;北海&#39;},{&#39;adcode&#39;:&#39;450600&#39;,&#39;name&#39;:&#39;防城港&#39;},{&#39;adcode&#39;:&#39;450700&#39;,&#39;name&#39;:&#39;钦州&#39;},{&#39;adcode&#39;:&#39;450800&#39;,&#39;name&#39;:&#39;贵港&#39;},{&#39;adcode&#39;:&#39;450900&#39;,&#39;name&#39;:&#39;玉林&#39;},{&#39;adcode&#39;:&#39;451000&#39;,&#39;name&#39;:&#39;百色&#39;},{&#39;adcode&#39;:&#39;451100&#39;,&#39;name&#39;:&#39;贺州&#39;},{&#39;adcode&#39;:&#39;451200&#39;,&#39;name&#39;:&#39;河池&#39;},{&#39;adcode&#39;:&#39;451300&#39;,&#39;name&#39;:&#39;来宾&#39;},{&#39;adcode&#39;:&#39;451400&#39;,&#39;name&#39;:&#39;崇左&#39;}]},{&#39;provice&#39;:&#39;贵州&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;520100&#39;,&#39;name&#39;:&#39;贵阳&#39;},{&#39;adcode&#39;:&#39;520200&#39;,&#39;name&#39;:&#39;六盘水&#39;},{&#39;adcode&#39;:&#39;520300&#39;,&#39;name&#39;:&#39;遵义&#39;},{&#39;adcode&#39;:&#39;520400&#39;,&#39;name&#39;:&#39;安顺&#39;},{&#39;adcode&#39;:&#39;520500&#39;,&#39;name&#39;:&#39;毕节&#39;},{&#39;adcode&#39;:&#39;520600&#39;,&#39;name&#39;:&#39;铜仁&#39;},{&#39;adcode&#39;:&#39;522300&#39;,&#39;name&#39;:&#39;黔西南布依族苗族自治州&#39;},{&#39;adcode&#39;:&#39;522600&#39;,&#39;name&#39;:&#39;黔东南苗族侗族自治州&#39;},{&#39;adcode&#39;:&#39;522700&#39;,&#39;name&#39;:&#39;黔南布依族苗族自治州&#39;}]},{&#39;provice&#39;:&#39;甘肃&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;620100&#39;,&#39;name&#39;:&#39;兰州&#39;},{&#39;adcode&#39;:&#39;620200&#39;,&#39;name&#39;:&#39;嘉峪关&#39;},{&#39;adcode&#39;:&#39;620300&#39;,&#39;name&#39;:&#39;金昌&#39;},{&#39;adcode&#39;:&#39;620400&#39;,&#39;name&#39;:&#39;白银&#39;},{&#39;adcode&#39;:&#39;620500&#39;,&#39;name&#39;:&#39;天水&#39;},{&#39;adcode&#39;:&#39;620600&#39;,&#39;name&#39;:&#39;武威&#39;},{&#39;adcode&#39;:&#39;620700&#39;,&#39;name&#39;:&#39;张掖&#39;},{&#39;adcode&#39;:&#39;620800&#39;,&#39;name&#39;:&#39;平凉&#39;},{&#39;adcode&#39;:&#39;620900&#39;,&#39;name&#39;:&#39;酒泉&#39;},{&#39;adcode&#39;:&#39;621000&#39;,&#39;name&#39;:&#39;庆阳&#39;},{&#39;adcode&#39;:&#39;621100&#39;,&#39;name&#39;:&#39;定西&#39;},{&#39;adcode&#39;:&#39;621200&#39;,&#39;name&#39;:&#39;陇南&#39;},{&#39;adcode&#39;:&#39;622900&#39;,&#39;name&#39;:&#39;临夏回族自治州&#39;},{&#39;adcode&#39;:&#39;623000&#39;,&#39;name&#39;:&#39;甘南藏族自治州&#39;}]},{&#39;provice&#39;:&#39;河北&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;130100&#39;,&#39;name&#39;:&#39;石家庄&#39;},{&#39;adcode&#39;:&#39;130200&#39;,&#39;name&#39;:&#39;唐山&#39;},{&#39;adcode&#39;:&#39;130300&#39;,&#39;name&#39;:&#39;秦皇岛&#39;},{&#39;adcode&#39;:&#39;130400&#39;,&#39;name&#39;:&#39;邯郸&#39;},{&#39;adcode&#39;:&#39;130500&#39;,&#39;name&#39;:&#39;邢台&#39;},{&#39;adcode&#39;:&#39;130600&#39;,&#39;name&#39;:&#39;保定&#39;},{&#39;adcode&#39;:&#39;130700&#39;,&#39;name&#39;:&#39;张家口&#39;},{&#39;adcode&#39;:&#39;130800&#39;,&#39;name&#39;:&#39;承德&#39;},{&#39;adcode&#39;:&#39;130900&#39;,&#39;name&#39;:&#39;沧州&#39;},{&#39;adcode&#39;:&#39;131000&#39;,&#39;name&#39;:&#39;廊坊&#39;},{&#39;adcode&#39;:&#39;131100&#39;,&#39;name&#39;:&#39;衡水&#39;}]},{&#39;provice&#39;:&#39;黑龙江&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;230100&#39;,&#39;name&#39;:&#39;哈尔滨&#39;},{&#39;adcode&#39;:&#39;230200&#39;,&#39;name&#39;:&#39;齐齐哈尔&#39;},{&#39;adcode&#39;:&#39;230300&#39;,&#39;name&#39;:&#39;鸡西&#39;},{&#39;adcode&#39;:&#39;230400&#39;,&#39;name&#39;:&#39;鹤岗&#39;},{&#39;adcode&#39;:&#39;230500&#39;,&#39;name&#39;:&#39;双鸭山&#39;},{&#39;adcode&#39;:&#39;230600&#39;,&#39;name&#39;:&#39;大庆&#39;},{&#39;adcode&#39;:&#39;230700&#39;,&#39;name&#39;:&#39;伊春&#39;},{&#39;adcode&#39;:&#39;230800&#39;,&#39;name&#39;:&#39;佳木斯&#39;},{&#39;adcode&#39;:&#39;230900&#39;,&#39;name&#39;:&#39;七台河&#39;},{&#39;adcode&#39;:&#39;231000&#39;,&#39;name&#39;:&#39;牡丹江&#39;},{&#39;adcode&#39;:&#39;231100&#39;,&#39;name&#39;:&#39;黑河&#39;},{&#39;adcode&#39;:&#39;231200&#39;,&#39;name&#39;:&#39;绥化&#39;},{&#39;adcode&#39;:&#39;232700&#39;,&#39;name&#39;:&#39;大兴安岭&#39;}]},{&#39;provice&#39;:&#39;河南&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;410100&#39;,&#39;name&#39;:&#39;郑州&#39;},{&#39;adcode&#39;:&#39;410200&#39;,&#39;name&#39;:&#39;开封&#39;},{&#39;adcode&#39;:&#39;410300&#39;,&#39;name&#39;:&#39;洛阳&#39;},{&#39;adcode&#39;:&#39;410400&#39;,&#39;name&#39;:&#39;平顶山&#39;},{&#39;adcode&#39;:&#39;410500&#39;,&#39;name&#39;:&#39;安阳&#39;},{&#39;adcode&#39;:&#39;410600&#39;,&#39;name&#39;:&#39;鹤壁&#39;},{&#39;adcode&#39;:&#39;410700&#39;,&#39;name&#39;:&#39;新乡&#39;},{&#39;adcode&#39;:&#39;410800&#39;,&#39;name&#39;:&#39;焦作&#39;},{&#39;adcode&#39;:&#39;410900&#39;,&#39;name&#39;:&#39;濮阳&#39;},{&#39;adcode&#39;:&#39;411000&#39;,&#39;name&#39;:&#39;许昌&#39;},{&#39;adcode&#39;:&#39;411100&#39;,&#39;name&#39;:&#39;漯河&#39;},{&#39;adcode&#39;:&#39;411200&#39;,&#39;name&#39;:&#39;三门峡&#39;},{&#39;adcode&#39;:&#39;411300&#39;,&#39;name&#39;:&#39;南阳&#39;},{&#39;adcode&#39;:&#39;411400&#39;,&#39;name&#39;:&#39;商丘&#39;},{&#39;adcode&#39;:&#39;411500&#39;,&#39;name&#39;:&#39;信阳&#39;},{&#39;adcode&#39;:&#39;411600&#39;,&#39;name&#39;:&#39;周口&#39;},{&#39;adcode&#39;:&#39;411700&#39;,&#39;name&#39;:&#39;驻马店&#39;},{&#39;adcode&#39;:&#39;419001&#39;,&#39;name&#39;:&#39;济源&#39;}]},{&#39;provice&#39;:&#39;湖北&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;420100&#39;,&#39;name&#39;:&#39;武汉&#39;},{&#39;adcode&#39;:&#39;420200&#39;,&#39;name&#39;:&#39;黄石&#39;},{&#39;adcode&#39;:&#39;420300&#39;,&#39;name&#39;:&#39;十堰&#39;},{&#39;adcode&#39;:&#39;420500&#39;,&#39;name&#39;:&#39;宜昌&#39;},{&#39;adcode&#39;:&#39;420600&#39;,&#39;name&#39;:&#39;襄阳&#39;},{&#39;adcode&#39;:&#39;420700&#39;,&#39;name&#39;:&#39;鄂州&#39;},{&#39;adcode&#39;:&#39;420800&#39;,&#39;name&#39;:&#39;荆门&#39;},{&#39;adcode&#39;:&#39;420900&#39;,&#39;name&#39;:&#39;孝感&#39;},{&#39;adcode&#39;:&#39;421000&#39;,&#39;name&#39;:&#39;荆州&#39;},{&#39;adcode&#39;:&#39;421100&#39;,&#39;name&#39;:&#39;黄冈&#39;},{&#39;adcode&#39;:&#39;421200&#39;,&#39;name&#39;:&#39;咸宁&#39;},{&#39;adcode&#39;:&#39;421300&#39;,&#39;name&#39;:&#39;随州&#39;},{&#39;adcode&#39;:&#39;422800&#39;,&#39;name&#39;:&#39;恩施土家族苗族自治州&#39;},{&#39;adcode&#39;:&#39;429004&#39;,&#39;name&#39;:&#39;仙桃&#39;},{&#39;adcode&#39;:&#39;429005&#39;,&#39;name&#39;:&#39;潜江&#39;},{&#39;adcode&#39;:&#39;429006&#39;,&#39;name&#39;:&#39;天门&#39;},{&#39;adcode&#39;:&#39;429021&#39;,&#39;name&#39;:&#39;神农架林区&#39;}]},{&#39;provice&#39;:&#39;湖南&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;430100&#39;,&#39;name&#39;:&#39;长沙&#39;},{&#39;adcode&#39;:&#39;430200&#39;,&#39;name&#39;:&#39;株洲&#39;},{&#39;adcode&#39;:&#39;430300&#39;,&#39;name&#39;:&#39;湘潭&#39;},{&#39;adcode&#39;:&#39;430400&#39;,&#39;name&#39;:&#39;衡阳&#39;},{&#39;adcode&#39;:&#39;430500&#39;,&#39;name&#39;:&#39;邵阳&#39;},{&#39;adcode&#39;:&#39;430600&#39;,&#39;name&#39;:&#39;岳阳&#39;},{&#39;adcode&#39;:&#39;430700&#39;,&#39;name&#39;:&#39;常德&#39;},{&#39;adcode&#39;:&#39;430800&#39;,&#39;name&#39;:&#39;张家界&#39;},{&#39;adcode&#39;:&#39;430900&#39;,&#39;name&#39;:&#39;益阳&#39;},{&#39;adcode&#39;:&#39;431000&#39;,&#39;name&#39;:&#39;郴州&#39;},{&#39;adcode&#39;:&#39;431100&#39;,&#39;name&#39;:&#39;永州&#39;},{&#39;adcode&#39;:&#39;431200&#39;,&#39;name&#39;:&#39;怀化&#39;},{&#39;adcode&#39;:&#39;431300&#39;,&#39;name&#39;:&#39;娄底&#39;},{&#39;adcode&#39;:&#39;433100&#39;,&#39;name&#39;:&#39;湘西土家族苗族自治州&#39;}]},{&#39;provice&#39;:&#39;海南&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;460100&#39;,&#39;name&#39;:&#39;海口&#39;},{&#39;adcode&#39;:&#39;460200&#39;,&#39;name&#39;:&#39;三亚&#39;},{&#39;adcode&#39;:&#39;460300&#39;,&#39;name&#39;:&#39;三沙&#39;},{&#39;adcode&#39;:&#39;460400&#39;,&#39;name&#39;:&#39;儋州&#39;}]},{&#39;provice&#39;:&#39;吉林&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;220100&#39;,&#39;name&#39;:&#39;长春&#39;},{&#39;adcode&#39;:&#39;220200&#39;,&#39;name&#39;:&#39;吉林&#39;},{&#39;adcode&#39;:&#39;220300&#39;,&#39;name&#39;:&#39;四平&#39;},{&#39;adcode&#39;:&#39;220400&#39;,&#39;name&#39;:&#39;辽源&#39;},{&#39;adcode&#39;:&#39;220500&#39;,&#39;name&#39;:&#39;通化&#39;},{&#39;adcode&#39;:&#39;220600&#39;,&#39;name&#39;:&#39;白山&#39;},{&#39;adcode&#39;:&#39;220700&#39;,&#39;name&#39;:&#39;松原&#39;},{&#39;adcode&#39;:&#39;220800&#39;,&#39;name&#39;:&#39;白城&#39;},{&#39;adcode&#39;:&#39;222400&#39;,&#39;name&#39;:&#39;延边朝鲜族自治州&#39;}]},{&#39;provice&#39;:&#39;江苏&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;320100&#39;,&#39;name&#39;:&#39;南京&#39;},{&#39;adcode&#39;:&#39;320200&#39;,&#39;name&#39;:&#39;无锡&#39;},{&#39;adcode&#39;:&#39;320300&#39;,&#39;name&#39;:&#39;徐州&#39;},{&#39;adcode&#39;:&#39;320400&#39;,&#39;name&#39;:&#39;常州&#39;},{&#39;adcode&#39;:&#39;320500&#39;,&#39;name&#39;:&#39;苏州&#39;},{&#39;adcode&#39;:&#39;320600&#39;,&#39;name&#39;:&#39;南通&#39;},{&#39;adcode&#39;:&#39;320700&#39;,&#39;name&#39;:&#39;连云港&#39;},{&#39;adcode&#39;:&#39;320800&#39;,&#39;name&#39;:&#39;淮安&#39;},{&#39;adcode&#39;:&#39;320900&#39;,&#39;name&#39;:&#39;盐城&#39;},{&#39;adcode&#39;:&#39;321000&#39;,&#39;name&#39;:&#39;扬州&#39;},{&#39;adcode&#39;:&#39;321100&#39;,&#39;name&#39;:&#39;镇江&#39;},{&#39;adcode&#39;:&#39;321200&#39;,&#39;name&#39;:&#39;泰州&#39;},{&#39;adcode&#39;:&#39;321300&#39;,&#39;name&#39;:&#39;宿迁&#39;}]},{&#39;provice&#39;:&#39;江西&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;360100&#39;,&#39;name&#39;:&#39;南昌&#39;},{&#39;adcode&#39;:&#39;360200&#39;,&#39;name&#39;:&#39;景德镇&#39;},{&#39;adcode&#39;:&#39;360300&#39;,&#39;name&#39;:&#39;萍乡&#39;},{&#39;adcode&#39;:&#39;360400&#39;,&#39;name&#39;:&#39;九江&#39;},{&#39;adcode&#39;:&#39;360500&#39;,&#39;name&#39;:&#39;新余&#39;},{&#39;adcode&#39;:&#39;360600&#39;,&#39;name&#39;:&#39;鹰潭&#39;},{&#39;adcode&#39;:&#39;360700&#39;,&#39;name&#39;:&#39;赣州&#39;},{&#39;adcode&#39;:&#39;360800&#39;,&#39;name&#39;:&#39;吉安&#39;},{&#39;adcode&#39;:&#39;360900&#39;,&#39;name&#39;:&#39;宜春&#39;},{&#39;adcode&#39;:&#39;361000&#39;,&#39;name&#39;:&#39;抚州&#39;},{&#39;adcode&#39;:&#39;361100&#39;,&#39;name&#39;:&#39;上饶&#39;}]},{&#39;provice&#39;:&#39;辽宁&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;210100&#39;,&#39;name&#39;:&#39;沈阳&#39;},{&#39;adcode&#39;:&#39;210200&#39;,&#39;name&#39;:&#39;大连&#39;},{&#39;adcode&#39;:&#39;210300&#39;,&#39;name&#39;:&#39;鞍山&#39;},{&#39;adcode&#39;:&#39;210400&#39;,&#39;name&#39;:&#39;抚顺&#39;},{&#39;adcode&#39;:&#39;210500&#39;,&#39;name&#39;:&#39;本溪&#39;},{&#39;adcode&#39;:&#39;210600&#39;,&#39;name&#39;:&#39;丹东&#39;},{&#39;adcode&#39;:&#39;210700&#39;,&#39;name&#39;:&#39;锦州&#39;},{&#39;adcode&#39;:&#39;210800&#39;,&#39;name&#39;:&#39;营口&#39;},{&#39;adcode&#39;:&#39;210900&#39;,&#39;name&#39;:&#39;阜新&#39;},{&#39;adcode&#39;:&#39;211000&#39;,&#39;name&#39;:&#39;辽阳&#39;},{&#39;adcode&#39;:&#39;211100&#39;,&#39;name&#39;:&#39;盘锦&#39;},{&#39;adcode&#39;:&#39;211200&#39;,&#39;name&#39;:&#39;铁岭&#39;},{&#39;adcode&#39;:&#39;211300&#39;,&#39;name&#39;:&#39;朝阳&#39;},{&#39;adcode&#39;:&#39;211400&#39;,&#39;name&#39;:&#39;葫芦岛&#39;}]},{&#39;provice&#39;:&#39;内蒙古&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;150100&#39;,&#39;name&#39;:&#39;呼和浩特&#39;},{&#39;adcode&#39;:&#39;150200&#39;,&#39;name&#39;:&#39;包头&#39;},{&#39;adcode&#39;:&#39;150300&#39;,&#39;name&#39;:&#39;乌海&#39;},{&#39;adcode&#39;:&#39;150400&#39;,&#39;name&#39;:&#39;赤峰&#39;},{&#39;adcode&#39;:&#39;150500&#39;,&#39;name&#39;:&#39;通辽&#39;},{&#39;adcode&#39;:&#39;150600&#39;,&#39;name&#39;:&#39;鄂尔多斯&#39;},{&#39;adcode&#39;:&#39;150700&#39;,&#39;name&#39;:&#39;呼伦贝尔&#39;},{&#39;adcode&#39;:&#39;150800&#39;,&#39;name&#39;:&#39;巴彦淖尔&#39;},{&#39;adcode&#39;:&#39;150900&#39;,&#39;name&#39;:&#39;乌兰察布&#39;},{&#39;adcode&#39;:&#39;152200&#39;,&#39;name&#39;:&#39;兴安盟&#39;},{&#39;adcode&#39;:&#39;152500&#39;,&#39;name&#39;:&#39;锡林郭勒盟&#39;},{&#39;adcode&#39;:&#39;152900&#39;,&#39;name&#39;:&#39;阿拉善盟&#39;}]},{&#39;provice&#39;:&#39;宁夏&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;640100&#39;,&#39;name&#39;:&#39;银川&#39;},{&#39;adcode&#39;:&#39;640200&#39;,&#39;name&#39;:&#39;石嘴山&#39;},{&#39;adcode&#39;:&#39;640300&#39;,&#39;name&#39;:&#39;吴忠&#39;},{&#39;adcode&#39;:&#39;640400&#39;,&#39;name&#39;:&#39;固原&#39;},{&#39;adcode&#39;:&#39;640500&#39;,&#39;name&#39;:&#39;中卫&#39;}]},{&#39;provice&#39;:&#39;青海&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;630100&#39;,&#39;name&#39;:&#39;西宁&#39;},{&#39;adcode&#39;:&#39;630200&#39;,&#39;name&#39;:&#39;海东&#39;},{&#39;adcode&#39;:&#39;632200&#39;,&#39;name&#39;:&#39;海北藏族自治州&#39;},{&#39;adcode&#39;:&#39;632300&#39;,&#39;name&#39;:&#39;黄南藏族自治州&#39;},{&#39;adcode&#39;:&#39;632500&#39;,&#39;name&#39;:&#39;海南藏族自治州&#39;},{&#39;adcode&#39;:&#39;632600&#39;,&#39;name&#39;:&#39;果洛藏族自治州&#39;},{&#39;adcode&#39;:&#39;632700&#39;,&#39;name&#39;:&#39;玉树藏族自治州&#39;},{&#39;adcode&#39;:&#39;632800&#39;,&#39;name&#39;:&#39;海西蒙古族藏族自治州&#39;}]},{&#39;provice&#39;:&#39;山西&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;140100&#39;,&#39;name&#39;:&#39;太原&#39;},{&#39;adcode&#39;:&#39;140200&#39;,&#39;name&#39;:&#39;大同&#39;},{&#39;adcode&#39;:&#39;140300&#39;,&#39;name&#39;:&#39;阳泉&#39;},{&#39;adcode&#39;:&#39;140400&#39;,&#39;name&#39;:&#39;长治&#39;},{&#39;adcode&#39;:&#39;140500&#39;,&#39;name&#39;:&#39;晋城&#39;},{&#39;adcode&#39;:&#39;140600&#39;,&#39;name&#39;:&#39;朔州&#39;},{&#39;adcode&#39;:&#39;140700&#39;,&#39;name&#39;:&#39;晋中&#39;},{&#39;adcode&#39;:&#39;140800&#39;,&#39;name&#39;:&#39;运城&#39;},{&#39;adcode&#39;:&#39;140900&#39;,&#39;name&#39;:&#39;忻州&#39;},{&#39;adcode&#39;:&#39;141000&#39;,&#39;name&#39;:&#39;临汾&#39;},{&#39;adcode&#39;:&#39;141100&#39;,&#39;name&#39;:&#39;吕梁&#39;}]},{&#39;provice&#39;:&#39;山东&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;370100&#39;,&#39;name&#39;:&#39;济南&#39;},{&#39;adcode&#39;:&#39;370200&#39;,&#39;name&#39;:&#39;青岛&#39;},{&#39;adcode&#39;:&#39;370300&#39;,&#39;name&#39;:&#39;淄博&#39;},{&#39;adcode&#39;:&#39;370400&#39;,&#39;name&#39;:&#39;枣庄&#39;},{&#39;adcode&#39;:&#39;370500&#39;,&#39;name&#39;:&#39;东营&#39;},{&#39;adcode&#39;:&#39;370600&#39;,&#39;name&#39;:&#39;烟台&#39;},{&#39;adcode&#39;:&#39;370700&#39;,&#39;name&#39;:&#39;潍坊&#39;},{&#39;adcode&#39;:&#39;370800&#39;,&#39;name&#39;:&#39;济宁&#39;},{&#39;adcode&#39;:&#39;370900&#39;,&#39;name&#39;:&#39;泰安&#39;},{&#39;adcode&#39;:&#39;371000&#39;,&#39;name&#39;:&#39;威海&#39;},{&#39;adcode&#39;:&#39;371100&#39;,&#39;name&#39;:&#39;日照&#39;},{&#39;adcode&#39;:&#39;371200&#39;,&#39;name&#39;:&#39;莱芜&#39;},{&#39;adcode&#39;:&#39;371300&#39;,&#39;name&#39;:&#39;临沂&#39;},{&#39;adcode&#39;:&#39;371400&#39;,&#39;name&#39;:&#39;德州&#39;},{&#39;adcode&#39;:&#39;371500&#39;,&#39;name&#39;:&#39;聊城&#39;},{&#39;adcode&#39;:&#39;371600&#39;,&#39;name&#39;:&#39;滨州&#39;},{&#39;adcode&#39;:&#39;371700&#39;,&#39;name&#39;:&#39;菏泽&#39;}]},{&#39;provice&#39;:&#39;四川&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;510100&#39;,&#39;name&#39;:&#39;成都&#39;},{&#39;adcode&#39;:&#39;510300&#39;,&#39;name&#39;:&#39;自贡&#39;},{&#39;adcode&#39;:&#39;510400&#39;,&#39;name&#39;:&#39;攀枝花&#39;},{&#39;adcode&#39;:&#39;510500&#39;,&#39;name&#39;:&#39;泸州&#39;},{&#39;adcode&#39;:&#39;510600&#39;,&#39;name&#39;:&#39;德阳&#39;},{&#39;adcode&#39;:&#39;510700&#39;,&#39;name&#39;:&#39;绵阳&#39;},{&#39;adcode&#39;:&#39;510800&#39;,&#39;name&#39;:&#39;广元&#39;},{&#39;adcode&#39;:&#39;510900&#39;,&#39;name&#39;:&#39;遂宁&#39;},{&#39;adcode&#39;:&#39;511000&#39;,&#39;name&#39;:&#39;内江&#39;},{&#39;adcode&#39;:&#39;511100&#39;,&#39;name&#39;:&#39;乐山&#39;},{&#39;adcode&#39;:&#39;511300&#39;,&#39;name&#39;:&#39;南充&#39;},{&#39;adcode&#39;:&#39;511400&#39;,&#39;name&#39;:&#39;眉山&#39;},{&#39;adcode&#39;:&#39;511500&#39;,&#39;name&#39;:&#39;宜宾&#39;},{&#39;adcode&#39;:&#39;511600&#39;,&#39;name&#39;:&#39;广安&#39;},{&#39;adcode&#39;:&#39;511700&#39;,&#39;name&#39;:&#39;达州&#39;},{&#39;adcode&#39;:&#39;511800&#39;,&#39;name&#39;:&#39;雅安&#39;},{&#39;adcode&#39;:&#39;511900&#39;,&#39;name&#39;:&#39;巴中&#39;},{&#39;adcode&#39;:&#39;512000&#39;,&#39;name&#39;:&#39;资阳&#39;},{&#39;adcode&#39;:&#39;513200&#39;,&#39;name&#39;:&#39;阿坝藏族羌族自治州&#39;},{&#39;adcode&#39;:&#39;513300&#39;,&#39;name&#39;:&#39;甘孜藏族自治州&#39;},{&#39;adcode&#39;:&#39;513400&#39;,&#39;name&#39;:&#39;凉山彝族自治州&#39;}]},{&#39;provice&#39;:&#39;陕西&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;610100&#39;,&#39;name&#39;:&#39;西安&#39;},{&#39;adcode&#39;:&#39;610200&#39;,&#39;name&#39;:&#39;铜川&#39;},{&#39;adcode&#39;:&#39;610300&#39;,&#39;name&#39;:&#39;宝鸡&#39;},{&#39;adcode&#39;:&#39;610400&#39;,&#39;name&#39;:&#39;咸阳&#39;},{&#39;adcode&#39;:&#39;610500&#39;,&#39;name&#39;:&#39;渭南&#39;},{&#39;adcode&#39;:&#39;610600&#39;,&#39;name&#39;:&#39;延安&#39;},{&#39;adcode&#39;:&#39;610700&#39;,&#39;name&#39;:&#39;汉中&#39;},{&#39;adcode&#39;:&#39;610800&#39;,&#39;name&#39;:&#39;榆林&#39;},{&#39;adcode&#39;:&#39;610900&#39;,&#39;name&#39;:&#39;安康&#39;},{&#39;adcode&#39;:&#39;611000&#39;,&#39;name&#39;:&#39;商洛&#39;}]},{&#39;provice&#39;:&#39;天津&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;120100&#39;,&#39;name&#39;:&#39;天津市市辖区&#39;}]},{&#39;provice&#39;:&#39;台湾&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;719002&#39;,&#39;name&#39;:&#39;台北&#39;},{&#39;adcode&#39;:&#39;719019&#39;,&#39;name&#39;:&#39;高雄&#39;},{&#39;adcode&#39;:&#39;719017&#39;,&#39;name&#39;:&#39;台中&#39;},{&#39;adcode&#39;:&#39;719016&#39;,&#39;name&#39;:&#39;台南&#39;},{&#39;adcode&#39;:&#39;719010&#39;,&#39;name&#39;:&#39;新北&#39;},{&#39;adcode&#39;:&#39;719011&#39;,&#39;name&#39;:&#39;基隆&#39;},{&#39;adcode&#39;:&#39;719006&#39;,&#39;name&#39;:&#39;新竹&#39;},{&#39;adcode&#39;:&#39;719004&#39;,&#39;name&#39;:&#39;嘉义&#39;}]},{&#39;provice&#39;:&#39;西藏&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;540100&#39;,&#39;name&#39;:&#39;拉萨&#39;},{&#39;adcode&#39;:&#39;540200&#39;,&#39;name&#39;:&#39;日喀则&#39;},{&#39;adcode&#39;:&#39;540300&#39;,&#39;name&#39;:&#39;昌都&#39;},{&#39;adcode&#39;:&#39;540400&#39;,&#39;name&#39;:&#39;林芝&#39;},{&#39;adcode&#39;:&#39;540500&#39;,&#39;name&#39;:&#39;山南&#39;},{&#39;adcode&#39;:&#39;540600&#39;,&#39;name&#39;:&#39;那曲&#39;},{&#39;adcode&#39;:&#39;542500&#39;,&#39;name&#39;:&#39;阿里&#39;}]},{&#39;provice&#39;:&#39;新疆&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;650100&#39;,&#39;name&#39;:&#39;乌鲁木齐&#39;},{&#39;adcode&#39;:&#39;650200&#39;,&#39;name&#39;:&#39;克拉玛依&#39;},{&#39;adcode&#39;:&#39;650400&#39;,&#39;name&#39;:&#39;吐鲁番&#39;},{&#39;adcode&#39;:&#39;650500&#39;,&#39;name&#39;:&#39;哈密&#39;},{&#39;adcode&#39;:&#39;652300&#39;,&#39;name&#39;:&#39;昌吉回族自治州&#39;},{&#39;adcode&#39;:&#39;652700&#39;,&#39;name&#39;:&#39;博尔塔拉蒙古自治州&#39;},{&#39;adcode&#39;:&#39;652800&#39;,&#39;name&#39;:&#39;巴音郭楞蒙古自治州&#39;},{&#39;adcode&#39;:&#39;652900&#39;,&#39;name&#39;:&#39;阿克苏&#39;},{&#39;adcode&#39;:&#39;653000&#39;,&#39;name&#39;:&#39;克孜勒苏柯尔克孜自治州&#39;},{&#39;adcode&#39;:&#39;653100&#39;,&#39;name&#39;:&#39;喀什&#39;},{&#39;adcode&#39;:&#39;653200&#39;,&#39;name&#39;:&#39;和田&#39;},{&#39;adcode&#39;:&#39;654000&#39;,&#39;name&#39;:&#39;伊犁哈萨克自治州&#39;},{&#39;adcode&#39;:&#39;654200&#39;,&#39;name&#39;:&#39;塔城&#39;},{&#39;adcode&#39;:&#39;654300&#39;,&#39;name&#39;:&#39;阿勒泰&#39;},{&#39;adcode&#39;:&#39;659001&#39;,&#39;name&#39;:&#39;石河子&#39;},{&#39;adcode&#39;:&#39;659002&#39;,&#39;name&#39;:&#39;阿拉尔&#39;},{&#39;adcode&#39;:&#39;659003&#39;,&#39;name&#39;:&#39;图木舒克&#39;},{&#39;adcode&#39;:&#39;659004&#39;,&#39;name&#39;:&#39;五家渠&#39;}]},{&#39;provice&#39;:&#39;云南&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;530100&#39;,&#39;name&#39;:&#39;昆明&#39;},{&#39;adcode&#39;:&#39;530300&#39;,&#39;name&#39;:&#39;曲靖&#39;},{&#39;adcode&#39;:&#39;530400&#39;,&#39;name&#39;:&#39;玉溪&#39;},{&#39;adcode&#39;:&#39;530500&#39;,&#39;name&#39;:&#39;保山&#39;},{&#39;adcode&#39;:&#39;530600&#39;,&#39;name&#39;:&#39;昭通&#39;},{&#39;adcode&#39;:&#39;530700&#39;,&#39;name&#39;:&#39;丽江&#39;},{&#39;adcode&#39;:&#39;530800&#39;,&#39;name&#39;:&#39;普洱&#39;},{&#39;adcode&#39;:&#39;530900&#39;,&#39;name&#39;:&#39;临沧&#39;},{&#39;adcode&#39;:&#39;532300&#39;,&#39;name&#39;:&#39;楚雄彝族自治州&#39;},{&#39;adcode&#39;:&#39;532500&#39;,&#39;name&#39;:&#39;红河哈尼族彝族自治州&#39;},{&#39;adcode&#39;:&#39;532600&#39;,&#39;name&#39;:&#39;文山壮族苗族自治州&#39;},{&#39;adcode&#39;:&#39;532800&#39;,&#39;name&#39;:&#39;西双版纳傣族自治州&#39;},{&#39;adcode&#39;:&#39;532900&#39;,&#39;name&#39;:&#39;大理白族自治州&#39;},{&#39;adcode&#39;:&#39;533100&#39;,&#39;name&#39;:&#39;德宏傣族景颇族自治州&#39;},{&#39;adcode&#39;:&#39;533300&#39;,&#39;name&#39;:&#39;怒江傈僳族自治州&#39;},{&#39;adcode&#39;:&#39;533400&#39;,&#39;name&#39;:&#39;迪庆藏族自治州&#39;}]},{&#39;provice&#39;:&#39;浙江&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;330100&#39;,&#39;name&#39;:&#39;杭州&#39;},{&#39;adcode&#39;:&#39;330200&#39;,&#39;name&#39;:&#39;宁波&#39;},{&#39;adcode&#39;:&#39;330300&#39;,&#39;name&#39;:&#39;温州&#39;},{&#39;adcode&#39;:&#39;330400&#39;,&#39;name&#39;:&#39;嘉兴&#39;},{&#39;adcode&#39;:&#39;330500&#39;,&#39;name&#39;:&#39;湖州&#39;},{&#39;adcode&#39;:&#39;330600&#39;,&#39;name&#39;:&#39;绍兴&#39;},{&#39;adcode&#39;:&#39;330700&#39;,&#39;name&#39;:&#39;金华&#39;},{&#39;adcode&#39;:&#39;330800&#39;,&#39;name&#39;:&#39;衢州&#39;},{&#39;adcode&#39;:&#39;330900&#39;,&#39;name&#39;:&#39;舟山&#39;},{&#39;adcode&#39;:&#39;331000&#39;,&#39;name&#39;:&#39;台州&#39;},{&#39;adcode&#39;:&#39;331100&#39;,&#39;name&#39;:&#39;丽水&#39;}]},{&#39;provice&#39;:&#39;上海&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;310000&#39;,&#39;name&#39;:&#39;上海市区&#39;}]},{&#39;provice&#39;:&#39;重庆&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;500000&#39;,&#39;name&#39;:&#39;重庆市区&#39;}]},{&#39;provice&#39;:&#39;北京&#39;,&#39;city&#39;:[{&#39;adcode&#39;:&#39;110000&#39;,&#39;name&#39;:&#39;北京市区&#39;}]}] class GaodeDataExport(object): def __init__(self, ids, keword, page, cookies): self.page = page self.keword = keword self.ids = ids self.url = &#34;https://www.amap.com/service/poiInfo?query_type=TQUERY&amp;pagesize=30&amp;pagenum=1&amp;qii=true&amp;cluster_state=5&amp;need_utd=true&amp;utd_sceneid=1000&amp;div=PC1000&amp;addr_poi_merge=true&amp;is_classify=true&amp;zoom=12&amp;city=&#34; &#43; \ ids&#43;&#34;&amp;geoobj=121.445178%7C31.151969%7C121.609973%7C31.317242&amp;keywords=&#34;&#43;keword self.headers = { &#39;Cookie&#39;: cookies, &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4ed03f01a012a496bc06b8a065f4f5c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-31T17:40:00+08:00" />
<meta property="article:modified_time" content="2018-10-31T17:40:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">爬去高德地图的公司信息</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="content" id="articleContent"> 
 <pre><code># _*_ coding:utf-8 _*_

from __future__ import division
import requests
import sys
import json
import tkinter as tk
from tkinter import *
from tkinter import ttk
import xlwt
import math
import time
import datetime



cityJsonStr = [{'provice':'安徽','city':[{'adcode':'340100','name':'合肥'},{'adcode':'340200','name':'芜湖'},{'adcode':'340300','name':'蚌埠'},{'adcode':'340400','name':'淮南'},{'adcode':'340500','name':'马鞍山'},{'adcode':'340600','name':'淮北'},{'adcode':'340700','name':'铜陵'},{'adcode':'340800','name':'安庆'},{'adcode':'341000','name':'黄山'},{'adcode':'341100','name':'滁州'},{'adcode':'341200','name':'阜阳'},{'adcode':'341300','name':'宿州'},{'adcode':'341500','name':'六安'},{'adcode':'341600','name':'亳州'},{'adcode':'341700','name':'池州'},{'adcode':'341800','name':'宣城'}]},{'provice':'福建','city':[{'adcode':'350100','name':'福州'},{'adcode':'350200','name':'厦门'},{'adcode':'350300','name':'莆田'},{'adcode':'350400','name':'三明'},{'adcode':'350500','name':'泉州'},{'adcode':'350600','name':'漳州'},{'adcode':'350700','name':'南平'},{'adcode':'350800','name':'龙岩'},{'adcode':'350900','name':'宁德'}]},{'provice':'广东','city':[{'adcode':'440100','name':'广州'},{'adcode':'440200','name':'韶关'},{'adcode':'440300','name':'深圳'},{'adcode':'440400','name':'珠海'},{'adcode':'440500','name':'汕头'},{'adcode':'440600','name':'佛山'},{'adcode':'440700','name':'江门'},{'adcode':'440800','name':'湛江'},{'adcode':'440900','name':'茂名'},{'adcode':'441200','name':'肇庆'},{'adcode':'441300','name':'惠州'},{'adcode':'441400','name':'梅州'},{'adcode':'441500','name':'汕尾'},{'adcode':'441600','name':'河源'},{'adcode':'441700','name':'阳江'},{'adcode':'441800','name':'清远'},{'adcode':'441900','name':'东莞'},{'adcode':'442000','name':'中山'},{'adcode':'445100','name':'潮州'},{'adcode':'445200','name':'揭阳'},{'adcode':'445300','name':'云浮'}]},{'provice':'广西','city':[{'adcode':'450100','name':'南宁'},{'adcode':'450200','name':'柳州'},{'adcode':'450300','name':'桂林'},{'adcode':'450400','name':'梧州'},{'adcode':'450500','name':'北海'},{'adcode':'450600','name':'防城港'},{'adcode':'450700','name':'钦州'},{'adcode':'450800','name':'贵港'},{'adcode':'450900','name':'玉林'},{'adcode':'451000','name':'百色'},{'adcode':'451100','name':'贺州'},{'adcode':'451200','name':'河池'},{'adcode':'451300','name':'来宾'},{'adcode':'451400','name':'崇左'}]},{'provice':'贵州','city':[{'adcode':'520100','name':'贵阳'},{'adcode':'520200','name':'六盘水'},{'adcode':'520300','name':'遵义'},{'adcode':'520400','name':'安顺'},{'adcode':'520500','name':'毕节'},{'adcode':'520600','name':'铜仁'},{'adcode':'522300','name':'黔西南布依族苗族自治州'},{'adcode':'522600','name':'黔东南苗族侗族自治州'},{'adcode':'522700','name':'黔南布依族苗族自治州'}]},{'provice':'甘肃','city':[{'adcode':'620100','name':'兰州'},{'adcode':'620200','name':'嘉峪关'},{'adcode':'620300','name':'金昌'},{'adcode':'620400','name':'白银'},{'adcode':'620500','name':'天水'},{'adcode':'620600','name':'武威'},{'adcode':'620700','name':'张掖'},{'adcode':'620800','name':'平凉'},{'adcode':'620900','name':'酒泉'},{'adcode':'621000','name':'庆阳'},{'adcode':'621100','name':'定西'},{'adcode':'621200','name':'陇南'},{'adcode':'622900','name':'临夏回族自治州'},{'adcode':'623000','name':'甘南藏族自治州'}]},{'provice':'河北','city':[{'adcode':'130100','name':'石家庄'},{'adcode':'130200','name':'唐山'},{'adcode':'130300','name':'秦皇岛'},{'adcode':'130400','name':'邯郸'},{'adcode':'130500','name':'邢台'},{'adcode':'130600','name':'保定'},{'adcode':'130700','name':'张家口'},{'adcode':'130800','name':'承德'},{'adcode':'130900','name':'沧州'},{'adcode':'131000','name':'廊坊'},{'adcode':'131100','name':'衡水'}]},{'provice':'黑龙江','city':[{'adcode':'230100','name':'哈尔滨'},{'adcode':'230200','name':'齐齐哈尔'},{'adcode':'230300','name':'鸡西'},{'adcode':'230400','name':'鹤岗'},{'adcode':'230500','name':'双鸭山'},{'adcode':'230600','name':'大庆'},{'adcode':'230700','name':'伊春'},{'adcode':'230800','name':'佳木斯'},{'adcode':'230900','name':'七台河'},{'adcode':'231000','name':'牡丹江'},{'adcode':'231100','name':'黑河'},{'adcode':'231200','name':'绥化'},{'adcode':'232700','name':'大兴安岭'}]},{'provice':'河南','city':[{'adcode':'410100','name':'郑州'},{'adcode':'410200','name':'开封'},{'adcode':'410300','name':'洛阳'},{'adcode':'410400','name':'平顶山'},{'adcode':'410500','name':'安阳'},{'adcode':'410600','name':'鹤壁'},{'adcode':'410700','name':'新乡'},{'adcode':'410800','name':'焦作'},{'adcode':'410900','name':'濮阳'},{'adcode':'411000','name':'许昌'},{'adcode':'411100','name':'漯河'},{'adcode':'411200','name':'三门峡'},{'adcode':'411300','name':'南阳'},{'adcode':'411400','name':'商丘'},{'adcode':'411500','name':'信阳'},{'adcode':'411600','name':'周口'},{'adcode':'411700','name':'驻马店'},{'adcode':'419001','name':'济源'}]},{'provice':'湖北','city':[{'adcode':'420100','name':'武汉'},{'adcode':'420200','name':'黄石'},{'adcode':'420300','name':'十堰'},{'adcode':'420500','name':'宜昌'},{'adcode':'420600','name':'襄阳'},{'adcode':'420700','name':'鄂州'},{'adcode':'420800','name':'荆门'},{'adcode':'420900','name':'孝感'},{'adcode':'421000','name':'荆州'},{'adcode':'421100','name':'黄冈'},{'adcode':'421200','name':'咸宁'},{'adcode':'421300','name':'随州'},{'adcode':'422800','name':'恩施土家族苗族自治州'},{'adcode':'429004','name':'仙桃'},{'adcode':'429005','name':'潜江'},{'adcode':'429006','name':'天门'},{'adcode':'429021','name':'神农架林区'}]},{'provice':'湖南','city':[{'adcode':'430100','name':'长沙'},{'adcode':'430200','name':'株洲'},{'adcode':'430300','name':'湘潭'},{'adcode':'430400','name':'衡阳'},{'adcode':'430500','name':'邵阳'},{'adcode':'430600','name':'岳阳'},{'adcode':'430700','name':'常德'},{'adcode':'430800','name':'张家界'},{'adcode':'430900','name':'益阳'},{'adcode':'431000','name':'郴州'},{'adcode':'431100','name':'永州'},{'adcode':'431200','name':'怀化'},{'adcode':'431300','name':'娄底'},{'adcode':'433100','name':'湘西土家族苗族自治州'}]},{'provice':'海南','city':[{'adcode':'460100','name':'海口'},{'adcode':'460200','name':'三亚'},{'adcode':'460300','name':'三沙'},{'adcode':'460400','name':'儋州'}]},{'provice':'吉林','city':[{'adcode':'220100','name':'长春'},{'adcode':'220200','name':'吉林'},{'adcode':'220300','name':'四平'},{'adcode':'220400','name':'辽源'},{'adcode':'220500','name':'通化'},{'adcode':'220600','name':'白山'},{'adcode':'220700','name':'松原'},{'adcode':'220800','name':'白城'},{'adcode':'222400','name':'延边朝鲜族自治州'}]},{'provice':'江苏','city':[{'adcode':'320100','name':'南京'},{'adcode':'320200','name':'无锡'},{'adcode':'320300','name':'徐州'},{'adcode':'320400','name':'常州'},{'adcode':'320500','name':'苏州'},{'adcode':'320600','name':'南通'},{'adcode':'320700','name':'连云港'},{'adcode':'320800','name':'淮安'},{'adcode':'320900','name':'盐城'},{'adcode':'321000','name':'扬州'},{'adcode':'321100','name':'镇江'},{'adcode':'321200','name':'泰州'},{'adcode':'321300','name':'宿迁'}]},{'provice':'江西','city':[{'adcode':'360100','name':'南昌'},{'adcode':'360200','name':'景德镇'},{'adcode':'360300','name':'萍乡'},{'adcode':'360400','name':'九江'},{'adcode':'360500','name':'新余'},{'adcode':'360600','name':'鹰潭'},{'adcode':'360700','name':'赣州'},{'adcode':'360800','name':'吉安'},{'adcode':'360900','name':'宜春'},{'adcode':'361000','name':'抚州'},{'adcode':'361100','name':'上饶'}]},{'provice':'辽宁','city':[{'adcode':'210100','name':'沈阳'},{'adcode':'210200','name':'大连'},{'adcode':'210300','name':'鞍山'},{'adcode':'210400','name':'抚顺'},{'adcode':'210500','name':'本溪'},{'adcode':'210600','name':'丹东'},{'adcode':'210700','name':'锦州'},{'adcode':'210800','name':'营口'},{'adcode':'210900','name':'阜新'},{'adcode':'211000','name':'辽阳'},{'adcode':'211100','name':'盘锦'},{'adcode':'211200','name':'铁岭'},{'adcode':'211300','name':'朝阳'},{'adcode':'211400','name':'葫芦岛'}]},{'provice':'内蒙古','city':[{'adcode':'150100','name':'呼和浩特'},{'adcode':'150200','name':'包头'},{'adcode':'150300','name':'乌海'},{'adcode':'150400','name':'赤峰'},{'adcode':'150500','name':'通辽'},{'adcode':'150600','name':'鄂尔多斯'},{'adcode':'150700','name':'呼伦贝尔'},{'adcode':'150800','name':'巴彦淖尔'},{'adcode':'150900','name':'乌兰察布'},{'adcode':'152200','name':'兴安盟'},{'adcode':'152500','name':'锡林郭勒盟'},{'adcode':'152900','name':'阿拉善盟'}]},{'provice':'宁夏','city':[{'adcode':'640100','name':'银川'},{'adcode':'640200','name':'石嘴山'},{'adcode':'640300','name':'吴忠'},{'adcode':'640400','name':'固原'},{'adcode':'640500','name':'中卫'}]},{'provice':'青海','city':[{'adcode':'630100','name':'西宁'},{'adcode':'630200','name':'海东'},{'adcode':'632200','name':'海北藏族自治州'},{'adcode':'632300','name':'黄南藏族自治州'},{'adcode':'632500','name':'海南藏族自治州'},{'adcode':'632600','name':'果洛藏族自治州'},{'adcode':'632700','name':'玉树藏族自治州'},{'adcode':'632800','name':'海西蒙古族藏族自治州'}]},{'provice':'山西','city':[{'adcode':'140100','name':'太原'},{'adcode':'140200','name':'大同'},{'adcode':'140300','name':'阳泉'},{'adcode':'140400','name':'长治'},{'adcode':'140500','name':'晋城'},{'adcode':'140600','name':'朔州'},{'adcode':'140700','name':'晋中'},{'adcode':'140800','name':'运城'},{'adcode':'140900','name':'忻州'},{'adcode':'141000','name':'临汾'},{'adcode':'141100','name':'吕梁'}]},{'provice':'山东','city':[{'adcode':'370100','name':'济南'},{'adcode':'370200','name':'青岛'},{'adcode':'370300','name':'淄博'},{'adcode':'370400','name':'枣庄'},{'adcode':'370500','name':'东营'},{'adcode':'370600','name':'烟台'},{'adcode':'370700','name':'潍坊'},{'adcode':'370800','name':'济宁'},{'adcode':'370900','name':'泰安'},{'adcode':'371000','name':'威海'},{'adcode':'371100','name':'日照'},{'adcode':'371200','name':'莱芜'},{'adcode':'371300','name':'临沂'},{'adcode':'371400','name':'德州'},{'adcode':'371500','name':'聊城'},{'adcode':'371600','name':'滨州'},{'adcode':'371700','name':'菏泽'}]},{'provice':'四川','city':[{'adcode':'510100','name':'成都'},{'adcode':'510300','name':'自贡'},{'adcode':'510400','name':'攀枝花'},{'adcode':'510500','name':'泸州'},{'adcode':'510600','name':'德阳'},{'adcode':'510700','name':'绵阳'},{'adcode':'510800','name':'广元'},{'adcode':'510900','name':'遂宁'},{'adcode':'511000','name':'内江'},{'adcode':'511100','name':'乐山'},{'adcode':'511300','name':'南充'},{'adcode':'511400','name':'眉山'},{'adcode':'511500','name':'宜宾'},{'adcode':'511600','name':'广安'},{'adcode':'511700','name':'达州'},{'adcode':'511800','name':'雅安'},{'adcode':'511900','name':'巴中'},{'adcode':'512000','name':'资阳'},{'adcode':'513200','name':'阿坝藏族羌族自治州'},{'adcode':'513300','name':'甘孜藏族自治州'},{'adcode':'513400','name':'凉山彝族自治州'}]},{'provice':'陕西','city':[{'adcode':'610100','name':'西安'},{'adcode':'610200','name':'铜川'},{'adcode':'610300','name':'宝鸡'},{'adcode':'610400','name':'咸阳'},{'adcode':'610500','name':'渭南'},{'adcode':'610600','name':'延安'},{'adcode':'610700','name':'汉中'},{'adcode':'610800','name':'榆林'},{'adcode':'610900','name':'安康'},{'adcode':'611000','name':'商洛'}]},{'provice':'天津','city':[{'adcode':'120100','name':'天津市市辖区'}]},{'provice':'台湾','city':[{'adcode':'719002','name':'台北'},{'adcode':'719019','name':'高雄'},{'adcode':'719017','name':'台中'},{'adcode':'719016','name':'台南'},{'adcode':'719010','name':'新北'},{'adcode':'719011','name':'基隆'},{'adcode':'719006','name':'新竹'},{'adcode':'719004','name':'嘉义'}]},{'provice':'西藏','city':[{'adcode':'540100','name':'拉萨'},{'adcode':'540200','name':'日喀则'},{'adcode':'540300','name':'昌都'},{'adcode':'540400','name':'林芝'},{'adcode':'540500','name':'山南'},{'adcode':'540600','name':'那曲'},{'adcode':'542500','name':'阿里'}]},{'provice':'新疆','city':[{'adcode':'650100','name':'乌鲁木齐'},{'adcode':'650200','name':'克拉玛依'},{'adcode':'650400','name':'吐鲁番'},{'adcode':'650500','name':'哈密'},{'adcode':'652300','name':'昌吉回族自治州'},{'adcode':'652700','name':'博尔塔拉蒙古自治州'},{'adcode':'652800','name':'巴音郭楞蒙古自治州'},{'adcode':'652900','name':'阿克苏'},{'adcode':'653000','name':'克孜勒苏柯尔克孜自治州'},{'adcode':'653100','name':'喀什'},{'adcode':'653200','name':'和田'},{'adcode':'654000','name':'伊犁哈萨克自治州'},{'adcode':'654200','name':'塔城'},{'adcode':'654300','name':'阿勒泰'},{'adcode':'659001','name':'石河子'},{'adcode':'659002','name':'阿拉尔'},{'adcode':'659003','name':'图木舒克'},{'adcode':'659004','name':'五家渠'}]},{'provice':'云南','city':[{'adcode':'530100','name':'昆明'},{'adcode':'530300','name':'曲靖'},{'adcode':'530400','name':'玉溪'},{'adcode':'530500','name':'保山'},{'adcode':'530600','name':'昭通'},{'adcode':'530700','name':'丽江'},{'adcode':'530800','name':'普洱'},{'adcode':'530900','name':'临沧'},{'adcode':'532300','name':'楚雄彝族自治州'},{'adcode':'532500','name':'红河哈尼族彝族自治州'},{'adcode':'532600','name':'文山壮族苗族自治州'},{'adcode':'532800','name':'西双版纳傣族自治州'},{'adcode':'532900','name':'大理白族自治州'},{'adcode':'533100','name':'德宏傣族景颇族自治州'},{'adcode':'533300','name':'怒江傈僳族自治州'},{'adcode':'533400','name':'迪庆藏族自治州'}]},{'provice':'浙江','city':[{'adcode':'330100','name':'杭州'},{'adcode':'330200','name':'宁波'},{'adcode':'330300','name':'温州'},{'adcode':'330400','name':'嘉兴'},{'adcode':'330500','name':'湖州'},{'adcode':'330600','name':'绍兴'},{'adcode':'330700','name':'金华'},{'adcode':'330800','name':'衢州'},{'adcode':'330900','name':'舟山'},{'adcode':'331000','name':'台州'},{'adcode':'331100','name':'丽水'}]},{'provice':'上海','city':[{'adcode':'310000','name':'上海市区'}]},{'provice':'重庆','city':[{'adcode':'500000','name':'重庆市区'}]},{'provice':'北京','city':[{'adcode':'110000','name':'北京市区'}]}]


class GaodeDataExport(object):

    def __init__(self, ids, keword, page, cookies):
        self.page = page
        self.keword = keword
        self.ids = ids
        self.url = "https://www.amap.com/service/poiInfo?query_type=TQUERY&amp;pagesize=30&amp;pagenum=1&amp;qii=true&amp;cluster_state=5&amp;need_utd=true&amp;utd_sceneid=1000&amp;div=PC1000&amp;addr_poi_merge=true&amp;is_classify=true&amp;zoom=12&amp;city=" + \
            ids+"&amp;geoobj=121.445178%7C31.151969%7C121.609973%7C31.317242&amp;keywords="+keword
        self.headers = {
            'Cookie': cookies,
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.146 Safari/537.36'}
        self.proxies = {
            'http': 'http://10.59.77.11:8118',
            'https': 'http://10.59.77.11:8118',
        }

    def getCompanyData(self):
        wbk = xlwt.Workbook()
        sheet = wbk.add_sheet('Sheet1', cell_overwrite_ok=True)
        today_date = datetime.datetime.now()
        today_dateStr = str(today_date.year)+"-"+str(today_date.month)+"-"+str(today_date.day)+"-"+str(today_date.hour)+"-"+str(today_date.minute)+"-"+str(today_date.second)
        if int(self.page) &gt; 30:
            pageNum = math.floor(int(self.page)/30)+1
            i = 0
            for k in range(pageNum+1):
                url = "https://www.amap.com/service/poiInfo?query_type=TQUERY&amp;pagesize=30&amp;pagenum="+str(k)+"&amp;qii=true&amp;cluster_state=5&amp;need_utd=true&amp;utd_sceneid=1000&amp;div=PC1000&amp;addr_poi_merge=true&amp;is_classify=true&amp;zoom=12&amp;city=" + \
                    self.ids+"&amp;geoobj=121.445178%7C31.151969%7C121.609973%7C31.317242&amp;keywords="+self.keword
                req = requests.get(
                    url=url, headers=self.headers, proxies=self.proxies)
                jsonData = json.loads(req.text)
                time.sleep(1)
                companyList = jsonData['data']['poi_list']
                for each in companyList:
                    tel = each['tel']
                    address = each['address']
                    name = each['name']
                    cityname = each['cityname']
                    disp_name = each['disp_name']
                    sheet.write(i, 0, cityname)
                    sheet.write(i, 1, name)
                    sheet.write(i, 2, disp_name)
                    sheet.write(i, 3, address)
                    sheet.write(i, 4, tel)
                    i = i+1
        else:
            req = requests.get(
                url=self.url, headers=self.headers, proxies=self.proxies)
            jsonData = json.loads(req.text)
            companyList = jsonData['data']['poi_list']
            i=0
            for each in companyList:
                tel = each['tel']
                address = each['address']
                name = each['name']
                cityname = each['cityname']
                disp_name = each['disp_name']
                sheet.write(i, 0, cityname)
                sheet.write(i, 1, name)
                sheet.write(i, 2, disp_name)
                sheet.write(i, 3, address)
                sheet.write(i, 4, tel)
                i = i+1

        wbk.save(today_dateStr+'.xls')


# 窗口显示
class WindowDisp(object):

    def __init__(self):

        self.provice = []
        self.city = []
        self.jsonArr = []
        self.cityId = ''

        self.root = tk.Tk()
        self.root.title("高德地图公司信息下载")
        self.root.geometry('600x600')
        self.comvalue1 = tk.StringVar()  # 窗体自带的文本，新建一个值
        self.comvalue2 = tk.StringVar()  # 窗体自带的文本，新建一个值
        self.comboxlist = ttk.Combobox(
            self.root, textvariable=self.comvalue1)  # 初始化
        self.comboxlist2 = ttk.Combobox(
            self.root, textvariable=self.comvalue2)  # 初始化

        self.e = StringVar()
        self.keword = Entry(self.root, textvariable=self.e)
        self.e2 = StringVar()
        self.page = keword = Entry(self.root, textvariable=self.e2)
        self.e3 = StringVar()
        self.Cookie = Entry(self.root, width=50, textvariable=self.e3)

        
        #jsonText = json.loads(str(cityJsonStr))
        self.jsonArr = cityJsonStr
        for each in cityJsonStr:
            self.provice.append(each['provice'])

    def showSecCob(self, *args):
        city = []
        for each in self.jsonArr:
            if each['provice'] == self.comboxlist.get():
                self.city = each['city']
                for cityS in each['city']:
                    city.append(cityS['name'])

        self.comboxlist2["values"] = city
        self.comboxlist2.current(0)  # 选择第一个
        # 绑定事件,(下拉列表框被选中时，绑定go()函数)
        self.comboxlist2.bind("&lt;&lt;ComboboxSelected&gt;&gt;", self.getCityId)

    def getCityId(self, *args):
        for each in self.city:
            if each['name'] == self.comboxlist2.get():
                self.cityId = each['adcode']

    def btnEvent(self, *args):
        gm = GaodeDataExport(self.cityId, self.e.get(),
                             self.e2.get(), self.e3.get())
        gm.getCompanyData()

    def createWin(self):
        # 省的位置
        l = Label(self.root, text="省", bg="green",
                  font=("Arial", 12), width=5, height=2)
        l.pack(side=TOP, padx=10, pady=10, anchor=W)

        # 省的下拉框
        self.comboxlist["values"] = self.provice
        self.comboxlist.current(0)  # 选择第一个
        # 绑定事件,(下拉列表框被选中时，绑定go()函数)
        self.comboxlist.bind("&lt;&lt;ComboboxSelected&gt;&gt;", self.showSecCob)
        self.comboxlist.pack()
        l2 = Label(self.root, text="市", bg="green",
                   font=("Arial", 12), width=5, height=2)
        l2.pack(side=TOP, padx=10, pady=10, anchor=W)
        self.comboxlist2.pack()
        l3 = Label(self.root, text="关键词", bg="green",
                   font=("Arial", 12), width=5, height=2)
        l3.pack(side=TOP, padx=10, pady=10, anchor=W)

        # 关键词输入
        self.keword.pack()

        l4 = Label(self.root, text="页码", bg="green",
                   font=("Arial", 12), width=5, height=2)
        l4.pack(side=TOP, padx=10, pady=10, anchor=W)

        # 页码输入
        self.page.pack()

        l5 = Label(self.root, text="Cookie", bg="green",
                   font=("Arial", 12), width=5, height=2)
        l5.pack(side=TOP, padx=10, pady=10, anchor=W)
        # Cookie
        self.Cookie.pack()

        btn = Button(self.root, width=30, relief=RAISED, text="导出",
                     command=self.btnEvent).pack(side=TOP, padx=10, pady=10, anchor=N)
        self.root.mainloop()


if __name__ == '__main__':
    win = WindowDisp()
    win.createWin()


</code></pre> 
</div> 
<p>转载于:https://my.oschina.net/u/3718694/blog/2354411</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/39fda00d0e96053e2e7fe2f6abbe9ac8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">php数组循环添加键值对</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b255f4380a07907bb309f3bb2546ede/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">.net core webapi  读取php 接口 方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>