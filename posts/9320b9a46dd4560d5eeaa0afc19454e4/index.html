<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Git与Gitlab - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Git与Gitlab" />
<meta property="og:description" content="自动化运维 Git与gitlab的搭建 自动化运维一、Git与Gitlab介绍Git、Github、Gitlab 的区别Git 与 SVN 区别git 主要的工作区域Git工作流程 二、部署Git 服务安装git安装后需配置用户相关信息查看已有的配置信息创建版本库方法一：在编写代码之前创建工程方法二：对已有文件的目录进行初始化 查看 git 状态将目录下所有文件都添加到暂存区，只有当暂存区有文件才能commit删除暂存区的文件，相当于撤销刚才的 add 操作 commit提交到版本库查看版本库文件将文件从暂存区和本地一起删除commit提交到版本库，彻底删除查看提交记录返回到init提交时的状态返回到最新的master状态在暂存区恢复已删除的文件tag管理分支管理 三、gitlab安装 docker拉取镜像由于容器也需要使用 22 端口，需要将容器所在主机的 ssh 服务端口改为 2222启动容器 四、gitlab应用添加单个成员到项目中通过在群组中添加成员，加入到项目中 对于没有创建过 git 版本库的主机对于已存在 git 版本库的主机（1）使用 http 协议将本地软件项目代码推送到 git 服务器（2）使用 ssh 免密推送代码 systemctl stop firewalld systemctl disable firewalld setenforce 0 一、Git与Gitlab介绍 Git、Github、Gitlab 的区别 git 是一套软件 可以做本地私有仓库
github 本身是一个代码托管网站 公有和私有仓库(收费) 不能做本地私有仓库
gitlab 本身也是一个代码托管的网站 功能上和github没有区别 公有和私有仓库（免费） 可以部署本地私有仓库
Git 与 SVN 区别 Git 与 SVN 区别Git是分布式的，svn不是：这是GIT和其它非分布式的版本控制系统，例如SVN，CVS等，最核心的区别。GIT把内容按元数据方式存储，而SVN是按文件：所有的资源控制系统都是把文件的元信息隐藏在一个类似.svn,.cvs等的文件夹里。GIT分支和SVN的分支不同：分支在SVN中一点不特别，就是版本库中的另外的一个目录。GIT没有一个全局的版本号，而SVN有：目前为止这是跟SVN相比GIT缺少的最大的一个特征。GIT的内容完整性要优于SVN：GIT的内容存储使用的是SHA-1哈希算法。这能确保代码内容的完整性，确保在遇到磁盘故障和网络问题时降低对版本库的破坏。git 是分布式的版本控制器 没有客户端和服务器端的概念svn 它是C/S结构的版本控制器 有客户端和服务器端 服务器如果宕机而且代码没有备份的情况下 完整代码就会丢失 git 主要的工作区域 工作区：代码目录，就是你在电脑里能看到的目录。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9320b9a46dd4560d5eeaa0afc19454e4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-29T22:47:41+08:00" />
<meta property="article:modified_time" content="2021-08-29T22:47:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Git与Gitlab</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>自动化运维</h2> 
<p></p> 
<div class="toc"> 
 <h4>Git与gitlab的搭建</h4> 
 <ul><li><a href="#_0" rel="nofollow">自动化运维</a></li><li><a href="#GitGitlab_12" rel="nofollow">一、Git与Gitlab介绍</a></li><li><ul><li><a href="#GitGithubGitlab__13" rel="nofollow">Git、Github、Gitlab 的区别</a></li><li><a href="#Git__SVN__23" rel="nofollow">Git 与 SVN 区别</a></li><li><a href="#git__34" rel="nofollow">git 主要的工作区域</a></li><li><a href="#Git_39" rel="nofollow">Git工作流程</a></li></ul> 
  </li><li><a href="#Git__51" rel="nofollow">二、部署Git 服务</a></li><li><ul><li><ul><li><a href="#_53" rel="nofollow">安装</a></li><li><a href="#git_59" rel="nofollow">git安装后需配置用户相关信息</a></li><li><a href="#_71" rel="nofollow">查看已有的配置信息</a></li><li><a href="#_84" rel="nofollow">创建版本库</a></li><li><ul><li><a href="#_85" rel="nofollow">方法一：在编写代码之前创建工程</a></li><li><a href="#_93" rel="nofollow">方法二：对已有文件的目录进行初始化</a></li></ul> 
    </li><li><a href="#_git__107" rel="nofollow">查看 git 状态</a></li><li><a href="#commit_126" rel="nofollow">将目录下所有文件都添加到暂存区，只有当暂存区有文件才能commit</a></li><li><a href="#_add__147" rel="nofollow">删除暂存区的文件，相当于撤销刚才的 add 操作</a></li></ul> 
   </li><li><a href="#commit_158" rel="nofollow">commit提交到版本库</a></li><li><ul><li><a href="#_171" rel="nofollow">查看版本库文件</a></li><li><a href="#_174" rel="nofollow">将文件从暂存区和本地一起删除</a></li><li><a href="#commit_191" rel="nofollow">commit提交到版本库，彻底删除</a></li><li><a href="#_205" rel="nofollow">查看提交记录</a></li><li><a href="#init_223" rel="nofollow">返回到init提交时的状态</a></li><li><a href="#master_247" rel="nofollow">返回到最新的master状态</a></li><li><a href="#_255" rel="nofollow">在暂存区恢复已删除的文件</a></li><li><a href="#tag_298" rel="nofollow">tag管理</a></li><li><a href="#_327" rel="nofollow">分支管理</a></li></ul> 
  </li></ul> 
  </li><li><a href="#gitlab_411" rel="nofollow">三、gitlab</a></li><li><ul><li><ul><li><a href="#_docker_417" rel="nofollow">安装 docker</a></li><li><a href="#_446" rel="nofollow">拉取镜像</a></li><li><a href="#_22__ssh__2222_453" rel="nofollow">由于容器也需要使用 22 端口，需要将容器所在主机的 ssh 服务端口改为 2222</a></li><li><a href="#_467" rel="nofollow">启动容器</a></li></ul> 
  </li></ul> 
  </li><li><a href="#gitlab_499" rel="nofollow">四、gitlab应用</a></li><li><ul><li><a href="#_543" rel="nofollow">添加单个成员到项目中</a></li><li><a href="#_550" rel="nofollow">通过在群组中添加成员，加入到项目中</a></li></ul> 
  </li><li><a href="#_git__565" rel="nofollow">对于没有创建过 git 版本库的主机</a></li><li><ul><li><a href="#_git__586" rel="nofollow">对于已存在 git 版本库的主机</a></li><li><ul><li><a href="#1_http__git__587" rel="nofollow">（1）使用 http 协议将本地软件项目代码推送到 git 服务器</a></li><li><a href="#2_ssh__624" rel="nofollow">（2）使用 ssh 免密推送代码</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><img src="https://images2.imgbox.com/d7/22/jaMyi4Af_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-handlebars"><span class="token variable">systemctl</span> <span class="token variable">stop</span> <span class="token variable">firewalld</span>
<span class="token variable">systemctl</span> <span class="token variable">disable</span> <span class="token variable">firewalld</span>
<span class="token variable">setenforce</span> <span class="token number">0</span>
</code></pre> 
<h2><a id="GitGitlab_12"></a>一、Git与Gitlab介绍</h2> 
<h3><a id="GitGithubGitlab__13"></a>Git、Github、Gitlab 的区别</h3> 
<blockquote> 
 <p>git 是一套软件 可以做本地私有仓库</p> 
</blockquote> 
<blockquote> 
 <p>github 本身是一个代码托管网站 公有和私有仓库(收费) 不能做本地私有仓库</p> 
</blockquote> 
<blockquote> 
 <p>gitlab 本身也是一个代码托管的网站 功能上和github没有区别 公有和私有仓库（免费） 可以部署本地私有仓库</p> 
</blockquote> 
<h3><a id="Git__SVN__23"></a>Git 与 SVN 区别</h3> 
<table><thead><tr><th align="left">Git 与 SVN 区别</th></tr></thead><tbody><tr><td align="left">Git是分布式的，svn不是：这是GIT和其它非分布式的版本控制系统，例如SVN，CVS等，最核心的区别。</td></tr><tr><td align="left">GIT把内容按元数据方式存储，而SVN是按文件：所有的资源控制系统都是把文件的元信息隐藏在一个类似.svn,.cvs等的文件夹里。</td></tr><tr><td align="left">GIT分支和SVN的分支不同：分支在SVN中一点不特别，就是版本库中的另外的一个目录。</td></tr><tr><td align="left">GIT没有一个全局的版本号，而SVN有：目前为止这是跟SVN相比GIT缺少的最大的一个特征。</td></tr><tr><td align="left">GIT的内容完整性要优于SVN：GIT的内容存储使用的是SHA-1哈希算法。这能确保代码内容的完整性，确保在遇到磁盘故障和网络问题时降低对版本库的破坏。</td></tr><tr><td align="left">git 是分布式的版本控制器 没有客户端和服务器端的概念</td></tr><tr><td align="left">svn 它是C/S结构的版本控制器 有客户端和服务器端 服务器如果宕机而且代码没有备份的情况下 完整代码就会丢失</td></tr></tbody></table> 
<h3><a id="git__34"></a>git 主要的工作区域</h3> 
<p><strong>工作区</strong>：代码目录，就是你在电脑里能看到的目录。<br> <strong>暂存区</strong>：工作区和版本库之间的缓存区域，一般存放在 .git 目录下的 index 文件（.git/index）中，英文叫 stage 或 index。<br> <strong>版本库</strong>：工作区有一个隐藏目录 .git，这个不算工作区，而是 git 的版本库。</p> 
<h3><a id="Git_39"></a>Git工作流程</h3> 
<p>一般工作流程如下：</p> 
<ul><li>克隆 Git 资源作为工作目录。</li><li>在克隆的资源上添加或修改文件。</li><li>如果其他人修改了，你可以更新资源。</li><li>在提交前查看修改。</li><li>提交修改。</li><li>在修改完成后，如果发现错误，可以撤回提交并再次修改并提交。<br> <img src="https://images2.imgbox.com/28/01/aUGTQYce_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="Git__51"></a>二、部署Git 服务</h2> 
<h4><a id="_53"></a>安装</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">yum</span> <span class="token variable">-y</span> <span class="token variable">install</span> <span class="token variable">git</span>
<span class="token variable">git</span> <span class="token variable">--version</span>
</code></pre> 
<h4><a id="git_59"></a>git安装后需配置用户相关信息</h4> 
<pre><code class="prism language-handlebars"><span class="token block keyword">#配置个人的用户名称和电子邮箱</span>
<span class="token variable">git</span> <span class="token variable">config</span> <span class="token variable">--global</span> <span class="token variable">user</span><span class="token punctuation">.</span><span class="token variable">name</span> <span class="token string">"lp"</span>
<span class="token variable">git</span> <span class="token variable">config</span> <span class="token variable">--global</span> <span class="token variable">user</span><span class="token punctuation">.</span><span class="token variable">email</span> <span class="token string">"1078802338@qq.com"</span>

<span class="token block keyword">#设置Git默认使用的文本编辑器,</span> <span class="token variable">一般可能会是</span> <span class="token variable">vi</span> <span class="token variable">或者</span> <span class="token variable">vim</span>
<span class="token variable">git</span> <span class="token variable">config</span> <span class="token variable">--global</span> <span class="token variable">core</span><span class="token punctuation">.</span><span class="token variable">editor</span> <span class="token variable">vim</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fc/6d/r4YhSWR1_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_71"></a>查看已有的配置信息</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">config</span> <span class="token variable">--list</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/77/whFDG0iE_o.png" alt="在这里插入图片描述"></p> 
<p>如果使用 --global 选项，那么配置的用户信息会保存在当前用户家目录下的 .gitconfig 文件里， 以后所有的项目都会默认使用此用户信息。<br> cat ~/.gitconfig</p> 
<p>如果要在某个特定的项目中使用其他名字或者电子邮箱，只要去掉 --global 选项重新配置即可，新的设定将会保存在当前项目的 .git/config 文件里。</p> 
<h4><a id="_84"></a>创建版本库</h4> 
<h5><a id="_85"></a>方法一：在编写代码之前创建工程</h5> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">init</span> <span class="token variable">mypro</span>
<span class="token variable">初始化空的</span> <span class="token variable">Git</span> <span class="token variable">版本库于</span> <span class="token punctuation">/</span><span class="token variable">root</span><span class="token punctuation">/</span><span class="token variable">mypro</span><span class="token punctuation">/</span><span class="token punctuation">.</span><span class="token variable">git</span><span class="token punctuation">/</span>

<span class="token variable">ls</span> <span class="token variable">-A</span> <span class="token punctuation">/</span><span class="token variable">root</span><span class="token punctuation">/</span><span class="token variable">mypro</span><span class="token punctuation">/</span>
<span class="token punctuation">.</span><span class="token variable">git</span>
</code></pre> 
<h5><a id="_93"></a>方法二：对已有文件的目录进行初始化</h5> 
<pre><code class="prism language-handlebars"><span class="token variable">mkdir</span> <span class="token punctuation">/</span><span class="token variable">root</span><span class="token punctuation">/</span><span class="token variable">myweb</span>
<span class="token variable">cd</span> <span class="token punctuation">!</span><span class="token variable">$</span>
<span class="token variable">echo</span> <span class="token string">'&lt;h1&gt;this is my web&lt;/h1&gt;'</span> <span class="token punctuation">&gt;</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">init</span>
<span class="token variable">初始化空的</span> <span class="token variable">Git</span> <span class="token variable">版本库于</span> <span class="token punctuation">/</span><span class="token variable">root</span><span class="token punctuation">/</span><span class="token variable">myweb</span><span class="token punctuation">/</span><span class="token punctuation">.</span><span class="token variable">git</span><span class="token punctuation">/</span>

<span class="token variable">ls</span> <span class="token variable">-A</span>
<span class="token punctuation">.</span><span class="token variable">git</span>  <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1d/2f/78IrfbRo_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_git__107"></a>查看 git 状态</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">status</span>
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span> <span class="token variable">初始提交</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span> <span class="token variable">未跟踪的文件</span><span class="token punctuation">:</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git add &lt;file&gt;..."</span> <span class="token variable">以包含要提交的内容）</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span>	<span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token variable">提交为空，但是存在尚未跟踪的文件（使用</span> <span class="token string">"git add"</span> <span class="token variable">建立跟踪）</span>

<span class="token variable">git</span> <span class="token variable">status</span> <span class="token variable">-s</span>
<span class="token variable">??</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6b/5c/B5nQcfCJ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="commit_126"></a>将目录下所有文件都添加到暂存区，只有当暂存区有文件才能commit</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">add</span> <span class="token punctuation">.</span>

<span class="token variable">git</span> <span class="token variable">status</span> <span class="token variable">-s</span>
<span class="token variable">A</span>  <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">status</span>
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span> <span class="token variable">初始提交</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span> <span class="token variable">要提交的变更：</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git rm --cached &lt;file&gt;..."</span> <span class="token variable">撤出暂存区）</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span>	<span class="token variable">新文件：</span>    <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token punctuation">#</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/30/RDZK6Ihp_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_add__147"></a>删除暂存区的文件，相当于撤销刚才的 add 操作</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">rm</span> <span class="token variable">--cached</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">status</span> <span class="token variable">-s</span>		<span class="token punctuation">#</span><span class="token variable">此时文件变成未知状态</span>
<span class="token variable">??</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">add</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
</code></pre> 
<h3><a id="commit_158"></a>commit提交到版本库</h3> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"init"</span>
<span class="token punctuation">[</span><span class="token variable">master（根提交）</span> <span class="token number">0296300</span><span class="token punctuation">]</span> <span class="token variable">init</span>
 <span class="token number">1</span> <span class="token variable">file</span> <span class="token variable">changed</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token variable">insertion</span><span class="token punctuation">(</span><span class="token punctuation">+</span><span class="token punctuation">)</span>
 <span class="token variable">create</span> <span class="token variable">mode</span> <span class="token number">100644</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
 
<span class="token variable">git</span> <span class="token variable">status</span>			<span class="token punctuation">#</span><span class="token variable">此时工作区为空</span>
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token variable">无文件要提交，干净的工作区</span>
</code></pre> 
<h4><a id="_171"></a>查看版本库文件</h4> 
<p>git ls-files</p> 
<h4><a id="_174"></a>将文件从暂存区和本地一起删除</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">rm</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token variable">rm</span> <span class="token string">'index.html'</span>

<span class="token variable">ls</span>         <span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token variable">此时目录中</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span> <span class="token variable">没有了</span>

<span class="token variable">git</span> <span class="token variable">status</span>     <span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token variable">现在的状态是代码库没有了但是暂存区还有</span>
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token punctuation">#</span> <span class="token variable">要提交的变更：</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git reset HEAD &lt;file&gt;..."</span> <span class="token variable">撤出暂存区）</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span>	<span class="token variable">删除：</span>      <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token punctuation">#</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e4/9a/4GJ7OOYO_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="commit_191"></a>commit提交到版本库，彻底删除</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"rm index.html"</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">master bd2197d</span><span class="token punctuation">]</span></span> <span class="token variable">rm</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
 <span class="token number">1</span> <span class="token variable">file</span> <span class="token variable">changed</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token variable">deletion</span><span class="token punctuation">(</span><span class="token variable">-</span><span class="token punctuation">)</span>
 <span class="token variable">delete</span> <span class="token variable">mode</span> <span class="token number">100644</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">status</span>
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token variable">无文件要提交，干净的工作区</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/26/34/Xgs3hks7_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_205"></a>查看提交记录</h4> 
<p>git log</p> 
<pre><code class="prism language-handlebars"><span class="token variable">commit</span> <span class="token variable">bd2197dcf3786ec628323ea6a1e782670b74b625</span>
<span class="token variable">Author</span><span class="token punctuation">:</span> <span class="token variable">lp</span> <span class="token punctuation">&lt;</span><span class="token number">1078802338</span><span class="token punctuation">@</span><span class="token variable">qq</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">&gt;</span>
<span class="token variable">Date</span><span class="token punctuation">:</span>   <span class="token variable">Sun</span> <span class="token variable">Aug</span> <span class="token number">29</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">:</span><span class="token number">46</span> <span class="token number">2021</span> <span class="token punctuation">+</span><span class="token number">0800</span>

    <span class="token variable">rm</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">commit</span> <span class="token number">02963004456252</span><span class="token variable">f41f00d53cd56b40c32e23df4a</span>
<span class="token variable">Author</span><span class="token punctuation">:</span> <span class="token variable">lp</span> <span class="token punctuation">&lt;</span><span class="token number">1078802338</span><span class="token punctuation">@</span><span class="token variable">qq</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">&gt;</span>
<span class="token variable">Date</span><span class="token punctuation">:</span>   <span class="token variable">Sun</span> <span class="token variable">Aug</span> <span class="token number">29</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token number">38</span> <span class="token number">2021</span> <span class="token punctuation">+</span><span class="token number">0800</span>

    <span class="token variable">init</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7f/a2/CqB9XatA_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="init_223"></a>返回到init提交时的状态</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">checkout</span> <span class="token number">02963004456252</span><span class="token variable">f41f00d53cd56b40c32e23df4a</span>
<span class="token variable">Note</span><span class="token punctuation">:</span> <span class="token variable">checking</span> <span class="token variable">out</span> <span class="token string">'02963004456252f41f00d53cd56b40c32e23df4a'</span><span class="token punctuation">.</span>

<span class="token variable">You</span> <span class="token variable">are</span> <span class="token variable">in</span> <span class="token string">'detached HEAD'</span> <span class="token variable">state</span><span class="token punctuation">.</span> <span class="token variable">You</span> <span class="token variable">can</span> <span class="token variable">look</span> <span class="token variable">around</span><span class="token punctuation">,</span> <span class="token variable">make</span> <span class="token variable">experimental</span>
<span class="token variable">changes</span> <span class="token variable">and</span> <span class="token variable">commit</span> <span class="token variable">them</span><span class="token punctuation">,</span> <span class="token variable">and</span> <span class="token variable">you</span> <span class="token variable">can</span> <span class="token variable">discard</span> <span class="token variable">any</span> <span class="token variable">commits</span> <span class="token variable">you</span> <span class="token variable">make</span> <span class="token variable">in</span> <span class="token variable">this</span>
<span class="token variable">state</span> <span class="token variable">without</span> <span class="token variable">impacting</span> <span class="token variable">any</span> <span class="token variable">branches</span> <span class="token variable">by</span> <span class="token variable">performing</span> <span class="token variable">another</span> <span class="token variable">checkout</span><span class="token punctuation">.</span>

<span class="token variable">If</span> <span class="token variable">you</span> <span class="token variable">want</span> <span class="token variable">to</span> <span class="token variable">create</span> <span class="token variable">a</span> <span class="token variable">new</span> <span class="token variable">branch</span> <span class="token variable">to</span> <span class="token variable">retain</span> <span class="token variable">commits</span> <span class="token variable">you</span> <span class="token variable">create</span><span class="token punctuation">,</span> <span class="token variable">you</span> <span class="token variable">may</span>
<span class="token variable">do</span> <span class="token variable">so</span> <span class="token punctuation">(</span><span class="token variable">now</span> <span class="token variable">or</span> <span class="token variable">later</span><span class="token punctuation">)</span> <span class="token variable">by</span> <span class="token variable">using</span> <span class="token variable">-b</span> <span class="token variable">with</span> <span class="token variable">the</span> <span class="token variable">checkout</span> <span class="token variable">command</span> <span class="token variable">again</span><span class="token punctuation">.</span> <span class="token variable">Example</span><span class="token punctuation">:</span>

  <span class="token variable">git</span> <span class="token variable">checkout</span> <span class="token variable">-b</span> <span class="token variable">new_branch_name</span>

<span class="token variable">HEAD</span> <span class="token variable">目前位于</span> <span class="token number">0296300.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token variable">init</span>


<span class="token variable">ls</span>		<span class="token punctuation">#</span><span class="token variable">此时之前删除的</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span> <span class="token variable">恢复回来了</span>
<span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token variable">注：不建议在返回某个历史提交的状态后对数据做修改，以防数据紊乱</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/60/34/8jTJbWQE_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="master_247"></a>返回到最新的master状态</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">checkout</span> <span class="token variable">master</span>

<span class="token variable">ls</span>     <span class="token punctuation">#</span><span class="token variable">此时</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span> <span class="token variable">没有了</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3c/e9/c9blm15j_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_255"></a>在暂存区恢复已删除的文件</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">cp</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">passwd</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">shadow</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">hosts</span> <span class="token punctuation">.</span><span class="token punctuation">/</span>

<span class="token variable">ls</span>
<span class="token variable">hosts</span>  <span class="token variable">passwd</span>  <span class="token variable">shadow</span>

<span class="token variable">git</span> <span class="token variable">add</span> <span class="token punctuation">.</span>
<span class="token variable">git</span> <span class="token variable">status</span> <span class="token variable">-s</span>
<span class="token variable">A</span>  <span class="token variable">hosts</span>
<span class="token variable">A</span>  <span class="token variable">passwd</span>
<span class="token variable">A</span>  <span class="token variable">shadow</span>

<span class="token variable">rm</span> <span class="token variable">-rf</span> <span class="token punctuation">*</span>

<span class="token variable">git</span> <span class="token variable">status</span> 
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token punctuation">#</span> <span class="token variable">要提交的变更：</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git reset HEAD &lt;file&gt;..."</span> <span class="token variable">撤出暂存区）</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span>	<span class="token variable">新文件：</span>    <span class="token variable">hosts</span>
<span class="token punctuation">#</span>	<span class="token variable">新文件：</span>    <span class="token variable">passwd</span>
<span class="token punctuation">#</span>	<span class="token variable">新文件：</span>    <span class="token variable">shadow</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span> <span class="token variable">尚未暂存以备提交的变更：</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git add/rm &lt;file&gt;..."</span> <span class="token variable">更新要提交的内容）</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git checkout -- &lt;file&gt;..."</span> <span class="token variable">丢弃工作区的改动）</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span>	<span class="token variable">删除：</span>      <span class="token variable">hosts</span>
<span class="token punctuation">#</span>	<span class="token variable">删除：</span>      <span class="token variable">passwd</span>
<span class="token punctuation">#</span>	<span class="token variable">删除：</span>      <span class="token variable">shadow</span>
<span class="token punctuation">#</span>


<span class="token variable">git</span> <span class="token variable">checkout</span> <span class="token variable">--</span> <span class="token punctuation">*</span>		<span class="token punctuation">#</span><span class="token variable">撤销工作区的文件改动来恢复文件</span>

<span class="token variable">ls</span>
<span class="token variable">hosts</span>  <span class="token variable">passwd</span>  <span class="token variable">shadow</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ba/24/qW4WDFSR_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="tag_298"></a>tag管理</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">可以给某一次提交打标记，如用于版本号</span>
<span class="token variable">echo</span> <span class="token string">'&lt;h1&gt;this is my web&lt;/h1&gt;'</span> <span class="token punctuation">&gt;</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token variable">git</span> <span class="token variable">add</span> <span class="token punctuation">.</span>
<span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"init"</span>

<span class="token variable">git</span> <span class="token variable">tag</span> <span class="token number">1.0</span>			<span class="token block keyword">#将当前commit标记为</span><span class="token number">1.0</span>

<span class="token variable">git</span> <span class="token variable">tag</span>				<span class="token punctuation">#</span><span class="token variable">查看所有的tag</span>
<span class="token number">1.0</span>

<span class="token variable">echo</span> <span class="token string">'&lt;h2&gt;hello world&lt;/h2&gt;'</span> <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">status</span> <span class="token variable">-s</span>
 <span class="token variable">M</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>

<span class="token variable">git</span> <span class="token variable">add</span> <span class="token punctuation">.</span>
<span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"modify index"</span>

<span class="token variable">git</span> <span class="token variable">tag</span> <span class="token number">2.0</span>			<span class="token block keyword">#将当前commit标记为</span><span class="token number">2.0</span>

<span class="token variable">git</span> <span class="token variable">tag</span>
<span class="token number">1.0</span>
<span class="token number">2.0</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/84/49/mkMelDEi_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_327"></a>分支管理</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">中默认有一个名为</span> <span class="token variable">master</span> <span class="token variable">的主分支，还可以创建自定义的分支。</span>

<span class="token punctuation">#</span><span class="token variable">查看分支</span>
<span class="token variable">git</span> <span class="token variable">branch</span> 
<span class="token punctuation">*</span> <span class="token variable">master</span>

<span class="token variable">git</span> <span class="token variable">status</span>			<span class="token punctuation">#</span><span class="token variable">创建分支前应确保工作区是干净的</span>
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token variable">无文件要提交，干净的工作区</span>

<span class="token variable">git</span> <span class="token variable">branch</span> <span class="token variable">b1</span>       <span class="token punctuation">#</span><span class="token variable">创建名为</span> <span class="token variable">b1</span> <span class="token variable">的分支</span>

<span class="token variable">git</span> <span class="token variable">branch</span> 
  <span class="token variable">b1</span>
<span class="token punctuation">*</span> <span class="token variable">master</span>			<span class="token punctuation">#</span> <span class="token punctuation">*</span><span class="token variable">号表示当前所在分支</span>

<span class="token punctuation">#</span><span class="token variable">切换分支</span>
<span class="token variable">git</span> <span class="token variable">checkout</span> <span class="token variable">b1</span>

<span class="token variable">git</span> <span class="token variable">branch</span> 
<span class="token punctuation">*</span> <span class="token variable">b1</span>
  <span class="token variable">master</span>

<span class="token punctuation">#</span><span class="token variable">修改分支内容</span>
<span class="token variable">cp</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">passwd</span> <span class="token punctuation">.</span><span class="token punctuation">/</span>
<span class="token variable">git</span> <span class="token variable">add</span> <span class="token punctuation">.</span>
<span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"add passwd"</span>

<span class="token variable">ls</span>
<span class="token variable">hosts</span>  <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>  <span class="token variable">passwd</span>  <span class="token variable">shadow</span>
</code></pre> 
<pre><code class="prism language-handlebars"><span class="token block keyword">#切换回master分支</span>
<span class="token variable">git</span> <span class="token variable">checkout</span> <span class="token variable">master</span>

<span class="token variable">ls</span>
<span class="token variable">hosts</span>  <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>  <span class="token variable">passwd</span>  <span class="token variable">shadow</span>

<span class="token punctuation">#</span><span class="token variable">将分支汇入主干</span>
<span class="token variable">git</span> <span class="token variable">merge</span> <span class="token variable">b1</span> <span class="token variable">-m</span> <span class="token string">"merge b1 to master"</span>

<span class="token variable">ls</span>
<span class="token variable">hosts</span>  <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>  <span class="token variable">passwd</span>  <span class="token variable">shadow</span>


<span class="token punctuation">#</span><span class="token variable">删除分支</span>
<span class="token variable">git</span> <span class="token variable">branch</span> <span class="token variable">-d</span> <span class="token variable">b1</span>

<span class="token variable">git</span> <span class="token variable">branch</span> 
<span class="token punctuation">*</span> <span class="token variable">master</span>

<span class="token punctuation">#</span><span class="token variable">可以在工作区下创建一个</span> <span class="token punctuation">.</span><span class="token variable">gitignore</span> <span class="token variable">文件，包含所有不需要</span> <span class="token variable">commit</span> <span class="token variable">到版本库中的文件名</span>
<span class="token variable">echo</span> <span class="token variable">abc123</span> <span class="token punctuation">&gt;</span> <span class="token variable">abc123</span><span class="token punctuation">.</span><span class="token variable">txt</span>
<span class="token variable">mkdir</span> <span class="token variable">mytest</span>
<span class="token variable">cp</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">hosts</span> <span class="token variable">mytest</span><span class="token punctuation">/</span>

<span class="token variable">git</span> <span class="token variable">status</span> 
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token punctuation">#</span> <span class="token variable">未跟踪的文件</span><span class="token punctuation">:</span>
<span class="token punctuation">#</span>   <span class="token variable">（使用</span> <span class="token string">"git add &lt;file&gt;..."</span> <span class="token variable">以包含要提交的内容）</span>
<span class="token punctuation">#</span>
<span class="token punctuation">#</span>	<span class="token variable">abc123</span><span class="token punctuation">.</span><span class="token variable">txt</span>
<span class="token punctuation">#</span>	<span class="token variable">mytest</span><span class="token punctuation">/</span>
<span class="token variable">提交为空，但是存在尚未跟踪的文件（使用</span> <span class="token string">"git add"</span> <span class="token variable">建立跟踪）</span>

<span class="token variable">vim</span> <span class="token punctuation">.</span><span class="token variable">gitignore</span>
<span class="token punctuation">.</span><span class="token variable">gitignore</span>		<span class="token punctuation">#</span><span class="token variable">忽略</span> <span class="token punctuation">.</span><span class="token variable">gitignore</span> <span class="token variable">文件自己</span>
<span class="token punctuation">*</span><span class="token punctuation">.</span><span class="token variable">swp</span>			<span class="token punctuation">#</span><span class="token variable">忽略正在被</span> <span class="token variable">vi</span> <span class="token variable">编辑器打开时产生的以</span> <span class="token punctuation">.</span><span class="token variable">swp</span> <span class="token variable">为后缀的临时文件</span>
<span class="token variable">abc123</span><span class="token punctuation">.</span><span class="token variable">txt</span>
<span class="token variable">mytest</span><span class="token punctuation">/</span><span class="token punctuation">*</span>

<span class="token variable">git</span> <span class="token variable">status</span> 
<span class="token punctuation">#</span> <span class="token variable">位于分支</span> <span class="token variable">master</span>
<span class="token variable">无文件要提交，干净的工作区</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/a1/psEvjdbE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/58/e1/uizAzXch_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5d/30/ljk08XrY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="gitlab_411"></a>三、gitlab</h2> 
<pre><code class="prism language-handlebars"><span class="token variable">---------------</span> <span class="token variable">部署本地gitlab服务器（使用docker搭建）</span> <span class="token variable">---------------</span>
                    <span class="token variable">虚拟机要求至少</span> <span class="token number">4</span><span class="token variable">G</span> <span class="token variable">内存</span>
</code></pre> 
<h4><a id="_docker_417"></a>安装 docker</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">yum</span> <span class="token variable">install</span> <span class="token variable">-y</span> <span class="token variable">yum-utils</span> <span class="token variable">device-mapper-persistent-data</span> <span class="token variable">lvm2</span> 
<span class="token variable">yum-config-manager</span> <span class="token variable">--add-repo</span> <span class="token variable">https</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token variable">mirrors</span><span class="token punctuation">.</span><span class="token variable">aliyun</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">/</span><span class="token variable">docker-ce</span><span class="token punctuation">/</span><span class="token variable">linux</span><span class="token punctuation">/</span><span class="token variable">centos</span><span class="token punctuation">/</span><span class="token variable">docker-ce</span><span class="token punctuation">.</span><span class="token variable">repo</span> 
<span class="token variable">yum</span> <span class="token variable">install</span> <span class="token variable">-y</span> <span class="token variable">docker-ce</span> <span class="token variable">docker-ce-cli</span> <span class="token variable">containerd</span><span class="token punctuation">.</span><span class="token variable">io</span>
</code></pre> 
<pre><code class="prism language-handlebars"><span class="token variable">mkdir</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">docker</span>
<span class="token variable">cat</span> <span class="token punctuation">&gt;</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">docker</span><span class="token punctuation">/</span><span class="token variable">daemon</span><span class="token punctuation">.</span><span class="token variable">json</span> <span class="token punctuation">&lt;</span><span class="token punctuation">&lt;</span><span class="token variable">EOF</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"registry-mirrors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"https://q7n9qid7.mirror.aliyuncs.com"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"exec-opts"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"native.cgroupdriver=systemd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"log-driver"</span><span class="token punctuation">:</span> <span class="token string">"json-file"</span><span class="token punctuation">,</span>
  <span class="token string">"log-opts"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"max-size"</span><span class="token punctuation">:</span> <span class="token string">"100m"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token variable">EOF</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0e/92/hi5RxIQ6_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-handlebars"><span class="token variable">systemctl</span> <span class="token variable">daemon-reload</span>
<span class="token variable">systemctl</span> <span class="token variable">restart</span> <span class="token variable">docker</span><span class="token punctuation">.</span><span class="token variable">service</span>
<span class="token variable">systemctl</span> <span class="token variable">enable</span> <span class="token variable">docker</span><span class="token punctuation">.</span><span class="token variable">service</span> 
</code></pre> 
<h4><a id="_446"></a>拉取镜像</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">docker</span> <span class="token variable">pull</span> <span class="token variable">twang2218</span><span class="token punctuation">/</span><span class="token variable">gitlab-ce-zh</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/05/cb/fMgcKDK0_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_22__ssh__2222_453"></a>由于容器也需要使用 22 端口，需要将容器所在主机的 ssh 服务端口改为 2222</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">vim</span> <span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">ssh</span><span class="token punctuation">/</span><span class="token variable">sshd_config</span>
<span class="token variable">Port</span> <span class="token number">2222</span>

<span class="token variable">systemctl</span> <span class="token variable">restart</span> <span class="token variable">sshd</span>

<span class="token punctuation">#</span><span class="token variable">退出当前</span> <span class="token variable">ssh</span> <span class="token variable">连接，再使用</span> <span class="token number">2222</span> <span class="token variable">端口重新连接</span>
<span class="token variable">ssh</span> <span class="token variable">-p</span> <span class="token number">2222</span> <span class="token variable">root</span><span class="token punctuation">@</span><span class="token number">192.168</span><span class="token number">.100</span><span class="token number">.150</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/61/81/RWvQDwdm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_467"></a>启动容器</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">docker</span> <span class="token variable">run</span> <span class="token variable">-d</span> <span class="token punctuation">\</span>
<span class="token variable">-h</span> <span class="token variable">gitlab</span> <span class="token punctuation">\</span>                        <span class="token punctuation">#</span><span class="token variable">指定容器中的主机名</span>
<span class="token variable">-p</span> <span class="token number">443</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token variable">-p</span> <span class="token number">80</span><span class="token punctuation">:</span><span class="token number">80</span> <span class="token variable">-p</span> <span class="token number">22</span><span class="token punctuation">:</span><span class="token number">22</span> <span class="token punctuation">\</span>
<span class="token variable">--name</span> <span class="token variable">gitlab</span> <span class="token punctuation">\</span>                    <span class="token punctuation">#</span><span class="token variable">指定容器名</span>
<span class="token variable">--restart</span> <span class="token variable">always</span> <span class="token punctuation">\</span>
<span class="token variable">-v</span> <span class="token punctuation">/</span><span class="token variable">srv</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">config</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">gitlab</span> <span class="token punctuation">\</span>              <span class="token punctuation">#</span><span class="token variable">挂载gitlab的配置文件</span>
<span class="token variable">-v</span> <span class="token punctuation">/</span><span class="token variable">srv</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">logs</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token variable">var</span><span class="token punctuation">/</span><span class="token variable">log</span><span class="token punctuation">/</span><span class="token variable">gitlab</span> <span class="token punctuation">\</span>     <span class="token punctuation">#</span><span class="token variable">挂载gitlab的日志文件</span>
<span class="token variable">-v</span> <span class="token punctuation">/</span><span class="token variable">srv</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">data</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token variable">var</span><span class="token punctuation">/</span><span class="token variable">opt</span><span class="token punctuation">/</span><span class="token variable">gitlab</span> <span class="token punctuation">\</span>     <span class="token punctuation">#</span><span class="token variable">挂载gitlab的数据</span>
<span class="token variable">twang2218</span><span class="token punctuation">/</span><span class="token variable">gitlab-ce-zh</span><span class="token punctuation">:</span><span class="token variable">latest</span>
<span class="token variable">------------------------------------------------------------------------</span>
<span class="token variable">docker</span> <span class="token variable">run</span> <span class="token variable">-d</span> <span class="token punctuation">\</span>
<span class="token variable">-h</span> <span class="token variable">gitlab</span> <span class="token punctuation">\</span>
<span class="token variable">-p</span> <span class="token number">443</span><span class="token punctuation">:</span><span class="token number">443</span> <span class="token variable">-p</span> <span class="token number">80</span><span class="token punctuation">:</span><span class="token number">80</span> <span class="token variable">-p</span> <span class="token number">22</span><span class="token punctuation">:</span><span class="token number">22</span> <span class="token punctuation">\</span>
<span class="token variable">--name</span> <span class="token variable">gitlab</span> <span class="token punctuation">\</span>
<span class="token variable">--restart</span> <span class="token variable">always</span> <span class="token punctuation">\</span>
<span class="token variable">-v</span> <span class="token punctuation">/</span><span class="token variable">srv</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">config</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token variable">etc</span><span class="token punctuation">/</span><span class="token variable">gitlab</span> <span class="token punctuation">\</span>
<span class="token variable">-v</span> <span class="token punctuation">/</span><span class="token variable">srv</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">logs</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token variable">var</span><span class="token punctuation">/</span><span class="token variable">log</span><span class="token punctuation">/</span><span class="token variable">gitlab</span> <span class="token punctuation">\</span>
<span class="token variable">-v</span> <span class="token punctuation">/</span><span class="token variable">srv</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">gitlab</span><span class="token punctuation">/</span><span class="token variable">data</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token variable">var</span><span class="token punctuation">/</span><span class="token variable">opt</span><span class="token punctuation">/</span><span class="token variable">gitlab</span> <span class="token punctuation">\</span>
<span class="token variable">twang2218</span><span class="token punctuation">/</span><span class="token variable">gitlab-ce-zh</span><span class="token punctuation">:</span><span class="token variable">latest</span>

<span class="token punctuation">#</span><span class="token variable">由于</span> <span class="token variable">gitlab</span> <span class="token variable">容器需要资源较多，需要等几分钟才能正常使用，等看到状态显示为</span> <span class="token punctuation">(</span><span class="token variable">healthy</span><span class="token punctuation">)</span> <span class="token variable">就代表已经启动了</span>
<span class="token variable">docker</span> <span class="token variable">ps</span> <span class="token variable">-a</span>
<span class="token variable">CONTAINER</span> <span class="token variable">ID</span>   <span class="token variable">IMAGE</span>                           <span class="token variable">COMMAND</span>             <span class="token variable">CREATED</span>         <span class="token variable">STATUS</span>                   <span class="token variable">PORTS</span>                                                                                                         <span class="token variable">NAMES</span>
<span class="token variable">b6cde725f2c3</span>   <span class="token variable">twang2218</span><span class="token punctuation">/</span><span class="token variable">gitlab-ce-zh</span><span class="token punctuation">:</span><span class="token variable">latest</span>   <span class="token string">"/assets/wrapper"</span>   <span class="token number">2</span> <span class="token variable">minutes</span> <span class="token variable">ago</span>   <span class="token variable">Up</span> <span class="token number">2</span> <span class="token variable">minutes</span> <span class="token punctuation">(</span><span class="token variable">healthy</span><span class="token punctuation">)</span>   <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token variable">-</span><span class="token punctuation">&gt;</span><span class="token number">22</span><span class="token block keyword">/tcp,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">22</span><span class="token variable">-</span><span class="token punctuation">&gt;</span><span class="token number">22</span><span class="token block keyword">/tcp,</span> <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token variable">-</span><span class="token punctuation">&gt;</span><span class="token number">80</span><span class="token block keyword">/tcp,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token variable">-</span><span class="token punctuation">&gt;</span><span class="token number">80</span><span class="token block keyword">/tcp,</span> <span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">:</span><span class="token number">443</span><span class="token variable">-</span><span class="token punctuation">&gt;</span><span class="token number">443</span><span class="token block keyword">/tcp,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">443</span><span class="token variable">-</span><span class="token punctuation">&gt;</span><span class="token number">443</span><span class="token block keyword">/tcp</span>   <span class="token variable">gitlab</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3d/26/iqrv6WfY_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="gitlab_499"></a>四、gitlab应用</h2> 
<p>浏览器访问：http://192.168.100.150<img src="https://images2.imgbox.com/38/13/8C1ZiQSi_o.png" alt="在这里插入图片描述"></p> 
<p>1、设置管理员 root 用户的新密码，注意有格式要求，这里设置成 root@123</p> 
<p>2、使用管理员 root 用户登录（root/root@123），登录后点击页面上方的【扳手】图标进入“管理区域”<br> <img src="https://images2.imgbox.com/36/56/BO1fVxAa_o.png" alt="在这里插入图片描述"></p> 
<p>gitlab 中重要的概念：<br> ●群组（group）：对应一个开发团队，比如开发部组、测试部组、运维部组等。<br> ●项目（project）：对应软件项目，比如开发部开发的每一个软件项目。<br> ●成员（member）：对应用户，用于将用户加入到组中，比如可将几个程序员加入到某一个软件项目组中，各自完成不同的功能模块的代码并上传，来共同完成整个软件项目。</p> 
<p>3、创建名为 devops 的组<br> 点击 【新建群组】<br> 【群组路径】、【群组名称】、【描述】都设置成 devops<br> 【可见等级】设置成 公开<br> 其他都保持默认值，点击 【创建群组】<br> <img src="https://images2.imgbox.com/47/16/O9ktLheY_o.png" alt="在这里插入图片描述"></p> 
<p>4、创建自己的账户，如 dl，账户加入到 devops 组中<br> 点击页面上方的【扳手】图标进入“管理区域”<br> 点击 【新建用户】<br> 【姓名】设置成 dl<br> 【用户名】设置成 dl<br> 【电子邮箱】设置成 dl@qq.com<br> 这里密码暂不设置，其他都保持默认值，先点击 【创建用户】</p> 
<p>创建好用户后再点击右上角的【编辑】，可在这里设置密码,，如 abc@1234<br> <img src="https://images2.imgbox.com/e6/ba/srmQxpnX_o.png" alt="在这里插入图片描述"></p> 
<p>5、创建项目 myweb，授权 kgc 是项目的主程序员，使其具有上传代码的权限<br> 点击页面上方的【扳手】图标进入“管理区域”<br> 点击 【新建项目】<br> 【项目路径】群组选项下拉选择 devops<br> 【项目名称】设置成 myweb<br> 【项目描述】设置成 zyxm<br> 【可见等级】设置成 公开<br> 点击 【创建项目】<br> <img src="https://images2.imgbox.com/0c/eb/gKnMr7e5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_543"></a>添加单个成员到项目中</h3> 
<p>点击左边菜单【设置】-&gt;【成员】进入“项目成员”<br> 【添加成员】中的【选择要邀请的成员】选择 kgc<br> 【选择角色权限】选择 主程序员<br> 点击 【添加到项目】<br> <img src="https://images2.imgbox.com/e4/b2/C4evJe5t_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_550"></a>通过在群组中添加成员，加入到项目中</h3> 
<p>点击页面上方的【群组】-&gt;【您的群组】选择 devops<br> 点击左边菜单【成员】<br> 【添加成员到 devops】选择 ylx，主程序员<br> 点击 【添加到群组】</p> 
<p>6、使用自己创建的账户进行管理<br> 退出当前账户，使用自己创建的账户dl 登录（kgc/abc@1234）<br> 第一次登录会被强制要求修改密码（kgc/root@123），可与旧密码相同，再重新登录</p> 
<p><img src="https://images2.imgbox.com/f0/53/bVvFYXWB_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_git__565"></a>对于没有创建过 git 版本库的主机</h2> 
<pre><code class="prism language-handlebars"><span class="token variable">cd</span> <span class="token punctuation">/</span><span class="token variable">opt</span>
<span class="token variable">git</span> <span class="token variable">clone</span> <span class="token variable">http</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token number">192.168</span><span class="token number">.100</span><span class="token number">.150</span><span class="token block keyword">/devops/myweb.git</span>

<span class="token variable">ls</span> <span class="token variable">-A</span> <span class="token variable">myweb</span><span class="token punctuation">/</span>
<span class="token punctuation">.</span><span class="token variable">git</span>

<span class="token variable">cd</span> <span class="token variable">myweb</span><span class="token punctuation">/</span>

<span class="token variable">touch</span> <span class="token variable">myxm</span><span class="token punctuation">.</span><span class="token variable">md</span>
<span class="token variable">git</span> <span class="token variable">add</span> <span class="token variable">myxm</span><span class="token punctuation">.</span><span class="token variable">md</span>
<span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"2"</span>
<span class="token variable">git</span> <span class="token variable">push</span> <span class="token variable">-u</span> <span class="token variable">origin</span> <span class="token variable">master</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cc/4d/FIiam7bX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/47/31/MkTEaNyf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_git__586"></a>对于已存在 git 版本库的主机</h3> 
<h4><a id="1_http__git__587"></a>（1）使用 http 协议将本地软件项目代码推送到 git 服务器</h4> 
<pre><code class="prism language-handlebars"><span class="token variable">cd</span> <span class="token punctuation">~</span><span class="token punctuation">/</span><span class="token variable">myweb</span><span class="token punctuation">/</span>
</code></pre> 
<p>#添加一个远程仓库上传代码方式的 url 名称为 origin</p> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">remote</span> <span class="token variable">add</span> <span class="token variable">origin</span> <span class="token variable">http</span><span class="token punctuation">:</span><span class="token punctuation">/</span><span class="token punctuation">/</span><span class="token number">192.168</span><span class="token number">.100</span><span class="token number">.150</span><span class="token block keyword">/devops/myweb.git</span>
</code></pre> 
<p>#查看远程仓库</p> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">remote</span>
</code></pre> 
<p>#推送本地代码到远程仓库</p> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">push</span> <span class="token variable">-u</span> <span class="token variable">origin</span> <span class="token variable">--all</span>		<span class="token punctuation">#</span><span class="token variable">输入账户名和密码（</span><span class="token number">1269651556</span><span class="token punctuation">@</span><span class="token variable">qq</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">/</span><span class="token variable">abc123456）</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/3d/HtsxHjjq_o.png" alt="在这里插入图片描述"></p> 
<p>#推送 tag 标记到远程仓库</p> 
<pre><code class="prism language-handlebars"><span class="token variable">git</span> <span class="token variable">push</span> <span class="token variable">-u</span> <span class="token variable">origin</span> <span class="token variable">--tags</span>		<span class="token punctuation">#</span><span class="token variable">输入账户名和密码（</span><span class="token number">1269651556</span><span class="token punctuation">@</span><span class="token variable">qq</span><span class="token punctuation">.</span><span class="token variable">com</span><span class="token punctuation">/</span><span class="token variable">abc123456）</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d4/dd/lrIcwCBX_o.png" alt="在这里插入图片描述"></p> 
<p>#刷新页面即可看到上传的代码和对应的 tag 标记<br> <img src="https://images2.imgbox.com/b6/ff/jm4if8I2_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_ssh__624"></a>（2）使用 ssh 免密推送代码</h4> 
<p>点击右上角的用户选项选择【设置】<br> 点击左边菜单【SSH密钥】，再点击页面中的【generate one】查看如何生成密钥</p> 
<p>ssh-keygen -t rsa -C “lp@qq.com” -b 4096 #一路回车<br> cat ~/.ssh/id_rsa.pub<br> <img src="https://images2.imgbox.com/26/51/PeP8mIYm_o.png" alt="在这里插入图片描述"></p> 
<p>git@gitlab:devops/myweb.git</p> 
<p>将公钥拷贝到网页中的公钥文本框中，再点击【增加密钥】<br> <img src="https://images2.imgbox.com/77/8e/sHRbHz2O_o.png" alt="在这里插入图片描述"></p> 
<p>#查看当前的 remote 方式<br> git remote show origin</p> 
<p>#更换上传代码方式<br> git remote remove origin #删除以前的方式</p> 
<p>#添加远程仓库上传代码方式<br> git remote add origin git@192.168.100.150:devops/myweb.git</p> 
<p>git remote show origin</p> 
<pre><code class="prism language-handlebars"><span class="token block keyword">#推送测试</span>
<span class="token variable">echo</span> <span class="token string">'&lt;h3&gt;new line&lt;/h3&gt;'</span> <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> <span class="token variable">index</span><span class="token punctuation">.</span><span class="token variable">html</span>
<span class="token variable">git</span> <span class="token variable">add</span> <span class="token punctuation">.</span>
<span class="token variable">git</span> <span class="token variable">commit</span> <span class="token variable">-m</span> <span class="token string">"modify index third"</span>

<span class="token variable">git</span> <span class="token variable">push</span>
<span class="token variable">git</span> <span class="token variable">push</span> <span class="token variable">--tags</span>

<span class="token punctuation">#</span><span class="token variable">刷新页面即可看到上传的代码和对应的</span> <span class="token variable">tag</span> <span class="token variable">标记</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c0e2731db5089e4e7a958904d0c6958/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python中strip函数几种用法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e82ee2758b328cf9cb5255ab41b93d6e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ZYNQ网络通信之PHY详解（型号：88E1145）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>