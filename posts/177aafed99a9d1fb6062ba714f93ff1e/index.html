<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Flink项目（看了就会） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Flink项目（看了就会）" />
<meta property="og:description" content="Flink基本项目WordCount 一， Flink批处理WordCount 使用maven先配置好pom文件
然后在项目目录上创建input包
然后在input包中创建word文件word.txt
并在文件中添加一下内容
hello woed hello linux hello mysql 然后在src的运行目录下创建一个目录，然后创建scala文件命名为BatcWordCount
具体代码为
package flink import org.apache.flink.api.scala.{ExecutionEnvironment, createTypeInformation} object BatchWordCount { def main(args: Array[String]): Unit = { // 1 创建一个执行环境 val env=ExecutionEnvironment.getExecutionEnvironment // 2 读取文本文件数据 val lineDataSet = env.readTextFile(&#34;input/word.txt&#34;) // 3 对数据集进行转换处理 val wordAndOne = lineDataSet.flatMap( _.split(&#34; &#34;) ).map(word =&gt; (word , 1)) // 4 按照单词进行分组 val wordAndOneGroup = wordAndOne.groupBy(0) // 5 对分组数据进行sum聚合统计 val sum = wordAndOneGroup.sum(1) //6 打印输出 sum." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/177aafed99a9d1fb6062ba714f93ff1e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-23T10:30:17+08:00" />
<meta property="article:modified_time" content="2024-01-23T10:30:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Flink项目（看了就会）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="FlinkWordCount_0"></a>Flink基本项目WordCount</h2> 
<h2><a id="_FlinkWordCount_4"></a>一， Flink批处理WordCount</h2> 
<p>使用maven先配置好pom文件<br> 然后在项目目录上创建input包</p> 
<p><img src="https://images2.imgbox.com/f0/67/PODrOwDE_o.png" alt="在这里插入图片描述"></p> 
<p>然后在input包中创建word文件word.txt</p> 
<p>并在文件中添加一下内容</p> 
<pre><code class="prism language-c">hello woed
hello linux
hello mysql


</code></pre> 
<p>然后在src的运行目录下创建一个目录，然后创建scala文件命名为BatcWordCount</p> 
<p><img src="https://images2.imgbox.com/32/5e/To8gHxMh_o.png" alt="在这里插入图片描述"></p> 
<p>具体代码为</p> 
<pre><code class="prism language-c">package flink

import org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>api<span class="token punctuation">.</span>scala<span class="token punctuation">.</span><span class="token punctuation">{<!-- --></span>ExecutionEnvironment<span class="token punctuation">,</span> createTypeInformation<span class="token punctuation">}</span>

object BatchWordCount <span class="token punctuation">{<!-- --></span>
  def <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span>String<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 1 创建一个执行环境</span>
    val env<span class="token operator">=</span>ExecutionEnvironment<span class="token punctuation">.</span>getExecutionEnvironment

    <span class="token comment">// 2 读取文本文件数据</span>
    val lineDataSet <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">readTextFile</span><span class="token punctuation">(</span><span class="token string">"input/word.txt"</span><span class="token punctuation">)</span>

    <span class="token comment">// 3 对数据集进行转换处理</span>
    val wordAndOne <span class="token operator">=</span> lineDataSet<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span> _<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>word <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>word <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">// 4 按照单词进行分组</span>
    val wordAndOneGroup <span class="token operator">=</span> wordAndOne<span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">// 5 对分组数据进行sum聚合统计</span>
    val sum <span class="token operator">=</span> wordAndOneGroup<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment">//6 打印输出</span>
    sum<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>运行结果为：</p> 
<p><img src="https://images2.imgbox.com/75/62/q6a9pY2h_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_FlinkWordCount_63"></a>二， Flink有界流处理WordCount</h3> 
<p>使用maven先配置好pom文件<br> 然后在项目目录上创建input包</p> 
<p><img src="https://images2.imgbox.com/28/58/nQl5SYY0_o.png" alt="在这里插入图片描述"></p> 
<p>然后在input包中创建word文件word.txt<br> 并在文件中添加一下内容</p> 
<pre><code class="prism language-c">hello woed
hello linux
hello mysql
</code></pre> 
<p>然后在src的运行目录下创建一个目录，然后创建scala文件命名为BoundeddStreamWordCount</p> 
<p><img src="https://images2.imgbox.com/35/4d/M1aV2wjm_o.png" alt="在这里插入图片描述"></p> 
<p>具体代码为:</p> 
<pre><code class="prism language-c">package flink
import  org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>scala<span class="token punctuation">.</span>_
object BoundeddStreamWordCount <span class="token punctuation">{<!-- --></span>
  def <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span>String<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1 创建一个流式执行环境</span>
    val env <span class="token operator">=</span> StreamExecutionEnvironment<span class="token punctuation">.</span>getExecutionEnvironment

    <span class="token comment">// 2 读取文本文件数据</span>
    val lineDataStream <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">readTextFile</span><span class="token punctuation">(</span><span class="token string">"input/word.txt"</span><span class="token punctuation">)</span>

    <span class="token comment">// 3 对数据集进行转换处理</span>
    val wordAndOne <span class="token operator">=</span> lineDataStream<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span> _<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>word <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>word <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">// 4 按照单词进行分组</span>
    val wordAndOneGroup <span class="token operator">=</span> wordAndOne<span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">)</span>

    <span class="token comment">// 5 对分组数据进行sum聚合统计</span>
    val sum <span class="token operator">=</span> wordAndOneGroup<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment">//6 打印输出</span>
    sum<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">//7 执行当前任务</span>
    env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p>运行结果为：</p> 
<p><img src="https://images2.imgbox.com/39/ac/WWctMsDJ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_FlinkWordCount_122"></a>三， Flink无界流处理WordCount</h3> 
<p>在src的运行目录下创建一个目录，然后创建scala文件命名为 StreamWordCount</p> 
<p><img src="https://images2.imgbox.com/95/15/iNzpvPM0_o.png" alt="在这里插入图片描述"></p> 
<p>具体代码为：</p> 
<pre><code class="prism language-c">package flink

import org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>flink<span class="token punctuation">.</span>streaming<span class="token punctuation">.</span>api<span class="token punctuation">.</span>scala<span class="token punctuation">.</span>_

object StreamWordCount <span class="token punctuation">{<!-- --></span>
  def <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span>String<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1 创建一个流式执行环境</span>
    val env <span class="token operator">=</span> StreamExecutionEnvironment<span class="token punctuation">.</span>getExecutionEnvironment

    <span class="token comment">// 2 读取socket文本流数据</span>
    val lineDataStream <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">socketTextStream</span><span class="token punctuation">(</span><span class="token string">"bigdata1"</span><span class="token punctuation">,</span><span class="token number">7777</span><span class="token punctuation">)</span>

    <span class="token comment">// 3 对数据集进行转换处理</span>
    val wordAndOne <span class="token operator">=</span> lineDataStream<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span> _<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>word <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>word <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">// 4 按照单词进行分组</span>
    val wordAndOneGroup <span class="token operator">=</span> wordAndOne<span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">)</span>

    <span class="token comment">// 5 对分组数据进行sum聚合统计</span>
    val sum <span class="token operator">=</span> wordAndOneGroup<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment">//6 打印输出</span>
    sum<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">//7 执行当前任务</span>
    env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p>首先在命名端口名称bigdtata1上执行</p> 
<pre><code class="prism language-c">nc <span class="token operator">-</span>lk <span class="token number">7777</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/d7/ngR71yJn_o.png" alt="在这里插入图片描述"></p> 
<p>然后连接好后在idea上执行程序StreamWordCount<br> 然后会发现并没有任何的输出，这主要是因为在bigdata1中的7777端口上没有任何的数据到来</p> 
<p><img src="https://images2.imgbox.com/47/b5/uLfO7jNa_o.png" alt="在这里插入图片描述"></p> 
<p>然后再端口7777中输入</p> 
<pre><code class="prism language-c">hello word
</code></pre> 
<p><img src="https://images2.imgbox.com/0b/47/ZSWAhbCy_o.png" alt="在这里插入图片描述"></p> 
<p>然后再到idea中查看会发现产生了结果</p> 
<p><img src="https://images2.imgbox.com/84/c3/WFUMUgyc_o.png" alt="在这里插入图片描述"><br> 然后继续往7777端口中输入</p> 
<pre><code class="prism language-c">hello flink
</code></pre> 
<p><img src="https://images2.imgbox.com/d9/e7/Uy36F1rq_o.png" alt="在这里插入图片描述"></p> 
<p>进入idea中查看数据会继续生成</p> 
<p><img src="https://images2.imgbox.com/a4/83/o3E7Jzbc_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1a1fab481ac2f0532403e859deb15d04/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">电脑摄像头设置在哪里？这3种打开方式要记好！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/011453a3d5ea885daabc461e0e8222b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用Flink的所有pom文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>