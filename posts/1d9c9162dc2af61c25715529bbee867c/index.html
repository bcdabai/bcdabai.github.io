<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>hybird (混合开发 - 视频详解) - 王云飞 - 小四 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="hybird (混合开发 - 视频详解) - 王云飞 - 小四" />
<meta property="og:description" content="背景介绍 移动端占大部分流量，已经远远超过PC端一线互联网公司都有自己的APP这些APP中有很大比例的前端代码 不要指望一个APP都是客户端开发，有很大一部分是JS、HTML、css前端的语言 那微信举例，你每天浏览微信的内容，多少是前端 移动应用分类： 原生应用
使用某一个移动平台所特有的语言
HTML5应用
使用标准的web技术
优势：跨平台
劣势：访问原生设备功能
混合应用
即使用了移动原生语言，又使用了web技术
使用技术 苹果手机
IOS系统，由swift和C&#43;&#43;/object-c语言编写，后缀名为ipa
安卓手机
安卓系统，由Java &#43; 安卓语言编写，后缀为apk
wp手机
windowphone系统
由C#语言编写，后缀分为两类（wp7 wp8的是xap，wp8.1以后用8.1的SDK开发后缀为appx）
混合开发
原生语言 &#43; JS
因为JS无法调用系统的原生功能，拍照、短信、打电话、通讯录等，但是原生（IOS、Android、wp）可以。原生有很大的适配问题（特别是Android），JS可以很好的解决这个问题。
术语 hybird
JS &#43; 安卓/IOSwebAPP
m站、手机网站nativeapp
纯IOS/android 题目 hyBird是什么？为什么用？介绍一下hybird更新和上线的流程hybird和h5的区别前端JS和客户端如何通讯 知识点 概念 hybird既混合，即前端和客户端的混合开发混合动力的汽车 需前端开发人员和客户端开发人员配合完成某些环节也可能涉及到server端PS：不要以为自己是前端就可以不理会客户端的知识，同样也不要不理会server端知识，现在是大前端的时代 存在价值 可以快速迭代更新【关键】，（无需app审核）客户端都需要应用市场审核，安卓的还好审核周期可能是一两天，苹果的就会很慢， 你不可能一天一更新迭代，小步快跑的时代，审核时间耗不起的。 APP需要审核是因为安卓的Java代码，IOS的swift，这些代码或开发环境都有权利访问 到手机的一些比较安全比较隐私的一些东西或者是一些比较深层次的API， 比如获取地理位置、相机等，用这些功能开发出来的APP肯定需要审核，你有这么高的权限 我如果不审核你，如何保证用户的合法权益。 hybird是纯前端代码，没有那么高的权限，所以无需审核 体验更流畅（和NA的体验基本类似，不抠细节）减少开发和沟通成本，双端共用一套代码 webview 浏览器的内核，可以承载一个HTML页面并且显示出来是APP中的一个组件（APP中可以有，也可以没有）webview是一个统称，每个APP中可能叫法不同浏览器中的webview
微信中的webview
file协议 其实一开始接触HTML开发，就已经使用了file协议只不过你当时没有“协议”、“标准”这些概念 HTTP(s)和file协议的区别 file协议：本地文件、快
http(s)：网络加载、慢
hybird不能用http协议只能用file协议，太慢受不了，要快，要做到和NA一样的体验， 要极致的快要变态的快 使用场景 不是所有的场景都适合使用hybird使用NA：体验要求极致，变化不频繁（头条首页）使用hybird：体验要求高，变化频繁（头条详情）使用h5：体验无要求，不常用的（举报、反馈） 具体实现 前端做好静态页面，将文件交给客户端客户端拿到前端静态页面，以文件形式存储在APP中客户端在一个webview中使用file协议加载静态页面
hybird和h5的区别 优点 体验更好，和NA差不多无需审核，迭代快 缺点 开发成本高，联调、测试、查bug都比较麻烦运维成本高，（更新上线流程） 适用场景 hybird - 适合产品型 产品的稳定功能，体验要求高，迭代频繁 h5 - 适合运营型 单次的运营活动（如，红包）或不常用功能 webview组件介绍 webview组件是我们原生开发中最核心的组件，可以理解为一个轻量级的浏览器。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1d9c9162dc2af61c25715529bbee867c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-11T08:53:13+08:00" />
<meta property="article:modified_time" content="2019-09-11T08:53:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">hybird (混合开发 - 视频详解) - 王云飞 - 小四</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>背景介绍</h3> 
<ul><li>移动端占大部分流量，已经远远超过PC端</li><li>一线互联网公司都有自己的APP</li><li>这些APP中有很大比例的前端代码 
  <ul><li>不要指望一个APP都是客户端开发，有很大一部分是JS、HTML、css前端的语言</li></ul> </li><li>那微信举例，你每天浏览微信的内容，多少是前端</li></ul> 
<h3><a id="_6"></a>移动应用分类：</h3> 
<ul><li> <p><strong>原生应用</strong><br> 使用某一个移动平台所特有的语言</p> </li><li> <p><strong>HTML5应用</strong><br> 使用标准的web技术<br> 优势：跨平台<br> 劣势：访问原生设备功能</p> </li><li> <p><strong>混合应用</strong><br> 即使用了移动原生语言，又使用了web技术</p> </li></ul> 
<h3><a id="_18"></a>使用技术</h3> 
<ul><li> <p><strong>苹果手机</strong><br> IOS系统，由swift和C++/object-c语言编写，后缀名为ipa</p> </li><li> <p><strong>安卓手机</strong><br> 安卓系统，由Java + 安卓语言编写，后缀为apk</p> </li><li> <p><strong>wp手机</strong><br> windowphone系统<br> 由C#语言编写，后缀分为两类（wp7 wp8的是xap，wp8.1以后用8.1的SDK开发后缀为appx）</p> </li><li> <p><strong>混合开发</strong><br> 原生语言 + JS<br> 因为JS无法调用系统的原生功能，拍照、短信、打电话、通讯录等，但是原生（IOS、Android、wp）可以。原生有很大的适配问题（特别是Android），JS可以很好的解决这个问题。</p> </li></ul> 
<h3><a id="_33"></a>术语</h3> 
<ul><li><strong>hybird</strong><br> JS + 安卓/IOS</li><li><strong>webAPP</strong><br> m站、手机网站</li><li><strong>nativeapp</strong><br> 纯IOS/android</li></ul> 
<h3><a id="_42"></a>题目</h3> 
<ul><li>hyBird是什么？为什么用？</li><li>介绍一下hybird更新和上线的流程</li><li>hybird和h5的区别</li><li>前端JS和客户端如何通讯</li></ul> 
<h3><a id="_47"></a>知识点</h3> 
<h4><a id="_48"></a>概念</h4> 
<ul><li>hybird既混合，即前端和客户端的混合开发<pre><code>混合动力的汽车
</code></pre> </li><li>需前端开发人员和客户端开发人员配合完成</li><li>某些环节也可能涉及到server端</li><li>PS：不要以为自己是前端就可以不理会客户端的知识，同样也不要不理会server端知识，现在是大前端的时代</li></ul> 
<h4><a id="_56"></a>存在价值</h4> 
<ul><li>可以快速迭代更新【关键】，（无需app审核）<pre><code>客户端都需要应用市场审核，安卓的还好审核周期可能是一两天，苹果的就会很慢，
你不可能一天一更新迭代，小步快跑的时代，审核时间耗不起的。

APP需要审核是因为安卓的Java代码，IOS的swift，这些代码或开发环境都有权利访问
到手机的一些比较安全比较隐私的一些东西或者是一些比较深层次的API，
比如获取地理位置、相机等，用这些功能开发出来的APP肯定需要审核，你有这么高的权限
我如果不审核你，如何保证用户的合法权益。

hybird是纯前端代码，没有那么高的权限，所以无需审核
</code></pre> </li><li>体验更流畅（和NA的体验基本类似，不抠细节）</li><li>减少开发和沟通成本，双端共用一套代码</li></ul> 
<h4><a id="webview_71"></a>webview</h4> 
<ul><li>浏览器的内核，可以承载一个HTML页面并且显示出来</li><li>是APP中的一个组件（APP中可以有，也可以没有）</li><li>webview是一个统称，每个APP中可能叫法不同</li><li>浏览器中的webview<br> <img src="https://images2.imgbox.com/a8/d7/cp303nI8_o.png" alt="image"></li><li>微信中的webview<br> <img src="https://images2.imgbox.com/e6/f5/gXvUNJnf_o.png" alt="image"></li></ul> 
<h4><a id="file_79"></a>file协议</h4> 
<ul><li>其实一开始接触HTML开发，就已经使用了file协议</li><li>只不过你当时没有“协议”、“标准”这些概念</li></ul> 
<h4><a id="HTTPsfile_82"></a>HTTP(s)和file协议的区别</h4> 
<ul><li>file协议：本地文件、快<br> <img src="https://images2.imgbox.com/fb/9f/DPT8J1qp_o.png" alt="image"></li><li>http(s)：网络加载、慢<br> <img src="https://images2.imgbox.com/b0/32/KKtQX1HH_o.png" alt="image"></li></ul> 
<pre><code>hybird不能用http协议只能用file协议，太慢受不了，要快，要做到和NA一样的体验，
要极致的快要变态的快
</code></pre> 
<h4><a id="_91"></a>使用场景</h4> 
<ul><li>不是所有的场景都适合使用hybird</li><li>使用NA：体验要求极致，变化不频繁（头条首页）</li><li>使用hybird：体验要求高，变化频繁（头条详情）</li><li>使用h5：体验无要求，不常用的（举报、反馈）</li></ul> 
<h4><a id="_96"></a>具体实现</h4> 
<ul><li>前端做好静态页面，将文件交给客户端</li><li>客户端拿到前端静态页面，以文件形式存储在APP中</li><li>客户端在一个webview中</li><li>使用file协议加载静态页面<br> <img src="https://images2.imgbox.com/fe/48/7cxhcwsJ_o.png" alt="asdsd"></li></ul> 
<h4><a id="hybirdh5_104"></a>hybird和h5的区别</h4> 
<h5><a id="_105"></a>优点</h5> 
<ul><li>体验更好，和NA差不多</li><li>无需审核，迭代快</li></ul> 
<h5><a id="_108"></a>缺点</h5> 
<ul><li>开发成本高，联调、测试、查bug都比较麻烦</li><li>运维成本高，（更新上线流程）</li></ul> 
<h5><a id="_111"></a>适用场景</h5> 
<h6><a id="hybird___112"></a>hybird - 适合产品型</h6> 
<ul><li>产品的稳定功能，体验要求高，迭代频繁</li></ul> 
<h6><a id="h5___114"></a>h5 - 适合运营型</h6> 
<ul><li>单次的运营活动（如，红包）或不常用功能</li></ul> 
<h4><a id="webview_116"></a>webview组件介绍</h4> 
<p>webview组件是我们原生开发中最核心的组件，可以理解为一个轻量级的浏览器。<br> 这个轻量级的浏览器就能捕获到网页中发送出来的所有请求，在捕获到的请求中，我们就可以进行过滤拦截，那么我就可以在JS中伪装一个请求，来让原生进行拦截从而截取到原生所需要的JS传递过来的数据信息</p> 
<h4><a id="JS_119"></a>JS和客户端通信的基本形式</h4> 
<p>微信公众平台：JS-SDk（微信公众平台封装的，h5前端和客户端的一个桥）</p> 
<ul><li>JS访问客户端能力，传递参数和回调函数</li><li>客户端通过回调函数返回内容<br> <img src="https://images2.imgbox.com/ce/83/z0KgK9VH_o.png" alt="image"></li></ul> 
<h3><a id="Android_125"></a>Android</h3> 
<h4><a id="API_126"></a>注入API方式</h4> 
<p>通过 WebView 提供的接口，向 JavaScript 的 Context（window）中注入对象或者方法，让 JavaScript 调用时，直接执行相应的 Native 代码逻辑，达到 JavaScript 调用 Native 的目的。</p> 
<h4><a id="JavaScriptAndroidtoast_128"></a>JavaScript调起Android的toast示例</h4> 
<pre><code>// Android部分
class MJavascriptInterface {
    private Context context;

    public MJavascriptInterface(Context context) {
        this.context = context;
    }

    // andorid版本升级时必须加上@JavascriptInterface
    @JavascriptInterface
    public void showToast() { // 可以由前端调用 window.ToastFunc.showToast()
        Toast.makeText(MainActivity.this, "js调起了android的Toast功能", Toast.LENGTH_SHORT).show();
    }
}

// 添加JS调用Android(Java)的方法接口
wv.addJavascriptInterface(new MJavascriptInterface(getApplicationContext()), "ToastFunc");

--------------------------------

// JavaScript - 前端部分
window.ToastFunc.showToast()
</code></pre> 
<h4><a id="AndroidJavaScript_153"></a>Android调用JavaScript前端示例</h4> 
<pre><code> // JavaScript - 提供给Android使用的方法
function getData (str) {
    $('#msg').html(str)
}
// Android端
wv.loadUrl("javascript:getData('我是一个android传递过来的值')");
</code></pre> 
<h3><a id="IOS_162"></a>IOS</h3> 
<h4><a id="schema_163"></a>schema协议简介和使用</h4> 
<ul><li>之前介绍了http(s)和file协议</li><li>schema协议 - 前端和客户端通讯的约定<pre><code>// 微信的schema协议（部分）
weixin://dl/general
weixin://dl/favorites 收藏
weixin://dl/scan 扫一扫
weixin://dl/feedback 反馈
weixin://dl/moments 朋友圈
weixin://dl/settings 设置
weixin://dl/notifications 消息通知设置
weixin://dl/chat 聊天设置
weixin://dl/general 通用设置
weixin://dl/officialaccounts 公众号
weixin://dl/games 游戏
weixin://dl/help 帮助
weixin://dl/feedback 反馈
weixin://dl/profile 个人信息
weixin://dl/features 功能插件

// 像HTTP或file协议都是定好的，不能改只能是HTTP或file
而schema协议可以根据自己的APP名称进行修改比如：weixin里面我们叫weixin、qq里面叫qq、这个都是APP自己定的。一般都会叫和自己APP相关的，不能瞎取，
// 这个名字取完以后就成了协议的一部分了，客户端和前端必须 遵守这么一个协议
</code></pre> </li></ul> 
<h4><a id="_URL_SCHEME_187"></a>拦截 URL SCHEME</h4> 
<p>先解释一下 URL SCHEME：URL SCHEME是一种类似于url的链接，是为了方便app直接互相调用设计的，形式和普通的 url 近似，主要区别是 protocol(协议) 和 host(域名) 一般是自定义的，例如: qunarhy://hy/url?url=ymfe.tech，protocol 是 qunarhy，host 则是 hy。<br> 拦截 URL SCHEME 的主要流程是：Web 端通过某种方式（例如 iframe.src）发送 URL Scheme 请求，之后 Native 拦截到请求并根据 URL SCHEME（包括所带的参数）进行相关操作。</p> 
<p>拦截 URL SCHEME 的主要流程是：Web 端通过某种方式（例如 iframe.src）发送 URL Scheme 请求，之后 Native 拦截到请求并根据 URL SCHEME（包括所带的参数）进行相关操作。</p> 
<p>在时间过程中，这种方式有一定的 缺陷：</p> 
<p>使用 iframe.src 发送 URL SCHEME 会有 url 长度的隐患。</p> 
<p>创建请求，需要一定的耗时，比注入 API 的方式调用同样的功能，耗时会较长。<br> 但是之前为什么很多方案使用这种方式呢？因为它 支持 iOS6。而现在的大环境下，iOS6 占比很小，基本上可以忽略，所以并不推荐为了 iOS6 使用这种 并不优雅 的方式。<br> 【注】：有些方案为了规避 url 长度隐患的缺陷，在 iOS 上采用了使用 Ajax 发送同域请求的方式，并将参数放到 head 或 body 里。这样，虽然规避了 url 长度的隐患，但是 WKWebView 并不支持这样的方式。<br> 【注2】：为什么选择 iframe.src 不选择 locaiton.href ？因为如果通过 location.href 连续调用 Native，很容易丢失一些调用。</p> 
<h5><a id="____JSnative_209"></a>示例 - 原理 - JS调用native</h5> 
<pre><code>// JS
&lt;button onclick="btnAction()"&gt;JS调用Native&lt;/button&gt;
function btnAction() {
    // 这里伪装一个请求，让native拦截
    window.location.href = 'test://hello world'
}
// IOS
if(拦截的路径有test://) {
    // 这是伪装的请求
    return 不发送
} else {
    // 不是伪装的请求
    return 正常发送
}
</code></pre> 
<h5><a id="____nativeJS_226"></a>示例 - 原理 - native调用JS</h5> 
<pre><code>// JS
// 在window上提供一个方法，为了能够让native调用起来，处理原生传递过来的数据
window.handleVal = function(val) {
    document.querySelector('#valInfo').innerText = val
}
// IOS
webVIew.stringByEvaluatingJavaScriptFormString:@"handleVal('hello，1810')"
// 在Android是使用loadUrl执行
</code></pre> 
<h4><a id="IOS_JS__native_237"></a>IOS JS -&gt; native实战</h4> 
<pre><code>// JS
function takePicture() {
    window.location.href = 'wyunfei://tackPicture'
    document.getElementById('img').src = ''
}
function getRQCode() {
    window.location.href = 'wyunfei://getRQCode'
}
// IOS
通过webView组件提供的方法，取到地址，获取协议
判断是伪装的还是真实的
定义和截取协议后面的字符串一致的方法，最后做出对应的逻辑处理

</code></pre> 
<p>，这样前端和客户端就能通过这个协议通讯了。</p> 
<h4><a id="__hybirdhttpswwwkancloudcnsmallfourasdasdasdasd1116619_255"></a>查看全部内容及视频详解，请点击 - <a href="https://www.kancloud.cn/small-four/asdasdasdasd/1116619" rel="nofollow">视频详解hybird开发</a></h4>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fa4c0c63f5822cebd8c06d319f1526cc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端工程化实践总结 | QQ音乐商业化Web团队</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bf1d5e251f5a8410933cb8853873716c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tensorflow学习笔记（3）: 使用load_modeld载入的keras模型是随机的</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>