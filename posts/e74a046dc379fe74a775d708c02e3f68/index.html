<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>osgi 学习系列（三）自定义osgi控制台命令 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="osgi 学习系列（三）自定义osgi控制台命令" />
<meta property="og:description" content="为了后面demo的结果显示需要先说下自定义osgi控制台命令,自定义命令的类必须实现org.eclipse.osgi.framework.console.CommandProvider接口
该接口中只有一个方法public String getHelp()用于在help方法中添加我们自定义命令的描述
自定义命令也很简单，只要写一个以下划线&#43;命令的方法即可，比如我想自定义一个say命令
public void _say(CommandInterpreter ci) { ci.print(&#34;said:&#34; &#43; ci.nextArgument()); } 这个CommandInterpreter参数必须要，否则找不到命令，ci.nextArgument()获取osgi控制台命令后跟的参数
通过getHelp方法就可以把该自定义命令的描述加到osgi控制台help命令中
@Override public String getHelp() { return &#34;\tsay – say what you input\n&#34;; } 下面建个bundle来演示一下
New--&gt;Plug-inProject
Finish完成
打开MANIFEST.MF文件，导入org.eclipse.osgi.framework.console和org.osgi.framework包 创建一个类并实现CommandProvider和BundleActivator接口
类代码如下
public class CustomizedCommand implements CommandProvider, BundleActivator { @Override public void start(BundleContext context) throws Exception { context.registerService(CommandProvider.class.getName(), new CustomizedCommand(), null); } @Override public void stop(BundleContext arg0) throws Exception { } public void _say(CommandInterpreter ci) { ci." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e74a046dc379fe74a775d708c02e3f68/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-05-27T20:33:00+08:00" />
<meta property="article:modified_time" content="2012-05-27T20:33:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">osgi 学习系列（三）自定义osgi控制台命令</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p align="left">为了后面demo的结果显示需要先说下自定义osgi控制台命令,自定义命令的类必须实现org.eclipse.osgi.framework.console.CommandProvider接口</p> 
<p align="left">该接口中只有一个方法public String getHelp()用于在help方法中添加我们自定义命令的描述</p> 
<p align="left">自定义命令也很简单，只要写一个以下划线+命令的方法即可，比如我想自定义一个say命令</p> 
<p align="left"></p> 
<pre><code class="language-java">public void _say(CommandInterpreter ci) {
     ci.print("said:" + ci.nextArgument());
}</code></pre> 
<p></p> 
<p align="left">这个CommandInterpreter参数必须要，否则找不到命令，ci.nextArgument()获取osgi控制台命令后跟的参数</p> 
<p align="left">通过getHelp方法就可以把该自定义命令的描述加到osgi控制台help命令中</p> 
<p align="left"></p> 
<pre><code class="language-java">@Override
public String getHelp() {
     return "\tsay – say what you input\n";
}
</code></pre> 
<br> 
<p></p> 
<p align="left">下面建个bundle来演示一下</p> 
<p align="left">New--&gt;Plug-inProject</p> 
<p align="left"><img src="https://images2.imgbox.com/89/92/fvZKu7B6_o.jpg" alt=""><br></p> 
<p align="left"><img src="https://images2.imgbox.com/d0/23/kDdYgGsf_o.jpg" alt=""><br></p> 
<p align="left"></p> 
<p align="left">Finish完成</p> 打开MANIFEST.MF文件，导入org.eclipse.osgi.framework.console和org.osgi.framework包 
<br> 
<p align="left"><img src="https://images2.imgbox.com/21/eb/hT09GSyM_o.jpg" alt=""><br></p> 
<p align="left">创建一个类并实现CommandProvider和BundleActivator接口<br></p> 
<p align="left"><img src="https://images2.imgbox.com/60/e0/Fg5ICXyH_o.jpg" alt=""><br></p> 
<p align="left">类代码如下<br></p> 
<p align="left"></p> 
<pre><code class="language-java">public class CustomizedCommand implements CommandProvider, BundleActivator {

	@Override
	public void start(BundleContext context) throws Exception {
		context.registerService(CommandProvider.class.getName(),
			    new CustomizedCommand(), null);
	}

	@Override
	public void stop(BundleContext arg0) throws Exception {
	}
	
	public void _say(CommandInterpreter ci) {
		 ci.print("said:" + ci.nextArgument());
	}

	@Override
	public String getHelp() {
		return "\tsay – say what you input\n";
	}
}
</code></pre> 
<br> 
<p></p> 
<p align="left">打开MANIFEST.MF，添加Bundle-Activator</p> 
<img src="https://images2.imgbox.com/c8/64/cZf0lpkI_o.jpg" alt=""> 
<br> 
<p align="left"><img src="https://images2.imgbox.com/fa/61/gwJYXuzC_o.jpg" alt=""><br></p> 
<p align="left"></p> 
<p align="left">Run运行后，在osgi控制台输入ss会看到我们建的bundle处于运行状态</p> 
<img src="https://images2.imgbox.com/9e/02/AXttt5Kl_o.jpg" alt=""> 
<br> 
<p align="left"></p> 
<p align="left">这里自定义的bundle的id比较大，是因为configuraton的缓存没有清理，我们可以在settings中把Clear the configuration area before launching勾上</p> 
<img src="https://images2.imgbox.com/d9/fe/U9KEnJ4T_o.jpg" alt=""> 
<br> 
<p align="left"></p> 
<p align="left">输入自定义命令say后会调用 _say方法</p> 
<img src="https://images2.imgbox.com/05/8f/5OMUzSi0_o.jpg" alt="">http:// 
<p align="left">在help方法中也能找到我们自定义的命令描述<br></p> 
<p align="left"><img src="https://images2.imgbox.com/13/40/7Rbu5oBF_o.jpg" alt=""><br></p> 
<p align="left"></p> 
<p align="left">osgi控制台自定义命令就说到这，这个demo中用到的jar包为</p> 
<p align="left">org.eclipse.osgi_3.7.2.v20120110-1415.jar</p> 
<p align="left">对于刚接触osgi，流程可能不太熟悉所以前面几章截图比较多，后面章节对基础的东西就不多加赘述。</p> 
<p align="left"><br></p> 
<p align="left"><a href="http://download.csdn.net/detail/ferry_passion/4333113"><span style="color:#ff0000;">点击下载demo代码</span></a><br></p> 
<br> 
<p align="left"><br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/881dbb74a0e150d4ac01218398c47efa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Xlib Programming Manual</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/702847b3739d5a45e8b1d965d51a23fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">有关BGP协议的13条选路规则，一些总结和看法 [收藏]</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>