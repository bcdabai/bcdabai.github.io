<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>yarn is running beyond physical memory limits 问题解决 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="yarn is running beyond physical memory limits 问题解决" />
<meta property="og:description" content="----- Diagnostic Messages for this Task: Container [pid=7830,containerID=container_1397098636321_27548_01_000297] is running beyond physical memory limits. Current usage: 2.1 GB of 2 GB physical memory used; 2.7 GB of 4.2 GB virtual memory used. Killing container. Dump of the process-tree for container_1397098636321_27548_01_000297 : |- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE |- 7830 7816 7830 7830 (Java) 2547 390 2924818432 539150 /export/servers/jdk1.6.0_25/bin/java -Djava.NET.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx2224m -Djava.io.tmpdir=/data2/nm/local/usercache/admin/appcache/application_1397098636321_27548/container_1397098636321_27548_01_000297/tmp -Dlog4j.configuration=Container-log4j.properties......
检查yarn-site-xml job内存限制" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bcfafc50a8512605e4637f0ff2d95985/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-26T12:03:21+08:00" />
<meta property="article:modified_time" content="2017-08-26T12:03:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">yarn is running beyond physical memory limits 问题解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style="color:rgb(51,51,51); font-size:14px; font-family:Simsun">-----</span> 
<br style="color:rgb(51,51,51); font-size:14px; font-family:Simsun"> 
<span style="color:rgb(51,51,51); font-size:14px; font-family:Simsun">Diagnostic Messages for this Task:</span> 
<br style="color:rgb(51,51,51); font-size:14px; font-family:Simsun"> 
<span style="color:rgb(51,51,51); font-size:14px; font-family:Simsun">C<span style="color:rgb(255,0,0)">ontainer [pid=7830,containerID=container_1397098636321_27548_01_000297] is running beyond physical memory limits. Current usage: 2.1 GB of 2 GB physical memory used; 2.7 GB of 4.2 GB virtual memory used. Killing container.</span></span> 
<br style="color:rgb(51,51,51); font-size:14px; font-family:Simsun"> 
<span style="color:rgb(51,51,51); font-size:14px; font-family:Simsun">Dump of the process-tree for container_1397098636321_27548_01_000297 :</span> 
<br style="color:rgb(51,51,51); font-size:14px; font-family:Simsun"> 
<span style="color:rgb(51,51,51); font-size:14px; font-family:Simsun">|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE</span> 
<br style="color:rgb(51,51,51); font-size:14px; font-family:Simsun"> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun">|- 7830 7816 7830 7830 (<a target="_blank" href="http://lib.csdn.net/base/java" rel="nofollow noopener noreferrer" class="replace_word" title="Java 知识库" style="color:rgb(223,52,52); font-weight:bold">Java</a>) 2547 390 2924818432 539150 /export/servers/jdk1.6.0_25/bin/java -Djava<a target="_blank" href="http://lib.csdn.net/base/dotnet" rel="nofollow noopener noreferrer" class="replace_word" title=".NET知识库" style="color:rgb(223,52,52); font-weight:bold">.NET</a>.preferIPv4Stack=true -Dhadoop.metrics.log.level=WARN -Xmx2224m -Djava.io.tmpdir=/data2/nm/local/usercache/admin/appcache/application_1397098636321_27548/container_1397098636321_27548_01_000297/tmp -Dlog4j.configuration=<a target="_blank" href="http://lib.csdn.net/base/docker" rel="nofollow noopener noreferrer" class="replace_word" title="Docker知识库" style="color:rgb(223,52,52); font-weight:bold">Container</a>-log4j.properties......</span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><br> </span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px">检查yarn-site-xml job内存限制</span></span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun">&lt;property&gt;<br>   &lt;name&gt;yarn.scheduler.minimum-allocation-mb&lt;/name&gt;<br>   &lt;value&gt;<span style="color:rgb(255,0,0)">2048</span>&lt;/value&gt;<br> &lt;/property&gt;<br> </span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><br> </span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun">解决方法：</span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px">1.增加yarn.scheduler.minimum-allocation-mb内存上限。</span></span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px"><span style="font-size:14.4444px">2.--hiveconf mapred.child.java.opts=-Xmx？？？？m  一定要小于<span style="font-size:14.4444px">yarn.scheduler.minimum-allocation-mb</span></span></span></span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px"><br> </span></span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px">如果是vm超了，如下：调整<span style="font-family:Tahoma; font-size:14.4444px; line-height:24px">yarn.nodemanager.vmem-pmem-ratio</span></span></span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px"><br> </span></span></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px"><span style="font-family:Simsun"><span style="font-size:14.4444px"><span style="font-size:14.4444px"></span></span></span></p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px"> 查看log没有明显的ERROR，但存在类似以下描述的日志</p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px"> 2012-05-16 13:08:20,876 INFO org.apache.<a target="_blank" href="http://lib.csdn.net/base/hadoop" rel="nofollow noopener noreferrer" class="replace_word" title="Hadoop知识库" style="color:rgb(223,52,52); font-weight:bold">Hadoop</a>.yarn.server.nodemanager.NodeStatusUpdaterImpl: Sending out status for container: container_id {, app_attempt_id {, application_id {, id: 18, cluster_timestamp: 1337134318909, }, attemptId: 1, }, id: 6, }, state: C_COMPLETE, diagnostics: "Container [pid=15641,containerID=container_1337134318909_0018_01_000006] is running beyond virtual memory limits. Current usage:<span style="margin:0px; padding:0px"> 32.1mb of 1.0gb physical memory used;<span style="background-color:rgb(255,0,0)"><span style="color:rgb(255,204,204)"> 6.2gb of 2.1gb</span></span></span><span style="color:rgb(255,204,204)"><span style="background-color:rgb(255,0,0)"> virtual memory used.</span> </span><span style="margin:0px; padding:0px">Killing container</span>.\nDump of the process-tree for container_1337134318909_0018_01_000006 :\n\t|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE\n\t|- 15641 26354 15641 15641 (java) 36 2 6686339072 8207 /home/zhouchen.zm/jdk1.6.0_23/bin/java</p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px">  </p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px"> 原因：</p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px"> 该错误是YARN的虚拟内存计算方式导致，上例中用户程序申请的内存为1Gb，YARN根据此值乘以一个比例（默认为2.1）得出申请的虚拟内存的值，当YARN计算的用户程序所需虚拟内存值大于计算出来的值时，就会报出以上错误。调节比例值可以解决该问题。具体参数为：yarn-site.xml中的yarn.nodemanager.vmem-pmem-ratio</p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px"> <br> </p> 
<p style="color:rgb(51,51,51); font-size:14px; margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Tahoma; line-height:24px"> 需要精确计算资源分配，以及使用情况。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f90192f6d3f4673f4b2ad071832dad3f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于使用Delphi XE10 进行android开发的一些总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b888304f8669b5b14e8f9af08fd994f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">再见CSDN</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>