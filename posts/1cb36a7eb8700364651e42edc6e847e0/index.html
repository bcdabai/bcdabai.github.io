<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>达梦数据库JDBC驱动测试记录 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="达梦数据库JDBC驱动测试记录" />
<meta property="og:description" content="一、测试说明 JDBC (Java Database Connectivity) 是 Java 应用程序与数据库的接口规范，旨在让各数据库开发商为 Java 程序员提供标准的数据库应用程序编程接口 (API)。JDBC 定义了一个跨数据库、跨平台的通用 SQL 数据库 API。
DM JDBC 数据库驱动程序是一个能够支持基本 SQL 功能的通用应用程序编程接口，支持一般的 SQL 数据库访问。通过 JDBC 驱动程序，用户可以在应用程序中实现对 DM 数据库的连接与访问
实验目标：部署DM8数据库，编写简单脚本测试JDBC驱动，完成数据库连接，简单SQL查询，并发连接等测试。
环境规划：
IP地址：192.168.50.100
数据库版本： DM8
软件路径规划
Linux系统目录
说明
1
/dm8
DM8安装路径
2
/home/dmdba/scrdir
脚本路径
二、软件安装 1、DM8图形化界面安装
略
2、安装JDK
yum install –y java-1.8.0-openjdk.x86_64
三、驱动测试 1、简单连接测试
编写测试脚本：vim jdbc_conn.java
import java.sql.Connection; import java.sql.DriverManager; import java.sql.SQLException; public class jdbc_conn { static Connection con = null; static String cname = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1cb36a7eb8700364651e42edc6e847e0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-06T10:33:30+08:00" />
<meta property="article:modified_time" content="2022-06-06T10:33:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">达梦数据库JDBC驱动测试记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0;text-align:justify;">一、测试说明</h3> 
<p style="margin-left:.0001pt;text-align:left;">        JDBC (Java Database Connectivity) 是 Java 应用程序与数据库的接口规范，旨在让各数据库开发商为 Java 程序员提供标准的数据库应用程序编程接口 (API)。JDBC 定义了一个跨数据库、跨平台的通用 SQL 数据库 API。</p> 
<p style="margin-left:.0001pt;text-align:left;">        DM JDBC 数据库驱动程序是一个能够支持基本 SQL 功能的通用应用程序编程接口，支持一般的 SQL 数据库访问。通过 JDBC 驱动程序，用户可以在应用程序中实现对 DM 数据库的连接与访问</p> 
<p style="margin-left:.0001pt;text-align:left;"><strong>实验目标：</strong>部署DM8数据库，编写简单脚本测试JDBC驱动，完成数据库连接，简单SQL查询，并发连接等测试。</p> 
<p style="margin-left:.0001pt;text-align:left;">环境规划：</p> 
<p style="margin-left:.0001pt;text-align:left;">IP地址：192.168.50.100</p> 
<p style="margin-left:.0001pt;text-align:left;">数据库版本：  DM8</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">软件路径规划</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="border-color:#000000;vertical-align:top;width:25.3pt;"> <p style="margin-left:.0001pt;text-align:left;"></p> </td><td style="border-color:#000000;vertical-align:top;width:112.8pt;"> <p style="margin-left:.0001pt;text-align:left;">Linux系统目录</p> </td><td style="border-color:#000000;vertical-align:top;width:140.15pt;"> <p style="margin-left:.0001pt;text-align:left;">说明</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:25.3pt;"> <p style="margin-left:.0001pt;text-align:left;">1</p> </td><td style="vertical-align:top;width:112.8pt;"> <p style="margin-left:.0001pt;text-align:left;">/dm8</p> </td><td style="vertical-align:top;width:140.15pt;"> <p style="margin-left:.0001pt;text-align:left;">DM8安装路径</p> </td></tr><tr><td style="border-color:#000000;vertical-align:top;width:25.3pt;"> <p style="margin-left:.0001pt;text-align:left;">2</p> </td><td style="vertical-align:top;width:112.8pt;"> <p style="margin-left:.0001pt;text-align:left;">/home/dmdba/scrdir</p> </td><td style="vertical-align:top;width:140.15pt;"> <p style="margin-left:.0001pt;text-align:left;">脚本路径</p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:0;text-align:justify;">二、软件安装</h3> 
<p style="margin-left:.0001pt;text-align:left;">1、DM8图形化界面安装</p> 
<p style="margin-left:.0001pt;text-align:left;">略</p> 
<p style="margin-left:.0001pt;text-align:left;">2、安装JDK</p> 
<p style="margin-left:.0001pt;text-align:left;">yum install –y java-1.8.0-openjdk.x86_64</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<h3 style="margin-left:0;text-align:justify;">三、驱动测试</h3> 
<p style="margin-left:.0001pt;text-align:left;">1、简单连接测试</p> 
<p style="margin-left:.0001pt;text-align:left;">编写测试脚本：vim jdbc_conn.java</p> 
<pre><code class="language-java">import java.sql.Connection;

import java.sql.DriverManager;

import java.sql.SQLException;

public class jdbc_conn {

    static Connection con = null;

    static String cname = "dm.jdbc.driver.DmDriver";

    static String url = "jdbc:dm://localhost:5236?logLevel=all&amp;logDir=/home/dmdba/sqltest";

    static String userid = "SYSDBA";

    static String pwd = "SYSDBA";

    static final String sql = "SELECT * from tab_01;";

    public static void main(String[] args) {

        try {

            Class.forName(cname);

            con = DriverManager.getConnection(url, userid, pwd);

            con.setAutoCommit(true);

            System.out.println("[SUCCESS]conn database");

        } catch (Exception e) {

            System.out.println("[FAIL]conn database：" + e.getMessage());

        }

    }

    public void disConn(Connection con) throws SQLException {

        if (con != null) {

            con.close();

        }

    }

}</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;">开启jdbc日志：在jdbc的串联处增加内容：</p> 
<p style="margin-left:.0001pt;text-align:justify;">?logLevel=all&amp;logDir=/home/dmdba/sqltest其中，logDir=日志目录，根据情况写。</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">--编译</p> 
<p style="margin-left:.0001pt;text-align:left;">/dm8/jdk/bin/javac -cp /dm8/drivers/jdbc/DmJdbcDriver18.jar /home/dmdba/scrdir/jdbc_conn.java</p> 
<p style="margin-left:.0001pt;text-align:left;">--测试脚本</p> 
<p style="margin-left:.0001pt;text-align:left;">java -cp /dm8/drivers/jdbc/DmJdbcDriver18.jar:/home/dmdba/scrdir/ jdbc_conn</p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="62" src="https://images2.imgbox.com/2c/88/Tq9Erl01_o.png" width="865"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:left;">2、简单查询SQL测试</p> 
<p style="margin-left:.0001pt;text-align:left;">创建数据库测试用例：</p> 
<pre><code class="language-sql">disql SYSDBA/SYSDBA

create tablespace CRM_DATA datafile 'crm_data_01.dbf' size 1024 autoextend on next 64;
create tablespace CRM_INDEX datafile 'crm_index_01.dbf' size 512 autoextend on next 64;
create user crm identified by "Jnhg2013!" default TABLESPACE "CRM_DATA" default INDEX TABLESPACE "CRM_INDEX";
grant PUBLIC to crm;
grant RESOURCE to crm;

create table tab_01 (c1 int, c2 char(10), c3 varchar, c4 numeric(5,2), c5 smallint, c6 bigint, c7 byte,c8 binary,c9 float, c10 double, c11 real,c12 bit,c13 date,c14 time, c15 timestamp, c16 interval year to month,  c17 time with time zone, c18 text,c19 image ,c20 blob, c21 clob);

insert into tab_01 values (1, 'abcd', 'testdatatype', '-123.45', '-32768', '-92233720', 123, '1', 5, 7.8, 9.1, null, '2012-12-24', '21:59:59', '2012-12-21 07:59:59', '15-08', '19:59:59 +02:03', 'test text data type','0x123456789','0x987654321','test clob data type');</code></pre> 
<p style="margin-left:.0001pt;text-align:left;">编写测试脚本：vi Sqlexec.java</p> 
<pre><code class="language-java">import java.sql.*;

import java.sql.DriverManager;

import java.util.*;

import java.text.SimpleDateFormat;

import java.util.Date;

public class Sqlexec {

    static final String JDBC_DRIVER = "dm.jdbc.driver.DmDriver";

    static final String DB_URL = "jdbc:dm://localhost:5236?logLevel=all&amp;logDir=/home/dmdba/sqltest";

    static final String USER = "crm";

    static final String PASS = "Jnhg2013!";

    static final String sql = "select * from TAB_01;";

    private static int ColumnCount;

    public static void main(String[] args) {

        Connection conn = null;

        PreparedStatement stmt = null;

        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss SSS");

        String d1;

        String d2;

        Date dt1;

        Date dt2;

        long diff;

        int i = 1;

            while ( i &lt;= 3) {

            try {

                Class.forName(JDBC_DRIVER);

                System.out.println(df.format(new Date()) + " 连接数据库");

                conn = DriverManager.getConnection(DB_URL, USER, PASS);

                d1 = df.format(new Date());

                dt1 = df.parse(d1);

                System.out.println(d1 + "第 " + i + " 次查询开始");               

                stmt = conn.prepareStatement(sql);

                ResultSet rs = stmt.executeQuery(sql);

                ResultSetMetaData rsmd = rs.getMetaData();

                List list = new ArrayList&lt;String&gt;();

                d2 = df.format(new Date());

                dt2 = df.parse(d2);

                diff = dt2.getTime() - dt1.getTime();

                System.out.println(d2 + "第 " + i + " 次查询结束");

                System.out.println("第 " + i + " 次查询耗时: " + diff);

                rs.close();

                stmt.close();

                conn.close();

                } catch (SQLException se) {

                    se.printStackTrace();

                } catch (Exception e) {

                    e.printStackTrace();

                } finally {

                    try {

                        if (stmt != null)

                        stmt.close();

                    } catch (SQLException se2) {}

                    try {

                        if (conn != null)

                        conn.close();

                  } catch (SQLException se){

                        se.printStackTrace();

                  }

                }

            i++;

            }

        System.out.println("Goodbye!");

    }

}</code></pre> 
<p style="margin-left:.0001pt;text-align:left;">--编译</p> 
<p style="margin-left:.0001pt;text-align:left;">/dm8/jdk/bin/javac -cp /dm8/drivers/jdbc/DmJdbcDriver18.jar /home/dmdba/scrdir/jdbc_conn.java</p> 
<p style="margin-left:.0001pt;text-align:left;">--测试脚本</p> 
<p style="margin-left:.0001pt;text-align:left;">java -cp /dm8/drivers/jdbc/DmJdbcDriver18.jar:/home/dmdba/scrdir/ jdbc_conn</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="264" src="https://images2.imgbox.com/c3/2e/plz5BfFN_o.png" width="865"></p> 
<p> </p> 
<p style="margin-left:.0001pt;text-align:left;">3、并发测试</p> 
<p style="margin-left:.0001pt;text-align:left;">编写测试脚本：vi Sqlexec.java</p> 
<pre><code class="language-java">import cn.hutool.core.thread.ThreadUtil;

import java.sql.DriverManager;

import java.sql.*;

import java.util.concurrent.*;

import java.util.Date;

import java.text.SimpleDateFormat;

public class Sqlexec {

    static final String JDBC_DRIVER = "dm.jdbc.driver.DmDriver";

    static final String DB_URL = "jdbc:dm://localhost:5236?logLevel=all&amp;logDir=/home/dmdba/sqltest";

    static final String USER = "crm";

    static final String PASS = "Jnhg2013!";

    static final String sql = "select * from TAB_01;";



    private static ExecutorService executor = ThreadUtil.newExecutor(10);

    public static void main(String[] args) {

        for (int i = 0; i &lt; 10; i++) {

            executor.execute(() -&gt; handler());

        }

        executor.shutdown();

    }

   

    public static void handler(){

        /* 打印当前线程名字 */

        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss SSS");

        System.out.println(df.format(new Date()) + "  当前执行线程：" + Thread.currentThread().getName());

        String d1;

        String d2;

        Date dt1;

        Date dt2;

        long diff;

        try {

            Class.forName(JDBC_DRIVER);

            Connection con = DriverManager.getConnection(DB_URL, USER, PASS);

            con.setAutoCommit(true);

            /* System.out.println("[SUCCESS]conn database"); */

            PreparedStatement stmt = con.prepareStatement(sql);

            d1 = df.format(new Date());

            dt1 = df.parse(d1);

            /* 执行查询操作 */

            stmt.execute();

            d2 = df.format(new Date());

            dt2 = df.parse(d2);

            /* 获取返回结果 */

            diff = dt2.getTime() - dt1.getTime();

            ResultSet resultSet = stmt.getResultSet();

            System.out.println(Thread.currentThread().getName() + " -&gt; 查询耗时: " + diff + "ms. 结果集：");

            while (resultSet.next()) {

                System.out.println(resultSet.getString("c1"));

            }

            resultSet.close();

            stmt.close();

            con.close();

        } catch (Exception e) {

            System.out.println("[FAIL]conn database：" + e.getMessage());

        }

    }

}</code></pre> 
<p style="margin-left:.0001pt;text-align:left;">--编译</p> 
<p style="margin-left:.0001pt;text-align:left;">/dm8/jdk/bin/javac -cp /dm8/drivers/jdbc/DmJdbcDriver18.jar -cp /home/dmdba/scrdir/hutool.jar /home/dmdba/scrdir/Sqlexec.java</p> 
<p style="margin-left:.0001pt;text-align:left;">--测试脚本</p> 
<p style="margin-left:.0001pt;text-align:left;">java -cp /dm8/drivers/jdbc/DmJdbcDriver18.jar:/home/dmdba/scrdir/hutool.jar:/home/dmdba/scrdir/ Sqlexec</p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="443" src="https://images2.imgbox.com/e1/8c/4cCDTgJD_o.png" width="865"></p> 
<p> </p> 
<p><span style="color:#fe2c24;"><em><strong>更多技术内容请访问社区：https://eco.dameng.com</strong></em></span></p> 
<p style="margin-left:.0001pt;text-align:left;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1c46f4b84721ab68d26167d913a323e8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">c&#43;&#43;基础</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/547e3b8f74fc53da2cce5ab8b4ec6f0b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">node升级版本后，运行原vue项目报错问题解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>