<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>selenium的常见表单元素操作 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="selenium的常见表单元素操作" />
<meta property="og:description" content="selenium的表单相关操作 selenium是浏览器自动化测试框架，是一个用于Web应用程序测试的工具，可以直接运行在浏览器当中，并可以驱动浏览器执行指定的动作，如点击、下拉、填充数据、删除cookie等操作，还可以获取浏览器当前页面的源代码，就像用户在浏览器中操作一样。该工具所支持的浏览器有IE浏览器、Mozilla Firefox以及Google Chrome等。selenium有很多语言的版本，比如：Java、Ruby、Python等。
操作表单元素 常见的表单元素 § Input
§ button
§ checkbox
§ select
1、操作输入框： 分为两步， 第一步：找到元素 第二步：使用send_keys(value),将数据填充进去。示例代码如下： # 以百度为例 #_*_coding:utf-8_*_ # 作者 ：liuxiaowei # 创建时间 ：2/9/22 3:35 PM # 文件 ：selenium操作input.py # IDE ：PyCharm # 导入webdriver 模块 from selenium import webdriver # 导入time模块 import time # 创建浏览器引擎 driver = webdriver.Chrome(executable_path=&#39;chromedriver&#39;) # 指定url url = &#39;http://www.baidu.com&#39; # 使用引擎打开网页 driver.get(url) # 通过ID查找input框 inputTag = driver.find_element_by_id(&#39;kw&#39;) # 向input框发送python值 inputTag.send_keys(&#39;python&#39;) # 停顿3秒 time." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e4f0c1abf1f476d06636832d7cf1851e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-10T14:57:33+08:00" />
<meta property="article:modified_time" content="2022-02-10T14:57:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">selenium的常见表单元素操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="selenium_0"></a>selenium的表单相关操作</h2> 
<hr> 
<p>selenium是浏览器自动化测试框架，是一个用于Web应用程序测试的工具，可以直接运行在浏览器当中，并可以驱动浏览器执行指定的动作，如点击、下拉、填充数据、删除cookie等操作，还可以获取浏览器当前页面的源代码，就像用户在浏览器中操作一样。该工具所支持的浏览器有<strong>IE浏览器、Mozilla Firefox以及Google Chrome</strong>等。selenium有很多语言的版本，比如：Java、Ruby、Python等。</p> 
<h3><a id="_6"></a>操作表单元素</h3> 
<h4><a id="_8"></a>常见的表单元素</h4> 
<p>§ Input</p> 
<p>§ button</p> 
<p>§ checkbox</p> 
<p>§ select</p> 
<h5><a id="1_____send_keysvalue_18"></a>1、操作输入框： 分为两步， 第一步：找到元素 第二步：使用send_keys(value),将数据填充进去。示例代码如下：</h5> 
<pre><code class="prism language-python"><span class="token comment"># 以百度为例</span>
<span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 3:35 PM</span>
<span class="token comment"># 文件      ：selenium操作input.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入webdriver 模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token comment"># 导入time模块</span>
<span class="token keyword">import</span> time

<span class="token comment"># 创建浏览器引擎</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span><span class="token string">'chromedriver'</span><span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>

<span class="token comment"># 使用引擎打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 通过ID查找input框</span>
inputTag <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
<span class="token comment"># 向input框发送python值</span>
inputTag<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'python'</span><span class="token punctuation">)</span>

<span class="token comment"># 停顿3秒</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> 
<p>使用clear 方法可以清除输入框中的内容。示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment"># 自动清除</span>
inputTag<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 停顿3秒</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭当前浏览页</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="2checkboxcheckbox_checkboxclick_63"></a>2、操作checkbox:因为要选中checkbox 标签，在网页中是通过鼠标点击的。因此想要选中checkbox标签，那么选中这个标签，然后执行click事件。示例代码如下：</h5> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 3:35 PM</span>
<span class="token comment"># 文件      ：selenium操作checkbox.py</span>
<span class="token comment"># IDE      ：PyCharm</span>


<span class="token comment"># 导入webdriver模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time

<span class="token comment"># 创建浏览器引擎</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span><span class="token string">'chromedriver'</span><span class="token punctuation">)</span>

<span class="token comment"># 设定url</span>
url <span class="token operator">=</span> <span class="token string">'https://passport.mingrisoft.com/login/index.html?tpl=sch'</span>

<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 通过name查找checkbox，本例默认是选中的</span>
checkboxTag <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">'rempwd'</span><span class="token punctuation">)</span>
<span class="token comment"># 执行click()命令，取消默认选中</span>
checkboxTag<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 停顿3秒</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 关闭当前浏览页</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="3selectselectseleniumselectseleniumwebdriversupportuiSelect_96"></a>3、选择select：select元素不能直接点击。因为点击后还需要选中元素，因此selenium专门为select标签提供了一个类selenium.webdriver.support.ui.Select。将获取的元素当成参数传到这个类中，创建这个对象。以后就可以使用这个对象进行选择了。示例代码如下：</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> Select
<span class="token comment"># 选中这个标签，然后使用Select创建对象</span>
selectTag <span class="token operator">=</span> Select<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">'jumpMenu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 根据索引选择</span>
selectTag<span class="token punctuation">.</span>select_by_index<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 根据值选择</span>
selectTag<span class="token punctuation">.</span>select_by_value<span class="token punctuation">(</span><span class="token string">'http://www.95yueba.com'</span><span class="token punctuation">)</span>
<span class="token comment"># 根据可是的文本选择</span>
selectTag<span class="token punctuation">.</span>select_by_visible_text<span class="token punctuation">(</span><span class="token string">'95秀客户端'</span><span class="token punctuation">)</span>
<span class="token comment"># 取消所有选项</span>
selectTag<span class="token punctuation">.</span>deselect_all<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="4click_112"></a>4、操作按钮：操作按钮有很多种方式。比如单击、右击、双击等。常用的是点击。直接调用click函数就可以。示例代码如下：</h5> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 4:59 PM</span>
<span class="token comment"># 文件      ：selenium操作按钮标签.py</span>
<span class="token comment"># IDE      ：PyCharm</span>


<span class="token comment"># 导入webdriver 模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token comment"># 导入Select模块</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> Select
<span class="token comment"># 导入time模块</span>
<span class="token keyword">import</span> time

<span class="token comment"># 创建浏览器引擎</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span><span class="token string">'chromedriver'</span><span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com'</span>

<span class="token comment"># 使用引擎打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 通过ID查找input框</span>
inputTag <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
<span class="token comment"># 向input框发送python值</span>
inputTag<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'python'</span><span class="token punctuation">)</span>

<span class="token comment"># 查找百度一下按钮</span>
submitTag <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span>
<span class="token comment"># click()执行百度命令</span>
submitTag<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 关闭当前浏览器页面</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_151"></a>行为链</h4> 
<p>所谓“行为链”就是一连串的操作动作。有时候在页面中的操作可能要有很多步，那么这时候可以使用鼠标行为链类ActionChains来完成。例如将鼠标移动到某个元素上并执行点击事件。示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 5:34 PM</span>
<span class="token comment"># 文件      ：selenium操作行为链.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
<span class="token keyword">import</span> time

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com/'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 找到input、百度一下标签</span>
inputTag <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
submitTag <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span>

<span class="token comment"># 创建行为</span>
actions <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span>
<span class="token comment"># 选中input框，然后输入'中国女足'</span>
actions<span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>inputTag<span class="token punctuation">)</span>
actions<span class="token punctuation">.</span>send_keys_to_element<span class="token punctuation">(</span>inputTag<span class="token punctuation">,</span> <span class="token string">'中国女足'</span><span class="token punctuation">)</span>
<span class="token comment"># 选中百度一下标签，然后单击</span>
actions<span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>submitTag<span class="token punctuation">)</span>
actions<span class="token punctuation">.</span>click<span class="token punctuation">(</span>submitTag<span class="token punctuation">)</span>
<span class="token comment"># 统一执行actions</span>
actions<span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>

time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>还有更多的鼠标相关操作</p> 
<ul><li>click_and_hold(element):点击但不松开鼠标</li><li>context_click(element):右键点击</li><li>double_click(element):双击</li></ul> 
<p>更多方法参考：http://selenium-python.readthedocs.io/api.html</p> 
<h3><a id="Cookie_205"></a>Cookie操作</h3> 
<p>1、获取所有的cookie</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 6:57 PM</span>
<span class="token comment"># 文件      ：selenium操作cookie.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>

<span class="token comment"># 访问url</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token keyword">for</span> cookie <span class="token keyword">in</span> driver<span class="token punctuation">.</span>get_cookies<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>程序运行结果如下：</p> 
<pre><code class="prism language-python"><span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1675940497</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BAIDUID_BFESS'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'sameSite'</span><span class="token punctuation">:</span> <span class="token string">'None'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'058DB780F413036AE207FA5D5DBDFD0D:FG=1'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1644408097</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BA_HECTOR'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'ac81212k8l8180e5ug1h077oi0q'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'H_PS_PSSID'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'35414_35104_31254_35488_34584_35491_35796_35316_26350_35765_35745'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1675940496</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BAIDUID'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'058DB780F413036AE207FA5D5DBDFD0D:FG=1'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">3791888143</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BIDUPSID'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'058DB780F413036A0DFEEB9DEAF54433'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">3791888143</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'PSTM'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'1644404497'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1645268497</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BD_UPN'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'123253'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BD_HOME'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">}</span>
Process finished <span class="token keyword">with</span> exit code <span class="token number">0</span>
</code></pre> 
<p>2、根据cookie的key获取cookie的value，示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 6:57 PM</span>
<span class="token comment"># 文件      ：selenium操作cookie.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>

<span class="token comment"># 访问url</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token comment"># 通过某个key获取cookie的value</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>get_cookie<span class="token punctuation">(</span><span class="token string">'PSTM'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>程序运行结果如下：</p> 
<pre><code class="prism language-python"><span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">3791888742</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'PSTM'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'1644405096'</span><span class="token punctuation">}</span>

Process finished <span class="token keyword">with</span> exit code <span class="token number">0</span>
</code></pre> 
<p>3、删除所有的cookies,示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 6:57 PM</span>
<span class="token comment"># 文件      ：selenium操作cookie.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>

<span class="token comment"># 访问url</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token comment"># 删除所有cookies</span>
driver<span class="token punctuation">.</span>delete_all_cookies<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>程序运行结果如下：</p> 
<p><img src="https://images2.imgbox.com/6a/f8/VUsC6Xya_o.png" alt=""></p> 
<p>4、删除某个cookie,示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 6:57 PM</span>
<span class="token comment"># 文件      ：selenium操作cookie.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>

<span class="token comment"># 访问url</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token keyword">for</span> cookie <span class="token keyword">in</span> driver<span class="token punctuation">.</span>get_cookies<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span>

<span class="token comment"># driver.close()</span>

<span class="token comment"># 根据cookie的key获取cookie值</span>
<span class="token comment"># print(driver.get_cookie('PSTM'))</span>

<span class="token comment"># 删除指定的cookie</span>
driver<span class="token punctuation">.</span>delete_cookie<span class="token punctuation">(</span><span class="token string">'PSTM'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>get_cookie<span class="token punctuation">(</span><span class="token string">'PSTM'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>程序运行结果如下：</p> 
<pre><code class="prism language-python"><span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1644409502</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BA_HECTOR'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'2s04ag8l0g252g6k6o1h0794f0q'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'H_PS_PSSID'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'35105_31253_34584_35490_35246_35796_35315_26350_35724_35765_35746'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1675941902</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BAIDUID'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'ACFC052478761063262775E7A2DE4C5F:FG=1'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">3791889549</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BIDUPSID'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'ACFC052478761063DE9BEFA0F014E38F'</span><span class="token punctuation">}</span>
<span class="token comment"># 没删除之前是存在的</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">3791889549</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'PSTM'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'1644405902'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'expiry'</span><span class="token punctuation">:</span> <span class="token number">1645269902</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BD_UPN'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'123253'</span><span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span><span class="token string">'domain'</span><span class="token punctuation">:</span> <span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'httpOnly'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'BD_HOME'</span><span class="token punctuation">,</span> <span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'secure'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">}</span>
<span class="token comment"># 删除之后，返回结果None</span>
<span class="token boolean">None</span>

Process finished <span class="token keyword">with</span> exit code <span class="token number">0</span>
</code></pre> 
<h3><a id="_375"></a>页面等待</h3> 
<p>现在网页很多采用了Ajax技术，这样程序便不能确定何时某个元素完全加载出来了。如果实际页面等待时间过长导致某个dom元素还没加载，但是你的代码直接使用了这个WebElement，那么会报错NullPointer的异常。为了解决这个问题，selenium提供了两种等待方式：隐式等待，显示等待。</p> 
<p>1.隐式等待：调用driver.implicitly_wait，那么在获取任何元素之前，会先等待10秒时间。示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 8:25 PM</span>
<span class="token comment"># 文件      ：隐式等待.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.csdn.net/'</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 隐式等待10秒</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 随意指定一个id值</span>
driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'dfsfasdfasfasfsfdsafds'</span><span class="token punctuation">)</span>
</code></pre> 
<p>2.显式等待：显式等待是表明某个条件成立后才执行获取元素的操作。也可以在等待的时候指定一个最大的时间，如果超过这个时间那么就报异常错误。显式等待应该使用<strong>selenium.webdriver.support.excepted_conditions</strong>期望的条件和<strong>selenium.webdriver.support.ui.WebDriverWait</strong>来配合完成。示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 8:30 PM</span>
<span class="token comment"># 文件      ：显式等待.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token comment"># 导入显式等待模块</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token string">'user-agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36'</span><span class="token punctuation">,</span>
 <span class="token string">'cookie'</span><span class="token punctuation">:</span><span class="token string">'uuid_tt_dd=10_20562014200-1642230088053-480005; __gads=ID=6d32e6ec1ea72d65-225f830cd5cf00dc:T=1642230106:RT=1642230106:S=ALNI_MZjtH_S6lcshDmkkDY4DQKIA1Ateg; ssxmod_itna=QqAxyD0DRD9G9ixl+D+rFOep8GfDc0AWOYPhx0HAeiODUxn4iaDToPTDGq+mR4YeSQm3BDQeYGYPGCijnRbiVb1YP5QbDneG0DQKGmzxGUFD7w+e2p=qDPDbxYPDGQqDbDY8tGwDY5HDGqDnDY=XD7Ug7AmWFMjgeudDCgmpli+zWi5oDOpxfi5IW8D=0DeI7i5K+A+zWc4qeowjSEFDGSTQ2iD=; ssxmod_itna2=QqAxyD0DRD9G9ixl+D+rFOep8GfDc0AWOYPxnK3xqqDsqDBQDjbPxx=MdidGYnBa2KYHl+iq7KwCb8uGrDgeC7owaD4m0DHDa7dIL3soD+I+02APk8wU977qxT8zGTNw63Xu1Mf=8QGDStRKPzTE+Df0p/+vBjRQszRPoMqf248fp03YujRGGUWjhzlUEIjrfAC2fzOYpG3dF1RfOaGDWD7jgD7=DeqxxD==; UserName=weixin_41905135; UserInfo=5d63720898c541cfa30ae44e4525ef44; UserToken=5d63720898c541cfa30ae44e4525ef44; UserNick=Bruce_Liuxiaowei; AU=E1F; UN=weixin_41905135; BT=1642230175210; p_uid=U110000; Hm_up_6bcd52f51e9b3dce32bec4a3997715ac={"islogin":{"value":"1","scope":1},"isonline":{"value":"1","scope":1},"isvip":{"value":"1","scope":1},"uid_":{"value":"weixin_41905135","scope":1}}; Hm_ct_6bcd52f51e9b3dce32bec4a3997715ac=6525*1*10_20562014200-1642230088053-480005!5744*1*weixin_41905135; c_dl_prid=1643325931307_582254; c_dl_rid=1644247742278_429472; c_dl_fref=https://blog.csdn.net/orange_xiang/article/details/82924296; c_dl_fpage=/download/weixin_38701952/12853345; c_dl_um=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-82924296.first_rank_v2_pc_rank_v29; dc_session_id=10_1644408299161.775025; dc_sid=8287d83a7595ae0d8779cb4fcedbe31a; csrfToken=Lb84yS2_Mi8haar-7oGjC4bZ; c_first_ref=default; c_first_page=https://www.csdn.net/; c_segment=5; Hm_lvt_6bcd52f51e9b3dce32bec4a3997715ac=1644373995,1644395322,1644401531,1644409224; c_page_id=default; log_Id_click=364; c_pref=https://www.csdn.net/; c_ref=https://blog.csdn.net/weixin_41905135?spm=1000.2115.3001.5343; dc_tos=r71fd2; log_Id_pv=444; Hm_lpvt_6bcd52f51e9b3dce32bec4a3997715ac=1644410632; log_Id_view=722'</span>
<span class="token punctuation">}</span>
<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 创建driver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'https://www.csdn.net/'</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'sousuo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 参数以元组形式传入</span>
    <span class="token punctuation">)</span>
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>3、一些其他等待条件</p> 
<ul><li>presence_of_element_located:某个元素已经加载完毕</li><li>presence_of_all_element_located:网页中所有满足条件的元素加载完毕</li><li>element_to_be_cliable:某个元素可以点击了</li></ul> 
<h3><a id="_449"></a>切换页面</h3> 
<p>有时候窗口中有很多子tab页面。这时候需要切换页面的。selenium提供了一个叫做<strong>switch_to_window</strong>来进行切换，具体切换到哪个页面，可以从<strong>driver.window_handles</strong>中找到。示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/9/22 9:57 PM</span>
<span class="token comment"># 文件      ：切换页面.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

<span class="token comment"># 指定url</span>
url1 <span class="token operator">=</span> <span class="token string">'https://www.douban.com/'</span>
url2 <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url1<span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"window.open('https://www.baidu.com/')"</span><span class="token punctuation">)</span>
</code></pre> 
<p>程序运行结果如下图：</p> 
<p><img src="https://images2.imgbox.com/5d/1e/pL5BR9WY_o.png" alt=""></p> 
<p>切换到指定窗口，代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment"># 从driver.window_handlers中取出具体的窗口，driver.window_handlers是一个列表，里面是窗口句柄</span>
<span class="token comment"># 此案例只打开两个窗口，所以handles列表取‘1’</span>
driver<span class="token punctuation">.</span>switch_to_window<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>window_handles<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="ip_487"></a>设置代理ip</h3> 
<p>爬取网页的时候为避免被封掉ip地址，我们就会需要代理ip，随时更换ip地址。不同的浏览器有不同的实现方式，本文以Chrome浏览器为例。示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/10/22 9:57 AM</span>
<span class="token comment"># 文件      ：设置代理ip.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># chromedriver路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>

options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--proxy-server=http://218.75.69.50:57903"</span><span class="token punctuation">)</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">,</span> chrome_options<span class="token operator">=</span>options<span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/ip'</span><span class="token punctuation">)</span>
</code></pre> 
<p>程序运行结果如下图：</p> 
<p><img src="https://images2.imgbox.com/d1/f9/1gCLlFLh_o.png" alt=""></p> 
<h3><a id="WebElement_515"></a>WebElement元素</h3> 
<p>从网页中获取网页元素，<strong>from selenium.webdriver.remote.webelement import WebElement</strong> 类是每个获取的元素的所属类。一些常用的属性如下：</p> 
<p>1、get_attribute:获取标签某个属性值</p> 
<p>2、screenshot:获取当前页面的截图，并保存为png格式，此方法只能在driver上使用。</p> 
<p>示例代码如下：</p> 
<pre><code class="prism language-python"><span class="token comment">#_*_coding:utf-8_*_</span>
<span class="token comment"># 作者      ：liuxiaowei</span>
<span class="token comment"># 创建时间   ：2/10/22 10:28 AM</span>
<span class="token comment"># 文件      ：获取网页元素.py</span>
<span class="token comment"># IDE      ：PyCharm</span>

<span class="token comment"># 导入模块</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>webelement <span class="token keyword">import</span> WebElement

<span class="token comment"># 指定浏览器驱动的路径</span>
execute_path <span class="token operator">=</span> <span class="token string">'../使用selenium爬取动态加载的信息/chromedriver'</span>
<span class="token comment"># 创建浏览器驱动</span>
brower <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span>execute_path<span class="token punctuation">)</span>

<span class="token comment"># 指定url</span>
url <span class="token operator">=</span> <span class="token string">'http://www.baidu.com/'</span>

<span class="token comment"># 打开网页</span>
brower<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 找到搜索按钮"百度一下"</span>
baidu_Btn <span class="token operator">=</span> brower<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'su'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>baidu_Btn<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 获取按钮属性value的值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>baidu_Btn<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 保存网页截图</span>
brower<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">'baidu.png'</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行结果如下：</p> 
<p><img src="https://images2.imgbox.com/29/83/xRhwdurG_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/88/41/3DH6s6Q8_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/23cc4a29053e7d61135804e5c9ef08d5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot是什么？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6103c2068611c8ef030bd04148fc0135/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">自定义exporter使用HTTPServer实现简单basic auth</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>