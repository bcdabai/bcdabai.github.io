<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>makefile编写 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="makefile编写" />
<meta property="og:description" content="#设置当编译路径为当前文件夹所在路径 LOCAL_PATH := $(call my-dir) #清空编译环境的变量（由其他模块设置过的变量） include $(CLEAR_VARS) 其中： #BUILD_STATIC_LIBRARY：编译为静态库。 #BUILD_SHARED_LIBRARY ：编译为动态库 #BUILD_EXECUTABLE：编译为Native C可执行程序 LOCAL_PATH:=$(call my-dir) Android.mk文件首先需要指定LOCAL_PATH变量，用于查找源文件。由于一般情况下 Android.mk和需要编译的源文件在同一目录下，所以定义成如下形式：
include (CLEARVARS)...include (BUILD_XXX) Android.mk中可以定义多个编译模块，每个编译模块都是以include $(CLEAR_VARS)开始，以include $(BUILD_XXX)结束。
include $(CLEAR_VARS) CLEAR_VARS由编译系统提供，指定让GNU MAKEFILE为你清除除LOCAL_PATH以外的所有LOCAL_XXX变量， 如:LOCAL_MODULE，LOCAL_SRC_FILES，LOCAL_SHARED_LIBRARIES，LOCAL_STATIC_LIBRARIES等。
include $(BUILD_STATIC_LIBRARY)表示编译成静态库include $(BUILD_SHARED_LIBRARY)表示编译成动态库。include $(BUILD_EXECUTABLE)表示编译成可执行程序 举例： frameworks/base/libs/audioflinger/Android.mk
#编译当前目录 LOCAL_PATH:= $(call my-dir) #模块一 include $(CLEAR_VARS) ifeq ($(AUDIO_POLICY_TEST),true) ENABLE_AUDIO_DUMP := true endif LOCAL_SRC_FILES:= \ AudioHardwareGeneric.cpp \ AudioHardwareStub.cpp \ AudioHardwareInterface.cpp ifeq ($(ENABLE_AUDIO_DUMP),true) LOCAL_SRC_FILES &#43;= AudioDumpInterface.cpp LOCAL_CFLAGS &#43;= -DENABLE_AUDIO_DUMP endif LOCAL_SHARED_LIBRARIES := \ libcutils \ libutils \ libbinder \ libmedia \ libhardware_legacy ifeq ($(strip $(BOARD_USES_GENERIC_AUDIO)),true) LOCAL_CFLAGS &#43;= -DGENERIC_AUDIO endif LOCAL_MODULE:= libaudiointerface ifeq ($(BOARD_HAVE_BLUETOOTH),true) LOCAL_SRC_FILES &#43;= A2dpAudioInterface." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ef1688517e1f8f831b44ec1deef3ece5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-14T20:21:30+08:00" />
<meta property="article:modified_time" content="2017-08-14T20:21:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">makefile编写</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre class="prettyprint"><code class=" hljs vala"><span class="hljs-preprocessor">#设置当编译路径为当前文件夹所在路径</span>
LOCAL_PATH := $(call my-dir)

<span class="hljs-preprocessor">#清空编译环境的变量（由其他模块设置过的变量）</span>
include $(CLEAR_VARS)

其中：
<span class="hljs-preprocessor">#BUILD_STATIC_LIBRARY：编译为静态库。 </span>
<span class="hljs-preprocessor">#BUILD_SHARED_LIBRARY ：编译为动态库 </span>
<span class="hljs-preprocessor">#BUILD_EXECUTABLE：编译为Native C可执行程序 </span>
</code></pre> 
<h4 id="localpathcall-my-dir">LOCAL_PATH:=$(call my-dir)</h4> 
<p>Android.mk文件首先需要指定LOCAL_PATH变量，用于查找源文件。由于一般情况下 <br> Android.mk和需要编译的源文件在同一目录下，所以定义成如下形式：</p> 
<h4 id="include-clearvars-include-buildxxx">include <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" style=""> 
   
   <span class="math" id="MathJax-Span-1" style="width: 10.99em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.361em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.741em 1000em 2.814em -0.294em); top: -2.514em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-5" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-7" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 1.149em; height: 0px;"><span style="position: absolute; clip: rect(1.741em 1000em 2.629em -0.331em); top: -2.514em; left: 0.002em;"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.518em;"></span></span><span style="position: absolute; top: -2.07em; left: 0.631em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.222em;"></span></span></span></span><span class="mi" id="MathJax-Span-11" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mi" id="MathJax-Span-12" style="font-family: STIXGeneral; font-style: italic;">R</span><span class="mi" id="MathJax-Span-13" style="font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-14" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-15" style="font-family: STIXGeneral;">.</span><span class="mo" id="MathJax-Span-16" style="font-family: STIXGeneral; padding-left: 0.187em;">.</span><span class="mo" id="MathJax-Span-17" style="font-family: STIXGeneral; padding-left: 0.187em;">.</span><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.187em;">i</span><span class="mi" id="MathJax-Span-19" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mi" id="MathJax-Span-20" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-22" style="font-family: STIXGeneral; font-style: italic;">u</span><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.518em;"></span></span></span><span style="border-left: 0.002em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.982em; vertical-align: -0.233em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-1">(CLEAR_VARS) ... include </script>(BUILD_XXX)</h4> 
<p>Android.mk中可以定义多个编译模块，每个编译模块都是以<code>include $(CLEAR_VARS)</code>开始，以<code>include $(BUILD_XXX)</code>结束。</p> 
<p>include $(CLEAR_VARS) <br> <code>CLEAR_VARS</code>由编译系统提供，指定让<code>GNU MAKEFILE</code>为你清除除<code>LOCAL_PATH</code>以外的所有<code>LOCAL_XXX</code>变量， <br> 如:<code>LOCAL_MODULE，LOCAL_SRC_FILES，LOCAL_SHARED_LIBRARIES，LOCAL_STATIC_LIBRARIES</code>等。</p> 
<ul><li><code>include $(BUILD_STATIC_LIBRARY)</code>表示编译成静态库</li><li><code>include $(BUILD_SHARED_LIBRARY)</code>表示编译成动态库。</li><li><code>include $(BUILD_EXECUTABLE)</code>表示编译成可执行程序</li></ul> 
<blockquote> 
 <p>举例： <br> <code>frameworks/base/libs/audioflinger/Android.mk</code></p> 
</blockquote> 
<pre class="prettyprint"><code class="language-mk hljs perl"><span class="hljs-comment">#编译当前目录</span>
LOCAL_PATH:= <span class="hljs-variable">$(</span>call <span class="hljs-keyword">my</span>-dir)
<span class="hljs-comment">#模块一</span>
include <span class="hljs-variable">$(</span>CLEAR_VARS)  
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>AUDIO_POLICY_TEST)</span>,true)
  ENABLE_AUDIO_DUMP := true
endif
LOCAL_SRC_FILES:= \
    AudioHardwareGeneric.cpp \
    AudioHardwareStub.cpp \
    AudioHardwareInterface.cpp
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>ENABLE_AUDIO_DUMP)</span>,true)
  LOCAL_SRC_FILES += AudioDumpInterface.cpp
  LOCAL_CFLAGS += -DENABLE_AUDIO_DUMP
endif
LOCAL_SHARED_LIBRARIES := \
    libcutils \
    libutils \
    libbinder \
    libmedia \
    libhardware_legacy
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>strip <span class="hljs-variable">$(</span>BOARD_USES_GENERIC_AUDIO)</span>),true)
  LOCAL_CFLAGS += -DGENERIC_AUDIO
endif
LOCAL_MODULE:= libaudiointerface
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>BOARD_HAVE_BLUETOOTH)</span>,true)
  LOCAL_SRC_FILES += A2dpAudioInterface.cpp
  LOCAL_SHARED_LIBRARIES += liba2dp
  LOCAL_CFLAGS += -DWITH_BLUETOOTH -DWITH_A2DP
  LOCAL_C_INCLUDES += <span class="hljs-variable">$(</span>call include-path-<span class="hljs-keyword">for</span>, bluez)
endif
include <span class="hljs-variable">$(</span>BUILD_STATIC_LIBRARY)  <span class="hljs-comment">#模块一编译成静态库</span>

<span class="hljs-comment">#继续编写模块2</span>
<span class="hljs-comment">#模块二</span>
include <span class="hljs-variable">$(</span>CLEAR_VARS)  
LOCAL_SRC_FILES:=               \
    AudioPolicyManagerBase.cpp
LOCAL_SHARED_LIBRARIES := \
    libcutils \
    libutils \
    libmedia
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>TARGET_SIMULATOR)</span>,true)
 LOCAL_LDLIBS += -ldl
<span class="hljs-keyword">else</span>
 LOCAL_SHARED_LIBRARIES += libdl
endif
LOCAL_MODULE:= libaudiopolicybase
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>BOARD_HAVE_BLUETOOTH)</span>,true)
  LOCAL_CFLAGS += -DWITH_A2DP
endif
ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>AUDIO_POLICY_TEST)</span>,true)
  LOCAL_CFLAGS += -DAUDIO_POLICY_TEST
endif
</code></pre> 
<blockquote> 
 <p><strong>补充知识</strong></p> 
</blockquote> 
<pre class="prettyprint"><code class=" hljs perl">ife<span class="hljs-string">q (<span class="hljs-variable">$（</span>变量名）， 变量值 )</span>
........
<span class="hljs-keyword">else</span> ife<span class="hljs-string">q (<span class="hljs-variable">$(</span>..)</span>, ..)
.........
<span class="hljs-keyword">else</span>
.........
endif</code></pre> 
<h4 id="编译apk">编译apk</h4> 
<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-constant">LOCAL_PATH</span> <span class="hljs-symbol">:</span>= <span class="hljs-variable">$(</span>call my-dir)
<span class="hljs-keyword">include</span> <span class="hljs-variable">$(</span><span class="hljs-constant">CLEAR_VARS</span>)
<span class="hljs-comment"># Build all Java files in the java subdirectory--&gt;直译（建立在java子目录中的所有Java文件）</span>
<span class="hljs-constant">LOCAL_SRC_FILES</span> <span class="hljs-symbol">:</span>= <span class="hljs-variable">$(</span>call all-subdir-java-files)
<span class="hljs-comment"># Name of the APK to build--&gt;直译（创建APK的名称）</span>
<span class="hljs-constant">LOCAL_PACKAGE_NAME</span> <span class="hljs-symbol">:</span>= <span class="hljs-constant">LocalPackage</span>
<span class="hljs-comment"># Tell it to build an APK--&gt;直译（告诉它来建立一个APK）</span>
<span class="hljs-keyword">include</span> <span class="hljs-variable">$(</span><span class="hljs-constant">BUILD_PACKAGE</span>)</code></pre> 
<h4 id="编译一个依赖于静态java库staticjar的应用程序">编译一个依赖于静态Java库(static.jar)的应用程序</h4> 
<pre class="prettyprint"><code class=" hljs sql">LOCAL_PATH := $(<span class="hljs-operator"><span class="hljs-keyword">call</span> my-dir)
include $(CLEAR_VARS)

# List <span class="hljs-keyword">of</span> static libraries <span class="hljs-keyword">to</span> include <span class="hljs-keyword">in</span> the package
LOCAL_STATIC_JAVA_LIBRARIES := static-library

# Build <span class="hljs-keyword">all</span> java files <span class="hljs-keyword">in</span> the java subdirectory
LOCAL_SRC_FILES := $(<span class="hljs-keyword">call</span> <span class="hljs-keyword">all</span>-subdir-java-files)

# Name <span class="hljs-keyword">of</span> the APK <span class="hljs-keyword">to</span> build
LOCAL_PACKAGE_NAME := LocalPackage

# Tell it <span class="hljs-keyword">to</span> build an APK
include $(BUILD_PACKAGE)</span></code></pre> 
<h4 id="编译一个需要用平台的key签名的应用程序">编译一个需要用平台的key签名的应用程序</h4> 
<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-constant">LOCAL_PATH</span> <span class="hljs-symbol">:</span>= <span class="hljs-variable">$(</span>call my-dir)
<span class="hljs-keyword">include</span> <span class="hljs-variable">$(</span><span class="hljs-constant">CLEAR_VARS</span>)

<span class="hljs-comment"># Build all java files in the java subdirectory</span>
<span class="hljs-constant">LOCAL_SRC_FILES</span> <span class="hljs-symbol">:</span>= <span class="hljs-variable">$(</span>call all-subdir-java-files)

<span class="hljs-comment"># Name of the APK to build</span>
<span class="hljs-constant">LOCAL_PACKAGE_NAME</span> <span class="hljs-symbol">:</span>= <span class="hljs-constant">LocalPackage</span>

<span class="hljs-constant">LOCAL_CERTIFICATE</span> <span class="hljs-symbol">:</span>= platform

<span class="hljs-comment"># Tell it to build an APK</span>
<span class="hljs-keyword">include</span> <span class="hljs-variable">$(</span><span class="hljs-constant">BUILD_PACKAGE</span>)</code></pre> 
<h4 id="编译一个需要用特定key前面的应用程序">编译一个需要用特定key前面的应用程序</h4> 
<pre class="prettyprint"><code class=" hljs ruby"><span class="hljs-constant">LOCAL_PATH</span> <span class="hljs-symbol">:</span>= <span class="hljs-variable">$(</span>call my-dir)
<span class="hljs-keyword">include</span> <span class="hljs-variable">$(</span><span class="hljs-constant">CLEAR_VARS</span>)

<span class="hljs-comment"># Build all java files in the java subdirectory</span>
<span class="hljs-constant">LOCAL_SRC_FILES</span> <span class="hljs-symbol">:</span>= <span class="hljs-variable">$(</span>call all-subdir-java-files)

<span class="hljs-comment"># Name of the APK to build</span>
<span class="hljs-constant">LOCAL_PACKAGE_NAME</span> <span class="hljs-symbol">:</span>= <span class="hljs-constant">LocalPackage</span>

<span class="hljs-constant">LOCAL_CERTIFICATE</span> <span class="hljs-symbol">:</span>= vendor/example/certs/app

<span class="hljs-comment"># Tell it to build an APK</span>
<span class="hljs-keyword">include</span> <span class="hljs-variable">$(</span><span class="hljs-constant">BUILD_PACKAGE</span>)</code></pre> 
<p>“`</p> 
<p>(8)添加一个预编译应用程序 <br> LOCAL_PATH := <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" style=""> 
   
   <span class="math" id="MathJax-Span-25" style="width: 9.123em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.619em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.638em 1000em 2.896em -0.5em); top: -2.513em; left: 0.003em;"><span class="mrow" id="MathJax-Span-26"><span class="mo" id="MathJax-Span-27" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-28" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-31" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral; padding-left: 0.255em;">−</span><span class="mi" id="MathJax-Span-35" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.255em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-36" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-38" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-40" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mi" id="MathJax-Span-41" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-42" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-43" style="font-family: STIXGeneral; font-style: italic;">u</span><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-2">(call my-dir)  
  include </script>(CLEAR_VARS)</p> 
<p># Module name should match apk name to be installed. <br> LOCAL_MODULE := LocalModuleName <br> LOCAL_SRC_FILES := <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" style=""> 
   
   <span class="math" id="MathJax-Span-46" style="width: 37.991em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.852em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.638em 1000em 2.896em -0.5em); top: -2.513em; left: 0.003em;"><span class="mrow" id="MathJax-Span-47"><span class="mo" id="MathJax-Span-48" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-50" style="font-family: STIXGeneral; font-style: italic;">O</span><span class="mi" id="MathJax-Span-51" style="font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="msubsup" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 1.261em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-54" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.569em;"><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral; font-style: italic;">O</span><span class="mi" id="MathJax-Span-57" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mi" id="MathJax-Span-58" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-59" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-60" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-61" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral;">.</span><span class="mi" id="MathJax-Span-63" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.192em;">a</span><span class="mi" id="MathJax-Span-64" style="font-family: STIXGeneral; font-style: italic;">p</span><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral; font-style: italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-67" style="font-family: STIXGeneral; font-style: italic;">O</span><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 1.261em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-71" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.569em;"><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral; font-style: italic;">O</span><span class="mi" id="MathJax-Span-74" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mi" id="MathJax-Span-75" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-76" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 1.198em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-78" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.632em;"><span class="mi" id="MathJax-Span-79" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-80" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mi" id="MathJax-Span-82" style="font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-83" style="font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-84" style="font-family: STIXGeneral; padding-left: 0.318em;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-85" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.318em;">A</span><span class="mi" id="MathJax-Span-86" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral; font-style: italic;">P</span><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-90" style="font-family: STIXGeneral; font-style: italic;">O</span><span class="mi" id="MathJax-Span-91" style="font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="msubsup" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 1.261em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-94" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.569em;"><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-96" style="font-family: STIXGeneral; font-style: italic;">O</span><span class="mi" id="MathJax-Span-97" style="font-family: STIXGeneral; font-style: italic;">D</span><span class="mi" id="MathJax-Span-98" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-99" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 1.072em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.632em;"><span class="mi" id="MathJax-Span-102" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-105" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-107" style="font-family: STIXGeneral; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mo" id="MathJax-Span-108" style="font-family: STIXGeneral; padding-left: 0.318em;">:<span style="font-family: STIXGeneral; font-style: normal; font-weight: normal;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-3">(LOCAL_MODULE).apk  
  LOCAL_MODULE_CLASS := APPS  
  LOCAL_MODULE_SUFFIX := </script>(COMMON_ANDROID_PACKAGE_SUFFIX)</p> 
<p>include $(BUILD_PREBUILT)</p> 
<p>(9)添加一个静态JAVA库 <br> LOCAL_PATH := <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" style=""> 
   
   <span class="math" id="MathJax-Span-109" style="width: 9.123em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.619em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.638em 1000em 2.896em -0.5em); top: -2.513em; left: 0.003em;"><span class="mrow" id="MathJax-Span-110"><span class="mo" id="MathJax-Span-111" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-112" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="mi" id="MathJax-Span-114" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-115" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-116" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mi" id="MathJax-Span-117" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-118" style="font-family: STIXGeneral; padding-left: 0.255em;">−</span><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.255em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-121" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-122" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-124" style="font-family: STIXGeneral; font-style: italic;">n</span><span class="mi" id="MathJax-Span-125" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mi" id="MathJax-Span-126" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral; font-style: italic;">u</span><span class="mi" id="MathJax-Span-128" style="font-family: STIXGeneral; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.07em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-4">(call my-dir)  
  include </script>(CLEAR_VARS)</p> 
<p># Build all java files in the java subdirectory <br> LOCAL_SRC_FILES := $(call all-subdir-java-files)</p> 
<p># Any libraries that this library depends on <br> LOCAL_JAVA_LIBRARIES := android.test.runner</p> 
<p># The name of the jar file to create <br> LOCAL_MODULE := sample</p> 
<p># Build a static jar file. <br> include $(BUILD_STATIC_JAVA_LIBRARY)</p> 
<p>(10)Android.mk的编译模块中间可以定义相关的编译内容，也就是指定相关的变量如下： <br> LOCAL_AAPT_FLAGS</p> 
<p>LOCAL_ACP_UNAVAILABLE </p> 
<p>LOCAL_ADDITIONAL_JAVA_DIR </p> 
<p>LOCAL_AIDL_INCLUDES </p> 
<p>LOCAL_ALLOW_UNDEFINED_SYMBOLS </p> 
<p>LOCAL_ARM_MODE </p> 
<p>LOCAL_ASFLAGS </p> 
<p>LOCAL_ASSET_DIR </p> 
<p>LOCAL_ASSET_FILES 在Android.mk文件中编译应用程序(BUILD_PACKAGE)时设置此变量，表示资源文件， <br> 通常会定义成LOCAL_ASSET_FILES += $(call find-subdir-assets)</p> 
<p>LOCAL_BUILT_MODULE_STEM <br> LOCAL_C_INCLUDES 额外的C/C++编译头文件路径，用LOCAL_PATH表示本文件所在目录 <br> 举例如下： <br> LOCAL_C_INCLUDES += extlibs/zlib-1.2.3 <br> LOCAL_C_INCLUDES += $(LOCAL_PATH)/src </p> 
<p>LOCAL_CC 指定C编译器</p> 
<p>LOCAL_CERTIFICATE 签名认证</p> 
<p>LOCAL_CFLAGS 为C/C++编译器定义额外的标志(如宏定义)，举例：LOCAL_CFLAGS += -DLIBUTILS_NATIVE=1</p> 
<p>LOCAL_CLASSPATH </p> 
<p>LOCAL_COMPRESS_MODULE_SYMBOLS </p> 
<p>LOCAL_COPY_HEADERS install应用程序时需要复制的头文件，必须同时定义LOCAL_COPY_HEADERS_TO</p> 
<p>LOCAL_COPY_HEADERS_TO install应用程序时复制头文件的目的路径</p> 
<p>LOCAL_CPP_EXTENSION 如果你的C++文件不是以cpp为文件后缀，你可以通过LOCAL_CPP_EXTENSION指定C++文件后缀名 <br> 如：LOCAL_CPP_EXTENSION := .cc <br> 注意统一模块中C++文件后缀必须保持一致。</p> 
<p>LOCAL_CPPFLAGS 传递额外的标志给C++编译器，如：LOCAL_CPPFLAGS += -ffriend-injection</p> 
<p>LOCAL_CXX 指定C++编译器</p> 
<p>LOCAL_DX_FLAGS</p> 
<p>LOCAL_EXPORT_PACKAGE_RESOURCES</p> 
<p>LOCAL_FORCE_STATIC_EXECUTABLE 如果编译的可执行程序要进行静态链接(执行时不依赖于任何动态库)，则设置LOCAL_FORCE_STATIC_EXECUTABLE:=true <br> 目前只有libc有静态库形式，这个只有文件系统中/sbin目录下的应用程序会用到，这个目录下的应用程序在运行时通常 <br> 文件系统的其它部分还没有加载，所以必须进行静态链接。</p> 
<p>LOCAL_GENERATED_SOURCES</p> 
<p>LOCAL_INSTRUMENTATION_FOR</p> 
<p>LOCAL_INSTRUMENTATION_FOR_PACKAGE_NAME</p> 
<p>LOCAL_INTERMEDIATE_SOURCES</p> 
<p>LOCAL_INTERMEDIATE_TARGETS</p> 
<p>LOCAL_IS_HOST_MODULE</p> 
<p>LOCAL_JAR_MANIFEST</p> 
<p>LOCAL_JARJAR_RULES</p> 
<p>LOCAL_JAVA_LIBRARIES 编译java应用程序和库的时候指定包含的java类库，目前有core和framework两种 <br> 多数情况下定义成：LOCAL_JAVA_LIBRARIES := core framework <br> 注意LOCAL_JAVA_LIBRARIES不是必须的，而且编译APK时不允许定义(系统会自动添加)</p> 
<p>LOCAL_JAVA_RESOURCE_DIRS </p> 
<p>LOCAL_JAVA_RESOURCE_FILES </p> 
<p>LOCAL_JNI_SHARED_LIBRARIES </p> 
<p>LOCAL_LDFLAGS 传递额外的参数给连接器(务必注意参数的顺序)</p> 
<p>LOCAL_LDLIBS 为可执行程序或者库的编译指定额外的库，指定库以”-lxxx”格式，举例： <br> LOCAL_LDLIBS += -lcurses -lpthread <br> LOCAL_LDLIBS += -Wl,-z,origin </p> 
<p>LOCAL_MODULE 生成的模块的名称(注意应用程序名称用LOCAL_PACKAGE_NAME而不是LOCAL_MODULE)</p> 
<p>LOCAL_MODULE_PATH 生成模块的路径</p> 
<p>LOCAL_MODULE_STEM </p> 
<p>LOCAL_MODULE_TAGS 生成模块的标记 </p> 
<p>LOCAL_NO_DEFAULT_COMPILER_FLAGS </p> 
<p>LOCAL_NO_EMMA_COMPILE </p> 
<p>LOCAL_NO_EMMA_INSTRUMENT </p> 
<p>LOCAL_NO_STANDARD_LIBRARIES </p> 
<p>LOCAL_OVERRIDES_PACKAGES </p> 
<p>LOCAL_PACKAGE_NAME APK应用程序的名称 </p> 
<p>LOCAL_POST_PROCESS_COMMAND</p> 
<p>LOCAL_PREBUILT_EXECUTABLES 预编译including <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" style=""> 
   
   <span class="math" id="MathJax-Span-130" style="width: 10.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.318em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.513em 1000em 2.896em -0.5em); top: -2.513em; left: 0.003em;"><span class="mrow" id="MathJax-Span-131"><span class="mo" id="MathJax-Span-132" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-133" style="font-family: STIXGeneral; font-style: italic;">B</span><span class="mi" id="MathJax-Span-134" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-136" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 1.198em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-138" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.695em;"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-140" style="font-family: STIXGeneral; font-style: italic;">R</span><span class="mi" id="MathJax-Span-141" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-142" style="font-family: STIXGeneral; font-style: italic;">B</span><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-144" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-145" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-146" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mo" id="MathJax-Span-147" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mo" id="MathJax-Span-150"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 94%; font-style: normal; font-weight: normal;'>或</span></span></span></span><span class="texatom" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="mo" id="MathJax-Span-153"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 94%; font-style: normal; font-weight: normal;'>者</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-5">(BUILD_PREBUILT)或者</script>(BUILD_HOST_PREBUILT)时所用,指定需要复制的可执行文件</p> 
<p>LOCAL_PREBUILT_JAVA_LIBRARIES </p> 
<p>LOCAL_PREBUILT_LIBS 预编译including <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" style=""> 
   
   <span class="math" id="MathJax-Span-154" style="width: 10.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.318em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.513em 1000em 2.896em -0.5em); top: -2.513em; left: 0.003em;"><span class="mrow" id="MathJax-Span-155"><span class="mo" id="MathJax-Span-156" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-157" style="font-family: STIXGeneral; font-style: italic;">B</span><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-159" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 1.198em; height: 0px;"><span style="position: absolute; clip: rect(1.701em 1000em 2.708em -0.563em); top: -2.513em; left: 0.003em;"><span class="mi" id="MathJax-Span-162" style="font-family: STIXGeneral; font-style: italic;">D</span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span><span style="position: absolute; top: -2.072em; left: 0.695em;"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">P</span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span></span><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral; font-style: italic;">R</span><span class="mi" id="MathJax-Span-165" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral; font-style: italic;">B</span><span class="mi" id="MathJax-Span-167" style="font-family: STIXGeneral; font-style: italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mi" id="MathJax-Span-169" style="font-family: STIXGeneral; font-style: italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.066em;"></span></span><span class="mo" id="MathJax-Span-171" style="font-family: STIXGeneral;">)</span><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="mo" id="MathJax-Span-174"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 94%; font-style: normal; font-weight: normal;'>或</span></span></span></span><span class="texatom" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="mo" id="MathJax-Span-177"><span style='font-family: STIXGeneral, "Arial Unicode MS", serif; font-size: 94%; font-style: normal; font-weight: normal;'>者</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.519em;"></span></span></span><span style="border-left: 0.003em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.263em;"></span></span> 
  </span><script type="math/tex" id="MathJax-Element-6">(BUILD_PREBUILT)或者</script>(BUILD_HOST_PREBUILT)时所用, 指定需要复制的库.</p> 
<p>LOCAL_PREBUILT_OBJ_FILES </p> 
<p>LOCAL_PREBUILT_STATIC_JAVA_LIBRARIES </p> 
<p>LOCAL_PRELINK_MODULE 是否需要预连接处理(默认需要，用来做动态库优化)</p> 
<p>LOCAL_REQUIRED_MODULES 指定模块运行所依赖的模块(模块安装时将会同步安装它所依赖的模块)</p> 
<p>LOCAL_RESOURCE_DIR</p> 
<p>LOCAL_SDK_VERSION</p> 
<p>LOCAL_SHARED_LIBRARIES 可链接动态库</p> 
<p>LOCAL_SRC_FILES 编译源文件</p> 
<p>LOCAL_STATIC_JAVA_LIBRARIES </p> 
<p>LOCAL_STATIC_LIBRARIES 可链接静态库 </p> 
<p>LOCAL_UNINSTALLABLE_MODULE </p> 
<p>LOCAL_UNSTRIPPED_PATH</p> 
<p>LOCAL_WHOLE_STATIC_LIBRARIES 指定模块所需要载入的完整静态库(这些精通库在链接是不允许链接器删除其中无用的代码)</p> 
<p>LOCAL_YACCFLAGS</p> 
<p>OVERRIDE_BUILT_MODULE_PATH</p> 
<p>接下来我们详细看一下android里的makefile文件</p> 
<p>android最顶层的目录结构如下： <br> . <br> |– Makefile （全局的Makefile） <br> |– bionic （Bionic含义为仿生，这里面是一些基础的库的源代码） <br> |– bootloader （引导加载器） <br> |– build （build目录中的内容不是目标所用的代码，而是编译和配置所需要的脚本和工具） <br> |– dalvik （JAVA虚拟机） <br> |– development （程序开发所需要的模板和工具） <br> |– external （目标机器使用的一些库） <br> |– frameworks （应用程序的框架层） <br> |– hardware （与硬件相关的库） <br> |– kernel （Linux2.6的源代码） <br> |– packages （Android的各种应用程序） <br> |– prebuilt （Android在各种平台下编译的预置脚本） <br> |– recovery （与目标的恢复功能相关） <br> `– system （Android的底层的一些库） <br> 本文将要分析的是build目录下的makefile和shell文件,android的代码是1.5的版本。 <br> 主要的目录结构如下： <br> 1.makefile入门 <br> 1.1 makefile helloworld <br> 1.2 用makefile构建交叉编译环境 <br> 1.3 makefile里面的一些技巧 <br> 2.android makefile分析 <br> 2.1 android shell分析 <br> 2.2 android build下的各个makefile分析 <br> 3. android其他目录的android.mk分析</p> 
<p>大家先通过网络的一些文章来了解一下andoroid的makefile。 <br> 1. <br> Android build system <br> 2. <br> Android Building System 分析 <br> 3. <br> Android Build System(介绍使用) <br> 1.1 makefile helloworld</p> 
<p>Makefile的规则如下：</p> 
<p>target … : prerequisites … </p> 
<p>command … …</p> 
<p>target可以是一个目标文件，也可以是Object File（例如helloworld.obj），也可以是执行文件和标签。</p> 
<p>prerequisites就是生成target所需要的文件或是目标。</p> 
<p>command <br> 也就是要达到target这个目标所需要执行的命令。这里没有说“使用生成target所需要执行的命令”，是因为target可能是标签。需要注意的是 <br> command前面必须是TAB键，而不是空格，因此喜欢在编辑器里面将TAB键用空格替换的人需要特别小心了。</p> 
<p>我们写程序一般喜欢写helloworld，当我们写了一个c的helloworld之后，我们该如何写helloworld来编译helloworld.c呢？</p> 
<p>下面就是编译helloworld的makefile。</p> 
<p>helloworld : helloworld.o</p> 
<pre><code>cc -o helloworld helloworld .o
</code></pre> 
<p>helloworld.o : helloworld.c </p> 
<pre><code>cc -c main.c
</code></pre> 
<p>clean:</p> 
<pre><code>rm helloworld helloworl.o
</code></pre> 
<p>之后我们执行make就可以编译helloworld.c了，执行make clean就可以清除编译结果了（其实就是删除helloworld helloworl.o）。</p> 
<p>可能有人问为什么执行make就会生成helloworld呢？这得从make的默认处理说起：make将makefile的第一个target作为作为最终的 <br> target，凡是这个规则依赖的规则都将被执行，否则就不会执行。所以在执行make的时候，clean这个规则就没有被执行。</p> 
<p>上面的是最简单的makefile，复杂点makefile就开始使用高级点的技巧了，例如使用变量，使用隐式规则，执行负责点shell命令（常见的是字符串处理和文件处理等），这里不打算介绍这些规则，后面在分析android的makefile时会结合具体代码进行具体分析，大家可以先看看陈皓的《跟我一起写makefile》来了解了解。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4d5d067b4f2a160f26a3509677a0e2cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python：whl文件是神？如何安装whl文件？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f3b4f1062081c1204c60afaf91cadfc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PC端 微信支付 扫码之后页面跳转处理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>