<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Nacos入门使用教程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Nacos入门使用教程" />
<meta property="og:description" content="Nacos介绍 Nacos /nɑ:kəʊs/ 是 Dynamic Naming and Configuration Service的首字母简称，一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。
在这个介绍中，可以看出Nacos至少有三个核心功能：
动态服务发现配置管理服务管理 后续会分别来介绍这三个功能是怎么回事。
下载和解压 教程制作时，Nacos的最新发行版为2.1.1 (Aug 8th, 2022)（本教程就是基于这个版本），官方当前推荐的稳定版本为2.0.3。
查看最新Nacos发行版：https://github.com/alibaba/nacos/releases
并且可以在此网页上下载安装包：
下载完了之后进行解压，解压之后的目录为：
bin目录下是启动和停止的脚本conf目录下是Nacos的配置文件target目录下是Nacos的jar包（启动脚本中其实就是运行的这个jar包，停止脚步中是直接kill到进程） 启动 解压完之后就可以启动Nacos了，Nacos支持单机和集群，默认是以集群模式启动，通过添加-m standalone就会以单机模式启动。
Linux/Unix/Mac 启动命令(standalone代表着单机模式运行，非集群模式):
sh startup.sh -m standalone
如果您使用的是ubuntu系统，或者运行脚本报错提示[[符号找不到，可尝试如下运行：
bash startup.sh -m standalone
Windows 启动命令(standalone代表着单机模式运行，非集群模式):
startup.cmd -m standalone
启动日志
可以发现，默认情况下Nacos占用了8848端口。
我们可以访问http://localhost:8848/nacos，来访问Nacos：
默认的用户名和密码为：nacos/nacos
登录进来后：
这个网页相当于nacos的管理台，有：
配置管理服务管理权限控制命名空间集群管理 配置管理 配置，其实就是一个key：value，比如
spring.datasource.username=zhouyu spring.datasource.password=123456 并且我们通常会把这些配置写在application.properties或application.yml文件中，当时通过这种方式一定配置发生了改变就需要重启应用，并且通过这种方式配置的配置项仅限于当前应用，而不能做到多个应用共享。
那么nacos的配置管理功能就是来解决这些问题的，我们可以直接通过nacos管理台来新增配置，并且这些配置能够被多个应用给使用到。
新建配置 新建配置时可以指定：
Data ID：相当于一个配置文件，比如相当于application.properties，或者application-dev.properties，不过要注意的是，我们在某个项目中使用application.properties文件中，那个application表示的就是当前应用，那我们在nacos进行配置时，就要尽可能的取一些有含义的Data ID，比如user.properties（表示用户应用的配置），order.properties（表示订单应用的配置），common.properties（表示多个应用共享的配置）。Group：在nacos中，一个Data ID，也就是一个或多个配置文件可以归类到同一个Group中，Group的作用就是用来区分Data ID相同的情况，不同的应用或中间件使用了相同的Data ID时就可以通过Group来进行区分，默认为DEFAULT_GROUP配置内容：写具体的配置项，可以用properties的格式，也可以用yaml的格式 比如：
拉取配置 在nacos中新建完配置后，那作为一个SpringBoot应用我们如何来获取配置呢？
Java SDK 首先，我们可以直接使用Nacos提供的Java SDK来获取配置。
首先在项目中，添加如下依赖：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/02a93970ff9b44b1925c70efdaafb035/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-04T21:26:45+08:00" />
<meta property="article:modified_time" content="2022-09-04T21:26:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Nacos入门使用教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Nacos_0"></a>Nacos介绍</h3> 
<p>Nacos /nɑ:kəʊs/ 是 Dynamic Naming and Configuration Service的首字母简称，一个更易于构建云原生应用的<strong>动态服务发现</strong>、<strong>配置管理</strong>和<strong>服务管理</strong>平台。</p> 
<p>在这个介绍中，可以看出Nacos至少有三个核心功能：</p> 
<ol><li><strong>动态服务发现</strong></li><li><strong>配置管理</strong></li><li><strong>服务管理</strong></li></ol> 
<p>后续会分别来介绍这三个功能是怎么回事。</p> 
<h3><a id="_11"></a>下载和解压</h3> 
<p>教程制作时，Nacos的最新发行版为<a href="https://github.com/alibaba/nacos/releases/tag/2.1.1">2.1.1 (Aug 8th, 2022)</a>（本教程就是基于这个版本），官方当前推荐的稳定版本为2.0.3。</p> 
<p>查看最新Nacos发行版：<a href="https://github.com/alibaba/nacos/releases">https://github.com/alibaba/nacos/releases</a></p> 
<p>并且可以在此网页上下载安装包：<br> <img src="https://images2.imgbox.com/85/9b/nEcxjUjs_o.png" alt="image.png"></p> 
<p>下载完了之后进行解压，解压之后的目录为：<br> <img src="https://images2.imgbox.com/24/25/MzUYb8SQ_o.png" alt="image.png"></p> 
<ol><li>bin目录下是启动和停止的脚本</li><li>conf目录下是Nacos的配置文件</li><li>target目录下是Nacos的jar包（启动脚本中其实就是运行的这个jar包，停止脚步中是直接kill到进程）</li></ol> 
<h3><a id="_26"></a>启动</h3> 
<p>解压完之后就可以启动Nacos了，Nacos支持单机和集群，默认是以集群模式启动，通过添加-m standalone就会以单机模式启动。</p> 
<h4><a id="LinuxUnixMac_28"></a>Linux/Unix/Mac</h4> 
<p>启动命令(standalone代表着单机模式运行，非集群模式):<br> <code>sh startup.sh -m standalone</code></p> 
<p>如果您使用的是ubuntu系统，或者运行脚本报错提示[[符号找不到，可尝试如下运行：<br> <code>bash startup.sh -m standalone</code></p> 
<h4><a id="Windows_34"></a>Windows</h4> 
<p>启动命令(standalone代表着单机模式运行，非集群模式):<br> <code>startup.cmd -m standalone</code></p> 
<p>启动日志<br> <img src="https://images2.imgbox.com/2c/10/srScT8tK_o.png" alt="image.png"></p> 
<p>可以发现，默认情况下Nacos占用了8848端口。</p> 
<p>我们可以访问<a href="http://localhost:8848/nacos" rel="nofollow">http://localhost:8848/nacos</a>，来访问Nacos：</p> 
<p><img src="https://images2.imgbox.com/79/87/yiKTVY3D_o.png" alt="image.png"></p> 
<p><strong>默认的用户名和密码为：nacos/nacos</strong></p> 
<p>登录进来后：<br> <img src="https://images2.imgbox.com/57/7d/TJORRU7w_o.png" alt="image.png"></p> 
<p>这个网页相当于nacos的管理台，有：</p> 
<ol><li>配置管理</li><li>服务管理</li><li>权限控制</li><li>命名空间</li><li>集群管理</li></ol> 
<h3><a id="_60"></a>配置管理</h3> 
<p>配置，其实就是一个key：value，比如</p> 
<pre><code class="prism language-java">spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>username<span class="token operator">=</span>zhouyu
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token number">123456</span>
</code></pre> 
<p>并且我们通常会把这些配置写在application.properties或application.yml文件中，当时通过这种方式一定配置发生了改变就需要重启应用，并且通过这种方式配置的配置项仅限于当前应用，而不能做到多个应用共享。</p> 
<p>那么nacos的配置管理功能就是来解决这些问题的，我们可以直接通过nacos管理台来新增配置，并且这些配置能够被多个应用给使用到。</p> 
<h4><a id="_69"></a>新建配置</h4> 
<p>新建配置时可以指定：</p> 
<ol><li>Data ID：相当于一个配置文件，比如相当于application.properties，或者application-dev.properties，不过要注意的是，我们在某个项目中使用application.properties文件中，那个application表示的就是当前应用，那我们在nacos进行配置时，就要尽可能的取一些有含义的Data ID，比如user.properties（表示用户应用的配置），order.properties（表示订单应用的配置），common.properties（表示多个应用共享的配置）。</li><li>Group：在nacos中，一个Data ID，也就是一个或多个配置文件可以归类到同一个Group中，Group的作用就是用来区分Data ID相同的情况，不同的应用或中间件使用了相同的Data ID时就可以通过Group来进行区分，默认为DEFAULT_GROUP</li><li>配置内容：写具体的配置项，可以用properties的格式，也可以用yaml的格式</li></ol> 
<p>比如：<br> <img src="https://images2.imgbox.com/db/05/SCxieg5A_o.png" alt="image.png"></p> 
<h4><a id="_80"></a>拉取配置</h4> 
<p>在nacos中新建完配置后，那作为一个SpringBoot应用我们如何来获取配置呢？</p> 
<h5><a id="Java_SDK_83"></a>Java SDK</h5> 
<p>首先，我们可以直接使用Nacos提供的Java SDK来获取配置。</p> 
<p>首先在项目中，添加如下依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>nacos-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>然后可以使用如下代码来获取nacos中的配置：</p> 
<pre><code class="prism language-java"><span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">String</span> serverAddr <span class="token operator">=</span> <span class="token string">"localhost:8848"</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> dataId <span class="token operator">=</span> <span class="token string">"user.properties"</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> group <span class="token operator">=</span> <span class="token string">"DEFAULT_GROUP"</span><span class="token punctuation">;</span>
	
	<span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"serverAddr"</span><span class="token punctuation">,</span> serverAddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">ConfigService</span> configService <span class="token operator">=</span> <span class="token class-name">NacosFactory</span><span class="token punctuation">.</span><span class="token function">createConfigService</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> content <span class="token operator">=</span> configService<span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NacosException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO Auto-generated catch block</span>
	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ol><li>serverAddr：nacos的地址</li><li>dataId：想要获取的配置文件的名字</li><li>group：分组</li></ol> 
<p>在Java SDK中，除开有获取配置的API，同时也提供了新增、删除、监听配置的API。</p> 
<p>我们可以通过如下代码来监听配置的变化：</p> 
<pre><code class="prism language-java"><span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">String</span> serverAddr <span class="token operator">=</span> <span class="token string">"localhost:8848"</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> dataId <span class="token operator">=</span> <span class="token string">"user.properties"</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> group <span class="token operator">=</span> <span class="token string">"DEFAULT_GROUP"</span><span class="token punctuation">;</span>
	<span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"serverAddr"</span><span class="token punctuation">,</span> serverAddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">ConfigService</span> configService <span class="token operator">=</span> <span class="token class-name">NacosFactory</span><span class="token punctuation">.</span><span class="token function">createConfigService</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> content <span class="token operator">=</span> configService<span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
	configService<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Listener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveConfigInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> configInfo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"recieve1:"</span> <span class="token operator">+</span> configInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">public</span> <span class="token class-name">Executor</span> <span class="token function">getExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 测试让主线程不退出，因为订阅配置是守护线程，主线程退出守护线程就会退出。 正式代码中无需下面代码</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
			<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NacosException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// TODO Auto-generated catch block</span>
	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>剩余API，大家可以直接参考官网：<a href="https://nacos.io/zh-cn/docs/sdk.html" rel="nofollow">https://nacos.io/zh-cn/docs/sdk.html</a></p> 
<h5><a id="Spring_157"></a>Spring</h5> 
<p>在真正开发时，我们不太会通过Java SDK的方式来拉取nacos中的配置，那Nacos有没有针对Spring提供一些比较好用的注解或API呢？</p> 
<p>当然是有的。</p> 
<p>增加一下依赖（不再需要nacos-client依赖了）</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>nacos<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>nacos<span class="token operator">-</span>spring<span class="token operator">-</span>context<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.1</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<p>我们可以按以下方式来配置Spring容器：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableNacosConfig</span><span class="token punctuation">(</span>globalProperties <span class="token operator">=</span> <span class="token annotation punctuation">@NacosProperties</span><span class="token punctuation">(</span>serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8848"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@NacosPropertySource</span><span class="token punctuation">(</span>dataId <span class="token operator">=</span> <span class="token string">"user.properties"</span><span class="token punctuation">,</span> autoRefreshed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">"com.zhouyu"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>
</code></pre> 
<p>很明显，通过@EnableNacosConfig注解定义了nacos的地址，通过@NacosPropertySource表示想要拉取的dataId，并且设置自动刷新（也就是配置发生了改变则会自动生效）。</p> 
<p>那如何使用某一个具体的配置项呢：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@NacosValue</span><span class="token punctuation">(</span><span class="token string">"${spring.datasource.username}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>可以通过@NacosValue来使用某一具体的配置项，<strong>那@Value行不行呢？也是可以的。</strong></p> 
<p><strong>之所以可以，原因是@EnableNacosConfig注解会负责把指定的dataId的配置项拉取到应用，并封装为PropertySource对象添加到Environment对象中，所以@Value也能读取到相应的配置项。</strong></p> 
<h5><a id="SpringBoot_201"></a>SpringBoot</h5> 
<p>如果我们使用SpringBoot，那则可以比Spring更加简单。</p> 
<p>首先引入依赖：</p> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>nacos<span class="token operator">-</span>config<span class="token operator">-</span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">0.2</span><span class="token number">.12</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<p>然后在application.properties中配置nacos的地址：</p> 
<pre><code class="prism language-properties">nacos.config.server-addr=127.0.0.1:8848
</code></pre> 
<p>然后：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@NacosPropertySource</span><span class="token punctuation">(</span>dataId <span class="token operator">=</span> <span class="token string">"user.properties"</span><span class="token punctuation">,</span> autoRefreshed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserApplication</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ConfigurableApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">UserApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">UserService</span> userService <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">UserService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userService<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>依旧使用@NacosPropertySource来指定要拉取的配置dataId即可，就可以使用@Value或@NacosValue来获取某个具体的配置项了。</p> 
<p>那有同学可能会想到，我们可不可以直接在application.properties文件中来配置dataid呢？确实可以：</p> 
<pre><code class="prism language-properties">nacos.config.server-addr=127.0.0.1:8848
nacos.config.data-id=user.properties
nacos.config.bootstrap.enable=true
</code></pre> 
<p>不过要注意，一定得把nacos.config.bootstrap.enable设置为true，不然是不行的。</p> 
<h5><a id="SpringCloud_245"></a>SpringCloud</h5> 
<p>如果我们是用SpringCloud，那将比SpringBoot更加简单。</p> 
<p>引入依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.8.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>然后在boostrap.properties文件中配置：</p> 
<pre><code class="prism language-properties">spring.application.name=user
spring.cloud.nacos.server-addr=127.0.0.1:8848
</code></pre> 
<p>就可以了，因为会自动去连接nacos并获取dataid为user.properties的配置了。</p> 
<p>到这里，我们大概知道了Nacos的配置管理是怎么用的了，接下来我们再来介绍一些配置管理更高级的功能。</p> 
<h4><a id="profile_267"></a>按profile拉取配置</h4> 
<p>在使用spring-cloud-starter-alibaba-nacos-config时，我们除开可以配置spring.cloud.nacos.config.server-addr外，还可以配置：</p> 
<ol><li>spring.cloud.nacos.config.group：默认为"DEFAULT_GROUP"</li><li>spring.cloud.nacos.config.file-extension：默认为"properties"</li><li>spring.cloud.nacos.config.prefix：默认为${spring.application.name}</li></ol> 
<p>所以，默认情况下，会拉取"DEFAULT_GROUP"组下dataid为user.properties的配置，不过通过看源码：</p> 
<pre><code class="prism language-java"><span class="token comment">// com.alibaba.cloud.nacos.client.NacosPropertySourceLocator#loadApplicationConfiguration</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">loadApplicationConfiguration</span><span class="token punctuation">(</span>
	<span class="token class-name">CompositePropertySource</span> compositePropertySource<span class="token punctuation">,</span> <span class="token class-name">String</span> dataIdPrefix<span class="token punctuation">,</span>
	<span class="token class-name">NacosConfigProperties</span> properties<span class="token punctuation">,</span> <span class="token class-name">Environment</span> environment<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">String</span> fileExtension <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getFileExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> nacosGroup <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 1</span>
	<span class="token comment">// load directly once by default</span>
	<span class="token function">loadNacosDataIfPresent</span><span class="token punctuation">(</span>compositePropertySource<span class="token punctuation">,</span> dataIdPrefix<span class="token punctuation">,</span> nacosGroup<span class="token punctuation">,</span>
						   fileExtension<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 2</span>
	<span class="token comment">// load with suffix, which have a higher priority than the default</span>
	<span class="token function">loadNacosDataIfPresent</span><span class="token punctuation">(</span>compositePropertySource<span class="token punctuation">,</span>
						   dataIdPrefix <span class="token operator">+</span> DOT <span class="token operator">+</span> fileExtension<span class="token punctuation">,</span> nacosGroup<span class="token punctuation">,</span> fileExtension<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">// 3</span>
	<span class="token comment">// Loaded with profile, which have a higher priority than the suffix</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> profile <span class="token operator">:</span> environment<span class="token punctuation">.</span><span class="token function">getActiveProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name">String</span> dataId <span class="token operator">=</span> dataIdPrefix <span class="token operator">+</span> SEP1 <span class="token operator">+</span> profile <span class="token operator">+</span> DOT <span class="token operator">+</span> fileExtension<span class="token punctuation">;</span>
		<span class="token function">loadNacosDataIfPresent</span><span class="token punctuation">(</span>compositePropertySource<span class="token punctuation">,</span> dataId<span class="token punctuation">,</span> nacosGroup<span class="token punctuation">,</span>
							   fileExtension<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>	
</code></pre> 
<p>可以发现，在拉取配置时会分为三步：</p> 
<ol><li>拉取dataid为user的配置</li><li>拉取dataid为user.properties的配置</li><li>拉取dataid为user-${spring.profiles.active}.properties的配置</li></ol> 
<p>并且优先级依次增高。</p> 
<p>还值得注意的是，在拉取配置时，还会加上namespace这个维度取获取配置，可以通过spring.cloud.nacos.config.namespace进行配置。</p> 
<p>我们可以在Nacos管理台：</p> 
<ol><li>新建不同的namespace</li><li>在每个namespace下可以进行dataid名称相同的配置</li><li>每个dataid又可以分配到不同的group下</li></ol> 
<p>相当于一个三层结构<br> <img src="https://images2.imgbox.com/41/bd/6zJ18j9z_o.jpg" alt=""></p> 
<h4><a id="_326"></a>拉取多个配置</h4> 
<p>一个应用可能不止需要一个配置，有时可能需要拉取多个配置，此时可以利用</p> 
<ol><li>spring.cloud.nacos.config.extension-configs[0].data-id=datasource.properties</li><li>spring.cloud.nacos.config.shared-configs[0].data-id=common.properties</li></ol> 
<p>extension-configs表示拉取额外的配置文件，shared-configs也表示拉取额外的配置文件，只不过：</p> 
<ol><li>extension-configs表示本应用特有的</li><li>shared-configs表示多个应用共享的</li></ol> 
<p>注意优先级：</p> 
<ul><li>extension-configs[2] &gt; extension-configs[1] &gt; extension-configs[0</li><li>shared-configs[2] &gt; shared-configs[1] &gt; shared-configs[0]</li><li>主配置 &gt; extension-configs &gt; shared-configs</li></ul> 
<h4><a id="_344"></a>配置的自动刷新</h4> 
<p><strong>默认情况下，主配置会自动刷新，extension-configs和shared-configs不会自动刷新</strong>，可以通过spring.cloud.nacos.config.refresh-enabled=false来关闭主配置的自动刷新。</p> 
<p>自动配置的意思是，一旦应用中引入的配置发生了变化，应用端也能及时获取到最新值。</p> 
<p>值得注意的是，尽管默认情况下会自动刷新，但是对于通过@Value的使用方式，还需要在该Bean上加上**@RefreshScope注解**，这样才能动态的修改@Value属性，达到动态更新的最终效果。</p> 
<h4><a id="_351"></a>历史版本回滚</h4> 
<p>可以回滚某个配置到历史版本</p> 
<h4><a id="_353"></a>监听查询</h4> 
<p>监听某个配置哪些应用在使用</p> 
<h3><a id="_356"></a>服务管理</h3> 
<p>服务管理核心就是：</p> 
<ol><li>服务注册</li><li>服务发现</li></ol> 
<p>通过nacos的服务注册与发现，可以使得在调用微服务时可以更加简单。</p> 
<h4><a id="Java_SDK_364"></a>Java SDK</h4> 
<h5><a id="_365"></a>服务注册</h5> 
<p>首先，我们可以直接使用Nacos提供的Java SDK来进行服务注册。</p> 
<p>首先在项目中，添加如下依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>nacos-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>我们可以使用如下代码来快速的进行服务注册：</p> 
<pre><code class="prism language-java"><span class="token class-name">NamingService</span> naming <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
naming<span class="token punctuation">.</span><span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> <span class="token string">"11.11.11.11"</span><span class="token punctuation">,</span> <span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码表示注册一个服务：</p> 
<ol><li>服务名字为app1</li><li>访问该服务的地址为：11.11.11.11：8888</li></ol> 
<p>注意执行完上述代码后，不要上线程停掉，可以加上：</p> 
<pre><code class="prism language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>运行为代码后，就可以到Nacos管理台看到：<br> <img src="https://images2.imgbox.com/1a/f5/wWxXAHcm_o.png" alt="image.png"></p> 
<p>可以发现，一个服务下：</p> 
<ol><li>一个服务可以属于某一个组，可以在注册时指定group</li><li>一个服务下可以有多个实例</li><li>一个服务下多个实例可以分为多个虚拟集群</li></ol> 
<p>比如以下代码就注册了一个服务有三个实例，分别属于两个虚拟集群</p> 
<pre><code class="prism language-java"><span class="token class-name">NamingService</span> naming <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
naming<span class="token punctuation">.</span><span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> <span class="token string">"11.11.11.11"</span><span class="token punctuation">,</span> <span class="token number">8888</span><span class="token punctuation">,</span> <span class="token string">"cluster1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">NamingService</span> naming1 <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
naming1<span class="token punctuation">.</span><span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> <span class="token string">"11.11.11.12"</span><span class="token punctuation">,</span> <span class="token number">8888</span><span class="token punctuation">,</span> <span class="token string">"cluster1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token class-name">NamingService</span> naming2 <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
naming2<span class="token punctuation">.</span><span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> <span class="token string">"11.11.11.13"</span><span class="token punctuation">,</span> <span class="token number">8888</span><span class="token punctuation">,</span> <span class="token string">"cluster2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>对应的管理台展示为：<br> <img src="https://images2.imgbox.com/da/74/Bixx7LiI_o.png" alt="image.png"></p> 
<p>详情如下：<br> <img src="https://images2.imgbox.com/46/66/pTAHFTnT_o.png" alt="image.png"></p> 
<p>我们也可以使用更加定制化的方式来注册服务：</p> 
<pre><code class="prism language-java"><span class="token class-name">NamingService</span> naming <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Instance</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span><span class="token function">setIp</span><span class="token punctuation">(</span><span class="token string">"55.55.55.55"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span><span class="token function">setHealthy</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span><span class="token function">setWeight</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> instanceMeta <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instanceMeta<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"site"</span><span class="token punctuation">,</span> <span class="token string">"et2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span><span class="token function">setMetadata</span><span class="token punctuation">(</span>instanceMeta<span class="token punctuation">)</span><span class="token punctuation">;</span>

naming<span class="token punctuation">.</span><span class="token function">registerInstance</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码注册了一个不健康的实例，并且设置了权重和元数据， 对应的管理台效果为：<br> <img src="https://images2.imgbox.com/66/e4/wRE74Txn_o.png" alt="image.png"></p> 
<h5><a id="_444"></a>服务发现</h5> 
<p>服务注册之后，服务消费者就可以来使用了，我们可以使用如下api来获取某个服务的所有实例信息</p> 
<pre><code class="prism language-java"><span class="token class-name">NamingService</span> naming <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>naming<span class="token punctuation">.</span><span class="token function">getAllInstances</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>也可以获取所有健康的实例</p> 
<pre><code class="prism language-java">naming<span class="token punctuation">.</span><span class="token function">selectInstances</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre> 
<p>可以直接某一个健康的实例（权重随机算法）</p> 
<pre><code class="prism language-java">naming<span class="token punctuation">.</span><span class="token function">selectOneHealthyInstance</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">)</span>
</code></pre> 
<p>通常，作为服务消费者，还需要监听服务实例化的变化，我们可以使用如下api来监听变化：</p> 
<pre><code class="prism language-java"><span class="token class-name">NamingService</span> naming <span class="token operator">=</span> <span class="token class-name">NamingFactory</span><span class="token punctuation">.</span><span class="token function">createNamingService</span><span class="token punctuation">(</span><span class="token string">"localhost:8848"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
naming<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">"app1"</span><span class="token punctuation">,</span> event <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token keyword">instanceof</span> <span class="token class-name">NamingEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">NamingEvent</span><span class="token punctuation">)</span> event<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServiceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">NamingEvent</span><span class="token punctuation">)</span> event<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上是Nacos提供了Java SDK的常用API，熟悉这些API能更好的理解或深入研究Nacos。</p> 
<h4><a id="SpringSpringBoot_475"></a>Spring/SpringBoot</h4> 
<p>直接使用Java SDK的方式来进行服务注册和发现比较麻烦，不过目前在Spring和SpringBoot中使用也不怎么方便，可以自行参考官网的教程：<a href="https://nacos.io/zh-cn/docs/quick-start-spring-boot.html" rel="nofollow">https://nacos.io/zh-cn/docs/quick-start-spring-boot.html</a></p> 
<h4><a id="SpringCloud_478"></a>SpringCloud</h4> 
<p>我们直接来看SpringCloud中如何使用Nacos来进行服务注册和发现</p> 
<p>首先添加依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.8.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="_490"></a>服务提供者</h5> 
<p>在服务提供者的application.properties中配置：</p> 
<pre><code class="prism language-properties">server.port=8070
spring.application.name=service-provider

spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
</code></pre> 
<p>使用@EnableDiscoveryClient来开启服务注册</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserApplication</span> <span class="token punctuation">{<!-- --></span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">UserApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>启动应用，就能完成服务注册:<br> <img src="https://images2.imgbox.com/b5/18/kQ6DWlFq_o.png" alt="image.png"></p> 
<h5><a id="_514"></a>服务消费者</h5> 
<p>也是先添加依赖：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.8.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>再配置应用的application.properties文件：</p> 
<pre><code class="prism language-properties">server.port=8080
spring.application.name=service-consumer

spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
</code></pre> 
<p>然后使用@EnableDiscoveryClient开启服务发现:</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsumerApplication</span> <span class="token punctuation">{<!-- --></span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ConsumerApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后通过定义一个RestTemplate来发现http请求，并使用@LoadBalanced</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@LoadBalanced</span>
<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后来使用RestTemplate调用服务：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsumerController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/test"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">"http://service-provider/test"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>可以发现在SpringCloud中使用Nacos还是比较方便的。</p> 
<h4><a id="_571"></a>高级功能</h4> 
<p>接下来我们再来看看Nacos服务管理中一些比较高级的功能</p> 
<h5><a id="_575"></a>临时实例与持久实例</h5> 
<p>默认情况下，注册给nacos的实例都是<strong>临时实例</strong>，临时实例表示会通过客户端与服务端之间的心跳来保活，默认情况下，客户端会每<strong>隔5s发送一次心跳</strong>。</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> DEFAULT_HEART_BEAT_INTERVAL <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在服务端测，如果<strong>超过15s没有收到客户端的心跳，那么就会把实例标记为不健康状态</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> DEFAULT_HEART_BEAT_TIMEOUT <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在服务端测，如果<strong>超过30s没有收到客户端的心跳，那么就会删除实例</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> DEFAULT_IP_DELETE_TIMEOUT <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>而对于持久实例，就算服务实例下线了，那么也不会被删除，我们可以通过：</p> 
<pre><code class="prism language-java">spring<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>nacos<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span>ephemeral<span class="token operator">=</span><span class="token boolean">false</span>
</code></pre> 
<p>来配置为持久实例，表示实例信息会持久化到磁盘中去。</p> 
<p>那什么时候用持久实例呢？我们可以发现持久实例与临时实例的区别在于，持久实例会永远在线，而临时实例不会，所以如果消费端在某种情况下想拿到已经下线的实例的实例信息，那么就可以把实例注册为持久实例。</p> 
<h5><a id="_600"></a>保护阈值</h5> 
<p>在使用过程中，我们可以设置一个0-1的一个比例，表示如果服务的所有实例中，健康实例的比重低于这个比重就会触发保护，一旦触发保护，在服务消费端侧就会把所有实例拉取下来，不管是否健康，这样就起到了保护的作用，因为正常来说消费端只会拿到健康实例，但是如果健康实例占总实例比例比较小了，那么就会导致所有流量都会压到健康实例上，这样仅剩的几个健康实例也会被压垮，所以只要触发了保护，消费端就会拉取到所有实例，这样部分消费端仍然会访问到不健康的实例从而请求失败，但是也有一部分请求能访问到健康实例，达到保护的作用。</p> 
<p><strong>在SpringCloud Tencent中，这个功能叫“全死全活”</strong>。</p> 
<h5><a id="_604"></a>权重</h5> 
<p>一个服务的多个实例，可能对应的机器配置不同，所以我们可以给不同的实例设置不同的权重，比如<br> <img src="https://images2.imgbox.com/75/14/he2EuENo_o.png" alt="image.png"><br> 给8070这个实例设置了权重为2，这样它的权重就是8071的两倍，那么就应该要承受2被的流量。</p> 
<p>不过我们在消费一个服务时，通常是通过ribbon来进行负载均衡的，所以默认情况下nacos配置的权重是起不到作用的，因为ribbon使用的是自己的负载均衡策略，而如果想要用到nacos的权重，可以：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">IRule</span> <span class="token function">ribbonRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NacosRule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这样就会利用到nacos中所配置的权重了。</p> 
<h5><a id="Cluster_618"></a>Cluster（就近访问）</h5> 
<p>一个服务下会有多个实例，在nacos中，可以将这些实例指定到不同的集群中，比如可以通过：</p> 
<pre><code class="prism language-java">spring<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>nacos<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span>cluster<span class="token operator">-</span>name<span class="token operator">=</span>bj
</code></pre> 
<p>这种方式来指定当前实例属于哪个集群，比如：</p> 
<p><img src="https://images2.imgbox.com/84/36/CbPpgQSG_o.png" alt="image.png"></p> 
<p>hz集群只有一个8070的实例，bj集群有8071、8072两个实例。</p> 
<p>此时在服务消费端，也可以配置：</p> 
<pre><code class="prism language-java">spring<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>nacos<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span>cluster<span class="token operator">-</span>name<span class="token operator">=</span>bj
</code></pre> 
<p>使得服务调用者也在bj集群，那么此时服务消费者就只会调用到bj集群中的两个实例。</p> 
<p>如果消费端没有配置cluster-name，那么则会使用所有集群。</p> 
<h3><a id="_639"></a>集群部署</h3> 
<p>在前面，我们都是使用的单机模式部署的nacos服务端的，为了保证nacos的高可用，也就是保证配置中心和注册中心的高可用，通常我们都需要以集群的方式来部署nacos server。</p> 
<p>首先，我们修改conf/cluster文件，把nacos集群中所有的节点的ip和port配置进去：</p> 
<pre><code class="prism language-java"><span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8848</span>
<span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8858</span>
<span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8868</span>
</code></pre> 
<p>我这里是在我本机搭集群，所以ip地址一样，端口得不一样，如果大家是在多个机器上搭机器，则ip地址不一样，端口可以一样，也可以不一样，通常是一样（8848）。</p> 
<p>如果多个机器来搭集群，那么这么配置一下就可以了，注意每个机器上得cluster文件都要配，表示每个nacos节点都得知道自己所在集群的节点情况。</p> 
<p>我这里在本地搭，就需要多几个步骤。</p> 
<p>先复制三份<br> <img src="https://images2.imgbox.com/56/7d/6XyQZ9cM_o.png" alt="image.png"><br> 每个文件夹的内容都是如下<br> <img src="https://images2.imgbox.com/5b/f3/vIp9EzAY_o.png" alt="image.png"></p> 
<p>分别修改三个cluster文件的内容都为：</p> 
<pre><code class="prism language-java"><span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8848</span>
<span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8858</span>
<span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8868</span>
</code></pre> 
<p>再分别修改三个application.properties中的server.port为8848、8858、8868</p> 
<p>然后通过cmd分别进去三个文件夹中的bin目录，运行：</p> 
<pre><code class="prism language-java">startup<span class="token punctuation">.</span>cmd <span class="token operator">-</span>p embedded
</code></pre> 
<p>来启动三个节点</p> 
<p>启动成功后<br> <img src="https://images2.imgbox.com/68/c5/bHknWD8k_o.png" alt="image.png"></p> 
<p>然后我们就可以通过：<a href="http://localhost:8858/nacos" rel="nofollow">http://localhost:8848/nacos</a>、<a href="http://localhost:8858/nacos" rel="nofollow">http://localhost:8858/nacos</a>、<a href="http://localhost:8858/nacos" rel="nofollow">http://localhost:8868/nacos</a>这三个路径来访问nacos管理台，效果是一样的。</p> 
<p>并且可以看到集群的情况：<br> <img src="https://images2.imgbox.com/1b/e9/Quffwbdb_o.png" alt="image.png"></p> 
<p>不过我们我们在启动的时候，使用了</p> 
<pre><code class="prism language-java">startup<span class="token punctuation">.</span>cmd <span class="token operator">-</span>p embedded
</code></pre> 
<p>表示使用内置数据源，我们可以切换成mysql，首先我们在自己的mysql中新建一个schema：nacos_config</p> 
<p>然后执行<img src="https://images2.imgbox.com/91/7a/r9gKT018_o.png" alt="image.png"><br> 然后执行该sql脚本，去创建相关的表，可以发现只有配置中心的配置信息才会存到mysql中，注册中心的服务信息是不会存的。</p> 
<p>然后修改application.properties文件中的：</p> 
<pre><code class="prism language-java">### <span class="token class-name">If</span> use <span class="token class-name">MySQL</span> as datasource<span class="token operator">:</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>platform<span class="token operator">=</span>mysql

### <span class="token class-name">Count</span> of DB<span class="token operator">:</span>
db<span class="token punctuation">.</span>num<span class="token operator">=</span><span class="token number">1</span>

### <span class="token class-name">Connect</span> URL of DB<span class="token operator">:</span>
db<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>nacos2<span class="token operator">?</span>characterEncoding<span class="token operator">=</span>utf8<span class="token operator">&amp;</span>connectTimeout<span class="token operator">=</span><span class="token number">1000</span><span class="token operator">&amp;</span>socketTimeout<span class="token operator">=</span><span class="token number">3000</span><span class="token operator">&amp;</span>autoReconnect<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>useSSL<span class="token operator">=</span><span class="token boolean">false</span><span class="token operator">&amp;</span>serverTimezone<span class="token operator">=</span>UTC
db<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">=</span>root
db<span class="token punctuation">.</span>password<span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">=</span><span class="token class-name">Zhouyu123456</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
</code></pre> 
<p>三个节点都配好，并且必须连接同一个数据库，配好之后，就可以直接使用startup.cmd来启动了。</p> 
<p>那nacos集群搭建完之后，对应我们的应用而言，连接任意一个节点都可以，或者可以配置配多个：</p> 
<pre><code class="prism language-java">spring<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>nacos<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span>server<span class="token operator">-</span>addr<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8848</span><span class="token punctuation">,</span> <span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8858</span><span class="token punctuation">,</span> <span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8858</span>
</code></pre> 
<p>这样其中某个节点就算挂掉了，对于应用而言也能从其他节点获取信息。</p> 
<p>不过，在应用上指定多个ip地址，有一个缺点就是，如果一旦ip地址发生变化，那么就得修改，所以我们可以在nacos集群之上在搭一个nginx。</p> 
<p>先下载一个nginx，然后修改conf/nginx配置文件：</p> 
<p>添加upstream</p> 
<pre><code class="prism language-java">upstream nacos<span class="token operator">-</span>cluster <span class="token punctuation">{<!-- --></span>
	server <span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8848</span><span class="token punctuation">;</span>
    server <span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8858</span><span class="token punctuation">;</span>
    server <span class="token number">192.168</span><span class="token number">.65</span><span class="token number">.46</span><span class="token operator">:</span><span class="token number">8868</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>添加location：</p> 
<pre><code class="prism language-java">location <span class="token operator">/</span>nacos <span class="token punctuation">{<!-- --></span>
	proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>nacos<span class="token operator">-</span>cluster<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>启动nginx后，访问<a href="http://localhost/nacos" rel="nofollow">http://localhost/nacos</a>就可以访问到nacos管理台了，并且在应用中只需要配置：</p> 
<pre><code class="prism language-java">spring<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>nacos<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span>server<span class="token operator">-</span>addr<span class="token operator">=</span>localhost<span class="token operator">:</span><span class="token number">80</span><span class="token operator">/</span>nacos
</code></pre> 
<p>即可进行服务注册与发现。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0b7485c5aa2c8a846463cf87391c95e8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">猿创征文｜Spring5梦开始的地方：入门必看</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c003554e515c677ebfe567e0436960e6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">idea构建spring源码项目</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>