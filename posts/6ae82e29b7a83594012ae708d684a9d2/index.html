<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MCDF实验——Lab5 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MCDF实验——Lab5" />
<meta property="og:description" content="Lab5主要完成如何定义覆盖率，如何从验证计划到测试用例的实现，最后再到覆盖率的量化。验证量化分为代码覆盖率和功能覆盖率。
一、编译 在编译过程中，需要对于设计相关的文件设置额外的覆盖率编译选项。
只选中与设计相关的文件点击右键，选择compile-&gt;compile properties，在弹出设置栏的coverage一栏中，如图选择以下选项，然后点击OK。
完成所有文件的编译“Compile All”。这一步将在编译DUT文件时生成代码覆盖率的模型。 二、仿真 在仿真窗口(transcript)中，执行仿真命令
vsim -i -classdebug -solvefaildebug -coverage -coverstore D:/questasim64_10.6c/Project/lab5/lab5 -testname mcdf_full_random_test -sv_seed random &#43;TESTNAME=mcdf_full_random_test -l mcdf_full_random_test.log work.tb -coverage：会在仿真时产生代码覆盖率数据，功能覆盖率数据则默认会生成，与此选项无关。-coverstore COVERAGE_STORAGE_PATH：这个命令是用来在仿真在最后结束时，生成覆盖率数据并且存储到COVERAGE_STORAGE_PATH。-testname TESTNAME：这个选项是你需要添加本次仿真的test名称，可以使用同&#43;TESTNAME选项一样的test名称。这样在仿真结束后，将在COVERAGE_STORAGE_PATH下产生一个覆盖率数据文件“{TESTNAME}_{SV_SEED}.data”。由于仿真时传入的种子是随机值，因此每次提交测试，在测试结束后都将产生一个独一无二的覆盖率数据。 执行run -all，等待跑完仿真
执行quit -sim命令之后，可以发现文件下中多了一个data文件
仿真结束以后，可以查看代码覆盖率
还可以查看本次仿真所收集到的功能覆盖率
三、合并覆盖率 运行不同的仿真，或者运行同一个test，都会生成独一无二的数据库，可以将生成的.data覆盖率数据文件做合并。
执行如下命令
vcover merge -out merged_coverage.ucdb D:/questasim64_10.6c/Project/lab5/lab5 可以打开合并后的UCDB覆盖率数据库，打开这个数据库之后，会发现合并后的数据库要比之前单独提交的任何一次测试在仿真结束时的该次覆盖率都要高。
四、分析覆盖率 可以选择Tools-&gt;Coverage Report-&gt;HTML生成报告
通过分析覆盖率，需要修改约束或者创建新的测试最终来达到验证完备性的要求。
五、覆盖率代码分析 相比于Lab4，Lab5在mcdf_pkg.sv新添加了一个组件mcdf_coverage
class mcdf_coverage; local virtual chnl_intf chnl_vifs[3]; local virtual arb_intf arb_vif; local virtual mcdf_intf mcdf_vif; local virtual reg_intf reg_vif; local virtual fmt_intf fmt_vif; local string name; local int delay_req_to_grant; covergroup cg_mcdf_reg_write_read; addr: coverpoint reg_vif." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6ae82e29b7a83594012ae708d684a9d2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-20T00:56:49+08:00" />
<meta property="article:modified_time" content="2021-02-20T00:56:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MCDF实验——Lab5</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>Lab5主要完成如何定义覆盖率，如何从验证计划到测试用例的实现，最后再到覆盖率的量化。验证量化分为代码覆盖率和功能覆盖率。</strong></p> 
<h2><a id="_3"></a>一、编译</h2> 
<p>在编译过程中，需要对于设计相关的文件设置额外的覆盖率编译选项。</p> 
<ol><li>只选中与设计相关的文件<img src="https://images2.imgbox.com/02/95/8TGbeqqj_o.png" alt="在这里插入图片描述"></li><li>点击右键，选择compile-&gt;compile properties，在弹出设置栏的coverage一栏中，如图选择以下选项，然后点击OK。<br> <img src="https://images2.imgbox.com/a7/0a/k2a7jZig_o.png" alt="在这里插入图片描述"></li><li>完成所有文件的编译“Compile All”。这一步将在编译DUT文件时生成代码覆盖率的模型。</li></ol> 
<h2><a id="_11"></a>二、仿真</h2> 
<p>在仿真窗口(transcript)中，执行仿真命令</p> 
<pre><code class="prism language-cpp">vsim <span class="token operator">-</span>i <span class="token operator">-</span>classdebug <span class="token operator">-</span>solvefaildebug <span class="token operator">-</span>coverage <span class="token operator">-</span>coverstore D<span class="token operator">:</span><span class="token operator">/</span>questasim64_10<span class="token punctuation">.</span><span class="token number">6</span>c<span class="token operator">/</span>Project<span class="token operator">/</span>lab5<span class="token operator">/</span>lab5 <span class="token operator">-</span>testname mcdf_full_random_test <span class="token operator">-</span>sv_seed random <span class="token operator">+</span>TESTNAME<span class="token operator">=</span>mcdf_full_random_test <span class="token operator">-</span>l mcdf_full_random_test<span class="token punctuation">.</span>log work<span class="token punctuation">.</span>tb
</code></pre> 
<ul><li><code>-coverage</code>：会在仿真时产生代码覆盖率数据，功能覆盖率数据则默认会生成，与此选项无关。</li><li><code>-coverstore COVERAGE_STORAGE_PATH</code>：这个命令是用来在仿真在最后结束时，生成覆盖率数据并且存储到COVERAGE_STORAGE_PATH。</li><li><code>-testname TESTNAME</code>：这个选项是你需要添加本次仿真的test名称，可以使用同<code>+TESTNAME</code>选项一样的test名称。这样在仿真结束后，将在COVERAGE_STORAGE_PATH下产生一个覆盖率数据文件“{TESTNAME}_{SV_SEED}.data”。由于仿真时传入的种子是随机值，因此每次提交测试，在测试结束后都将产生一个独一无二的覆盖率数据。</li></ul> 
<p><img src="https://images2.imgbox.com/91/92/JXNe3qgA_o.png" alt="在这里插入图片描述"><br> 执行<code>run -all</code>，等待跑完仿真<br> <img src="https://images2.imgbox.com/8e/7d/m4eU0XFJ_o.png" alt="在这里插入图片描述"><br> 执行<code>quit -sim</code>命令之后，可以发现文件下中多了一个data文件<br> <img src="https://images2.imgbox.com/53/92/FVpEDbWA_o.png" alt="在这里插入图片描述"><br> 仿真结束以后，可以查看代码覆盖率<br> <img src="https://images2.imgbox.com/98/92/B9LOIpUU_o.png" alt="在这里插入图片描述"><br> 还可以查看本次仿真所收集到的功能覆盖率<br> <img src="https://images2.imgbox.com/9b/8a/akdzfI2Q_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_32"></a>三、合并覆盖率</h2> 
<p>运行不同的仿真，或者运行同一个test，都会生成独一无二的数据库，可以将生成的.data覆盖率数据文件做合并。</p> 
<p>执行如下命令</p> 
<pre><code class="prism language-cpp">vcover merge <span class="token operator">-</span>out merged_coverage<span class="token punctuation">.</span>ucdb D<span class="token operator">:</span><span class="token operator">/</span>questasim64_10<span class="token punctuation">.</span><span class="token number">6</span>c<span class="token operator">/</span>Project<span class="token operator">/</span>lab5<span class="token operator">/</span>lab5
</code></pre> 
<p><img src="https://images2.imgbox.com/bf/19/2MXzSOVt_o.png" alt="在这里插入图片描述"><br> 可以打开合并后的UCDB覆盖率数据库，打开这个数据库之后，会发现合并后的数据库要比之前单独提交的任何一次测试在仿真结束时的该次覆盖率都要高。<br> <img src="https://images2.imgbox.com/45/2a/3WPhvWNS_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_43"></a>四、分析覆盖率</h2> 
<p>可以选择Tools-&gt;Coverage Report-&gt;HTML生成报告<br> <img src="https://images2.imgbox.com/9e/9b/3hhSdJ4M_o.png" alt="在这里插入图片描述"><br> 通过分析覆盖率，需要修改约束或者创建新的测试最终来达到验证完备性的要求。</p> 
<h2><a id="_50"></a>五、覆盖率代码分析</h2> 
<p>相比于Lab4，Lab5在<code>mcdf_pkg.sv</code>新添加了一个组件<code>mcdf_coverage</code></p> 
<pre><code class="prism language-cpp">  <span class="token keyword">class</span> <span class="token class-name">mcdf_coverage</span><span class="token punctuation">;</span>
    local <span class="token keyword">virtual</span> chnl_intf chnl_vifs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    local <span class="token keyword">virtual</span> arb_intf arb_vif<span class="token punctuation">;</span> 
    local <span class="token keyword">virtual</span> mcdf_intf mcdf_vif<span class="token punctuation">;</span>
    local <span class="token keyword">virtual</span> reg_intf reg_vif<span class="token punctuation">;</span>
    local <span class="token keyword">virtual</span> fmt_intf fmt_vif<span class="token punctuation">;</span>
    local string name<span class="token punctuation">;</span>
    local <span class="token keyword">int</span> delay_req_to_grant<span class="token punctuation">;</span>

    covergroup cg_mcdf_reg_write_read<span class="token punctuation">;</span>
      addr<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_addr <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins slv0_rw_addr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv1_rw_addr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV1_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv2_rw_addr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV2_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv0_r_addr  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_R_ADDR <span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv1_r_addr  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV1_R_ADDR <span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv2_r_addr  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV2_R_ADDR <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      cmd<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins write <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`WRITE<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins read  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`READ<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins idle  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`IDLE<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      cmdXaddr<span class="token operator">:</span> cross cmd<span class="token punctuation">,</span> addr <span class="token punctuation">{<!-- --></span>
        bins slv0_rw_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv1_rw_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv2_rw_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv0_r_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_r_addr <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv1_r_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_r_addr <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv2_r_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_r_addr <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write        <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read         <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins idle         <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>idle <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_slv0_rw_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_slv1_rw_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_slv2_rw_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv0_rw_addr   <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv1_rw_addr   <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv2_rw_addr   <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv0_r_addr    <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_r_addr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        bins read_slv1_r_addr    <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_r_addr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        bins read_slv2_r_addr    <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_r_addr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
    endgroup

    covergroup cg_mcdf_reg_illegal_access<span class="token punctuation">;</span>
      addr<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_addr <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins legal_rw <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_RW_ADDR<span class="token punctuation">,</span> `SLV1_RW_ADDR<span class="token punctuation">,</span> `SLV2_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins legal_r <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_R_ADDR<span class="token punctuation">,</span> `SLV1_R_ADDR<span class="token punctuation">,</span> `SLV2_R_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins illegal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">8</span><span class="token string">'h20:$], 8'</span>hC<span class="token punctuation">,</span> <span class="token number">8</span>'h1C<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      cmd<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins write <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`WRITE<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins read  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`READ<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      wdata<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_data_m2s <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins legal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span>'h3F<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins illegal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span>'h40<span class="token operator">:</span>$<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      rdata<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_data_s2m <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins legal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span>'hFF<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      cmdXaddrXdata<span class="token operator">:</span> cross cmd<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> wdata<span class="token punctuation">,</span> rdata <span class="token punctuation">{<!-- --></span>
        bins addr_legal_rw <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_rw<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins addr_legal_r <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins addr_illegal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins cmd_write <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins cmd_read <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins wdata_legal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>legal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins wdata_illegal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins rdata_legal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>rdata<span class="token punctuation">.</span>legal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_illegal_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_illegal_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_illegal_rw_data <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_rw<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_illegal_r_data <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_r<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup

    covergroup cg_channel_disable<span class="token punctuation">;</span>
      ch0_en<span class="token operator">:</span> coverpoint mcdf_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>chnl_en<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        wildcard bins en  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        wildcard bins dis <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch1_en<span class="token operator">:</span> coverpoint mcdf_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>chnl_en<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        wildcard bins en  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        wildcard bins dis <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch2_en<span class="token operator">:</span> coverpoint mcdf_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>chnl_en<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        wildcard bins en  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        wildcard bins dis <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch0_vld<span class="token operator">:</span> coverpoint chnl_vifs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins hi <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins lo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch1_vld<span class="token operator">:</span> coverpoint chnl_vifs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins hi <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins lo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch2_vld<span class="token operator">:</span> coverpoint chnl_vifs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins hi <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins lo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      chenXchvld<span class="token operator">:</span> cross ch0_en<span class="token punctuation">,</span> ch1_en<span class="token punctuation">,</span> ch2_en<span class="token punctuation">,</span> ch0_vld<span class="token punctuation">,</span> ch1_vld<span class="token punctuation">,</span> ch2_vld <span class="token punctuation">{<!-- --></span>
        bins ch0_en  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_dis <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_en  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_dis <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_en  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_dis <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_hi  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_lo  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>lo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_hi  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_lo  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>lo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_hi  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_lo  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>lo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_en_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_dis_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_en_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_dis_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_en_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_dis_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup

    covergroup cg_arbiter_priority<span class="token punctuation">;</span>
      ch0_prio<span class="token operator">:</span> coverpoint arb_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>slv_prios<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        bins ch_prio0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      ch1_prio<span class="token operator">:</span> coverpoint arb_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>slv_prios<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        bins ch_prio0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      ch2_prio<span class="token operator">:</span> coverpoint arb_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>slv_prios<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        bins ch_prio0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
    endgroup

    covergroup cg_formatter_length<span class="token punctuation">;</span>
      id<span class="token operator">:</span> coverpoint fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_chid <span class="token punctuation">{<!-- --></span>
        bins ch0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins ch1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins ch2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      length<span class="token operator">:</span> coverpoint fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_length <span class="token punctuation">{<!-- --></span>
        bins len4  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins len8  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins len16 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins len32 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">32</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup

    covergroup <span class="token function">cg_formatter_grant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      delay_req_to_grant<span class="token operator">:</span> coverpoint <span class="token keyword">this</span><span class="token punctuation">.</span>delay_req_to_grant <span class="token punctuation">{<!-- --></span>
        bins delay1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins delay2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins delay3_or_more <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup

    function <span class="token keyword">new</span><span class="token punctuation">(</span>string name<span class="token operator">=</span><span class="token string">"mcdf_coverage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_write_read <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_illegal_access <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_channel_disable <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_arbiter_priority <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_length <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_grant <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    endfunction

    task <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fork 
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_reg_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_channel_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_arbiter_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_formater_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      join
    endtask

    task <span class="token function">do_reg_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      forever begin
        @<span class="token punctuation">(</span>posedge reg_vif<span class="token punctuation">.</span>clk iff reg_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_write_read<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_illegal_access<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      end
    endtask

    task <span class="token function">do_channel_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      forever begin
        @<span class="token punctuation">(</span>posedge mcdf_vif<span class="token punctuation">.</span>clk iff mcdf_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>chnl_vifs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1</span>
          <span class="token operator">||</span> chnl_vifs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1</span>
          <span class="token operator">||</span> chnl_vifs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>cg_channel_disable<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      end
    endtask

    task <span class="token function">do_arbiter_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      forever begin
        @<span class="token punctuation">(</span>posedge arb_vif<span class="token punctuation">.</span>clk iff arb_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>arb_vif<span class="token punctuation">.</span>slv_reqs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">||</span> arb_vif<span class="token punctuation">.</span>slv_reqs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">||</span> arb_vif<span class="token punctuation">.</span>slv_reqs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>cg_arbiter_priority<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      end
    endtask

    task <span class="token function">do_formater_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fork
        forever begin
          @<span class="token punctuation">(</span>posedge fmt_vif<span class="token punctuation">.</span>clk iff fmt_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_req <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_length<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        end
        forever begin
          @<span class="token punctuation">(</span>posedge fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_req<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>delay_req_to_grant <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          forever begin
            <span class="token keyword">if</span><span class="token punctuation">(</span>fmt_vif<span class="token punctuation">.</span>fmt_grant <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> begin
              <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_grant<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">break</span><span class="token punctuation">;</span>
            end
            <span class="token keyword">else</span> begin
              @<span class="token punctuation">(</span>posedge fmt_vif<span class="token punctuation">.</span>clk<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>delay_req_to_grant<span class="token operator">++</span><span class="token punctuation">;</span>
            end
          end
        end
      join
    endtask

    function <span class="token keyword">void</span> <span class="token function">do_report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      string s<span class="token punctuation">;</span>
      s <span class="token operator">=</span> <span class="token string">"\n---------------------------------------------------------------\n"</span><span class="token punctuation">;</span>
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> <span class="token string">"COVERAGE SUMMARY \n"</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"total coverage: %.1f \n"</span><span class="token punctuation">,</span> $<span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"  cg_mcdf_reg_write_read coverage: %.1f \n"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_write_read<span class="token punctuation">.</span><span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"  cg_mcdf_reg_illegal_access coverage: %.1f \n"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_illegal_access<span class="token punctuation">.</span><span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"  cg_channel_disable_test coverage: %.1f \n"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cg_channel_disable<span class="token punctuation">.</span><span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"  cg_arbiter_priority_test coverage: %.1f \n"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cg_arbiter_priority<span class="token punctuation">.</span><span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"  cg_formatter_length_test coverage: %.1f \n"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_length<span class="token punctuation">.</span><span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> $<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"  cg_formatter_grant_test coverage: %.1f \n"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_grant<span class="token punctuation">.</span><span class="token function">get_coverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>s<span class="token punctuation">,</span> <span class="token string">"---------------------------------------------------------------\n"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      rpt_pkg<span class="token operator">::</span><span class="token function">rpt_msg</span><span class="token punctuation">(</span>$<span class="token function">sformatf</span><span class="token punctuation">(</span><span class="token string">"[%s]"</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> rpt_pkg<span class="token operator">::</span>INFO<span class="token punctuation">,</span> rpt_pkg<span class="token operator">::</span>TOP<span class="token punctuation">)</span><span class="token punctuation">;</span>
    endfunction

    <span class="token keyword">virtual</span> function <span class="token keyword">void</span> <span class="token function">set_interface</span><span class="token punctuation">(</span><span class="token keyword">virtual</span> chnl_intf ch_vifs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> 
                                        <span class="token punctuation">,</span><span class="token keyword">virtual</span> reg_intf reg_vif
                                        <span class="token punctuation">,</span><span class="token keyword">virtual</span> arb_intf arb_vif
                                        <span class="token punctuation">,</span><span class="token keyword">virtual</span> fmt_intf fmt_vif
                                        <span class="token punctuation">,</span><span class="token keyword">virtual</span> mcdf_intf mcdf_vif
                                      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>chnl_vifs <span class="token operator">=</span> ch_vifs<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>arb_vif <span class="token operator">=</span> arb_vif<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>reg_vif <span class="token operator">=</span> reg_vif<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fmt_vif <span class="token operator">=</span> fmt_vif<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>mcdf_vif <span class="token operator">=</span> mcdf_vif<span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>chnl_vifs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> null <span class="token operator">||</span> chnl_vifs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> null <span class="token operator">||</span> chnl_vifs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> null<span class="token punctuation">)</span>
        $<span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"chnl interface handle is NULL, please check if target interface has been intantiated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>arb_vif <span class="token operator">==</span> null<span class="token punctuation">)</span>
        $<span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"arb interface handle is NULL, please check if target interface has been intantiated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>reg_vif <span class="token operator">==</span> null<span class="token punctuation">)</span>
        $<span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"reg interface handle is NULL, please check if target interface has been intantiated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>fmt_vif <span class="token operator">==</span> null<span class="token punctuation">)</span>
        $<span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"fmt interface handle is NULL, please check if target interface has been intantiated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>mcdf_vif <span class="token operator">==</span> null<span class="token punctuation">)</span>
        $<span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"mcdf interface handle is NULL, please check if target interface has been intantiated"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    endfunction
  endclass
</code></pre> 
<p>首先定义了6个<code>covergroup</code></p> 
<pre><code class="prism language-cpp">covergroup cg_mcdf_reg_write_read<span class="token punctuation">;</span>
covergroup cg_mcdf_reg_illegal_access<span class="token punctuation">;</span>
covergroup cg_channel_disable<span class="token punctuation">;</span>
covergroup cg_arbiter_priority<span class="token punctuation">;</span>
covergroup cg_formatter_length<span class="token punctuation">;</span>
covergroup <span class="token function">cg_formatter_grant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>然后例化这6个<code>covergroup</code></p> 
<pre><code class="prism language-cpp">    function <span class="token keyword">new</span><span class="token punctuation">(</span>string name<span class="token operator">=</span><span class="token string">"mcdf_coverage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_write_read <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_illegal_access <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_channel_disable <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_arbiter_priority <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_length <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_grant <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    endfunction
</code></pre> 
<p>然后通过4个采样任务进行采样</p> 
<pre><code class="prism language-cpp">    task <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fork 
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_reg_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_channel_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_arbiter_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_formater_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      join
    endtask
</code></pre> 
<p>这4个采样任务分别采样了6个<code>covergroup</code></p> 
<pre><code class="prism language-cpp"><span class="token comment">//do_reg_sample()</span>
cg_mcdf_reg_write_read<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cg_mcdf_reg_illegal_access<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//do_channel_sample()</span>
cg_channel_disable<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//do_arbiter_sample()</span>
cg_arbiter_priority<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//do_formater_sample()</span>
cg_formatter_length<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cg_formatter_grant<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>定义的<code>mcdf_coverage</code>会在<code>mcdf_env</code>中例化，并且调用<code>cvrg.run()</code>和<code>cvrg.do_report()</code>使其运行并生成测试报告。</p> 
<h4><a id="6covergroup_403"></a><strong>重点是6个<code>covergroup</code></strong></h4> 
<p><code>cg_mcdf_reg_write_read</code>：寄存器读写测试</p> 
<p>对所有控制、状态寄存器的读写进行测试。</p> 
<pre><code class="prism language-cpp">covergroup cg_mcdf_reg_write_read<span class="token punctuation">;</span>
	  <span class="token comment">//要覆盖到6个寄存器地址，3个读写寄存器地址和3个只读寄存器地址</span>
      addr<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_addr <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//权重设置为0，表示不关心此覆盖点的覆盖率，否则cross会出现很多的bin</span>
        bins slv0_rw_addr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv1_rw_addr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV1_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv2_rw_addr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV2_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv0_r_addr  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_R_ADDR <span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv1_r_addr  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV1_R_ADDR <span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins slv2_r_addr  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV2_R_ADDR <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//8bit地址实际上会生成256个bin，256-6=250会被平均分配到这6个bin中，</span>
        <span class="token comment">//但默认max为64个bin，所以剩下的250要分配到64-6=58个bin里面</span>
      <span class="token punctuation">}</span>
      
      <span class="token comment">//覆盖读写指令</span>
      cmd<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins write <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`WRITE<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins read  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`READ<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins idle  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`IDLE<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//cmd是2bit的，所以还有一个默认的bin</span>
      <span class="token punctuation">}</span>
      
      <span class="token comment">//交叉覆盖，哪些寄存器可以读写，哪些寄存器只读，通过不同指令对不同地址的寄存器的操作来进行覆盖</span>
      cmdXaddr<span class="token operator">:</span> cross cmd<span class="token punctuation">,</span> addr <span class="token punctuation">{<!-- --></span>
        bins slv0_rw_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//因为权重为0，所以需要再一次的声明，这样可以只关心所需要的bin即可，不会生成没用的bin</span>
        bins slv1_rw_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv2_rw_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv0_r_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_r_addr <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv1_r_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_r_addr <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins slv2_r_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_r_addr <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write        <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read         <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins idle         <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>idle <span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_slv0_rw_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_slv1_rw_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins write_slv2_rw_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv0_rw_addr   <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv1_rw_addr   <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv2_rw_addr   <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_rw_addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins read_slv0_r_addr    <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv0_r_addr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        bins read_slv1_r_addr    <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv1_r_addr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        bins read_slv2_r_addr    <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>slv2_r_addr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
    endgroup
</code></pre> 
<p><code>cg_mcdf_reg_illegal_access</code>：寄存器稳定性测试</p> 
<p>对非法地址进行读写测试，对控制寄存器的保留域进行读写测试，对状态寄存器进行写操作测试。</p> 
<pre><code class="prism language-cpp">    covergroup cg_mcdf_reg_illegal_access<span class="token punctuation">;</span>
      addr<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_addr <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins legal_rw <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_RW_ADDR<span class="token punctuation">,</span> `SLV1_RW_ADDR<span class="token punctuation">,</span> `SLV2_RW_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>		<span class="token comment">//合法读写地址范围</span>
        bins legal_r <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`SLV0_R_ADDR<span class="token punctuation">,</span> `SLV1_R_ADDR<span class="token punctuation">,</span> `SLV2_R_ADDR<span class="token punctuation">}</span><span class="token punctuation">;</span>			<span class="token comment">//合法读地址范围</span>
        bins illegal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">8</span><span class="token string">'h20:$], 8'</span>hC<span class="token punctuation">,</span> <span class="token number">8</span>'h1C<span class="token punctuation">}</span><span class="token punctuation">;</span>							<span class="token comment">//非法地址范围</span>
      <span class="token punctuation">}</span>
	  
	  <span class="token comment">//覆盖读写指令</span>
      cmd<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins write <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`WRITE<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins read  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>`READ<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
      <span class="token comment">//写数据覆盖点</span>
      wdata<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_data_m2s <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">//数据合法范围，0~111111，即bit(0)使能信号、bit(2:1)优先级、bit(5:3)数据包长度都可以写</span>
        bins legal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span>'h3F<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>		
        <span class="token comment">//数据非法范围，bit(31:6)保留位，无法写入</span>
        bins illegal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span>'h40<span class="token operator">:</span>$<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
	  
	  <span class="token comment">//读数据覆盖点</span>
      rdata<span class="token operator">:</span> coverpoint reg_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>cmd_data_s2m <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">//读数据合法范围，0~11111111，即bit(7:0)上行数据从端FIFO的可写余量</span>
        bins legal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span>'hFF<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

	  <span class="token comment">//交叉覆盖组合</span>
      cmdXaddrXdata<span class="token operator">:</span> cross cmd<span class="token punctuation">,</span> addr<span class="token punctuation">,</span> wdata<span class="token punctuation">,</span> rdata <span class="token punctuation">{<!-- --></span>
        bins addr_legal_rw <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_rw<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins addr_legal_r <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins addr_illegal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins cmd_write <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins cmd_read <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins wdata_legal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>legal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins wdata_illegal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins rdata_legal <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>rdata<span class="token punctuation">.</span>legal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//只关注这几个重点组合</span>
        bins write_illegal_addr <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//对非法地址的写操作</span>
        bins read_illegal_addr  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>read<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//对非法地址的读操作</span>
        bins write_illegal_rw_data <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_rw<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//对读写寄存器的合法地址写入非法数据</span>
        bins write_illegal_r_data <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>write<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>addr<span class="token punctuation">.</span>legal_r<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>wdata<span class="token punctuation">.</span>illegal<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//对只读寄存器的合法地址写入非法数据</span>
      <span class="token punctuation">}</span>
    endgroup
</code></pre> 
<p><code>cg_channel_disable</code>：数据通道开关测试</p> 
<p>对每一个数据通道对应的控制寄存器域en配置为0，在关闭状态下测试数据写入是否通过。</p> 
<pre><code class="prism language-cpp">    covergroup cg_channel_disable<span class="token punctuation">;</span>
      <span class="token comment">//3个数据通道的en信号覆盖点</span>
      ch0_en<span class="token operator">:</span> coverpoint mcdf_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>chnl_en<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        wildcard bins en  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        wildcard bins dis <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch1_en<span class="token operator">:</span> coverpoint mcdf_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>chnl_en<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        wildcard bins en  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        wildcard bins dis <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch2_en<span class="token operator">:</span> coverpoint mcdf_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>chnl_en<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        wildcard bins en  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        wildcard bins dis <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

	  <span class="token comment">//3个数据通道的valid信号的覆盖点</span>
      ch0_vld<span class="token operator">:</span> coverpoint chnl_vifs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins hi <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins lo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch1_vld<span class="token operator">:</span> coverpoint chnl_vifs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins hi <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins lo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ch2_vld<span class="token operator">:</span> coverpoint chnl_vifs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid <span class="token punctuation">{<!-- --></span>
        type_option<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        bins hi <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins lo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
	  
	  <span class="token comment">//交叉覆盖组合</span>
      chenXchvld<span class="token operator">:</span> cross ch0_en<span class="token punctuation">,</span> ch1_en<span class="token punctuation">,</span> ch2_en<span class="token punctuation">,</span> ch0_vld<span class="token punctuation">,</span> ch1_vld<span class="token punctuation">,</span> ch2_vld <span class="token punctuation">{<!-- --></span>
        bins ch0_en  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_dis <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_en  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_dis <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_en  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_dis <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_hi  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_lo  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>lo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_hi  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_lo  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>lo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_hi  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_lo  <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>lo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//采集当valid拉高时，en拉高和拉低的情况数据</span>
        bins ch0_en_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch0_dis_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch0_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_en_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch1_dis_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch1_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_en_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>en<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bins ch2_dis_vld <span class="token operator">=</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_en<span class="token punctuation">.</span>dis<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">binsof</span><span class="token punctuation">(</span>ch2_vld<span class="token punctuation">.</span>hi<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup
</code></pre> 
<p><code>cg_arbiter_priority</code>：优先级测试</p> 
<p>将不同数据通道配置为相同或者不同的优先级，在数据通道使能的情况下进行测试。</p> 
<pre><code class="prism language-cpp">    covergroup cg_arbiter_priority<span class="token punctuation">;</span>
      <span class="token comment">//把3个数据通道的优先级分别配置为0,1,2,3</span>
      ch0_prio<span class="token operator">:</span> coverpoint arb_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>slv_prios<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        bins ch_prio0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      ch1_prio<span class="token operator">:</span> coverpoint arb_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>slv_prios<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        bins ch_prio0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      ch2_prio<span class="token operator">:</span> coverpoint arb_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>slv_prios<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span>
        bins ch_prio0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
        bins ch_prio3 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
    endgroup
</code></pre> 
<p><code>cg_formatter_length</code>：发包长度测试</p> 
<p>将不同数据通道随机配置为各自的长度，在数据通道使能的情况下进行测试。</p> 
<pre><code class="prism language-cpp">    covergroup cg_formatter_length<span class="token punctuation">;</span>
      <span class="token comment">//不同的数据通道是否都能发送数据</span>
      id<span class="token operator">:</span> coverpoint fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_chid <span class="token punctuation">{<!-- --></span>
        bins ch0 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins ch1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins ch2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span> 
      <span class="token punctuation">}</span>
      <span class="token comment">//发送不同的数据长度</span>
      length<span class="token operator">:</span> coverpoint fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_length <span class="token punctuation">{<!-- --></span>
        bins len4  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins len8  <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins len16 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins len32 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">32</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup
</code></pre> 
<p><code>cg_formatter_grant</code>：下行从端低带宽测试</p> 
<p>将MCDF下行数据接收端设置为小存储量，低带宽的类型，由此使得在由formatter发送出数据之后，下行从端有更多的机会延迟grant信号的置位，用来模拟真实场景。</p> 
<pre><code class="prism language-cpp">    covergroup <span class="token function">cg_formatter_grant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      delay_req_to_grant<span class="token operator">:</span> coverpoint <span class="token keyword">this</span><span class="token punctuation">.</span>delay_req_to_grant <span class="token punctuation">{<!-- --></span>		<span class="token comment">//delay_req_to_grant是一个软件信号，即是mcdf_coverage中的一个成员变量，是计算出来的</span>
        bins delay1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins delay2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        bins delay3_or_more <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//req和grant之间的间隔不允许为0</span>
        illegal_bins illegal <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    endgroup
</code></pre> 
<h4><a id="4sample_642"></a><strong>4个<code>sample</code>采样</strong></h4> 
<p><code>do_reg_sample()</code>：对寄存器进行采样</p> 
<pre><code class="prism language-cpp">    task <span class="token function">do_reg_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      forever begin
      	<span class="token comment">//对于每一个时钟上升沿，就要对寄存器的读写、寄存器的非法操作做采样</span>
        @<span class="token punctuation">(</span>posedge reg_vif<span class="token punctuation">.</span>clk iff reg_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_write_read<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cg_mcdf_reg_illegal_access<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      end
    endtask
</code></pre> 
<p><code>do_channel_sample()</code>：对数据通道做采样</p> 
<pre><code class="prism language-cpp">    task <span class="token function">do_channel_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      forever begin
      	<span class="token comment">//对于每一个时钟上升沿，至少有一个channel的valid信号为1时，即有数据发送进来时，才对disable做采样</span>
        @<span class="token punctuation">(</span>posedge mcdf_vif<span class="token punctuation">.</span>clk iff mcdf_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>chnl_vifs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1</span>
          <span class="token operator">||</span> chnl_vifs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1</span>
          <span class="token operator">||</span> chnl_vifs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>ch_valid<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>cg_channel_disable<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      end
    endtask
</code></pre> 
<p><code>do_arbiter_sample()</code>：对优先级做采样</p> 
<pre><code class="prism language-cpp">    task <span class="token function">do_arbiter_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//对于每一个时钟的上升沿，至少有一个channel的req为1，即至少有一个channel要发送数据了，才对其优先级做采样</span>
      forever begin
        @<span class="token punctuation">(</span>posedge arb_vif<span class="token punctuation">.</span>clk iff arb_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>arb_vif<span class="token punctuation">.</span>slv_reqs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">||</span> arb_vif<span class="token punctuation">.</span>slv_reqs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">||</span> arb_vif<span class="token punctuation">.</span>slv_reqs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>cg_arbiter_priority<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      end
    endtask
</code></pre> 
<p><code>do_formater_sample()</code>：对<code>grant</code>信号做采样</p> 
<pre><code class="prism language-cpp">    task <span class="token function">do_formater_sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      fork
        forever begin
          <span class="token comment">//对于每一个时钟上升沿，当req为1时，对数据的长度做采样</span>
          @<span class="token punctuation">(</span>posedge fmt_vif<span class="token punctuation">.</span>clk iff fmt_vif<span class="token punctuation">.</span>rstn<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_req <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_length<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        end
        forever begin
          <span class="token comment">//当req拉高时，要通过变量delay_req_to_grant来计算延迟，对grant做采样</span>
          @<span class="token punctuation">(</span>posedge fmt_vif<span class="token punctuation">.</span>mon_ck<span class="token punctuation">.</span>fmt_req<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>delay_req_to_grant <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>		<span class="token comment">//初始化为0</span>
          forever begin
          	<span class="token comment">//只有grant拉高时，才对grant做采样，进而通过delay_req_to_grant的值得到延迟</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>fmt_vif<span class="token punctuation">.</span>fmt_grant <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> begin
              <span class="token keyword">this</span><span class="token punctuation">.</span>cg_formatter_grant<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">break</span><span class="token punctuation">;</span>
            end
            <span class="token keyword">else</span> begin
              @<span class="token punctuation">(</span>posedge fmt_vif<span class="token punctuation">.</span>clk<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>delay_req_to_grant<span class="token operator">++</span><span class="token punctuation">;</span>
            end
          end
        end
      join
    endtask
</code></pre> 
<p><strong>综上所述：对于覆盖率组件<code>mcdf_coverage</code>，首先要定义<code>covergroup</code>并指点<code>coverpoint</code>，然后例化<code>covergroup</code>，例化之后要做采样，接着在<code>run()</code>中调用采样任务。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a0c78227c4ced7851a4d63917221a86e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">早高峰共享单车潮汐点的群智优化Baseline</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ed7277b61401249a54548d738376091/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python下雪的实例_javascript实现下雪效果【实例代码】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>