<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android 按键事件流程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android 按键事件流程" />
<meta property="og:description" content="#号键 的处理流程
keyCode=18, scanCode=228
1.linux kernel阶段
scanCode=228 0001 00e4 00000000 14*16 224&#43;4=228
内核驱动层发送 输入事件 228
/vendor/etc/remote.tab1
0x96 0x55 #TELECOM_VOICE
添加一个按键 0x96 代表扫描码
0x55 输入事件的值，也是上层的扫描码
2.input 服务
/vendor/usr/keylayout/Vendor_0001_Product_0001.kl
#key 228 POUND
key 228 CALL
228对应的是 POUND
把228 POUND改为 228 CALL
得到的键值变为 keyCode=5
3.framework的处理
查表 POUND 的键值是 18
static const KeycodeLabel KEYCODES[] = {
{ &#34;SOFT_LEFT&#34;, 1 },
{ &#34;SOFT_RIGHT&#34;, 2 },
{ &#34;HOME&#34;, 3 },
{ &#34;BACK&#34;, 4 },
{ &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/84b118ca718e3d919b7f67e80625e3cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-26T19:46:27+08:00" />
<meta property="article:modified_time" content="2021-09-26T19:46:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android 按键事件流程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br> #号键 的处理流程<br> keyCode=18, scanCode=228</p> 
<p>1.linux kernel阶段<br> scanCode=228 <br> 0001 00e4 00000000   14*16 224+4=228<br> 内核驱动层发送 输入事件 228</p> 
<p>/vendor/etc/remote.tab1<br> 0x96    0x55   #TELECOM_VOICE<br> 添加一个按键 <br> 0x96 代表扫描码<br> 0x55 输入事件的值，也是上层的扫描码</p> 
<p><br> 2.input 服务<br> /vendor/usr/keylayout/Vendor_0001_Product_0001.kl</p> 
<p>#key 228   POUND<br> key 228 CALL<br> 228对应的是 POUND</p> 
<p>把228   POUND改为 228 CALL<br> 得到的键值变为 keyCode=5</p> 
<p>3.framework的处理<br> 查表 POUND 的键值是 18</p> 
<p><br> static const KeycodeLabel KEYCODES[] = {<!-- --><br>     { "SOFT_LEFT", 1 },<br>     { "SOFT_RIGHT", 2 },<br>     { "HOME", 3 },<br>     { "BACK", 4 },<br>     { "CALL", 5 },<br>     { "ENDCALL", 6 },<br>     { "0", 7 },<br>     { "1", 8 },<br>     { "2", 9 },<br>     { "3", 10 },<br>     { "4", 11 },<br>     { "5", 12 },<br>     { "6", 13 },<br>     { "7", 14 },<br>     { "8", 15 },<br>     { "9", 16 },<br>     { "STAR", 17 },<br>     { "POUND", 18 },<br>     { "DPAD_UP", 19 },<br>     { "DPAD_DOWN", 20 },<br>     { "DPAD_LEFT", 21 },<br>     { "DPAD_RIGHT", 22 },<br>     { "DPAD_CENTER", 23 },<br>     { "VOLUME_UP", 24 },<br>     { "VOLUME_DOWN", 25 },<br>     { "POWER", 26 },<br>     { "CAMERA", 27 },<br>     { "CLEAR", 28 },<br>     { "A", 29 },<br>     { "B", 30 },<br>     { "C", 31 },<br>     { "D", 32 },<br>     { "E", 33 },<br>     { "F", 34 },<br>     { "G", 35 },<br>     { "H", 36 },<br>     { "I", 37 },<br>     { "J", 38 },<br>     { "K", 39 },<br>     { "L", 40 },<br>     { "M", 41 },<br>     { "N", 42 },<br>     { "O", 43 },<br>     { "P", 44 },<br>     { "Q", 45 },<br>     { "R", 46 },<br>     { "S", 47 },<br>     { "T", 48 },<br>     { "U", 49 },<br>     { "V", 50 },<br>     { "W", 51 },<br>     { "X", 52 },<br>     { "Y", 53 },<br>     { "Z", 54 },<br>     { "COMMA", 55 },<br>     { "PERIOD", 56 },<br>     { "ALT_LEFT", 57 },<br>     { "ALT_RIGHT", 58 },<br>     { "SHIFT_LEFT", 59 },<br>     { "SHIFT_RIGHT", 60 },<br>     { "TAB", 61 },<br>     { "SPACE", 62 },<br>     { "SYM", 63 },<br>     { "EXPLORER", 64 },<br>     { "ENVELOPE", 65 },<br>     { "ENTER", 66 },<br>     { "DEL", 67 },<br>     { "GRAVE", 68 },<br>     { "MINUS", 69 },<br>     { "EQUALS", 70 },<br>     { "LEFT_BRACKET", 71 },<br>     { "RIGHT_BRACKET", 72 },<br>     { "BACKSLASH", 73 },<br>     { "SEMICOLON", 74 },<br>     { "APOSTROPHE", 75 },<br>     { "SLASH", 76 },<br>     { "AT", 77 },<br>     { "NUM", 78 },<br>     { "HEADSETHOOK", 79 },<br>     { "FOCUS", 80 },<br>     { "PLUS", 81 },<br>     { "MENU", 82 },<br>     { "NOTIFICATION", 83 },<br>     { "SEARCH", 84 },<br>     { "MEDIA_PLAY_PAUSE", 85 },<br>     { "MEDIA_STOP", 86 },<br>     { "MEDIA_NEXT", 87 },<br>     { "MEDIA_PREVIOUS", 88 },<br>     { "MEDIA_REWIND", 89 },<br>     { "MEDIA_FAST_FORWARD", 90 },<br>     { "MUTE", 91 },<br>     { "PAGE_UP", 92 },<br>     { "PAGE_DOWN", 93 },<br>     { "PICTSYMBOLS", 94 },<br>     { "SWITCH_CHARSET", 95 },<br>     { "BUTTON_A", 96 },<br>     { "BUTTON_B", 97 },<br>     { "BUTTON_C", 98 },<br>     { "BUTTON_X", 99 },<br>     { "BUTTON_Y", 100 },<br>     { "BUTTON_Z", 101 },<br>     { "BUTTON_L1", 102 },<br>     { "BUTTON_R1", 103 },<br>     { "BUTTON_L2", 104 },<br>     { "BUTTON_R2", 105 },<br>     { "BUTTON_THUMBL", 106 },<br>     { "BUTTON_THUMBR", 107 },<br>     { "BUTTON_START", 108 },<br>     { "BUTTON_SELECT", 109 },<br>     { "BUTTON_MODE", 110 },<br>     { "ESCAPE", 111 },<br>     { "FORWARD_DEL", 112 },<br>     { "CTRL_LEFT", 113 },<br>     { "CTRL_RIGHT", 114 },<br>     { "CAPS_LOCK", 115 },<br>     { "SCROLL_LOCK", 116 },<br>     { "META_LEFT", 117 },<br>     { "META_RIGHT", 118 },<br>     { "FUNCTION", 119 },<br>     { "SYSRQ", 120 },<br>     { "BREAK", 121 },<br>     { "MOVE_HOME", 122 },<br>     { "MOVE_END", 123 },<br>     { "INSERT", 124 },<br>     { "FORWARD", 125 },<br>     { "MEDIA_PLAY", 126 },<br>     { "MEDIA_PAUSE", 127 },<br>     { "MEDIA_CLOSE", 128 },<br>     { "MEDIA_EJECT", 129 },<br>     { "MEDIA_RECORD", 130 },<br>     { "F1", 131 },<br>     { "F2", 132 },<br>     { "F3", 133 },<br>     { "F4", 134 },<br>     { "F5", 135 },<br>     { "F6", 136 },<br>     { "F7", 137 },<br>     { "F8", 138 },<br>     { "F9", 139 },<br>     { "F10", 140 },<br>     //{ "F11", 141 },<br>     { "F11", 546 },<br>     { "F12", 142 },<br>     { "NUM_LOCK", 143 },<br>     { "NUMPAD_0", 144 },<br>     { "NUMPAD_1", 145 },<br>     { "NUMPAD_2", 146 },<br>     { "NUMPAD_3", 147 },<br>     { "NUMPAD_4", 148 },<br>     { "NUMPAD_5", 149 },<br>     { "NUMPAD_6", 150 },<br>     { "NUMPAD_7", 151 },<br>     { "NUMPAD_8", 152 },<br>     { "NUMPAD_9", 153 },<br>     { "NUMPAD_DIVIDE", 154 },<br>     { "NUMPAD_MULTIPLY", 155 },<br>     { "NUMPAD_SUBTRACT", 156 },<br>     { "NUMPAD_ADD", 157 },<br>     { "NUMPAD_DOT", 158 },<br>     { "NUMPAD_COMMA", 159 },<br>     { "NUMPAD_ENTER", 160 },<br>     { "NUMPAD_EQUALS", 161 },<br>     { "NUMPAD_LEFT_PAREN", 162 },<br>     { "NUMPAD_RIGHT_PAREN", 163 },<br>     { "VOLUME_MUTE", 164 },<br>     { "INFO", 165 },<br>     { "CHANNEL_UP", 166 },<br>     { "CHANNEL_DOWN", 167 },<br>     { "ZOOM_IN", 168 },<br>     { "ZOOM_OUT", 169 },<br>     { "TV", 170 },<br>     { "WINDOW", 171 },<br>     { "GUIDE", 172 },<br>     { "DVR", 173 },<br>     { "BOOKMARK", 174 },<br>     { "CAPTIONS", 175 },<br>     { "SETTINGS", 176 },<br>     { "TV_POWER", 177 },<br>     { "TV_INPUT", 178 },<br>     { "STB_POWER", 179 },<br>     { "STB_INPUT", 180 },<br>     { "AVR_POWER", 181 },<br>     { "AVR_INPUT", 182 },<br>     { "PROG_RED", 183 },<br>     { "PROG_GREEN", 184 },<br>     { "PROG_YELLOW", 185 },<br>     { "PROG_BLUE", 186 },<br>     { "APP_SWITCH", 187 },<br>     { "BUTTON_1", 188 },<br>     { "BUTTON_2", 189 },<br>     { "BUTTON_3", 190 },<br>     { "BUTTON_4", 191 },<br>     { "BUTTON_5", 192 },<br>     { "BUTTON_6", 193 },<br>     { "BUTTON_7", 194 },<br>     { "BUTTON_8", 195 },<br>     { "BUTTON_9", 196 },<br>     { "BUTTON_10", 197 },<br>     { "BUTTON_11", 198 },<br>     { "BUTTON_12", 199 },<br>     { "BUTTON_13", 200 },<br>     { "BUTTON_14", 201 },<br>     { "BUTTON_15", 202 },<br>     { "BUTTON_16", 203 },<br>     { "LANGUAGE_SWITCH", 204 },<br>     { "MANNER_MODE", 205 },<br>     { "3D_MODE", 206 },<br>     { "CONTACTS", 207 },<br>     { "CALENDAR", 208 },<br>     { "MUSIC", 209 },<br>     { "CALCULATOR", 210 },<br>     { "ZENKAKU_HANKAKU", 211 },<br>     { "EISU", 212 },<br>     { "MUHENKAN", 213 },<br>     { "HENKAN", 214 },<br>     { "KATAKANA_HIRAGANA", 215 },<br>     { "YEN", 216 },<br>     { "RO", 217 },<br>     { "KANA", 218 },<br>     { "ASSIST", 219 },<br>     { "BRIGHTNESS_DOWN", 220 },<br>     { "BRIGHTNESS_UP", 221 },<br>     { "MEDIA_AUDIO_TRACK", 222 },</p> 
<p>    // NOTE: If you add a new keycode here you must also add it to several other files.<br>     //       Refer to frameworks/base/core/java/android/view/KeyEvent.java for the full list.</p> 
<p>    { NULL, 0 }<br> };<br> ————————————————<br> 版权声明：本文为CSDN博主「qq964541543」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br> 原文链接：https://blog.csdn.net/mjfh095215/article/details/104966173<br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67da1117fcb1978a31d845eb7091541c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">nvidia-smi Failed to initialize NVML: Driver/library version mismatch</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b14826a94c56d0157528f31441c60d8f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">矩阵分析L2 线性映射与线性变换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>