<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux LTP安装与使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux LTP安装与使用" />
<meta property="og:description" content="1. Introduction
1. Purposeof this document
LinuxTest Project (LTP) is an open source project with a goal to deliver test suitesto the open source community that validate the reliability, robustness, andstability of Linux. The LTP test suite is a collection of automated andsemi-automated tests for testing various aspects of the Linux operating system.The dominant programming language in LTP is ANSI-C (94%) followed by Bash (5%)and Perl (0.62%).
Thisdocument has several goals." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/85fe9108156b4d807dd91a2c8e85a832/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-04-22T17:07:00+08:00" />
<meta property="article:modified_time" content="2017-04-22T17:07:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux LTP安装与使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="content" id="articleContent"> 
 <p><br></p> 
 <p><strong><span style="color:#656565;">1.  </span><span style="color:#656565;">Introduction</span></strong></p> 
 <p><strong><span style="color:#656565;">1.    </span><span style="color:#656565;">Purposeof this document</span></strong></p> 
 <p><span style="color:#656565;">LinuxTest Project (LTP) is an open source project with a goal to deliver test suitesto the open source community that validate the reliability, robustness, andstability of Linux. The LTP test suite is a collection of automated andsemi-automated tests for testing various aspects of the Linux operating system.The dominant programming language in LTP is ANSI-C (94%) followed by Bash (5%)and Perl (0.62%).</span></p> 
 <p><span style="color:#656565;">Thisdocument has several goals. First, it provides a cursory view of the contentsof LTP test suite. Second, it introduces a template for writing test-cases inANSI-C and Shell. Finally, it enumerates the steps that must to be followedinorder to add a new test cases to LTP. The document reflects the authors viewson code layout and coding practices.</span></p> 
 <p><strong><span style="color:#656565;">2.    </span><span style="color:#656565;">Feedbackand corrections</span></strong></p> 
 <p><span style="color:#656565;">In aneffort to keep this document current and useful, any form of feedback isgreatly appreciated. Feel free to point out any mistakes in this document orcontribute additional information. Please e-mail</span><span style="color:#656565;"> </span><a href="mailto:shubham@linux.vnet.ibm.com" rel="nofollow"><span style="color:#0080FF;">shubham@linux.vnet.ibm.com</span></a><span style="color:#656565;"> </span><span style="color:#656565;">so that these changes can be made available in the nextversion.</span></p> 
 <p><strong><span style="color:#656565;">2.  </span><span style="color:#656565;">RevisionHistory</span></strong></p> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p><strong>Version</strong></p> </td><td> <p><strong>Author</strong></p> </td><td> <p><strong>Date</strong></p> </td><td> <p><strong>Comments</strong></p> </td></tr><tr><td> <p>1.0</p> </td><td> <p>Manoj Iyer<br> IBM Austin TX<br><a href="mailto:manjo@austin.ibm.com" rel="nofollow"><span style="color:#0080FF;">manjo @ austin.ibm.com</span></a></p> </td><td> <p>Jan 17 2003</p> </td><td> <p>Initial Draft</p> </td></tr><tr><td> <p>1.1</p> </td><td> <p>Shubham Goyal<br> IBM India, Bangalore<br><a href="mailto:shubham@linux.vnet.ibm.com" rel="nofollow"><span style="color:#0080FF;">shubham@linux.vnet.ibm.com</span></a></p> </td><td> <p>Apr 28 2012</p> </td><td> <p>Updated Various URL's and other documentation</p> </td></tr></tbody></table> 
 <p><strong><span style="color:#656565;">3.  </span><span style="color:#656565;">BeforeYou Begin</span></strong></p> 
 <p><span style="color:#656565;">Thissection will provide a cursory view of the contents of the LTP test suite, andalso provide instructions on downloading, compiling and executing the testsuite.</span></p> 
 <p><strong><span style="color:#656565;">1.    </span><span style="color:#656565;">Downloadingthe LTP test suite</span></strong></p> 
 <p><span style="color:#656565;">The stable version of the LTP test suite source,ltp-yyyymmdd.tgz is released on a monthly basis. The test suite may be used toverify stable and development release of the Linux kernel. The test suite isalso available in binary and source RPM format. The package ltp-yyyymmdd.tgzcan be downloaded from the</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/" rel="nofollow"><span style="color:#0080FF;">LTPweb-site</span></a><span style="color:#656565;"> </span><span style="color:#656565;">using a web browser or using the</span><span style="color:#656565;"> <em>'wget'</em> </span><span style="color:#656565;">command.</span></p> 
 <p><em><span style="color:#656565;">wget -chttp://prdownloads.sourceforge.net/ltp/ltp-full-yyyymmdd.tgz?download (Replaceyyyymmdd with appropriate values)</span></em><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">You can download the latest CVS snapshot of the LTP testsuite source via anonymous CVS access as follows.</span></p> 
 <p><em><span style="color:#656565;">cvs-d:pserver:anonymous@ltp.cvs.sourceforge.net:/cvsroot/ltp login</span></em></p> 
 <p><em><span style="color:#656565;">cvs -z3-d:pserver:anonymous@ltp.cvs.sourceforge.net:/cvsroot/ltp co ltp</span></em><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">Use the following to download without the CVS (directory)getting created in each subdirectory</span></p> 
 <p><em><span style="color:#656565;">cvs-d:pserver:anonymous@ltp.cvs.sourceforge.net:/cvsroot/ltp login</span></em></p> 
 <p><em><span style="color:#656565;">cvs -z3-d:pserver:anonymous@ltp.cvs.sourceforge.net:/cvsroot/ltp export -D "MONTHDAY, YEAR HH:MMam/pm" ltp</span></em><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">2.    </span><span style="color:#656565;">Contentsof the LTP test suite</span></strong></p> 
 <p><span style="color:#656565;">Thetop level directory or</span><span style="color:#656565;"> </span><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/" rel="nofollow"><span style="color:#0080FF;">LTP rootdirectory</span></a><span style="color:#656565;"> </span><span style="color:#656565;">./ltp-yyyymmdd contains SHELL scripts and various sourcedirectories. These scripts may be used to execute the test cases, the scriptsexecute the test cases using the test driver called</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/ltpmantemp.php?file=man1/pan.html" rel="nofollow"><span style="color:#0080FF;">pan</span></a><span style="color:#656565;">.</span></p> 
 <p><strong><span style="color:#656565;">Scripts</span></strong></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/IDcheck.sh" rel="nofollow"><strong><span style="color:#0080FF;">IDcheck.sh</span></strong></a></p> 
 <p><span style="color:#656565;">The test suite requires that certain users and groups(For example User:nobody Group:nobody.) exist on the system. This script willcreate these users and groups. This script is called from the top levelMakefile located in the LTP root directory.</span></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/runltp" rel="nofollow"><strong><span style="color:#0080FF;">runltp</span></strong></a></p> 
 <p><span style="color:#656565;">This driver script runs a majority of tests in the LTP.It can also be easily modified to run a custom list of tests if required.<br> By default, this script will execute:</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">filesystemstress tests</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">disk I/Otests</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">memorymanagement stress tests</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">ipcstress</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">schedulertests</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">commandsfunctional varification tests</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">systemcall functional varification tests</span></p> 
 <p><span style="color:#656565;">The script is named runalltest.sh but it does not run allthe tests in the LTP.</span></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/networktests.sh" rel="nofollow"><strong><span style="color:#0080FF;">networktests.sh</span></strong></a></p> 
 <p><span style="color:#656565;">This script executes the networking related tests. Beforeexecuting this script, two environment variables must be set RHOST (Remote HostName) and PASSWD (root password of the remote host).</span><span style="color:#656565;"> </span></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/diskio.sh" rel="nofollow"><strong><span style="color:#0080FF;">diskio.sh</span></strong></a></p> 
 <p><span style="color:#656565;">This script executes tests related to floppy and CD-ROMdrives. These tests require that a floppy disk and CD-ROM media be present inthe respective drives.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">Directories</span></strong></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/testcases/" rel="nofollow"><strong><span style="color:#0080FF;">testcases</span></strong></a></p> 
 <p><span style="color:#656565;">This directory contains the source code for all the testcases. The test cases are located under directories named after the subsystemor service they are intended to test. For example, memory management tests arelocated under testcases/mem etc.</span></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/runtest/" rel="nofollow"><strong><span style="color:#0080FF;">runtest</span></strong></a></p> 
 <p><span style="color:#656565;">This directory contains command files that are used by</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/ltpmantemp.php?file=man1/pan.html" rel="nofollow"><span style="color:#0080FF;">pan</span></a><span style="color:#656565;"> </span><span style="color:#656565;">to run the tests. Each file contains the name of the testcase "tag" and the "command" with arguments, if any, thatmust be executed to perform the test. For example, the file"syscalls" contains entries as follows.</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p><strong> # Name of test        Command</strong></p> <p><strong> access01              access01</strong></p> <p><strong> alarm04               cp -f $LTPROOT/test-cases/bin/sig_rev $TMP;alarm04</strong></p> <p><strong> chdir01A              symlink01 -T chdir01; chdir01</strong></p> </td></tr></tbody></table> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/lib/" rel="nofollow"><strong><span style="color:#0080FF;">lib</span></strong></a></p> 
 <p><span style="color:#656565;">This directory contains source code for the LTP-harnessAPIs (libltp.a). The libltp.a library gets linked with any test-case that usesthese API functions to log test results and status.</span></p> 
 <p><a href="http://ltp.cvs.sourceforge.net/ltp/ltp/include/" rel="nofollow"><strong><span style="color:#0080FF;">include</span></strong></a></p> 
 <p><span style="color:#656565;">This directory contains header files that are included inany test-case that uses the LTP API-harness functions.</span></p> 
 <p><strong><u><span style="color:#656565;">/opt/ltp/testcases/bin</span></u></strong></p> 
 <p><span style="color:#656565;">This directory contains the test executables, the testcases get installed in this directory by typing "make install".</span></p> 
 <p><strong><span style="color:#656565;">3.    </span><span style="color:#656565;">Compilingthe test suite</span></strong></p> 
 <p><span style="color:#656565;">Tocompile the test suite change directory to ltp-yyyymmdd and type"./configure" followed by "make". To install the testsuite, type "make install" as root user. This will create symboliclinks of the executable to corresponding files in ltp-yyyymmdd/ test-cases/bindirectory. The test scripts (runltp for example) execute the binaries presentin this directory based on the tests listed in its command file.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br> Note that, "make install" can be run as non-root, but IDcheck.sh mustbe run separately before executing any test cases as root.</span></p> 
 <p><strong><span style="color:#656565;">4.    </span><span style="color:#656565;">Executingthe test suite</span></strong></p> 
 <p><span style="color:#656565;">Currentlythere are three scripts that can be used to execute test cases in the LTP testsuite, namely, runltp , networktests.sh and diskio.sh. The test cases and thetest driver "pan", require certain environment variables to be setand certain directories to be present in order function correctly. Thesescripts take care of such pre-requisites. The scripts invoke the test driver"pan" with certain parameters and pan executes the tests and logstest results. The parameters that are be passed to pan can be controlled byuser provided options to the scripts.<br><br> The most frequently used script, runltp , currently provides the followingoptions. If no options are specified while executing this script, the defaultbehaviour is as follows:</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Run asingle iteration of all the default set of tests</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Verboseoutput of of test-case status on screen</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Doesnot produce any log file or test results by default</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        </p> <p>    -a EMAIL_TO     EMAIL all your Reports to this E-mail Address</p> <p>    -c NUM_PROCS    Run LTP under additional background CPU load</p> <p>                    [NUM_PROCS = no. of processes creating the CPU Load by spinning over sqrt()</p> <p>                                 (Defaults to 1 when value)]</p> <p>    -C FAILCMDFILE  Command file with all failed test cases.</p> <p>    -d TMPDIR       Directory where temporary files will be created.</p> <p>    -D NUM_PROCS,NUM_FILES,NUM_BYTES,CLEAN_FLAG</p> <p>                    Run LTP under additional background Load on Secondary Storage (Seperate by comma)</p> <p>                    [NUM_PROCS   = no. of processes creating Storage Load by spinning over write()]</p> <p>                    [NUM_FILES   = Write() to these many files (Defaults to 1 when value 0 or undefined)]</p> <p>                    [NUM_BYTES   = write these many bytes (defaults to 1GB, when value 0 or undefined)]</p> <p>                    [CLEAN_FLAG  = unlink file to which random data written, when value 1]</p> <p>    -e              Prints the date of the current LTP release</p> <p>    -f CMDFILES     Execute user defined list of testcases (separate with ',')</p> <p>    -g HTMLFILE     Create an additional HTML output format</p> <p>    -h              Help. Prints all available options.</p> <p>    -i NUM_PROCS    Run LTP under additional background Load on IO Bus</p> <p>                    [NUM_PROCS   = no. of processes creating IO Bus Load by spinning over sync()]</p> <p>    -l LOGFILE      Log results of test in a logfile.</p> <p>    -m NUM_PROCS,CHUNKS,BYTES,HANGUP_FLAG</p> <p>                    Run LTP under additional background Load on Main memory (Seperate by comma)</p> <p>                    [NUM_PROCS   = no. of processes creating main Memory Load by spinning over malloc()]</p> <p>                    [CHUNKS      = malloc these many chunks (default is 1 when value 0 or undefined)]</p> <p>                    [BYTES       = malloc CHUNKS of BYTES bytes (default is 256MB when value 0 or undefined) ]</p> <p>                    [HANGUP_FLAG = hang in a sleep loop after memory allocated, when value 1]</p> <p>    -N              Run all the networking tests. </p> <p>    -n              Run LTP with network traffic in background.</p> <p>    -o OUTPUTFILE   Redirect test output to a file.</p> <p>    -p              Human readable format logfiles. </p> <p>    -q              Print less verbose output to screen.</p> <p>    -r LTPROOT      Fully qualified path where testsuite is installed.</p> <p>    -s PATTERN      Only run test cases which match PATTERN.</p> <p>    -t DURATION     Execute the testsuite for given duration. Examples:</p> <p>                      -t 60s = 60 seconds</p> <p>                      -t 45m = 45 minutes</p> <p>                      -t 24h = 24 hours</p> <p>                      -t 2d  = 2 days</p> <p>    -T REPETITION   Execute the testsuite for REPETITION no. of times</p> <p>    -v              Print more verbose output to screen.                   </p> <p>    -w CMDFILEADDR  Uses wget to get the user's list of testcases.</p> <p>    -x INSTANCES    Run multiple instances of this testsuite.</p> <p>                                                          </p> </td></tr></tbody></table> 
 <p><span style="color:#656565;"><br><strong>Execuing default set of tests</strong><br> If you wish to execute the default set of test case, you can use the followingcommands.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Changedirectory to /opt/ltp/</span><span style="color:#656565;"> </span><span style="color:#656565;"><br></span><em><span style="color:#656565;">cd/opt/ltp/</span></em></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Executerunltp script with the following options, or chose the options that are bestsuited for you from the list above.</span><span style="color:#656565;"> <em>./runltp -p -l result.yyyymmdd.log</em></span></p> 
 <p><span style="color:#656565;"><br><strong>Executing user defined set of tests</strong><br> If you wish to run a select set of test cases, you have to do the following.</span></p> 
 <p><span style="color:#656565;">§  </span><span style="color:#656565;">Create a command file. The command file contains the nameof the test case "tag" and the "test case" with arguments,if any, that must be executed to perform the test. For example.</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>#Tag       Test case<br> #---------------------------------------<br> mtest01     mtest01 -p 10<br> mmstress    mmstress -x 100<br> fork01      fork01<br> chdir01     symlink01 -T chdir01<br> #----------------------------------------</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Changeto the directory where LTP is installed i.e. /opt/ltp/<br></span><em><span style="color:#656565;">cd/opt/ltp/</span></em></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Executetests in command file using runltp . You can execute runltp with the</span><span style="color:#656565;"> <em>-f command file </em></span><span style="color:#656565;">option to execute these tests.<br></span><em><span style="color:#656565;">./runltp-p -l result.02.log -f my_command_file</span></em></p> 
 <p><strong><span style="color:#656565;">5.    </span><span style="color:#656565;">Contentsof output to screen and logfile</span></strong></p> 
 <p><strong><span style="color:#656565;">Outputto screen</span></strong><span style="color:#656565;"><br> The test cases, test driver, and scripts print various informational messagesto the screen. The test cases use the USCTEST functions to print information,the test driver "pan", prints tags that separate output from one testto another. Depending on the options that you may choose while running thescripts, the verbosity of these messages can be adjusted. For example.</span></p> 
 <p><span style="color:#656565;">§  </span><span style="color:#656565;">Screen output of the command</span><span style="color:#656565;"> <em>runltp -p -lresults.03.log -f my_command_file </em></span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        If some fields are empty or look unusual you may have an old version.</p> <p>        Compare to the current minimal requirements in Documentation/Changes.</p> <p> </p> <p>        /etc/issue:</p> <p>        Debian GNU/\s testing/unstable \n \l</p> <p> </p> <p>        Linux lazy 2.4.19 #1 Mon Aug 26 14:25:41 CDT 2002 i686 unknown</p> <p> </p> <p>        Gnu C                  2.95.4</p> <p>        Gnu make               3.80</p> <p>        util-linux             2.11x</p> <p>        mount                  2.11x</p> <p>        modutils               2.4.21</p> <p>        e2fsprogs              1.32</p> <p>        Linux C Library        2.3.1</p> <p>        Dynamic linker (ldd)   2.3.1</p> <p>        Procps                 3.1.1</p> <p>        Net-tools              1.60</p> <p>        Kbd                    66:</p> <p>        Sh-utils               2.0.11</p> <p>        Modules Loaded         soundcore uhci usbcore vfat fat</p> <p>        free -m reports:</p> <p>                     total       used       free     shared    buffers     cached</p> <p>        Mem:           249        211         37          0          4        135</p> <p>        -/+ buffers/cache:         71        178</p> <p>        Swap:          258         49        208</p> <p> </p> <p>        /proc/cpuinfo</p> <p>        processor       : 0</p> <p>        vendor_id       : GenuineIntel</p> <p>        cpu family      : 6</p> <p>        model           : 8</p> <p>        model name      : Pentium III (Coppermine)</p> <p>        stepping        : 10</p> <p>        cpu MHz         : 863.881</p> <p>        cache size      : 256 KB</p> <p>        fdiv_bug        : no</p> <p>        hlt_bug         : no</p> <p>        f00f_bug        : no</p> <p>        coma_bug        : no</p> <p>        fpu             : yes</p> <p>        fpu_exception   : yes</p> <p>        cpuid level     : 2</p> <p>        wp              : yes</p> <p>        flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov</p> <p>        pat pse36 mmx fxsr sse</p> <p>        bogomips        : 1723.59</p> <p> </p> <p>        t_start&gt;&gt;&gt;</p> <p>        tag=mtest01 stime=1043946397</p> <p>        cmdline="    mtest01"</p> <p>        contacts=""</p> <p>        analysis=exit</p> <p>        initiation_status="ok"</p> <p>        (((test_output)))</p> <p>        stopped at 3076521984 bytes</p> <p>        (((execution_status)))</p> <p>        duration=0 termination_type=exited termination_id=1 corefile=no</p> <p>        cutime=1 cstime=9</p> <p>        (((test_end)))</p> <p> </p> <p>        INFO: run mmstress -h for all options</p> <p> </p> <p>        test1: Test case tests the race condition between</p> <p>        simultaneous read faults in the same address space.</p> <p>        (((test_start)))</p> <p>        tag=mmstress stime=1043946397</p> <p>        cmdline="   mmstress "</p> <p>        contacts=""</p> <p>        analysis=exit</p> <p>        initiation_status="ok"</p> <p>        (((test_output)))</p> <p>        test2: Test case tests the race condition between</p> <p>        simultaneous write faults in the same address space.</p> <p>        test3: Test case tests the race condition between</p> <p>        simultaneous COW faults in the same address space.</p> <p>        test4: Test case tests the race condition between</p> <p>        simultaneous READ faults in the same address space.</p> <p>        The file maped is /dev/zero</p> <p>        test5: Test case tests the race condition between</p> <p>        simultaneous fork - exit faults in the same address space.</p> <p> </p> <p>        </p> <p><em>               more messages here skipped.</em></p> <p><em>        </em></p> <p>        (((execution_status)))</p> <p>        duration=41 termination_type=exited termination_id=0 corefile=no</p> <p>        cutime=605 cstime=3443</p> <p>        (((test_end)))</p> <p>        (((test_start)))</p> <p>        tag=fork01 stime=1043946438</p> <p>        cmdline="     fork01"</p> <p>        contacts=""</p> <p>        analysis=exit</p> <p>        initiation_status="ok"</p> <p>        (((test_output)))</p> <p>        fork01      1  PASS  :  fork() returned 11825</p> <p>        fork01      2  PASS  :  child pid and fork() return agree: 11825</p> <p>        (((execution_status)))</p> <p>        duration=0 termination_type=exited termination_id=0 corefile=no</p> <p>        cutime=0 cstime=0</p> <p>        (((test_end)))</p> <p>        (((test_start)))</p> <p>        tag=chdir01A stime=1043946438</p> <p>        cmdline="   symlink01 -T chdir01"</p> <p>        contacts=""</p> <p>        analysis=exit</p> <p>        initiation_status="ok"</p> <p>        (((test_output)))</p> <p>        incrementing stop</p> <p>        chdir01     1  PASS  :  chdir(2) to object file location through symbolic link</p> <p>        file is ok</p> <p>        chdir01     2  PASS  :  chdir(2) to non-existent object file location through</p> <p>        symbolic link file failed as expected</p> <p>        chdir01     3  PASS  :  Nested symbolic link access condition caught.  ELOOP is</p> <p>        returned</p> <p>        (((execution_status)))</p> <p>        duration=0 termination_type=exited termination_id=0 corefile=no</p> <p>        cutime=0 cstime=1</p> <p>        (((test_end)))</p> <p>        pan reported FAIL</p> <p> </p> <p>        ###############################################################</p> <p> </p> <p>        result log is in the /home/manjo/cvs_tree/ltp/results directory</p> <p> </p> <p>        ###############################################################</p> <p>                                                     </p> </td></tr></tbody></table> 
 <p><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§  </span><span style="color:#656565;">Screen output of the command</span><span style="color:#656565;"> <em>runltp -q -p -lresult.04.log -f my_command_file </em></span><span style="color:#656565;">(Providing the</span><span style="color:#656565;"> <em>-q </em></span><span style="color:#656565;">option to runlt runltp will supress certain messages).</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        If some fields are empty or look unusual you may have an old version.</p> <p>        Compare to the current minimal requirements in Documentation/Changes.</p> <p> </p> <p>        /etc/issue:</p> <p>        Debian GNU/\s testing/unstable \n \l</p> <p> </p> <p>        Linux lazy 2.4.19 #1 Mon Aug 26 14:25:41 CDT 2002 i686 unknown</p> <p> </p> <p>        Gnu C                  2.95.4</p> <p>        Gnu make               3.80</p> <p>        util-linux             2.11x</p> <p>        mount                  2.11x</p> <p>        modutils               2.4.21</p> <p>        e2fsprogs              1.32</p> <p>        Linux C Library        2.3.1</p> <p>        Dynamic linker (ldd)   2.3.1</p> <p>        Procps                 3.1.1</p> <p>        Net-tools              1.60</p> <p>        Kbd                    66:</p> <p>        Sh-utils               2.0.11</p> <p>        Modules Loaded         soundcore uhci usbcore vfat fat</p> <p> </p> <p>        free -m reports:</p> <p>                     total       used       free     shared    buffers     cached</p> <p>        Mem:           249        212         37          0          4        134</p> <p>        -/+ buffers/cache:         73        175</p> <p>        Swap:          258         49        208</p> <p> </p> <p>        </p> <p><em>               more messages here skipped.</em></p> <p><em>        </em></p> <p> </p> <p>        test1: Test case tests the race condition between</p> <p>        simultaneous read faults in the same address space.</p> <p>        test2: Test case tests the race condition between</p> <p>        simultaneous write faults in the same address space.</p> <p>        test3: Test case tests the race condition between</p> <p>        simultaneous COW faults in the same address space.</p> <p>        test4: Test case tests the race condition between</p> <p>        simultaneous READ faults in the same address space.</p> <p>        The file maped is /dev/zero</p> <p>        test5: Test case tests the race condition between</p> <p>        simultaneous fork - exit faults in the same address space.</p> <p>        test6: Test case tests the race condition between</p> <p>        simultaneous fork -exec - exit faults in the same</p> <p>        address space.</p> <p>        fork01      1  PASS  :  fork() returned 12156</p> <p>        fork01      2  PASS  :  child pid and fork() return agree: 12156</p> <p>        chdir01     1  PASS  :  chdir(2) to object file location through symbolic link</p> <p>        file is ok</p> <p>        chdir01     2  PASS  :  chdir(2) to non-existent object file location through</p> <p>        symbolic link file failed as expected</p> <p>        chdir01     3  PASS  :  Nested symbolic link access condition caught.  ELOOP is</p> <p>        returned</p> <p>        pan reported FAIL</p> <p> </p> <p>        ###############################################################</p> <p> </p> <p>        result log is in the /home/manjo/cvs_tree/ltp/results directory</p> <p> </p> <p>        ###############################################################</p> <p>                                                     </p> </td></tr></tbody></table> 
 <p><strong><span style="color:#656565;">Output to log file</span></strong><span style="color:#656565;"><br> The test driver pan uses the exit value of the test case to decide success orfailure of a test. If the test case exits with a non-zero value pan recordsthis as FAIL, if the test case exits with a value zero pan records this asPASS. The test driver "pan" generates log files, these logfilescontain results from executing the test case. You can provide the</span><span style="color:#656565;"> <em>-l logfile_name </em></span><span style="color:#656565;">option to runalltest.sh script in order to log results.If the use does not provide an absolute path, the file is created under theresults directory. Currently, the result log file is generated in two formats.</span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§  </span><strong><span style="color:#656565;">Human readable format</span></strong><span style="color:#656565;"><br> You can generate a logfile in this format by providing runltp with the</span><span style="color:#656565;"> <em>-p </em></span><span style="color:#656565;">option. This generates a log file in ASCII format, forexample.</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        Test Start Time: Thu Jan 30 11:06:37 2003</p> <p>        -----------------------------------------</p> <p>        Testcase                       Result     Exit Value</p> <p>        --------                       ------     ----------</p> <p>        mtest01                        FAIL       1</p> <p>        mmstress                       PASS       0</p> <p>        fork01                         PASS       0</p> <p>        chdir01A                       PASS       0</p> <p>        -----------------------------------------------</p> <p>        Total Tests: 4</p> <p>        Total Failures: 1</p> <p>        Kernel Version: 2.4.19</p> <p>        Machine Architecture: i686</p> <p>        Hostname: lazy</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">§  </span><strong><span style="color:#656565;">Script readable format</span></strong><span style="color:#656565;"><br> This is the default format and may be used by scripts that are designed togenerate test result analysis reports. The file generated in ASCII format. Forexample.</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        tag=mtest01 stime=1043947511 dur=0 exit=exited stat=1 core=no cu=0 cs=11</p> <p>        tag=mmstress stime=1043947511 dur=41 exit=exited stat=0 core=no cu=671 cs=3383</p> <p>        tag=fork01 stime=1043947552 dur=0 exit=exited stat=0 core=no cu=0 cs=1</p> <p>        tag=chdir01A stime=1043947552 dur=0 exit=exited stat=0 core=no cu=0 cs=0</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">4.  </span><span style="color:#656565;">Developingtests in ANSI-C using LTP test harness API's</span></strong></p> 
 <p><span style="color:#656565;">At thetime of this writing, LTP has 156,775 physical source lines of code. The most dominantprogramming language is ANSI-C (94.43%) followed by shell (4.60%) and Perl(0.62%). This section provides an introduction to developing new test cases inANSI-C using LTP test harness APIs.</span></p> 
 <p><strong><span style="color:#656565;">1.    </span><span style="color:#656565;">Basictemplate</span></strong></p> 
 <p><span style="color:#656565;">Thissection provides a basic template that may be used to develop test-cases inANSI-C using LTP harness APIs. Please note that the following code will notcompile as is.</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>/******************************************************************************/</p> <p>/*                                                                            */</p> <p>/* Copyright (c) International Business Machines  Corp., 2001                 */</p> <p>/*                                                                            */</p> <p>/* This program is free software;  you can redistribute it and/or modify      */</p> <p>/* it under the terms of the GNU General Public License as published by       */</p> <p>/* the Free Software Foundation; either version 2 of the License, or          */</p> <p>/* (at your option) any later version.                                        */</p> <p>/*                                                                            */</p> <p>/* This program is distributed in the hope that it will be useful,            */</p> <p>/* but WITHOUT ANY WARRANTY;  without even the implied warranty of            */</p> <p>/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See                  */</p> <p>/* the GNU General Public License for more details.                           */</p> <p>/*                                                                            */</p> <p>/* You should have received a copy of the GNU General Public License          */</p> <p>/* along with this program;  if not, write to the Free Software               */</p> <p>/* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA    */</p> <p>/*                                                                            */</p> <p>/******************************************************************************/</p> <p> </p> <p>/******************************************************************************/</p> <p>/*                                                                            */</p> <p>/* File:        template.c                                                    */</p> <p>/*                                                                            */</p> <p>/* Description: This is a template that can be used to develop new test-cases */</p> <p>/*              using the LTP-harness APIs. As an example a dummy_syscall()   */</p> <p>/*              system call will be used as an example.                       */</p> <p>/*                                                                            */</p> <p>/* Total Tests: 1                                                             */</p> <p>/*                                                                            */</p> <p>/* Test Name:   dummy_syscall_test01                                          */</p> <p>/*                                                                            */</p> <p>/* Test Assertion                                                             */</p> <p>/* amp; Strategy:  A brief description of the test Assertion and Strategy     */</p> <p>/*                                                                            */</p> <p>/* Author:      Manoj Iyer manjo@austin.ibm.com                               */</p> <p>/*                                                                            */</p> <p>/* History:     Created - Jan 19 2003 - Manoj Iyer manjo@austin.ibm.com       */</p> <p>/*              Added   - Jan 20 2003 - Manoj Iyer, comments describing the   */</p> <p>/*                                      the functions used by the test-case.  */</p> <p>/*                                                                            */</p> <p>/******************************************************************************/</p> <p> </p> <p>/* Standard Include Files */</p> <p>#include &lt;stdio.h&gt;</p> <p>#include &lt;stdlib.h&gt;</p> <p>#include &lt;errno.h&gt;</p> <p> </p> <p>        /* Harness Specific Include Files. */</p> <p>        #include "test.h"</p> <p>        #include "usctest.h"</p> <p> </p> <p>        /* Local Defines */</p> <p>        #if !defined(TRUE) amp;amp; !defined(FALSE)</p> <p>        #define TRUE  1</p> <p>        #define FALSE 0</p> <p>        #endif</p> <p> </p> <p>        /* Extern Global Variables */</p> <p>        extern int  Tst_count;               /* counter for tst_xxx routines.         */</p> <p>        extern char *TESTDIR;                /* temporary dir created by tst_tmpdir() */</p> <p> </p> <p>        /* Global Variables */</p> <p>        char *TCID     = "dummy_syscall_test01"; /* test program identifier.          */</p> <p>        int  TST_TOTAL = 1;                  /* total number of tests in this file.   */</p> <p> </p> <p>        /* Extern Global Functions */</p> <p>        /******************************************************************************/</p> <p>        /*                                                                            */</p> <p>        /* Function:    cleanup                                                       */</p> <p>        /*                                                                            */</p> <p>        /* Description: Performs all one time clean up for this test on successful    */</p> <p>        /*              completion,  premature exit or  failure. Closes all temporary */</p> <p>        /*              files, removes all temporary directories exits the test with  */</p> <p>        /*              appropriate return code by calling tst_exit() function.       */</p> <p>        /*                                                                            */</p> <p>        /* Input:       None.                                                         */</p> <p>        /*                                                                            */</p> <p>        /* Output:      None.                                                         */</p> <p>        /*                                                                            */</p> <p>        /* Return:      On failure - Exits calling tst_exit(). Non '0' return code.   */</p> <p>        /*              On success - Exits calling tst_exit(). With '0' return code.  */</p> <p>        /*                                                                            */</p> <p>        /******************************************************************************/</p> <p>        extern void</p> <p>        cleanup()</p> <p>        {<!-- --></p> <p>        /* Close all open file descriptors. */</p> <p>        </p> <p><em>               Insert code here. In case an unexpected failure occurs report it</em></p> <p><em>               and exit setup(), the following lines of code will demonstrate</em></p> <p><em>               this.</em></p> <p><em>        </em></p> <p>        if (close(fd) == -1)</p> <p>        {<!-- --></p> <p>        tst_resm(TWARN, "close(%s) Failed, errno=%d : %s",</p> <p>        fname, errno, strerror(errno));</p> <p>        }</p> <p> </p> <p>        /* Remove all temporary directories used by this test. */</p> <p> </p> <p>        <em>Insert real code here </em></p> <p> </p> <p>        /* kill child processes if any. */</p> <p> </p> <p>        <em>Insert code here</em></p> <p> </p> <p>        /* Exit with appropriate return code. */</p> <p> </p> <p>        tst_exit();</p> <p>        }</p> <p> </p> <p> </p> <p>        /* Local  Functions */</p> <p>        /******************************************************************************/</p> <p>        /*                                                                            */</p> <p>        /* Function:    setup                                                         */</p> <p>        /*                                                                            */</p> <p>        /* Description: Performs all one time setup for this test. This function is   */</p> <p>        /*              typically used to capture signals, create temporary dirs      */</p> <p>        /*              and temporary files that may be used in the course of this    */</p> <p>        /*              test.                                                         */</p> <p>        /*                                                                            */</p> <p>        /* Input:       None.                                                         */</p> <p>        /*                                                                            */</p> <p>        /* Output:      None.                                                         */</p> <p>        /*                                                                            */</p> <p>        /* Return:      On failure - Exits by calling cleanup().                      */</p> <p>        /*              On success - returns 0.                                       */</p> <p>        /*                                                                            */</p> <p>        /******************************************************************************/</p> <p>        void</p> <p>        setup()</p> <p>        {<!-- --></p> <p>        /* Capture signals. */</p> <p> </p> <p>        <em>Insert code here</em></p> <p> </p> <p>        /* Create temporary directories */</p> <p> </p> <p>        <em>Insert code here</em></p> <p> </p> <p>        /* Create temporary files. */</p> <p>        </p> <p><em>               Insert real code here. In case an unexpected failure occurs</em></p> <p><em>               report it and exit setup(). Follow the code below for example.</em></p> <p><em>        </em></p> <p>        if ((fd = open(fname, O_RDWR|O_CREAT, 0700)) == -1 )</p> <p>        {<!-- --></p> <p>        tst_brkm(TBROK, cleanup,</p> <p>        "Unable to open %s for read/write.  Error:%d, %s\n",</p> <p>        fname, errno, strerror(errno));</p> <p>        }</p> <p> </p> <p>        return;</p> <p>        }</p> <p> </p> <p> </p> <p>        /******************************************************************************/</p> <p>        /*                                                                            */</p> <p>        /* Function:    main                                                          */</p> <p>        /*                                                                            */</p> <p>        /* Description: Entry point to this test-case. It parses all the command line */</p> <p>        /*              inputs, calls the global setup and executes the test. It logs */</p> <p>        /*              the test status and results appropriately using the LTP API's */</p> <p>        /*              On successful completion or premature failure, cleanup() func */</p> <p>        /*              is called and test exits with an appropriate return code.     */</p> <p>        /*                                                                            */</p> <p>        /* Input:       Describe input arguments to this test-case                    */</p> <p>        /*               -l - Number of iteration                                     */</p> <p>        /*               -v - Prints verbose output                                   */</p> <p>        /*               -V - Prints the version number                               */</p> <p>        /*                                                                            */</p> <p>        /* Exit:       On failure - Exits by calling cleanup().                       */</p> <p>        /*             On success - exits with 0 exit value.                          */</p> <p>        /*                                                                            */</p> <p>        /******************************************************************************/</p> <p>        int</p> <p>        main(int   argc,    /* number of command line parameters                      */</p> <p>         char **argv)   /* pointer to the array of the command line parameters.   */</p> <p>        {<!-- --></p> <p> </p> <p>        /* parse options. */</p> <p>        </p> <p><em>               LTP test harness provides a function called parse_opts() that</em></p> <p><em>               may be used to parse standard options. For a list of standard</em></p> <p><em>               option that are available refer </em><a href="http://ltp.sourceforge.net/ltpman.php" rel="nofollow"><em><span style="color:#0080FF;">on-line man page</span></em></a><em> at the LTP</em></p> <p><em>               web-site</em></p> <p><em>        </em></p> <p>        /* perform global test setup, call setup() function. */</p> <p>        setup();</p> <p> </p> <p>        /* Print test Assertion using tst_resm() function with argument TINFO. */</p> <p>        tst_resm(TINFO, "Testing if dummy_syscall() function works\n");</p> <p> </p> <p>        /* Test Case Body. */</p> <p>        </p> <p><em>               Insert real code goes here. In case of unexpected failure, or</em></p> <p><em>               failure not directly related to the entity being tested report</em></p> <p><em>               using tst_brk() or tst_brkm() functions.</em></p> <p><em>        </em></p> <p>        if (<em>something bad happened</em>)</p> <p>        {<!-- --></p> <p>        tst_brkm(TBROK, cleanup, "Unable to open test file %s\n", fname);</p> <p>        }</p> <p> </p> <p>        /* print results and exit test-case */</p> <p>        if(<em>results are favorable</em>)</p> <p>        tst_resm(TPASS, "dummy_syscall worked as designed\n");</p> <p>        else</p> <p>        tst_resm(TFAIL, "dummy_syscall failed to work as designed\n");</p> <p> </p> <p>        tst_exit()</p> <p>        }</p> </td></tr></tbody></table> 
 <p><strong><span style="color:#656565;">2.    </span><span style="color:#656565;">Understandingthe template</span></strong></p> 
 <p><strong><span style="color:#656565;">Copyrights and license statement</span></strong></p> 
 <p><span style="color:#656565;">Each test-case starts with a copyright and licensestatement. All test-cases in LTP are covered under the</span><span style="color:#656565;"> </span><a href="http://www.gnu.org/copyleft/gpl.html" rel="nofollow"><span style="color:#0080FF;">GNU public license</span><span style="color:#0080FF;"> </span></a><span style="color:#656565;">. Copyrights usually belong to the author or corporationthat developed the tests. Test case developed by IBM will have IBM copyrights,and test cases developed by SGI will have SGI copyrights and so on.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">File header</span></strong></p> 
 <p><span style="color:#656565;">The file header contains information contained in thetest case file under five main categories, these are as follows.</span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">File:Name of the test case file. For example test01.c</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Description:A brief description of the contents of this file, explains what this filecontains, namely, a test case to test functionality of certain system call etc.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">TotalTests: Total number of test cases in this file.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">TestName: Name of the test case</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">TestAssertion amp; Strategy: A brief description of the test Assertion andStrategy.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">History:Date of creation or modification, Author and email address. Followed bycomments that describes the change.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br> For example: Created - Jan 19 2003 - Manoj Iyer manjo@austin.ibm.com</span></p> 
 <p><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">Standard include and header files</span></strong></p> 
 <p><span style="color:#656565;">Theseinclude files must be based on recommendations made in the man pages ofstandard C library (libc) APIs that are used by the test case. Standard includefiles are followed by LTP harness specific header files and any other localheader file that the test might use.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">Global variable definitions</span></strong></p> 
 <p><span style="color:#656565;">Includeany global definitions, external global variables, and variables that areglobal to this test case. The variables Tst_count, TST_TOTAL and TCID are usedby the harness APIs for reporting status and test results. These are theminimum set of variables that must be defined in order to use the basicfunctions (tst_brk, tst_brkm, tst_res, tst_resm and tst_exit) to report teststatus.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">Global function definitions</span></strong></p> 
 <p><span style="color:#656565;">Thevariable definition is followed by global function definitions, it isrecommended that the developer define at least one function, namely, cleanup()and optionally a setup() as global extern function. The cleanup() function mustbe supplied to tst_brk() routine, this routine is used to report premature testfailure. The cleanup() function will call the tst_exit() function which willexit with appropriate exit values.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">main()</span></strong></p> 
 <p><span style="color:#656565;">Function definitions are followed by main(), the entrypoint to the test case. The activities expected from main() can be summarizedas follows:</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">parseinput options.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">callsetup function or perform tasks that are a pre-requisite to perform tests.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">printthe test assertion.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">performthe test.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">printtest results.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">cleanup and exit with appropriate exit code.</span></p> 
 <p><span style="color:#656565;">TheLTP harness library provides certain macros and functions in an attempt tosimplify some of the above activities or help manage results and test statuseasily. For instance, The</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/ltpmantemp.php?file=man3/usctest.html" rel="nofollow"><span style="color:#0080FF;">USCTEST macros and functions</span><span style="color:#0080FF;"> </span></a><span style="color:#656565;">mightbe helpful for testing system calls. Below is an example of such a function.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br><br> The parse_opt() function, for instance, may be used to parse standard (orbuilt-in) options or user defined options to the test case. It supports a setof pre-defined standard options with the flexibility of adding more userdefined options.</span><span style="color:#656565;"> </span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        char *</p> <p>        parse_opts(int      argc,  char   *argv[], option_t option_array[], void (*user_help_func)());</p> <p>        </p> <p>        where option_t is:</p> <p>        </p> <p>        typedef struct {<!-- --></p> <p>        char    *option;</p> <p>        int     *flag;</p> <p>        char    **arg;</p> <p>        } option_t;</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;"><br> User defined options may be specified in the option_array argument. A help() orusage() function may be specified in the user_help_func argument.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br><br> Although using these macros and functions are left to the developer'sdiscretion, the use of tst_resm/tst_res, tst_brk/tst_brkm,tst_brkloop/tst_brkloopm, and tst_exit functions is highly recommended. Fordetails on usage and syntax please refer man pages on(http://ltp.sourceforge.net) the LTP website.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br> The tst_brk/tst_brkm functions are typically used in a situation where a testcase breaks as a result of something other than the entity that is being testedfails. The tst_resm/tst_res functions may be used to print various messagedepending on the result type passed to it as argument. The result type may beone of the following.</span></p> 
 <p><strong><span style="color:#656565;">TINFO</span></strong></p> 
 <p><span style="color:#656565;">Print informational messages that report test executionstatus, test assertion , or other informational message. For example.</span></p> 
 <p><span style="color:#656565;">test01   0  INFO  :  Thistest will test the uname command.</span></p> 
 <p><strong><span style="color:#656565;">TPASS</span></strong></p> 
 <p><span style="color:#656565;">Print the test case result. The tst_resm/tst_res functionprints related messages to the screen indicating a test success. The test casewill exit with a zero exit value when tst_exit function is called.</span></p> 
 <p><span style="color:#656565;">test01   0  PASS  : uname command works as expected.</span></p> 
 <p><strong><span style="color:#656565;">TFAIL</span></strong></p> 
 <p><span style="color:#656565;">Print the test case result. The tst_resm/tst_res functionprints related messages to the screen indicating a test failure. The test willexit with a non-zero exit value when tst_exit function is called.</span></p> 
 <p><span style="color:#656565;">test01   0  PASS  : uname command exited with error code = 255</span></p> 
 <p><strong><span style="color:#656565;">TWARN</span></strong></p> 
 <p><span style="color:#656565;">Print warning messages. For example, when systemresources are low.</span></p> 
 <p><span style="color:#656565;">test01   0  PASS  : System low on memory, test case might fail.</span></p> 
 <p><strong><span style="color:#656565;">3.    </span><span style="color:#656565;">Recommendationon coding style</span></strong></p> 
 <p><span style="color:#656565;">Thissection includes recommendations on code layout and style. They are optional,it reflects the authors personal coding style and practice and may beapplicable in general to any program written in ANSI-C.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Use afile header to describe the contents of a file and maintain a change history.CVS provides the option to maintain a change log while checking in code intothe CVS tree, but often times the developer need not be responsible formaintaining the code in CVS. The change log or history maintained in the filecan help both the developer and the maintainer of the code to track changesmade to the file.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Usemeaningful variable names. Avoid variable names like "i";"j", instead use variable names like "index","array_ndx" etc. Also initialize and comment the variablesappropriately. For example a for loop counter may be defined as follows:<br> int loop_cntr = 0; /* counter to keep track of number of iterations */<br> instead of defining the same as:<br> int j;</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Commentcode appropriately. Code might be handled by seasoned programmers as well asnewbies. It is a good practice to add comments in the code where everappropriate for maintainance reasons. Comments can be stripped off from thecode using AWK or PERL scripts if required.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Use"/* --- */" style for comments, avoid using the "//" C++style comments.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">UseANSI-C style function names instead of C++ style function names, for example</span></p> 
 <p><span style="color:#656565;">create_file()</span></p> 
 <p><span style="color:#656565;">instead of</span></p> 
 <p><span style="color:#656565;">CreateFile()</span></p> 
 <p><span style="color:#656565;">Declare functions local to the file as"static". Start the function names in a new line, and each input oroutput variable in separate lines with appropriate comments. For example:</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        static int</p> <p>        create_tmpfile(char    *fname, /* name of temporary file created by test01  */</p> <p>        int     flags,  /* describes file as read, write only etc    */</p> <p>        mode_t  mode)   /* file open modes, S_IRWXO etc.             */</p> <p>        { </p> <p>        }</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Use afunction prologue. The prologue should describe the function, its input andoutput variables if any, and exit or return values if any. Using a functionprologue is a good practice that makes code readable and maintainable. Refer tothe template for an example.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Checkwith man pages for #include &lt;include file=""/&gt; recommendationwhen using standard C library (libc) functions. Avoid using unnecessary headerfiles.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Checkfor return values from system calls. Report reason appropriately using thetst_brkm() API. The recommended style is as follows:</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        if ((ret = open(filename, O_RDWR|O_CREAT, S_IRWXO|S_IRWXU|S_IRWXG)) == -1)</p> <p>        {<!-- --></p> <p>               tst_brkm(TBROK, cleanup, "open(): Failed %s\n",  strerror(errno));</p> <p>        }</p> <p>        else{}</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Usetst_resm(TINFO, ...) to print informational messages as appropriate,alternately, a verbose option or a 'quiet' option may be provided to suppressor activate such messages.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Usespaces instead of tab characters. Typically four spaces may be used instead ofa tab character.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Compilecode using the "-Wall" option. Using this option, the compiler willgenerate more warning than when compiled without "-Wall". Treat allwarnings generated by the compiler as errors and try to minimize them.</span></p> 
 <p><strong><span style="color:#656565;">4.    </span><span style="color:#656565;">More help</span></strong></p> 
 <p><span style="color:#656565;">LTPtest suite has over a thousand test cases that can be studied in order tounderstand the use of the LTP APIs. For more information on syntax and usagefollow the "LTP Man Pages" link on the online man page located athttp://ltp.sourceforge.net under "Documentation" section. You canfind man pages for the LTP APIs, USCTEST macros and test driver"pan", in the ltp-yyyymmdd/doc/ directory.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">5.  </span><span style="color:#656565;">Developingtests in Bash using the LTP command line harness interface</span></strong></p> 
 <p><span style="color:#656565;">Limitednumber of test in the LTP test suite are written in Shell scripts (4.6%).Currently, the focus of the LTP test suite is the reliablity and stability ofthe Linux kernel. However, there is increasing interest in writing tests forother parts of the Linux operating system (for example deamons, services,etc.). It might be required to develop these tests in a language other thanANSI-C.(for example BASH script or AWK script). This section will provide atemplate for developing new test cases in SHELL using the command line harnessAPIs.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br><br> A minimum set of LTP harness APIs are available in the form of commands. Thesecommands help developers log test status and test results in a format similarto that done by tests in ANSI-C. The source code for these commands are locatedin the ltp-yyyymmdd/tools/apicmds/ directory. Once the commands are compiledand installed the test-cases reside under ltp-yyyymmdd/testcases/bin directory.</span><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">1.    </span><span style="color:#656565;">Basictemplate</span></strong></p> 
 <p><span style="color:#656565;">Thissection will introduces a basic template that can be used to develop test casesin SHELL. Please note that the follwing code will fail to execute as is.</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>        ################################################################################</p> <p>        ##                                                                            ##</p> <p>        ## Copyright (c) International Business Machines  Corp., 2001                 ##</p> <p>        ##                                                                            ##</p> <p>        ## This program is free software;  you can redistribute it and#or modify      ##</p> <p>        ## it under the terms of the GNU General Public License as published by       ##</p> <p>        ## the Free Software Foundation; either version 2 of the License, or          ##</p> <p>        ## (at your option) any later version.                                        ##</p> <p>        ##                                                                            ##</p> <p>        ## This program is distributed in the hope that it will be useful, but        ##</p> <p>        ## WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY ##</p> <p>        ## or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License   ##</p> <p>        ## for more details.                                                          ##</p> <p>        ##                                                                            ##</p> <p>        ## You should have received a copy of the GNU General Public License          ##</p> <p>        ## along with this program;  if not, write to the Free Software               ##</p> <p>        ## Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA    ##</p> <p>        ##                                                                            ##</p> <p>        ################################################################################</p> <p>        #</p> <p>        # File :        template.sh</p> <p>        #</p> <p>        # Description:  This is a template that can be used to develop new test cases</p> <p>        #               using the LTP-harness command APIs. As an example a dummy_cmd</p> <p>        #               is used in this file.</p> <p>        #</p> <p>        # Author:       Manoj Iyer, manjo@mail.utexas.edu</p> <p>        #</p> <p>        # History:      Jan 19 2003 - Created - Manoj Iyer.</p> <p>        #               Jan 20 2003 - Added - Manoj Iyer, Test #1</p> <p>        #</p> <p>        #! /bin/sh</p> <p> </p> <p> </p> <p>        # Function:     setup</p> <p>        #</p> <p>        # Description:  - Check if required commands exits</p> <p>        #               - Export global variables</p> <p>        #               - Check if required config files exits</p> <p>        #               - Create temporary files and directories</p> <p>        #</p> <p>        # Return        - zero on success</p> <p>        #               - non zero on failure. return value from commands ($RC)</p> <p>        setup()</p> <p>        {<!-- --></p> <p> </p> <p>        </p> <p><em>               This variable is required by the LTP command line harness APIs</em></p> <p><em>               to keep track of the number of testcases in this file. This</em></p> <p><em>               variable is not local to this file.</em></p> <p><em>        </em></p> <p>        export TST_TOTAL=1  # Total number of test cases in this file.</p> <p> </p> <p>        # Set up LTPTMP (temporary directory used by the tests).</p> <p>        </p> <p><em>               Export PATH variable to point to the ltp-yyyymmdd/testcases/bin</em></p> <p><em>               directory before running the tests manually, path is set up</em></p> <p><em>               automatically when you use the runltp script.</em></p> <p><em>               LTPTMP is user defined variables used only in this test case.</em></p> <p><em>               These variables are local to this file.</em></p> <p><em>               The TMP variable is exported by the runltp script.</em></p> <p><em>        </em></p> <p>        LTPTMP=${TMP}       # Temporary directory to create files, etc.</p> <p> </p> <p>        </p> <p><em>               The TCID and TST_COUNT variables are required by the LTP</em></p> <p><em>               command line harness APIs, these variables are not local</em></p> <p><em>               to this program.</em></p> <p><em>        </em></p> <p>        export TCID="setup" # Test case identifier</p> <p>        export TST_COUNT=0  # Set up is initialized as test 0</p> <p> </p> <p>        # Initialize cleanup function to execute on program exit.</p> <p>        # This function will be called before the test program exits.</p> <p>        trap "cleanup" 0</p> <p> </p> <p>        # Initialize return code to zero.</p> <p>        </p> <p><em>               RC is used to store the return code from commands that are</em></p> <p><em>               used in this test. This variable is local to this file.</em></p> <p><em>        </em></p> <p>        RC=0                # Exit values of system commands used</p> <p> </p> <p>        # Check if awk command exists</p> <p>        which awk amp;&gt;$LTPTMP/tst_template.out || RC=$?</p> <p>        if [ $RC -ne 0 ]</p> <p>        then</p> <p>        tst_brkm TBROK NULL "INIT: Command awk not found"</p> <p>        return $RC</p> <p>        fi</p> <p> </p> <p>        # Check if temp_user exists. If not add one.</p> <p>        RC=$(awk '/^temp_user/ {print 1}' /etc/passwd)</p> <p>        if [ -z $RC ]</p> <p>        then</p> <p>        RC=0</p> <p>        tst_resm TINFO "INIT: Adding temporary user temp_user"</p> <p>        useradd -m -s /bin/bash temp_user amp;&gt;$LTPTMP/tst_template.out || RC=$?</p> <p>        if [ $RC -ne 0 ]</p> <p>        then</p> <p>        tst_brk TBROK $LTPTMP/tst_template.out NULL \</p> <p>        "Test INIT: Failed adding user temp_user Reason:"</p> <p>        return $RC</p> <p>        fi</p> <p>        fi</p> <p>        return $RC</p> <p>        }</p> <p> </p> <p> </p> <p>        # Function:     cleanup</p> <p>        #</p> <p>        # Description   - remove temporary files and directories.</p> <p>        #</p> <p>        # Return        - zero on success</p> <p>        #               - non zero on failure. return value from commands ($RC)</p> <p>        cleanup()</p> <p>        {<!-- --></p> <p>        <em>Clean up code goes here</em></p> <p>        }</p> <p> </p> <p> </p> <p>        # Function:     test01</p> <p>        # Description   - Test if command dummy_cmd -f tst_file.in will print</p> <p>        #                 contents of tst_file.in</p> <p>        #               - Create input file tst_file.in</p> <p>        #               -</p> <p>        test01()</p> <p>        {<!-- --></p> <p>        TCID="test01"    # Identifier of this testcase.</p> <p>        TST_COUNT=1      # Test case number.</p> <p>        RC=0             # return code from commands.</p> <p> </p> <p>        </p> <p><em>               In case of failure your testcase MUST exit with a</em></p> <p><em>               non-zero value. This exit value will be used by pan,</em></p> <p><em>               the test driver, to report FAIL. If the testcase exits with a</em></p> <p><em>               value zero, pan reports PASS. This variable is local to this</em></p> <p><em>               file.</em></p> <p><em>        </em></p> <p> </p> <p>        # Print test assertion.</p> <p>        tst_resm TINFO \</p> <p>        "Test #1: dummy_cmd -f tst_file.in will print contents of tst_file.in"</p> <p> </p> <p>        # Create input file tst_file.in</p> <p>        cat amp;gt $LTPTMP/tst_file.in amp;ltamp;lt -EOF || RC=$?</p> <p>        This is a test file</p> <p>        EOF</p> <p>        if [ $RC -ne 0 ]</p> <p>        then</p> <p>        tst_brkm TBROK NULL "Test #1: Unable to create input file"</p> <p>        return $RC</p> <p>        fi</p> <p> </p> <p>        # Perform test by calling command dummy_cmd with -f option</p> <p>        # and tst_file.in as input.</p> <p>        </p> <p><em>               Insert real code here. In case something wicked happenes use</em></p> <p><em>               tst_brk or tst_brkm functions to report this for example,</em></p> <p><em>               follow the lines of code below.</em></p> <p><em>        </em></p> <p> </p> <p>        # Print test results and exit with appropriate value</p> <p>        # Return code RC contains the value returned by dummy_cmd</p> <p>        # zero on success non-zero on failure.</p> <p>        if [ $RC -ne 0 ]</p> <p>        then</p> <p>        tst_res TFAIL $LTPTMP/tst_file.out \</p> <p>        "Test #1: dummy_cmd failed to print input file. Reason:"</p> <p>        return $RC</p> <p>        else</p> <p>        tst_resm TPASS \</p> <p>        "Test #1: succeeded in printing the contents of input file."</p> <p>        fi</p> <p>        return $RC</p> <p>        }</p> <p> </p> <p> </p> <p>        # Function:     main</p> <p>        #</p> <p>        # Description:  - Execute all tests, exit with test status.</p> <p>        #</p> <p>        # Exit:         - zero on success</p> <p>        #               - non-zero on failure.</p> <p>        #</p> <p>        RC=0    # Return value from setup, and test functions.</p> <p> </p> <p>        setup  || exit $RC</p> <p> </p> <p>        test01 || exit $RC</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;"> </span></p> 
 <p><strong><span style="color:#656565;">2.    </span><span style="color:#656565;">Understandingthe template</span></strong></p> 
 <p><span style="color:#656565;">Each test-case starts with a copyright and licensestatement. All test-cases in LTP are covered under the</span><span style="color:#656565;"> </span><a href="http://www.gnu.org/copyleft/gpl.html" rel="nofollow"><span style="color:#0080FF;">GNU public license</span><span style="color:#0080FF;"> </span></a><span style="color:#656565;">. Copyrights usually belong to the author or corporationthat developed the tests. Test case developed by IBM will have IBM copyrights,and test cases developed by SGI will have SGI copyrights and so on.<br><br> The structure of the template is similar to tests written in ANSI-C. There arecertain important points to note while writing tests in SHELL using the LTPcommand-line APIs. These are summarized below.</span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">exportTST_TOTAL=</span><em><span style="color:#656565;">"totalnumber of tests in this file"</span></em><span style="color:#656565;">. Thisvariable must be exported. It is used by the LTP command level APIs to displaystatus or results.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">exportTCID=</span><em><span style="color:#656565;">"nameof the test case"</span></em><span style="color:#656565;">. Thisvariable must be exported. It is used by the LTP command-line APIs to reportthe name of the test while printing test status or results.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">TST_COUNT=</span><em><span style="color:#656565;">"current test casenumber"</span></em><span style="color:#656565;"> </span><span style="color:#656565;">If the test file has more than one test, each test mustset this to an appropriate value. For instance, third test (test #3) should setthis variable to 3, (TST_COUNT=3). The variable is used by the command levelAPIs for reporting status or results.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Thearguments to command APIs are in conformance with ANSI-C APIs. The FUNCargument to the commands is ignored, but a value must be provided forconformance with ANSI-C APIs (use NULL). The arguments to commands are asfollows:</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> export TCID=<em>test name</em></span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> export TST_TOTAL=<em>Total Number of Tests</em></span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> export TST_COUNT=<em>Test case number</em></span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> tst_brk TTYPE FNAME FUNC STRING</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> TTYPE  -Test Result Type; one of TFAIL, TBROK, TCONF, and  TRETR.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> FNAME  -Print contents of this file after the message</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> FUNC   -Cleanup function (ignored), but MUST be provided. Use NULL.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> STRING - Message explaining the test result</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> tst_brkm TTYPE FUNC STRING</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> TTYPE  -Test Result Type; one of TFAIL, TBROK, TCONF, and  TRETR.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> FUNC   -Cleanup function (ignored), but MUST be provided. Use NULL.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> STRING - Message explaining the test result</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> tst_res TTYPE FNAME STRING</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> TTYPE  -Test Result Type; one of TFAIL, TBROK, TCONF, and  TRETR.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> FNAME  -Print contents of this file after the message</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> STRING - Message explaining the test result</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> tst_resm TTYPE STRING</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> TTYPE  -Test Result Type; one of TFAIL, TBROK, TCONF, and  TRETR.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> STRING - Message explaining the test result</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;"> These messages are displayed if commands arecalled with no arguments.</span></p> 
 <p><span style="color:#656565;">                                       </span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">TheUSCTEST functions and macros are not available in the form of commands. Thesefunctions and macros may be added at a later time. Check with the latestrelease of LTP test suite for recent updates.</span></p> 
 <p><strong><span style="color:#656565;">3.    </span><span style="color:#656565;">Recommendationon coding style</span></strong></p> 
 <p><span style="color:#656565;">This section makes certain recommendation on code layoutand style, but they are optional, it reflects the authors personal coding styleand practice and may be applicable in general to any program written in SHELL.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Use afile header to describe the contents of file and maintain a change history. Itmay be argued that CVS provides the option to maintain such a change log whilechecking in code to the CVS tree, but often times the developer need not beresponsible for maintaining the code in CVS. The change log or historymaintained in the file can help both developer and the maintainer of the codeto track changes made to the file.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Usemeaningful variable names, and capitalize all variables. Avoid variable like'i', 'j' etc instead use variable names like 'INDEX', 'ARRAY_NDX' etc.Initialize and comment the variables appropriately.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Commentcode appropriately. Code may by handled by seasoned programmers as well asnewbies, it is generally a good practice to add comments in the code where everappropriate for maintainability reasons. Comments can be stripped off from thecode using AWK or PERL scipts if required.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Usefunctions if possible, the template does not follow this rule for reasons ofconvenience.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Usetst_resm TINFO ... to print informational messages as appropriate, alternately,a verbose option or a 'quiet' option may be provided to suppress or activatesuch messages.</span></p> 
 <p><span style="color:#656565;">§ </span><span style="color:#656565;">Use'spaces' instead of 'tab' characters. Typically four spaces may be used insteadof a tab character.</span></p> 
 <p><strong><span style="color:#656565;">4.    </span><span style="color:#656565;">Morehelp</span></strong></p> 
 <p><span style="color:#656565;">At thetime of this writing, only tst_brk, tst_brkm, tst_res and tst_resm functionsare available for use as commands. The syntax for using these commands conformswith the ANSI-C APIs. Man pages for these ANSI-C APIs may be helpful inunderstanding the arguments to these commands. Alternately executing thesecommands without any arguments will print usage. Testcases using these commandsare located under ltp-yyyymmdd/testcases/commands/ directory.</span></p> 
 <p><strong><span style="color:#656565;">6.  </span><span style="color:#656565;">Addinga new test to LTP</span></strong></p> 
 <p><span style="color:#656565;">Youcan add a new test to the LTP test suite can be done in two ways.</span></p> 
 <p><strong><span style="color:#656565;">If the developers does not have developer/maintaineraccess to the the LTP CVS tree.</span></strong></p> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Emailthe test case to the</span><span style="color:#656565;"> </span><a href="mailto:ltp-list@lists.sourceforge.net" rel="nofollow"><span style="color:#0080FF;">LTP mailing list</span></a><span style="color:#656565;"> </span><span style="color:#656565;">and a developer or maintainer of LTP will add the testcase after reviewing the code.</span></p> 
 <p><strong><span style="color:#656565;">If the test case develper has access to the LTP CVS tree.</span></strong></p> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Getthe test case reviewed by peers. Test it throughly under different Linuxdistributions and kernel versions. This step is important in order to maintaina test suite that is of highest quality, and code free from bugs.</span></p> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Createa sub-directory under the appropriate directory. For example, when adding a newsystem call test case, create a new directory with an appropriate name underthe ltp-yyyymmmdd/testcases/kernel/syscalls/ directory.</span></p> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Addthe source code (written in ANSI-C) to this directory, use the genericMakefile, research existing test case for Makefile syntax. Generic template fortest-cases in ANSI-C may be as follows:</span><span style="color:#656565;"> </span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>CFLAGS+=    -I../../../../include</p> <p> </p> <p>LOADLIBES+= -L../../../../lib -lltp</p> <p> </p> <p>SRCS=$(wildcard *.c)</p> <p>TARGETS=$(patsubst %.c,%,$(SRCS))</p> <p>all: $(TARGETS)</p> <p> </p> <p>install:</p> <p>@for i in $(TARGETS); do ln -f $$i ../../../bin/$$i ; done</p> <p>clean:</p> <p>rm -f $(TARGETS)</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">If thetest case is written in shell, then the Makefile might require only an"install:" section. Please make sure that there are empty tags for"all:" and "clean:". For example:</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>all:</p> <p>install:</p> <p>@ln -f mail_tests.sh ../../bin/mail_tests.sh</p> <p> </p> <p>clean:</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Add adescription of the test cases to the 00_Descriptions.txt file located in theltp-yyyymmmdd/testcases/kernel/syscalls/ directory. The following template maybe used:</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>test01<br>     test does not exist, just an example.<br> test02<br>     test does not exist, just an example.<br> test03<br>     test does not exist, just an example<br> test04<br>     test does not exist, just an example.</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Addthe new sub-directory to the top level Makefile, in this case add to Makefileunder ltp-yyyymmmdd/testcases/kernel/syscalls/ to the SUBDIR variable.</span></p> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Addthe test "tag" and "command" to execute to the appropriatecommand file under ltp-yyyymmdd/runtest/ directory, to the syscall file. Followthe syntax used in this file. This file will be used as input to the test suitedriver PAN, pan will use the contents of this file to execute the test case.For example, adding a hypothetical system call test01 to the command filesyscall:</span></p> 
 <table border="0" cellpadding="0" style="background:#E0F0F0;"><tbody><tr><td> <p>syslog11 syslog11<br> syslog12 syslog12<br> time01 time01<br> time02 time02<br> times01 times01<br> times02 times02<br> times03 times03<br> truncate01 truncate01<br> truncate02 truncate02<br> truncate03 truncate03<br> truncate04 truncate04<br> test01 test01</p> </td></tr></tbody></table> 
 <p><span style="color:#656565;">o   </span><span style="color:#656565;">Sendan email to the mailing list notifying the subscribers the addition of a a newtest. ltp-list@lists.sourceforge.net</span></p> 
 <p><span style="color:#656565;">Testcase might be included in the subsequent monthly release of the LTP test suite,and due credit will be given to the author of the test case.</span></p> 
 <p><strong><span style="color:#656565;">    </span><span style="color:#656565;">OtherResources</span></strong></p> 
 <p><span style="color:#656565;">Pleaserefer</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/test" rel="nofollow"><span style="color:#0080FF;">Linux Test Project</span></a><span style="color:#656565;"> </span><span style="color:#656565;">website for updates, documentation, project details,email address, and to download the latest version of the test suite itself.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br> Please refer</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/test/coverage/lcov.php" rel="nofollow"><span style="color:#0080FF;">Linux Test Project Kernel CodeCoverage</span></a><span style="color:#656565;"> </span><span style="color:#656565;">website for LTP's kernel code coverage tools.<br> The</span><span style="color:#656565;"> </span><a href="http://ltp.sourceforge.net/test/documentation/technical_papers/techpaper.php" rel="nofollow"><span style="color:#0080FF;">Technical papers</span></a><span style="color:#656565;"> </span><span style="color:#656565;">section contains a wealth of information pertaining totesting Linux and also the LTP test suite.</span></p> 
 <p><strong><span style="color:#656565;">    </span><span style="color:#656565;">Acknowledgements</span></strong></p> 
 <p><span style="color:#656565;">Aspecial acknowledgement to Kristin Thomas for reviewing and editing thisdocument. I also thank everyone who provided me with valuable comments andsuggestions.</span></p> 
 <p><strong><span style="color:#656565;">    </span><span style="color:#656565;">Disclaimer</span></strong></p> 
 <p><span style="color:#656565;">IBM,the IBM logo, AIX are trademarks of the IBM Corporation.<br> Pentium is a trademark of Intel Corporation in the United States, othercountries, or both.<br><br> Linux is a registered trademark of Linus Torvalds.<br><br> All other trademarks and registered trademarks are the property of theirrespective owners.<br><br> This publication reflects the views of the author, and not the IBM Corporation.This publication may include typographical errors and technical inaccuraciesand may be changed or withdrawn at any time. The content is provided AS IS,without warranties of any kind, either express or implied, including theimplied warranties of merchantability and fitness for a particular purpose.<br><br> This publication may contain links to third party sites that are not under thecontrol of or maintained by IBM. Access to any such third party site is at theuser's own risk and IBM is not responsible for the accuracy or reliability ofany information, data, opinions, advice or statements made on these sites. IBMprovides these links merely as a convenience and the inclusion of such linksdoes not imply an endorsement.</span><span style="color:#656565;"> </span><span style="color:#656565;"><br><br> The test results reported in this document represent results obtained fromrunning tests under specific conditions at IBM's laboratory facility in Austin,Texas. Users may achieve different results depending on their particularinstallations, configurations, workloads, or other factors. The information inthis document is provided solely for the information of the user. Theinformation is provided on an "AS IS" basis, without liability orwarranty. Users use such information at their own risk. Users are, thus,advised to evaluate the code referenced in this document as is appropriate fortheir specific installations.<br><br> Document Author:<br> Manoj Iyer</span></p> 
 <p> </p> 
 <p><br></p> 
 <p><span style="font-size:18px;color:#ff0000;">转载：http://ltp.sourceforge.net/documentation/how-to/ltp.php</span></p> 
</div> 
<p>转载于:https://my.oschina.net/u/2291665/blog/885047</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b4b8603039c102eec586c1675cb793b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CCF NOI1031 等腰三角形</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6a9ef29e6fcb9a19c59082ce3df17eb1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MyBatis-动态SQL、关联映射、MyBatis整合Spring</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>