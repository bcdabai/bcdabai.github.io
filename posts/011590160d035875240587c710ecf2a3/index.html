<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终" />
<meta property="og:description" content="文章目录 全系列总结博客链接前引golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终1、从示例代码入手2、ListenAndServe(addr string, handler Handler) error1、server.ListenAndServe()2、server.Serve(l net.Listener) error3、conn.serve(ctx context.Context) { 3、HandleFunc(pattern string, handler func(ResponseWriter, *Request))1、mtx.HandleFunc(pattern string, handler func(ResponseWriter, *Request))2、mux.ServeHTTP(w ResponseWriter, r *Request) 4、简单总结一下 全系列总结博客链接 golang Gin框架源码分析 全系列总结博客
前引 本意是没有打算写这一篇的 但是这两天在刷面经的时候发现 还是有问这个net/http包的
这个看样子是逃不掉了 还是需要深挖一下
发现要做的事情太多 太忙 但是想到如果能回到自己的hometown 今年9月份就要定正式工作了
这个offer起码决定了后面好几年的日子 也不得不这几个月再硬着头皮冲一下了
golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终 1、从示例代码入手 刚刚也才基本把net/http的框架给梳理了一遍 还是很有收获的^^
这里还是简单推荐一下 一篇对于net/http解析写的挺好的帖子 我下面贴一下链接 大家可以先去看看这篇
Introduction 万字手撕Go http源码server.go
还是从示例代码入手 下面是非常常见的用net/http写一个高并发的web服务器的代码 我们注册url相对应的处理函数就是以下面的方式来注册的 那我们就可以顺藤摸瓜的去看一下 ListenAndServe函数 和 HandleFunc函数是怎么运行的
package main import ( &#34;net/http&#34; &#34;strconv&#34; &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/011590160d035875240587c710ecf2a3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-31T19:20:32+08:00" />
<meta property="article:modified_time" content="2023-01-31T19:20:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_4" rel="nofollow">全系列总结博客链接</a></li><li><a href="#_10" rel="nofollow">前引</a></li><li><a href="#golang_gin__nethttp_19" rel="nofollow">golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终</a></li><li><ul><li><a href="#1_21" rel="nofollow">1、从示例代码入手</a></li><li><a href="#2ListenAndServeaddr_string_handler_Handler_error_58" rel="nofollow">2、ListenAndServe(addr string, handler Handler) error</a></li><li><ul><li><a href="#1serverListenAndServe_103" rel="nofollow">1、server.ListenAndServe()</a></li><li><a href="#2serverServel_netListener_error_187" rel="nofollow">2、server.Serve(l net.Listener) error</a></li><li><a href="#3connservectx_contextContext__297" rel="nofollow">3、conn.serve(ctx context.Context) {<!-- --></a></li></ul> 
    </li><li><a href="#3HandleFuncpattern_string_handler_funcResponseWriter_Request_379" rel="nofollow">3、HandleFunc(pattern string, handler func(ResponseWriter, *Request))</a></li><li><ul><li><a href="#1mtxHandleFuncpattern_string_handler_funcResponseWriter_Request_413" rel="nofollow">1、mtx.HandleFunc(pattern string, handler func(ResponseWriter, *Request))</a></li><li><a href="#2muxServeHTTPw_ResponseWriter_r_Request_469" rel="nofollow">2、mux.ServeHTTP(w ResponseWriter, r *Request)</a></li></ul> 
    </li><li><a href="#4_563" rel="nofollow">4、简单总结一下</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h3><a id="_4"></a>全系列总结博客链接</h3> 
<hr> 
<p><strong><a href="https://blog.csdn.net/qq_37500516/article/details/128804079">golang Gin框架源码分析 全系列总结博客</a></strong></p> 
<hr> 
<h3><a id="_10"></a>前引</h3> 
<hr> 
<p><strong>本意是没有打算写这一篇的 但是这两天在刷面经的时候发现 还是有问这个<code>net/http</code>包的<br> 这个看样子是逃不掉了 还是需要深挖一下</strong></p> 
<p><strong>发现要做的事情太多 太忙 但是想到如果能回到自己的hometown 今年9月份就要定正式工作了</strong><br> <strong>这个offer起码决定了后面好几年的日子 也不得不这几个月再硬着头皮冲一下了</strong></p> 
<hr> 
<h3><a id="golang_gin__nethttp_19"></a>golang gin框架源码分析（三）---- 问其根本 net/http包需要深究才能有始有终</h3> 
<hr> 
<h4><a id="1_21"></a>1、从示例代码入手</h4> 
<hr> 
<p><strong>刚刚也才基本把<code>net/http</code>的框架给梳理了一遍 还是很有收获的^^</strong><br> <strong>这里还是简单推荐一下 一篇对于<code>net/http</code>解析写的挺好的帖子 我下面贴一下链接 大家可以先去看看这篇</strong><br> <strong><a href="https://segmentfault.com/a/1190000023799082" rel="nofollow">Introduction 万字手撕Go http源码server.go</a></strong></p> 
<p><strong>还是从示例代码入手 下面是非常常见的用<code>net/http</code>写一个高并发的<code>web</code>服务器的代码 我们注册<code>url</code>相对应的处理函数就是以下面的方式来注册的 那我们就可以顺藤摸瓜的去看一下 <code>ListenAndServe</code>函数 和 <code>HandleFunc</code>函数是怎么运行的</strong></p> 
<pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"net/http"</span>
	<span class="token string">"strconv"</span>

	<span class="token string">"github.com/gin-gonic/gin"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">`hello world`</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/go/"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">`go`</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8002"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<p><strong>访问<code>url</code>的实际效果</strong><br> <img src="https://images2.imgbox.com/11/04/vvEgU7MR_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1b/61/GMaaEkfR_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c5/64/qIdHDivD_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h4><a id="2ListenAndServeaddr_string_handler_Handler_error_58"></a>2、ListenAndServe(addr string, handler Handler) error</h4> 
<hr> 
<p><strong>下面可以仔细看看 我贴出来了<code>Server</code>的结构体 如我们的示例代码所示 其实结构体中只赋值了<code>addr</code> 对于handler部分我们是填写的<code>nil</code> 那么对于该<code>Server</code>的话 之后找我们的<code>handler</code>只会去我们的默认多路复用器 也就是<code>DefaultServerMux</code>里面去找我们所注册的<code>handler</code>了 也就是我们调用了两个<code>http.HandleFunc</code> 其实也就是往我们默认的<code>DefaultServerMux</code>注册处理函数了 当然这是后话了 我们可以顺藤摸瓜下去</strong></p> 
<pre><code class="prism language-go"><span class="token comment">// A Server defines parameters for running an HTTP server.</span>
<span class="token comment">// The zero value for Server is a valid configuration.</span>
<span class="token keyword">type</span> Server <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Addr <span class="token builtin">string</span>
	Handler Handler <span class="token comment">// handler to invoke, http.DefaultServeMux if nil</span>
	
	DisableGeneralOptionsHandler <span class="token builtin">bool</span>
	TLSConfig <span class="token operator">*</span>tls<span class="token punctuation">.</span>Config
	ReadTimeout time<span class="token punctuation">.</span>Duration
	ReadHeaderTimeout time<span class="token punctuation">.</span>Duration
	WriteTimeout time<span class="token punctuation">.</span>Duration
	IdleTimeout time<span class="token punctuation">.</span>Duration
	MaxHeaderBytes <span class="token builtin">int</span>
	TLSNextProto <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token operator">*</span>Server<span class="token punctuation">,</span> <span class="token operator">*</span>tls<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> Handler<span class="token punctuation">)</span>
	ConnState <span class="token keyword">func</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> ConnState<span class="token punctuation">)</span>
	ErrorLog <span class="token operator">*</span>log<span class="token punctuation">.</span>Logger
	BaseContext <span class="token keyword">func</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>Listener<span class="token punctuation">)</span> context<span class="token punctuation">.</span>Context
	ConnContext <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> c net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> context<span class="token punctuation">.</span>Context

	inShutdown atomic<span class="token punctuation">.</span>Bool <span class="token comment">// true when server is in shutdown</span>

	disableKeepAlives atomic<span class="token punctuation">.</span>Bool
	nextProtoOnce     sync<span class="token punctuation">.</span>Once <span class="token comment">// guards setupHTTP2_* init</span>
	nextProtoErr      <span class="token builtin">error</span>     <span class="token comment">// result of http2.ConfigureServer if used</span>

	mu         sync<span class="token punctuation">.</span>Mutex
	listeners  <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token operator">*</span>net<span class="token punctuation">.</span>Listener<span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	activeConn <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token operator">*</span>conn<span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	onShutdown <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	listenerGroup sync<span class="token punctuation">.</span>WaitGroup
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">ListenAndServe</span><span class="token punctuation">(</span>addr <span class="token builtin">string</span><span class="token punctuation">,</span> handler Handler<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{<!-- --></span>
	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>Server<span class="token punctuation">{<!-- --></span>Addr<span class="token punctuation">:</span> addr<span class="token punctuation">,</span> Handler<span class="token punctuation">:</span> handler<span class="token punctuation">}</span>
	<span class="token keyword">return</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h5><a id="1serverListenAndServe_103"></a>1、server.ListenAndServe()</h5> 
<hr> 
<p><strong>这里前面可以省略 处理<code>shutdown</code>情况 取出来<code>addr</code></strong><br> <strong>而后面重点就是这两句话 <code>ln, err := net.Listen("tcp", addr)</code> <code>return srv.Serve(ln)</code></strong><br> <strong>对于服务器 常见的处理框架也就是 <code>监听端口-&gt;取出新连接-&gt;工作线程/子线程处理/多路复用处理新连接</code><br> 而这里的<code>ln</code>其实就是一个接口 当然递归的去看看<code>listen</code>工作其实也就是包装了一下相关资源 对于不同类型返回不同的结构体而已 也就可以当作是监听结构体</strong></p> 
<p><strong>然后我们得到了后 就去调用<code>serve</code> 开始服务了 我们往下继续看看</strong></p> 
<pre><code class="prism language-go">ln<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
<span class="token keyword">return</span> srv<span class="token punctuation">.</span><span class="token function">Serve</span><span class="token punctuation">(</span>ln<span class="token punctuation">)</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// A Listener is a generic network listener for stream-oriented protocols.</span>
<span class="token comment">//</span>
<span class="token comment">// Multiple goroutines may invoke methods on a Listener simultaneously.</span>
<span class="token keyword">type</span> Listener <span class="token keyword">interface</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// Accept waits for and returns the next connection to the listener.</span>
	<span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

	<span class="token comment">// Close closes the listener.</span>
	<span class="token comment">// Any blocked Accept operations will be unblocked and return errors.</span>
	<span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>

	<span class="token comment">// Addr returns the listener's network address.</span>
	<span class="token function">Addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
<span class="token punctuation">}</span>

<span class="token comment">// Listen announces on the local network address.</span>
<span class="token comment">//</span>
<span class="token comment">// See func Listen for a description of the network and address</span>
<span class="token comment">// parameters.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>lc <span class="token operator">*</span>ListenConfig<span class="token punctuation">)</span> <span class="token function">Listen</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> network<span class="token punctuation">,</span> address <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Listener<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	addrs<span class="token punctuation">,</span> err <span class="token operator">:=</span> DefaultResolver<span class="token punctuation">.</span><span class="token function">resolveAddrList</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"listen"</span><span class="token punctuation">,</span> network<span class="token punctuation">,</span> address<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>OpError<span class="token punctuation">{<!-- --></span>Op<span class="token punctuation">:</span> <span class="token string">"listen"</span><span class="token punctuation">,</span> Net<span class="token punctuation">:</span> network<span class="token punctuation">,</span> Source<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> Addr<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> Err<span class="token punctuation">:</span> err<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	sl <span class="token operator">:=</span> <span class="token operator">&amp;</span>sysListener<span class="token punctuation">{<!-- --></span>
		ListenConfig<span class="token punctuation">:</span> <span class="token operator">*</span>lc<span class="token punctuation">,</span>
		network<span class="token punctuation">:</span>      network<span class="token punctuation">,</span>
		address<span class="token punctuation">:</span>      address<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> l Listener
	la <span class="token operator">:=</span> addrs<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span>isIPv4<span class="token punctuation">)</span>
	<span class="token keyword">switch</span> la <span class="token operator">:=</span> la<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> <span class="token operator">*</span>TCPAddr<span class="token punctuation">:</span>
		l<span class="token punctuation">,</span> err <span class="token operator">=</span> sl<span class="token punctuation">.</span><span class="token function">listenTCP</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> la<span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token operator">*</span>UnixAddr<span class="token punctuation">:</span>
		l<span class="token punctuation">,</span> err <span class="token operator">=</span> sl<span class="token punctuation">.</span><span class="token function">listenUnix</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> la<span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>OpError<span class="token punctuation">{<!-- --></span>Op<span class="token punctuation">:</span> <span class="token string">"listen"</span><span class="token punctuation">,</span> Net<span class="token punctuation">:</span> sl<span class="token punctuation">.</span>network<span class="token punctuation">,</span> Source<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> Addr<span class="token punctuation">:</span> la<span class="token punctuation">,</span> Err<span class="token punctuation">:</span> <span class="token operator">&amp;</span>AddrError<span class="token punctuation">{<!-- --></span>Err<span class="token punctuation">:</span> <span class="token string">"unexpected address type"</span><span class="token punctuation">,</span> Addr<span class="token punctuation">:</span> address<span class="token punctuation">}</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>OpError<span class="token punctuation">{<!-- --></span>Op<span class="token punctuation">:</span> <span class="token string">"listen"</span><span class="token punctuation">,</span> Net<span class="token punctuation">:</span> sl<span class="token punctuation">.</span>network<span class="token punctuation">,</span> Source<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> Addr<span class="token punctuation">:</span> la<span class="token punctuation">,</span> Err<span class="token punctuation">:</span> err<span class="token punctuation">}</span> <span class="token comment">// l is non-nil interface containing nil pointer</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> l<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// ListenAndServe listens on the TCP network address srv.Addr and then</span>
<span class="token comment">// calls Serve to handle requests on incoming connections.</span>
<span class="token comment">// Accepted connections are configured to enable TCP keep-alives.</span>
<span class="token comment">//</span>
<span class="token comment">// If srv.Addr is blank, ":http" is used.</span>
<span class="token comment">//</span>
<span class="token comment">// ListenAndServe always returns a non-nil error. After Shutdown or Close,</span>
<span class="token comment">// the returned error is ErrServerClosed.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>srv <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> srv<span class="token punctuation">.</span><span class="token function">shuttingDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> ErrServerClosed
	<span class="token punctuation">}</span>
	addr <span class="token operator">:=</span> srv<span class="token punctuation">.</span>Addr
	<span class="token keyword">if</span> addr <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{<!-- --></span>
		addr <span class="token operator">=</span> <span class="token string">":http"</span>
	<span class="token punctuation">}</span>
	ln<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> srv<span class="token punctuation">.</span><span class="token function">Serve</span><span class="token punctuation">(</span>ln<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h5><a id="2serverServel_netListener_error_187"></a>2、server.Serve(l net.Listener) error</h5> 
<hr> 
<p><strong>前面其实也是不是很重要的 可以抓一下关键 直接看到<code>for</code>循环内部</strong><br> <strong>我已经把最核心的地方节省出来了 <code>Accept</code>获取新连接 然后获取新连接结构体<code>server + net.Conn</code> 返回</strong><br> <strong>启用<code>go协程</code>去处理新连接</strong></p> 
<p><strong>这个可以说是就是 把例如<code>c++</code>的网络库中 例如<code>Epoll/Select</code> 处理服务器的多路复用 改用为用<code>go协程</code>去处理新连接</strong><br> <strong>相当于高并发核心应该就是来自于这里 则<code>go协程</code>的快捷以及切换快速 也让<code>go web</code>高并发得到了实现</strong></p> 
<p><strong>我们可以继续往下看看</strong></p> 
<pre><code class="prism language-go"><span class="token comment">// Create new connection from rwc.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>srv <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">newConn</span><span class="token punctuation">(</span>rwc net<span class="token punctuation">.</span>Conn<span class="token punctuation">)</span> <span class="token operator">*</span>conn <span class="token punctuation">{<!-- --></span>
	c <span class="token operator">:=</span> <span class="token operator">&amp;</span>conn<span class="token punctuation">{<!-- --></span>
		server<span class="token punctuation">:</span> srv<span class="token punctuation">,</span>
		rwc<span class="token punctuation">:</span>    rwc<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> debugServerConnections <span class="token punctuation">{<!-- --></span>
		c<span class="token punctuation">.</span>rwc <span class="token operator">=</span> <span class="token function">newLoggingConn</span><span class="token punctuation">(</span><span class="token string">"server"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>rwc<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> c
<span class="token punctuation">}</span>

<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		rw<span class="token punctuation">,</span> err <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		c <span class="token operator">:=</span> srv<span class="token punctuation">.</span><span class="token function">newConn</span><span class="token punctuation">(</span>rw<span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>rwc<span class="token punctuation">,</span> StateNew<span class="token punctuation">,</span> runHooks<span class="token punctuation">)</span> <span class="token comment">// before Serve can return</span>
		<span class="token keyword">go</span> c<span class="token punctuation">.</span><span class="token function">serve</span><span class="token punctuation">(</span>connCtx<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span>
<span class="token comment">// Serve accepts incoming connections on the Listener l, creating a</span>
<span class="token comment">// new service goroutine for each. The service goroutines read requests and</span>
<span class="token comment">// then call srv.Handler to reply to them.</span>
<span class="token comment">//</span>
<span class="token comment">// HTTP/2 support is only enabled if the Listener returns *tls.Conn</span>
<span class="token comment">// connections and they were configured with "h2" in the TLS</span>
<span class="token comment">// Config.NextProtos.</span>
<span class="token comment">//</span>
<span class="token comment">// Serve always returns a non-nil error and closes l.</span>
<span class="token comment">// After Shutdown or Close, the returned error is ErrServerClosed.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>srv <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">Serve</span><span class="token punctuation">(</span>l net<span class="token punctuation">.</span>Listener<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> fn <span class="token operator">:=</span> testHookServerServe<span class="token punctuation">;</span> fn <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">fn</span><span class="token punctuation">(</span>srv<span class="token punctuation">,</span> l<span class="token punctuation">)</span> <span class="token comment">// call hook with unwrapped listener</span>
	<span class="token punctuation">}</span>

	origListener <span class="token operator">:=</span> l
	l <span class="token operator">=</span> <span class="token operator">&amp;</span>onceCloseListener<span class="token punctuation">{<!-- --></span>Listener<span class="token punctuation">:</span> l<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> l<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> err <span class="token operator">:=</span> srv<span class="token punctuation">.</span><span class="token function">setupHTTP2_Serve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> err
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token operator">!</span>srv<span class="token punctuation">.</span><span class="token function">trackListener</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> ErrServerClosed
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> srv<span class="token punctuation">.</span><span class="token function">trackListener</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>l<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>

	baseCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> srv<span class="token punctuation">.</span>BaseContext <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		baseCtx <span class="token operator">=</span> srv<span class="token punctuation">.</span><span class="token function">BaseContext</span><span class="token punctuation">(</span>origListener<span class="token punctuation">)</span>
		<span class="token keyword">if</span> baseCtx <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"BaseContext returned a nil context"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> tempDelay time<span class="token punctuation">.</span>Duration <span class="token comment">// how long to sleep on accept failure</span>

	ctx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>baseCtx<span class="token punctuation">,</span> ServerContextKey<span class="token punctuation">,</span> srv<span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		rw<span class="token punctuation">,</span> err <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> srv<span class="token punctuation">.</span><span class="token function">shuttingDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> ErrServerClosed
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> ne<span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span>net<span class="token punctuation">.</span>Error<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token operator">&amp;&amp;</span> ne<span class="token punctuation">.</span><span class="token function">Temporary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> tempDelay <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{<!-- --></span>
					tempDelay <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Millisecond
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					tempDelay <span class="token operator">*=</span> <span class="token number">2</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span> max <span class="token operator">:=</span> <span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">;</span> tempDelay <span class="token operator">&gt;</span> max <span class="token punctuation">{<!-- --></span>
					tempDelay <span class="token operator">=</span> max
				<span class="token punctuation">}</span>
				srv<span class="token punctuation">.</span><span class="token function">logf</span><span class="token punctuation">(</span><span class="token string">"http: Accept error: %v; retrying in %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">,</span> tempDelay<span class="token punctuation">)</span>
				time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>tempDelay<span class="token punctuation">)</span>
				<span class="token keyword">continue</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> err
		<span class="token punctuation">}</span>
		connCtx <span class="token operator">:=</span> ctx
		<span class="token keyword">if</span> cc <span class="token operator">:=</span> srv<span class="token punctuation">.</span>ConnContext<span class="token punctuation">;</span> cc <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			connCtx <span class="token operator">=</span> <span class="token function">cc</span><span class="token punctuation">(</span>connCtx<span class="token punctuation">,</span> rw<span class="token punctuation">)</span>
			<span class="token keyword">if</span> connCtx <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
				<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"ConnContext returned nil"</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		tempDelay <span class="token operator">=</span> <span class="token number">0</span>
		c <span class="token operator">:=</span> srv<span class="token punctuation">.</span><span class="token function">newConn</span><span class="token punctuation">(</span>rw<span class="token punctuation">)</span>
		c<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>rwc<span class="token punctuation">,</span> StateNew<span class="token punctuation">,</span> runHooks<span class="token punctuation">)</span> <span class="token comment">// before Serve can return</span>
		<span class="token keyword">go</span> c<span class="token punctuation">.</span><span class="token function">serve</span><span class="token punctuation">(</span>connCtx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h5><a id="3connservectx_contextContext__297"></a>3、conn.serve(ctx context.Context) {<!-- --></h5> 
<hr> 
<p><strong>我对下面的代码进行了抛肥捡瘦 <code>for</code>循环我理解的应该是长连接 需要多次<code>request response</code> 一旦请求终止即<code>return</code></strong><br> <strong>而这里面最核心的一句话就是<code>serverHandler{c.server}.ServeHTTP(w, w.req)</code></strong></p> 
<p><strong><code>serveHTTP</code> 这个是内部的函数 我贴在了下面 是最重要的语句 我们详细来看看</strong><br> <strong>首先先赋值<code>handler</code> 这个<code>handler</code> 对于我们的示例代码还记得吗 我们填写的是<code>nil</code> 如果我们自己写了类 实现了<code>ServeHTTP</code>的话 则响应函数只会触发我们自己写的了 而不是我们用<code>HandlerFunc</code>默认的多路复用器我们添加的那部分函数了</strong></p> 
<p><strong>最后这个<code>net/http</code> 最核心的一句话 处理函数就是在<code>handler.ServeHTTP(rw, req)</code> 调用我们的<code>handler</code></strong><br> <strong>那现在明了了 逻辑基本理清了 那这个时候我们可以最后再去看看我们的<code>DefaultServeMux</code>是如何存储我们的多个<code>url</code>对应的响应函数的</strong></p> 
<pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>sh serverHandler<span class="token punctuation">)</span> <span class="token function">ServeHTTP</span><span class="token punctuation">(</span>rw ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	handler <span class="token operator">:=</span> sh<span class="token punctuation">.</span>srv<span class="token punctuation">.</span>Handler
	<span class="token keyword">if</span> handler <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		handler <span class="token operator">=</span> DefaultServeMux
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>sh<span class="token punctuation">.</span>srv<span class="token punctuation">.</span>DisableGeneralOptionsHandler <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>RequestURI <span class="token operator">==</span> <span class="token string">"*"</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>Method <span class="token operator">==</span> <span class="token string">"OPTIONS"</span> <span class="token punctuation">{<!-- --></span>
		handler <span class="token operator">=</span> globalOptionsHandler<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> req<span class="token punctuation">.</span>URL <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>RawQuery<span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">var</span> allowQuerySemicolonsInUse atomic<span class="token punctuation">.</span>Bool
		req <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">WithContext</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">WithValue</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> silenceSemWarnContextKey<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			allowQuerySemicolonsInUse<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token operator">!</span>allowQuerySemicolonsInUse<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				sh<span class="token punctuation">.</span>srv<span class="token punctuation">.</span><span class="token function">logf</span><span class="token punctuation">(</span><span class="token string">"http: URL query contains semicolon, which is no longer a supported separator; parts of the query may be stripped when parsed; see golang.org/issue/25192"</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	handler<span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>rw<span class="token punctuation">,</span> req<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

<span class="token comment">// Serve a new connection.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>conn<span class="token punctuation">)</span> <span class="token function">serve</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token operator">...</span><span class="token operator">...</span>
	<span class="token operator">...</span><span class="token operator">...</span>
	<span class="token comment">// HTTP/1.x from here on.</span>

	ctx<span class="token punctuation">,</span> cancelCtx <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithCancel</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	c<span class="token punctuation">.</span>cancelCtx <span class="token operator">=</span> cancelCtx
	<span class="token keyword">defer</span> <span class="token function">cancelCtx</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	c<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token operator">&amp;</span>connReader<span class="token punctuation">{<!-- --></span>conn<span class="token punctuation">:</span> c<span class="token punctuation">}</span>
	c<span class="token punctuation">.</span>bufr <span class="token operator">=</span> <span class="token function">newBufioReader</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>r<span class="token punctuation">)</span>
	c<span class="token punctuation">.</span>bufw <span class="token operator">=</span> <span class="token function">newBufioWriterSize</span><span class="token punctuation">(</span>checkConnErrorWriter<span class="token punctuation">{<!-- --></span>c<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">&lt;&lt;</span><span class="token number">10</span><span class="token punctuation">)</span>

	<span class="token keyword">for</span> <span class="token punctuation">{<!-- --></span>
		w<span class="token punctuation">,</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">readRequest</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
		<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

		<span class="token comment">// Expect 100 Continue support</span>
		req <span class="token operator">:=</span> w<span class="token punctuation">.</span>req
		<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span>

		<span class="token comment">// HTTP cannot have multiple simultaneous active requests.[*]</span>
		<span class="token comment">// Until the server replies to this request, it can't read another,</span>
		<span class="token comment">// so we might as well run the handler in this goroutine.</span>
		<span class="token comment">// [*] Not strictly true: HTTP pipelining. We could let them all process</span>
		<span class="token comment">// in parallel even if their responses need to be serialized.</span>
		<span class="token comment">// But we're not going to implement HTTP pipelining because it</span>
		<span class="token comment">// was never deployed in the wild and the answer is HTTP/2.</span>
		inFlightResponse <span class="token operator">=</span> w
		serverHandler<span class="token punctuation">{<!-- --></span>c<span class="token punctuation">.</span>server<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> w<span class="token punctuation">.</span>req<span class="token punctuation">)</span>
		inFlightResponse <span class="token operator">=</span> <span class="token boolean">nil</span>
		w<span class="token punctuation">.</span><span class="token function">cancelCtx</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> c<span class="token punctuation">.</span><span class="token function">hijacked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		w<span class="token punctuation">.</span><span class="token function">finishRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="3HandleFuncpattern_string_handler_funcResponseWriter_Request_379"></a>3、HandleFunc(pattern string, handler func(ResponseWriter, *Request))</h4> 
<hr> 
<p><strong>下面我把相关的结构体贴出来了</strong><br> <strong>我可以这里就简单介绍一下</strong><br> <strong><code>mu</code>是读写锁控制竞态环境的 <code>m</code>则是存相关<code>url</code>的map 我们示例代码<code>/go</code> <code>/hello</code>也就被存储在了这里面</strong><br> <strong>而<code>es</code>则是 我们存储<code>path</code>末尾是<code>/</code>的匹配模式串 而且会按照长度从长到短按照顺序来存储 这个都会后面的讲</strong></p> 
<p><strong>我们可以递归的去看看<code>mux.HandleFunc</code> 我们是如何写入<code>map</code>的</strong></p> 
<pre><code class="prism language-go"><span class="token keyword">type</span> muxEntry <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	h       Handler
	pattern <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ServeMux <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	mu    sync<span class="token punctuation">.</span>RWMutex
	m     <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>muxEntry
	es    <span class="token punctuation">[</span><span class="token punctuation">]</span>muxEntry <span class="token comment">// slice of entries sorted from longest to shortest.</span>
	hosts <span class="token builtin">bool</span>       <span class="token comment">// whether any patterns contain hostnames</span>
<span class="token punctuation">}</span>

<span class="token comment">// DefaultServeMux is the default ServeMux used by Serve.</span>
<span class="token keyword">var</span> DefaultServeMux <span class="token operator">=</span> <span class="token operator">&amp;</span>defaultServeMux
<span class="token keyword">var</span> defaultServeMux ServeMux

<span class="token comment">// HandleFunc registers the handler function for the given pattern</span>
<span class="token comment">// in the DefaultServeMux.</span>
<span class="token comment">// The documentation for ServeMux explains how patterns are matched.</span>
<span class="token keyword">func</span> <span class="token function">HandleFunc</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> handler <span class="token keyword">func</span><span class="token punctuation">(</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>Request<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	DefaultServeMux<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h5><a id="1mtxHandleFuncpattern_string_handler_funcResponseWriter_Request_413"></a>1、mtx.HandleFunc(pattern string, handler func(ResponseWriter, *Request))</h5> 
<hr> 
<p><strong>最核心的两个函数我已经贴在了下方</strong><br> <strong>这里其实之前贴的那个帖子说的挺好的 这里有点像是语法糖 传入 其实本质上做了类型转换 我们只需要传入这个类型的函数 而不需要自己去定义新的类然后实现<code>ServeHTTP</code>这个函数</strong></p> 
<p><strong>然后我们仔细看看<code>Handle</code> 函数 其实很简单</strong><br> <strong>没有<code>m</code> 初始化一个 然后把我们的<code>url</code>对应的函数写入结构体 对于末尾是<code>/</code>的模式串单独写入<code>es</code></strong><br> <strong>那最后我们看看<code>ServeMux</code>的<code>ServeHTTP</code> 默认的多路复用器是怎么复用的</strong></p> 
<pre><code class="prism language-go"><span class="token keyword">type</span> HandlerFunc <span class="token keyword">func</span><span class="token punctuation">(</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>Request<span class="token punctuation">)</span>

<span class="token comment">// ServeHTTP calls f(w, r).</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>f HandlerFunc<span class="token punctuation">)</span> <span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">f</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Handle registers the handler for the given pattern.</span>
<span class="token comment">// If a handler already exists for pattern, Handle panics.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mux <span class="token operator">*</span>ServeMux<span class="token punctuation">)</span> <span class="token function">Handle</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> handler Handler<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	mux<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> mux<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> pattern <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"http: invalid pattern"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> handler <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"http: nil handler"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> exist <span class="token operator">:=</span> mux<span class="token punctuation">.</span>m<span class="token punctuation">[</span>pattern<span class="token punctuation">]</span><span class="token punctuation">;</span> exist <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"http: multiple registrations for "</span> <span class="token operator">+</span> pattern<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> mux<span class="token punctuation">.</span>m <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		mux<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>muxEntry<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	e <span class="token operator">:=</span> muxEntry<span class="token punctuation">{<!-- --></span>h<span class="token punctuation">:</span> handler<span class="token punctuation">,</span> pattern<span class="token punctuation">:</span> pattern<span class="token punctuation">}</span>
	mux<span class="token punctuation">.</span>m<span class="token punctuation">[</span>pattern<span class="token punctuation">]</span> <span class="token operator">=</span> e
	<span class="token keyword">if</span> pattern<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'/'</span> <span class="token punctuation">{<!-- --></span>
		mux<span class="token punctuation">.</span>es <span class="token operator">=</span> <span class="token function">appendSorted</span><span class="token punctuation">(</span>mux<span class="token punctuation">.</span>es<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> pattern<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token char">'/'</span> <span class="token punctuation">{<!-- --></span>
		mux<span class="token punctuation">.</span>hosts <span class="token operator">=</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// HandleFunc registers the handler function for the given pattern.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mux <span class="token operator">*</span>ServeMux<span class="token punctuation">)</span> <span class="token function">HandleFunc</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> handler <span class="token keyword">func</span><span class="token punctuation">(</span>ResponseWriter<span class="token punctuation">,</span> <span class="token operator">*</span>Request<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> handler <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"http: nil handler"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	mux<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> <span class="token function">HandlerFunc</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h5><a id="2muxServeHTTPw_ResponseWriter_r_Request_469"></a>2、mux.ServeHTTP(w ResponseWriter, r *Request)</h5> 
<hr> 
<p><strong>长话短说 <code>h.ServeHTTP(w, r)</code> 是真正的执行函数 而找到<code>handler</code>是在<code>mux.Handler(r)</code>内部 递归的看看 贴在了下面</strong><br> <strong>最后找<code>handler</code> 又是递归到了<code>mux.handler(host, path string)</code></strong></p> 
<p><strong>然后就发现 我们如何找到<code>handler</code> 就是<code>mutex.match</code>来找 正常匹配的话 则是内部<code>mux.match</code> 递归再看看</strong><br> <strong><code>ok</code> 显然易见了 直接从<code>map</code>中取 如果没有找到 则是去<code>es</code> 去模糊匹配 而且<code>es</code>内部的字符串是从长到短进行排序 这个可以从上一篇<code>mtx.HandleFunc()</code>去找 <code>mux.es = appendSorted(mux.es, e)</code></strong></p> 
<p><strong>基本上 这个<code>net/http</code>已经被我们梳理了出来了 文章基本到这里就差不多了</strong></p> 
<pre><code class="prism language-go"><span class="token comment">// Find a handler on a handler map given a path string.</span>
<span class="token comment">// Most-specific (longest) pattern wins.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mux <span class="token operator">*</span>ServeMux<span class="token punctuation">)</span> <span class="token function">match</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>h Handler<span class="token punctuation">,</span> pattern <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// Check for exact match first.</span>
	v<span class="token punctuation">,</span> ok <span class="token operator">:=</span> mux<span class="token punctuation">.</span>m<span class="token punctuation">[</span>path<span class="token punctuation">]</span>
	<span class="token keyword">if</span> ok <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> v<span class="token punctuation">.</span>h<span class="token punctuation">,</span> v<span class="token punctuation">.</span>pattern
	<span class="token punctuation">}</span>

	<span class="token comment">// Check for longest valid match.  mux.es contains all patterns</span>
	<span class="token comment">// that end in / sorted from longest to shortest.</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> e <span class="token operator">:=</span> <span class="token keyword">range</span> mux<span class="token punctuation">.</span>es <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">HasPrefix</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> e<span class="token punctuation">.</span>pattern<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> e<span class="token punctuation">.</span>h<span class="token punctuation">,</span> e<span class="token punctuation">.</span>pattern
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token string">""</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>mux <span class="token operator">*</span>ServeMux<span class="token punctuation">)</span> <span class="token function">handler</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>h Handler<span class="token punctuation">,</span> pattern <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	mux<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">RLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> mux<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">RUnlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// Host-specific pattern takes precedence over generic ones</span>
	<span class="token keyword">if</span> mux<span class="token punctuation">.</span>hosts <span class="token punctuation">{<!-- --></span>
		h<span class="token punctuation">,</span> pattern <span class="token operator">=</span> mux<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>host <span class="token operator">+</span> path<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> h <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		h<span class="token punctuation">,</span> pattern <span class="token operator">=</span> mux<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> h <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		h<span class="token punctuation">,</span> pattern <span class="token operator">=</span> <span class="token function">NotFoundHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>mux <span class="token operator">*</span>ServeMux<span class="token punctuation">)</span> <span class="token function">Handler</span><span class="token punctuation">(</span>r <span class="token operator">*</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span>h Handler<span class="token punctuation">,</span> pattern <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	<span class="token keyword">if</span> r<span class="token punctuation">.</span>Method <span class="token operator">==</span> <span class="token string">"CONNECT"</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> u<span class="token punctuation">,</span> ok <span class="token operator">:=</span> mux<span class="token punctuation">.</span><span class="token function">redirectToPathSlash</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Host<span class="token punctuation">,</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">,</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token function">RedirectHandler</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> StatusMovedPermanently<span class="token punctuation">)</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>Path
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> mux<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Host<span class="token punctuation">,</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	host <span class="token operator">:=</span> <span class="token function">stripHostPort</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>Host<span class="token punctuation">)</span>
	path <span class="token operator">:=</span> <span class="token function">cleanPath</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span>

	<span class="token keyword">if</span> u<span class="token punctuation">,</span> ok <span class="token operator">:=</span> mux<span class="token punctuation">.</span><span class="token function">redirectToPathSlash</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> path<span class="token punctuation">,</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token function">RedirectHandler</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> StatusMovedPermanently<span class="token punctuation">)</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>Path
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> path <span class="token operator">!=</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path <span class="token punctuation">{<!-- --></span>
		<span class="token boolean">_</span><span class="token punctuation">,</span> pattern <span class="token operator">=</span> mux<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> path<span class="token punctuation">)</span>
		u <span class="token operator">:=</span> <span class="token operator">&amp;</span>url<span class="token punctuation">.</span>URL<span class="token punctuation">{<!-- --></span>Path<span class="token punctuation">:</span> path<span class="token punctuation">,</span> RawQuery<span class="token punctuation">:</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>RawQuery<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token function">RedirectHandler</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> StatusMovedPermanently<span class="token punctuation">)</span><span class="token punctuation">,</span> pattern
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> mux<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

<span class="token comment">// ServeHTTP dispatches the request to the handler whose</span>
<span class="token comment">// pattern most closely matches the request URL.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>mux <span class="token operator">*</span>ServeMux<span class="token punctuation">)</span> <span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> r<span class="token punctuation">.</span>RequestURI <span class="token operator">==</span> <span class="token string">"*"</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">ProtoAtLeast</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			w<span class="token punctuation">.</span><span class="token function">Header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"Connection"</span><span class="token punctuation">,</span> <span class="token string">"close"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		w<span class="token punctuation">.</span><span class="token function">WriteHeader</span><span class="token punctuation">(</span>StatusBadRequest<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	h<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> mux<span class="token punctuation">.</span><span class="token function">Handler</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
	h<span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="4_563"></a>4、简单总结一下</h4> 
<hr> 
<p><strong>这里面博客写的挺全的 想下楼转一转了</strong><br> <strong>后面面试的时候 再想想咋总结了 = = 晚上回来还要再学一学GRPC 那就这样啦</strong></p> 
<p><strong>想看点更相信的可以烦请跳转到下面链接啦～</strong><br> <strong><a href="https://segmentfault.com/a/1190000023799082" rel="nofollow">Introduction 万字手撕Go http源码server.go</a></strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d3c0f4695fe663696cc506d9ba391eef/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unix环境高级编程_进程环境_启动代码,环境变量表,进程内存结构,库</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7838076d36edf24a62075dcd66f652bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vs 如何引用第三方库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>