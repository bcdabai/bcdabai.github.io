<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>模拟退火算法Python - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="模拟退火算法Python" />
<meta property="og:description" content="1.是什么？为什么？怎么做？ Q1:模拟退火是什么算法？ 模拟退火是模拟物理上退火方法，通过N次迭代（退火），逼近函数的上的一个最值（最大或者最小值）。
比如逼近这个函数的最大值C点：
Q2:模拟退火为什么可行？ 讨论这个问题需要理解一下物理原型是怎么样的，也就是原来是怎么“退火”的：
模拟退火算法的思想借鉴于固体的退火原理，当固体的温度很高的时候，内能比较大，固体的内部粒子处于快速无序运动，当温度慢慢降低的过程中，固体的内能减小，粒子的慢慢趋于有序，最终，当固体处于常温时，内能达到最小，此时，粒子最为稳定。
注意标粗字体：
温度高-&gt;运动速度快（温度低-&gt;运动速度慢）温度是缓慢（想象成特别慢的那种）降低的温度基本不再变化后，趋于有序(最后内能达到最小，也就是接近最优) 我们通过模拟这个操作，使得我们需要的答案“趋于有序”，也就是最靠近需要的值（最值）。
Q3:怎么做？ 大方向 首先，理解一下大方向：
模拟退火就是一种循环算法。
我们先设定一个初始的温度 T T T（这个温度会比较高，比如2000）每次循环都退火一次。（具体怎么操作后面详解）然后降低 T T T的温度，我们通过让 T T T和一个“降温系数” D e l t a T \\Delta T DeltaT（一个接近1的小数，比如 0.99 0.99 0.99)相乘，达到慢慢降低温度的效果，直到接近于0（我们用 e p s eps eps来代表一个接近0的数(比如0.00001)，只要 T &gt; e p s T&gt;eps T&gt;eps就可以退出循环了） 所以总的来说，用伪代码表示退火的流程是这样的：
T = 2000 # 代表开始的温度 dT = 0.99 # 代表系数delta T eps = 1e-14 # 相当于0.0000000000000001 while T &gt; eps： # -------------- # 这里是每一次退火的操作 # -------------- T = T * dT # 温度每次下降一点点， T * 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e87dbaae890fa88023871b62134ab306/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-14T15:54:47+08:00" />
<meta property="article:modified_time" content="2023-08-14T15:54:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">模拟退火算法Python</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1_2"></a>1.是什么？为什么？怎么做？</h3> 
<h4><a id="Q1_4"></a>Q1:模拟退火是什么算法？</h4> 
<p>模拟退火是模拟物理上退火方法，通过N次迭代（退火），逼近函数的上的一个<strong>最值</strong>（最大或者最小值）。</p> 
<p>比如逼近这个函数的最大值C点：</p> 
<p><img src="https://images2.imgbox.com/0f/98/GXzUtyxR_o.png" alt="请添加图片描述"></p> 
<h4><a id="Q2_13"></a>Q2:模拟退火为什么可行？</h4> 
<p>讨论这个问题需要理解一下物理原型是怎么样的，也就是原来是怎么“退火”的：</p> 
<p>模拟退火算法的思想借鉴于固体的退火原理，当固体的<strong>温度很高</strong>的时候，内能比较大，固体的内部粒子处于<strong>快速无序运动</strong>，当温度<strong>慢慢降低</strong>的过程中，固体的内能减小，粒子的慢慢<strong>趋于有序</strong>，最终，当固体处于常温时，<strong>内能达到最小</strong>，此时，粒子<strong>最为稳定</strong>。</p> 
<p>注意标粗字体：</p> 
<ol><li>温度高-&gt;运动速度快（温度低-&gt;运动速度慢）</li><li>温度是缓慢（想象成特别慢的那种）降低的</li><li>温度基本不再变化后，趋于有序(最后内能达到最小，也就是接近最优)</li></ol> 
<p>我们通过模拟这个操作，使得我们需要的答案“趋于有序”，也就是最靠近需要的值（最值）。</p> 
<h4><a id="Q3_27"></a>Q3:怎么做？</h4> 
<h5><a id="_29"></a>大方向</h5> 
<p>首先，理解一下<strong>大方向</strong>：</p> 
<p>模拟退火就是一种<strong>循环算法</strong>。</p> 
<ol><li>我们先设定一个初始的温度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          T 
         
        
       
         T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>（这个温度会比较高，比如2000）</li><li>每次循环都<strong>退火一次</strong>。（具体怎么操作<strong>后面详解</strong>）</li><li>然后降低<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          T 
         
        
       
         T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>的温度，我们通过让<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          T 
         
        
       
         T 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>和一个“降温系数”<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
        
          D 
         
        
          e 
         
        
          l 
         
        
          t 
         
        
          a 
         
        
          T 
         
        
       
         \\Delta T 
        
       
     </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>（一个接近1的小数，比如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0.99 
         
        
       
         0.99 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span></span></span></span></span>)相乘，达到<strong>慢慢降低</strong>温度的效果，直到接近于0（我们用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          e 
         
        
          p 
         
        
          s 
         
        
       
         eps 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">s</span></span></span></span></span>来代表一个接近0的数(比如0.00001)，只要<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          T 
         
        
          &gt; 
         
        
          e 
         
        
          p 
         
        
          s 
         
        
       
         T&gt;eps 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72243em; vertical-align: -0.0391em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">s</span></span></span></span></span>就可以退出循环了）</li></ol> 
<p>所以总的来说，用伪代码表示退火的流程是这样的：</p> 
<pre><code class="prism language-python">T <span class="token operator">=</span> <span class="token number">2000</span> <span class="token comment"># 代表开始的温度</span>
dT <span class="token operator">=</span> <span class="token number">0.99</span> <span class="token comment"># 代表系数delta T</span>
eps <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">14</span> <span class="token comment"># 相当于0.0000000000000001</span>
<span class="token keyword">while</span> T <span class="token operator">&gt;</span> eps：
    <span class="token comment"># --------------</span>
    <span class="token comment"># 这里是每一次退火的操作</span>
    <span class="token comment"># --------------</span>
    T <span class="token operator">=</span> T <span class="token operator">*</span> dT <span class="token comment"># 温度每次下降一点点， T * 0.99</span>
</code></pre> 
<h5><a id="_52"></a>退火详解</h5> 
<p>我们要求解的答案无非是两个：自变量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>和对应函数的<strong>最大值</strong><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        f(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span></p> 
<p>那么模拟退火的是怎么做到的呢？【<strong>下面车速很快，请系好安全带！</strong>】</p> 
<ol><li> <p>我们先<strong>随机</strong>找一点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           x 
          
         
           _ 
          
         
           0 
          
         
        
          x\_0 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span></span></span></span> ，不论是哪个点都可以，<strong>随机！</strong>（不超过定义域就行）。</p> <p>这个点作为我们的初始值（相当于物体里的<strong>一个粒子</strong>）</p> </li></ol> 
<p><img src="https://images2.imgbox.com/4e/e0/HedVUcEw_o.png" alt="请添加图片描述"></p> 
<ol start="2"><li>再找到一点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          f 
         
        
          ( 
         
        
          x 
         
        
          _ 
         
        
          0 
         
        
          ) 
         
        
       
         f(x\_0) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>,来代表<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          x 
         
        
          _ 
         
        
          0 
         
        
       
         x\_0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span></span></span></span>所对应的函数值</li></ol> 
<p><img src="https://images2.imgbox.com/c0/b2/lpOpdEmD_o.png" alt="请添加图片描述"></p> 
<ol start="3"><li> <p>现在正式开始退火！</p> <p>刚才我们说了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           x 
          
         
           _ 
          
         
           0 
          
         
        
          x\_0 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span></span></span></span>相当于是<strong>一个粒子</strong>，所以我们会进行一个<strong>无序运动</strong>，也就是向左或者向右随机移动</p> <p>是的，是<strong>随机移动</strong>，可能向左，也可能向右，但是请记住一个关键点：移动的<strong>幅度</strong>和<strong>当前的温度</strong><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           T 
          
         
        
          T 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>有关。</p> <p>温度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           T 
          
         
        
          T 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>越大，移动的幅度越大。温度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           T 
          
         
        
          T 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>越小，移动的幅度就越小。这是在模拟粒子无序运动的状态。</p> </li><li> <p>接受(Accept)更"好"的状态</p> </li></ol> 
<p><img src="https://images2.imgbox.com/23/6f/dyCbwZUi_o.png" alt="请添加图片描述"><br> 假设我们移动到了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         _ 
        
       
         1 
        
       
      
        x\_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span></span></span></span></span>处，那么这个点对应的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         ) 
        
       
      
        f(x\_1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>很明显答案是优于（大于）当前的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
       
         ) 
        
       
      
        f(x\_0) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>的</p> 
<p><img src="https://images2.imgbox.com/24/11/amqF2is7_o.png" alt="请添加图片描述"><br> 因此我们将答案进行<strong>更新</strong>。也就是将初始值进行替换：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         _ 
        
       
         0 
        
       
         = 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         , 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
       
         ) 
        
       
         = 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         ) 
        
       
      
        x\_0=x\_1,f(x\_0)=f(x\_1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>。这是一种<strong>贪心</strong>的思想。</p> 
<ol start="5"><li> <p>以一定概率接受(Accept)<strong>更差的状态</strong></p> <p>这是退火最精彩的部分。</p> <p>为什么我们要接受一个更加差的状态呢？因为可能在一个较差的状态旁边会出现一个<strong>更加高</strong>的山峰</p> </li></ol> 
<p><img src="https://images2.imgbox.com/0a/e4/GBz9cpwX_o.png" alt="请添加图片描述"><br> 如果我们<strong>鼠目寸光</strong>，只盯着右半区，很容易随着<strong>温度的下降、左右跳转幅度的减小</strong>而<strong>迷失自己</strong>，最后困死在小山丘中。<br> 而我们如果找到了左边山峰的低点，以<strong>一定的概率接受了它</strong>（概率大小和温度以及当前的值的关键程度有关），会在跳转幅度减少之前，<strong>尽可能找到最优点</strong>。<br> 那么我们以多少的概率去接受它呢？我们用一个公式表示（这个公式我们只需记住，这是科学家推导出来的结论）：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
        
          H 
         
        
          u 
         
        
          g 
         
        
          e 
         
         
         
           e 
          
          
           
          
            f 
           
          
            r 
           
          
            a 
           
          
            c 
           
           
            
           
             D 
            
           
             e 
            
           
             l 
            
           
             t 
            
           
             a 
            
           
             f 
            
           
           
           
             k 
            
           
             T 
            
           
          
         
        
       
         \\Huge e^{\\frac{\\Delta f}{kT}} 
        
       
     </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1.09355em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight newline"></span><span class="mord mathdefault mtight" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">c</span><span class="mord mtight"><span class="mspace mtight newline"></span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.10764em;">f</span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br> 别慌！很简单！我们来理解一下这里面的变量：<br> 1. <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         e 
        
       
      
        e 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">e</span></span></span></span></span>是自然对数，约等于2.71。我们可以把右上角这一坨值<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         f 
        
       
         r 
        
       
         a 
        
       
         c 
        
        
         
        
          D 
         
        
          e 
         
        
          l 
         
        
          t 
         
        
          a 
         
        
          f 
         
        
        
        
          k 
         
        
          T 
         
        
       
      
        \\frac{\\Delta f}{kT} 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord"><span class="mspace newline"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span></span>看成一个整体<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>:<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          x 
         
        
       
      
        e^x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>的图形画出来是这样的：</p> 
<p><img src="https://images2.imgbox.com/e4/31/Fgc3bK4z_o.png" alt="请添加图片描述"><br> 因为我们想要函数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          x 
         
        
       
      
        e^x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>来代表一个概率值，所以我们只需要关注x为<strong>负数</strong>的部分即可：</p> 
<p>负数部分的值域是在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         0 
        
       
         , 
        
       
         1 
        
       
         ) 
        
       
      
        (0,1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>开区间内，x越小，越接近0，越大越靠近1。</p> 
<p>因为在0到1之间，所以这个值相当于是概率了。比如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          x 
         
        
       
         = 
        
       
         0.97 
        
       
      
        e^x=0.97 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">7</span></span></span></span></span>，那么我们接受的概率就是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         97 
        
        
       
      
        97\\% 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">9</span><span class="mord">7</span></span><span class="mspace newline"></span></span></span></span></p> 
<p>而正数部分的值域会大于1，也就是说概率会超过<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         100 
        
        
       
      
        100\\% 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span></span><span class="mspace newline"></span></span></span></span>，所以会一定选（其实是上一种找到更优的情况）</p> 
<ol start="2"><li> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           k 
          
         
           T 
          
         
        
          kT 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           k 
          
         
        
          k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>其实是个物理学常数，我们在代码中<strong>不会用到</strong>。</p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           T 
          
         
        
          T 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>很简单，就是当前的温度。所以实际上这个分母就是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           T 
          
         
        
          T 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           k 
          
         
        
          k 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>当做<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           1 
          
         
        
          1 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>使用。</p> </li><li> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
         
           D 
          
         
           e 
          
         
           l 
          
         
           t 
          
         
           a 
          
         
           f 
          
         
        
          \\Delta f 
         
        
      </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span></p> </li></ol> 
<p>我们着重讲一下什么是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         D 
        
       
         e 
        
       
         l 
        
       
         t 
        
       
         a 
        
       
         f 
        
       
      
        \\Delta f 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>。</p> 
<p>其实从前面的函数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          x 
         
        
       
      
        e^x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>中可以发现，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         D 
        
       
         e 
        
       
         l 
        
       
         t 
        
       
         a 
        
       
         f 
        
       
      
        \\Delta f 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>必须是个负数！</p> 
<p>我们想要函数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          x 
         
        
       
      
        e^x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>来代表一个概率值，一定要让它的值域属于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         0 
        
       
         , 
        
       
         1 
        
       
         ) 
        
       
      
        (0,1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>，所以<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         f 
        
       
         r 
        
       
         a 
        
       
         c 
        
        
         
        
          D 
         
        
          e 
         
        
          l 
         
        
          t 
         
        
          a 
         
        
          f 
         
        
        
        
          k 
         
        
          T 
         
        
       
      
        \\frac{\\Delta f}{kT} 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord"><span class="mspace newline"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span></span>必须是个负数。但是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         k 
        
       
         T 
        
       
      
        kT 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span>在我们的模拟中一定是正数，那么<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         D 
        
       
         e 
        
       
         l 
        
       
         t 
        
       
         a 
        
       
         f 
        
       
      
        \\Delta f 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>必须是个负数！</p> 
<p>其实<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         D 
        
       
         e 
        
       
         l 
        
       
         t 
        
       
         a 
        
       
         f 
        
       
      
        \\Delta f 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span></span></span></span>就是当前解的函数值与目标解函数值之差，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         D 
        
       
         e 
        
       
         l 
        
       
         t 
        
       
         a 
        
       
         f 
        
       
         = 
        
       
         − 
        
        
       
         l 
        
       
         e 
        
       
         f 
        
       
         t 
        
       
         ∣ 
        
       
         f 
        
        
       
         l 
        
       
         e 
        
       
         f 
        
       
         t 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
        
       
         r 
        
       
         i 
        
       
         g 
        
       
         h 
        
       
         t 
        
       
         ) 
        
       
         − 
        
       
         f 
        
        
       
         l 
        
       
         e 
        
       
         f 
        
       
         t 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
        
       
         r 
        
       
         i 
        
       
         g 
        
       
         h 
        
       
         t 
        
       
         ) 
        
        
       
         r 
        
       
         i 
        
       
         g 
        
       
         h 
        
       
         t 
        
       
         ∣ 
        
       
      
        \\Delta f=-\\left|f\\left(x\_0\\right)-f\\left(x\_1\\right)\\right| 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mord">∣</span></span></span></span></span>，并且一定是个负数。这个需要<strong>具体问题具体分析</strong>。</p> 
<p>比如现在我们求一个函数的<strong>最大值</strong>，那么如果<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
       
         ) 
        
       
         &lt; 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         ) 
        
       
      
        f(x\_0) &lt; f(x\_1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>了，那就说明结果<strong>变好了</strong>，我们<strong>肯定</strong>选择它（见第4点）</p> 
<p>如果<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
       
         ) 
        
       
         &gt; 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         ) 
        
       
      
        f(x\_0) &gt; f(x\_1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>，那就说明结果<strong>变差了</strong>，我们需要概率选择它，因此<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         D 
        
       
         e 
        
       
         l 
        
       
         t 
        
       
         a 
        
       
         f 
        
       
         = 
        
       
         − 
        
       
         ( 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
       
         ) 
        
       
         – 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         ) 
        
       
         ) 
        
       
      
        \\Delta f=-(f(x\_0) – f(x\_1)) 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span><span class="mord" style="margin-right: 0.02778em;">–</span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p> 
<p><img src="https://images2.imgbox.com/9d/a2/eGqnzGJ6_o.png" alt="请添加图片描述"></p> 
<p>所以总结一下就是：</p> 
<p>随机后的函数值如果结果更好，我们一定选择它(即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         _ 
        
       
         0 
        
       
         = 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         , 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         0 
        
       
         ) 
        
       
         = 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         _ 
        
       
         1 
        
       
         ) 
        
       
      
        x\_0=x\_1,f(x\_0)=f(x\_1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06em; vertical-align: -0.31em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>)<br> 随机后的函数值如果结果更差，我们以<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         L 
        
       
         A 
        
       
         R 
        
       
         G 
        
       
         E 
        
        
        
          e 
         
         
          
         
           f 
          
         
           r 
          
         
           a 
          
         
           c 
          
          
           
          
            D 
           
          
            e 
           
          
            l 
           
          
            t 
           
          
            a 
           
          
            f 
           
          
          
          
            k 
           
          
            T 
           
          
         
        
       
      
        \\LARGE e^{\\frac{\\Delta f}{kT}} 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight newline"></span><span class="mord mathdefault mtight" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">c</span><span class="mord mtight"><span class="mspace mtight newline"></span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">D</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.10764em;">f</span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span></span>的概率接受它</p> 
<h5><a id="_142"></a>伪代码流程</h5> 
<blockquote> 
 <p>注：对代码中的函数作出解释：<br> import random<br> ①对random函数</p> 
 <ol><li> <p>random.randint(0,32767)拿到[0,32767]内的随机整数</p> </li><li> <p>random.randint(0,32767)<em>2的范围是[0,32767</em> 2]</p> </li><li> <p>random.randint(0,32767)*2-32767 的范围是[-32767, 32767]</p> </li></ol> 
 <p>import math<br> ②对math.exp()函数</p> 
 <ol><li>math.exp(x)代表<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            e 
           
          
            x 
           
          
         
        
          e^x 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span></li></ol> 
 <p>③关于math.exp((f - df) / T) * 32767 &gt; random.randint(0, 32767)</p> 
 <ol><li>目的是要概率接受，但是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            e 
           
          
            x 
           
          
         
        
          e^x 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>是个准确值，所以从理论上我们可以生成一个（0,1）的随机数，如果<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            e 
           
          
            x 
           
          
         
        
          e^x 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>比(0,1)这个随机数要大，那么我们就接受。</li><li>但是由于rand()只能产生[0,32767]内的随机整数，化成小数太过麻烦。所以我们可以把左边乘以32767（也就是把概率同时扩大32767倍），效果就等同于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            e 
           
          
            x 
           
          
         
        
          e^x 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>比(0,1)了。</li></ol> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> math

T <span class="token operator">=</span> <span class="token number">2000</span> <span class="token comment"># 代表开始的温度</span>
dT <span class="token operator">=</span> <span class="token number">0.99</span> <span class="token comment"># 代表系数delta T</span>
eps <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">14</span> <span class="token comment"># 相当于0.0000000000000001</span>

<span class="token comment"># 用自变量计算函数值,这里可能存在多个自变量对应一个函数值的情况，比如f(x,y)</span>
<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token comment"># 这里是对函数值进行计算</span>
    ans <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> ans
<span class="token comment"># 原始值</span>
x <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">32767</span><span class="token punctuation">)</span> <span class="token comment"># x0取随机值</span>
f <span class="token operator">=</span> func<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment"># 通过自变量算出f(x0)的值</span>
<span class="token keyword">while</span> T <span class="token operator">&gt;</span> eps<span class="token punctuation">:</span> 
    <span class="token comment"># --------------</span>
    <span class="token comment"># 这里是每一次退火的操作</span>

    <span class="token comment"># x1可以左右随机移动，幅度和温度T正相关，所以*T</span>
    <span class="token comment"># 注意这里移动可以左右移动，但是也可以单向移动</span>
    dx <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token operator">*</span> T 

    <span class="token comment"># 让x落在定义域内，如果没在里面，就重新随机。题目有要求需要写，否则不用写</span>
    <span class="token comment"># ================</span>
    <span class="token keyword">while</span> x <span class="token operator">&gt;</span> ? <span class="token operator">|</span><span class="token operator">|</span> x <span class="token operator">&lt;</span> ? <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">:</span>
        dx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> RAND_MAX<span class="token punctuation">)</span> <span class="token operator">*</span> T 
    <span class="token comment"># ================</span>

    <span class="token comment"># 求出f(x1)的值</span>
    df <span class="token operator">=</span> func<span class="token punctuation">(</span>dx<span class="token punctuation">)</span>
    <span class="token comment"># 这里需要具体问题具体分析，我们要接受更加优秀的情况。可能是df &lt; f(比如求最小值）</span>
    <span class="token keyword">if</span> f <span class="token operator">&lt;</span> df <span class="token punctuation">:</span>
        f <span class="token operator">=</span> df
        x <span class="token operator">=</span> dx  <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>y <span class="token operator">=</span> dy<span class="token punctuation">]</span> <span class="token comment"># 接受，替换值，如果多个自变量，那么都替换</span>
    <span class="token comment"># 否则概率接受，注意这里df-f也要具体问题具体分析。</span>
    <span class="token keyword">elif</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">-</span> df<span class="token punctuation">)</span> <span class="token operator">/</span> T<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">32767</span> <span class="token operator">&gt;</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32767</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> df
        x <span class="token operator">=</span> dx  <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>y <span class="token operator">=</span> dy<span class="token punctuation">]</span> <span class="token comment"># 接受，替换值，如果多个自变量，那么都替换</span>
    <span class="token comment"># --------------</span>
    T <span class="token operator">=</span> T <span class="token operator">*</span> dT <span class="token comment"># 温度每次下降一点点， T * 0.99</span>

</code></pre> 
<h3><a id="2_n_209"></a>2.通过模拟退火算出 根号n的值</h3> 
<p>思路是这样的：我们试图通过退火找出一个值<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         _ 
        
       
         0 
        
       
      
        x\_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span></span></span></span>，使得<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           x 
          
         
           _ 
          
         
           0 
          
         
        
          2 
         
        
       
      
        {x\_0}^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.15845em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.848448em;"><span class="" style="top: -3.09734em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>的值更加接近于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
          
         
           s 
          
         
           q 
          
         
           r 
          
         
           t 
          
         
           n 
          
         
        
          2 
         
        
       
      
        {\\sqrt{n}}^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.01353em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mspace newline"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">n</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.819088em;"><span class="" style="top: -3.06798em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>。（记住退火是让一个随机值去逼近最后的答案）</p> 
<p>因为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           x 
          
         
           _ 
          
         
           0 
          
         
        
          2 
         
        
       
      
        {x\_0}^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.15845em; vertical-align: -0.31em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.848448em;"><span class="" style="top: -3.09734em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>的值更加接近于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
          
         
           s 
          
         
           q 
          
         
           r 
          
         
           t 
          
         
           n 
          
         
        
          2 
         
        
       
      
        {\\sqrt{n}}^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.01353em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord"><span class="mspace newline"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">n</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.819088em;"><span class="" style="top: -3.06798em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>。因此<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
         _ 
        
       
         0 
        
       
      
        x\_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.95444em; vertical-align: -0.31em;"></span><span class="mord mathdefault">x</span><span class="mord" style="margin-right: 0.02778em;">_</span><span class="mord">0</span></span></span></span></span>值就更加接近于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
       
         s 
        
       
         q 
        
       
         r 
        
       
         t 
        
       
         n 
        
       
      
        \\sqrt{n} 
       
      
    </span><span class="katex-html"><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.80952em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">n</span></span></span></span></span></span></p> 
<p>#完整代码和注释供大家调试:</p> 
<pre><code class="prism language-python"><span class="token comment"># 通过模拟退火算出根号n的值</span>
<span class="token keyword">import</span> random
<span class="token keyword">import</span> math

n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># n代表我们最后函数要逼近的值</span>
dT <span class="token operator">=</span> <span class="token number">0.993</span>  <span class="token comment"># 代表系数delta T，变化率，这里需要速度稍微慢一点，写0.995 或者 0.997都可以，但是越靠近1速度就越慢</span>
eps <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">14</span>  <span class="token comment"># 10的-14次方已经非常小了，写这个大概率没问题</span>


<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> math<span class="token punctuation">.</span>fabs<span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">-</span> n<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">SA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 首先随机生成一个点x0，这里我用0代替。</span>
    T <span class="token operator">=</span> <span class="token number">20000</span>  <span class="token comment"># 代表开始的温度，初始温度主要是看题目开始需要跳转的幅度。</span>
    f <span class="token operator">=</span> func<span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token comment"># 算出x平方和n的差距f(x0)</span>
    <span class="token keyword">while</span> T <span class="token operator">&gt;</span> eps<span class="token punctuation">:</span>
        <span class="token comment"># 这里x0既可以变小，也可以变大，所以我们正负都要进行一个跳转,算出变换后的点dx</span>
        dx <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token operator">*</span> T
        <span class="token comment"># 但是请注意，dx很明显要保证 &gt;= 0才行，因为算术平方根的定义域是&gt;=0，因此小于0就重新随机</span>
        <span class="token keyword">while</span> dx <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            dx <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">32767</span><span class="token punctuation">)</span> <span class="token operator">*</span> T
        df <span class="token operator">=</span> func<span class="token punctuation">(</span>dx<span class="token punctuation">)</span>  <span class="token comment"># 算出变换后的点dx的平方和n的差距，f(dx)</span>
        <span class="token comment"># 这里就是关键的地方了，很明显我们需要算出来的function值越小，自变量x更加接近那个根号值。所以如果新来的值df 比 f更小，我们百分百接受</span>
        <span class="token keyword">if</span> df <span class="token operator">&lt;</span> f<span class="token punctuation">:</span>
            x <span class="token operator">=</span> dx
            f <span class="token operator">=</span> df
        <span class="token comment"># 否则我们概率接受，这里的需要写 f - df了，因为这样才是负值。负值说明我们并不是贪心接受的，他是不太好的值。</span>
        <span class="token keyword">elif</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">-</span> df<span class="token punctuation">)</span> <span class="token operator">/</span> T<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">32767</span> <span class="token operator">&gt;</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32767</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> dx
            f <span class="token operator">=</span> df
        <span class="token comment"># 温度下降一下</span>
        T <span class="token operator">*=</span> dT
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%.8f"</span><span class="token operator">%</span> x<span class="token punctuation">)</span>


SA<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>假设输入为2，则输出为：<br> <img src="https://images2.imgbox.com/b0/2d/ghekoOhm_o.png" alt="在这里插入图片描述"></p> 
<p>参考：<br> <a href="https://www.bilibili.com/video/BV1Hb4y1J7PN?spm_id_from=333.337.search-card.all.click" rel="nofollow">B站视频：大学生速通模拟退火算法_哔哩哔哩_bilibili</a><br> <a href="https://www.tocry.cn/simulated-annealing/" rel="nofollow">博客：速通模拟退火 - Don’t Cry！</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e9a981118bc6fc5ef13b578d52d01f0e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Navicat的使用flushing</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c29f226edb0f4bc7dfe4476045152685/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">day7 ADC模数转换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>