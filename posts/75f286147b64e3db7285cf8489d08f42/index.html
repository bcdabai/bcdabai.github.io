<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CC2530之UART串口通信 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CC2530之UART串口通信" />
<meta property="og:description" content="利用单片机的串口与计算机通信，可方便对各种实验数据进行观察。 CC2530有两个串口，分别为USART0和USART1。由于采用了引脚复用功能，外设与引脚对应的关系可根据外设控制寄存器PERCFG进行配置，具体对应情况如下： UART0对应的外部引脚关系，位置1：Rx - P0_2 Tx - P0_3 ；位置2：Rx - P1_4 Tx - P1_5 UART1对应的外部引脚关系，位置1：Rx – P0_5 Tx – P0_4；位置2：Rx - P1_7 Tx - P1_6 由寄存器UxBAUD.BAUD_M[7： 0]和UxGCR.BAUD_E[4： 0]定义波特率。 串口波特率设置公式： 选择外部32MHz晶振时，具体值可参阅下表： 测试程序如下： #include &lt;iocc2530.h&gt; #define uint unsigned int #define uchar unsigned char void setSysClock(); void uart0Init(); void uart0SendStr(uchar *str); void main() { setSysClock(); uart0Init(); uart0SendStr(&#34;Hello world\n&#34;); while (1) { } } /** * 设置系统时钟为32MHz */ void setSysClock() { CLKCONCMD &amp;= ~0x40; // 选择系统时钟源为外部32MHz crystal oscillator while(CLKCONSTA &amp; 0x40); // 等待晶振启动 CLKCONCMD &amp;= ~0x47; // 设置系统时钟频率为32MHZ } /** * 8-bit数据位，无奇偶校验，Baud:115200bps */ void uart0Init() { PERCFG = 0x00; // 外设控制，UART0选择端口位置1 P0SEL = 0x0C; // 端口0功能选择，P0_2、P0_3用作串口 P2DIR &amp;= ~0xC0; // 端口0外设优先级控制，高2位置0，USART0优先 U0CSR |= 0x80; // UART模式 U0GCR |= 11; U0BAUD |= 216; // 采用32MHz系统时钟时，波特率设置为115200 UTX0IF = 0; // UART0 TX中断标志初始置位0 } void uart0SendStr(uchar *str) { while (*str !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/75f286147b64e3db7285cf8489d08f42/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-06-02T10:20:21+08:00" />
<meta property="article:modified_time" content="2016-06-02T10:20:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CC2530之UART串口通信</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>　　利用单片机的串口与计算机通信，可方便对各种实验数据进行观察。 <br> 　　CC2530有两个串口，分别为USART0和USART1。由于采用了引脚复用功能，外设与引脚对应的关系可根据外设控制寄存器PERCFG进行配置，具体对应情况如下： <br> </p> 
<center>
  UART0对应的外部引脚关系，位置1：Rx - P0_2 Tx - P0_3 ；位置2：Rx - P1_4 Tx - P1_5 
 <br> UART1对应的外部引脚关系，位置1：Rx – P0_5 Tx – P0_4；位置2：Rx - P1_7 Tx - P1_6 
</center> 
<p></p> 
<p>由寄存器UxBAUD.BAUD_M[7： 0]和UxGCR.BAUD_E[4： 0]定义波特率。 <br> </p> 
<center>
  串口波特率设置公式： 
 <img title="" alt="这里写图片描述" src="https://images2.imgbox.com/f2/b3/P3Ju6zbh_o.png"> 
</center> 
<p></p> 
<p>选择外部32MHz晶振时，具体值可参阅下表： <br> </p> 
<center> 
 <img title="" alt="这里写图片描述" src="https://images2.imgbox.com/8e/bd/jquAOyKA_o.png"> 
</center> 
<p></p> 
<h3 id="测试程序如下"><strong>测试程序如下：</strong></h3> 
<pre class="prettyprint"><code class=" hljs java">#include &lt;iocc2530.h&gt;

#define uint unsigned <span class="hljs-keyword">int</span>
#define uchar unsigned <span class="hljs-keyword">char</span>

<span class="hljs-keyword">void</span> setSysClock();
<span class="hljs-keyword">void</span> uart0Init();
<span class="hljs-keyword">void</span> uart0SendStr(uchar *str);

<span class="hljs-keyword">void</span> main()
{
    setSysClock();       
    uart0Init();

    uart0SendStr(<span class="hljs-string">"Hello world\n"</span>);

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {

    }
}

<span class="hljs-javadoc">/**
 * 设置系统时钟为32MHz
 */</span>
<span class="hljs-keyword">void</span> setSysClock()
{
    CLKCONCMD &amp;= ~<span class="hljs-number">0x40</span>;           <span class="hljs-comment">// 选择系统时钟源为外部32MHz crystal oscillator</span>
    <span class="hljs-keyword">while</span>(CLKCONSTA &amp; <span class="hljs-number">0x40</span>);      <span class="hljs-comment">// 等待晶振启动 </span>
    CLKCONCMD &amp;= ~<span class="hljs-number">0x47</span>;           <span class="hljs-comment">// 设置系统时钟频率为32MHZ  </span>
}

<span class="hljs-javadoc">/**
 * 8-bit数据位，无奇偶校验，Baud:115200bps
 */</span>
<span class="hljs-keyword">void</span> uart0Init()
{
    PERCFG = <span class="hljs-number">0x00</span>;   <span class="hljs-comment">// 外设控制，UART0选择端口位置1 </span>
    P0SEL = <span class="hljs-number">0x0C</span>;    <span class="hljs-comment">// 端口0功能选择，P0_2、P0_3用作串口</span>
    P2DIR &amp;= ~<span class="hljs-number">0xC0</span>;  <span class="hljs-comment">// 端口0外设优先级控制，高2位置0，USART0优先</span>

    U0CSR |= <span class="hljs-number">0x80</span>;   <span class="hljs-comment">// UART模式</span>
    U0GCR |= <span class="hljs-number">11</span>;
    U0BAUD |= <span class="hljs-number">216</span>;   <span class="hljs-comment">// 采用32MHz系统时钟时，波特率设置为115200</span>
    UTX0IF = <span class="hljs-number">0</span>;      <span class="hljs-comment">// UART0 TX中断标志初始置位0</span>

}

<span class="hljs-keyword">void</span> uart0SendStr(uchar *str)
{
    <span class="hljs-keyword">while</span> (*str != <span class="hljs-string">'\0'</span>) {
        U0DBUF = *str++;
        <span class="hljs-keyword">while</span>(UTX0IF != <span class="hljs-number">1</span>);  <span class="hljs-comment">// 等待发送完成</span>
        UTX0IF = <span class="hljs-number">0</span>; 
    }
}
</code></pre> 
<p>采用上位机观察实验结果</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cf0e6bc64648394565e41476a5af13af/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">bitmap.setPixels()方法及自己理解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba9f7183f7172553cfe32606af29c450/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">J2ee项目从0搭建(一):eclipse下载、安装、使用习惯配置迁移</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>