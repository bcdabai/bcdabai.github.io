<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>超级实用且不花哨的js代码大全（一） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="超级实用且不花哨的js代码大全（一）" />
<meta property="og:description" content="事件源对象 event.srcElement.tagName event.srcElement.type 捕获释放 event.srcElement.setCapture(); event.srcElement.releaseCapture(); 事件按键 event.keyCode event.shiftKey event.altKey event.ctrlKey 事件返回值 event.returnValue 鼠标位置 event.x event.y 窗体活动元素 document.activeElement 绑定事件 document.captureEvents(Event.KEYDOWN); 访问窗体元素 document.all(&#34;txt&#34;).focus(); document.all(&#34;txt&#34;).select(); 窗体命令 document.execCommand 窗体COOKIE document.cookie 菜单事件 document.oncontextmenu 创建元素 document.createElement(&#34;SPAN&#34;); 根据鼠标获得元素： document.elementFromPoint(event.x,event.y).tagName==&#34;TD document.elementFromPoint(event.x,event.y).appendChild(ms) 窗体图片 document.images[索引] 窗体事件绑定 document.οnmοusedοwn=scrollwindow; 元素 document.窗体.elements[索引] 对象绑定事件 document.all.xxx.detachEvent(&#39;onclick&#39;,a); 插件数目 navigator.plugins 取变量类型 typeof($js_libpath) == &#34;undefined&#34; 下拉框 下拉框.options[索引] 下拉框.options.length 查找对象 document.getElementsByName(&#34;r1&#34;); document.getElementById(id); 定时 timer=setInterval(&#39;scrollwindow()&#39;,delay); clearInterval(timer); UNCODE编码 escape() ,unescape 父对象 obj.parentElement(dhtml) obj.parentNode(dom) 交换表的行 TableID.moveRow(2,1) 替换CSS document.all.csss.href = &#34;a.css&#34;; 并排显示 display:inline 隐藏焦点 hidefocus=true 根据宽度换行 style=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1a585288de6998904f1c3dfa54b8bac7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-28T09:47:19+08:00" />
<meta property="article:modified_time" content="2019-04-28T09:47:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">超级实用且不花哨的js代码大全（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>事件源对象 <br> event.srcElement.tagName <br> event.srcElement.type <br> 捕获释放 <br> event.srcElement.setCapture(); <br> event.srcElement.releaseCapture(); <br> 事件按键 <br> event.keyCode <br> event.shiftKey <br> event.altKey <br> event.ctrlKey <br> 事件返回值 <br> event.returnValue <br> 鼠标位置 <br> event.x <br> event.y <br> 窗体活动元素 <br> document.activeElement <br> 绑定事件 <br> document.captureEvents(Event.KEYDOWN); <br> 访问窗体元素 <br> document.all("txt").focus(); <br> document.all("txt").select(); <br> 窗体命令 <br> document.execCommand <br> 窗体COOKIE <br> document.cookie <br> 菜单事件 <br> document.oncontextmenu <br> 创建元素 <br> document.createElement("SPAN"); <br> 根据鼠标获得元素： <br> document.elementFromPoint(event.x,event.y).tagName=="TD <br> document.elementFromPoint(event.x,event.y).appendChild(ms) <br> 窗体图片 <br> document.images[索引] <br> 窗体事件绑定 <br> document.οnmοusedοwn=scrollwindow; <br> 元素 <br> document.窗体.elements[索引] <br> 对象绑定事件 <br> document.all.xxx.detachEvent('onclick',a); <br> 插件数目 <br> navigator.plugins <br> 取变量类型 <br> typeof($js_libpath) == "undefined" <br> 下拉框 <br> 下拉框.options[索引] <br> 下拉框.options.length <br> 查找对象 <br> document.getElementsByName("r1"); <br> document.getElementById(id); <br> 定时 <br> timer=setInterval('scrollwindow()',delay); <br> clearInterval(timer); <br> UNCODE编码 <br> escape() ,unescape <br> 父对象 <br> obj.parentElement(dhtml) <br> obj.parentNode(dom) <br> 交换表的行 <br> TableID.moveRow(2,1) <br> 替换CSS <br> document.all.csss.href = "a.css"; <br> 并排显示 <br> display:inline <br> 隐藏焦点 <br> hidefocus=true <br> 根据宽度换行 <br> style="word-break:break-all" <br> 自动刷新 <br> &lt;meta HTTP-EQUIV="refresh" C&gt; <br> 简单邮件 <br> &lt;a href="[email=aaa@bbb.com?subject=ccc&amp;body=xxxyyy]mailto:aaa@bbb.com?subject=ccc&amp;body=xxxyyy[/email]"&gt; <br> 快速转到位置 <br> obj.scrollIntoView(true) <br> 锚 <br> &lt;a name="first"&gt; <br> &lt;a href="#first"&gt;anchors&lt;/a&gt; <br> 网页传递参数 <br> location.search(); <br> 可编辑 <br> obj.contenteditable=true <br> 执行菜单命令 <br> obj.execCommand <br> 双字节字符 <br> /[^\x00-\xff]/ <br> 汉字 <br> /[\u4e00-\u9fa5]/ <br> 让英文字符串超出表格宽度自动换行 <br> word-wrap: break-word; word-break: break-all; <br> 透明背景 <br> &lt;IFRAME src="1.htm" width=300 height=180 allowtransparency&gt;&lt;/iframe&gt; <br> 获得style内容 <br> obj.style.cssText <br> HTML标签 <br> document.documentElement.innerHTML <br> 第一个style标签 <br> document.styleSheets[0] <br> style标签里的第一个样式 <br> document.styleSheets[0].rules[0] <br> 防止点击空链接时，页面往往重置到页首端。 <br> &lt;a href="javascript:function()"&gt;word&lt;/a&gt; <br> 上一网页源 <br> asp: <br> request.servervariables("HTTP_REFERER") <br> javascript: <br> document.referrer <br> 释放内存 <br> CollectGarbage(); <br> 禁止右键 <br> document.oncontextmenu = function() { return false;} <br> 禁止保存 <br> &lt;noscript&gt;&lt;iframe src="*.htm"&gt;&lt;/iframe&gt;&lt;/noscript&gt; <br> 禁止选取&lt;body Shortcut Icon" href="favicon.ico"&gt; <br> favicon.ico 名字最好不变16*16的16色,放虚拟目录根目录下 <br> 收藏栏图标 <br> &lt;link rel="Bookmark" href="favicon.ico"&gt; <br> 查看源码 <br> &lt;input type=button value=查看网页源代码 &gt; <br> 关闭输入法 <br> &lt;input style="ime-mode:disabled"&gt; <br> 自动全选 <br> &lt;input type=text name=text1 value="123" &gt; <br> ENTER键可以让光标移到下一个输入框 <br> &lt;input &gt; <br> 文本框的默认值 <br> &lt;input type=text value="123" &gt; <br> title换行 <br> obj.title = "123 sdfs " <br> 获得时间所代表的微秒 <br> var n1 = new Date("2004-10-10".replace(/-/g, "\/")).getTime() <br> 窗口是否关闭 <br> win.closed <br><br> checkbox扁平 <br> &lt;input type=checkbox style="position: absolute; clip:rect(5px 15px 15px 5px)"&gt;&lt;br&gt; <br> 获取选中内容 <br> document.selection.createRange().duplicate().text <br> 自动完成功能 <br> &lt;input type=text autocomplete=on&gt;打开该功能 <br> &lt;input type=text autocomplete=off&gt;关闭该功能 <br> 关闭窗口 <br> window.close(); <br> 返回 <br> history.back(); <br> 无关闭按钮IE window.open("aa.htm", "meizz", "fullscreen=7"); <br> 统一编码/解码 alert(decodeURIComponent(encodeURIComponent("http://你好.com?as= hehe")))<br> encodeURIComponent对":"、"/"、";" 和 "?"也编码 <br> 高级应用(一) <br><br> 页面跳转： <br> 　　window.location.href('地址') <br> 　　window.open('地址', '_self') <br> 打开新窗口： <br> 　　window.open('地址', '_blank') <br> 　　只显示地址栏：window.open('地址', 'title', 'location=1, height=200, width=500') <br> 　　只显示状态栏：window.open('地址', 'title', 'status=1') <br> 　　只显示工具栏：window.open('地址', 'title', 'toolbar=1') <br> 　　只显示菜单栏：window.open('地址', 'title', 'menubar=1') <br> 　　一个不少：window.open('地址', 'title) <br> 　　光棍但可以调整大小：window.open('地址', 'title', 'resizable=1') <br> 去掉所有空格： <br> 　　Object.replace(/^\s+|\s+$/g, "") <br> 屏蔽鼠标： <br> 　　οncοntextmenu="window.event.returnValue=false" <br> 取消选取： <br> 　　onselectstart="return false" <br> 不允许粘贴： <br> 　　οnpaste="return false" <br> 关闭输入法： <br> 　　&lt;input style="ime-mode:disabled"&gt; <br> 不允许另存为： <br> 　　&lt;noscript&gt;&lt;iframe src=*.html&gt;&lt;/iframe&gt;&lt;/noscript&gt; <br> 得到上一页来源： <br> 　　document.referrer <br> 弹出窗口总在最上： <br> 　　&lt;body &gt; <br> 弹出确认对话框： <br> 　　comfirm('文本')" <br> 　　&lt;script&gt;if(confirm('文本')){//确定}else{//取消} <br> 回车转换Tab键： <br> 　　if(window.event.keyCode==13){event.keyCode=9} <br> 返回上一页： <br> 　　history.go(-1) <br> 重新加载页面： <br> 　　window.location.reload() <br> 子页面中调父页面中的方法： <br> 　　window.opener.function() <br> 子页面中访问父页面中名为name的控件值： <br> 　　window.opener.name.value <br> 子页面中访问父页面中表单中名为name的控件值： <br> 　　window.opener.formName.nam.value <br> 得到控件的绝对位置：</p> 
<pre class="has"><code class="language-javascript">function getIE() { 
    var t = e.offsetTop; 
    var l = e.offsetLeft; 
    while (e = e.offsetParent) { 
        t += e.offsetTop; 
        l += e.offsetLeft; 
    } 
    alert("top=" + t + " and left=" + l); 
} </code></pre> 
<p><br> 光标停在文本框文字的最后： <br> 　　function toEnd() { <br> 　　　　var e = event.srcElement; <br> 　　　　var r = e.createTextRange(); <br> 　　　　r.moveStart("character", e.value.length); <br> 　　　　r.collapse(true); <br> 　　　　r.select(); <br> 　　} <br> 　　&lt;input type="text" value="end" &gt; <br> 屏蔽功能键(Shift, Alt, Ctrl) <br> 　　function testKey() { <br> 　　　　if (event.shiftKey) {　　// altKey; ctrlKey <br> 　　　　　　alert("Shift"); <br> 　　　　} <br> 　　} <br> 不要滚动条： <br> 　　&lt;body scroll="no"&gt; <br> 让竖条没有： <br> 　　&lt;body style="overflow:scroll; overflow-y: hidden"&gt; <br> 让横条没有： <br> 　　&lt;body style="overflow:scroll; overflow-x: hidden"&gt; <br> 去掉图片链接点击后图片周围的虚线： <br> 　　&lt;a href="#" &gt;&lt;img src="test.jpg"&gt;&lt;/a&gt; <br> 在子窗体中刷新父窗体： <br> 　　window.opener.location.reload() <br> 设置打开窗口的大小： <br> 　　&lt;body 100)"&gt; <br> 设置打开窗口的位置： <br> 　　&lt;body 100)"&gt; <br> 得到窗体大小： <br> 　　document.body.clientWidth; <br> 　　document.body.clientHeight; <br> TEXTAREA自适应文字行数： <br> 　　&lt;textarea rows="1" cols="17" onpropertychange="this.style.posHeight=this.scrollHeight&gt;&lt;/textarea&gt; <br> 屏蔽脚本错误： <br> 　　function killErrors() { <br> 　　　　return true; <br> 　　} <br> 　　window.οnerrοr=killErrors(); <br> 判断是否是字符： <br> 　　if (/[^/x00-/xff]/g.test(str)) { <br> 　　　　alert("有汉字"); <br> 　　} else { <br> 　　　　alert("全是字符"); <br> 　　} <br><br> screen.属性： <br> 　　availHeight 获取系统屏幕的工作区域高度，排除 Microsoft&amp;reg; Windows&amp;reg; 任务栏。 <br> 　　availWidth 获取系统屏幕的工作区域宽度，排除 Windows 任务栏。 <br> 　　bufferDepth 设置或获取用于画面外位图缓冲颜色的每像素位数。 <br> 　　colorDepth 获取用于目标设置或缓冲区的颜色每像素位数。 <br> 　　deviceXDPI 设置或获取系统屏幕水平每英寸点数(DPI)的数值。 <br> 　　deviceYDPI 设置或获取系统屏幕垂直每英寸点数(DPI)的数值。 <br> 　　fontSmoothingEnabled 获取用户是否在控制面板的显示设置中启用了圆整屏幕字体边角的选项。 <br> 　　height 获取屏幕的垂直分辨率。 <br> 　　logicalXDPI 获取系统屏幕水平每英寸点数(DPI)的常规数值。 <br> 　　logicalYDPI 获取系统屏幕垂直每英寸点数(DPI)的常规数值。 <br> 　　updateInterval 设置或获取屏幕的更新间隔。 <br> 　　width 获取屏幕的垂直分辨率。 <br><br> 得到div的height值： <br> 　　div.offsetHeight(带滚动条的完整高度) <br> 　　div.clientHeight(内容的高度) <br><br> //各种尺寸 <br><br> s += "\r\n网页可见区域宽："+ document.body.clientWidth; <br> s += "\r\n网页可见区域高："+ document.body.clientHeight; <br> s += "\r\n网页可见区域高："+ document.body.offsetWeight +" (包括边线的宽)"; <br> s += "\r\n网页可见区域高："+ document.body.offsetHeight +" (包括边线的宽)"; <br> s += "\r\n网页正文全文宽："+ document.body.scrollWidth; <br> s += "\r\n网页正文全文高："+ document.body.scrollHeight; <br> s += "\r\n网页被卷去的高："+ document.body.scrollTop; <br> s += "\r\n网页被卷去的左："+ document.body.scrollLeft; <br> s += "\r\n网页正文部分上："+ window.screenTop; <br> s += "\r\n网页正文部分左："+ window.screenLeft; <br> s += "\r\n屏幕分辨率的高："+ window.screen.height; <br> s += "\r\n屏幕分辨率的宽："+ window.screen.width; <br> s += "\r\n屏幕可用工作区高度："+ window.screen.availHeight; <br> s += "\r\n屏幕可用工作区宽度："+ window.screen.availWidth; <br><br> //过滤数字 <br><br> &lt;input type=text οnkeypress="return event.keyCode&gt;=48&amp;&amp;event.keyCode&lt;=57||(this.value.indexOf('.')&lt;0?event.keyCode==46:false)" οnpaste="return !clipboardData.getData('text').match(/\D/)" οndragenter="return false"&gt; </p> 
<p> </p> 
<p>//特殊用途 <br><br> &lt;input type=button value=导入收藏夹 οnclick="window.external.ImportExportFavorites(true,'http://localhost');"&gt; <br> &lt;input type=button value=导出收藏夹 οnclick="window.external.ImportExportFavorites(false,'http://localhost');"&gt; <br> &lt;input type=button value=整理收藏夹 οnclick="window.external.ShowBrowserUI('OrganizeFavorites', null)"&gt; <br> &lt;input type=button value=语言设置 οnclick="window.external.ShowBrowserUI('LanguageDialog', null)"&gt; <br> &lt;input type=button value=加入收藏夹 οnclick="window.external.AddFavorite('<a href="https://www.douban.com/link2/?url=http%3A%2F%2Fwww.google.com%2F" rel="nofollow">http://www.google.com/</a>,' 'google')"&gt; <br> &lt;input type=button value=加入到频道 οnclick="window.external.addChannel('<a href="https://www.douban.com/link2/?url=http%3A%2F%2Fwww.google.com%2F" rel="nofollow">http://www.google.com/</a>')"&gt; <br> &lt;input type=button value=加入到频道 οnclick="window.external.showBrowserUI('PrivacySettings',null)"&gt; <br><br><br> //不缓存 <br><br> &lt;META HTTP-EQUIV="pragma" CONTENT="no-cache"&gt; <br> &lt;META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate"&gt; <br> &lt;META HTTP-EQUIV="expires" CONTENT="0"&gt; <br><br><br> //正则匹配 <br><br> 匹配中文字符的正则表达式： [\u4e00-\u9fa5] <br> 匹配双字节字符(包括汉字在内)：[^\x00-\xff] <br> 匹配空行的正则表达式：\n[\s| ]*\r <br> 匹配HTML标记的正则表达式：/&lt;(.*)&gt;.*&lt;\/\1&gt;|&lt;(.*) \/&gt;/ <br> 匹配首尾空格的正则表达式：(^\s*)|(\s*$)（像vbscript那样的trim函数） <br> 匹配Email地址的正则表达式：\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)* <br> 匹配网址URL的正则表达式：http://([\w-]+\.)+[\w-]+(/[\w- ./?%&amp;=]*)? <br> 以下是例子： <br> 利用正则表达式限制网页表单里的文本框输入内容： <br> 用正则表达式限制只能输入中文：οnkeyup="value=value.replace(/[^\u4E00-\u9FA5]/g,'')" onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\u4E00-\u9FA5]/g,''))" <br> 1.用正则表达式限制只能输入全角字符： οnkeyup="value=value.replace(/[^\uFF00-\uFFFF]/g,'')" onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\uFF00-\uFFFF]/g,''))" <br> 2.用正则表达式限制只能输入数字：οnkeyup="value=value.replace(/[^\d]/g,'') "onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))" <br> 3.用正则表达式限制只能输入数字和英文：οnkeyup="value=value.replace(/[\W]/g,'') "onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))" <br><br><br> //消除图像工具栏 <br><br> &lt;IMG SRC="mypicture.jpg" HEIGHT="100px" WIDTH="100px" GALLERYIMG="false"&gt; <br> or <br> &lt;head&gt; <br> &lt;meta http-equiv="imagetoolbar" content="no"&gt; <br> &lt;/head&gt; <br><br><br> //无提示关闭 <br><br> function Close() <br> { <br> var ua=navigator.userAgent <br> var ie=navigator.appName=="Microsoft Internet Explorer"?true:false <br> if(ie) <br> { <br> var IEversion=parseFloat(ua.substring(ua.indexOf("MSIE ")+5,ua.indexOf(";",ua.indexOf("MSIE ")))) <br> if(IEversion&lt; 5.5) <br> { <br> var str = '&lt;object id=noTipClose classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"&gt;' <br> str += '&lt;param name="Command" value="Close"&gt;&lt;/object&gt;'; <br> document.body.insertAdjacentHTML("beforeEnd", str); <br> document.all.noTipClose.Click(); <br> } <br> else <br> { <br> window.opener =null; <br> window.close(); <br> } <br> } <br> else <br> { <br> window.close() <br> } <br> } <br><br> //取得控件得绝对位置(1) <br><br> &lt;script language="javascript"&gt; <br> function getoffset(e) <br> { <br> var t=e.offsetTop; <br> var l=e.offsetLeft; <br> while(e=e.offsetParent) <br> { <br> t+=e.offsetTop; <br> l+=e.offsetLeft; <br> } <br> var rec = new Array(1); <br> rec[0] = t; <br> rec[1] = l; <br> return rec <br> } <br> &lt;/script&gt; <br><br> //获得控件的绝对位置(2) <br><br> oRect = obj.getBoundingClientRect(); <br> oRect.left <br> oRect. <br><br><br> //最小化,最大化,关闭 <br><br> &lt;object id=min classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"&gt; <br> &lt;param name="Command" value="Minimize"&gt;&lt;/object&gt; <br> &lt;object id=max classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"&gt; <br> &lt;param name="Command" value="Maximize"&gt;&lt;/object&gt; <br> &lt;OBJECT id=close classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"&gt; <br> &lt;PARAM NAME="Command" value="Close"&gt;&lt;/OBJECT&gt; <br> &lt;input type=button value=最小化 οnclick=min.Click()&gt; <br> &lt;input type=button value=最大化 οnclick=max.Click()&gt; <br> &lt;input type=button value=关闭 οnclick=close.Click()&gt; <br><br><br> //光标停在文字最后 <br><br><br> &lt;script language="javascript"&gt; <br> function cc() <br> { <br> var e = event.srcElement; <br> var r =e.createTextRange(); <br> r.moveStart('character',e.value.length); <br> r.collapse(true); <br> r.select(); <br> } <br> &lt;/script&gt; <br> &lt;input type=text name=text1 value="123" οnfοcus="cc()"&gt; <br><br> //页面进入和退出的特效 <br><br> 进入页面&lt;meta http-equiv="Page-Enter" content="revealTrans(duration=x, transition=y)"&gt; <br> 推出页面&lt;meta http-equiv="Page-Exit" content="revealTrans(duration=x, transition=y)"&gt; <br> 这个是页面被载入和调出时的一些特效。duration表示特效的持续时间，以秒为单位。transition表示使 <br> 用哪种特效，取值为1-23: <br> 　　0 矩形缩小 <br> 　　1 矩形扩大 <br> 　　2 圆形缩小 <br> 　　3 圆形扩大 <br> 　　4 下到上刷新 <br> 　　5 上到下刷新 <br> 　　6 左到右刷新 <br> 　　7 右到左刷新 <br> 　　8 竖百叶窗 <br> 　　9 横百叶窗 <br> 　　10 错位横百叶窗 <br> 　　11 错位竖百叶窗 <br> 　　12 点扩散 <br> 　　13 左右到中间刷新 <br> 　　14 中间到左右刷新 <br> 　　15 中间到上下 <br> 　　16 上下到中间 <br> 　　17 右下到左上 <br> 　　18 右上到左下 <br> 　　19 左上到右下 <br> 　　20 左下到右上 <br> 　　21 横条 <br> 　　22 竖条 <br> 　　23 <br><br><br> //网页是否被检索 &lt;meta name="ROBOTS" content="属性值"&gt; <br> 　　其中属性值有以下一些: <br> 　　属性值为"all": 文件将被检索，且页上链接可被查询； <br> 　　属性值为"none": 文件不被检索，而且不查询页上的链接； <br> 　　属性值为"index": 文件将被检索； <br> 　　属性值为"follow": 查询页上的链接； <br> 　　属性值为"noindex": 文件不检索，但可被查询链接； <br> 　　属性值为"nofollow": <br><br><br> //打印分页 &lt;p style="page-break-after:always"&gt;page1&lt;/p&gt; <br> &lt;p style="page-break-after:always"&gt;page2&lt;/p&gt; <br><br> //设置打印 <br><br> &lt;object id="factory" style="display:none" viewastext <br> classid="clsid:1663ed61-23eb-11d2-b92f-008048fdd814" <br> codebase="<a href="http://www.meadroid.com/scriptx/ScriptX.cab#Version=5,60,0,360" rel="nofollow">http://www.meadroid.com/scriptx/ScriptX.cab#Version=5,60,0,360</a>" <br> &gt;&lt;/object&gt; <br> &lt;input type=button value=页面设置 οnclick="factory.printing.PageSetup()"&gt; <br> &lt;input type=button value=打印预览 οnclick="factory.printing.Preview()"&gt; <br><br> &lt;script language=javascript&gt; <br> function window.onload() <br> { <br> // -- advanced features <br> factory.printing.SetMarginMeasure(2) // measure margins in inches <br> factory.printing.SetPageRange(false, 1, 3) // need pages from 1 to 3 <br> factory.printing.printer = "HP DeskJet 870C" <br> factory.printing.copies = 2 <br> factory.printing.collate = true <br> factory.printing.paperSize = "A4" <br> factory.printing.paperSource = "Manual feed" <br> // -- basic features <br> factory.printing.header = "居左显示&amp;b居中显示&amp;b居右显示页码，第&amp;p页/共&amp;P页" <br> factory.printing.footer = "（自定义页脚）" <br> factory.printing.portrait = false <br> factory.printing.leftMargin = 0.75 <br> factory.printing.topMargin = 1.5 <br> factory.printing.rightMargin = 0.75 <br> factory.printing.bottomMargin = 1.5 <br> } <br> function Print(frame) { <br> factory.printing.Print(true, frame) // print with prompt <br> } <br> &lt;/script&gt; <br> &lt;input type=button value="打印本页" οnclick="factory.printing.Print(false)"&gt; <br> &lt;input type=button value="页面设置" οnclick="factory.printing.PageSetup()"&gt; <br> &lt;input type=button value="打印预览" οnclick="factory.printing.Preview()"&gt;&lt;br&gt; <br> &lt;a href="<a href="http://www.meadroid.com/scriptx/docs/printdoc.htm?static" rel="nofollow">http://www.meadroid.com/scriptx/docs/printdoc.htm?static</a>" target=_blank&gt;具体使用手册，更多信息，点这里&lt;/a&gt; <br><br><br> //自带的打印预览 <br> WebBrowser.ExecWB(1,1) 打开 <br> Web.ExecWB(2,1) 关闭现在所有的IE窗口，并打开一个新窗口 <br> Web.ExecWB(4,1) 保存网页 <br> Web.ExecWB(6,1) 打印 <br> Web.ExecWB(7,1) 打印预览 <br> Web.ExecWB(8,1) 打印页面设置 <br> Web.ExecWB(10,1) 查看页面属性 <br> Web.ExecWB(15,1) 好像是撤销，有待确认 <br> Web.ExecWB(17,1) 全选 <br> Web.ExecWB(22,1) 刷新 <br> Web.ExecWB(45,1) 关闭窗体无提示 <br> &lt;style media=print&gt; <br> .Noprint{display:none;}&lt;!--用本样式在打印时隐藏非打印项目--&gt; <br> .PageNext{page-break-after: always;}&lt;!--控制分页--&gt; <br> &lt;/style&gt; <br> &lt;object id="WebBrowser" width=0 height=0 classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"&gt; <br> &lt;/object&gt; <br><br> &lt;center class="Noprint" &gt; <br> &lt;input type=button value=打印 οnclick=document.all.WebBrowser.ExecWB(6,1)&gt; <br> &lt;input type=button value=直接打印 οnclick=document.all.WebBrowser.ExecWB(6,6)&gt; <br> &lt;input type=button value=页面设置 οnclick=document.all.WebBrowser.ExecWB(8,1)&gt; <br> &lt;/p&gt; <br> &lt;p&gt; &lt;input type=button value=打印预览 οnclick=document.all.WebBrowser.ExecWB(7,1)&gt; <br> &lt;/center&gt; <br><br> //去掉打印时的页眉页脚 <br><br> &lt;script language="JavaScript"&gt; <br> var HKEY_Root,HKEY_Path,HKEY_Key; <br> HKEY_Root="HKEY_CURRENT_USER"; <br> HKEY_Path="\\Software\\Microsoft\\Internet Explorer\\PageSetup\\"; <br> //设置网页打印的页眉页脚为空 <br> function PageSetup_Null() <br> { <br> try <br> { <br> var Wsh=new ActiveXObject("WScript.Shell"); <br> HKEY_Key="header"; <br> Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,""); <br> HKEY_Key="footer"; <br> Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,""); <br> } <br> catch(e){} <br> } <br> //设置网页打印的页眉页脚为默认值 <br> function PageSetup_Default() <br> { <br> try <br> { <br> var Wsh=new ActiveXObject("WScript.Shell"); <br> HKEY_Key="header"; <br> Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,"&amp;w&amp;b页码,&amp;p/&amp;P"); <br> HKEY_Key="footer"; <br> Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,"&amp;u&amp;b&amp;d"); <br> } <br> catch(e){} <br> } <br> &lt;/script&gt; <br> &lt;input type="button" value="清空页码" οnclick=PageSetup_Null()&gt; <br> &lt;input type="button" value="恢复页码" οnclick=PageSetup_Default()&gt; <br><br><br> //浏览器验证 <br><br> function checkBrowser() <br> { <br> this.ver=navigator.appVersion <br> this.dom=document.getElementById?1:0 <br> this.ie6=(this.ver.indexOf("MSIE 6")&gt;-1 &amp;&amp; this.dom)?1:0; <br> this.ie5=(this.ver.indexOf("MSIE 5")&gt;-1 &amp;&amp; this.dom)?1:0; <br> this.ie4=(document.all &amp;&amp; !this.dom)?1:0; <br> this.ns5=(this.dom &amp;&amp; parseInt(this.ver) &gt;= 5) ?1:0; <br> this.ns4=(document.layers &amp;&amp; !this.dom)?1:0; <br> this.mac=(this.ver.indexOf('Mac') &gt; -1) ?1:0; <br> this.ope=(navigator.userAgent.indexOf('Opera')&gt;-1); <br> this.ie=(this.ie6 || this.ie5 || this.ie4) <br> this.ns=(this.ns4 || this.ns5) <br> this.bw=(this.ie6 || this.ie5 || this.ie4 || this.ns5 || this.ns4 || this.mac || this.ope) <br> this.nbw=(!this.bw) <br> return this; <br> } <br><br><br> //计算内容宽和高 <br><br> &lt;SCRIPT language="javascript"&gt; <br> function test(obj) <br> { <br> var range = obj.createTextRange(); <br> alert("内容区宽度: " + range.boundingWidth <br> + "px\r\n内容区高度: " + range.boundingHeight + "px"); <br> } <br> &lt;/SCRIPT&gt; <br> &lt;BODY&gt; <br> &lt;Textarea id="txt" height="150"&gt;sdf&lt;/textarea&gt;&lt;INPUT type="button" value="计算内容宽度" onClick="test(txt)"&gt; <br> &lt;/BODY&gt; <br><br> //无模式的提示框 function modelessAlert(Msg) <br> { <br> window.showModelessDialog("javascript:alert(\""+escape(Msg)+"\");window.close();","","status:no;resizable:no;help:no;dialogHeight:height:30px;dialogHeight:40px;"); <br> } <br><br> //屏蔽按键 <br> &lt;html&gt; <br> &lt;head&gt; <br> &lt;meta http-equiv="Content-Type" content="text/html; charset=gb2312"&gt; <br> &lt;noscript&gt;&lt;meta http-equiv="refresh" content="0;url=about:noscript"&gt;&lt;/noscript&gt; <br> &lt;title&gt;屏蔽鼠标右键、Ctrl+N、Shift+F10、Alt+F4、F11、F5刷新、退格键&lt;/title&gt; <br> &lt;/head&gt; <br> &lt;body&gt; <br> &lt;script language="Javascript"&gt;&lt;!-- <br> //屏蔽鼠标右键、Ctrl+N、Shift+F10、F11、F5刷新、退格键 <br> //Author: meizz(梅花雨) 2002-6-18 <br> function document.oncontextmenu(){event.returnValue=false;}//屏蔽鼠标右键 <br> function window.onhelp(){return false} //屏蔽F1帮助 <br> function document.onkeydown() <br> { <br> if ((window.event.altKey)&amp;&amp; <br> ((window.event.keyCode==37)|| //屏蔽 Alt+ 方向键 ← <br> (window.event.keyCode==39))) //屏蔽 Alt+ 方向键 → <br> { <br> alert("不准你使用ALT+方向键前进或后退网页！"); <br> event.returnValue=false; <br> } <br> /* 注：这还不是真正地屏蔽 Alt+ 方向键， <br> 因为 Alt+ 方向键弹出警告框时，按住 Alt 键不放， <br> 用鼠标点掉警告框，这种屏蔽方法就失效了。以后若 <br> 有哪位高手有真正屏蔽 Alt 键的方法，请告知。*/ <br> if ((event.keyCode==8) || //屏蔽退格删除键 <br> (event.keyCode==116)|| //屏蔽 F5 刷新键 <br> (event.ctrlKey &amp;&amp; event.keyCode==82)){ //Ctrl + R <br> event.keyCode=0; <br> event.returnValue=false; <br> } <br> if (event.keyCode==122){event.keyCode=0;event.returnValue=false;} //屏蔽F11 <br> if (event.ctrlKey &amp;&amp; event.keyCode==78) event.returnValue=false; //屏蔽 Ctrl+n <br> if (event.shiftKey &amp;&amp; event.keyCode==121)event.returnValue=false; //屏蔽 shift+F10 <br> if (window.event.srcElement.tagName == "A" &amp;&amp; window.event.shiftKey) <br> window.event.returnValue = false; //屏蔽 shift 加鼠标左键新开一网页 <br> if ((window.event.altKey)&amp;&amp;(window.event.keyCode==115)) //屏蔽Alt+F4 <br> { <br> window.showModelessDialog("about:blank","","dialogWidth:1px;dialogheight:1px"); <br> return false; <br> } <br> } <br> &lt;/script&gt; <br> 屏蔽鼠标右键、Ctrl+N、Shift+F10、Alt+F4、F11、F5刷新、退格键 <br> &lt;/body&gt; <br> &lt;/html&gt; <br><br><br> //屏蔽打印 <br> &lt;style&gt; <br> @media print{ <br> * {display:none} <br> } <br> &lt;/style&gt; <br><br><br> //移动的图层，拖动 <br><br> 1.&lt;span style='position:absolute;width:200;height:200;background:red' οnmοusedοwn=MouseDown(this) οnmοusemοve=MouseMove() οnmοuseup=MouseUp()&gt;meizz&lt;/span&gt; <br> &lt;script language=javascript&gt; <br> var Obj; <br> function MouseDown(obj) <br> { <br> Obj=obj; <br> Obj.setCapture(); <br> Obj.l=event.x-Obj.style.pixelLeft; <br> Obj.t=event.y-Obj.style.pixelTop; <br> } <br> function MouseMove() <br> { <br> if(Obj!=null) <br> { <br> Obj.style.left = event.x-Obj.l; <br> Obj.style.top = event.y-Obj.t; <br> } <br> } <br> function MouseUp() <br> { <br> if(Obj!=null) <br> { <br> Obj.releaseCapture(); <br> Obj=null; <br> } <br> } <br> &lt;/script&gt; <br> 2. <br> &lt;div id="myDiv" src="logo.gif" οndrag="doDrag();" οnmοuseοver="this.style.cursor='hand'" style="position:absolute;left=100;top=100;" οnmοusedοwn="doMouseDown();"&gt; <br> &lt;a href="#" οnclick="return false"&gt;&lt;h1&gt;wlecome&lt;/h1&gt;&lt;/a&gt; <br> &lt;/div&gt; <br> &lt;script language="JavaScript" type="text/javascript"&gt; <br> var orgMouseX; <br> var orgMouseY; <br> var orgObjX; <br> var orgObjY; <br> function doDrag() <br> { <br> var myObject=document.all.myDiv; <br><br> var x=event.clientX; <br> var y=event.clientY; <br> myObject.style.left=x-(orgMouseX-orgObjX); <br> myObject.style.top=y-(orgMouseY-orgObjY); <br><br> } <br> function doMouseDown() <br> { <br> orgMouseX=event.clientX; <br> orgMouseY=event.clientY; <br> orgObjX=parseInt(document.all.myDiv.style.left); <br> orgObjY=parseInt(document.all.myDiv.style.top); <br> } <br><br> &lt;/script&gt; <br><br> //文档状态改变 <br><br> &lt;iframe src="a.html" id="f" name="f" scrolling="no" frameborder=0 marginwidth=0 marginheight=0&gt;&lt;/iframe&gt; <br> &lt;script&gt; <br> var doc=window.frames["f"].document; <br> function s(){ <br> if (doc.readyState=="complete"){ <br> document.all.f.style.height=doc.body.scrollHeight <br> document.all.f.style.width=doc.body.scrollWidth <br> } <br> } <br> doc.onreadystatechange=s <br> &lt;/script&gt; <br><br><br> //刷新后不变的文本框 &lt;HTML&gt; <br> &lt;HEAD&gt; <br> &lt;META NAME="save" CONTENT="history"&gt; <br> &lt;STYLE&gt; <br> .sHistory {behavior:url(#default#savehistory);} <br> &lt;/STYLE&gt; <br> &lt;/HEAD&gt; <br> &lt;BODY&gt; <br> &lt;INPUT class=sHistory type=text id=oPersistInput&gt; <br> &lt;/BODY&gt; <br> &lt;/HTML&gt; <br><br> //访问剪贴板 <br><br> event.dataTransfer.setData("URL", oImage.src); <br> sImageURL = event.dataTransfer.getData("URL") <br> (2)普通访问 <br> window.clipboardData.setData("Text",oSource.innerText); <br> window.clipboardData.getData("Text"); <br><br><br> //操作COOKIE <br><br> function SetCookie(sName, sValue) <br> { <br> document.cookie = sName + "=" + escape(sValue) + "; "; <br> } <br> function GetCookie(sName) <br> { <br> var aCookie = document.cookie.split("; "); <br> for (var i=0; i &lt; aCookie.length; i++) <br> { <br><br> var aCrumb = aCookie.split("="); <br> if (sName == aCrumb[0]) <br> return unescape(aCrumb[1]); <br> } <br><br> } <br> function DelCookie(sName) <br> { <br> document.cookie = sName + "=" + escape(sValue) + "; expires=Fri, 31 Dec 1999 23:59:59 GMT;"; <br> } <br><br><br> //setTimeout增加参数 <br><br> &lt;script&gt; <br> var _st = window.setTimeout; <br> window.setTimeout = function(fRef, mDelay) { <br> if(typeof fRef == 'function'){ <br> var argu = Array.prototype.slice.call(arguments,2); <br> var f = (function(){ fRef.apply(null, argu); }); <br> return _st(f, mDelay); <br> } <br> return _st(fRef,mDelay); <br> } <br> function test(x){ <br> alert(x); <br> } <br> window.setTimeout(test,1000,'fason'); <br> &lt;/script&gt; </p> 
<p> </p> 
<p>转载出处：<a href="http://blog.csdn.net/panxuan/archive/2007/11/26/1902826.aspx">http://blog.csdn.net/panxuan/archive/2007/11/26/1902826.aspx</a></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/815611b95fe56dcf57c0d17d71cfd329/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">金融级分布式架构，分布式系统数据层设计模式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f4f3f996ebe3625147212026279b3bdd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">org.apache.tomcat.util.http.parser.Cookie.logInvalidHeader A cookie header was received</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>