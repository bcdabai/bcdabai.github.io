<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Oracle分析函数之ROW_NUMBER()详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Oracle分析函数之ROW_NUMBER()详解" />
<meta property="og:description" content="语法：ROW_NUMBER() OVER(PARTITION BY COLUMN ORDER BY COLUMN)
简单的说row_number()从1开始，为每一条分组记录返回一个数字，这里的ROW_NUMBER() OVER (ORDER BY xlh DESC) 是先把xlh列降序，再为降序以后的没条xlh记录返回一个序号。 示例： xlh row_num 1700 1 1500 2 1085 3 710 4
row_number() OVER (PARTITION BY COL1 ORDER BY COL2) 表示根据COL1分组，在分组内部根据 COL2排序，而此函数计算的值就表示每组内部排序后的顺序编号（组内连续的唯一的)
实例：
初始化数据
create table employee (empid int ,deptid int ,salary decimal(10,2))
insert into employee values(1,10,5500.00)
insert into employee values(2,10,4500.00)
insert into employee values(3,20,1900.00)
insert into employee values(4,20,4800.00)
insert into employee values(5,40,6500.00)
insert into employee values(6,40,14500." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bb08cf8aae5414b5d784db4c2462fa64/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-01-04T14:46:36+08:00" />
<meta property="article:modified_time" content="2015-01-04T14:46:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Oracle分析函数之ROW_NUMBER()详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 语法：ROW_NUMBER() OVER(PARTITION BY COLUMN ORDER BY COLUMN)</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 简单的说row_number()从1开始，为每一条分组记录返回一个数字，这里的ROW_NUMBER() OVER (ORDER BY xlh DESC) 是先把xlh列降序，再为降序以后的没条xlh记录返回一个序号。 <br> 示例： <br> xlh           row_num <br> 1700              1 <br> 1500              2 <br> 1085              3 <br> 710                4</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> <strong>row_number() OVER (PARTITION BY COL1 ORDER BY COL2)</strong> 表示根据COL1分组，在分组内部根据 COL2排序，而此函数计算的值就表示每组内部排序后的顺序编号（组内连续的唯一的)</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 实例：</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 初始化数据</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> create table employee (empid int ,deptid int ,salary decimal(10,2))<br> insert into employee values(1,10,5500.00)<br> insert into employee values(2,10,4500.00)<br> insert into employee values(3,20,1900.00)<br> insert into employee values(4,20,4800.00)<br> insert into employee values(5,40,6500.00)<br> insert into employee values(6,40,14500.00)<br> insert into employee values(7,40,44500.00)<br> insert into employee values(8,50,6500.00)<br> insert into employee values(9,50,7500.00)</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 数据显示为</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> empid       deptid      salary<br> ----------- ----------- ---------------------------------------<br> 1           10          5500.00<br> 2           10          4500.00<br> 3           20          1900.00<br> 4           20          4800.00<br> 5           40          6500.00<br> 6           40          14500.00<br> 7           40          44500.00<br> 8           50          6500.00<br> 9           50          7500.00</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 需求：根据部门分组，显示每个部门的工资等级</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> 预期结果：</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> empid       deptid      salary                                  rank<br> ----------- ----------- --------------------------------------- --------------------<br> 1           10          5500.00                                 1<br> 2           10          4500.00                                 2<br> 4           20          4800.00                                 1<br> 3           20          1900.00                                 2<br> 7           40          44500.00                                1<br> 6           40          14500.00                                2<br> 5           40          6500.00                                 3<br> 9           50          7500.00                                 1<br> 8           50          6500.00                                 2</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> SQL脚本：</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> SELECT *, Row_Number() OVER (partition by deptid ORDER BY salary desc) rank FROM employee;</p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> <span style="color:#ff0000">注意:</span><span style="color:#006600">row_number()是非确定性的（如返回值为12,13,14,15.但结果又可能是12,14,13,15），而rank()和dense_rank()是确定性函数</span><span style="color:#009900">。</span></p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> <br> </p> 
<p style="margin:10px auto; font-family:Verdana,'Lucida Grande',Arial,Helvetica,sans-serif; line-height:18px"> <br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/136654cd97e714321577d0e9baa18ee6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle分析函数之first_value和last_value 分析函数详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fc75ade0bc6a0d4d4e5a77f13551c072/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Oracle分析函数之ratio_to_report()详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>