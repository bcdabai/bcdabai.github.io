<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sklearn神经网络参数 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sklearn神经网络参数" />
<meta property="og:description" content="下面写了一个超级简单的实例，训练和测试数据是mnist手写识别数据集：
from sklearn.neural_network import MLPClassifier import gzip import pickle with gzip.open(&#39;./mnist.pkl.gz&#39;) as f_gz: train_data,valid_data,test_data = pickle.load(f_gz) clf = MLPClassifier(solver=&#39;sgd&#39;,activation = &#39;identity&#39;,max_iter = 10,alpha = 1e-5,hidden_layer_sizes = (100,50),random_state = 1,verbose = True) clf.fit(train_data[0][:10000],train_data[1][:10000]) print clf.predict(test_data[0][:10]) print(clf.score(test_data[0][:100],test_data[1][:100])) print(clf.predict_proba(test_data[0][:10])) 参数说明：
参数说明:
hidden_layer_sizes :例如hidden_layer_sizes=(50, 50)，表示有两层隐藏层，第一层隐藏层有50个神经元，第二层也有50个神经元。
activation :激活函数,{‘identity’, ‘logistic’, ‘tanh’, ‘relu’}, 默认relu
identity：f(x) = x
logistic：其实就是sigmod,f(x) = 1 / (1 &#43; exp(-x)).
tanh：f(x) = tanh(x).
relu：f(x) = max(0, x)
solver： {‘lbfgs’, ‘sgd’, ‘adam’}, 默认adam，用来优化权重 lbfgs：quasi-Newton方法的优化器" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f5a608dc70bdffa30854af88c33b35ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-05T21:57:27+08:00" />
<meta property="article:modified_time" content="2021-03-05T21:57:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sklearn神经网络参数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>下面写了一个超级简单的实例，训练和测试数据是mnist手写识别数据集：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier

<span class="token keyword">import</span> gzip

<span class="token keyword">import</span> pickle

<span class="token keyword">with</span> gzip<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./mnist.pkl.gz'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_gz<span class="token punctuation">:</span>

    train_data<span class="token punctuation">,</span>valid_data<span class="token punctuation">,</span>test_data <span class="token operator">=</span> pickle<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f_gz<span class="token punctuation">)</span>

clf <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'sgd'</span><span class="token punctuation">,</span>activation <span class="token operator">=</span> <span class="token string">'identity'</span><span class="token punctuation">,</span>max_iter <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>alpha <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span>hidden_layer_sizes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>verbose <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>train_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>test_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>参数说明：</p> 
<p>参数说明:</p> 
<ol><li> <p>hidden_layer_sizes :例如hidden_layer_sizes=(50, 50)，表示有两层隐藏层，第一层隐藏层有50个神经元，第二层也有50个神经元。</p> </li><li> <p>activation :激活函数,{‘identity’, ‘logistic’, ‘tanh’, ‘relu’}, 默认relu</p> </li></ol> 
<ul><li> <p>identity：f(x) = x</p> </li><li> <p>logistic：其实就是sigmod,f(x) = 1 / (1 + exp(-x)).</p> </li><li> <p>tanh：f(x) = tanh(x).</p> </li><li> <p>relu：f(x) = max(0, x)</p> </li></ul> 
<ol start="3"><li>solver： {‘lbfgs’, ‘sgd’, ‘adam’}, 默认adam，用来优化权重</li></ol> 
<ul><li> <p>lbfgs：quasi-Newton方法的优化器</p> </li><li> <p>sgd：随机梯度下降</p> </li><li> <p>adam： Kingma, Diederik, and Jimmy Ba提出的机遇随机梯度的优化器</p> </li></ul> 
<p>注意：默认solver ‘adam’在相对较大的数据集上效果比较好（几千个样本或者更多），对小数据集来说，lbfgs收敛更快效果也更好。</p> 
<ol start="4"><li> <p>alpha :float,可选的，默认0.0001,正则化项参数</p> </li><li> <p>batch_size : int , 可选的，默认’auto’,随机优化的minibatches的大小batch_size=min(200,n_samples)，如果solver是’lbfgs’，分类器将不使用minibatch</p> </li><li> <p>learning_rate :学习率,用于权重更新,只有当solver为’sgd’时使用，{‘constant’，’invscaling’, ‘adaptive’},默认constant</p> </li></ol> 
<ul><li> <p>‘constant’: 有’learning_rate_init’给定的恒定学习率</p> </li><li> <p>‘incscaling’：随着时间t使用’power_t’的逆标度指数不断降低学习率learning_rate_ ，effective_learning_rate = learning_rate_init / pow(t, power_t)</p> </li><li> <p>‘adaptive’：只要训练损耗在下降，就保持学习率为’learning_rate_init’不变，当连续两次不能降低训练损耗或验证分数停止升高至少tol时，将当前学习率除以5.</p> </li></ul> 
<ol start="7"><li> <p>power_t: double, 可选, default 0.5，只有solver=’sgd’时使用，是逆扩展学习率的指数.当learning_rate=’invscaling’，用来更新有效学习率。</p> </li><li> <p>max_iter: int，可选，默认200，最大迭代次数。</p> </li><li> <p>random_state:int 或RandomState，可选，默认None，随机数生成器的状态或种子。</p> </li><li> <p>shuffle: bool，可选，默认True,只有当solver=’sgd’或者‘adam’时使用，判断是否在每次迭代时对样本进行清洗。</p> </li><li> <p>tol：float, 可选，默认1e-4，优化的容忍度</p> </li><li> <p>learning_rate_int:double,可选，默认0.001，初始学习率，控制更新权重的补偿，只有当solver=’sgd’ 或’adam’时使用。</p> </li><li> <p>verbose : bool, 可选, 默认False,是否将过程打印到stdout</p> </li><li> <p>warm_start : bool, 可选, 默认False,当设置成True，使用之前的解决方法作为初始拟合，否则释放之前的解决方法。</p> </li><li> <p>momentum : float, 默认 0.9,动量梯度下降更新，设置的范围应该0.0-1.0. 只有solver=’sgd’时使用.</p> </li><li> <p>nesterovs_momentum : boolean, 默认True, Whether to use Nesterov’s momentum. 只有solver=’sgd’并且momentum &gt; 0使用.</p> </li><li> <p>early_stopping : bool, 默认False,只有solver=’sgd’或者’adam’时有效,判断当验证效果不再改善的时候是否终止训练，当为True时，自动选出10%的训练数据用于验证并在两步连续迭代改善，低于tol时终止训练。</p> </li><li> <p>validation_fraction : float, 可选, 默认 0.1,用作早期停止验证的预留训练数据集的比例，早0-1之间，只当early_stopping=True有用</p> </li><li> <p>beta_1 : float, 可选, 默认0.9，只有solver=’adam’时使用，估计一阶矩向量的指数衰减速率，[0,1)之间</p> </li><li> <p>beta_2 : float, 可选, 默认0.999,只有solver=’adam’时使用估计二阶矩向量的指数衰减速率[0,1)之间</p> </li><li> <p>epsilon : float, 可选, 默认1e-8,只有solver=’adam’时使用数值稳定值。</p> </li></ol> 
<p>属性说明：</p> 
<ul><li> <p>classes_:每个输出的类标签</p> </li><li> <p>loss_:损失函数计算出来的当前损失值</p> </li><li> <p>coefs_:列表中的第i个元素表示i层的权重矩阵</p> </li><li> <p>intercepts_:列表中第i个元素代表i+1层的偏差向量</p> </li><li> <p>n_iter_ ：迭代次数</p> </li><li> <p>n_layers_:层数</p> </li><li> <p>n_outputs_:输出的个数</p> </li><li> <p>out_activation_:输出激活函数的名称。</p> </li></ul> 
<p>方法说明：</p> 
<ul><li> <p>fit(X,y):拟合</p> </li><li> <p>get_params([deep]):获取参数</p> </li><li> <p>predict(X):使用MLP进行预测</p> </li><li> <p>predic_log_proba(X):返回对数概率估计</p> </li><li> <p>predic_proba(X)：概率估计</p> </li><li> <p>score(X,y[,sample_weight]):返回给定测试数据和标签上的平均准确度</p> </li></ul> 
<p>-set_params(**params):设置参数。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/60449760502fc33320b583beffefb5be/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决ajax跨域问题【5种解决方案】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9d072829a7b0827757e010beb49118af/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[漏洞复现]CVE-2019-0708</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>