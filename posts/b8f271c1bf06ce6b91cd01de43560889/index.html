<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ElasticSearcho从入门到放弃:(一)简介, lucene,概念, 安装 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ElasticSearcho从入门到放弃:(一)简介, lucene,概念, 安装" />
<meta property="og:description" content="文章目录 一、ElasticSeach简介1. 介绍2. ES可以做什么2.1 信息检索2.2 企业内部系统搜索2.3 数据分析引擎 3. ES特点3.1 海量数据处理3.2 开箱即用3.3 作用传统数据库的补充 4. ES对比solr: 二、Lucene全文检索库1. 什么是全文检索1.1 结构化数据与非结构化数据1.2 搜索结构化数据和非结构化数据1.3 全文检索: 2. Lucene简介 三、ES的核心概念：1. 索引 index:2. 映射 mapping3. 字段 Field4. 类型type5. 文档 document6. 集群 cluster7. 节点 node8. 分片和副本: shards &amp; replicas8.1 分片8.2 副本 四. 安装ES:1. 安装es:1.1 创建普通用户:1.2 为普通用户添加sudo权限1.3 准备安装包1.4 修改配置文件1.4.1 修改elasticsearch.yml1.4.2 修改jvm.option 1.5 配置其他节点1.6 修改系统配置, 解决启动问题1.6.1 打开文件的最大数限制;1.6.2 启动线程数限制1.6.3 调大虚拟内存 1.7 启动es 2. 使用Docker3. Elasticsearch-head插件4. 安装IK分词器5. 准备Vscode开发环境 一、ElasticSeach简介 官方网站: https://www.elastic.co/cn/elasticsearch/
1. 介绍 Elasticsearch是一个基于Lucence的搜索服务器;提供了一个分布式多用户能力的全文搜索引擎, 基于RESTful web接口;Elasticsearch是用java语言发开的, 并作为Apache许可条款下的开放源码发布, 是一种流行的企业级搜索引擎;ES用于云计算中, 能够达到实时搜索, 稳定, 可靠,快速,安装使用方便;官方客户端维护多种编程语言可用;根据DB-Engines排名显示, ES是最受欢迎的企业所搜索引擎; 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b8f271c1bf06ce6b91cd01de43560889/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-05T17:38:34+08:00" />
<meta property="article:modified_time" content="2022-04-05T17:38:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ElasticSearcho从入门到放弃:(一)简介, lucene,概念, 安装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#ElasticSeach_2" rel="nofollow">一、ElasticSeach简介</a></li><li><ul><li><a href="#1__5" rel="nofollow">1. 介绍</a></li><li><a href="#2_ES_12" rel="nofollow">2. ES可以做什么</a></li><li><ul><li><a href="#21__13" rel="nofollow">2.1 信息检索</a></li><li><a href="#22__15" rel="nofollow">2.2 企业内部系统搜索</a></li><li><a href="#23__19" rel="nofollow">2.3 数据分析引擎</a></li></ul> 
   </li><li><a href="#3_ES_23" rel="nofollow">3. ES特点</a></li><li><ul><li><a href="#31__24" rel="nofollow">3.1 海量数据处理</a></li><li><a href="#32__29" rel="nofollow">3.2 开箱即用</a></li><li><a href="#33__33" rel="nofollow">3.3 作用传统数据库的补充</a></li></ul> 
   </li><li><a href="#4_ESsolr_39" rel="nofollow">4. ES对比solr:</a></li></ul> 
  </li><li><a href="#Lucene_46" rel="nofollow">二、Lucene全文检索库</a></li><li><ul><li><a href="#1__47" rel="nofollow">1. 什么是全文检索</a></li><li><ul><li><a href="#11__48" rel="nofollow">1.1 结构化数据与非结构化数据</a></li><li><a href="#12__52" rel="nofollow">1.2 搜索结构化数据和非结构化数据</a></li><li><a href="#13__56" rel="nofollow">1.3 全文检索:</a></li></ul> 
   </li><li><a href="#2_Lucene_62" rel="nofollow">2. Lucene简介</a></li></ul> 
  </li><li><a href="#ES_69" rel="nofollow">三、ES的核心概念：</a></li><li><ul><li><a href="#1__index_71" rel="nofollow">1. 索引 index:</a></li><li><a href="#2__mapping_76" rel="nofollow">2. 映射 mapping</a></li><li><a href="#3__Field_81" rel="nofollow">3. 字段 Field</a></li><li><a href="#4_type_84" rel="nofollow">4. 类型type</a></li><li><a href="#5__document_87" rel="nofollow">5. 文档 document</a></li><li><a href="#6__cluster_91" rel="nofollow">6. 集群 cluster</a></li><li><a href="#7__node_96" rel="nofollow">7. 节点 node</a></li><li><a href="#8__shards__replicas_103" rel="nofollow">8. 分片和副本: shards &amp; replicas</a></li><li><ul><li><a href="#81__104" rel="nofollow">8.1 分片</a></li><li><a href="#82__114" rel="nofollow">8.2 副本</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_ES_118" rel="nofollow">四. 安装ES:</a></li><li><ul><li><a href="#1_es_119" rel="nofollow">1. 安装es:</a></li><li><ul><li><a href="#11__121" rel="nofollow">1.1 创建普通用户:</a></li><li><a href="#12_sudo_130" rel="nofollow">1.2 为普通用户添加sudo权限</a></li><li><a href="#13__136" rel="nofollow">1.3 准备安装包</a></li><li><a href="#14__150" rel="nofollow">1.4 修改配置文件</a></li><li><ul><li><a href="#141_elasticsearchyml_151" rel="nofollow">1.4.1 修改elasticsearch.yml</a></li><li><a href="#142_jvmoption_186" rel="nofollow">1.4.2 修改jvm.option</a></li></ul> 
    </li><li><a href="#15__194" rel="nofollow">1.5 配置其他节点</a></li><li><a href="#16___196" rel="nofollow">1.6 修改系统配置, 解决启动问题</a></li><li><ul><li><a href="#161__198" rel="nofollow">1.6.1 打开文件的最大数限制;</a></li><li><a href="#162__219" rel="nofollow">1.6.2 启动线程数限制</a></li><li><a href="#163__229" rel="nofollow">1.6.3 调大虚拟内存</a></li></ul> 
    </li><li><a href="#17_es_243" rel="nofollow">1.7 启动es</a></li></ul> 
   </li><li><a href="#2_Docker_253" rel="nofollow">2. 使用Docker</a></li><li><a href="#3__Elasticsearchhead_258" rel="nofollow">3. Elasticsearch-head插件</a></li><li><a href="#4_IK_264" rel="nofollow">4. 安装IK分词器</a></li><li><a href="#5_Vscode_285" rel="nofollow">5. 准备Vscode开发环境</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="ElasticSeach_2"></a>一、ElasticSeach简介</h2> 
<p>官方网站: <a href="https://www.elastic.co/cn/elasticsearch/" rel="nofollow">https://www.elastic.co/cn/elasticsearch/</a></p> 
<h3><a id="1__5"></a>1. 介绍</h3> 
<ul><li>Elasticsearch是一个基于Lucence的搜索服务器;</li><li>提供了一个分布式多用户能力的全文搜索引擎, 基于RESTful web接口;</li><li>Elasticsearch是用java语言发开的, 并作为Apache许可条款下的开放源码发布, 是一种流行的企业级搜索引擎;</li><li>ES用于云计算中, 能够达到实时搜索, 稳定, 可靠,快速,安装使用方便;官方客户端维护多种编程语言可用;</li><li>根据DB-Engines排名显示, ES是最受欢迎的企业所搜索引擎;</li></ul> 
<h3><a id="2_ES_12"></a>2. ES可以做什么</h3> 
<h4><a id="21__13"></a>2.1 信息检索</h4> 
<h4><a id="22__15"></a>2.2 企业内部系统搜索</h4> 
<ul><li>关系型数据库使用like进行模糊检索, 会导致索引失效, 效率低下;</li><li>可以基于ES来进行检索, 效率非常高;</li></ul> 
<h4><a id="23__19"></a>2.3 数据分析引擎</h4> 
<p>ES聚合可以对数十一行日志数据进行聚合分析, 套索数据的趋势和规律;</p> 
<h3><a id="3_ES_23"></a>3. ES特点</h3> 
<h4><a id="31__24"></a>3.1 海量数据处理</h4> 
<ul><li>大型分布式集群(数百台规模服务器)</li><li>处理PB级数据</li><li>小公司也可以进行单机部署;</li></ul> 
<h4><a id="32__29"></a>3.2 开箱即用</h4> 
<ul><li>简单易用, 操作简单</li><li>快速部署生产环境</li></ul> 
<h4><a id="33__33"></a>3.3 作用传统数据库的补充</h4> 
<ul><li>传统关系型数据库不擅长全文检索(mysql自带的全文索引, 与ES性能差距非常大)</li><li>传统关系型数据无法支持搜索排名, 海量数据存储, 分析 等功能;</li><li>ES可以作为传统关系型数据库的补充, 提供RDBM无法提供的功能;</li></ul> 
<h3><a id="4_ESsolr_39"></a>4. ES对比solr:</h3> 
<ul><li>solr利用Zookeeper进行分布式管理, 而ES自带有分布式协调管理功能;</li><li>Solr支持更多格式的数据, 而ES仅支持json文件格式;</li><li>Solr官方提供的功能更多, 而ES本身更注重于核心功能, 高级功能多有第三方插件提供;</li><li>Solr在传统的搜索应用中表现好于ES, 但在处理实时搜索应用是时, ES的效率更高;</li></ul> 
<h2><a id="Lucene_46"></a>二、Lucene全文检索库</h2> 
<h3><a id="1__47"></a>1. 什么是全文检索</h3> 
<h4><a id="11__48"></a>1.1 结构化数据与非结构化数据</h4> 
<ul><li>结构化数据: 指具有固定格式或优先长度的数据, 如: 数据库, 元数据等;</li><li>非结构化数据: 指不定长或无固定格式的数据, 如: 邮件, 图片等磁盘上的文件;</li></ul> 
<h4><a id="12__52"></a>1.2 搜索结构化数据和非结构化数据</h4> 
<ul><li>使用SQL语言专门搜索结构化数据;</li><li>使用ES/Lucene/Solr建立<strong>倒排索引</strong>, 根据关键字就可以搜索一些非结构化数据;</li></ul> 
<h4><a id="13__56"></a>1.3 全文检索:</h4> 
<p>全文检索是指:</p> 
<ul><li>通过一个程序扫描文本中的每个单词, 针对单词建立索引, 并保存该单词在文本中的位置以及出现的频次;</li><li>用户查询时, 通过之前建立好的索引来查询, 将索引单词对应的文本位置, 出现的次数返回给用户, 因为有了具体的位置, 就可以将具体的内容读出来;</li><li>类似于通过字典中, 检索字表查字的过程</li></ul> 
<h3><a id="2_Lucene_62"></a>2. Lucene简介</h3> 
<p><a href="https://lucene.apache.org/" rel="nofollow">https://lucene.apache.org/</a><br> <img src="https://images2.imgbox.com/ef/0b/bNorumdb_o.png" alt="在这里插入图片描述"></p> 
<ul><li>Lucene是一种高性能的全文检索库, 2000年开源, 最初有Doug Cutting(道格·卡丁)开发;</li><li>Lucnee是Apache的一个顶级开源醒目, 是一个全文检索引擎工具包; 但Lucene不是一个完整的全文检索引擎, 它只是提供一个基本的全文检索的架构, 还提供了一些基本的分词库;</li><li>Lucene是一个简单易用的工具包, 可以方便的实现全文检索的功能;</li></ul> 
<h2><a id="ES_69"></a>三、ES的核心概念：</h2> 
<h3><a id="1__index_71"></a>1. 索引 index:</h3> 
<ul><li>一个索引就是一个拥有几分相似特征的文档的集合;</li><li>一个索引由一个名字来标识(必须全部是小写字母);</li><li>在一个集群中, 可以定义任意多的索引;</li></ul> 
<h3><a id="2__mapping_76"></a>2. 映射 mapping</h3> 
<ul><li>ES中的映射(Mapping)用来定义一个文档;</li><li>mapping是处理数据的方式和规则方面做一些限制; 如: 字段的数据类型, 默认值, 分析器, 是否被索引;</li><li>类似mysql在建表时, 指定字段和字段类型;</li></ul> 
<h3><a id="3__Field_81"></a>3. 字段 Field</h3> 
<p>相当于数据表中的字段, 对文档数据根据不同属性进行的分类标识;</p> 
<h3><a id="4_type_84"></a>4. 类型type</h3> 
<p>每一个字段都应该有一个对应的类型, 例如: Text, Keyword, Byte等;</p> 
<h3><a id="5__document_87"></a>5. 文档 document</h3> 
<ul><li>一个文档是一个可被索引的基础信息单元; 比如: 可以拥有某一个客户的文档, 某一个产品的一个文档; 当然, 也可以是拥有某个订单的一个文档;</li><li>文档以json格式来表示;</li></ul> 
<h3><a id="6__cluster_91"></a>6. 集群 cluster</h3> 
<ul><li>一个集群就是由一个或多个节点组织在一起, 它们共同持有整个的数据, 并一起提供索引和搜索功能;</li><li>一个集群由一个唯一的名字标识, 这个名字默认就是 “elasticsearch”;</li><li>这个名字是重要的, 因为一个节点只能通过指定的某个集群名字来加入这个集群;</li></ul> 
<h3><a id="7__node_96"></a>7. 节点 node</h3> 
<ul><li>一个节点时集群中的一个服务器, 作为集群的一部分, 它存储数据, 参与集群的索引和搜索功能;</li><li>一个节点可以通过配置集群名称的方式加入一个指定的集群; 默认情况下, 每个节点都会被安排加入到 "elasticsearch"的集群中;</li><li>这意味着, 如果网络中启动了若干个节点, 并假定它们能够相互发现, 它们将会自动的形成并加入到集群中;</li><li>在一个集群里, 可以拥有任意多个节点, 而且, 如果有网络中没有运行任何的ES节点, 这时启动一个节点, 会默认创建并加入到 "elasticsearch"的集群中;</li></ul> 
<h3><a id="8__shards__replicas_103"></a>8. 分片和副本: shards &amp; replicas</h3> 
<h4><a id="81__104"></a>8.1 分片</h4> 
<ul><li>一个索引可以存储超出单个节点硬件限制的大量数据; 比如, 一个具有10亿文档的索引占据1TB的磁盘空间, 而任一节点都没有这样大的磁盘空间, 或者单个节点处理搜索请求, 响应太慢;</li><li>为了解决这个问题, ES提供了将索引划分成多份的能力, 这些份被称为<strong>分片</strong>;</li><li>当创建一个索引的时候, 可以指定想要的分片数量;</li><li>每个分片本身也是一个功能完善并且独立的"索引", 这个"索引"可以被防止到集群中的任何节点上;</li><li>分片功能主要体现在: 
  <ul><li>允许水平分割/扩展内容容量;</li><li>允许在分片之上进行分布式, 并行的操作, 进而提高性能和吞吐;</li></ul> </li><li>至于一个分片怎样分布, 文档怎样聚合, 搜索请求怎么处理, 是完全有ES管理的, 对于用户来说, 是透明的;</li></ul> 
<h4><a id="82__114"></a>8.2 副本</h4> 
<ul><li>在一个网络/云的环境中, 失败随时都可能发生, 在某个分片/节点突然处于离线状态;</li></ul> 
<h2><a id="_ES_118"></a>四. 安装ES:</h2> 
<h3><a id="1_es_119"></a>1. 安装es:</h3> 
<p><strong>操作系统: centos7</strong></p> 
<h4><a id="11__121"></a>1.1 创建普通用户:</h4> 
<blockquote> 
 <p>ES不能使用root用户, 必须使用普通用户来安装启动;</p> 
</blockquote> 
<p>创建一个es专门的用户</p> 
<pre><code class="prism language-shell"><span class="token function">useradd</span> esuser
<span class="token function">passwd</span> es123
</code></pre> 
<h4><a id="12_sudo_130"></a>1.2 为普通用户添加sudo权限</h4> 
<p>执行<code>visudo</code>打开用户权限管理文件</p> 
<pre><code class="prism language-shell">esuser <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> ALL
</code></pre> 
<h4><a id="13__136"></a>1.3 准备安装包</h4> 
<p>下载地址: <a href="https://www.elastic.co/cn/downloads/elasticsearch" rel="nofollow">https://www.elastic.co/cn/downloads/elasticsearch</a></p> 
<p>在服务器上创建<code>es</code>目录, 并修改owner为esuser用户</p> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> -p /export/server/es
<span class="token function">chown</span> -R esuser /export/server/es

<span class="token comment"># 解压ES</span>
<span class="token function">su</span> esuser
<span class="token builtin class-name">cd</span> /export/software
<span class="token function">tar</span> -zvxf elasticsearch-xxx.tar.gz -C /export/server/es/
</code></pre> 
<h4><a id="14__150"></a>1.4 修改配置文件</h4> 
<h5><a id="141_elasticsearchyml_151"></a>1.4.1 修改elasticsearch.yml</h5> 
<p>使用<code>esuser</code>用户来修改配置文件</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /export/server/es/elasticsearch-xxx/config
<span class="token function">mkdir</span> -p /export/server/es/elasticsearch-xxx/log
<span class="token function">mkdir</span> -p /export/server/es/elasticsearch-xxx/data
<span class="token function">rm</span> -rf elasticsearch.yml
</code></pre> 
<p><code>elasticsearch.yml</code></p> 
<pre><code class="prism language-yml"><span class="token key atrule">clister.name</span><span class="token punctuation">:</span> elasticsearch
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> node1
<span class="token key atrule">path.data</span><span class="token punctuation">:</span> /export/server/es/elasticsearch<span class="token punctuation">-</span>xxx/data
<span class="token key atrule">path.log</span><span class="token punctuation">:</span> /export/server/es/elasticsearch<span class="token punctuation">-</span>xxx/log
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> node1
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">9200</span>
<span class="token key atrule">discovery.seed_host</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"node1"</span><span class="token punctuation">,</span> <span class="token string">"node2"</span><span class="token punctuation">,</span> <span class="token string">"node3"</span><span class="token punctuation">]</span>
<span class="token key atrule">cluster.initial_master_nodes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"node1"</span><span class="token punctuation">,</span> <span class="token string">"node2"</span><span class="token punctuation">]</span>
<span class="token key atrule">bootstrap.system_call_filter</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">bootstrap.memory_lock</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">http.cors.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">http.cors.allow-origin</span><span class="token punctuation">:</span> <span class="token string">"*"</span>
</code></pre> 
<p>ps: node(x): 为节点地址(域名或ip)</p> 
<blockquote> 
 <p>clister.name: 集群名称<br> node.name: 当前节点名称<br> path.data, path.log: 数据和日志目录<br> network.host: 当前网络地址<br> http.port:服务端口号<br> discovery.seed_host: 互相发现的地址列表<br> cluster.initial_master_nodes:初始化master节点列表<br> bootstrap.system_call_filter: 系统调用过滤<br> bootstrap.memory_lock: 内存锁定<br> http.cors.enabled, http.cors.allow-origin: 跨域相关, 开放</p> 
</blockquote> 
<h5><a id="142_jvmoption_186"></a>1.4.2 修改jvm.option</h5> 
<p>修改jvm.option配置文件, 调整jvm堆内存大小</p> 
<p><code>/export/server/es/elasticsearch-xxx/config/ jvm.options</code></p> 
<pre><code class="prism language-shell">-Xms2g
-Xmx2g
</code></pre> 
<h4><a id="15__194"></a>1.5 配置其他节点</h4> 
<h4><a id="16___196"></a>1.6 修改系统配置, 解决启动问题</h4> 
<p>由于现在使用普通用户来安装es服务, 且es服务对服务器要求的资源比较多, 包括内存大小, 线程数等, 所以, 需要给esuser解开资源的束缚;</p> 
<h5><a id="161__198"></a>1.6.1 打开文件的最大数限制;</h5> 
<p>问题错误信息:<br> <code>max file descriptors[4096] for elasticsearch process likely too low, increase to at least [65536]</code><br> es因为需要大量的创建索引文件, 需要大量的打开系统的文件<br> <code>sudo vi /etc/security/limits.conf</code><br> 添加如下内容:<br> ps: <code>*</code>不要去掉</p> 
<pre><code class="prism language-shell"><span class="token punctuation">..</span><span class="token punctuation">..</span>. <span class="token comment"># 原本的内容</span>
* soft nofile <span class="token number">65535</span>
* hard nofile <span class="token number">131072</span>
* soft nproc <span class="token number">2048</span>
* hard nproc <span class="token number">4096</span>

<span class="token comment"># End of file</span>
</code></pre> 
<blockquote> 
 <p>修改此文件后, 需要重新登录用户</p> 
</blockquote> 
<h5><a id="162__219"></a>1.6.2 启动线程数限制</h5> 
<p>问题错误描述:<br> <code>max number of threads [1024] for user [esuser] likely too low, increase to at least [4096]</code><br> <code>/etc/security/limits.d/20-nproc.conf</code></p> 
<pre><code class="prism language-shell">* soft nproc <span class="token number">1024</span>
<span class="token comment"># 修改为:</span>
* soft nproc <span class="token number">4096</span>
</code></pre> 
<h5><a id="163__229"></a>1.6.3 调大虚拟内存</h5> 
<p>问题错误描述<br> <code>max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least[262144]</code><br> 手动执行命令:</p> 
<pre><code> sudo sysctl -w vm.max_map_count=262144
</code></pre> 
<p>修改系统文件(重启后不必在修改)<br> <code>/etc/sysctl.conf</code></p> 
<pre><code class="prism language-shell"><span class="token comment"># 最后一行</span>
vm.max_map_count-262144
</code></pre> 
<h4><a id="17_es_243"></a>1.7 启动es</h4> 
<p>使用<code>esuser</code>用户来执行</p> 
<pre><code class="prism language-shell">nobup /export/server/es/elasticsearch-xxx/bin/elasticsearch <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> <span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
</code></pre> 
<p>使用<code>jps</code>可以看到es服务进程<br> 访问 <code>http://node1:9200/?pretty</code> 可以看到一些信息<br> <img src="https://images2.imgbox.com/5b/32/hclqaCIM_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_Docker_253"></a>2. 使用Docker</h3> 
<p>镜像地址: <a href="https://hub.docker.com/_/elasticsearch" rel="nofollow">https://hub.docker.com/_/elasticsearch</a></p> 
<p>相关文档: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.5/docker.html" rel="nofollow">https://www.elastic.co/guide/en/elasticsearch/reference/7.5/docker.html</a></p> 
<h3><a id="3__Elasticsearchhead_258"></a>3. Elasticsearch-head插件</h3> 
<ul><li>elasticsearch-head提供一个用于图形化查看的插件工具,</li></ul> 
<p>文档网站: <a href="http://mobz.github.io/elasticsearch-head/" rel="nofollow">http://mobz.github.io/elasticsearch-head/</a><br> 项目地址: <a href="https://github.com/mobz/elasticsearch-head">https://github.com/mobz/elasticsearch-head</a></p> 
<h3><a id="4_IK_264"></a>4. 安装IK分词器</h3> 
<p>需要使用ES来进行中文分词, 所以要单独给ES安装IK分词器插件:</p> 
<ul><li>下载ES Ik分词器: 
  <ul><li><a href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik</a></li></ul> </li><li>切换用户<code>esuser</code>, 并在es安装目录下的<code>/plugin</code>目录下创建 <code>ik</code> 目录</li></ul> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> -p /export/server/es/elasticsearch-xxx/plugin/ik
</code></pre> 
<ul><li>将ik分词器解压到该目录下</li></ul> 
<pre><code class="prism language-shell"><span class="token function">unzip</span> elasticsearch-analysis-ik-xxx.zip
</code></pre> 
<ul><li>重启ElasticSearch</li></ul> 
<blockquote> 
 <p>使用docker启动, 将ik分词器解压到本地;<br> macOS会在本地的plugin目录中生成一个文件, 会影响es的启动;<br> 注意版本要一致!!!<br> <code>docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -v /docker/elasticsearch/plugin:/usr/share/elasticsearch/plugins -e "discovery.type=single-node" elasticsearch</code><br> 使用新版的ES需要密码登录: <a href="https://blog.csdn.net/u012999325/article/details/105451855">https://blog.csdn.net/u012999325/article/details/105451855</a></p> 
</blockquote> 
<h3><a id="5_Vscode_285"></a>5. 准备Vscode开发环境</h3> 
<p>在VScode中安装elasticsearch for vscode插件</p> 
<p>插件地址: <a href="https://marketplace.visualstudio.com/items?itemName=ria.elastic" rel="nofollow">https://marketplace.visualstudio.com/items?itemName=ria.elastic</a></p> 
<p><img src="https://images2.imgbox.com/81/23/rTY7wiDo_o.png" alt="在这里插入图片描述"><br> 使用普通的分词器:</p> 
<pre><code class="prism language-es">POST _analyze
{
  "analyzer": "standard",
  "text": "我爱你中国"
}
</code></pre> 
<p>结果:</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"tokens"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"我"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC&gt;"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"爱"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC&gt;"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"你"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC&gt;"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"中"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC&gt;"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"国"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"&lt;IDEOGRAPHIC&gt;"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">4</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>使用ik分词器</p> 
<pre><code class="prism language-es">POST _analyze
{
  "analyzer": "ik_max_word", // 尽可能多的分词
  "text": "我爱你中国"
}
</code></pre> 
<p>结果:</p> 
<pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"tokens"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"我爱你"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"爱你"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string-property property">"token"</span><span class="token operator">:</span> <span class="token string">"中国"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"start_offset"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token string-property property">"end_offset"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"CN_WORD"</span><span class="token punctuation">,</span>
            <span class="token string-property property">"position"</span><span class="token operator">:</span> <span class="token number">2</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1c83cda5273f8716ff1d7c3d5905193d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">记录:OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loade...idea debug启动报错【解决方案】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eeb74462f64f0bf7d2174cfb4ab4e32f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux下安装RabbitMQ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>