<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL之binlog - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL之binlog" />
<meta property="og:description" content="binlog是什么？它是一个日志，一个归档日志，一个二进制日志，一个逻辑日志，一个server层日志。表示看完了没什么感觉，能动手的最好别bb。看看它能干什么。
建议先打开你的数据库客户端或者“黑窗口”什么的，连接并且登录数据库。
作用：恢复数据，避免删库跑路。
还是来先看看你的数据库有没有开启binlog功能。
SHOW VARIABLES LIKE &#39;%log_bin%&#39;; 看到这里的ON了吗？恭喜你，你的数据库开启了binlog，为你的数据安全增加了一份保障。如果是OFF，那么参考官方文档或者自行搜索开启binlog配置（本人windows 5.7.12版本因不知名原因配置后无法启动服务就不写配置方法了）。
binlog有三种格式（哪三种方式自行搜索），方式：
SHOW VARIABLES LIKE &#39;%binlog_format%&#39;; 如果你已经配置成功，那么找一个不怎么重要的库里的不怎么重要的表增删改数据看看如果用binlog恢复它们。
我执行了一个update：
看上面的截图log_bin_basename，进到这个目录下面查看可以看到一堆：
通过文本方式打开它，会发现一堆乱七八糟的东西，因为它是二进制日志。使用mysqlbinlog命令查看：
mysqlbinlog -v --start-datetime=&#34;2022-06-01 15:00:00&#34; --stop-datetime=&#34;2022-06-01 15:30:00&#34; ../data/binlog.000243 &gt; ../data/temp.log 注意：本文所有操作皆在windows下进行的。mysqlbinlog在bin目录下，需要进入bin目录执行；日期用双引号，要找准日志文件的位置，temp.log是一个临时转存文件。
我这里看到一些这样的东西，看下@1、@2、@3分别对应了表里的字段，重点看下@1、@3（不要在意乱码，我数据库数据本身就这样）。实际上这一堆东西就是伪sql，一堆执行逻辑（逻辑日志）。将它们整理好，放到客户端执行就可以恢复修改的数据了。
mysqlbinlog语法：
mysqlbinlog [options] log-files
options：可选参数
log-files：文件名称
[options]常用值：
-d: 根据数据库的名称筛选日志
-o：跳过前N行日志
-r, --result-fil: 把日志输出到指定文件
–start-datetime: 读取指定时间之后的日志，时间格式：yyyy-MM-dd HH:mm:ss
–stop-datetime: 读取指定时间之前的日志，时间格式：yyyy-MM-dd HH:mm:ss
–start-position: 从指定位置开始读取日志
–stop-position: 读取到指定位置停止
–base64-output：在row格式下，显示伪sql语句
-v, --verbose：显示伪sql语句，-vv可以为sql语句添加备注
–set-charset：设置输出文件编码
主从架构需要用到
（没有实际操作过，暂时就不写了）。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e37c5d32b528ac48a1aed12d010dfdae/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-01T16:38:09+08:00" />
<meta property="article:modified_time" content="2022-06-01T16:38:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL之binlog</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>binlog是什么？它是一个日志，一个归档日志，一个二进制日志，一个逻辑日志，一个server层日志。表示看完了没什么感觉，能动手的最好别bb。看看它能干什么。<br> 建议先打开你的数据库客户端或者“黑窗口”什么的，连接并且登录数据库。<br> 作用：<strong>恢复数据</strong>，避免删库跑路。<br> 还是来先看看你的数据库有没有开启binlog功能。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%log_bin%'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/40/d1/FZoBTjzO_o.png" alt="binlog是否开启"><br> 看到这里的<mark>ON</mark>了吗？恭喜你，你的数据库开启了binlog，为你的数据安全增加了一份保障。如果是<mark>OFF</mark>，那么参考<a href="https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#replication-optvars-binlog" rel="nofollow">官方文档</a>或者自行搜索开启binlog配置（本人windows 5.7.12版本因不知名原因配置后无法启动服务就不写配置方法了）。<br> binlog有三种格式（哪三种方式自行搜索），方式：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%binlog_format%'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8e/b3/MLTzYjFG_o.png" alt="binlog格式"><br> 如果你已经配置成功，那么找一个不怎么重要的库里的不怎么重要的表增删改数据看看如果用binlog恢复它们。<br> 我执行了一个update：<br> <img src="https://images2.imgbox.com/8b/ad/XtIAhVND_o.png" alt="修改"><br> 看上面的截图log_bin_basename，进到这个目录下面查看可以看到一堆：<br> <img src="https://images2.imgbox.com/b0/fe/ERH7nTil_o.png" alt="binlog文件"><br> 通过文本方式打开它，会发现一堆乱七八糟的东西，因为它是<mark>二进制日志</mark>。使用<strong>mysqlbinlog</strong>命令查看：</p> 
<pre><code class="prism language-powershell">mysqlbinlog <span class="token operator">-</span>v <span class="token operator">--</span><span class="token function">start-datetime</span>=<span class="token string">"2022-06-01 15:00:00"</span> <span class="token operator">--</span><span class="token function">stop-datetime</span>=<span class="token string">"2022-06-01 15:30:00"</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>binlog<span class="token punctuation">.</span>000243 &gt; <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>temp<span class="token punctuation">.</span>log
</code></pre> 
<p>注意：本文所有操作皆在windows下进行的。mysqlbinlog在bin目录下，需要进入bin目录执行；日期用双引号，要找准日志文件的位置，temp.log是一个临时转存文件。<br> <img src="https://images2.imgbox.com/8f/ff/dTa7jEvN_o.png" alt="在这里插入图片描述"><br> 我这里看到一些这样的东西，看下@1、@2、@3分别对应了表里的字段，重点看下@1、@3（不要在意乱码，我数据库数据本身就这样）。实际上这一堆东西就是伪sql，一堆执行逻辑（逻辑日志）。将它们整理好，放到客户端执行就可以恢复修改的数据了。<br> mysqlbinlog语法：</p> 
<blockquote> 
 <p>mysqlbinlog [options] log-files</p> 
</blockquote> 
<p>options：可选参数<br> log-files：文件名称</p> 
<p>[options]常用值：</p> 
<blockquote> 
 <p>-d: 根据数据库的名称筛选日志<br> -o：跳过前N行日志<br> -r, --result-fil: 把日志输出到指定文件<br> –start-datetime: 读取指定时间之后的日志，时间格式：yyyy-MM-dd HH:mm:ss<br> –stop-datetime: 读取指定时间之前的日志，时间格式：yyyy-MM-dd HH:mm:ss<br> –start-position: 从指定位置开始读取日志<br> –stop-position: 读取到指定位置停止<br> –base64-output：在row格式下，显示伪sql语句<br> -v, --verbose：显示伪sql语句，-vv可以为sql语句添加备注<br> –set-charset：设置输出文件编码</p> 
</blockquote> 
<p><strong>主从架构需要用到</strong><br> （没有实际操作过，暂时就不写了）。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/62ad5ba7fbbe5597051f70546c1b4d3c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决opencv源代码编译找不到ffmpeg</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e3cd6776b08b1d617a5b903241ceb846/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">设备接入EasyGBS平台后请求实时流播放，出现超时是什么原因？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>