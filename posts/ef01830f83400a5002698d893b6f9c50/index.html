<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>手把手教你用Java实现一套简单的鉴权服务（SpringBoot，SSM）（万字长文） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="手把手教你用Java实现一套简单的鉴权服务（SpringBoot，SSM）（万字长文）" />
<meta property="og:description" content="文章目录 前言一、何为鉴权服务二、利用servlet&#43;jdbc实现简单的用户登录程序1.明确思路2.手把手教你实现一个简单的web登录程序①创建web项目②编写简单的登录页面③编写servlet程序④封装jdbc操作，编写简单的数据库连接池⑤操作数据库⑥配置web.xml⑦idea运行配置⑧运行程序 三、回顾1.密码未加密裸奔2.登录信息未存储3.对于其他资源并未进行权限管理 四、优化设计1.密码加密存储2.存储登录信息3.对资源进行管理 五、关于鉴权问题1.Cookie/Session机制2.用Cookie/Session解决鉴权问题？Cookie/Session机制的缺点1.无法解决跨域问题2.session机制依赖于cookie3.可拓展性不强4.服务器压力增大5.安全性问题 3.使用token机制解决鉴权问题 六、用SpringBoot&#43;SSM实现一套简单的鉴权服务（注册，登录，权限控制）1.注册服务①注册页面②发送验证码sendcode接口邮件发送方法（调用SpringBoot提供的mail服务（需要导包））验证码对象验证码池 ③注册用户MD5加密类注册用户接口检验验证码方法 2.登录服务登录界面登录接口认证方法登录方式enum类登录方式类认证令牌类认证令牌池 3.权限控制（拦截器）拦截器UserInterceptorMVC配置类 七、效果展示1.注册2.登录3.访问其他资源 写在最后 前言 时遇JavaEE作业，题目要求写个简单web登录程序，按照老师的意思是用servlet、jsp和jdbc完成。本着要么不做，要做就要做好的原则，我开始着手完成此次作业（其实也是写实训作业的用户鉴权部分），而之前写项目的时候也有相关经验，这次正好能派上用场。
一、何为鉴权服务 引用百度百科的话说
鉴权（authentication）是指验证用户是否拥有访问系统的权利。
鉴权包括两个方面：
用户鉴权，网络对用户进行鉴权，防止非法用户占用网络资源。网络鉴权，用户对网络进行鉴权，防止用户接入了非法的网络，被骗取关键信息。 而我们这里的鉴权主要指用户鉴权，即如何确认“你是你”。最简单的体现便是平常用的用户登录登出。
现今大部分系统都会有自己的鉴权服务，它是用户与系统交互的第一步，系统需要一系列步骤明白你是谁，你可以做哪些事，明白了这些之后它才能更好的服务于你。
二、利用servlet&#43;jdbc实现简单的用户登录程序 1.明确思路 首先，我们要仔细思考一下我们到底需要什么？
先让我们回想一下一般的登录是如何做的呢？
对于网页，首先会出现一个登录页面，然后呢，输入账号密码，点击登录，就会弹出成功/失败的页面。
那如何去判断成功/失败呢？
思考一下，最简单的方法便是拿到前端传来的数据之后便将其拿到数据中去查，看看密码是不是一样，然后给前端回复说——我找到了，他就是XXX或者我找不到他的记录，让他重新输入账号密码。
然后前端对此回复做出相应的操作，比如登录成功便跳转到首页，失败让用户重新输入。
2.手把手教你实现一个简单的web登录程序 出于某些原因，我这里手把手教你如何实现一个简单的web登录程序。
①创建web项目 打开idea，新建一个web项目
这里为了方便jar包的管理，选择maven结构的项目（至于什么是maven结构，不懂的可以百度，了解概念即可），然后选择从原型创建，选择webapp（这里只是方便，你也可以选择空项目，不过会费点时间）。
点击下一步，输入项目名称
这里选择相应的maven，idea里有自带的maven和jar包仓库，不过我是自己去官网下了一个（不下也完全可以）。
选择完成，这样一个最简单的项目结构就出来了。
接下来需要配置一下pom.xml，因为要用到jdbc和tomcat的jar包（毕竟都是调用人家的接口（笑哭））
&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; &lt;artifactId&gt;tomcat-embed-core&lt;/artifactId&gt; &lt;version&gt;9.0.37&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.20&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; （加在project标签里就行），上面配置的意思就是导入两个第三方工具包
②编写简单的登录页面 这里我既想要好看，又想偷懒，所以用了layui框架的模板
&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&#34;UTF-8&#34;&gt; &lt;title&gt;后台管理-登陆&lt;/title&gt; &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge,chrome=1&#34;&gt; &lt;meta http-equiv=&#34;Access-Control-Allow-Origin&#34; content=&#34;*&#34;&gt; &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1, maximum-scale=1&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ef01830f83400a5002698d893b6f9c50/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-05T21:30:09+08:00" />
<meta property="article:modified_time" content="2021-05-05T21:30:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">手把手教你用Java实现一套简单的鉴权服务（SpringBoot，SSM）（万字长文）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#_7" rel="nofollow">一、何为鉴权服务</a></li><li><a href="#servletjdbc_20" rel="nofollow">二、利用servlet+jdbc实现简单的用户登录程序</a></li><li><ul><li><a href="#1_21" rel="nofollow">1.明确思路</a></li><li><a href="#2web_34" rel="nofollow">2.手把手教你实现一个简单的web登录程序</a></li><li><ul><li><a href="#web_36" rel="nofollow">①创建web项目</a></li><li><a href="#_77" rel="nofollow">②编写简单的登录页面</a></li><li><a href="#servlet_269" rel="nofollow">③编写servlet程序</a></li><li><a href="#jdbc_316" rel="nofollow">④封装jdbc操作，编写简单的数据库连接池</a></li><li><a href="#_387" rel="nofollow">⑤操作数据库</a></li><li><a href="#webxml_430" rel="nofollow">⑥配置web.xml</a></li><li><a href="#idea_456" rel="nofollow">⑦idea运行配置</a></li><li><a href="#_482" rel="nofollow">⑧运行程序</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_504" rel="nofollow">三、回顾</a></li><li><ul><li><a href="#1_508" rel="nofollow">1.密码未加密裸奔</a></li><li><a href="#2_515" rel="nofollow">2.登录信息未存储</a></li><li><a href="#3_517" rel="nofollow">3.对于其他资源并未进行权限管理</a></li></ul> 
  </li><li><a href="#_520" rel="nofollow">四、优化设计</a></li><li><ul><li><a href="#1_522" rel="nofollow">1.密码加密存储</a></li><li><a href="#2_525" rel="nofollow">2.存储登录信息</a></li><li><a href="#3_528" rel="nofollow">3.对资源进行管理</a></li></ul> 
  </li><li><a href="#_531" rel="nofollow">五、关于鉴权问题</a></li><li><ul><li><a href="#1CookieSession_533" rel="nofollow">1.Cookie/Session机制</a></li><li><a href="#2CookieSession_559" rel="nofollow">2.用Cookie/Session解决鉴权问题？</a></li><li><ul><li><a href="#CookieSession_564" rel="nofollow">Cookie/Session机制的缺点</a></li><li><ul><li><a href="#1_565" rel="nofollow">1.无法解决跨域问题</a></li><li><a href="#2sessioncookie_568" rel="nofollow">2.session机制依赖于cookie</a></li><li><a href="#3_573" rel="nofollow">3.可拓展性不强</a></li><li><a href="#4_578" rel="nofollow">4.服务器压力增大</a></li><li><a href="#5_581" rel="nofollow">5.安全性问题</a></li></ul> 
   </li></ul> 
   </li><li><a href="#3token_588" rel="nofollow">3.使用token机制解决鉴权问题</a></li></ul> 
  </li><li><a href="#SpringBootSSM_629" rel="nofollow">六、用SpringBoot+SSM实现一套简单的鉴权服务（注册，登录，权限控制）</a></li><li><ul><li><a href="#1_645" rel="nofollow">1.注册服务</a></li><li><ul><li><a href="#_646" rel="nofollow">①注册页面</a></li><li><a href="#_816" rel="nofollow">②发送验证码</a></li><li><ul><li><a href="#sendcode_817" rel="nofollow">sendcode接口</a></li><li><a href="#SpringBootmail_848" rel="nofollow">邮件发送方法（调用SpringBoot提供的mail服务（需要导包））</a></li><li><a href="#_878" rel="nofollow">验证码对象</a></li><li><a href="#_958" rel="nofollow">验证码池</a></li></ul> 
    </li><li><a href="#_1020" rel="nofollow">③注册用户</a></li><li><ul><li><a href="#MD5_1021" rel="nofollow">MD5加密类</a></li><li><a href="#_1075" rel="nofollow">注册用户接口</a></li><li><a href="#_1120" rel="nofollow">检验验证码方法</a></li></ul> 
   </li></ul> 
   </li><li><a href="#2_1140" rel="nofollow">2.登录服务</a></li><li><ul><li><a href="#_1141" rel="nofollow">登录界面</a></li><li><a href="#_1343" rel="nofollow">登录接口</a></li><li><a href="#_1363" rel="nofollow">认证方法</a></li><li><a href="#enum_1381" rel="nofollow">登录方式enum类</a></li><li><a href="#_1454" rel="nofollow">登录方式类</a></li><li><a href="#_1530" rel="nofollow">认证令牌类</a></li><li><a href="#_1623" rel="nofollow">认证令牌池</a></li></ul> 
   </li><li><a href="#3_1682" rel="nofollow">3.权限控制（拦截器）</a></li><li><ul><li><a href="#UserInterceptor_1684" rel="nofollow">拦截器UserInterceptor</a></li><li><a href="#MVC_1741" rel="nofollow">MVC配置类</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_1784" rel="nofollow">七、效果展示</a></li><li><ul><li><a href="#1_1785" rel="nofollow">1.注册</a></li><li><a href="#2_1800" rel="nofollow">2.登录</a></li><li><a href="#3_1821" rel="nofollow">3.访问其他资源</a></li></ul> 
  </li><li><a href="#_1831" rel="nofollow">写在最后</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_4"></a>前言</h2> 
<p>时遇JavaEE作业，题目要求写个简单web登录程序，按照老师的意思是用servlet、jsp和jdbc完成。本着要么不做，要做就要做好的原则，我开始着手完成此次作业（其实也是写实训作业的用户鉴权部分），而之前写项目的时候也有相关经验，这次正好能派上用场。</p> 
<h2><a id="_7"></a>一、何为鉴权服务</h2> 
<p>引用百度百科的话说</p> 
<blockquote> 
 <p><strong>鉴权（authentication）是指验证用户是否拥有访问系统的权利。</strong></p> 
 <p>鉴权包括两个方面：</p> 
 <ul><li>用户鉴权，网络对用户进行鉴权，防止非法用户占用网络资源。</li><li>网络鉴权，用户对网络进行鉴权，防止用户接入了非法的网络，被骗取关键信息。</li></ul> 
</blockquote> 
<p>而我们这里的鉴权主要指用户鉴权，即如何确认“你是你”。最简单的体现便是平常用的用户登录登出。</p> 
<p>现今大部分系统都会有自己的鉴权服务，它是用户与系统交互的第一步，系统需要一系列步骤明白你是谁，你可以做哪些事，明白了这些之后它才能更好的服务于你。</p> 
<h2><a id="servletjdbc_20"></a>二、利用servlet+jdbc实现简单的用户登录程序</h2> 
<h3><a id="1_21"></a>1.明确思路</h3> 
<p>首先，我们要仔细思考一下我们到底需要什么？</p> 
<p>先让我们回想一下一般的登录是如何做的呢？</p> 
<p>对于网页，首先会出现一个登录页面，然后呢，输入账号密码，点击登录，就会弹出成功/失败的页面。</p> 
<p>那如何去判断成功/失败呢？</p> 
<p>思考一下，最简单的方法便是拿到前端传来的数据之后便将其拿到数据中去查，看看密码是不是一样，然后给前端回复说——我找到了，他就是XXX或者我找不到他的记录，让他重新输入账号密码。</p> 
<p>然后前端对此回复做出相应的操作，比如登录成功便跳转到首页，失败让用户重新输入。</p> 
<h3><a id="2web_34"></a>2.手把手教你实现一个简单的web登录程序</h3> 
<p>出于某些原因，我这里手把手教你如何实现一个简单的web登录程序。</p> 
<h4><a id="web_36"></a>①创建web项目</h4> 
<p>打开idea，新建一个web项目</p> 
<p><img src="https://images2.imgbox.com/7a/ec/PQmsPKNG_o.png" alt="在这里插入图片描述"></p> 
<p>这里为了方便jar包的管理，选择maven结构的项目（至于什么是maven结构，不懂的可以百度，了解概念即可），然后选择从原型创建，选择webapp（这里只是方便，你也可以选择空项目，不过会费点时间）。</p> 
<p><img src="https://images2.imgbox.com/a3/97/HvEsSZT3_o.png" alt="在这里插入图片描述"></p> 
<p>点击下一步，输入项目名称</p> 
<p><img src="https://images2.imgbox.com/97/84/8ZPAVdEP_o.png" alt="在这里插入图片描述"></p> 
<p>这里选择相应的maven，idea里有自带的maven和jar包仓库，不过我是自己去官网下了一个（不下也完全可以）。</p> 
<p><img src="https://images2.imgbox.com/2b/ae/HPnIhF5w_o.png" alt="在这里插入图片描述"></p> 
<p>选择完成，这样一个最简单的项目结构就出来了。</p> 
<p><img src="https://images2.imgbox.com/0f/75/mdnJend4_o.png" alt="在这里插入图片描述"></p> 
<p>接下来需要配置一下pom.xml，因为要用到jdbc和tomcat的jar包（毕竟都是调用人家的接口（笑哭））</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tomcat-embed-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>9.0.37<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>（加在project标签里就行），上面配置的意思就是导入两个第三方工具包</p> 
<h4><a id="_77"></a>②编写简单的登录页面</h4> 
<p>这里我既想要好看，又想偷懒，所以用了layui框架的模板</p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>后台管理-登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE=edge,chrome=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Access-Control-Allow-Origin<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>*<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1, maximum-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>apple-mobile-web-app-status-bar-style<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>black<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>apple-mobile-web-app-capable<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>yes<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>format-detection<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>telephone=no<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../lib/layui-v2.6.3/css/layui.css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--[if lt IE 9]&gt;
    &lt;script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;
    &lt;![endif]--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
        <span class="token selector">.main-body</span> <span class="token punctuation">{<!-- --></span><span class="token property">top</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">-webkit-transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%,-50%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-moz-transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%,-50%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-ms-transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%,-50%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-o-transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%,-50%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">translate</span><span class="token punctuation">(</span>-50%,-50%<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span>hidden<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item input</span> <span class="token punctuation">{<!-- --></span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>227px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>22px<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">outline</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>14px<span class="token punctuation">;</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon-1</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat 1px 0<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon-2</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat -54px 0<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon-3</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat -106px 0<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon-4</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat 0 -43px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">right</span><span class="token punctuation">:</span>-10px<span class="token punctuation">;</span><span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon-5</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat -55px -43px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon-6</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat 0 -93px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">right</span><span class="token punctuation">:</span>-10px<span class="token punctuation">;</span><span class="token property">margin-top</span><span class="token punctuation">:</span>8px<span class="token punctuation">;</span><span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .tip .icon-nocheck</span> <span class="token punctuation">{<!-- --></span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>2px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>solid 1px #9abcda<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>2px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>1px 8px 1px 1px<span class="token punctuation">;</span><span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .tip .icon-check</span> <span class="token punctuation">{<!-- --></span><span class="token property">margin</span><span class="token punctuation">:</span>0 7px 0 0<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>14px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>14px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/icon-login.png)</span> no-repeat -111px -48px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .icon</span> <span class="token punctuation">{<!-- --></span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>33px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>22px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>288px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>35px<span class="token punctuation">;</span><span class="token property">border-bottom</span><span class="token punctuation">:</span>1px solid #dae1e6<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span>35px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>428px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span><span class="token property">float</span><span class="token punctuation">:</span>left<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-top</span> <span class="token punctuation">{<!-- --></span><span class="token property">height</span><span class="token punctuation">:</span>117px<span class="token punctuation">;</span><span class="token property">background-color</span><span class="token punctuation">:</span>#148be4<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>12px 12px 0 0<span class="token punctuation">;</span><span class="token property">font-family</span><span class="token punctuation">:</span>SourceHanSansCN-Regular<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>30px<span class="token punctuation">;</span><span class="token property">font-weight</span><span class="token punctuation">:</span>400<span class="token punctuation">;</span><span class="token property">font-stretch</span><span class="token punctuation">:</span>normal<span class="token punctuation">;</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>117px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span>hidden<span class="token punctuation">;</span><span class="token property">-webkit-transform</span><span class="token punctuation">:</span><span class="token function">rotate</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-moz-transform</span><span class="token punctuation">:</span><span class="token function">rotate</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-ms-transform</span><span class="token punctuation">:</span><span class="token function">rotate</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-o-transform</span><span class="token punctuation">:</span><span class="token function">rotate</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">rotate</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-top .bg1</span> <span class="token punctuation">{<!-- --></span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>74px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>74px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">opacity</span><span class="token punctuation">:</span>.1<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>0 74px 0 0<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>43px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-top .bg2</span> <span class="token punctuation">{<!-- --></span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>94px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>94px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">opacity</span><span class="token punctuation">:</span>.1<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">right</span><span class="token punctuation">:</span>-16px<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>-16px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>428px<span class="token punctuation">;</span><span class="token property">background</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>0 0 12px 12px<span class="token punctuation">;</span><span class="token property">padding-bottom</span><span class="token punctuation">:</span>53px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>288px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>0 auto<span class="token punctuation">;</span><span class="token property">padding-top</span><span class="token punctuation">:</span>40px<span class="token punctuation">;</span><span class="token property">padding-bottom</span><span class="token punctuation">:</span>15px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .tip</span> <span class="token punctuation">{<!-- --></span><span class="token property">clear</span><span class="token punctuation">:</span>both<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>16px<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>16px<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>288px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>0 auto<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">body</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span><span class="token url">url(../images/loginbg.png)</span> 0% 0% / cover no-repeat<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>static<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>12px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">input::-webkit-input-placeholder</span> <span class="token punctuation">{<!-- --></span><span class="token property">color</span><span class="token punctuation">:</span>#a6aebf<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">input::-moz-placeholder</span> <span class="token punctuation">{<!-- --></span><span class="token comment">/* Mozilla Firefox 19+ */</span>            <span class="token property">color</span><span class="token punctuation">:</span>#a6aebf<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">input:-moz-placeholder</span> <span class="token punctuation">{<!-- --></span><span class="token comment">/* Mozilla Firefox 4 to 18 */</span>            <span class="token property">color</span><span class="token punctuation">:</span>#a6aebf<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">input:-ms-input-placeholder</span> <span class="token punctuation">{<!-- --></span><span class="token comment">/* Internet Explorer 10-11 */</span>            <span class="token property">color</span><span class="token punctuation">:</span>#a6aebf<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">input:-webkit-autofill</span> <span class="token punctuation">{<!-- --></span><span class="token comment">/* 取消Chrome记住密码的背景颜色 */</span>            <span class="token property">-webkit-box-shadow</span><span class="token punctuation">:</span>0 0 0 1000px white inset <span class="token important">!important</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">html</span> <span class="token punctuation">{<!-- --></span><span class="token property">height</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .tip</span> <span class="token punctuation">{<!-- --></span><span class="token property">clear</span><span class="token punctuation">:</span>both<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>16px<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>16px<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>288px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>0 auto<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .tip .login-tip</span> <span class="token punctuation">{<!-- --></span><span class="token property">font-family</span><span class="token punctuation">:</span>MicrosoftYaHei<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>12px<span class="token punctuation">;</span><span class="token property">font-weight</span><span class="token punctuation">:</span>400<span class="token punctuation">;</span><span class="token property">font-stretch</span><span class="token punctuation">:</span>normal<span class="token punctuation">;</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#9abcda<span class="token punctuation">;</span><span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .tip .forget-password</span> <span class="token punctuation">{<!-- --></span><span class="token property">font-stretch</span><span class="token punctuation">:</span>normal<span class="token punctuation">;</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#1391ff<span class="token punctuation">;</span><span class="token property">text-decoration</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">right</span><span class="token punctuation">:</span>62px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .login-btn</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>288px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>40px<span class="token punctuation">;</span><span class="token property">background-color</span><span class="token punctuation">:</span>#1E9FFF<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>16px<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>24px auto 0<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>40px<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>14px<span class="token punctuation">;</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-main .login-bottom .center .item .validateImg</span> <span class="token punctuation">{<!-- --></span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">right</span><span class="token punctuation">:</span>1px<span class="token punctuation">;</span><span class="token property">cursor</span><span class="token punctuation">:</span>pointer<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>36px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>1px solid #e6e6e6<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.footer</span> <span class="token punctuation">{<!-- --></span><span class="token property">left</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">bottom</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>30px<span class="token punctuation">;</span><span class="token property">padding-bottom</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span><span class="token property">text-shadow</span><span class="token punctuation">:</span>#000 0.1em 0.1em 0.1em<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>14px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.padding-5</span> <span class="token punctuation">{<!-- --></span><span class="token property">padding</span><span class="token punctuation">:</span>5px <span class="token important">!important</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.footer a,.footer span</span> <span class="token punctuation">{<!-- --></span><span class="token property">color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token atrule"><span class="token rule">@media</span> screen and <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span>428px<span class="token punctuation">)</span></span> <span class="token punctuation">{<!-- --></span><span class="token selector">.login-main</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>360px <span class="token important">!important</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
            <span class="token selector">.login-main .login-top</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>360px <span class="token important">!important</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
            <span class="token selector">.login-main .login-bottom</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>360px <span class="token important">!important</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>main-body<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login-main<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login-top<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>LayuiMini后台登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bg1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bg2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form login-bottom<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/login<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon icon-2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uname<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span>  <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入登录账号<span class="token punctuation">"</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>24<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon icon-3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pwd<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span>  <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入密码<span class="token punctuation">"</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bind-password icon icon-4<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tip<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>icon-nocheck<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login-tip<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>保持登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>javascript:<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>forget-password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>忘记密码？<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token property">margin</span><span class="token punctuation">:</span>0px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login-btn<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">lay-submit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>立即登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    ©版权所有 2014-2018 叁贰柒工作室<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>padding-5<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>|<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.miitbeian.gov.cn<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>粤ICP备16006642号-2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../lib/layui-v2.6.3/layui.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    <span class="token comment">//原本想用json的post发送，结果发现后端数据得自己解析，为了降低难度，直接用form表单的post提交，这样后端直接拿数据即可（不然还得解析Json数据）</span>
    <span class="token comment">// layui.use(['form','jquery'], function () {<!-- --></span>
    <span class="token comment">//     var $ = layui.jquery,</span>
    <span class="token comment">//         form = layui.form,</span>
    <span class="token comment">//         layer = layui.layer;</span>
    <span class="token comment">//</span>
    <span class="token comment">//     // 登录过期的时候，跳出ifram框架</span>
    <span class="token comment">//     if (top.location != self.location) top.location = self.location;</span>
    <span class="token comment">//</span>
    <span class="token comment">//     $('.bind-password').on('click', function () {<!-- --></span>
    <span class="token comment">//         if ($(this).hasClass('icon-5')) {<!-- --></span>
    <span class="token comment">//             $(this).removeClass('icon-5');</span>
    <span class="token comment">//             $("input[name='pwd']").attr('type', 'password');</span>
    <span class="token comment">//         } else {<!-- --></span>
    <span class="token comment">//             $(this).addClass('icon-5');</span>
    <span class="token comment">//             $("input[name='pwd']").attr('type', 'text');</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     });</span>
    <span class="token comment">//</span>
    <span class="token comment">//     $('.icon-nocheck').on('click', function () {<!-- --></span>
    <span class="token comment">//         if ($(this).hasClass('icon-check')) {<!-- --></span>
    <span class="token comment">//             $(this).removeClass('icon-check');</span>
    <span class="token comment">//         } else {<!-- --></span>
    <span class="token comment">//             $(this).addClass('icon-check');</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//     });</span>
    <span class="token comment">//</span>
    <span class="token comment">//     // 进行登录操作</span>
    <span class="token comment">//     form.on('submit(login)', function (data) {<!-- --></span>
    <span class="token comment">//         data = data.field;</span>
    <span class="token comment">//         if (data.uname == '') {<!-- --></span>
    <span class="token comment">//             layer.msg('用户名不能为空');</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         if (data.pwd == '') {<!-- --></span>
    <span class="token comment">//             layer.msg('密码不能为空');</span>
    <span class="token comment">//             return false;</span>
    <span class="token comment">//         }</span>
    <span class="token comment">//         $.ajax({<!-- --></span>
    <span class="token comment">//             url:'/login',</span>
    <span class="token comment">//             method:'post',</span>
    <span class="token comment">//             data:data,</span>
    <span class="token comment">//             dataType:'JSON',</span>
    <span class="token comment">//             success:function(res){<!-- --></span>
    <span class="token comment">//                 if (res.msg==='登录成功'){<!-- --></span>
    <span class="token comment">//                     layer.msg('登录成功', function () {<!-- --></span>
    <span class="token comment">//                         window.location = '../index.html';</span>
    <span class="token comment">//                     });</span>
    <span class="token comment">//                 }else {<!-- --></span>
    <span class="token comment">//                     layer.msg("登录失败");</span>
    <span class="token comment">//                 }</span>
    <span class="token comment">//             },</span>
    <span class="token comment">//             error:function (data) {<!-- --></span>
    <span class="token comment">//             }</span>
    <span class="token comment">//         }) ;</span>
    <span class="token comment">//</span>
    <span class="token comment">//</span>
    <span class="token comment">//         return false;</span>
    <span class="token comment">//     });</span>
    <span class="token comment">// });</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>当然以上代码有一部分注释掉了，原因是如果用JSON格式发送post请求，后端的servlet（准确的说是Tomcat的解析）并没有帮我们解析封装这部分数据，所以我们无法直接get到，得自己另外解析数据，当然也有一些第三方的工具包可以帮我们做这些事情（如阿里的fastjson等），这里为了使其更加简单，所以采用表单提交post请求的方式，这样解析的工作就不用我们做了。</p> 
<p>效果是这样的：<br> <img src="https://images2.imgbox.com/0c/d7/8zHfW1kK_o.png" alt="在这里插入图片描述"></p> 
<p>如果你没学过layui或者对前端不太行，你也可以这样</p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
&lt;htmllang="en"&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>用户登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/login<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uname<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    密码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pwd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>一样的功能，不过看上去的效果就不怎么好了。</p> 
<h4><a id="servlet_269"></a>③编写servlet程序</h4> 
<p>当有了前端的页面，看上去好了很多，但实质校验的程序我们还没有写。</p> 
<p>想象一下我们就是后端程序，当前端的数据历经艰险，从错综复杂的网络中到达我们的服务器，然后经过系统分发到相应端口，这时恰在此端口的tomcat程序接受到了HTTP请求并对其封装，经过一系列骚操作后分发到了我们手中，而我们要做的就是拿着这个封装好的请求进行校验操作，然后对返回对象进行相应修改。</p> 
<p>而这也是servlet类所需要做的（如果你想更好的理解servlet，可以看看<a href="https://www.zhihu.com/question/21416727" rel="nofollow">bravo1988的回答</a>），</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>loginTest<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>loginTest<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>UserMapper<span class="token punctuation">;</span>

<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletException<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletOutputStream<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServlet<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> UserMapper userMapper<span class="token operator">=</span>UserMapper<span class="token punctuation">.</span><span class="token function">getUserMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest req<span class="token punctuation">,</span> HttpServletResponse resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{<!-- --></span>
        String uname<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"uname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String pwd<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ServletOutputStream outputStream <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String result<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>pwd<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>userMapper<span class="token punctuation">.</span><span class="token function">getPwdByName</span><span class="token punctuation">(</span>uname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//响应</span>
            result<span class="token operator">=</span><span class="token string">"登录成功"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            result<span class="token operator">=</span><span class="token string">"登录失败"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        outputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>你可能会疑惑这个UserMapper是什么，别急，后面会介绍。</p> 
<h4><a id="jdbc_316"></a>④封装jdbc操作，编写简单的数据库连接池</h4> 
<p>在操作数据库之前，最好写个简单的数据库连接池。一个是简化我们的操作，一个是节省开销，提高性能（Connection是个非常耗费资源的对象，频繁的创建和回收将会是一笔巨大的开销）</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>loginTest<span class="token punctuation">.</span>utils<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Driver<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DriverManager<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>HashMap<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token comment">/**
 * 一个简单的数据库连接池
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pool</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> Driver driver<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            driver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            DriverManager<span class="token punctuation">.</span><span class="token function">registerDriver</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Connection<span class="token punctuation">,</span>Integer<span class="token punctuation">&gt;</span></span> pool<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> String url<span class="token operator">=</span><span class="token string">"jdbc:mysql://localhost:3306/depository?serverTimezone=Asia/Shanghai"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> String user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> String password<span class="token operator">=</span><span class="token string">"jinhaolin"</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * 从连接池中获取一个空闲连接，如果没有则创建一个新的连接返回
     * synchronized确保并发请求时，数据库连接的正确性
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>Map<span class="token punctuation">.</span>Entry entry<span class="token operator">:</span>pool<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                entry<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span>Connection<span class="token punctuation">)</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        Connection connection<span class="token operator">=</span>null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            connection<span class="token operator">=</span>DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>user<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pool<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> connection<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 释放connection连接对象
     * @param connection
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">releaseConnection</span><span class="token punctuation">(</span>Connection connection<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<p>当然上述实现非常简陋，并发性能也不是很好，高并发时可能还会发生OOM，不过凑活着用吧（笑哭）。</p> 
<h4><a id="_387"></a>⑤操作数据库</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>loginTest<span class="token punctuation">.</span>mapper<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>loginTest<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>Pool<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>*<span class="token punctuation">;</span>

<span class="token comment">/**
 * 查询用户的Mapper
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> UserMapper userMapper<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UserMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//单例</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> UserMapper <span class="token function">getUserMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> userMapper<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token function">UserMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
    <span class="token comment">//默认数据库中用户名唯一</span>
    <span class="token keyword">public</span> String <span class="token function">getPwdByName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        Connection connection<span class="token operator">=</span> Pool<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            PreparedStatement statement<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">"select pwd from `user` where uname=?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ResultSet rs<span class="token operator">=</span>statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//resultSet初始下标无法访问，要调用next方法后移一位</span>
            rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>这里采用单例的设计模式，保证UserMapper对象只有一个。（非常简陋，实现也不优雅，看着自己的代码，突然感觉框架好方便啊（笑哭））</p> 
<p>这里的作用就是根据用户名查询密码。</p> 
<h4><a id="webxml_430"></a>⑥配置web.xml</h4> 
<p>虽然写了servlet，但是tomcat并不知道你这个servlet的类在哪啊，所以必须让tomcat知道，配置web.xml的目的就是通知tomcat在哪（更准确的说是servlet容器）的一种方式（当然也可以用注解）。<br> 配置如下：</p> 
<pre><code class="prism language-xml"><span class="token doctype">&lt;!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" &gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display-name</span><span class="token punctuation">&gt;</span></span>Archetype Created Web Application<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>display-name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>LoginServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>com.dreamchaser.loginTest.LoginServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>LoginServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/login<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<p>servlet-class里写你这个Servlet类的路径即可。</p> 
<h4><a id="idea_456"></a>⑦idea运行配置</h4> 
<p>idea配置还是比较方便的。</p> 
<p>点击编辑配置，<br> <img src="https://images2.imgbox.com/36/5a/ojQuqktV_o.png" alt="在这里插入图片描述"></p> 
<p>点击+（添加按钮），选择tomcat服务器（选哪个都可以，我选了tomcat本地）<br> <img src="https://images2.imgbox.com/19/68/C1HJI5EE_o.png" alt="在这里插入图片描述"></p> 
<p>然后选择相应的服务器程序，配置项目访问的端口，就是tomcat在哪个端口运行（注意不要占用已有端口，默认8080，我这里是因为8080被占了，所以用了9090）<br> <img src="https://images2.imgbox.com/54/81/O3FlRv8Z_o.png" alt="在这里插入图片描述"></p> 
<p>这里还得配置一下工件，因为项目要运行一般有两种方式：</p> 
<ul><li>一种是打成war包放在tomcat的webapps目录下</li><li>一种是打成jar包直接运行（SpringBoot就是用这种方式，因为它内置tomcat）</li></ul> 
<p><img src="https://images2.imgbox.com/78/ee/NB3le8dj_o.png" alt="在这里插入图片描述"></p> 
<p>这里工件的作用就是打成war包，至于每次运行部署？idea都会帮你搞定！是不是很方便？</p> 
<p>这里那个应用程序上下文的作用就是给访问路径加个前缀<br> <img src="https://images2.imgbox.com/d7/e0/wDYIOvth_o.png" alt="在这里插入图片描述"><br> 一般直接写成"/"就行了，这样我们要访问login.html，只需访问http://localhost:9090/login.html就行了，是不是很方便？</p> 
<h4><a id="_482"></a>⑧运行程序</h4> 
<p>点击运行<br> <img src="https://images2.imgbox.com/2a/cf/6fV6Knxf_o.png" alt="在这里插入图片描述"></p> 
<p>访问localhost:9090/login.html(我因为是在login.html外面放了一个pages包，所以路径是http://localhost:9090/pages/login.html)<br> <img src="https://images2.imgbox.com/57/b4/lIWMi88v_o.png" alt="在这里插入图片描述"></p> 
<p>访问成功，试试账号密码<br> <img src="https://images2.imgbox.com/11/4b/XAb3y4eM_o.png" alt="在这里插入图片描述"></p> 
<p>我现在数据库里只有root这一条数据，试试效果</p> 
<p>输入错误的密码<br> <img src="https://images2.imgbox.com/bc/d5/LyVh1sWJ_o.png" alt="在这里插入图片描述"></p> 
<p>输入正确的密码</p> 
<p><img src="https://images2.imgbox.com/78/26/nAbeqLU9_o.png" alt="在这里插入图片描述"></p> 
<p>到这里，我们松了一口气，终于完成了简单的登录功能。</p> 
<h2><a id="_504"></a>三、回顾</h2> 
<p>别急，我们虽然实现了登录这个功能，但是这个实现是在太简陋了，各方各面都没考虑，返回页面也只登录成功，登录失败的提示。<br> 我们回顾一下，仔细想想有哪些问题。</p> 
<h3><a id="1_508"></a>1.密码未加密裸奔</h3> 
<p>我们在做上面的登录时查询时，密码是查询出来直接比对的，也就是说数据库的密码是明文存储，而注册登录请求中密码都是明文传输，这样做的安全性极低，当黑客破解进入了你的数据库时，你的数据库的账户信息都在“裸奔”，比如前些年的csdn密码泄露事件<br> <img src="https://images2.imgbox.com/8b/fe/06NhVlaR_o.png" alt="在这里插入图片描述"></p> 
<p>如果我们存储在数据库的用户密码是加密过的，那么就算黑客进入了你的数据库，损失也不会像明文存储那样大。</p> 
<h3><a id="2_515"></a>2.登录信息未存储</h3> 
<p>对于这个登录操作，登录成功后并未做其他处理，也就是说每次访问都要登录（如果对请求进行了拦截），或者这个登录操作就是摆设，用户访问其他资源依旧畅通无阻。</p> 
<h3><a id="3_517"></a>3.对于其他资源并未进行权限管理</h3> 
<p>对于其他资源，如果不进行权限管理，那么登录认证便失去了意义，不如做成一个静态网页来的省事。</p> 
<h2><a id="_520"></a>四、优化设计</h2> 
<p>针对上述缺点，我们可以进行以下改进：</p> 
<h3><a id="1_522"></a>1.密码加密存储</h3> 
<p>针对密码未加密裸奔的问题，我们可以选择在注册的时候对密码进行加密，然后存储；对于登录功能，我们对前端传过来的密码进行加密，再根据这个密码去数据库中取数据，这样我们就实现了对密码的加密存储</p> 
<h3><a id="2_525"></a>2.存储登录信息</h3> 
<p>对于登录操作，我们必须记录下此次登录状态，并在该用户继续访问其他资源时予以放行，避免用户多次进行登录操作</p> 
<h3><a id="3_528"></a>3.对资源进行管理</h3> 
<p>对于系统资源我们必须进行管理，在用户没有相应权限时拒绝用户的访问请求，这个可以用过滤器或者SpringBoot的拦截器实现。</p> 
<h2><a id="_531"></a>五、关于鉴权问题</h2> 
<p>在正式讲思路之前，我还是想聊聊鉴权问题。</p> 
<h3><a id="1CookieSession_533"></a>1.Cookie/Session机制</h3> 
<p>关于这个问题我不得不说说cookie/session机制（想了解的具体可以看这篇<a href="https://www.cnblogs.com/l199616j/p/11195667.html" rel="nofollow">cookie和session的详解与区别</a>）。</p> 
<p>总的来说，就是浏览器中有个叫做cookie的东西（其实就是个文件）,它可以用来存储一些信息，每次发送请求时，浏览器会自动把cookie字段信息加在请求头里发送出去<br> <img src="https://images2.imgbox.com/7b/09/UKfKrDbw_o.png" alt="在这里插入图片描述"></p> 
<p>这有什么用呢？</p> 
<p>学过计算机网络的人应该都清楚我们的http请求是无法保存状态的，通俗点来讲就是这次的请求无法知道上次的请求是什么，而这也对一些场景带来的一些不便，就比如说登录，我们就需要保存上次登录的信息。</p> 
<p>可http请求无法保存状态，所以我们必须把一些信息写入到下次的请求里，保证服务器知道之前的关键信息，以便对之后的请求做出特定的操作。</p> 
<p>而cookie便是解决这个问题而出现的，当我们需要存储一些信息（状态），就可以把信息存入cookie，浏览器每次发送请求时都会把cookie放在请求头中（但这个要注意跨域问题，cookie在遇到跨域访问时会失效，不过这个无关此次主题，就不细讲了，感兴趣的自行百度吧）。</p> 
<p><strong>总而言之，cookie就是存储在浏览器（客户端）的数据（文件），每次访问时会带上对应的cookie。</strong></p> 
<p>而session是什么呢？<br> session和cookie类似，也是用来存放信息的，不过它是放在服务器上的。不过呢，session的本质是存在于<strong>服务器内存中的对象</strong>，阅读源码我们可以发现其对应的就是一个ConcurrentMap（线程安全的map容器）</p> 
<p><img src="https://images2.imgbox.com/ca/41/qXUdpBXY_o.png" alt="在这里插入图片描述"></p> 
<p>每一个客户端会对应服务端一个session对象，而如何得到的关键就在于cookie中的JSESSIONID（tomcat默认是这个名字，名称可以变，但用法是一样的），其值便对应这map容器的键，而map的值便是session对象。这样每次用户发送请求来时，服务器就能准确的找到对应的session对象了。<br> <img src="https://images2.imgbox.com/a6/bf/IDjs7ct7_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2CookieSession_559"></a>2.用Cookie/Session解决鉴权问题？</h3> 
<p>明白了Cookie/Session的机制以后，我们不难设计出一套简单的登录方案——登录成功后在对应的session对象中存放User信息并设置失效时间，每次访问资源都看看session中有没有对应user对象，如果有就说明之前登录过了，直接通过即可，否则说明未登录，此时可以跳转至登录页面让用户进行登录。</p> 
<p>这一切看似都很完美，从某种角度上来说确实如此，但它没有缺点吗？</p> 
<h4><a id="CookieSession_564"></a>Cookie/Session机制的缺点</h4> 
<h5><a id="1_565"></a>1.无法解决跨域问题</h5> 
<p>在跨域访问时，cookie会失效，这是为了防止csrf攻击（跨站请求伪造），但对于开发者来说造成了一定的困扰，因为现实中的服务器不可能只有一台，大概率是集群分布，虽然可以用反向代理避免跨域访问，但终究是有局限之处的。</p> 
<h5><a id="2sessioncookie_568"></a>2.session机制依赖于cookie</h5> 
<p>从cookie/session机制中我们不难看出，session的实现依赖于前端的cookie，因为其session的确定必须要前端请求中cookie，没有了cookie，session是无法确定的。</p> 
<p>而这会带来什么问题呢？那就是对于多端访问，如手机App端，其并没有cookie的直接实现（可以实现，其实也就是在请求头中加入cookie字段，但使用此方式并不普遍，也挺麻烦的），如果cookie很难使用，那么session也无法使用。</p> 
<h5><a id="3_573"></a>3.可拓展性不强</h5> 
<p>如果将来搭建了多个服务器，虽然每个服务器都执行的是同样的业务逻辑，但是session数据是保存在内存中的（不是共享的），用户第一次访问的是服务器1，当用户再次请求时可能访问的是另外一台服务器2，服务器2获取不到session信息，就判定用户没有登陆过。</p> 
<p>与此同时，当你使用session的时候你会发现一个很尴尬的事情——你无法直接获取到存放session的map（除非你用反射），这样就导致你的操作受限，比如你想以某个身份强制下线某个用户时，session将会变得力不从心。</p> 
<h5><a id="4_578"></a>4.服务器压力增大</h5> 
<p>session存在于服务器内存中，如果session很多，那么服务器压力便会很大。会频繁触发gc操作，导致服务器响应变慢，吞吐量下降。</p> 
<h5><a id="5_581"></a>5.安全性问题</h5> 
<p>Cookie/Session机制并不是绝对安全，你必须小心应对，当然我接下来说的token方式同样也有这样那样的问题，但是我们要明白一件事情——<strong>没有绝对安全的系统！</strong></p> 
<p>当前的所谓安全措施不过是在<strong>增加黑客入侵系统的成本</strong>，但你要注意的是<strong>你在增加黑客入侵的难度和成本的同时，也同样在增加自己系统的维护成本，它必然是以一定的性能作为代价的</strong>。</p> 
<p>所以<strong>如何权衡安全和性能，这是永远是一件值得我们深思的事情</strong>。</p> 
<h3><a id="3token_588"></a>3.使用token机制解决鉴权问题</h3> 
<p>什么是token呢？</p> 
<p>事实上它只是我们自己实现的一套类似cookie/Session的机制。</p> 
<p>至于为啥叫token？</p> 
<p>你也可以叫它cat，dog之类的，只要你喜欢，随便你怎么取名字（笑哭）。</p> 
<p>好了，开个玩笑，咱们回到正题，在我看来，token只是脱胎于cookie/session的一套机制，它的实现原理几乎是和cookie/session一模一样的（9成像，当然也有很多根据自己业务的变种）。</p> 
<p>如果说cookie/session机制可以描述为下图：</p> 
<p><img src="https://images2.imgbox.com/74/46/XBr46eyI_o.jpg" alt="在这里插入图片描述"></p> 
<p>那么token机制可以描述为以下形式：</p> 
<p><img src="https://images2.imgbox.com/fb/90/fkmhoilX_o.jpg" alt="在这里插入图片描述"></p> 
<p>怎么样？是不是很像？其实它们核心原理是一样的。</p> 
<p>那token机制相较于cookie/session机制有啥好处呢？</p> 
<ul><li>1.可以直接操作token令牌池</li><li>2.对于手机App端友好</li><li>3.跨域问题可以间接解决</li><li>4.对于服务器集群，token令牌池可以放在redis数据库中（当然也可以是其他方案），这样可以实现用户登录状态多服务器共享</li></ul> 
<p>其实，总的来说，就只有一条（笑哭），那就是<strong>灵活</strong>！因为token机制是我们自己实现的（当然也可以借助框架），这样操作这些东西的时候就不必拘泥于条条框框，可以根据自己的业务需求制定适合的鉴权方案。</p> 
<p>悄悄告诉你一句：csdn也是用token的哦！（不过具体实现可能并不一样）<br> <img src="https://images2.imgbox.com/9b/f6/IBz4Esle_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/50/bd/I1j4hJvj_o.png" alt="在这里插入图片描述"></p> 
<p>当然，相较于cookie/session机制而言，它也有个巨大的弊端——在网页应用中，使用token机制会比使用cookie/session机制麻烦很多，所有都得“从头再来”，不像cookie/session可以开箱即用。</p> 
<h2><a id="SpringBootSSM_629"></a>六、用SpringBoot+SSM实现一套简单的鉴权服务（注册，登录，权限控制）</h2> 
<p>这里我是用token来实现鉴权服务的。<br> 以下是我画的大致流程图（可能有点丑，有点乱）<br> <img src="https://images2.imgbox.com/f9/93/WoWFPO31_o.jpg" alt="在这里插入图片描述"></p> 
<p>在展示代码实现时，你可能会对某些类比较疑惑，以下是对这些类的说明：</p> 
<ul><li>RestResponse 这是我用来封装响应格式的，Status用来封装响应状态</li><li>CrudUtil 这是我用来封装CRUD操作的工具类，该类主要为了简化controller的响应操作</li></ul> 
<p>同时我会省略Service层和Dao层实现</p> 
<h3><a id="1_645"></a>1.注册服务</h3> 
<h4><a id="_646"></a>①注册页面</h4> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>zh-CN<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.thymeleaf.org<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>layui<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>renderer<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>webkit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE=edge,chrome=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1, maximum-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/css/public.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/lib/layui-v2.6.3/css/layui.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
        <span class="token selector">body</span> <span class="token punctuation">{<!-- --></span>
            <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url">url("static/images/loginbg.png")</span> 0% 0% / cover no-repeat<span class="token punctuation">;</span>
            <span class="token property">position</span><span class="token punctuation">:</span> static<span class="token punctuation">;</span>
            <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-main layui-card<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fieldset</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-elem-field<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span> 20%</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>legend</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">font-size</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span><span class="token property">padding-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span> center</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>用户注册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>legend</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-field-box<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form layuimini-form<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">margin</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span><span class="token property">margin-top</span><span class="token punctuation">:</span> 30px</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uname<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span> <span class="token attr-name">lay-reqtext</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>用户名不能为空<span class="token punctuation">"</span></span>
                                   <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入用户名<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tip</span><span class="token punctuation">&gt;</span></span>填写自己真实姓名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tip</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>性别<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>男<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>男<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sex<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>女<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>女<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>手机<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>phone<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>phone<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入手机号<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
                                   <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>邮箱<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入邮箱<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
                                   <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pwd<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入密码<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
                                   <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>入职时间<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>entryDate<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请选择入职时间<span class="token punctuation">"</span></span>
                                   <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-label required<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> inline</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>邮箱验证码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>code<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入验证码<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required<span class="token punctuation">"</span></span>
                               <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span>160px<span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span> inline</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>saveBtn<span class="token punctuation">"</span></span> <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>saveBtn<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-btn layui-btn-normal layui-btn-sm<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">
                                <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span><span class="token property">margin-left</span><span class="token punctuation">:</span> 10px</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>发送验证码
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>


                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span> 20px</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input-block<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-btn layui-btn-lg<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 150px</span><span class="token punctuation">"</span></span> <span class="token attr-name">lay-submit</span>
                                    <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>registerBtn<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>注册
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fieldset</span><span class="token punctuation">&gt;</span></span>


    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/lib/layui-v2.6.3/layui.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'form'</span><span class="token punctuation">,</span> <span class="token string">'layer'</span><span class="token punctuation">,</span> <span class="token string">'laydate'</span><span class="token punctuation">,</span><span class="token string">'element'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> form <span class="token operator">=</span> layui<span class="token punctuation">.</span>form<span class="token punctuation">,</span>
            layer <span class="token operator">=</span> layui<span class="token punctuation">.</span>layer<span class="token punctuation">,</span>
            laydate <span class="token operator">=</span> layui<span class="token punctuation">.</span>laydate<span class="token punctuation">,</span>
            element<span class="token operator">=</span>layui<span class="token punctuation">.</span>element<span class="token punctuation">,</span>
            $ <span class="token operator">=</span> layui<span class="token punctuation">.</span>$<span class="token punctuation">;</span>

        <span class="token comment">//日期</span>
        laydate<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            elem<span class="token punctuation">:</span> <span class="token string">'#date'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//监听提交</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#saveBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> email <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#email'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>email<span class="token operator">===</span><span class="token string">''</span><span class="token operator">||</span>email<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"请输入正确的邮箱!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    url<span class="token punctuation">:</span> <span class="token string">"/sendCode"</span><span class="token punctuation">,</span>
                    data<span class="token punctuation">:</span><span class="token string">'{"email":'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'}'</span><span class="token punctuation">,</span>
                    type<span class="token punctuation">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span>
                    dataType<span class="token punctuation">:</span> <span class="token string">'JSON'</span><span class="token punctuation">,</span>
                    contentType<span class="token punctuation">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>
                    success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>statusInfo<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败的表情</span>
                            <span class="token keyword">return</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                            layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"验证码发送成功，请前往邮箱查看"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                                icon<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token comment">//成功的表情</span>
                                time<span class="token punctuation">:</span> <span class="token number">1000</span> <span class="token comment">//1秒关闭（如果不配置，默认是3秒）</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//监听提交</span>
        form<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'submit(registerBtn)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                url<span class="token punctuation">:</span> <span class="token string">"/register"</span><span class="token punctuation">,</span>
                data<span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>field<span class="token punctuation">)</span><span class="token punctuation">,</span>
                type<span class="token punctuation">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span>
                dataType<span class="token punctuation">:</span> <span class="token string">'JSON'</span><span class="token punctuation">,</span>
                contentType<span class="token punctuation">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>
                success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>statusInfo<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败的表情</span>
                        <span class="token keyword">return</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"注册成功"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                            icon<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token comment">//成功的表情</span>
                            time<span class="token punctuation">:</span> <span class="token number">1000</span> <span class="token comment">//1秒关闭（如果不配置，默认是3秒）</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'/login'</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="_816"></a>②发送验证码</h4> 
<h5><a id="sendcode_817"></a>sendcode接口</h5> 
<pre><code class="prism language-java"><span class="token comment">/**
     * 验证是否有此账号，然后发送验证码
     * @param map 主要认证主体，如账号，邮箱，qq的openID，wechat的code等
     * @return restResponse，附带凭证token
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/sendCode"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> RestResponse <span class="token function">sendCode</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>Object<span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">findUserByCondition</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            String principal<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"phone"</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                principal<span class="token operator">=</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"phone"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                principal<span class="token operator">=</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> CrudUtil<span class="token punctuation">.</span>ID_MISS_RESPONSE<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//创建一个验证码</span>
            VerificationCode v<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">VerificationCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//将验证码存入验证码等待池</span>
            VerificationCodePool<span class="token punctuation">.</span><span class="token function">addCode</span><span class="token punctuation">(</span>principal<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//发送邮箱验证码</span>
            <span class="token function">sendEmail</span><span class="token punctuation">(</span>principal<span class="token punctuation">,</span>v<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestResponse</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token number">304</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">StatusInfo</span><span class="token punctuation">(</span><span class="token string">"发送验证码失败，该账户已存在！"</span><span class="token punctuation">,</span><span class="token string">"发送验证码失败，该账户已存在！"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h5><a id="SpringBootmail_848"></a>邮件发送方法（调用SpringBoot提供的mail服务（需要导包））</h5> 
<pre><code class="prism language-java"><span class="token comment">/**
     * 发送带有验证码的邮件信息
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sendEmail</span><span class="token punctuation">(</span>String email<span class="token punctuation">,</span>String code<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//发送验证邮件</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            SimpleMailMessage mailMessage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleMailMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//主题</span>
            mailMessage<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"仓库管理系统的验证码邮件"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//内容</span>
            mailMessage<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"欢迎使用仓库管理系统，您正在注册此账户。"</span> <span class="token operator">+</span>
                    <span class="token string">"\n您收到的验证码是： "</span><span class="token operator">+</span>code<span class="token operator">+</span><span class="token string">" ，请不要将此验证码透露给别人。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//发送的邮箱地址</span>
            mailMessage<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//默认发送邮箱邮箱</span>
            mailMessage<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>fromEmail<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//发送</span>
            mailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mailMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_878"></a>验证码对象</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>bean<span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>Instant<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Random<span class="token punctuation">;</span>

<span class="token comment">/**
 * 验证码，默认有效期为五分钟
 * @author 金昊霖
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VerificationCode</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 默认持续时间
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">long</span> DEFAULT_TERM<span class="token operator">=</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 验证码
     */</span>
    <span class="token keyword">private</span> String code<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 创建时刻
     */</span>
    <span class="token keyword">private</span> Instant instant<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 有效期
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> term<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 根据时间判断是否有效
     * @return boolean值
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> Instant<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEpochSecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>instant<span class="token punctuation">.</span><span class="token function">getEpochSecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>term<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">VerificationCode</span><span class="token punctuation">(</span>Instant instant<span class="token punctuation">,</span> <span class="token keyword">long</span> term<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//生成随机验证码code</span>
        <span class="token function">generateCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant <span class="token operator">=</span> instant<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term <span class="token operator">=</span> term<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token function">VerificationCode</span><span class="token punctuation">(</span>Instant instant<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//生成随机验证码code</span>
        <span class="token function">generateCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant <span class="token operator">=</span> instant<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term<span class="token operator">=</span>DEFAULT_TERM<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">VerificationCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//生成随机验证码code</span>
        <span class="token function">generateCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant<span class="token operator">=</span>Instant<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term<span class="token operator">=</span>DEFAULT_TERM<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">generateCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        StringBuilder codeNum <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> numbers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        Random random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//目的是产生足够随机的数，避免产生的数字重复率高的问题</span>
            <span class="token keyword">int</span> next <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            codeNum<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>numbers<span class="token punctuation">[</span>next <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code<span class="token operator">=</span> codeNum<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="_958"></a>验证码池</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>pool<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>bean<span class="token punctuation">.</span>VerificationCode<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ConcurrentHashMap<span class="token punctuation">;</span>

<span class="token comment">/**
 * 验证码等待池
 * @author 金昊霖
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VerificationCodePool</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> VerificationCode<span class="token punctuation">&gt;</span></span> pool<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 增加一条验证码
     * @param principal 主要内容，如邮箱，电话号码等
     * @param verificationCode 验证码
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addCode</span><span class="token punctuation">(</span>String principal<span class="token punctuation">,</span>VerificationCode verificationCode<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>principal<span class="token punctuation">,</span> verificationCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据principal主要信息获取未过期的验证码，如果没有未过期的令牌则返回null
     * @param principal 主要内容，如邮箱，电话号码等
     * @return verificationCode 未过期的验证码或者null
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> VerificationCode <span class="token function">getCode</span><span class="token punctuation">(</span>String principal<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        VerificationCode verificationCode<span class="token operator">=</span>pool<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>principal<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//如果没有相应验证码则直接返回null</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>verificationCode<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//判断令牌是否过期</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>verificationCode<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//将验证码取出</span>
            pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>principal<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> verificationCode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//清除过期验证码</span>
            pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>principal<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据主要信息principal删除对应的验证码
     * @param principal 主要信息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">removeCode</span><span class="token punctuation">(</span>String principal<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>principal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1020"></a>③注册用户</h4> 
<h5><a id="MD5_1021"></a>MD5加密类</h5> 
<pre><code class="prism language-java">	<span class="token comment">/*
	 * Copyright (c) JForum Team All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1) Redistributions of
	 * source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2) Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
	 * following disclaimer in the documentation and/or other materials provided with the distribution. 3) Neither the name of "Rafael Steil" nor the names of its contributors may be used to endorse or promote products
	 * derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
	 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
	 * OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
	 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE This file creation date: Mar 29, 2003 /
	 * 1:15:50 AM The JForum Project http://www.jforum.net
	 */</span>
	<span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>utils<span class="token punctuation">;</span>
	
	<span class="token keyword">import</span> java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>MessageDigest<span class="token punctuation">;</span>
	<span class="token keyword">import</span> java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>NoSuchAlgorithmException<span class="token punctuation">;</span>
	
	<span class="token comment">/**
	 * MD5加密
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Md5</span> <span class="token punctuation">{<!-- --></span>
	
		<span class="token comment">/**
		 * Encodes a string
		 * @param str String to encode
		 * @return Encoded String
		 */</span>
		<span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">crypt</span><span class="token punctuation">(</span>String str<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> null <span class="token operator">||</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"String to encript cannot be null or zero length"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			StringBuilder hexString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				MessageDigest md <span class="token operator">=</span> MessageDigest<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"MD5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				md<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hash <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">byte</span> b <span class="token operator">:</span> hash<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0xff</span> <span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0x10</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						hexString<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>Integer<span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0xFF</span> <span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
						hexString<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>Integer<span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token number">0xFF</span> <span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchAlgorithmException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> hexString<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	
	<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="_1075"></a>注册用户接口</h5> 
<pre><code class="prism language-java"><span class="token comment">/**
     * 注册用户（通常为手机或者邮箱注册）
     * @param map 参数列表，包括账号（手机注册就是phone，邮箱就是email）、密码
     * @return 成功则返回凭证，否则返回验证失败
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/register"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> RestResponse <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>Object<span class="token punctuation">&gt;</span></span>map<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        String principal<span class="token punctuation">;</span>
        Object password<span class="token operator">=</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Object code<span class="token operator">=</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        UserToken userToken<span class="token punctuation">;</span>
        <span class="token comment">//判断必要参数是否满足</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>password<span class="token operator">==</span>null<span class="token operator">||</span>code<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> CrudUtil<span class="token punctuation">.</span>ID_MISS_RESPONSE<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//从map中获取对应参数</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            principal<span class="token operator">=</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            userToken<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UserToken</span><span class="token punctuation">(</span>LoginType<span class="token punctuation">.</span>EMAIl_PASSWORD<span class="token punctuation">,</span>principal<span class="token punctuation">,</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> CrudUtil<span class="token punctuation">.</span>ID_MISS_RESPONSE<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//验证码正确且成功插入数据</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">checkCode</span><span class="token punctuation">(</span>principal<span class="token punctuation">,</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//对密码进行加密然后存储用户信息</span>
            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">,</span>Md5<span class="token punctuation">.</span><span class="token function">crypt</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//如果用户记录插入成功</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">insertUser</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                String token<span class="token operator">=</span> Md5<span class="token punctuation">.</span><span class="token function">crypt</span><span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>userToken<span class="token punctuation">.</span><span class="token function">getInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//返回凭证</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//验证码错误</span>
            <span class="token keyword">return</span> CrudUtil<span class="token punctuation">.</span>CODE_ERROR<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> 
</code></pre> 
<p>这里的LoginType是登录方式，这个之后会提到</p> 
<h5><a id="_1120"></a>检验验证码方法</h5> 
<pre><code class="prism language-java"><span class="token comment">/**
     * 用于注册用户的方法，主要为号码验证和邮箱验证提供验证码核对的服务
     * @param principal 认证主体
     * @param code 验证码
     * @return 是否验证通过
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">checkCode</span><span class="token punctuation">(</span>String principal<span class="token punctuation">,</span>String code<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            VerificationCode verificationCode<span class="token operator">=</span>VerificationCodePool<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span>principal<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>verificationCode<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> code<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>verificationCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="2_1140"></a>2.登录服务</h3> 
<h4><a id="_1141"></a>登录界面</h4> 
<p>这里为了方便起见，我把token存储在cookie中</p> 
<pre><code class="prism language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>zh-CN<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.thymeleaf.org<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>后台管理-登陆<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>IE=edge,chrome=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Access-Control-Allow-Origin<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>*<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1, maximum-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>apple-mobile-web-app-status-bar-style<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>black<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>apple-mobile-web-app-capable<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>yes<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>format-detection<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>telephone=no<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/lib/layui-v2.6.3/css/layui.css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--[if lt IE 9]&gt;
    &lt;script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;
    &lt;![endif]--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style language-css">
        <span class="token selector">html, body</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">}</span>
        <span class="token selector">body</span> <span class="token punctuation">{<!-- --></span><span class="token property">background</span><span class="token punctuation">:</span> #1E9FFF<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">body:after</span> <span class="token punctuation">{<!-- --></span><span class="token property">content</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">;</span><span class="token property">background-repeat</span><span class="token punctuation">:</span>no-repeat<span class="token punctuation">;</span><span class="token property">background-size</span><span class="token punctuation">:</span>cover<span class="token punctuation">;</span><span class="token property">-webkit-filter</span><span class="token punctuation">:</span><span class="token function">blur</span><span class="token punctuation">(</span>3px<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-moz-filter</span><span class="token punctuation">:</span><span class="token function">blur</span><span class="token punctuation">(</span>3px<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-o-filter</span><span class="token punctuation">:</span><span class="token function">blur</span><span class="token punctuation">(</span>3px<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">-ms-filter</span><span class="token punctuation">:</span><span class="token function">blur</span><span class="token punctuation">(</span>3px<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">filter</span><span class="token punctuation">:</span><span class="token function">blur</span><span class="token punctuation">(</span>3px<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">right</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">bottom</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span><span class="token property">z-index</span><span class="token punctuation">:</span>-1<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.layui-container</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span><span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">}</span>
        <span class="token selector">.admin-login-background</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>360px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>300px<span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>40%<span class="token punctuation">;</span><span class="token property">margin-left</span><span class="token punctuation">:</span>-180px<span class="token punctuation">;</span><span class="token property">margin-top</span><span class="token punctuation">:</span>-100px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.logo-title</span> <span class="token punctuation">{<!-- --></span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">letter-spacing</span><span class="token punctuation">:</span>2px<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>14px 0<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.logo-title h1</span> <span class="token punctuation">{<!-- --></span><span class="token property">color</span><span class="token punctuation">:</span>#1E9FFF<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>25px<span class="token punctuation">;</span><span class="token property">font-weight</span><span class="token punctuation">:</span>bold<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-form</span> <span class="token punctuation">{<!-- --></span><span class="token property">background-color</span><span class="token punctuation">:</span>#fff<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>1px solid #fff<span class="token punctuation">;</span><span class="token property">border-radius</span><span class="token punctuation">:</span>3px<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>14px 20px<span class="token punctuation">;</span><span class="token property">box-shadow</span><span class="token punctuation">:</span>0 0 8px #eeeeee<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-form .layui-form-item</span> <span class="token punctuation">{<!-- --></span><span class="token property">position</span><span class="token punctuation">:</span>relative<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-form .layui-form-item label</span> <span class="token punctuation">{<!-- --></span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span><span class="token property">left</span><span class="token punctuation">:</span>1px<span class="token punctuation">;</span><span class="token property">top</span><span class="token punctuation">:</span>1px<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>38px<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>36px<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token property">color</span><span class="token punctuation">:</span>#d2d2d2<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.login-form .layui-form-item input</span> <span class="token punctuation">{<!-- --></span><span class="token property">padding-left</span><span class="token punctuation">:</span>36px<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.captcha</span> <span class="token punctuation">{<!-- --></span><span class="token property">width</span><span class="token punctuation">:</span>60%<span class="token punctuation">;</span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.captcha-img</span> <span class="token punctuation">{<!-- --></span><span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>34%<span class="token punctuation">;</span><span class="token property">float</span><span class="token punctuation">:</span>right<span class="token punctuation">;</span><span class="token punctuation">}</span>
        <span class="token selector">.captcha-img img</span> <span class="token punctuation">{<!-- --></span><span class="token property">height</span><span class="token punctuation">:</span>34px<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span>1px solid #e6e6e6<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>36px<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token punctuation">}</span>
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>admin-login-background<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form login-form<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item logo-title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>仓库信息管理系统登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-icon layui-icon-username<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>principal<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required|account<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入邮箱<span class="token punctuation">"</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-icon layui-icon-password<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>credentials<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required|password<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>密码<span class="token punctuation">"</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!-- 徒有其表的验证码，主要是不想另外弄了 --&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-icon layui-icon-vercode<span class="token punctuation">"</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>captcha<span class="token punctuation">"</span></span> <span class="token attr-name">lay-verify</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>required|captcha<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>图形验证码<span class="token punctuation">"</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>off<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-input verification captcha<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>captcha-img<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>captchaPic<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/images/captcha.jpg<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rememberMe<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">lay-skin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>记住密码<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-form-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>layui-btn layui-btn layui-btn-normal layui-btn-fluid<span class="token punctuation">"</span></span> <span class="token attr-name">lay-submit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">lay-filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>登 入<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/lib/jquery-3.4.1/jquery-3.4.1.min.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/lib/layui-v2.6.3/layui.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/lib/jq-module/jquery.particleground.min.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>static/js/cookie.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    layui<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'layer'</span><span class="token punctuation">,</span><span class="token string">'form'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> form <span class="token operator">=</span> layui<span class="token punctuation">.</span>form<span class="token punctuation">,</span>
            layer <span class="token operator">=</span> layui<span class="token punctuation">.</span>layer<span class="token punctuation">;</span>


        <span class="token comment">// 登录过期的时候，跳出ifram框架</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>top<span class="token punctuation">.</span>location <span class="token operator">!=</span> self<span class="token punctuation">.</span>location<span class="token punctuation">)</span> top<span class="token punctuation">.</span>location <span class="token operator">=</span> self<span class="token punctuation">.</span>location<span class="token punctuation">;</span>

        <span class="token comment">// 粒子线条背景</span>
        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.layui-container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">particleground</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                dotColor<span class="token punctuation">:</span><span class="token string">'#7ec7fd'</span><span class="token punctuation">,</span>
                lineColor<span class="token punctuation">:</span><span class="token string">'#7ec7fd'</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 进行登录操作</span>
        form<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'submit(login)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            data <span class="token operator">=</span> data<span class="token punctuation">.</span>field<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>principal <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">'用户名不能为空'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>credentials <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">'密码不能为空'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>captcha <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">'验证码不能为空'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            data<span class="token punctuation">.</span>loginType<span class="token operator">=</span><span class="token string">"email"</span><span class="token punctuation">;</span>
            $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                url<span class="token punctuation">:</span><span class="token string">"/login"</span><span class="token punctuation">,</span>
                type<span class="token punctuation">:</span><span class="token string">'post'</span><span class="token punctuation">,</span>
                dataType<span class="token punctuation">:</span><span class="token string">'json'</span><span class="token punctuation">,</span>
                contentType<span class="token punctuation">:</span> <span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">,</span>
                data<span class="token punctuation">:</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
                beforeSend<span class="token punctuation">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>layerIndex <span class="token operator">=</span> layer<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> shade<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">'#393D49'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                success<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>statusInfo<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失败的表情</span>
                        <span class="token keyword">return</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                        layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">"登录成功"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                            icon<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token comment">//成功的表情</span>
                            time<span class="token punctuation">:</span> <span class="token number">1000</span> <span class="token comment">//1秒关闭（如果不配置，默认是3秒）</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                            cookieUtil<span class="token punctuation">.</span><span class="token function">createCookie</span><span class="token punctuation">(</span><span class="token string">"token"</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
                            window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'/index'</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                complete<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    layer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>当然这里封装了cookie的操作</p> 
<pre><code class="prism language-js"><span class="token keyword">var</span> cookieUtil<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    createCookie<span class="token punctuation">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>value<span class="token punctuation">,</span>days<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> expires<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>days<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> date<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            date<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>days<span class="token operator">*</span><span class="token number">14</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">3600</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            expires<span class="token operator">=</span><span class="token string">";expires="</span><span class="token operator">+</span>date<span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        document<span class="token punctuation">.</span>cookie<span class="token operator">=</span>name<span class="token operator">+</span><span class="token string">"="</span><span class="token operator">+</span>value<span class="token operator">+</span>expires<span class="token operator">+</span><span class="token string">";path=/"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/*设置cookie*/</span>
    <span class="token keyword">set</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>value<span class="token punctuation">,</span>expires<span class="token punctuation">,</span>path<span class="token punctuation">,</span>domain<span class="token punctuation">,</span>secure<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> cookie<span class="token operator">=</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"="</span><span class="token operator">+</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>expires <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            cookie<span class="token operator">+=</span><span class="token string">"; expires="</span><span class="token operator">+</span>expires<span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> date<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            date<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>expires<span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">3600</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cookie<span class="token operator">+=</span><span class="token string">"; expires="</span><span class="token operator">+</span>date<span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            cookie<span class="token operator">+=</span><span class="token string">"; path="</span><span class="token operator">+</span>path<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            cookie<span class="token operator">+=</span><span class="token string">"; domain="</span><span class="token operator">+</span>domain<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>secure<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            cookie<span class="token operator">+=</span><span class="token string">"; "</span><span class="token operator">+</span>secure<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        document<span class="token punctuation">.</span>cookie<span class="token operator">=</span>cookie<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">/*获取cookie*/</span>
    <span class="token keyword">get</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> cookieName<span class="token operator">=</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/*正则表达式获取cookie*/</span>
        <span class="token keyword">var</span> restr<span class="token operator">=</span><span class="token string">"(^| )"</span><span class="token operator">+</span>cookieName<span class="token operator">+</span><span class="token string">"=([^;]*)(;|$)"</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> reg<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>restr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> cookieValue<span class="token operator">=</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">/*字符串截取cookie*/</span>
        <span class="token comment">/*var cookieStart=document.cookie.indexOf(cookieName+“=”);
        var cookieValue=null;
        if(cookieStart&gt;-1){
            var cookieEnd=document.cookie.indexOf(";",cookieStart);
            if(cookieEnd==-1){
                cookieEnd=document.cookie.length;
            }
            cookieValue=decodeURIComponent(document.cookie.substring(cookieStart
            +cookieName.length,cookieEnd));
        }*/</span>
        <span class="token keyword">return</span> cookieValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1343"></a>登录接口</h4> 
<p>这里的token凭证是根据用户密码+当前时刻（盐）加密得到的</p> 
<pre><code class="prism language-java"><span class="token comment">/**
     * 登录接口
     * @param map 登录信息
     *  loginType 登录方式，目前支持的有email,qq,wechat
     *  principal 主要认证主体，如账号，邮箱，qq的openID，wechat的code等
     *  credentials 类似于密码，如果是qq，wechat则不需要传改参数
     *  restResponse，附带凭证token
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> RestResponse <span class="token function">login</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span>String<span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        UserToken userToken<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">UserToken</span><span class="token punctuation">(</span>LoginType<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"loginType"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"principal"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"credentials"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">login</span><span class="token punctuation">(</span>userToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1363"></a>认证方法</h4> 
<pre><code class="prism language-java"><span class="token comment">/**
     * 将生成的令牌拿去认证，如果认证成功则返回带有token凭证响应，否则返回用户密码错误的响应
     * @param userToken 未认证的令牌
     * @return restResponse 如果认证成功则返回带有token凭证响应，否则返回用户密码错误的响应
     */</span>
    <span class="token keyword">private</span> RestResponse <span class="token function">login</span><span class="token punctuation">(</span>UserToken userToken<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        String token<span class="token operator">=</span>loginRealms<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span>userToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestResponse</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> CrudUtil<span class="token punctuation">.</span>NOT_EXIST_USER_OR_ERROR_PWD_RESPONSE<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre> 
<h4><a id="enum_1381"></a>登录方式enum类</h4> 
<p>这里可以看到我里面有多种方式登录，不过我的代码里只实现了邮箱登录，其余方式可以自己去实现拓展</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>bean<span class="token punctuation">;</span>

<span class="token comment">/**
 * 登录方式枚举类
 * @author 金昊霖
 */</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> LoginType <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 通用
     */</span>
    <span class="token function">COMMON</span><span class="token punctuation">(</span><span class="token string">"common_realm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * 用户密码登录
     */</span>
    <span class="token function">EMAIl_PASSWORD</span><span class="token punctuation">(</span><span class="token string">"user_password_realm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * 手机验证码登录
     */</span>
    <span class="token function">USER_PHONE</span><span class="token punctuation">(</span><span class="token string">"user_phone_realm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * 第三方登录(微信登录)
     */</span>
    <span class="token function">WECHAT_LOGIN</span><span class="token punctuation">(</span><span class="token string">"wechat_login_realm"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">/**
     * 第三方登录(qq登录)
     */</span>
    <span class="token function">QQ_LOGIN</span><span class="token punctuation">(</span><span class="token string">"qq_login_realm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">private</span> String type<span class="token punctuation">;</span>

    <span class="token function">LoginType</span><span class="token punctuation">(</span>String type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据简单的字符串返回对应的LoginType
     * @param s 简单的字符串
     * @return 对应的LoginType
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> LoginType <span class="token function">getType</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token string">"email"</span><span class="token operator">:</span>
                <span class="token keyword">return</span> EMAIl_PASSWORD<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"qq"</span><span class="token operator">:</span>
                <span class="token keyword">return</span> QQ_LOGIN<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"wechat"</span><span class="token operator">:</span>
                <span class="token keyword">return</span> WECHAT_LOGIN<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"phone"</span><span class="token operator">:</span>
                <span class="token keyword">return</span> USER_PHONE<span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1454"></a>登录方式类</h4> 
<p>这里面可以根据自己的业务拓展，我只实现了邮箱登录</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>bean<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>exception<span class="token punctuation">.</span>MyException<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>AuthenticationTokenPool<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>service<span class="token punctuation">.</span>UserService<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>Md5<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span>

<span class="token comment">/**
 * 内置多种登录方式，和shiro中的realm类似
 * @author 金昊霖
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginRealms</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> UserService userService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 认证，如果认证成功则返回凭证，否则返回null
     * @param userToken 未认证的令牌
     * @return 如果认证成功则返回凭证，否则返回null
     */</span>
    <span class="token keyword">public</span> String <span class="token function">authenticate</span><span class="token punctuation">(</span>UserToken userToken<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//对密码加密</span>
            userToken<span class="token punctuation">.</span><span class="token function">setCredentials</span><span class="token punctuation">(</span>Md5<span class="token punctuation">.</span><span class="token function">crypt</span><span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getLoginType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>LoginType<span class="token punctuation">.</span>EMAIl_PASSWORD<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">handle</span><span class="token punctuation">(</span>userToken<span class="token punctuation">,</span><span class="token function">emailLogin</span><span class="token punctuation">(</span>userToken<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//else if (其他登录方式...)</span>
        <span class="token comment">//如果无匹配的认证方式则视为验证失败</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 邮箱登录方式
     * @param userToken 令牌
     * @return 认证成功返回SimpleUser
     */</span>
    <span class="token keyword">private</span> User <span class="token function">emailLogin</span><span class="token punctuation">(</span>UserToken userToken<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">findUserByEmail</span><span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据传入的user是否为null（是否认证通过）来对令牌做剩下的操作（将user刻入令牌，并将该令牌放入令牌池中）
     * @param userToken 经过验证后的令牌
     * @return token 根据令牌生成的凭证 ，如果认证未成功则返回null
     */</span>
    <span class="token keyword">private</span> String <span class="token function">handle</span><span class="token punctuation">(</span>UserToken userToken<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//说明账户不存在</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token number">409</span><span class="token punctuation">,</span><span class="token string">"该用户不存在，请注册后再登录！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//判断密码是否正确</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getPwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//将User信息刻入令牌</span>
            userToken<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//获取token凭证</span>
            String token<span class="token operator">=</span>Md5<span class="token punctuation">.</span><span class="token function">crypt</span><span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>userToken<span class="token punctuation">.</span><span class="token function">getInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//将令牌放入认证令牌池</span>
            AuthenticationTokenPool<span class="token punctuation">.</span><span class="token function">addToken</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span>userToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> token<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1530"></a>认证令牌类</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>bean<span class="token punctuation">;</span>


<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">;</span>
<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>Instant<span class="token punctuation">;</span>


<span class="token comment">/**
 * 登录令牌，默认有效期为7天
 * @author 金昊霖
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserToken</span><span class="token punctuation">{<!-- --></span>

    <span class="token keyword">final</span> <span class="token keyword">long</span> DEFAULT_TERM<span class="token operator">=</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 登录方式
     */</span>
    <span class="token keyword">private</span> LoginType loginType<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 微信、qq的code，邮箱，或者用户名之类的
     */</span>
    <span class="token keyword">private</span> String principal<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 相当于密码（一般是加密过的）
     */</span>
    <span class="token keyword">private</span> String credentials<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 放入的时间
     */</span>
    <span class="token keyword">private</span> Instant instant<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 有效期(单位：秒)
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> term<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 可以放一些不敏感的信息,以便下次访问时可以直接取出，如果user属性太多可以另外写个类，比如SimpleUser，
     * 存放一些经常需要用到的信息。
     */</span>
    <span class="token keyword">private</span> User User<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 根据时间判断是否有效
     * @return 有效则返回true，否则返回false
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> Instant<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEpochSecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>instant<span class="token punctuation">.</span><span class="token function">getEpochSecond</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>term<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">UserToken</span><span class="token punctuation">(</span>LoginType loginType<span class="token punctuation">,</span> String principal<span class="token punctuation">,</span> String credentials<span class="token punctuation">,</span> Instant instant<span class="token punctuation">,</span> <span class="token keyword">long</span> term<span class="token punctuation">,</span> User user<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loginType <span class="token operator">=</span> loginType<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>principal <span class="token operator">=</span> principal<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>credentials <span class="token operator">=</span> credentials<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant <span class="token operator">=</span> instant<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term <span class="token operator">=</span> term<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>User <span class="token operator">=</span> user<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">UserToken</span><span class="token punctuation">(</span>LoginType loginType<span class="token punctuation">,</span> String principal<span class="token punctuation">,</span> String credentials<span class="token punctuation">,</span> Instant instant<span class="token punctuation">,</span> <span class="token keyword">long</span> term<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loginType <span class="token operator">=</span> loginType<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>principal <span class="token operator">=</span> principal<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>credentials <span class="token operator">=</span> credentials<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant <span class="token operator">=</span> instant<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term <span class="token operator">=</span> term<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">UserToken</span><span class="token punctuation">(</span>LoginType loginType<span class="token punctuation">,</span> String principal<span class="token punctuation">,</span> String credentials<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loginType <span class="token operator">=</span> loginType<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>principal <span class="token operator">=</span> principal<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>credentials <span class="token operator">=</span> credentials<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant <span class="token operator">=</span> Instant<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term<span class="token operator">=</span>DEFAULT_TERM<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">UserToken</span><span class="token punctuation">(</span>LoginType loginType<span class="token punctuation">,</span> String principal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loginType <span class="token operator">=</span> loginType<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>principal <span class="token operator">=</span> principal<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instant<span class="token operator">=</span>Instant<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>term<span class="token operator">=</span>DEFAULT_TERM<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_1623"></a>认证令牌池</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>pool<span class="token punctuation">;</span>


<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>bean<span class="token punctuation">.</span>UserToken<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>ConcurrentHashMap<span class="token punctuation">;</span>

<span class="token comment">/**
 * 认证后的令牌连接池（由于获取全局的session比较麻烦，所以自己维护一个类似session的令牌池）
 * @author 金昊霖
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthenticationTokenPool</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 认证后的令牌连接池
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">,</span> UserToken<span class="token punctuation">&gt;</span></span> pool<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">addToken</span><span class="token punctuation">(</span>String token<span class="token punctuation">,</span>UserToken userToken<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> userToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据token凭证获取未过期的令牌，如果没有未过期的令牌则返回null
     * @param token 凭证
     * @return userToken 未过期的令牌
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> UserToken <span class="token function">getToken</span><span class="token punctuation">(</span>String token<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        UserToken userToken<span class="token operator">=</span>pool<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//如果没有相应令牌则直接返回null</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userToken<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//判断令牌是否过期</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userToken<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> userToken<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//清除过期令牌</span>
            pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据凭证删除对应的令牌
     * @param token 凭证
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">removeToken</span><span class="token punctuation">(</span>String token<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="3_1682"></a>3.权限控制（拦截器）</h3> 
<p>由于大作业的规模也没这么大，权限并没有划分很细，所以这里我只做了鉴权的操作，如果需要对不同资源采取不同的权限控制，我的方案是写多个拦截器，同时对于不同权限资源路径加上不同的前缀以便区分控制。（这块我并未细想，可能还有更好的方案，日后补充吧）</p> 
<h4><a id="UserInterceptor_1684"></a>拦截器UserInterceptor</h4> 
<p>其实登出的操作也在这里做了，相对应的logout方法只是返回响应而已（笑哭）</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>intercepter<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>exception<span class="token punctuation">.</span>MyException<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>security<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>AuthenticationTokenPool<span class="token punctuation">;</span>
<span class="token keyword">import</span> lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>Slf4j<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Component<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>handler<span class="token punctuation">.</span>HandlerInterceptorAdapter<span class="token punctuation">;</span>

<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>Cookie<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletRequest<span class="token punctuation">;</span>
<span class="token keyword">import</span> javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpServletResponse<span class="token punctuation">;</span>

<span class="token comment">/**
 * 认证拦截器，如果请求头中有相应凭证则放行，否则拦截返回认证失效错误
 * @author 金昊霖
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInterceptor</span> <span class="token keyword">extends</span> <span class="token class-name">HandlerInterceptorAdapter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span>
                             HttpServletResponse response<span class="token punctuation">,</span> Object handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> MyException <span class="token punctuation">{<!-- --></span>

        <span class="token comment">//拿到requset中的head</span>
        String token <span class="token operator">=</span>null<span class="token punctuation">;</span>
        Cookie<span class="token punctuation">[</span><span class="token punctuation">]</span> cookies<span class="token operator">=</span>request<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>Cookie c<span class="token operator">:</span>cookies<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"token"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                token<span class="token operator">=</span>c<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">,</span><span class="token string">"未授权,请重新登录！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//如果是访问logout则删除对应的令牌</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getServletPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            AuthenticationTokenPool<span class="token punctuation">.</span><span class="token function">removeToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>AuthenticationTokenPool<span class="token punctuation">.</span><span class="token function">getToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">MyException</span><span class="token punctuation">(</span><span class="token number">407</span><span class="token punctuation">,</span><span class="token string">"认证失效，请重新登录!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="MVC_1741"></a>MVC配置类</h4> 
<p>注意过滤掉注册，登录，登出的接口</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dreamchaser<span class="token punctuation">.</span>depository_manage<span class="token punctuation">.</span>intercepter<span class="token punctuation">.</span>UserInterceptor<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>InterceptorRegistry<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>WebMvcConfigurer<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebMvcConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span>InterceptorRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UserInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> <span class="token string">"/register"</span><span class="token punctuation">,</span> <span class="token string">"/sendCode"</span><span class="token punctuation">,</span> <span class="token string">"/error"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/static/**"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//    private static final String[] CLASSPATH_RESOURCE_LOCATIONS = {<!-- --></span>
<span class="token operator">/</span><span class="token operator">/</span>            <span class="token string">"classpath:/META-INF/resources/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/resources/"</span><span class="token punctuation">,</span>
<span class="token operator">/</span><span class="token operator">/</span>            <span class="token string">"classpath:/static/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/public/"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">/</span><span class="token operator">/</span>    <span class="token annotation punctuation">@Override</span>
<span class="token operator">/</span><span class="token operator">/</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addResourceHandlers</span><span class="token punctuation">(</span>ResourceHandlerRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">/</span><span class="token operator">/</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>registry<span class="token punctuation">.</span><span class="token function">hasMappingForPattern</span><span class="token punctuation">(</span><span class="token string">"/webjars/**"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//            registry.addResourceHandler("/webjars/**").addResourceLocations(</span>
<span class="token operator">/</span><span class="token operator">/</span>                    <span class="token string">"classpath:/META-INF/resources/webjars/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">/</span><span class="token operator">/</span>        <span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">/</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>registry<span class="token punctuation">.</span><span class="token function">hasMappingForPattern</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">/</span><span class="token operator">/</span>            registry<span class="token punctuation">.</span><span class="token function">addResourceHandler</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addResourceLocations</span><span class="token punctuation">(</span>
<span class="token operator">/</span><span class="token operator">/</span>                    CLASSPATH_RESOURCE_LOCATIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">/</span><span class="token operator">/</span>        <span class="token punctuation">}</span>
<span class="token operator">/</span><span class="token operator">/</span>
<span class="token operator">/</span><span class="token operator">/</span>    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre> 
<h2><a id="_1784"></a>七、效果展示</h2> 
<h3><a id="1_1785"></a>1.注册</h3> 
<p><img src="https://images2.imgbox.com/69/25/GSa6NS0R_o.png" alt="在这里插入图片描述"></p> 
<p>发送验证码</p> 
<p><img src="https://images2.imgbox.com/81/0a/bGuRyvVB_o.png" alt="在这里插入图片描述"></p> 
<p>注册成功</p> 
<p><img src="https://images2.imgbox.com/70/8b/pc0RJfzb_o.png" alt="在这里插入图片描述"></p> 
<p>数据库新增一条记录，并且密码加密存储<br> <img src="https://images2.imgbox.com/33/ac/2dYiYUFO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_1800"></a>2.登录</h3> 
<p><img src="https://images2.imgbox.com/70/f0/Ud0u129N_o.png" alt="在这里插入图片描述"></p> 
<p>输入错误的密码<br> <img src="https://images2.imgbox.com/95/8a/5RKrRD3t_o.png" alt="在这里插入图片描述"></p> 
<p>输入正确的密码<br> <img src="https://images2.imgbox.com/c3/3a/jxJkN7UV_o.png" alt="在这里插入图片描述"></p> 
<p>同时跳转至首页<br> <img src="https://images2.imgbox.com/8b/d8/ZIb9iZHR_o.png" alt="在这里插入图片描述"></p> 
<p>这里为了方便起见，我把token存储在cookie中，看看cookie信息<br> <img src="https://images2.imgbox.com/b4/44/DPu5UWoi_o.png" alt="在这里插入图片描述"></p> 
<p>可以看到cookie中已经有token凭证</p> 
<h3><a id="3_1821"></a>3.访问其他资源</h3> 
<p>未登录访问<br> <img src="https://images2.imgbox.com/f2/76/KThTyyEq_o.png" alt="在这里插入图片描述"></p> 
<p>登录后访问<br> <img src="https://images2.imgbox.com/fc/63/qZqC64ww_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_1831"></a>写在最后</h2> 
<p>说实话，写这篇博文花了我不少时间，光写博文都花了两个晚上，更别说自己实际去操作去找资料了。别看我现在讲的头头是道的，当初我为了解决这个问题可花了不少心力，不说四处查资料学习，光光坑我就踩了一堆。</p> 
<p>当然了，我写的方案也并非是最好的，只是用Java实现的一套的简单的鉴权服务，如果你学过SpringSecurity或者shiro这种权限管理框架，那你肯定能或多或少看出一点它们的影子，因为我有一部分是模仿它们写的（当然写的很简陋罢了）。</p> 
<p>如果你有什么意见或者建议，欢迎在评论区评论，对于每一条“非水”评论我都会认真回复。</p> 
<p>最后，愿大家都能以梦为马，不负人生韶华！<br> 与君共勉！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ea13c3bf3d750197f7f6ed0f84740b3b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于Spring项目中路径前加/和不加/的区别！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/342a8d8764bda818f92a6ad8673b9e1a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Kubernetes源码学习-Kubelet-P1-启动流程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>