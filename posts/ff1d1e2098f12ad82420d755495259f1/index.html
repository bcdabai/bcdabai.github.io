<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java多线程adb安装apk卡死_多线程方式安装apk - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java多线程adb安装apk卡死_多线程方式安装apk" />
<meta property="og:description" content="# -*- coding:utf-8 -*-
# 1.获取连接设备的机器ip
# 2.获取需要安装的apk
# 3.对每一台机器安装apk
# 4.检查apk安装是否成功
# 5.安装完成
import os,subprocess
import _thread
#获取设备ip地址，并连接
result=0
def connectDevice(dress):
&#39;&#39;&#39;检查设别是否连接成功，如果成功返回True，否则返回False&#39;&#39;&#39;
ip_dress=deviceName(dress)
for ipdressline in ip_dress:
cmd=&#34;adb connect&#34;&#43;&#34; &#34;&#43;str(ipdressline)
print(cmd)
device_con=subprocess.getoutput(cmd)
print(device_con)
Devicecmd=&#39;adb devices&#39;
device_str=subprocess.getoutput(Devicecmd)
device_list=[]
m=(device_str.strip(&#39;\n&#39;).strip(&#39; &#39;)).split(&#39;\n&#39;)
for line in m:
if &#39;List&#39; not in line:
device_list.append(line.split(&#39;\t&#39;)[0])
print(device_list)
else:
print(&#34;无设备连接&#34;)
return device_list
#读取apk
def readapk(apk_path):
apkpackage=os.listdir(apk_path)
apk_list=[]
for list in apkpackage:
if &#39;.apk&#39; in list:
apk_list.append(list)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ff1d1e2098f12ad82420d755495259f1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-25T02:31:36+08:00" />
<meta property="article:modified_time" content="2021-02-25T02:31:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java多线程adb安装apk卡死_多线程方式安装apk</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p># -*- coding:utf-8 -*-</p> 
 <p># 1.获取连接设备的机器ip</p> 
 <p># 2.获取需要安装的apk</p> 
 <p># 3.对每一台机器安装apk</p> 
 <p># 4.检查apk安装是否成功</p> 
 <p># 5.安装完成</p> 
 <p>import os,subprocess</p> 
 <p>import _thread</p> 
 <p>#获取设备ip地址，并连接</p> 
 <p>result=0</p> 
 <p>def connectDevice(dress):</p> 
 <p>'''检查设别是否连接成功，如果成功返回True，否则返回False'''</p> 
 <p>ip_dress=deviceName(dress)</p> 
 <p>for ipdressline in ip_dress:</p> 
 <p>cmd="adb connect"+" "+str(ipdressline)</p> 
 <p>print(cmd)</p> 
 <p>device_con=subprocess.getoutput(cmd)</p> 
 <p>print(device_con)</p> 
 <p>Devicecmd='adb devices'</p> 
 <p>device_str=subprocess.getoutput(Devicecmd)</p> 
 <p>device_list=[]</p> 
 <p>m=(device_str.strip('\n').strip(' ')).split('\n')</p> 
 <p>for line in m:</p> 
 <p>if 'List' not in line:</p> 
 <p>device_list.append(line.split('\t')[0])</p> 
 <p>print(device_list)</p> 
 <p>else:</p> 
 <p>print("无设备连接")</p> 
 <p>return device_list</p> 
 <p>#读取apk</p> 
 <p>def readapk(apk_path):</p> 
 <p>apkpackage=os.listdir(apk_path)</p> 
 <p>apk_list=[]</p> 
 <p>for list in apkpackage:</p> 
 <p>if '.apk' in list:</p> 
 <p>apk_list.append(list)</p> 
 <p>print("需要安装的apk是%s" % (apk_list))</p> 
 <p>return apk_list</p> 
 <p>#读取apk，安装apk</p> 
 <p>def readFile():</p> 
 <p>global result</p> 
 <p>#current=os.getcwd()</p> 
 <p>device_list = connectDevice("E:\cewen\deviceIPdress.txt")</p> 
 <p>apklist = readapk(r'E:\cewen\package')</p> 
 <p>for dev in device_list:</p> 
 <p>for apk in apklist:</p> 
 <p>apk='E:\cewen\package\\'+apk</p> 
 <p>installCmd = r'adb -s %s install -r %s ' % (dev, apk)</p> 
 <p>result =result+1</p> 
 <p>_thread.start_new_thread(manythread,(installCmd,apk))</p> 
 <p>#result = subprocess.Popen(installCmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True, universal_newlines=True)</p> 
 <p>while result!=0:</p> 
 <p>pass</p> 
 <p>def manythread(installCmd,apk):</p> 
 <p>global result</p> 
 <p>print(installCmd)</p> 
 <p>print('正在安装apk包：%s' % apk)</p> 
 <p>result = subprocess.Popen(installCmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True,</p> 
 <p>universal_newlines=True)</p> 
 <p>print(result.stdout.readlines())</p> 
 <p>result=result-1</p> 
 <p>#导入设备编号</p> 
 <p>def deviceName(ipdress):</p> 
 <p>filename=open(ipdress,'r')</p> 
 <p>devicelist=[]</p> 
 <p>for readline in filename:</p> 
 <p>devicelist.append(readline.strip('\n'))</p> 
 <p>return devicelist</p> 
 <p>#connectDevice()</p> 
 <p>#print(readapk(r'G:\测温软件\apk'))</p> 
 <p>readFile()</p> 
 <p>运行时很容易有问题。。。。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f08eff97cdc3a52eab521b1721b1ca3d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">学单片机怎么入门？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/35e19620d19285e01766dbcf06528ac7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java中跳转页面的两种方法_页面跳转的几种方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>