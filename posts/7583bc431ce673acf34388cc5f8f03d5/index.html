<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>记录项目里面用到的几个给国外邮箱发邮件的代码 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="记录项目里面用到的几个给国外邮箱发邮件的代码" />
<meta property="og:description" content="一些说明：
这几个都可以正常发邮件，但是免费的每天都会有限制，发多了就会黑名单。。。
最终选择了exchange付费的版本，每天可以发1万条邮件，也不是很贵，基础的32一个月的就可以了
import javax.mail.internet.AddressException; import javax.mail.internet.InternetAddress; import javax.mail.internet.MimeMessage; import javax.mail.internet.MimeUtility; import com.sun.mail.smtp.SMTPTransport; import microsoft.exchange.webservices.data.core.ExchangeService; import microsoft.exchange.webservices.data.core.enumeration.misc.ExchangeVersion; import microsoft.exchange.webservices.data.core.enumeration.property.BodyType; import microsoft.exchange.webservices.data.core.service.item.EmailMessage; import microsoft.exchange.webservices.data.credential.ExchangeCredentials; import microsoft.exchange.webservices.data.credential.WebCredentials; import microsoft.exchange.webservices.data.property.complex.MessageBody; import javax.mail.Session; import java.io.UnsupportedEncodingException; import java.net.URI; import java.net.URISyntaxException; import java.util.Date; import java.util.Properties; import javax.mail.Message; import javax.mail.MessagingException; import javax.mail.Transport; public class SendHtmlMail { public static void main(String[] args) { String to = &#34;******@gmail.com&#34;; StringBuffer theMessage = new StringBuffer(); theMessage.append(&#34;&lt;!DOCTYPE html&gt;&lt;html lang=&#39;en&#39;&gt;&lt;head&gt;&lt;meta charset=&#39;UTF-8&#39;&gt;&lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;测试一哈&lt;/body&gt;&lt;/html&gt;&#34;); sendMessageByExchange(&#34;***&#34;,&#34;***&#34;,&#34;Test&#34;,to,theMessage.toString()); } //Exchange服务发送 public static int sendMessageByExchange(String username, String password,String subject, String to,String bodyText){ ExchangeService service = new ExchangeService(ExchangeVersion." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7583bc431ce673acf34388cc5f8f03d5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-20T17:31:27+08:00" />
<meta property="article:modified_time" content="2019-06-20T17:31:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">记录项目里面用到的几个给国外邮箱发邮件的代码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一些说明：</p> 
<p>这几个都可以正常发邮件，但是免费的每天都会有限制，发多了就会黑名单。。。</p> 
<p>最终选择了exchange付费的版本，每天可以发1万条邮件，也不是很贵，基础的32一个月的就可以了</p> 
<p><img alt="" class="has" height="253" src="https://images2.imgbox.com/2d/d5/QtCf13QP_o.png" width="224"></p> 
<p> </p> 
<pre class="has"><code class="language-java">import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeUtility;
import com.sun.mail.smtp.SMTPTransport;
import microsoft.exchange.webservices.data.core.ExchangeService;
import microsoft.exchange.webservices.data.core.enumeration.misc.ExchangeVersion;
import microsoft.exchange.webservices.data.core.enumeration.property.BodyType;
import microsoft.exchange.webservices.data.core.service.item.EmailMessage;
import microsoft.exchange.webservices.data.credential.ExchangeCredentials;
import microsoft.exchange.webservices.data.credential.WebCredentials;
import microsoft.exchange.webservices.data.property.complex.MessageBody;
import javax.mail.Session;
import java.io.UnsupportedEncodingException;
import java.net.URI;
import java.net.URISyntaxException;
import java.util.Date;
import java.util.Properties;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Transport;

public class SendHtmlMail {

    public static void main(String[] args) {
        String to = "******@gmail.com";

        StringBuffer theMessage = new StringBuffer();
        theMessage.append("&lt;!DOCTYPE html&gt;&lt;html lang='en'&gt;&lt;head&gt;&lt;meta charset='UTF-8'&gt;&lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;&lt;body&gt;测试一哈&lt;/body&gt;&lt;/html&gt;");
             
        sendMessageByExchange("***","***","Test",to,theMessage.toString());
        
    }
    
    //Exchange服务发送
    public static int sendMessageByExchange(String username, String password,String subject, String to,String bodyText){
        ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);
        ExchangeCredentials credentials = new WebCredentials(username,password);
        service.setCredentials(credentials);
        
        try {
            service.setUrl(new URI("https://smtp.office365.com/EWS/exchange.asmx"));
            EmailMessage msg = new EmailMessage(service);
            msg.setSubject(subject);
            MessageBody body = MessageBody.getMessageBodyFromText(bodyText);
            body.setBodyType(BodyType.HTML);
            msg.setBody(body);
            msg.getToRecipients().add(to);
            
            msg.send();
            return 1;
        } catch (URISyntaxException e) {
            e.printStackTrace();
            return 0;
        } catch (Exception e) {
            e.printStackTrace();
            return 0;
        }
    }
    
    //MG服务发送
    public static int sendMessageByMG(String from, String password, String to, String content, 
        String sender,String title) throws UnsupportedEncodingException{
        
        try {
            Properties props = System.getProperties();
            props.put("mail.smtps.host", "smtp.mailgun.org");
            props.put("mail.smtps.auth", "true");

            Session session = Session.getInstance(props, null);
            Message msg = new MimeMessage(session);
            
            msg.setFrom(new InternetAddress(from));
            
            InternetAddress[] addrs = InternetAddress.parse(to, false);
            msg.setRecipients(Message.RecipientType.TO, addrs);
            msg.setSubject(MimeUtility.encodeText(title, "gb2312", "B"));
            msg.setSentDate(new Date());
            msg.setContent(content, "text/html;charset=gb2312");

            SMTPTransport t = (SMTPTransport) session.getTransport("smtps");
            t.connect("smtp.mailgun.org", from, password);
            t.sendMessage(msg, msg.getAllRecipients());

            System.out.println("To: " + to + "Response: " + t.getLastServerResponse());
            t.close();
            return 1;
        } catch (AddressException e) {
            e.printStackTrace();
            return 0;
        } catch (MessagingException e) {
            e.printStackTrace();
            return 0;
        }
    }
    
    //outlook服务发送
    public static int sendMessageByOutLook(String from, String password, String to, String content, String sender,
        String title) throws MessagingException, java.io.UnsupportedEncodingException {

        try {
            Properties props = new Properties();
            // 开启debug调试
            props.setProperty("mail.debug", "true"); // false
            // 发送服务器需要身份验证
            props.setProperty("mail.smtp.auth", "true");
            // 设置邮件服务器主机名
            props.setProperty("mail.host", "smtp.office365.com");
            // 发送邮件协议名称
            props.setProperty("mail.transport.protocol", "smtp");
            props.setProperty("mail.smtp.port", "587");
            props.put("mail.smtp.starttls.enable", "true");

            // 设置环境信息
            Session session = Session.getInstance(props);
            InternetAddress toAddress = new InternetAddress(to);
            
            // 创建邮件对象
            MimeMessage testMessage = new MimeMessage(session);
            testMessage.setFrom(new InternetAddress(from,sender));
            testMessage.addRecipient(javax.mail.Message.RecipientType.TO, toAddress);
            testMessage.setSentDate(new java.util.Date());
            testMessage.setSubject(MimeUtility.encodeText(title, "gb2312", "B"));

            testMessage.setContent(content, "text/html;charset=gb2312");

            Transport transport = session.getTransport();
            // 连接邮件服务器
            transport.connect(from, password);
            // 发送邮件
            transport.sendMessage(testMessage, testMessage.getAllRecipients());
            // 关闭连接
            transport.close();
            System.out.println("Message sent to " + to + " success!");
            return 1;
        } catch (Exception e) {
            e.printStackTrace();
            return 0;
        }
    }

    //gmail服务发送
    public static int sendMessageByGmail(String from, String password, String to, String content, String sender, String title)
        throws MessagingException, java.io.UnsupportedEncodingException {

        try {
            // Step 1: Configure the mail session
            String host = "smtp.gmail.com";
            String port = "465";

            System.out.println("Configuring mail session for: " + host);
            java.util.Properties props = new java.util.Properties();
            props.setProperty("mail.smtp.auth", "true");// 指定是否需要SMTP验证
            props.put("mail.transport.protocol", "smtp");

            props.put("mail.smtp.user", from);
            props.put("mail.smtp.host", host);
            props.put("mail.smtp.starttls.enable", "true");
            props.put("mail.smtp.debug", "true");
            props.put("mail.smtp.auth", "true");
            props.put("mail.smtp.port", port);
            props.put("mail.smtp.timeout", "5000");
            props.put("mail.smtp.socketFactory.port", port);
            props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
            props.put("mail.smtp.socketFactory.fallback", "false");

            Session mailSession = Session.getDefaultInstance(props);
            mailSession.setDebug(false);// 是否在控制台显示debug信息

            // Step 2: Construct the message
            System.out.println("Constructing message -  from=" + from + "  to=" + to);
            InternetAddress fromAddress = new InternetAddress(from, sender);
            InternetAddress toAddress = new InternetAddress(to);

            MimeMessage testMessage = new MimeMessage(mailSession);
            testMessage.setFrom(fromAddress);
            testMessage.addRecipient(javax.mail.Message.RecipientType.TO, toAddress);
            testMessage.setSentDate(new java.util.Date());
            testMessage.setSubject(MimeUtility.encodeText(title, "gb2312", "B"));

            testMessage.setContent(content, "text/html;charset=gb2312");
            System.out.println("Message constructed");

            // Step 3: Now send the message
            Transport transport = mailSession.getTransport("smtps");
            transport.connect(host, Integer.valueOf(port), from, password);
            transport.sendMessage(testMessage, testMessage.getAllRecipients());
            transport.close();

            System.out.println("Message sent to " + to + " success!");
            return 1;
        } catch (NumberFormatException e) {
            e.printStackTrace();
            return 0;
        }
    }

}</code></pre> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bfca7acd0d5c9da7e2b0de0c51bae44f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">竞品分析」项目协作管理平台-Teambition和CORNERSTONE--深度体验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/10d1a03f8b1b6240d2d92731da8b9c11/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FFmpeg 为视频添加关键帧</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>