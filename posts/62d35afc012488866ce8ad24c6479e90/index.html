<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Redisç¼“å­˜ç©¿é€â€”â€”å®æˆ˜ä»£ç æ•™å­¦ï¼Œäº²èº«ä½“éªŒé«˜å¹¶å‘å¦‚ä½•è§£å†³ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Redisç¼“å­˜ç©¿é€â€”â€”å®æˆ˜ä»£ç æ•™å­¦ï¼Œäº²èº«ä½“éªŒé«˜å¹¶å‘å¦‚ä½•è§£å†³" />
<meta property="og:description" content="ğŸš€ æ³¨é‡ç‰ˆæƒï¼Œè½¬è½½è¯·æ³¨æ˜åŸä½œè€…å’ŒåŸæ–‡é“¾æ¥
ğŸ¥­ ä½œè€…ï¼šå…¨æ ˆå°è¢
ğŸ åŸåˆ›ä¸ªäººå¼€æºåšå®¢é¡¹ç›®(ç›®å‰V2.0å¾®æœåŠ¡ç‰ˆæœ¬)ï¼šhttps://github.com/yuanprogrammer/xiaoyuanboke
ğŸ‰ å¼€æºé¡¹ç›®è§‰å¾—è¿˜è¡Œçš„è¯ç‚¹ç‚¹starï¼Œæœ‰ä»€ä¹ˆéœ€è¦å®Œå–„æˆ–è€…ç‚¹å­æ¬¢è¿æissue å°è¢æœ‰è¯è¯´ ä¼—æ‰€å‘¨çŸ¥ï¼ŒRedisä¸‰å¤§é—®é¢˜ï¼Œç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©ï¼Œä¹Ÿæ˜¯æœ€å¸¸è§çš„ç¼“å­˜é—®é¢˜ï¼Œåœ¨é¢è¯•å½“ä¸­ä¹Ÿæ˜¯ç»å¸¸è¢«é—®åˆ°ï¼Œä»Šå¤©æˆ‘ä»¬å°±å…ˆæ¥è®²è®² ç¼“å­˜ç©¿é€ é—®é¢˜çš„è§£å†³ä»¥åŠå¦‚ä½•ç¼–å†™ä»£ç 
ä¹‹å‰æˆ‘ä¹Ÿæ˜¯çœ‹è¿‡å¾ˆå¤šç›¸å…³çš„çŸ¥è¯†ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯ç»“åˆè‡ªå·±æ‰€å­¦æ€»ç»“çš„ä¸€ç¯‡æ–‡ç« ï¼Œå¦‚æœä»€ä¹ˆåœ°æ–¹æœ‰é—®é¢˜æˆ–è€…ä¸è¶³ä¹‹å¤„å¯ä»¥è¯„è®ºåŒºç•™è¨€å‘Šè¯‰æˆ‘
ç¼“å­˜å‡»ç©¿å’Œç¼“å­˜é›ªå´©ï¼Œåç»­å‡º~
ä¸€ã€å‰æœŸå‡†å¤‡ æ•°æ®è¡¨ éšä¾¿åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œè¿™é‡Œä»¥ç”¨æˆ·è¡¨ä½œä¸ºæ¼”ç¤º
CREATE TABLE `user` ( `id` int(10) NOT NULL AUTO_INCREMENT, `username` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;ç”¨æˆ·å&#39;, `password` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;å¯†ç &#39;, `name` varchar(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;æ˜µç§°&#39;, `mobile` varchar(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;å·ç &#39;, `email` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT &#39;é‚®ç®±&#39;, `gmt_create` datetime(0) NULL DEFAULT NULL COMMENT &#39;æ—¶é—´&#39;, PRIMARY KEY (`id`) USING BTREE ) ENGINE = InnoDB AUTO_INCREMENT = 1001 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic; ä½¿ç”¨åœ¨çº¿å·¥å…·éšæœºç”Ÿæˆä¸€åƒæ¡æ•°æ®ï¼Œå·¥å…·åœ°å€ï¼šhttps://datum." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/62d35afc012488866ce8ad24c6479e90/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-31T16:55:09+08:00" />
<meta property="article:modified_time" content="2023-01-31T16:55:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Redisç¼“å­˜ç©¿é€â€”â€”å®æˆ˜ä»£ç æ•™å­¦ï¼Œäº²èº«ä½“éªŒé«˜å¹¶å‘å¦‚ä½•è§£å†³</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <ul><li>ğŸš€ <strong>æ³¨é‡ç‰ˆæƒï¼Œè½¬è½½è¯·æ³¨æ˜åŸä½œè€…å’ŒåŸæ–‡é“¾æ¥</strong><br> <br></li><li>ğŸ¥­ <strong>ä½œè€…ï¼š<a href="https://blog.csdn.net/weixin_47971206?type=blog">å…¨æ ˆå°è¢</a></strong><br> <br></li><li>ğŸ <strong>åŸåˆ›ä¸ªäººå¼€æºåšå®¢é¡¹ç›®(ç›®å‰V2.0å¾®æœåŠ¡ç‰ˆæœ¬)ï¼š<a href="https://github.com/yuanprogrammer/xiaoyuanboke">https://github.com/yuanprogrammer/xiaoyuanboke</a></strong><br> <br></li><li>ğŸ‰ <strong>å¼€æºé¡¹ç›®è§‰å¾—è¿˜è¡Œçš„è¯ç‚¹ç‚¹starï¼Œæœ‰ä»€ä¹ˆéœ€è¦å®Œå–„æˆ–è€…ç‚¹å­æ¬¢è¿æissue</strong></li></ul> 
</blockquote> 
<h3><a id="_8"></a>å°è¢æœ‰è¯è¯´</h3> 
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒRedisä¸‰å¤§é—®é¢˜ï¼Œ<code>ç¼“å­˜ç©¿é€</code>ã€<code>ç¼“å­˜å‡»ç©¿</code>ã€<code>ç¼“å­˜é›ªå´©</code>ï¼Œä¹Ÿæ˜¯æœ€å¸¸è§çš„ç¼“å­˜é—®é¢˜ï¼Œåœ¨é¢è¯•å½“ä¸­ä¹Ÿæ˜¯ç»å¸¸è¢«é—®åˆ°ï¼Œä»Šå¤©æˆ‘ä»¬å°±å…ˆæ¥è®²è®² <code>ç¼“å­˜ç©¿é€</code> é—®é¢˜çš„è§£å†³ä»¥åŠå¦‚ä½•ç¼–å†™ä»£ç </p> 
<p>ä¹‹å‰æˆ‘ä¹Ÿæ˜¯çœ‹è¿‡å¾ˆå¤šç›¸å…³çš„çŸ¥è¯†ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯ç»“åˆè‡ªå·±æ‰€å­¦æ€»ç»“çš„ä¸€ç¯‡æ–‡ç« ï¼Œå¦‚æœä»€ä¹ˆåœ°æ–¹æœ‰é—®é¢˜æˆ–è€…ä¸è¶³ä¹‹å¤„å¯ä»¥è¯„è®ºåŒºç•™è¨€å‘Šè¯‰æˆ‘</p> 
<blockquote> 
 <p>ç¼“å­˜å‡»ç©¿å’Œç¼“å­˜é›ªå´©ï¼Œåç»­å‡º~</p> 
</blockquote> 
<h3><a id="_15"></a>ä¸€ã€å‰æœŸå‡†å¤‡</h3> 
<h5><a id="_16"></a>æ•°æ®è¡¨</h5> 
<p>éšä¾¿åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œè¿™é‡Œä»¥ç”¨æˆ·è¡¨ä½œä¸ºæ¼”ç¤º</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·å'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'å¯†ç '</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'æ˜µç§°'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>mobile<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'å·ç '</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>email<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'é‚®ç®±'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'æ—¶é—´'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">=</span> <span class="token number">1001</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8_general_ci ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

</code></pre> 
<p>ä½¿ç”¨åœ¨çº¿å·¥å…·éšæœºç”Ÿæˆä¸€åƒæ¡æ•°æ®ï¼Œå·¥å…·åœ°å€ï¼š<a href="https://datum.codedefault.com/" rel="nofollow">https://datum.codedefault.com/</a></p> 
<p>ç”±äºSQLæ¯”è¾ƒé•¿ï¼Œå°±ä¸æ”¾åœ¨è¿™é‡Œå±•ç¤ºäº†ï¼Œæ‰“å¼€æˆ‘çš„ç¬”è®°å³å¯å¤åˆ¶SQLè¯­å¥<a href="https://note.youdao.com/s/13OsjC3d" rel="nofollow">https://note.youdao.com/s/13OsjC3d</a></p> 
<p><img src="https://images2.imgbox.com/45/14/xlY3bk96_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ä¸‹é¢è¿™äº›ç½‘ä¸Šéƒ½æœå¾—åˆ°çš„ï¼Œç”¨è§£å‹ç‰ˆå³å¯ï¼Œå¦‚æœä½ ä»¬æ‰¾ä¸åˆ°å¯ä»¥æ–‡ç« ç•™è¨€ï¼ˆé‚®ç®±+å·¥å…·ï¼‰ï¼Œæˆ‘çœ‹åˆ°ä¼šä¸€èµ·æ‰“åŒ…å‘ç»™ä½ </p> 
<h5><a id="Redis_38"></a>Redis</h5> 
<p>å®‰è£…å¥½redisï¼Œå¹¶æˆåŠŸè¿æ¥ä¸Š</p> 
<h5><a id="Redis_Desktop_Manager_40"></a>Redis Desktop Manager</h5> 
<p>rediså®¢æˆ·ç«¯å·¥å…·ï¼Œè·Ÿnavicatè¿™ç§ä½œç”¨ç›¸ä¼¼ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ•°æ®æƒ…å†µï¼Œå½“ç„¶ä½ ä¸ç”¨ä¹Ÿè¡Œ</p> 
<p><img src="https://images2.imgbox.com/04/a0/ouRX0ta3_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="Postman_45"></a>Postman</h5> 
<p>httpè¯·æ±‚å·¥å…·</p> 
<p><img src="https://images2.imgbox.com/86/be/fN7SVWDJ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="Jmeter_50"></a>Jmeter</h5> 
<p>é«˜å¹¶å‘æµ‹è¯•å·¥å…·</p> 
<p><img src="https://images2.imgbox.com/8d/14/g5GDqD9A_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="Maven_55"></a>äºŒã€æ„å»ºMavené¡¹ç›®</h3> 
<p>åˆ›å»ºä¸€ä¸ªMavené¡¹ç›®ï¼Œ</p> 
<h5><a id="_58"></a>ä¾èµ–</h5> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Webå¯åŠ¨ä¾èµ– --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.12.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Redis --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.12.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- MyBatis-Plus --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- æ•°æ®åº“é©±åŠ¨ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- hutool --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.7.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="applicationyml_96"></a>application.yml</h5> 
<p>é˜²æ­¢ç«¯å£å†²çªï¼Œä¿®æ”¹ç«¯å£å·</p> 
<pre><code class="prism language-python">server<span class="token punctuation">:</span>
  port<span class="token punctuation">:</span> <span class="token number">8085</span>
spring<span class="token punctuation">:</span>
  datasource<span class="token punctuation">:</span>
    driver<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">-</span>name<span class="token punctuation">:</span> com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>cj<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
    url<span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>redis?useUnicode<span class="token operator">=</span>true<span class="token operator">&amp;</span>characterEncoding<span class="token operator">=</span>UTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&amp;</span>serverTimezone<span class="token operator">=</span>GMT<span class="token operator">%</span>2B8
    username<span class="token punctuation">:</span> xiaoyuan
    password<span class="token punctuation">:</span> root
  redis<span class="token punctuation">:</span>
    port<span class="token punctuation">:</span> <span class="token number">6379</span>
    host<span class="token punctuation">:</span> localhost
    database<span class="token punctuation">:</span> <span class="token number">0</span>
</code></pre> 
<h5><a id="_114"></a>å®ä½“ç±»</h5> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">IdType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">TableName</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> mobile<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Date</span> gmtCreate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="Mapper_145"></a>Mapperæ¥å£</h5> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">BaseMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="service_157"></a>serviceæ¥å£</h5> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token keyword">extends</span> <span class="token class-name">IService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// ç”¨æˆ·æŸ¥è¯¢, ç”¨nameå­—æ®µæ¥æ¨¡æ‹ŸæŸ¥è¯¢ä¸å­˜åœ¨çš„ç”¨æˆ·</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="impl_171"></a>implå®ç°ç±»</h5> 
<p>ä¸€ä¸ªç®€å•çš„æŸ¥è¯¢</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">LambdaQueryWrapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>extension<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">ServiceImpl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">UserMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMapper</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        wrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="controller_195"></a>controller</h5> 
<p>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªä¸€èˆ¬ä¸šåŠ¡å†™æ³•</p> 
<p><code>redisMap </code> å­˜å‚¨æ¯ä¸ªkeyæˆåŠŸè·å–ç¼“å­˜æ¬¡æ•°çš„æƒ…å†µ<br> <code>mysqlMap</code> å­˜å‚¨æ¯ä¸ªkeyè®¿é—®æ•°æ®åº“æ¬¡æ•°çš„æƒ…å†µ</p> 
<p><strong>clearæ¥å£</strong> â€”â€” æƒ…å†µMapç»“æœé›†ï¼Œ<strong>getMapæ¥å£</strong> â€”â€” æŸ¥çœ‹Mapç»“æœé›†ï¼Œ<strong>queryæ¥å£</strong> ç”¨æˆ·æŸ¥è¯¢æ¥å£ï¼Œä»¥<code>name</code> å­—æ®µä¸ºä¾‹ç®€å•æ¨¡æ‹Ÿåœºæ™¯</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ConcurrentHashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/user/api"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// å­˜å‚¨æ¯ä¸ªkeyèµ°äº†å¤šå°‘æ¬¡ç¼“å­˜</span>
    <span class="token keyword">private</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> redisMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å­˜å‚¨æ¯ä¸ªkeyèµ°äº†å¤šå°‘æ¬¡æ•°æ®åº“</span>
    <span class="token keyword">private</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> mysqlMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"clear"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"getMap"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"redisMap"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mysqlMap"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> json<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> cache <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ˜¯å¦å­˜åœ¨ç¼“å­˜</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// ä¸å­˜åœ¨ç¼“å­˜, æŸ¥è¯¢æ•°æ®åº“</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">queryUser</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// æœ‰æ•°æ®, ä¸¢å…¥ç¼“å­˜</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>users <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> users<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> users<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/de/a4/ejOF4BG6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_273"></a>ä¸‰ã€æ­£å¼å¼€å§‹ï¼ˆé‡ç‚¹ï¼‰</h3> 
<h5><a id="_274"></a>æ™®é€šæµ‹è¯•</h5> 
<p>æˆ‘ä»¬ç”¨ <code>postman</code> å…ˆæ™®é€šæµ‹è¯•ä¸€ä¸‹æ¥å£ï¼Œæµ‹è¯•ä¸€ä¸ªå­˜åœ¨çš„æ•°æ®ï¼Œæ­£å¸¸æ˜¾ç¤º</p> 
<p><img src="https://images2.imgbox.com/8f/19/qyf06dI0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h5><a id="jmeter_279"></a>jmeterå‹æµ‹</h5> 
<p>æ¥ä¸‹æ¥è¿›å…¥æ­£é¢˜ï¼Œç”¨ <code>jmeter</code> æµ‹è¯•ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¹¶å‘1000ä¸ªçº¿ç¨‹ï¼Œå¾ªç¯10æ¬¡ï¼Œè®¾ç½®éšæœºå˜é‡ï¼Œæ§åˆ¶åœ¨ <strong>å…¨æ ˆå°è¢001 ~ å…¨æ ˆå°è¢100</strong> ä¹‹é—´</p> 
<p><img src="https://images2.imgbox.com/83/66/HGGj5s15_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/7a/42/Zz7utNU3_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/e1/ee/yXVjcQSR_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>æ‰§è¡Œjemterï¼Œæ¥ç€ä½¿ç”¨postmantæŸ¥çœ‹ä¸€ä¸‹ç»“æœï¼Œä»ç»“æœå¯ä»¥çœ‹åˆ°å…¨éƒ¨è®¿é—®äº†æ•°æ®åº“</p> 
<p>å¦‚æœå¹¶å‘éå¸¸å¤§ï¼Œæ˜¯ä¸æ˜¯ä¼šç»™æ•°æ®åº“é€ æˆå‹åŠ›ï¼Œç”šè‡³å¯¼è‡´æ•°æ®åº“å®•å¥”æºƒï¼Ÿ</p> 
<p><img src="https://images2.imgbox.com/1e/76/aylWMakG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_294"></a>å››ã€ç©ºå€¼ç¼“å­˜ï¼ˆæ–¹æ¡ˆä¸€ï¼‰</h3> 
<p><img src="https://images2.imgbox.com/c0/34/Is7VNP36_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>åŠ å…¥è¿™ä¸€æ®µä»£ç </p> 
<p><img src="https://images2.imgbox.com/ea/70/hYKqzyh0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-java"><span class="token comment">// ç¼“å­˜ç©ºå€¼æˆ–è€…é»˜è®¤å€¼</span>
<span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"res"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> json<span class="token punctuation">;</span>
</code></pre> 
<p>é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œè¿›è¡Œjemeterå‹æµ‹ï¼Œæµ‹è¯•ç»“æœå¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†èµ°äº†redisç¼“å­˜çš„é»˜è®¤å€¼ï¼Œè®¿é—®mysqlçš„æ¬¡æ•°å¤§å¹…åº¦é™ä½äº†</p> 
<p><img src="https://images2.imgbox.com/11/84/3HLHbhpi_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/1f/d0/BP9Hm6Ae_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_316"></a>äº”ã€ç™½åå•ï¼ˆæ–¹æ¡ˆäºŒï¼‰</h3> 
<p>åœ¨ <strong>æ–¹æ¡ˆä¸€ä¸­</strong> å¯¹æ‰€æœ‰çš„éæ³•keyéƒ½åšäº†ç¼“å­˜ï¼Œè€Œä¸”éƒ½æ˜¯åŒæ ·çš„valueï¼Œè¿™æ ·çš„æ“ä½œé€ æˆäº†æ•°æ®å†—ä½™ï¼Œè€Œä¸”keyçš„æ•°é‡éå¸¸å¤š</p> 
<p>æˆ‘ä»¬å¯ä»¥å®Œå–„ä¸€ä¸‹ï¼Œåˆ©ç”¨redisä¸­çš„ <code>set</code> é›†åˆï¼Œè®¾ç½® <strong>é»‘åå•åˆ—è¡¨</strong></p> 
<p><img src="https://images2.imgbox.com/4a/df/aGdB603U_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// æ˜¯å¦åœ¨é»‘åå•ä¸­</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isMember</span><span class="token punctuation">(</span><span class="token string">"NullSet"</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redisMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"res"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¿”å›ç©ºå€¼</span>
        <span class="token keyword">return</span> json<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">String</span> cache <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å­˜åœ¨ç¼“å­˜</span>
        <span class="token keyword">return</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æŸ¥è¯¢æ•°æ®åº“</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">queryUser</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>users <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> users<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// æœ‰æ•°æ®, ä¸¢å…¥ç¼“å­˜</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> users<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// æ— æ•°æ®, åŠ å…¥é»‘åå•åˆ—è¡¨</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"NullSet"</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"res"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è¿”å›ç©ºå€¼</span>
            <span class="token keyword">return</span> json<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å¯åŠ¨è¿›è¡Œjmeterå‹æµ‹ï¼Œæµ‹è¯•ç»“æœå¯ä»¥ä¹Ÿæ˜¯å¤§éƒ¨åˆ†èµ°äº†redisï¼Œå‡å°‘mysqlè®¿é—®çš„æ¬¡æ•°ï¼ŒåŒæ—¶seté›†åˆä¹Ÿæ–¹ä¾¿ç®¡ç†ï¼Œå‡å°‘æ•°æ®çš„å†—ä½™</p> 
<p><img src="https://images2.imgbox.com/b8/10/FYRJkSFf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/a1/23/xDvdFHcB_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<hr> 
<h3><a id="_367"></a>å…­ã€å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆæ–¹æ¡ˆä¸‰ï¼‰</h3> 
<p>æ— è®ºæ˜¯ æ–¹æ¡ˆä¸€ è¿˜æ˜¯ æ–¹æ¡ˆäºŒï¼Œæ•°æ®é‡å¤§èµ·æ¥å¯¹ç©ºé—´æ¶ˆè€—è¿˜æ˜¯éå¸¸å¤§çš„ï¼Œæ‰€ä»¥å°±æœ‰äº†ç¬¬ä¸‰ç§æ–¹æ¡ˆâ€”â€” <code>å¸ƒéš†è¿‡æ»¤å™¨</code></p> 
<p><code>å¸ƒéš†è¿‡æ»¤å™¨</code> æˆ‘å°±ä¸ä¸è¯¦ç»†ä»‹ç»äº†ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šè¯¦ç»†çš„è§£é‡Šï¼Œè¿™é‡Œæˆ‘å°±å¤§æ¦‚è¯´ä¸€ä¸‹å°±è¡Œ</p> 
<blockquote> 
 <p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œå¸ƒéš†è¿‡æ»¤å™¨çš„ç»“æ„æ˜¯ç”± <code>äºŒè¿›åˆ¶ 0 1 </code> ç»„æˆçš„æ•°ç»„ï¼Œ0æ˜¯ä¸å­˜åœ¨ï¼Œ1æ˜¯å­˜åœ¨ <br><br> ï¼ˆ2ï¼‰æ‹¥æœ‰ k ä¸ªç‹¬ç«‹çš„ <code>å“ˆå¸Œå‡½æ•°æ˜ å°„</code> ï¼Œé€šè¿‡è¦åˆ¤æ–­çš„å­—ç¬¦åˆ†åˆ«è®¡ç®—å‡º <code>å“ˆå¸Œå€¼</code> è®¡ç®—å‡ºä¸‹æ ‡ä½ç½®ï¼Œå½“ k ä¸ªä¸‹æ ‡è·å–åˆ°çš„å€¼éƒ½ä¸º <strong>1</strong> æ—¶ï¼Œåˆ™è®¤ä¸ºå½“å‰å­—ç¬¦å­˜åœ¨ï¼Œå¦åˆ™ä¸å­˜åœ¨ <br><br> ï¼ˆ3ï¼‰ä¼˜ç‚¹ï¼šé€Ÿåº¦éå¸¸å¿«ï¼Œå ç”¨ç©ºé—´æå°‘ï¼Œæ“ä½œçš„æ˜¯æœºå™¨åº•å±‚äºŒè¿›åˆ¶å‘é‡ï¼›ç¼ºç‚¹ï¼šä¸€æ˜¯å­˜åœ¨ <code>è¯¯åˆ¤</code>ï¼Œä¸åŒçš„å­—ç¬¦ä¼šå‡ºç°ç›¸åŒçš„å“ˆå¸Œå€¼ï¼ŒäºŒæ˜¯ <code>åˆ é™¤å›°éš¾</code> <br><br> ï¼ˆ4ï¼‰è¿™é‡Œæ’ä¸€ç‚¹ï¼šä¸Šé¢è¯´åˆ°åˆ é™¤å›°éš¾ï¼Œäºæ˜¯è¡ç”Ÿå‡ºäº† <code>å¸ƒè°·è¿‡æ»¤å™¨</code> ï¼Œå¯ä»¥åˆ é™¤æ“ä½œï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å»çœ‹çœ‹</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/58/cd/1jN4Ughx_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>è¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯ <code>hutool</code> å·¥å…·åº“å·²ç»å°è£…å¥½çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å·¥å…·åº“æˆ–è€…è‡ªå·±å°è£…ä¸€ä¸ªï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„</p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>bloomfilter<span class="token punctuation">.</span></span><span class="token class-name">BloomFilter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>bloomfilter<span class="token punctuation">.</span></span><span class="token class-name">BloomFilterUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>json<span class="token punctuation">.</span></span><span class="token class-name">JSONUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ConcurrentHashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/user/api"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// å­˜å‚¨æ¯ä¸ªkeyèµ°äº†å¤šå°‘æ¬¡å¸ƒéš†è¿‡æ»¤å™¨</span>
    <span class="token keyword">private</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> bloomMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å­˜å‚¨æ¯ä¸ªkeyèµ°äº†å¤šå°‘æ¬¡æ•°æ®åº“</span>
    <span class="token keyword">private</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> mysqlMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¸ƒéš†è¿‡æ»¤å™¨, è®¾ç½®å¤§çº¦1000ä¸ªæ•°æ®</span>
    <span class="token keyword">private</span> <span class="token class-name">BloomFilter</span> bloomFilter <span class="token operator">=</span> <span class="token class-name">BloomFilterUtil</span><span class="token punctuation">.</span><span class="token function">createBitMap</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"clear"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bloomMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"getMap"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"bloomMap"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bloomMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mysqlMap"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> json<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å¸ƒéš†è¿‡æ»¤å™¨è¿‡æ»¤, åˆ¤æ–­æ˜¯å¦å‡ºç°åœ¨è¿‡æ»¤å™¨é‡Œ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bloomFilter<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>bloomMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bloomMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bloomMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"res"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è¿”å›ç©ºå€¼</span>
            <span class="token keyword">return</span> json<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">String</span> cache <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cache <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// è¿”å›ç¼“å­˜</span>
            <span class="token keyword">return</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// æŸ¥è¯¢æ•°æ®åº“</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mysqlMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">queryUser</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>users <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> users<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// æœ‰æ•°æ®, ä¸¢å…¥ç¼“å­˜</span>
                redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> users<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// æ— æ•°æ®, æ·»åŠ åˆ°è¿‡æ»¤å™¨é‡Œ</span>
                bloomFilter<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">JSONObject</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                json<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"res"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è¿”å›ç©ºå€¼</span>
                <span class="token keyword">return</span> json<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>é‡æ–°å¯åŠ¨ï¼Œå‹æµ‹ï¼Œæµ‹è¯•ç»“æœå¯ä»¥çœ‹å‡ºå¤§éƒ¨åˆ†éƒ½è¢« <code>å¸ƒéš†è¿‡æ»¤å™¨</code> ç»™è¿‡æ»¤æ‰äº†</p> 
<p><img src="https://images2.imgbox.com/69/e2/Ffnu5AG4_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_472"></a>æ€»ç»“</h3> 
<p>å¥½äº†ï¼Œæ•´ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œåšä¸ªæ€»ç»“ï¼Œä¹Ÿæ˜¯æˆ‘çš„ä¸ªäººä¹ æƒ¯ä¹‹ä¸€</p> 
<h5><a id="_475"></a>é—®é¢˜äº§ç”Ÿ</h5> 
<p>å®¢æˆ·ç«¯å‘é€è¯·æ±‚è·å–æ•°æ®çš„æ—¶å€™ï¼Œåœ¨redisä¸­æœªå‘½ä¸­ï¼Œæ¥ç€æŸ¥è¯¢æ•°æ®åº“ä¹Ÿæœªå‘½ä¸­ï¼Œå¦‚æœè¿™æ—¶å€™å¤§é‡è¯·æ±‚è¿™äº›ä¸å­˜åœ¨çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¼šç»™æ•°æ®åº“é€ æˆä¸€å®šçš„å‹åŠ›ç”šè‡³å®•æœºï¼Œè¿™å°±æ˜¯ <code>ç¼“å­˜ç©¿é€</code> é—®é¢˜çš„äº§ç”Ÿ</p> 
<h5><a id="_478"></a>è§£å†³æ–¹æ¡ˆ</h5> 
<ul><li>ç¼“å­˜ç©ºå€¼æˆ–è€…é»˜è®¤å€¼ 
  <ul><li>å¯¹ä¸å­˜åœ¨çš„æ•°æ®keyæ„å»ºç¼“å­˜ï¼Œä¸‹æ¬¡è¯·æ±‚æ—¶ç›´æ¥è¿”å›ç¼“å­˜ï¼Œå¯¹äºç©ºé—´å ç”¨é—®é¢˜å¯ä»¥è®¾ç½®ç¼“å­˜æ—¶é—´çŸ­ä¸€äº›ï¼ˆ5s/10s/20sï¼‰</li></ul> </li><li>é»‘åå• 
  <ul><li>åˆ©ç”¨Seté›†åˆï¼Œè®¾ç½®ç©ºå€¼é»‘åå•åˆ—è¡¨ï¼Œé‡åˆ°å­˜åœ¨é»‘åå•ä¸­çš„éæ³•è¯·æ±‚ç›´æ¥è¿”å›ç©ºå€¼æˆ–é»˜è®¤å€¼ï¼ŒåŒæ—¶å¯ä»¥è‡ªå®šä¹‰æ“ä½œseté›†åˆæ•°æ®</li></ul> </li><li>å¸ƒéš†è¿‡æ»¤å™¨ 
  <ul><li>0 1 ç»„é•¿çš„äºŒè¿›åˆ¶å‘é‡ï¼Œç©ºé—´å ç”¨æå°ï¼Œé€Ÿåº¦ä¹Ÿéå¸¸å¿«ï¼Œä½†åˆ é™¤æ¯”è¾ƒå›°éš¾ï¼Œä¸”å­˜åœ¨ä¸€å®šçš„è¯¯åˆ¤ï¼ˆä¸åŒå¯¹è±¡å¯èƒ½å­˜åœ¨ç›¸åŒå“ˆå¸Œå€¼ï¼‰</li></ul> </li></ul> 
<h5><a id="_486"></a>é€‰æ‹©</h5> 
<p>æˆ‘è‡ªå·±åœ¨é¡¹ç›®ä¸­ä¸€èˆ¬éƒ½æ˜¯ç”¨ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œæ–¹ä¾¿åˆ·æ–°ï¼Œæœ‰å¯èƒ½è¿™æ¬¡è¿™ä¸ªæŸ¥è¯¢æ˜¯ä¸å­˜åœ¨æ•°æ®ï¼Œä¸‹æ¬¡å°±å­˜åœ¨äº†ï¼Œé‚£äºŒä¸‰æ–¹æ¡ˆå°±æ¯”è¾ƒä¸å¥½å®ç°åˆ·æ–°</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8fded5fb5ba9240871e6bde250173229/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu16.04 ç½‘ç»œè¿æ¥åå¾ˆå¿«æ–­å¼€</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ae8965bdf7e0049e75cc866ff918b00/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">CSSä¸­çš„marginå¡Œé™·å’Œmarginåˆå¹¶BUGä»¥åŠBFCçš„å¸¸è§åº”ç”¨</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>