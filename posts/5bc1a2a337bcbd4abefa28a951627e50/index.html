<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Impala常用函数 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Impala常用函数" />
<meta property="og:description" content="Impala 字符串函数 1、去除字符串之前和之后的任意个数的空格 ​ btrim(string a)
[master:21000] &gt; select btrim(&#39; hello &#39;) as btrim; &#43;-------&#43; | btrim | &#43;-------&#43; | hello | &#43;-------&#43; 2、返回字符串的长度，两个函数功能相同 ​ char_length(string a)
​ character_length(string a)
--char_length得到hello world的长度 [master:21000] &gt; select char_length(&#39;hello world&#39;) as char_length; &#43;-------------&#43; | char_length | &#43;-------------&#43; | 11 | &#43;-------------&#43; --通过函数character_length得到hello world的长度 [master:21000] &gt; select character_length(&#39;hello world&#39;) as character_length; &#43;------------------&#43; | character_length | &#43;------------------&#43; | 11 | &#43;------------------&#43; 3、拼接多个字符串 ​ concat(string a,string b…)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5bc1a2a337bcbd4abefa28a951627e50/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-31T13:25:29+08:00" />
<meta property="article:modified_time" content="2023-01-31T13:25:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Impala常用函数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Impala_0"></a>Impala</h2> 
<h3><a id="_1"></a>字符串函数</h3> 
<h4><a id="1_3"></a>1、去除字符串之前和之后的任意个数的空格</h4> 
<p>​ <strong>btrim(string a)</strong></p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> btrim<span class="token punctuation">(</span><span class="token string">'    hello '</span><span class="token punctuation">)</span> <span class="token keyword">as</span> btrim<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------+</span>
<span class="token operator">|</span> btrim <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+</span>
<span class="token operator">|</span> hello <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------+</span>
</code></pre> 
<h4><a id="2_18"></a>2、返回字符串的长度，两个函数功能相同</h4> 
<p>​ <strong>char_length(string a)</strong></p> 
<p>​ <strong>character_length(string a)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--char_length得到hello world的长度</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> char_length<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> char_length<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> char_length <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> <span class="token number">11</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token comment">--通过函数character_length得到hello world的长度</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> character_length<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> character_length<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token operator">|</span> character_length <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token operator">|</span> <span class="token number">11</span>               <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
</code></pre> 
<h4><a id="3_43"></a>3、拼接多个字符串</h4> 
<p>​ <strong>concat(string a,string b…)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--连接hello和world两个字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'world'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> concat<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------+</span>
<span class="token operator">|</span> concat     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------+</span>
<span class="token operator">|</span> helloworld <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------+</span>
<span class="token comment">--连接hello、world、cauchy三个字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'world'</span><span class="token punctuation">,</span><span class="token string">'cauchy'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> concat<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token operator">|</span> concat           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token operator">|</span> helloworldcauchy <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
</code></pre> 
<h4><a id="4_66"></a>4、拼接多个字符串，由指定分隔符分割</h4> 
<p>​ <strong>concat_ws(string sep,string a,string b…)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--通过'-'连接两个字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> concat_ws<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'world'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> concat_ws<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> concat_ws   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> hello<span class="token operator">-</span>world <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
</code></pre> 
<h4><a id="5__82"></a>5、 返回参数字符串的字符长度</h4> 
<p>​ <strong>length(string a)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--得到字符串'abcdefg'的长度</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> length<span class="token punctuation">(</span><span class="token string">'abcdefg'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> length<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span> length <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span> <span class="token number">7</span>      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
</code></pre> 
<h4><a id="6_98"></a>6、返回参数字符串，并从左侧删除任何前导空格</h4> 
<p>​ <strong>ltrim(string a)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--删除字符串'  hello  '左侧的所有空格</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> ltrim<span class="token punctuation">(</span><span class="token string">'  hello  '</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ltrim<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
<span class="token operator">|</span> ltrim   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
<span class="token operator">|</span> hello   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
</code></pre> 
<h4><a id="7_114"></a>7、返回参数字符串，并从右侧删除任何后置空格</h4> 
<p>​ <strong>rtrim(string a)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--删除字符串'  hello  '右侧的所有空格</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> rtrim<span class="token punctuation">(</span><span class="token string">'  hello  '</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rtrim<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
<span class="token operator">|</span> rtrim   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
<span class="token operator">|</span>   hello <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
</code></pre> 
<h4><a id="8_130"></a>8、去掉字符串中所有前导和后置空格</h4> 
<p>​ <strong>trim(string a)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--去掉'  hello world  '的前导和后置空格</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> trim<span class="token punctuation">(</span><span class="token string">'  hello world  '</span><span class="token punctuation">)</span> <span class="token keyword">as</span> trim<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> trim        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> hello world <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
</code></pre> 
<h4><a id="9_truefalse_146"></a>9、 返回true或者false，表示字符串是否包含正则表达式的值</h4> 
<p>​ <strong>regexp_like(string source,string pattern,[string options])</strong></p> 
<p>options参数：</p> 
<ul><li>c： 区分大小写匹配（默认）</li><li>i：不区分大小写</li><li>m：多行匹配</li><li>n：换行符匹配</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">--判断字符'foo'是否包含'f'</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> regexp_like<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token operator">|</span> regexp_like<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token operator">|</span> <span class="token boolean">true</span>                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token comment">--判断字符'foo'是否包含'F'</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> regexp_like<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token operator">|</span> regexp_like<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token operator">|</span> <span class="token boolean">false</span>                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token comment">--判断字符'foo'是否包含'f',设置参数不区分大小写</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> regexp_like<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------------------+</span>
<span class="token operator">|</span> regexp_like<span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------------------+</span>
<span class="token operator">|</span> <span class="token boolean">true</span>                         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------------------+</span>
</code></pre> 
<h4><a id="10delimitern_183"></a>10、以delimiter字符串作为拆分项，取第n个字符串返回</h4> 
<p>​ <strong>split_part(string source,string delimiter,bigint n)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--以','为分隔符拆分'x,y,z'并返回第1个字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> split_part<span class="token punctuation">(</span><span class="token string">'x,y,z'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token operator">|</span> split_part<span class="token punctuation">(</span><span class="token string">'x,y,z'</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token operator">|</span> x                           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token comment">--以','为分隔符拆分'x,y,z'并返回第2个字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> split_part<span class="token punctuation">(</span><span class="token string">'x,y,z'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token operator">|</span> split_part<span class="token punctuation">(</span><span class="token string">'x,y,z'</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token operator">|</span> y                           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token comment">--以','为分隔符拆分'x,y,z'并返回第3个字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> split_part<span class="token punctuation">(</span><span class="token string">'x,y,z'</span><span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token operator">|</span> split_part<span class="token punctuation">(</span><span class="token string">'x,y,z'</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
<span class="token operator">|</span> z                           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------+</span>
</code></pre> 
<h4><a id="11_n_213"></a>11、 截取字符串，返回左边的n个字符</h4> 
<p>​ <strong>strleft(string a,int num_chars)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--从左边截取字符串'hello world'，返回长度为4的字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> strleft<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">as</span> strleft<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
<span class="token operator">|</span> strleft <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
<span class="token operator">|</span> hell    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------+</span>
</code></pre> 
<h4><a id="12n_229"></a>12、截取字符串，返回右边的n个字符</h4> 
<p>​ <strong>strright(string a,int num_chars)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--从右边截取字符串'hello world'，返回长度为4的字符串</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> strright<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">as</span> strright<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------+</span>
<span class="token operator">|</span> strright <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+</span>
<span class="token operator">|</span> orld     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+</span>
</code></pre> 
<h4><a id="13_245"></a>13、返回从指定点开始的字符串部分,可选地指定最大长度</h4> 
<p>​ <strong>substr(string a,int start,[int len])</strong></p> 
<p>​ <strong>substring(string a,int start,[int len])</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">--截取字符串'hello world'，从第6位开始</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> substr<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">as</span> substr<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span> substr <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span>  world <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token comment">--截取字符串'hello world'，从第6位开始，长度为3</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> substr<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> substr<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span> substr <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token operator">|</span>  wo    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------+</span>
<span class="token comment">--截取字符串'hello world'，从第6位开始</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> substring<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">as</span> substring<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span> substring <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span>  world    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token comment">--截取字符串'hello world'，从第6位开始，长度为3</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> substring<span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> substring<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span> substring <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
<span class="token operator">|</span>  wo       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+</span>
</code></pre> 
<h3><a id="_284"></a>时间函数</h3> 
<h4><a id="1_286"></a>1、当前时间戳</h4> 
<p>​ <strong>now()</strong></p> 
<p>​ <strong>current_timestamp()</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- now()</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token operator">|</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">10</span>:<span class="token number">07</span>:<span class="token number">07.628604000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token comment">-- current_timestamp()</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token keyword">current_timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">current_timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">10</span>:<span class="token number">08</span>:<span class="token number">22.152984000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
</code></pre> 
<h4><a id="2_311"></a>2、时间戳取整</h4> 
<pre><code class="prism language-sql">Impala <span class="token number">2.11</span> 之前的取整当前时间的写法:
<span class="token keyword">select</span> trunc<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'YEAR'</span><span class="token punctuation">)</span> <span class="token comment">--取整到年份, 得到当年 1 月 1 日 0 点 0 分</span>
<span class="token keyword">select</span> trunc<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'MONTH'</span><span class="token punctuation">)</span> <span class="token comment">--取整到月份, 得到当月 1 日 0 点 0 分</span>
<span class="token keyword">select</span> trunc<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'DD'</span><span class="token punctuation">)</span> <span class="token comment">--取整到日期, 得到当天 0 点 0 分</span>
<span class="token keyword">select</span> trunc<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'DAY'</span><span class="token punctuation">)</span> <span class="token comment">--取整到星期, 得到本星期第一天的 0 点 0 分</span>
<span class="token keyword">select</span> trunc<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'HH24'</span><span class="token punctuation">)</span> <span class="token comment">--取整到小时, 得到当前小时的 0 分</span>
<span class="token keyword">select</span> trunc<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'MI'</span><span class="token punctuation">)</span> <span class="token comment">--取整到分钟, 得到当前分钟 0 秒</span>


Impala <span class="token number">2.11</span> 之后增加了 date_trunc<span class="token punctuation">(</span><span class="token punctuation">)</span> 函数<span class="token punctuation">,</span> 下面是几个取整的写法:
date_trunc<span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date_trunc<span class="token punctuation">(</span><span class="token string">'month'</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date_trunc<span class="token punctuation">(</span><span class="token string">'week'</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date_trunc<span class="token punctuation">(</span><span class="token string">'day'</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date_trunc<span class="token punctuation">(</span><span class="token string">'hour'</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date_trunc<span class="token punctuation">(</span><span class="token string">'minute'</span><span class="token punctuation">,</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
date_trunc<span class="token punctuation">(</span><span class="token punctuation">)</span> 的语法和 date_part<span class="token punctuation">(</span><span class="token punctuation">)</span> 类似<span class="token punctuation">,</span> 下面是完整的时间 part 列表:
microseconds
milliseconds
<span class="token keyword">second</span>
<span class="token keyword">minute</span>
<span class="token keyword">hour</span>
<span class="token keyword">day</span>
week
<span class="token keyword">month</span>
<span class="token keyword">year</span>
decade
century
millennium
</code></pre> 
<h4><a id="3_347"></a>3、时间戳提取</h4> 
<p>​ <strong>date_part(‘year’, now())</strong></p> 
<p>​ <strong>extract(now(), ‘year’)</strong></p> 
<p>​ <strong>extract(year from now())</strong></p> 
<p>​ <strong>year(now())</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- date_part('year', now())</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> date_part<span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> date_part<span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span>                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token comment">-- date_part('day', now())</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> date_part<span class="token punctuation">(</span><span class="token string">'day'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token operator">|</span> date_part<span class="token punctuation">(</span><span class="token string">'day'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token operator">|</span> <span class="token number">16</span>                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------+</span>
<span class="token comment">-- extract(now(), 'year')</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> extract<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------------+</span>
<span class="token operator">|</span> extract<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span>                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------------+</span>
<span class="token comment">-- extract(year from now())</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> extract<span class="token punctuation">(</span><span class="token keyword">year</span> <span class="token keyword">from</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> extract<span class="token punctuation">(</span><span class="token keyword">year</span> <span class="token keyword">from</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span>                     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+</span>
<span class="token comment">-- year(now())</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token keyword">year</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span>         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token comment">-- month(now())</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token keyword">month</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token number">1</span>            <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token comment">-- -- day(now())</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token keyword">day</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token keyword">day</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
<span class="token operator">|</span> <span class="token number">16</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------+</span>
</code></pre> 
<h4><a id="4_411"></a>4、时间加减</h4> 
<pre><code class="prism language-sql">时间戳可以直接加减 <span class="token keyword">interval</span> n days<span class="token operator">/</span>months<span class="token operator">/</span>years<span class="token operator">/</span>hours<span class="token operator">/</span>minutes <span class="token punctuation">.</span>

也可以使用下面的函数:
years_add<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
years_sub<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
months_add<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
months_sub<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
days_add<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
days_sub<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
hours_add<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
hours_sub<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
minutes_add<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
minutes_sub<span class="token punctuation">(</span><span class="token keyword">timestamp</span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token comment">-- years_add(now(),2)</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> years_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token operator">|</span> years_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2025</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">10</span>:<span class="token number">35</span>:<span class="token number">30.402209000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------------------------+</span>

也可以用下面两个通用的函数:
date_add<span class="token punctuation">(</span><span class="token keyword">time</span><span class="token punctuation">,</span> <span class="token keyword">interval</span> N months<span class="token punctuation">)</span>
date_sub<span class="token punctuation">(</span><span class="token keyword">time</span><span class="token punctuation">,</span> <span class="token keyword">interval</span> N hours<span class="token punctuation">)</span>

<span class="token comment">-- date_add(time, interval N year)</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> date_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">interval</span> <span class="token number">1</span> years<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+</span>
<span class="token operator">|</span> date_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">interval</span> <span class="token number">1</span> years<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2024</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">10</span>:<span class="token number">45</span>:<span class="token number">26.244200000</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+</span>
<span class="token comment">-- date_sub(time, interval N year)</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> date_sub<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">interval</span> <span class="token number">1</span> years<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+</span>
<span class="token operator">|</span> date_sub<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">interval</span> <span class="token number">1</span> years<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2022</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">10</span>:<span class="token number">45</span>:<span class="token number">49.260996000</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------------------------+</span>
</code></pre> 
<h4><a id="5_457"></a>5、获取月份最后一天</h4> 
<p>​ <strong>last_day(timestamp t)</strong></p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> last_day<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------+</span>
<span class="token operator">|</span> last_day<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">31</span> <span class="token number">00</span>:<span class="token number">00</span>:<span class="token number">00</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+</span>
</code></pre> 
<h4><a id="6_470"></a>6、获取月份间隔</h4> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> months_between<span class="token punctuation">(</span><span class="token string">'2023-06-18'</span><span class="token punctuation">,</span> <span class="token string">'2023-01-18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------+</span>
<span class="token operator">|</span> months_between<span class="token punctuation">(</span><span class="token string">'2023-06-18'</span><span class="token punctuation">,</span> <span class="token string">'2023-01-18'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">5</span>                                          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------+</span>
</code></pre> 
<h4><a id="7_483"></a>7、获取时间间隔天数</h4> 
<p>​ <strong>datediff(end time,start time)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- datediff(end time,start time)</span>
<span class="token punctuation">[</span>master:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> datediff<span class="token punctuation">(</span><span class="token string">'2023-01-18 10:47:24'</span><span class="token punctuation">,</span> <span class="token string">'2023-01-16 15:47:16'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------------------+</span>
<span class="token operator">|</span> datediff<span class="token punctuation">(</span><span class="token string">'2023-01-18 10:47:24'</span><span class="token punctuation">,</span> <span class="token string">'2023-01-16 15:47:16'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2</span>                                                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------------------+</span>
</code></pre> 
<h4><a id="8_497"></a>8、获取前昨天日期</h4> 
<p><strong>yyyyMMdd格式</strong></p> 
<p><strong>substr(regexp_replace(cast(date_sub(now(),1) as string),‘-’,‘’),1,8)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- substr(regexp_replace(cast(date_sub(now(),1) as string),'-',''),1,8)</span>
<span class="token punctuation">[</span>dn02:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> substr<span class="token punctuation">(</span> regexp_replace<span class="token punctuation">(</span>cast<span class="token punctuation">(</span>date_sub<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------------------------+</span>
<span class="token operator">|</span> substr<span class="token punctuation">(</span>regexp_replace<span class="token punctuation">(</span>cast<span class="token punctuation">(</span>date_sub<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">20230129</span>                                                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------------------------------+</span>

</code></pre> 
<p><strong>yyyy-MM-dd格式</strong></p> 
<p><strong>substr(cast(date_sub(now(),1) as string),1,10)</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- substr(cast(date_sub(now(),1) as string),1,10)</span>
<span class="token punctuation">[</span>dn02:<span class="token number">21000</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token keyword">select</span> substr<span class="token punctuation">(</span>cast<span class="token punctuation">(</span>date_sub<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------+</span>
<span class="token operator">|</span> substr<span class="token punctuation">(</span>cast<span class="token punctuation">(</span>date_sub<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token number">2023</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">30</span>                                        <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------------------------------------+</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aa820b856a82789d80bef747e6765b27/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RustDesk自建服务器实录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ce776c0304bd1ee7b624fd7ae90e88b9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【14】IP协议基础及分片</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>