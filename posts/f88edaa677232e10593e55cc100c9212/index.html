<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>动态路由协议——OSPF - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="动态路由协议——OSPF" />
<meta property="og:description" content="动态路由协议 静态路由的缺点在于无法适应网络中的各种变化，每一条路由都是管理员自己手动配置的。
动态路由协议的基本原理不像静态路由那样，它的基本原理就是各个路由器之间通过交互某种报文信息，这种报文中包含了很多自身路由器的信息。这些路由通过报文就可以知道整个网络的情况，当网络中的某些设备发生故障时，这些路由器也会通过这种报文获取得到，从而进行某种算法重新的计算出一个可用的网络。
OSPF——链路状态路由协议 ospf（开放式最短路径优先）是一个基于链路状态的内部网关协议。
目前针对IPv4协议使用的是OSPF Version 2（RFC2328）；针对IPv6协议使用OSPF Version 3（RFC2740）
运行OSPF路由器之间交互的是LS（Link State，链路状态）信息，而不是直接交互路由。LS信息是OSPF能够正常进行拓扑及路由计算的关键信息。
OSPF路由器将网络中的LS信息收集起来，存储在LSDB中。路由器都清楚区域内的网络拓扑结构，这有助于路由器计算无环路径。
每台OSPF路由器都采用SPF算法计算达到目的地的最短路径。路由器依据这些路径形成路由加载到路由表中。 基本术语 区域 OSPF Area用于标识一个OSPF的区域。
区域是从逻辑上将设备划分为不同的组，每个组用区域号（Area ID）来标识。
RouteID Router-ID（Router Identifier，路由器标识符），用于在一个OSPF域中唯一地标识一台路由器。
度量值 OSPF使用Cost（开销）作为路由的度量值。每一个激活了OSPF的接口都会维护一个接口Cost值。 报文协议 报文作用Hello周期性发送，用来发现和维护OSPF邻居关系。Datebase Description描述本地LSDB的摘要信息，用于两台设备进行数据库同步。LinkState Request用于向对方请求所需要的LSA。设备只有在OSPF邻居双方成功交换DD报文，后才会向对方发出LSR报文。Link StateUpdate用于向对方发送其所需要的LSA。Link State ACK用来对收到的LSA进行确认。 三大表项 邻居表 OSPF在传递链路状态信息之前，需先建立OSPF邻居关系。
OSPF的邻居关系通过交互Hello报文建立。
OSPF邻居表显示了OSPF路由器之间的邻居状态，使用display osp fpeer查看。
LSDB表 LSDB会保存自己产生的及从邻居收到的LSA信息
使用命令行display ospf lsdb查看LSDB表。
Type标识LSA的类型，AdvRouter标识发送LSA的路由器。
OSPF路由表 OSPF路由表和路由器路由表是两张不同的表项。
OSPF路由表包含Destination、Cost和NextHop等指导转发的信息。
使用命令display ospfrouting查看OSPF路由表。
工作原理 DR和BDR 在MA网络中，如果每台OSPF路由器都与其他的所有路由器建立OSPF邻接关系，便会导致网络中存在过多的OSPF邻接关系，增加设备负担，也增加了网络中泛洪的OSPF报文数量。
当拓扑出现变更，网络中的LSA泛洪可能会造成带宽的浪费和设备资源的损耗。
为优化MA网络中OSPF邻接关系，OSPF指定了三种OSPF路由器身份，DR（Designated Router，指定路由器）、BDR（Backup Designated Router，备用指定路由器）和DRother路由器。
只允许DR、BDR与其他OSPF路由器建立邻接关系。DRother之间不会建立全毗邻的OSPF邻接关系，双方停滞在2-way状态。
BDR会监控DR的状态，并在当前DR发生故障时接替其角色。
OSPF单区域和多区域 OSPF路由器在同一个区域（Area）内网络中泛洪LSA。如果OSPF域仅有一个区域，随着网络规模越来越大，OSPF路由器
的数量越来越多，这将导致诸多问题：
LSDB越来越庞大，同时导致OSPF路由表规模增加。路由器资源消耗多，设备性能下降，影响数据转发。
基于庞大的LSDB进行路由计算变得困难。
当网络拓扑变更时，LSA全域泛洪和全网SPF重计算带来巨大负担。
OSPF引入区域（Area）的概念，将一个OSPF域划分成多个区域，可以使OSPF支撑更大规模组网。
OSPF多区域的设计减小了LSA泛洪的范围，有效的把拓扑变化的影响控制在区域内，达到网络优化的目的。
OSPF路由器根据其位置或功能不同，有这样几种类型：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f88edaa677232e10593e55cc100c9212/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-29T11:12:20+08:00" />
<meta property="article:modified_time" content="2022-11-29T11:12:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">动态路由协议——OSPF</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>动态路由协议</h3> 
<p>静态路由的缺点在于无法适应网络中的各种变化，每一条路由都是管理员自己手动配置的。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/9e/23/qLgRuyNd_o.png"></p> 
<p>动态路由协议的基本原理不像静态路由那样，它的基本原理就是各个路由器之间通过交互某种报文信息，这种报文中包含了很多自身路由器的信息。这些路由通过报文就可以知道整个网络的情况，当网络中的某些设备发生故障时，这些路由器也会通过这种报文获取得到，从而进行某种算法重新的计算出一个可用的网络。</p> 
<h3>OSPF——链路状态路由协议</h3> 
<ul><li> <p>ospf（开放式最短路径优先）是一个基于链路状态的内部网关协议。</p> </li><li> <p>目前针对IPv4协议使用的是OSPF Version 2（RFC2328）；针对IPv6协议使用OSPF Version 3（RFC2740）</p> </li><li> <p>运行OSPF路由器之间交互的是LS（Link State，链路状态）信息，而不是直接交互路由。LS信息是OSPF能够正常进行拓扑及路由计算的关键信息。</p> </li><li> <p>OSPF路由器将网络中的LS信息收集起来，存储在LSDB中。路由器都清楚区域内的网络拓扑结构，这有助于路由器计算无环路径。</p> </li><li> <p>每台OSPF路由器都采用SPF算法计算达到目的地的最短路径。路由器依据这些路径形成路由加载到路由表中。  </p> </li></ul> 
<h4>基本术语</h4> 
<h4>区域</h4> 
<p>OSPF Area用于标识一个OSPF的区域。</p> 
<p>区域是从逻辑上将设备划分为不同的组，每个组用区域号（Area ID）来标识。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3e/e3/XUARXPJA_o.png"></p> 
<p> </p> 
<h4>RouteID</h4> 
<p>Router-ID（Router Identifier，路由器标识符），用于在一个OSPF域中唯一地标识一台路由器。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7b/00/5A9uxsIu_o.png"> </p> 
<h4>度量值</h4> 
<p>OSPF使用Cost（开销）作为路由的度量值。每一个激活了OSPF的接口都会维护一个接口Cost值。  </p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/51/5d/p6vo4Qfm_o.png"></p> 
<h4> </h4> 
<h4>报文协议</h4> 
<table><thead><tr><th style="text-align:center;">报文</th><th style="text-align:center;">作用</th></tr></thead><tbody><tr><td style="text-align:center;">Hello</td><td style="text-align:center;">周期性发送，用来发现和维护OSPF邻居关系。</td></tr><tr><td style="text-align:center;">Datebase Description</td><td style="text-align:center;">描述本地LSDB的摘要信息，用于两台设备进行数据库同步。</td></tr><tr><td style="text-align:center;">LinkState Request</td><td style="text-align:center;">用于向对方请求所需要的LSA。设备只有在OSPF邻居双方成功交换DD报文，后才会向对方发出LSR报文。</td></tr><tr><td style="text-align:center;">Link StateUpdate</td><td style="text-align:center;">用于向对方发送其所需要的LSA。</td></tr><tr><td style="text-align:center;">Link State ACK</td><td style="text-align:center;">用来对收到的LSA进行确认。</td></tr></tbody></table> 
<h3> </h3> 
<h4>三大表项</h4> 
<h4>邻居表</h4> 
<ul><li> <p>OSPF在传递链路状态信息之前，需先建立OSPF邻居关系。</p> </li><li> <p>OSPF的邻居关系通过交互Hello报文建立。</p> </li><li> <p>OSPF邻居表显示了OSPF路由器之间的邻居状态，使用display osp fpeer查看。</p> </li></ul> 
<h4></h4> 
<h4>LSDB表</h4> 
<ul><li> <p>LSDB会保存自己产生的及从邻居收到的LSA信息</p> </li><li> <p>使用命令行display ospf lsdb查看LSDB表。</p> </li><li> <p>Type标识LSA的类型，AdvRouter标识发送LSA的路由器。</p> </li></ul> 
<h4> OSPF路由表</h4> 
<ul><li> <p>OSPF路由表和路由器路由表是两张不同的表项。</p> </li><li> <p>OSPF路由表包含Destination、Cost和NextHop等指导转发的信息。</p> </li><li> <p>使用命令display ospfrouting查看OSPF路由表。</p> </li></ul> 
<h3>工作原理</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b1/37/rX4qtkHY_o.png"></p> 
<h3>DR和BDR</h3> 
<ul><li> <p>在MA网络中，如果每台OSPF路由器都与其他的所有路由器建立OSPF邻接关系，便会导致网络中存在过多的OSPF邻接关系，增加设备负担，也增加了网络中泛洪的OSPF报文数量。</p> </li><li> <p>当拓扑出现变更，网络中的LSA泛洪可能会造成带宽的浪费和设备资源的损耗。</p> </li></ul> 
<h3 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/99/c1/Nf8FMKgs_o.png"> </h3> 
<ul><li> <p>为优化MA网络中OSPF邻接关系，OSPF指定了三种OSPF路由器身份，DR（Designated Router，指定路由器）、BDR（Backup Designated Router，备用指定路由器）和DRother路由器。</p> </li><li> <p>只允许DR、BDR与其他OSPF路由器建立邻接关系。DRother之间不会建立全毗邻的OSPF邻接关系，双方停滞在2-way状态。</p> </li><li> <p>BDR会监控DR的状态，并在当前DR发生故障时接替其角色。</p> </li></ul> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/71/39/90M3xiDg_o.png"> </p> 
<h3>OSPF单区域和多区域</h3> 
<p>OSPF路由器在同一个区域（Area）内网络中泛洪LSA。如果OSPF域仅有一个区域，随着网络规模越来越大，OSPF路由器</p> 
<p>的数量越来越多，这将导致诸多问题：</p> 
<ol><li> <p>LSDB越来越庞大，同时导致OSPF路由表规模增加。路由器资源消耗多，设备性能下降，影响数据转发。</p> </li><li> <p>基于庞大的LSDB进行路由计算变得困难。</p> </li><li> <p>当网络拓扑变更时，LSA全域泛洪和全网SPF重计算带来巨大负担。</p> </li></ol> 
<p></p> 
<ul><li> <p>OSPF引入区域（Area）的概念，将一个OSPF域划分成多个区域，可以使OSPF支撑更大规模组网。</p> </li><li> <p>OSPF多区域的设计减小了LSA泛洪的范围，有效的把拓扑变化的影响控制在区域内，达到网络优化的目的。</p> </li></ul> 
<p style="text-align:center;"><img alt="" height="384" src="https://images2.imgbox.com/cd/6d/ejVLXCaO_o.png" width="456"> </p> 
<p> </p> 
<p>OSPF路由器根据其位置或功能不同，有这样几种类型：</p> 
<p>▫ 区域内路由器（Internal Router）</p> 
<p>▫ 区域边界路由器ABR（Area Border Router）</p> 
<p>▫ 骨干路由器（Backbone Router）</p> 
<p>▫ 自治系统边界路由器ASBR（AS Boundary Router）</p> 
<p></p> 
<h2>单区域的OSPF配置实验</h2> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/0f/9f/ilExkI2F_o.png"></p> 
<p>实验目的</p> 
<p>1、配置OSPF协议，使得主机之间能够相互通信</p> 
<p>2、查看路由器的邻居信息、LSDB、OSPF路由表</p> 
<p>3、关闭R1和R3之间的链路，观察是否能通信</p> 
<p>查看邻居表</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e8/d7/gd9FIEhp_o.png">R1邻居表，和R2与R3建立了邻居关系  </p> 
<p> 查看LSDB</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/cd/70/dh22LRSf_o.png"></p> 
<p style="text-align:center;">R1路由器均收到来自R2和R3的LS信息</p> 
<p>查看OSPF路由表</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/87/0c/CYKJIuM8_o.png"> </p> 
<p>当关闭了R1和R3之间的链路，R1和R3之间的邻居也就断开了。此时主机仍然可以通信。再次开启的又会再次建立连接，再次进行SPF的计算。</p> 
<p style="text-align:center;"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/14cb3120bc67f5efe014574e4a6dc1ec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JWT在线解码网址和结构介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5c842cb798ebeaa11b452e87ac0c8dcf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">torch-geometric使用过程中的问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>