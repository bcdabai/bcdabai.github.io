<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Centos8/Centos8Stream升级至Centos9Stream,并优化部分设置操作步骤 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Centos8/Centos8Stream升级至Centos9Stream,并优化部分设置操作步骤" />
<meta property="og:description" content="目录
前言
centos8.3以下版本升级到8.5
1、注释mirrorlist
2、指向baseurl至vault.epel.cloud存储库
3、升级系统至Centos 8.5
centos8升级到centos8stream
1、选择新源
2、升级所有软件包至最新稳定发行版
3、安装epel源
4、重启系统
centos8stream升级到centos9stream
1、安装必要包管理工具rpmconf和yum-utils
2、处理所有包的配置文件
3、移除旧版epel源
4、安装Centos-Stream-9相关的包
5、执行升级Centos-Stream-9的命令
6、升级完成后进行相关清理和配置操作
常用优化设置
1、禁用防火墙等
2、安装启动web控制台
总结
前言 centos被redhat收购后，centos官方宣布centos Linux项目将停止维护，并使用新推出的centos stream项目替代。新版的centos stream项目在软件更新方式上与centos存在较大差别，具体详情可查看官方说明。
centos8.3以下版本升级到8.5 1、注释mirrorlist sed -i &#39;s/mirrorlist/#mirrorlist/g&#39; /etc/yum.repos.d/CentOS-*.repo 2、指向baseurl至vault.epel.cloud存储库 sed -i &#39;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.epel.cloud|g&#39; /etc/yum.repos.d/CentOS-*.repo 3、升级系统至Centos 8.5 yum update centos8升级到centos8stream 1、选择新源 dnf --disablerepo &#39;*&#39; --enablerepo extras swap centos-linux-repos centos-stream-repos 2、升级所有软件包至最新稳定发行版 dnf distro-sync 3、安装epel源 dnf -y install epel-release 4、重启系统 reboot centos8stream升级到centos9stream 1、安装必要包管理工具rpmconf和yum-utils dnf -y install rpmconf yum-utils 2、处理所有包的配置文件 如果出现提示，直接输入Y并回车继续，如果没提示继续第三步操作" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0a760c51593026e1c275719995cefe21/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-30T22:17:02+08:00" />
<meta property="article:modified_time" content="2022-10-30T22:17:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Centos8/Centos8Stream升级至Centos9Stream,并优化部分设置操作步骤</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="centos8.3%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7%E5%88%B08.5-toc" style="margin-left:0px;"><a href="#centos8.3%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7%E5%88%B08.5" rel="nofollow">centos8.3以下版本升级到8.5</a></p> 
<p id="1%E3%80%81%E6%B3%A8%E9%87%8Amirrorlist-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E6%B3%A8%E9%87%8Amirrorlist" rel="nofollow">1、注释mirrorlist</a></p> 
<p id="2%E3%80%81%E6%8C%87%E5%90%91baseurl%E8%87%B3vault.epel.cloud%E5%AD%98%E5%82%A8%E5%BA%93-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E6%8C%87%E5%90%91baseurl%E8%87%B3vault.epel.cloud%E5%AD%98%E5%82%A8%E5%BA%93" rel="nofollow">2、指向baseurl至vault.epel.cloud存储库</a></p> 
<p id="3%E3%80%81%E5%8D%87%E7%BA%A7%E7%B3%BB%E7%BB%9F%E8%87%B3Centos%208.5-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E5%8D%87%E7%BA%A7%E7%B3%BB%E7%BB%9F%E8%87%B3Centos%208.5" rel="nofollow">3、升级系统至Centos 8.5</a></p> 
<p id="centos8%E5%8D%87%E7%BA%A7%E5%88%B0centos8stream-toc" style="margin-left:0px;"><a href="#centos8%E5%8D%87%E7%BA%A7%E5%88%B0centos8stream" rel="nofollow">centos8升级到centos8stream</a></p> 
<p id="1%E3%80%81%E9%80%89%E6%8B%A9%E6%96%B0%E6%BA%90-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E9%80%89%E6%8B%A9%E6%96%B0%E6%BA%90" rel="nofollow">1、选择新源</a></p> 
<p id="2%E3%80%81%E5%8D%87%E7%BA%A7%E6%89%80%E6%9C%89%E8%BD%AF%E4%BB%B6%E5%8C%85%E8%87%B3%E6%9C%80%E6%96%B0%E7%A8%B3%E5%AE%9A%E5%8F%91%E8%A1%8C%E7%89%88-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E5%8D%87%E7%BA%A7%E6%89%80%E6%9C%89%E8%BD%AF%E4%BB%B6%E5%8C%85%E8%87%B3%E6%9C%80%E6%96%B0%E7%A8%B3%E5%AE%9A%E5%8F%91%E8%A1%8C%E7%89%88" rel="nofollow">2、升级所有软件包至最新稳定发行版</a></p> 
<p id="3%E3%80%81%E5%AE%89%E8%A3%85epel%E6%BA%90-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E5%AE%89%E8%A3%85epel%E6%BA%90" rel="nofollow">3、安装epel源</a></p> 
<p id="4%E3%80%81%E9%87%8D%E5%90%AF%E7%B3%BB%E7%BB%9F-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E9%87%8D%E5%90%AF%E7%B3%BB%E7%BB%9F" rel="nofollow">4、重启系统</a></p> 
<p id="-toc" style="margin-left:0px;"><a href="#" rel="nofollow">centos8stream升级到centos9stream</a></p> 
<p id="1%E3%80%81%E5%AE%89%E8%A3%85%E5%BF%85%E8%A6%81%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7rpmconf%E5%92%8Cyum-utils-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E5%AE%89%E8%A3%85%E5%BF%85%E8%A6%81%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7rpmconf%E5%92%8Cyum-utils" rel="nofollow">1、安装必要包管理工具rpmconf和yum-utils</a></p> 
<p id="2%E3%80%81%E5%A4%84%E7%90%86%E6%89%80%E6%9C%89%E5%8C%85%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E5%A4%84%E7%90%86%E6%89%80%E6%9C%89%E5%8C%85%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">2、处理所有包的配置文件</a></p> 
<p id="3%E3%80%81%E7%A7%BB%E9%99%A4%E6%97%A7%E7%89%88epel%E6%BA%90-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E7%A7%BB%E9%99%A4%E6%97%A7%E7%89%88epel%E6%BA%90" rel="nofollow">3、移除旧版epel源</a></p> 
<p id="4%E3%80%81%E5%AE%89%E8%A3%85Centos-Stream-9%E7%9B%B8%E5%85%B3%E7%9A%84%E5%8C%85-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E5%AE%89%E8%A3%85Centos-Stream-9%E7%9B%B8%E5%85%B3%E7%9A%84%E5%8C%85" rel="nofollow">4、安装Centos-Stream-9相关的包</a></p> 
<p id="5%E3%80%81%E6%89%A7%E8%A1%8C%E5%8D%87%E7%BA%A7Centos-Stream-9%E7%9A%84%E5%91%BD%E4%BB%A4-toc" style="margin-left:40px;"><a href="#5%E3%80%81%E6%89%A7%E8%A1%8C%E5%8D%87%E7%BA%A7Centos-Stream-9%E7%9A%84%E5%91%BD%E4%BB%A4" rel="nofollow">5、执行升级Centos-Stream-9的命令</a></p> 
<p id="6%E3%80%81%E5%8D%87%E7%BA%A7%E5%AE%8C%E6%88%90%E5%90%8E%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%85%B3%E6%B8%85%E7%90%86%E5%92%8C%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#6%E3%80%81%E5%8D%87%E7%BA%A7%E5%AE%8C%E6%88%90%E5%90%8E%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%85%B3%E6%B8%85%E7%90%86%E5%92%8C%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C" rel="nofollow">6、升级完成后进行相关清理和配置操作</a></p> 
<p id="-toc" style="margin-left:0px;"><a href="#" rel="nofollow">常用优化设置</a></p> 
<p id="1%E3%80%81%E7%A6%81%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E7%AD%89-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E7%A6%81%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E7%AD%89" rel="nofollow">1、禁用防火墙等</a></p> 
<p id="2%E3%80%81%E5%AE%89%E8%A3%85%E5%90%AF%E5%8A%A8web%E6%8E%A7%E5%88%B6%E5%8F%B0-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E5%AE%89%E8%A3%85%E5%90%AF%E5%8A%A8web%E6%8E%A7%E5%88%B6%E5%8F%B0" rel="nofollow">2、安装启动web控制台</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p>centos被redhat收购后，centos官方宣布centos Linux项目将停止维护，并使用新推出的centos stream项目替代。新版的centos stream项目在软件更新方式上与centos存在较大差别，具体详情可查看官方说明。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f9/89/BRdgQ8Tv_o.png"></p> 
<p> </p> 
<h2 id="centos8.3%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7%E5%88%B08.5">centos8.3以下版本升级到8.5</h2> 
<h3 id="1%E3%80%81%E6%B3%A8%E9%87%8Amirrorlist">1、注释mirrorlist</h3> 
<pre><code class="language-bash">sed -i 's/mirrorlist/#mirrorlist/g' /etc/yum.repos.d/CentOS-*.repo</code></pre> 
<h3 id="2%E3%80%81%E6%8C%87%E5%90%91baseurl%E8%87%B3vault.epel.cloud%E5%AD%98%E5%82%A8%E5%BA%93">2、指向baseurl至vault.epel.cloud存储库</h3> 
<pre><code class="language-bash">sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://vault.epel.cloud|g' /etc/yum.repos.d/CentOS-*.repo</code></pre> 
<h3 id="3%E3%80%81%E5%8D%87%E7%BA%A7%E7%B3%BB%E7%BB%9F%E8%87%B3Centos%208.5">3、升级系统至Centos 8.5</h3> 
<pre><code class="language-bash">yum update</code></pre> 
<h2 id="centos8%E5%8D%87%E7%BA%A7%E5%88%B0centos8stream">centos8升级到centos8stream</h2> 
<h3 id="1%E3%80%81%E9%80%89%E6%8B%A9%E6%96%B0%E6%BA%90">1、选择新源</h3> 
<pre><code class="language-bash">dnf --disablerepo '*' --enablerepo extras swap centos-linux-repos centos-stream-repos</code></pre> 
<h3 id="2%E3%80%81%E5%8D%87%E7%BA%A7%E6%89%80%E6%9C%89%E8%BD%AF%E4%BB%B6%E5%8C%85%E8%87%B3%E6%9C%80%E6%96%B0%E7%A8%B3%E5%AE%9A%E5%8F%91%E8%A1%8C%E7%89%88">2、升级所有软件包至最新稳定发行版</h3> 
<pre><code class="language-bash">dnf distro-sync</code></pre> 
<h3 id="3%E3%80%81%E5%AE%89%E8%A3%85epel%E6%BA%90">3、安装epel源</h3> 
<pre><code class="language-bash">dnf -y install epel-release</code></pre> 
<h3 id="4%E3%80%81%E9%87%8D%E5%90%AF%E7%B3%BB%E7%BB%9F">4、重启系统</h3> 
<pre><code class="language-bash">reboot</code></pre> 
<h2>centos8stream升级到centos9stream</h2> 
<h3 id="1%E3%80%81%E5%AE%89%E8%A3%85%E5%BF%85%E8%A6%81%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7rpmconf%E5%92%8Cyum-utils">1、安装必要包管理工具rpmconf和yum-utils</h3> 
<pre><code class="language-bash">dnf -y install rpmconf yum-utils</code></pre> 
<h3 id="2%E3%80%81%E5%A4%84%E7%90%86%E6%89%80%E6%9C%89%E5%8C%85%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">2、处理所有包的配置文件</h3> 
<p>如果出现提示，直接输入Y并回车继续，如果没提示继续第三步操作</p> 
<pre><code class="language-bash">rpmconf -a</code></pre> 
<h3 id="3%E3%80%81%E7%A7%BB%E9%99%A4%E6%97%A7%E7%89%88epel%E6%BA%90">3、移除旧版epel源</h3> 
<pre><code class="language-bash">dnf -y remove rpmconf yum-utils epel-release</code></pre> 
<h3 id="4%E3%80%81%E5%AE%89%E8%A3%85Centos-Stream-9%E7%9B%B8%E5%85%B3%E7%9A%84%E5%8C%85">4、安装Centos-Stream-9相关的包</h3> 
<p>安装过程中有可能出现文件找不到的提示，不用理会直接继续</p> 
<pre><code class="language-bash">rpm -e --nodeps `rpm -qa|grep centos`
rpm -ivh --nodeps --force https://mirrors.aliyun.com/centos-stream/9-stream/BaseOS/x86_64/os/Packages/centos-stream-release-9.0-12.el9.noarch.rpm
rpm -ivh --nodeps --force https://mirrors.aliyun.com/centos-stream/9-stream/BaseOS/x86_64/os/Packages/centos-gpg-keys-9.0-12.el9.noarch.rpm
rpm -ivh --nodeps --force https://mirrors.aliyun.com/centos-stream/9-stream/BaseOS/x86_64/os/Packages/centos-stream-repos-9.0-12.el9.noarch.rpm
dnf clean all</code></pre> 
<h3 id="5%E3%80%81%E6%89%A7%E8%A1%8C%E5%8D%87%E7%BA%A7Centos-Stream-9%E7%9A%84%E5%91%BD%E4%BB%A4">5、执行升级Centos-Stream-9的命令</h3> 
<pre><code class="language-bash">dnf -y --releasever=9-stream --allowerasing --setopt=deltarpm=false distro-sync</code></pre> 
<h3 id="6%E3%80%81%E5%8D%87%E7%BA%A7%E5%AE%8C%E6%88%90%E5%90%8E%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%85%B3%E6%B8%85%E7%90%86%E5%92%8C%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C">6、升级完成后进行相关清理和配置操作</h3> 
<pre><code class="language-bash">#重建rpm数据库
rpm --rebuilddb
#卸载Centos-Stream-8的内核，卸载时可能会报错，一般断开所有远程连接后再次运行命令即可
rpm -e --nodeps `rpm -qa|grep -i kernel`
#安装新内核及必要语言包
dnf -y install kernel kernel-core shim
#安装基础环境
dnf group install minimal-environment -y
#安装epel源、rpmconf和yum-utils
dnf -y install epel-release
dnf -y install rpmconf yum-utils
#禁用无效module，处理：冲突的请求，此步需要注意根据具体的冲突的包来禁用
dnf module disable mariadb:10.3 python36 -y
#更新系统
dnf -y update
#再次处理包配置
rpmconf -a</code></pre> 
<h2 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/57/6f/xVknn124_o.png"></h2> 
<p> </p> 
<h2>常用优化设置</h2> 
<h3 id="1%E3%80%81%E7%A6%81%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99%E7%AD%89"><br> 1、禁用防火墙等</h3> 
<pre><code class="language-bash">#禁用防火墙
systemctl disable --now firewalld.service
#禁用SELINUX
setenforce 0
sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/sysconfig/selinux
sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config</code></pre> 
<h3 id="2%E3%80%81%E5%AE%89%E8%A3%85%E5%90%AF%E5%8A%A8web%E6%8E%A7%E5%88%B6%E5%8F%B0">2、安装启动web控制台</h3> 
<p>cockpit是一个交互式 Linux 服务器管理接口，能够方便的通过web界面来管理Linux服务器的相关硬件资源和服务，以下是相关的安装和启动命令。</p> 
<pre><code class="language-bash">#安装cockpit
dnf install cockpit -y
#启动并设置自启动服务
systemctl enable --now cockpit.socket
#安装相关插件
dnf install -y cockpit-machines cockpit-podman cockpit-composer</code></pre> 
<h2 id="%E6%80%BB%E7%BB%93">总结</h2> 
<p>以上就是centos8升级centos9stream的操作步骤，此操作步骤已经实际验证过，可以正确运行，请放心使用。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26a14634315d3b710a7205b178b31d76/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">typescript number 转 string（转）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a22d1195b520b08f7dc1edb8ee79839c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Windows子系统for Linux Ubuntu安装位置转移</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>