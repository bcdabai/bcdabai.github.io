<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ado.Net连接数据库的两种方式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ado.Net连接数据库的两种方式" />
<meta property="og:description" content="一.使用Command和DataReader对象：
（1）.首先连接数据库有两种模式：
1.混合连接模式 该模式需要输入登录名和密码
代码如下：
string Myconnection =&#34;server=服务器名称（如果是本地也可以用.来代替）;database=连接的数据库名称;&#34;;uid=登录名；pwd=密码&#34;;
SqlConnection conn=new SqlConnection(Myconnection);
2.Window连接模式 该模式必须将Trusted_connection=true
string Myconnection=&#34;server=服务器名称;database=连接的数据库名称;Trusted_connection=true&#34;;
SqlConnection conn=new SqlConnection(Myconnection);
(2).调用Connection对象的Open方法打开连接
(3).连接数据源(指的是连接到具体的数据库文件中)有两种方式
1.通过Command对象和DataReader对象
2.通过DataSet对象和DataAdapter对象(适用于经常更改数据库)
(4).从数据源读取数据 (5).调用Command对象的Close方法关闭连接 二.下面是两种连接数据源方法的代码：
（Command对象和DataReader对象）此方法需要引用using System.Data.SqlClient命名空间
string StrSql = &#34;server=.;database=BookDB;trusted_connection=true&#34;;
SqlConnection conn = new SqlConnection(StrSql);
SqlCommand com = new SqlCommand();
//封装连接数据源的方法
ADOCRUDByCommend(conn, com);
//使用try catch finally catch可以将Try代码块的错误捕捉，而且使用该方法的好处是try中的代码无论是否出错都可以编译，如果代码出错catch将会显示出错，最后执行finally中的语句。
try
{
conn.Open();
//数据库中的CRUD(增删查改)操作语句
string Sqlstr = &#34;select * from Table1&#34;;
//string Sqlstr = &#34;insert into Table1 values(&#39;05&#39;,&#39;005&#39;,&#39;0005&#39;,&#39;0005&#39;)&#34;;
//string Sqlstr = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0993cd49c6c80cc769da71e4f85d24a1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-01-29T15:45:13+08:00" />
<meta property="article:modified_time" content="2018-01-29T15:45:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ado.Net连接数据库的两种方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一.使用Command和DataReader对象：</p> 
<p>（1）.首先连接数据库有两种模式：</p> 
<p>1.混合连接模式 该模式需要输入登录名和密码</p> 
<p>代码如下：</p> 
<p>string Myconnection ="server=服务器名称（如果是本地也可以用.来代替）;database=连接的数据库名称;";uid=登录名；pwd=密码";</p> 
<p>SqlConnection conn=new SqlConnection(Myconnection);</p> 
<p>2.Window连接模式 该模式必须将Trusted_connection=true</p> 
<p>string Myconnection="server=服务器名称;database=连接的数据库名称;Trusted_connection=true";</p> 
<p>SqlConnection conn=new SqlConnection(Myconnection);</p> 
<p>(2).调用Connection对象的Open方法打开连接</p> 
<p>(3).连接数据源(指的是连接到具体的数据库文件中)有两种方式</p> 
<p>1.通过Command对象和DataReader对象</p> 
<p>2.通过DataSet对象和DataAdapter对象(适用于经常更改数据库)</p> 
<p>(4).从数据源读取数据 </p> 
<p>(5).调用Command对象的Close方法关闭连接    </p> 
<p>二.下面是两种连接数据源方法的代码：</p> 
<p>（Command对象和DataReader对象）此方法需要引用using System.Data.SqlClient命名空间</p> 
<p>string StrSql = "server=.;database=BookDB;trusted_connection=true";<br>             SqlConnection conn = new SqlConnection(StrSql);<br>             SqlCommand com = new SqlCommand();</p> 
<p>//封装连接数据源的方法<br>             ADOCRUDByCommend(conn, com);<br> </p> 
<p>//使用try catch finally catch可以将<span style='font-family:"Microsoft YaHei"; font-size:14px; background-color:rgb(255,255,255)'>Try代码块的错误捕捉，而且使用该方法的好处是try中的代码无论是否出错都可以编译，如果代码出错catch将会显示出错，最后执行finally中的语句。</span></p> 
<p> try<br>             {<!-- --><br>                 conn.Open();</p> 
<p>//数据库中的CRUD(增删查改)操作语句<br>                 string Sqlstr = "select * from Table1";<br>                 //string Sqlstr = "insert into Table1 values('05','005','0005','0005')";<br>                 //string Sqlstr = "delete from Table1 where date=01";<br>                 //string Sqlstr = "update Table1 set English='00001' where English='1' ";<br>                 com.Connection = conn;<br>                 com.CommandText = Sqlstr;</p> 
<p>//实例化一个读取数据的对象（由于DataReader是抽象类 不能直接实例化，因此要通过Command对象的ExcuteReader方法返回DataReader实例）<br>                 SqlDataReader Mydatrder = com.ExecuteReader();</p> 
<p>//Read()方法是用来移动记录指针到下一行<br>                 while (Mydatrder.Read())<br>                 {<!-- --><br>                     string date = Mydatrder["date"].ToString();<br>                     string china = Mydatrder["china"].ToString();<br>                     string math = Mydatrder["math"].ToString();<br>                     string English = Mydatrder["English"].ToString();</p> 
<p>//将查询结果输出<br>                     Console.WriteLine("{0},{1},{2},{3}", date, china, math, English);<br>                 }<br>             }<br>             catch (Exception ex)<br>             {<!-- --><br>                 Console.WriteLine(ex.Message);<br>             }<br>             finally<br>             {<!-- --><br>                 conn.Close();<br>                 Console.ReadKey();<br>             }<br> </p> 
<p><br> </p> 
<p>（DataSet对象和DataAdapter对象）此方法需要引用using System.Data.SqlClient和<br> using System.Data命名空间</p> 
<p> string Cstring = "server=.;database=BookDB;trusted_connection=true";<br>             //定义Myconn对象连接数据库<br>             SqlConnection Myconn = new SqlConnection(Cstring);</p> 
<p>//数据库中的CRUD语句<br>             //string Sql = "select * from Table1 where date=01";<br>             //string Sql = "insert into Table1 values('06','006','0006','00006')";<br>             //string Sql = "update Table1 set date='07' where date='06'";<br>             string Sql = "delete Table1 where date='07'";<br>             //定义DataSet对象存储数据<br>             System.Data.DataSet MyDataSet = new System.Data.DataSet();<br>             SqlDataAdapter MyDataAdapter = new SqlDataAdapter(Sql,Myconn);<br>             //调用Fill()方法将数据填充到DataSet中<br>             MyDataAdapter.Fill(MyDataSet);<br>             //调用Connection中open()打开连接 <br>             Myconn.Open();</p> 
<p>//读取符合条件的数据<br>             foreach (DataTable table in MyDataSet.Tables)<br>             {<!-- --><br>                 foreach (DataRow row in table.Rows)<br>                 {<!-- --><br>                     foreach (object field in row.ItemArray)<br>                     {<!-- --><br>                         Console.Write(field);<br>                     }<br>                     //相应的行处理<br>                     Console.WriteLine(row);<br>                 }<br>                 //相应的表处理<br>                 Console.WriteLine(table);<br>             }<br>             //Console.WriteLine(MyDataSet.Tables[0].Rows[0][2]);<br>             Console.ReadKey();<br>             Myconn.Close();<br> </p> 
<p>                                                                                                                                                           </p> 
<p><br> </p> 
<p><br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/74075e650e9ab5c347fcd22f5a047e8a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Anaconda找包，安装包时，遇到PackageNotFoundError： &#39;&#39;Package missing in current channels&#34;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d94d45f8ebcf6dab6c0e9b4243054e60/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">05 正负样本的准备</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>