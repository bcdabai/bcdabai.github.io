<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OCC之HelloWorld - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="OCC之HelloWorld" />
<meta property="og:description" content="一个Viewer管理多个view对象,一个view就是一个视图。它不与具体的窗口关联。
构造一个view需要两个对象: 一个是Aspect_WindowDriver的子类对象，一个是Viewer。
Aspect_WindowDriver的父类是Aspect_Driver，它有画直线段，多边形等纯虚函数。
可以把它看成是抽象的GDI，即用来画图。在windows平台下，可使用Aspect_WindowDriver
的子类WNT_WDriver。构造这个对象只需要一个WNT_Window对象。它是Aspect_Window的子类。
WNT_Window是一个被包装的窗口。传入父窗体句柄，然后调用CreateWindow的API，创建一个Windows OS
的窗口。New 一个WNT_Window需要父窗口句柄和WNT_GraphicDevice对象。它的父类是
Aspect_GraphicDevice，是一个颜色管理类。在Windows,X-Window ,及各种显卡，它们显
示颜色方式不统一，OCC为是可移植到其它系统上，创建了这个颜色管理类。
WNT_GraphicDevice是它的子类，针对Windows NT平台。只要new 一个
WNT_GraphicDevice就可以用了。
好了，我们用代码描述创建一个OCC窗口的过程。
device = new WNT_GraphicDevice;
win = new WNT_Window(device, 父窗口句柄);
Driver = new WNT_WDriver(win);
View = newV2d_View(driver,已先创建的Viewer对象);
创建Viewer对象，需要一个WNT_GraphicDevice对象。
下面的例子，显示了一个金黄色的窗口。
附加包含目录 $(CASROOT)\inc
附加依赖项 TKernel.lib TKService.lib TKV2d.lib
代码如下
//mfc.h #include &lt;Handle_V2d_View.hxx&gt; class CMFCApp : public CWinApp { public: virtual BOOL InitInstance(); }; class CMainWindow : public CFrameWnd { public: CMainWindow(); protected: Handle_V2d_View pV2dView;	protected: afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct); DECLARE_MESSAGE_MAP () }; //MFC." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/675194b9cc0d5f432911833b58f5a88b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-07-17T21:31:03+08:00" />
<meta property="article:modified_time" content="2011-07-17T21:31:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OCC之HelloWorld</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote style="border: none; padding: 0px;"> 
 <p><br></p> 
</blockquote> 
<p><span style="font-family:Times New Roman;"></span><span style="font-family:宋体;">一个Viewer管理多个view对象,一个view就是一个视图。它不与具体的窗口关联。<br>构造一个view需要两个对象: </span><span style="font-family:宋体;">一个是</span>Aspect_WindowDriver的子类对象，一个是<span style="font-family:Times New Roman;">Viewer</span><span style="font-family:宋体;">。</span></p> 
<p><span style="font-family:宋体;"></span>Aspect_WindowDriver的父类是Aspect_Driver，它有画直线段，多边形等纯虚函数。</p> 
<p>可以把它看成是抽象的<span style="font-family:Times New Roman;">GDI</span><span style="font-family:宋体;">，即用</span><span style="font-family:宋体;">来画图。在</span><span style="font-family:Times New Roman;">windows</span><span style="font-family:宋体;">平台下，可使用</span>Aspect_WindowDriver</p> 
<p>的子类WNT_WDriver。构造这个对象只需要一个WNT_Window对象。它是Aspect_Window的子类。</p> 
<p>WNT_Window是一个被包装的窗口。传入父窗体句柄，然后调用CreateWindow<span style="font-family:宋体;">的</span><span style="font-family:Times New Roman;">API</span><span style="font-family:宋体;">，创建一个</span><span style="font-family:Times New Roman;">Windows OS</span></p> 
<p><span style="font-family:Times New Roman;"></span><span style="font-family:宋体;">的窗口。</span>New <span style="font-family:宋体;">一个</span><span style="font-family:Times New Roman;">WNT_Window</span>需要父窗口句柄和WNT_GraphicDevice对象。它的父类是</p> 
<p>Aspect_GraphicDevice，是一个颜色管理类。在Windows,X-Window ,<span style="font-family:宋体;">及各种显卡，它们显</span></p> 
<p><span style="font-family:宋体;">示颜色方式不统一，</span><span style="font-family:Times New Roman;">OCC</span><span style="font-family:宋体;">为是可移植到其它系统上，创建了这个颜色管理类。</span></p> 
<p><span style="font-family:宋体;"></span>WNT_GraphicDevice是它的子类，针对Windows NT<span style="font-family:宋体;">平台。只要</span><span style="font-family:Times New Roman;">new </span><span style="font-family:宋体;">一个</span></p> 
<p><span style="font-family:宋体;"></span>WNT_GraphicDevice就可以用了。</p> 
<p><br></p> 
<p>好了，我们用代码描述创建一个OCC<span style="font-family:宋体;">窗口的过程。</span></p> 
<p>device = new WNT_GraphicDevice;</p> 
<p> win = new WNT_Window(device, <span style="font-family:宋体;">父窗口句柄</span><span style="font-family:Times New Roman;">);</span></p> 
<p>Driver = new WNT_WDriver(win);</p> 
<p>View = newV2d_View(driver,<span style="font-family:宋体;">已先创建的</span><span style="font-family:Times New Roman;">Viewer</span><span style="font-family:宋体;">对象</span><span style="font-family:Times New Roman;">);</span></p> 
<p>创建<span style="font-family:Times New Roman;">Viewer</span><span style="font-family:宋体;">对象，</span>需要一个WNT_GraphicDevice<span style="font-family:宋体;">对象。</span></p> 
<p>下面的例子，显示了一个金黄色的窗口。</p> 
<p>附加包含目录 <span style="font-family:Times New Roman;">$(CASROOT)\inc</span></p> 
<p>附加依赖项 <span style="font-family:Times New Roman;">TKernel.lib TKService.lib TKV2d.lib</span></p> 
<p><span style="font-family:Times New Roman;">代码如下</span></p> 
<p><span style="font-family:Times New Roman;"></span></p> 
<pre><code class="language-cpp">//mfc.h
#include &lt;Handle_V2d_View.hxx&gt;

class CMFCApp : public CWinApp
{
public:
	virtual BOOL InitInstance();

};

class CMainWindow : public CFrameWnd
{
public:
	CMainWindow();
protected:
	Handle_V2d_View  pV2dView;	
protected:
	afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
	DECLARE_MESSAGE_MAP ()
};

//MFC.cpp
#include &lt;afxwin.h&gt;
#include "resource.h"
#include "MFC.H"
#include "OCCMgr.h"
#include &lt;Quantity_Color.hxx&gt;
#include &lt;V2d_View.hxx&gt;

CMFCApp theApp;

BOOL CMFCApp::InitInstance()
{
    m_pMainWnd = new CMainWindow; 
	m_pMainWnd-&gt;ShowWindow(m_nCmdShow);
	m_pMainWnd-&gt;UpdateWindow();
	return TRUE;
}

BEGIN_MESSAGE_MAP (CMainWindow, CFrameWnd)
	//ON_WM_PAINT ()
	ON_WM_CREATE()
END_MESSAGE_MAP ()


CMainWindow::CMainWindow()
{
	Create(NULL,_T("A Simple MFC Program!"));
}

int CMainWindow::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
	pV2dView = OCCMgr::Get()-&gt;CreatView(this-&gt;m_hWnd);
	pV2dView-&gt;SetBackground(Quantity_Color(Quantity_NOC_GOLD));
	return 0;
}

//OCCMgr.h
#pragma once
#include &lt;v2d_viewer.hxx&gt;
#include &lt;Handle_WNT_GraphicDevice.hxx&gt;
#include &lt;Handle_V2d_View.hxx&gt;
#include &lt;Handle_WNT_WDriver.hxx&gt;
#include &lt;Handle_WNT_Window.hxx&gt;

class OCCMgr
{
public:
	static OCCMgr * Get();
	Handle_V2d_View CreatView(HWND parentHwnd);
protected:
	OCCMgr();
protected:
	Handle_V2d_Viewer m_pViewer;
	Handle_WNT_GraphicDevice m_pGraphicDevice;
	Handle_V2d_View m_pView;
	
};

//OCCMgr.cpp
#include "afxwin.h"
#include "OCCMgr.h"
#include &lt;WNT_WClass.hxx&gt;
#include &lt;WNT_Window.hxx&gt;
#include &lt;WNT_WDriver.hxx&gt;
#include &lt;V2d_View.hxx&gt;
#include &lt;WNT_GraphicDevice.hxx&gt;

OCCMgr * OCCMgr::Get()
{
	static OCCMgr mgr;
	return &amp; mgr;
}

OCCMgr::OCCMgr()
{
	try
	{m_pGraphicDevice = new WNT_GraphicDevice();}
	catch(Standard_Failure)
	{
		AfxMessageBox("Fatal error during graphic initialization",MB_ICONSTOP);
		ExitProcess(1);
	}

	TCollection_ExtendedString Name("Viewer 2D");
	TCollection_AsciiString Domain("My Domain");
	m_pViewer = new V2d_Viewer(m_pGraphicDevice,
		Name.ToExtString(),
		Domain.ToCString());
}

Handle_V2d_View OCCMgr::CreatView(HWND parentHwnd)
{
	 Handle_WNT_Window pWin = new WNT_Window(m_pGraphicDevice, parentHwnd);
	 Handle_WNT_WDriver pDriver = new WNT_WDriver(pWin);
	 m_pView = new V2d_View(pDriver, m_pViewer);
	 return m_pView;
}</code></pre> 
<p></p> 
<p><span style="font-family:Times New Roman;"><br></span></p> 
<img src="https://images2.imgbox.com/09/85/L2eeuwCl_o.gif" alt=""> 
<br> 
<br> 
<p><span style="font-family:Times New Roman;"><br></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8e77c30fa4ff0adf367b56af5e0b1f17/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pthread_cond_init</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a8359e8d6bcf1eb1a539a17e6fd9b0ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">批处理(.bat)文件中使用相对路径</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>