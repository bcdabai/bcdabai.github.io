<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>wangEditor5 富文本编辑器基于 vue3、Nuxt3 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="wangEditor5 富文本编辑器基于 vue3、Nuxt3" />
<meta property="og:description" content="这是官方dome: https://www.wangeditor.com/demo/index.html 使用这个插件会遇到的一些问题 已解决：
1.使用5.1.23的最新的话：视频尺寸编辑会有问题
2.setHtml 不可以设置值 提示不存在 上传图片 上传视频
3.刷新页面 编辑器数据不存在
这篇文章主要讲一下创建 引入 图片上传 粘贴 视频上传等
在项目中安装
yarn安装 yarn add @wangeditor/editor yarn add @wangeditor/editor-for-vue@next npm 安装 npm install @wangeditor/editor npm install @wangeditor/editor-for-vue@next 这里我是通过创建组件来使用 你们也可以直接在想要的页面直接引入就好
这个是部分代码截图：
第一步：首先创建一个组件wangeditor.vue
这里讲一下vue3和nuxt引入 我们除了引入不同 其他的都是一样的 我们在wangeditor.vue组件里面引入wangeditor
vue3的引入方法：
import &#34;@wangeditor/editor/dist/css/style.css&#34;;
import { Editor, Toolbar} from &#39;@wangeditor/editor-for-vue&#39;
Nuxt的引入方法： 因为在Nuxt中是分服务端跟客户端的所以这里我们需要判断一下
方法1： if (process.client) {
const { Editor, Toolbar } = await import(&#34;@wangeditor/editor-for-vue&#34;);
}
方法2：在父组件使用
&lt;ClientOnly&gt;
&lt;h-wangeditor /&gt;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0d16a58d3ba9f9d666c806c95c8aa2db/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-28T16:19:54+08:00" />
<meta property="article:modified_time" content="2023-06-28T16:19:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">wangEditor5 富文本编辑器基于 vue3、Nuxt3</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code>这是官方dome: https://www.wangeditor.com/demo/index.html</code></pre> 
<p>使用这个插件会遇到的一些问题 <span style="color:#fe2c24;">已解决</span>：</p> 
<blockquote> 
 <p>1.使用5.1.23的最新的话：视频尺寸编辑会有问题</p> 
 <p>2.setHtml 不可以设置值 提示不存在 上传图片 上传视频</p> 
 <p>3.刷新页面 编辑器数据不存在</p> 
</blockquote> 
<p>这篇文章主要讲一下<u><strong>创建 引入 图片<span style="color:#fe2c24;">上传</span> <span style="color:#fe2c24;">粘贴</span> 视频上传</strong></u>等</p> 
<p>在项目中<span style="color:#fe2c24;"><strong>安装</strong></span></p> 
<pre><code>yarn安装
    yarn add @wangeditor/editor
    yarn add @wangeditor/editor-for-vue@next
npm 安装
    npm install @wangeditor/editor
    npm install @wangeditor/editor-for-vue@next</code></pre> 
<p>这里我是通过创建组件来使用 你们也可以直接在想要的页面直接引入就好</p> 
<p>这个是部分代码截图：</p> 
<p><img alt="" height="367" src="https://images2.imgbox.com/53/25/D7yQE8T1_o.png" width="1111"></p> 
<p> 第一步：首先创建一个组件wangeditor.vue</p> 
<blockquote> 
 <p>这里讲一下vue3和nuxt引入 我们除了引入不同 其他的都是一样的 我们在wangeditor.vue组件里面引入wangeditor</p> 
 <p><span style="color:#fe2c24;"><strong>vue3的引入方法</strong></span>：</p> 
 <p>        import "@wangeditor/editor/dist/css/style.css";</p> 
 <p>        import { Editor, Toolbar} from '@wangeditor/editor-for-vue'</p> 
 <p><span style="color:#fe2c24;"><strong>Nuxt的引入方法： 因为在Nuxt中是分服务端跟客户端的所以这里我们需要判断一下</strong></span></p> 
 <p>方法1：       </p> 
 <p> if (process.client) {<!-- --></p> 
 <p>                const { Editor, Toolbar } = await import("@wangeditor/editor-for-vue");</p> 
 <p>        }</p> 
 <p>方法2：在父组件使用</p> 
 <p> &lt;ClientOnly&gt;</p> 
 <p>        &lt;h-wangeditor /&gt;</p> 
 <p> &lt;/ClientOnly&gt;</p> 
 <p> 然后再子组件就可以用vue3的引入方式了</p> 
</blockquote> 
<p>wangeditor.vue组件代码：</p> 
<p>vue3引入：</p> 
<pre><code class="language-html">&lt;template&gt;
  &lt;div class="py-5px"&gt;
    &lt;Toolbar style="border-bottom: 1px solid #ccc" :editor="editorRef" :defaultConfig="toolbarConfig" mode="default" /&gt;
    &lt;Editor style="height: 500px; overflow-y: hidden" v-model="valueHtml" :defaultConfig="editorConfig" mode="default" @onCreated="handleCreated" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { onBeforeUnmount, ref, shallowRef, onMounted } from "vue";
import "@wangeditor/editor/dist/css/style.css"; // 引入 css
import { Editor, Toolbar } from "@wangeditor/editor-for-vue";

const editorRef = shallowRef(); // 编辑器实例，必须用 shallowRef
const valueHtml = ref("&lt;p&gt;hello&lt;/p&gt;"); // 内容 HTML
// 模拟 ajax 异步获取内容
onMounted(() =&gt; {
  setTimeout(() =&gt; {
    valueHtml.value = "&lt;p&gt;模拟 Ajax 异步设置内容&lt;/p&gt;";
  }, 1500);
});
const toolbarConfig = {};
const editorConfig = { placeholder: "请输入内容..." };
// 组件销毁时，也及时销毁编辑器
onBeforeUnmount(() =&gt; {
  const editor = editorRef.value;
  if (editor == null) return;
  editor.destroy();
});
const handleCreated = (editor) =&gt; {
  editorRef.value = editor; // 记录 editor 实例，重要！
};
&lt;/script&gt;

</code></pre> 
<p>Nuxt3引入：</p> 
<pre><code class="language-html">&lt;template&gt;
  &lt;div class="py-5px"&gt;
    &lt;Toolbar style="border-bottom: 1px solid #ccc" :editor="editorRef" :defaultConfig="toolbarConfig" mode="default" /&gt;
    &lt;Editor style="height: 500px; overflow-y: hidden" v-model="valueHtml" :defaultConfig="editorConfig" mode="default" @onCreated="handleCreated" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { onBeforeUnmount, ref, shallowRef, onMounted } from "vue";
import "@wangeditor/editor/dist/css/style.css"; // 引入 css
if (process.client) {
  const { Editor, Toolbar } = await import("@wangeditor/editor-for-vue");
}
const editorRef = shallowRef(); // 编辑器实例，必须用 shallowRef
const valueHtml = ref("&lt;p&gt;hello&lt;/p&gt;"); // 内容 HTML
// 模拟 ajax 异步获取内容
onMounted(() =&gt; {
  setTimeout(() =&gt; {
    valueHtml.value = "&lt;p&gt;模拟 Ajax 异步设置内容&lt;/p&gt;";
  }, 1500);
});
const toolbarConfig = {};
const editorConfig = { placeholder: "请输入内容..." };
// 组件销毁时，也及时销毁编辑器
onBeforeUnmount(() =&gt; {
  const editor = editorRef.value;
  if (editor == null) return;
  editor.destroy();
});
const handleCreated = (editor) =&gt; {
  editorRef.value = editor; // 记录 editor 实例，重要！
};
&lt;/script&gt;</code></pre> 
<p>以上就能够展示富文本编辑器出来来 自己去想要的页面引入一下就好了</p> 
<p>然后就讲一下<span style="color:#fe2c24;"><strong>图片上传粘贴</strong></span>这些怎么配置 ：没什么改变就是 加了上传图片跟视频的配置 然后就可以粘贴这些都没问题了</p> 
<pre><code class="language-html">&lt;template&gt;
  &lt;div class="py-5px"&gt;
    &lt;Toolbar style="border-bottom: 1px solid #ccc" :editor="editorRef" :defaultConfig="toolbarConfig" mode="default" /&gt;
    &lt;Editor style="height: 500px; overflow-y: hidden" v-model="valueHtml" :defaultConfig="editorConfig" mode="default" @onCreated="handleCreated" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { onBeforeUnmount, ref, shallowRef, onMounted } from "vue";
import "@wangeditor/editor/dist/css/style.css"; // 引入 css
if (process.client) {
  const { Editor, Toolbar } = await import("@wangeditor/editor-for-vue");
}
const editorRef = shallowRef(); // 编辑器实例，必须用 shallowRef
const valueHtml = ref("&lt;p&gt;hello&lt;/p&gt;"); // 内容 HTML
// 模拟 ajax 异步获取内容
onMounted(() =&gt; {
  setTimeout(() =&gt; {
    valueHtml.value = "&lt;p&gt;模拟 Ajax 异步设置内容&lt;/p&gt;";
  }, 1500);
});
const toolbarConfig = {};
const editorConfig = {  MENU_CONF: {}};
/**
 * @上传图片
 */
 editorConfig.MENU_CONF["uploadImage"] = {
  // 上传图片的配置
  server: "这里是上传图片的地址",
  fieldName: "image", //这个是参数名字
  headers: { //配置token 接口需要就配 不需要就不用
    Authorization: "Bearer asdfhaohfvdsnvshf",
  },
  customInsert(res, insertFn) {这个是获取接口返回的数据
    insertFn(res.data.url); // 从 res 中找到 url（也就是接口返回的图片地址），然后插入图片
  },
};

/**
 * @上传视频
 */
 editorConfig.MENU_CONF["uploadVideo"] = {
  server: "这里是上传图片的地址", //上传图片的请求地址
  fieldName: "image", //这个是参数名字
  headers: {//配置token 接口需要就配 不需要就不用
    Authorization: "Bearer asdfhaohfvdsnvshf",
  },
  customInsert(res, insertFn) { 这个是获取接口返回的数据
    insertFn(res.data.url); // 从 res 中找到（也就是接口返回的图片地址），然后插入图片
  },
};
// 组件销毁时，也及时销毁编辑器
onBeforeUnmount(() =&gt; {
  const editor = editorRef.value;
  if (editor == null) return;
  editor.destroy();
});
const handleCreated = (editor) =&gt; {
  editorRef.value = editor; // 记录 editor 实例，重要！
};
&lt;/script&gt;
</code></pre> 
<p>现在就可以实现基本的富文本需求了 自己创建一个dome试一下 流程走通了 大概了解了在 丢进项目 不然报错一大堆 然后找bug就找一天  如果有什么其他的问题欢迎提问~~~</p> 
<p>wangeditor 在nuxt3中 第一次进入回显正常 刷新 或者第二次进去 就会报setHtml不存在 当时花了一周的时间去找这个问题 最后还是没用它这个方法 直接改成dangerouslyInsertHtml这个方法去回显html值</p> 
<p></p> 
<p>1.视频编辑尺寸不显示 请把版本降级 我是降级到了5.1.12版本</p> 
<p>2.setHtml方法不存在 我们使用  </p> 
<p>//这里我过滤了一下 因为每次进入编辑器 首位都会自动添加回车 不过滤就会越加越多</p> 
<pre><code class="language-javascript">const valueHtml = computed({
  get() {
    //这里我过滤了一下 因为每次进入编辑器 首位都会自动添加回车 不过滤就会越加越多
    return props.content.replace(/&lt;p&gt;&lt;br&gt;&lt;\/p&gt;/g, "");
  },
  set(value) {
    emit("on-html", value);
  },
});</code></pre> 
<p>3.刷新页面数据不存在 也是跟2一样</p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a6884f93d9aee8eeff6d9bef625e1e72/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Android Framework系列】第3章 Zygote进程相关</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/92e89483d35f0295cfbb091a6888fd42/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Qt实现拖拽功能（支持拖放文件、拖放操作）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>