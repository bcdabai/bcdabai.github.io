<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux中_网络抓包工具tcpdump_了解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux中_网络抓包工具tcpdump_了解" />
<meta property="og:description" content="Linux中_网络抓包工具tcpdump_了解 1、介绍：2、使用介绍：3、常用参数：4、示例： 1、介绍： tcpdump是一个在Unix和Linux系统中常用的命令行网络抓包工具，用于捕获网络流量并分析网络数据包。它可以捕获和显示网络数据包。它可以帮助我们查看网络传输情况，分析网络问题和调试网络应用程序。以下是tcpdump的使用介绍、常用参数和示例。
2、使用介绍： 在命令行中输入tcpdump命令，即可启动tcpdump进行抓包。
tcpdump会默认抓取由所有网络接口进出的数据包，并将其显示在命令行窗口上。
按Ctrl&#43;C可以中断抓包，并显示抓包结果的统计信息。
命令格式：
表达式：
可以使用表达式来过滤要捕获的数据包。表达式可以根据协议、源/目的IP地址、端口号等进行过滤。
tcpdump [选项参数] [expression表达式]
3、常用参数： -i ：指定要监听的网络接口。例如，监听eth0网卡：-i eth0。
any作为接口参数，您可以捕获系统上所有的网络流量数据。
-n：以IP地址而非主机名形式显示数据包，禁用DNS解析，只显示IP地址。
-c ：指定抓包的数据包数量，例如，表示只抓取10个数据包：-c 10。
-s ：设置抓包时的快照长度（以字节为单位）,设置每个数据包要捕获的最大字节数。例如：-s 1500。
-w ：将抓取的数据包保存到文件中，例如：-w capture.pcap。
-r ：从指定文件中读取数据包进行分析。例如：-r packet.pcap
-X：以16进制和ASCII格式显示数据包内容。例如：tcpdump -X
-q：以更简洁的方式显示结果。例如：
：按照指定的协议过滤数据包。例如：tcpdump http
-v 在捕获数据包时显示更多的详细信息。例如：tcpdump -v
src &lt;source_ip&gt;: 按照源IP地址过滤数据包。例如：src 192.168.1.10
仅捕获指定源IP地址的数据包：tcpdump src host 192.168.0.1
dst &lt;destination_ip&gt;: 按照目标IP地址过滤数据包。例如：dst 192.168.1.10
捕获指定目的端口号的数据包：tcpdump dst port 80
and ：按照前后条件同时满足过滤数据包。例如：src 192.168.1.10 and dst port 80
or ：按照前后条件有一个满足就过滤数据包。例如：
-B ：设置数据包的缓冲区大小，单位为字节。示例：tcpdump -B 4096" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/06e560040ad0032768132c9a2eeef106/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-13T12:18:39+08:00" />
<meta property="article:modified_time" content="2023-11-13T12:18:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux中_网络抓包工具tcpdump_了解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Linux中_网络抓包工具tcpdump_了解</h4> 
 <ul><li><a href="#1_2" rel="nofollow">1、介绍：</a></li><li><a href="#2_7" rel="nofollow">2、使用介绍：</a></li><li><a href="#3_20" rel="nofollow">3、常用参数：</a></li><li><a href="#4_117" rel="nofollow">4、示例：</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_2"></a>1、介绍：</h2> 
<p>tcpdump是一个在Unix和Linux系统中常用的命令行网络抓包工具，用于捕获网络流量并分析网络数据包。它可以捕获和显示网络数据包。它可以帮助我们查看网络传输情况，分析网络问题和调试网络应用程序。以下是tcpdump的使用介绍、常用参数和示例。</p> 
<h2><a id="2_7"></a>2、使用介绍：</h2> 
<ol><li> <p>在命令行中输入tcpdump命令，即可启动tcpdump进行抓包。</p> </li><li> <p>tcpdump会默认抓取由所有网络接口进出的数据包，并将其显示在命令行窗口上。</p> </li><li> <p>按Ctrl+C可以中断抓包，并显示抓包结果的统计信息。</p> </li><li> <p>命令格式：<br> 表达式：</p> <p>可以使用表达式来过滤要捕获的数据包。表达式可以根据协议、源/目的IP地址、端口号等进行过滤。</p> <p>tcpdump [选项参数] [expression表达式]</p> </li></ol> 
<h2><a id="3_20"></a>3、常用参数：</h2> 
<ol><li> <p>-i ：指定要监听的网络接口。例如，监听eth0网卡：-i eth0。<br> any作为接口参数，您可以捕获系统上所有的网络流量数据。</p> </li><li> <p>-n：以IP地址而非主机名形式显示数据包，禁用DNS解析，只显示IP地址。</p> </li><li> <p>-c ：指定抓包的数据包数量，例如，表示只抓取10个数据包：-c 10。</p> </li><li> <p>-s ：设置抓包时的快照长度（以字节为单位）,设置每个数据包要捕获的最大字节数。例如：-s 1500。</p> </li><li> <p>-w ：将抓取的数据包保存到文件中，例如：-w capture.pcap。</p> </li><li> <p>-r ：从指定文件中读取数据包进行分析。例如：-r packet.pcap</p> </li><li> <p>-X：以16进制和ASCII格式显示数据包内容。例如：tcpdump -X</p> </li><li> <p>-q：以更简洁的方式显示结果。例如：</p> </li><li> <p>：按照指定的协议过滤数据包。例如：tcpdump http</p> </li><li> <p>-v 在捕获数据包时显示更多的详细信息。例如：tcpdump -v</p> </li><li> <p>src &lt;source_ip&gt;: 按照源IP地址过滤数据包。例如：src 192.168.1.10<br> 仅捕获指定源IP地址的数据包：tcpdump src host 192.168.0.1</p> </li><li> <p>dst &lt;destination_ip&gt;: 按照目标IP地址过滤数据包。例如：dst 192.168.1.10<br> 捕获指定目的端口号的数据包：tcpdump dst port 80</p> </li><li> <p> and ：按照前后条件同时满足过滤数据包。例如：src 192.168.1.10 and dst port 80</p> </li><li> <p> or ：按照前后条件有一个满足就过滤数据包。例如：</p> </li><li> <p>-B ：设置数据包的缓冲区大小，单位为字节。示例：tcpdump -B 4096</p> </li><li> <p>-C &lt;file_size&gt;：设置保存数据包的文件大小上限，单位为MB，达到上限后会自动创建新的文件进行保存。<br> 示例：tcpdump -C 100</p> </li><li> <p>-E algo:secret：指定用于解密数据包的算法和密钥。</p> </li></ol> 
<pre><code>  示例：tcpdump -E aes256:secretkey
</code></pre> 
<ol start="18"><li>-F ：从指定的文件中读取过滤规则。</li></ol> 
<pre><code>  示例：tcpdump -F filter.txt
</code></pre> 
<ol start="19"><li>-G ：设置保存数据包的文件的时间间隔，单位为秒，达到时间间隔后会自动创建新的文件进行保存。</li></ol> 
<pre><code>  示例：tcpdump -G 60
</code></pre> 
<ol start="20"><li>-j ：设置时间戳类型。</li></ol> 
<pre><code>  示例：tcpdump -j host
</code></pre> 
<ol start="21"><li>-M ：设置使用指定的密钥对数据包进行解密处理，设置密钥，将数据包标记为具有指定密钥的特定流。。</li></ol> 
<pre><code>  示例：tcpdump -M secretkey
</code></pre> 
<ol start="22"><li>–number：在输出结果中显示每个数据包的序号。</li></ol> 
<pre><code>  示例：tcpdump --number
</code></pre> 
<ol start="23"><li>-Q &lt;in|out|inout&gt;：设置过滤规则的方向，只匹配输入、输出或输入输出都匹配的数据包。</li></ol> 
<pre><code>  示例：tcpdump -Q in
</code></pre> 
<ol start="24"><li>–time-stamp-precision ：设置时间戳的精度。</li></ol> 
<pre><code>  示例：tcpdump --time-stamp-precision nano
</code></pre> 
<ol start="25"><li>–immediate-mode：立即将数据包写入文件，而不进行缓冲。</li></ol> 
<pre><code>  示例：tcpdump --immediate-mode
</code></pre> 
<ol start="26"><li>-T ：设置输出的格式类型。指定输出文件的类型，如ps、psml、psml+xml、text、csv等。</li></ol> 
<pre><code>  示例：tcpdump -T json
</code></pre> 
<ol start="27"><li>–version：显示tcpdump的版本信息。</li></ol> 
<pre><code>  示例：tcpdump --version
</code></pre> 
<ol start="28"><li>-V ：从指定的文件中读取要解析的数据包。</li></ol> 
<pre><code>  示例：tcpdump -V packets.pcap
</code></pre> 
<ol start="29"><li>-W ：设置保存数据包的文件的数量上限，达到上限后会自动删除最旧的文件。</li></ol> 
<pre><code>  示例：tcpdump -W 10
</code></pre> 
<ol start="30"><li>-y ：设置数据链路层类型。</li></ol> 
<pre><code>  示例：tcpdump -y ethernet
</code></pre> 
<ol start="31"><li>-z ：在每次文件切换时切换到下一个输出文件之前执行指定的命令。</li></ol> 
<pre><code>  示例：tcpdump -z "gzip -9"
</code></pre> 
<ol start="32"><li>-Z ：以指定的用户身份运行tcpdump。</li></ol> 
<pre><code>  示例：tcpdump -Z root
</code></pre> 
<h2><a id="4_117"></a>4、示例：</h2> 
<ol><li> <p>抓取特定网络接口上的数据包，并显示其详细信息：</p> <pre><code class="prism language-bash">tcpdump <span class="token parameter variable">-i</span> eth0
</code></pre> </li><li> <p>仅捕获指定源IP地址的数据包：</p> <pre><code>tcpdump src host 192.168.0.1
</code></pre> </li><li> <p>捕获指定目的端口号的数据包：</p> <pre><code>tcpdump dst port 80
</code></pre> </li><li> <p>将抓取到的数据包保存到文件中：</p> <pre><code class="prism language-bash">tcpdump <span class="token parameter variable">-w</span> capture.pcap
</code></pre> </li><li> <p>从文件中读取数据包并进行分析：</p> <pre><code class="prism language-bash">tcpdump <span class="token parameter variable">-r</span> capture.pcap
</code></pre> </li><li> <p>监听eth0网卡，捕获前10个数据包的详细信息：</p> </li></ol> 
<pre><code> ```
 tcpdump -i eth0 -c 10 -v
 ```
</code></pre> 
<ol start="7"><li>捕获源IP地址为192.168.1.10并且目标端口为80的HTTP数据包：</li></ol> 
<pre><code> ```
 tcpdump src 192.168.1.10 and dst port 80 and http
 ```
</code></pre> 
<p>8、tcpdump怎么统计pcap文件中有多少个协议类型为17的数据包？</p> 
<pre><code>  tcpdump -r &lt;pcap文件路径&gt; 'ip[9] = 17' | wc -l
</code></pre> 
<p>9、使用tcpdump命令将.cap文件转换为.pcap文件？</p> 
<pre><code>  tcpdump -r input.cap -w output.pcap
</code></pre> 
<p>10、使用tcpdump批量将.cap文件转换为.pcap文件：</p> 
<pre><code>  for file in *.cap; do
     tcpdump -r "$file" -w "${file%.cap}.pcap"
  done
</code></pre> 
<p>您可以查看tcpdump的官方文档或使用<code>tcpdump --help</code>命令获取更详细的信息。</p> 
<p>请注意，在使用tcpdump时需要具有适当的权限，通常需要以root用户或具有特定权限的用户身份运行。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/09092897764bf5ed0dfbcb0c922e196d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">一阶倒立摆的ts模糊控制，基于ts模糊模型搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f4a55fa0794617f00d5af59498a08400/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux中_银河麒麟V4.0.2_使用中_遇到问题_及解决_记录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>