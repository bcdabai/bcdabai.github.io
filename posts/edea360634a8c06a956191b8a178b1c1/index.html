<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>修复LandSat7 ETM SLC&#43;off缺失条带 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="修复LandSat7 ETM SLC&#43;off缺失条带" />
<meta property="og:description" content="想做深度学习修复遥感图像，现在先试一下广泛使用的遥感专业软件envi的条带修复效果。方便以后实现不同方法的对比。
整体步骤：
1、地理空间数据云下载免费的遥感图像
2、用landsat7 slc&#43;off 的掩膜和landsat7 slc&#43;on的图像文件生成新的条带图像
3、envi插件修复，输出栅格tif文件
4、用arcgis将tif转换为jpg
5、计算PSNR和SSIM指标
详细解释：
1
经过了解，网上方便下载landsat7图像的地方有中科院国际科学数据服务平台和地理空间数据云，后者的数据应该也是从前者下载过来整合的，但是不知是特殊时期还是没有权限，国科平台的数据页面进不去，其网站提供的两种在线数据恢复方法也没法用。只能在后者下载数据。
2
下载的每景图像中，包含该卫星每个波段的图和每个波段的掩膜文件。因为后面要对修复的图像作PSNR和SSIM两个指标评价，需要有groundtruth，但是landsat7slc&#43;off是没有的，所以我下载了03年之前传感器未损坏的图像。使用损坏图像的掩膜和完好图像自己制作了缺失条带图像。这里有个问题是即使都是landsat7卫星，但每一景的大小都不通，因此是不能直接拿损坏图像一个波段的掩膜和完好图像作融合，他们大小不匹配，matlab会报错。况且每张卫星图非常大，直接对其处理不方便，因此我取中间的750*600像素块来进行后续的计算的研究。
RGB=imread(&#39;321.TIF&#39;); RGB1=imcrop(RGB,[1150,2300,750,600]); rgb=imread(&#39;caiqie_mask.TIF&#39;); rgb1=imcrop(rgb,[1150,2300,750,600]); imshow(RGB1); RGB2=RGB.*rgb; figure imshow(RGB2); imwrite(RGB2,&#39;caiqie_321.TIF&#39;); 裁切后的groundtruth：
添加掩膜后的自制条带图像：
对于landsat7卫星来说，其图像一共有9个波段，查资料得知，其3、2、1波段分别赋红、绿、蓝合成后会生成自然状态下的真彩色，正是我们的需求，因此上面所有的图都是3、2、1波段按顺序合成的真彩色图。
3
ENVI插件修复方法基本有两种，两个插件分别是landsat_gapfill.sav和tm_destripe.sav 下载地址
https://blog.csdn.net/dou3516/article/details/71547274
两种方法使用上略微有点不同，具体操作很多人的博客都有说，不再赘述。
有一点需要注意：如果envi版本比较新，是没有basic tools这个窗口的，我5.3的版本是在右侧的toolbox。网上很多人说的插件放在envi安装目录下的save_add文件夹中即可，使用路径 Basic Tools -&gt; Preprocessing -&gt; Data-Specific Utilities -&gt;Landsat TM -&gt; Landsat gapfill，注意这是经典版的，我5.3版本是在这。
这两个插件效果差别很大，这是tm_destripe修复效果：
这是landsat_gapfill修复效果：
很明显后者要好很多，因此后面不再关注第一种方法。由于我要与深度学习的方法作比较，此两种方法均为传统方法，其具体实现原理暂不做深入探究，仅比较他们的修复效果。
4
在探索过程中，我发现用envi修复的图像只能保存为TIF或者其他不认识，不熟悉的文件格式。并不能保存常见的jpg图片格式，这或许会给后面的使用带来很多问题，所以我用另一款专业软件arcgis10.2将栅格TIF转换成JPG格式。因为某些原因，以前装的不能用了，需要重新安装，但要注意，在非首次安装时，一定要先把上次装的清理干净，特别是系统注册表那些卸载软件很容易忽略的，不然会一直安装失败。另外很多人在安装arcgis manager时，提示缺少一个文件，那应该是下载的安装包不完整。：
这里推荐一个教程链接，下载安装都有，很好用
5
利用landsat_gapfill.sav插件修复的图像效果如下：
与前面groundtruth对法发现，其修复的视觉效果是还不错的，计算其峰值信噪比和结构相似度：此处借鉴此博客方法
到此，得到一组传统方法修复遥感条带图像的指标。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/edea360634a8c06a956191b8a178b1c1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-26T11:33:20+08:00" />
<meta property="article:modified_time" content="2020-03-26T11:33:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">修复LandSat7 ETM SLC&#43;off缺失条带</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>想做深度学习修复遥感图像，现在先试一下广泛使用的遥感专业软件envi的条带修复效果。方便以后实现不同方法的对比。</p> 
<p><strong>整体步骤：</strong><br> 1、地理空间数据云下载免费的遥感图像<br> 2、用landsat7 slc+off 的掩膜和landsat7 slc+on的图像文件生成新的条带图像<br> 3、envi插件修复，输出栅格tif文件<br> 4、用arcgis将tif转换为jpg<br> 5、计算PSNR和SSIM指标</p> 
<p><strong>详细解释：</strong></p> 
<p><strong>1</strong></p> 
<p>经过了解，网上方便下载landsat7图像的地方有中科院国际科学数据服务平台和地理空间数据云，后者的数据应该也是从前者下载过来整合的，但是不知是特殊时期还是没有权限，国科平台的数据页面进不去，其网站提供的两种在线数据恢复方法也没法用。只能在后者下载数据。</p> 
<p><strong>2</strong></p> 
<p>下载的每景图像中，包含该卫星每个波段的图和每个波段的掩膜文件。因为后面要对修复的图像作PSNR和SSIM两个指标评价，需要有groundtruth，但是landsat7slc+off是没有的，所以我下载了03年之前传感器未损坏的图像。使用损坏图像的掩膜和完好图像自己制作了缺失条带图像。这里有个问题是即使都是landsat7卫星，但每一景的大小都不通，因此是不能直接拿损坏图像一个波段的掩膜和完好图像作融合，他们大小不匹配，matlab会报错。况且每张卫星图非常大，直接对其处理不方便，因此我取中间的750*600像素块来进行后续的计算的研究。</p> 
<pre><code class="prism language-markup">RGB=imread('321.TIF');
RGB1=imcrop(RGB,[1150,2300,750,600]);
rgb=imread('caiqie_mask.TIF');
rgb1=imcrop(rgb,[1150,2300,750,600]);
imshow(RGB1);
RGB2=RGB.*rgb;
figure
imshow(RGB2);
imwrite(RGB2,'caiqie_321.TIF');
</code></pre> 
<p>裁切后的groundtruth：<br> <img src="https://images2.imgbox.com/4c/d0/xsH23u91_o.png" alt="在这里插入图片描述"><br> 添加掩膜后的自制条带图像：<br> <img src="https://images2.imgbox.com/c2/13/sfnT0z4X_o.jpg" alt="在这里插描述"><br> 对于landsat7卫星来说，其图像一共有9个波段，查资料得知，其3、2、1波段分别赋红、绿、蓝合成后会生成自然状态下的真彩色，正是我们的需求，因此上面所有的图都是3、2、1波段按顺序合成的真彩色图。</p> 
<p><strong>3</strong></p> 
<p>ENVI插件修复方法基本有两种，两个插件分别是landsat_gapfill.sav和tm_destripe.sav 下载地址</p> 
<blockquote> 
 <p>https://blog.csdn.net/dou3516/article/details/71547274</p> 
</blockquote> 
<p>两种方法使用上略微有点不同，具体操作很多人的博客都有说，不再赘述。<br> 有一点需要注意：如果envi版本比较新，是没有basic tools这个窗口的，我5.3的版本是在右侧的toolbox。网上很多人说的插件放在envi安装目录下的save_add文件夹中即可，使用路径 Basic Tools -&gt; Preprocessing -&gt; Data-Specific Utilities -&gt;Landsat TM -&gt; Landsat gapfill，注意这是经典版的，我5.3版本是在这。<br> <img src="https://images2.imgbox.com/de/5b/OzKOeJ1o_o.png" alt="在这里插入图片描述"><br> 这两个插件效果差别很大，这是tm_destripe修复效果：<br> <img src="https://images2.imgbox.com/64/b2/i6yUTmRX_o.png" alt="在这里插入图片描述"><br> 这是landsat_gapfill修复效果：<br> <img src="https://images2.imgbox.com/48/88/XVgsn4mH_o.png" alt="在这里插入图片描述"><br> 很明显后者要好很多，因此后面不再关注第一种方法。由于我要与深度学习的方法作比较，此两种方法均为传统方法，其具体实现原理暂不做深入探究，仅比较他们的修复效果。</p> 
<p><strong>4</strong></p> 
<p>在探索过程中，我发现用envi修复的图像只能保存为TIF或者其他不认识，不熟悉的文件格式。并不能保存常见的jpg图片格式，这或许会给后面的使用带来很多问题，所以我用另一款专业软件arcgis10.2将栅格TIF转换成JPG格式。因为某些原因，以前装的不能用了，需要重新安装，但要注意，在非首次安装时，一定要先把上次装的清理干净，特别是系统注册表那些卸载软件很容易忽略的，不然会一直安装失败。另外很多人在安装arcgis manager时，提示缺少一个文件，那应该是下载的安装包不完整。：<br> <a href="https://malagis.com/arcgis-desktop-10-2-full-installation-tutorial.html" rel="nofollow">这里推荐一个教程链接，下载安装都有，很好用</a></p> 
<p><strong>5</strong></p> 
<p>利用landsat_gapfill.sav插件修复的图像效果如下：<br> <img src="https://images2.imgbox.com/4c/56/XiXujpvE_o.png" alt="在这里插入图片描述"><br> 与前面groundtruth对法发现，其修复的视觉效果是还不错的，计算其峰值信噪比和结构相似度：<a href="https://blog.csdn.net/weixin_43876801/article/details/103146995?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task">此处借鉴此博客方法</a><br> <img src="https://images2.imgbox.com/74/1f/AzdJxNwX_o.png" alt="在这里插入图片描述"><br> 到此，得到一组传统方法修复遥感条带图像的指标。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/de4635f23183e3bb8d4c4d0a8391a01c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OPENSSH 详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eee86784cb95d859651fd71ae6027cc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">建Kangle&#43;EasyPanel对接SWAP IDC虚拟主机自助开通完整教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>