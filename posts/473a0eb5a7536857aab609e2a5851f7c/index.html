<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL必须懂的高级查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL必须懂的高级查询" />
<meta property="og:description" content="SQL高级查询详解 一、前言二、高级查询2.1、基础查询2.2、条件查询2.3、范围查询2.4、判空查询2.5、模糊查询2.6、分页查询2.7、查询后排序2.8、聚合查询2.9、分组查询 三、联表查询3.1、INNER JOIN3.2、LEFT JOIN3.3、RIGHT JOIN 四、子查询/合并查询4.1、单行子查询4.2、多行子查询4.3 正则表达式 总结 一、前言 SQL 是关系型数据库的标准语言，所有的关系型数据库都支持 SQL，比如 MySQL、Oracle、SQL Server、MS Access、DB2 等。不学习 SQL，就没法使用关系型数据库。SQL 仅仅是一种查询语言，它不是数据库，要想使用 SQL，您需要安装一款数据库。
有些数据库在标准 SQL 的基础上进行了扩展或者裁减，形成了不同的“方言”，比如：
SQL Server 使用 T-SQL.Oracle 使用 PL/SQL；MS Access 使用的 SQL 被称为 JET SQL。 高级查询可以让我们的SQL语句更加灵活，完成更多的任务需求。
二、高级查询 做一下准备，为下面的查询操作建立数据库。
DROP TABLE IF EXISTS `class`; CREATE TABLE `class` ( `cid` int(11) NOT NULL AUTO_INCREMENT, `caption` varchar(32) NOT NULL, PRIMARY KEY (`cid`) ) ENGINE=innoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8; DROP TABLE IF EXISTS `student`; CREATE TABLE `student` ( `sid` int(11) NOT NULL AUTO_INCREMENT, `gender` char(1) NOT NULL, `class_id` int(11) NOT NULL, `sname` varchar(32) NOT NULL, PRIMARY KEY (`sid`), KEY `fk_class` (`class_id`), CONSTRAINT `fk_class` FOREIGN KEY (`class_id`) REFERENCES `class` (`cid`) ) ENGINE=innoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8; DROP TABLE IF EXISTS `teacher`; CREATE TABLE `teacher` ( `tid` int(11) NOT NULL AUTO_INCREMENT, `tname` varchar(32) NOT NULL, PRIMARY KEY (`tid`) ) ENGINE=innoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8; DROP TABLE IF EXISTS `course`; CREATE TABLE `course` ( `cid` int(11) NOT NULL AUTO_INCREMENT, `cname` varchar(32) NOT NULL, `teacher_id` int(11) NOT NULL, PRIMARY KEY (`cid`), KEY `fk_course_teacher` (`teacher_id`), CONSTRAINT `fk_course_teacher` FOREIGN KEY (`teacher_id`) REFERENCES `teacher` (`tid`) ) ENGINE=innoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8; DROP TABLE IF EXISTS `score`; CREATE TABLE `score` ( `sid` int(11) NOT NULL AUTO_INCREMENT, `student_id` int(11) NOT NULL, `course_id` int(11) NOT NULL, `num` int(11) NOT NULL, PRIMARY KEY (`sid`), KEY `fk_score_student` (`student_id`), KEY `fk_score_course` (`course_id`), CONSTRAINT `fk_score_course` FOREIGN KEY (`course_id`) REFERENCES `course` (`cid`), CONSTRAINT `fk_score_student` FOREIGN KEY (`student_id`) REFERENCES `student` (`sid`) ) ENGINE=innoDB AUTO_INCREMENT=53 DEFAULT CHARSET=utf8; 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/473a0eb5a7536857aab609e2a5851f7c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-17T00:01:23+08:00" />
<meta property="article:modified_time" content="2023-06-17T00:01:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL必须懂的高级查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>SQL高级查询详解</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、前言</a></li><li><a href="#_11" rel="nofollow">二、高级查询</a></li><li><ul><li><a href="#21_68" rel="nofollow">2.1、基础查询</a></li><li><a href="#22_81" rel="nofollow">2.2、条件查询</a></li><li><a href="#23_89" rel="nofollow">2.3、范围查询</a></li><li><a href="#24_95" rel="nofollow">2.4、判空查询</a></li><li><a href="#25_108" rel="nofollow">2.5、模糊查询</a></li><li><a href="#26_117" rel="nofollow">2.6、分页查询</a></li><li><a href="#27_126" rel="nofollow">2.7、查询后排序</a></li><li><a href="#28_136" rel="nofollow">2.8、聚合查询</a></li><li><a href="#29_153" rel="nofollow">2.9、分组查询</a></li></ul> 
  </li><li><a href="#_167" rel="nofollow">三、联表查询</a></li><li><ul><li><a href="#31INNER_JOIN_172" rel="nofollow">3.1、INNER JOIN</a></li><li><a href="#32LEFT_JOIN_178" rel="nofollow">3.2、LEFT JOIN</a></li><li><a href="#33RIGHT_JOIN_184" rel="nofollow">3.3、RIGHT JOIN</a></li></ul> 
  </li><li><a href="#_190" rel="nofollow">四、子查询/合并查询</a></li><li><ul><li><a href="#41_191" rel="nofollow">4.1、单行子查询</a></li><li><a href="#42_196" rel="nofollow">4.2、多行子查询</a></li><li><a href="#43__216" rel="nofollow">4.3 正则表达式</a></li></ul> 
  </li><li><a href="#_234" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、前言</h2> 
<p>SQL 是关系型数据库的标准语言，所有的关系型数据库都支持 SQL，比如 MySQL、Oracle、SQL Server、MS Access、DB2 等。不学习 SQL，就没法使用关系型数据库。SQL 仅仅是一种查询语言，它不是数据库，要想使用 SQL，您需要安装一款数据库。</p> 
<p>有些数据库在标准 SQL 的基础上进行了扩展或者裁减，形成了不同的“方言”，比如：</p> 
<ul><li>SQL Server 使用 T-SQL.</li><li>Oracle 使用 PL/SQL；</li><li>MS Access 使用的 SQL 被称为 JET SQL。</li></ul> 
<p>高级查询可以让我们的SQL语句更加灵活，完成更多的任务需求。</p> 
<h2><a id="_11"></a>二、高级查询</h2> 
<p>做一下准备，为下面的查询操作建立数据库。</p> 
<pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>class<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>class<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>cid<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>caption<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>cid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">innoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">5</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>



<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>sid<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>sname<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>sid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>fk_class<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>fk_class<span class="token punctuation">`</span></span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>class<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>cid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">innoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">17</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>


<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>tid<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>tname<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>tid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">innoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">6</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>


<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>course<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>course<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>cid<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>cname<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>teacher_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>cid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>fk_course_teacher<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>teacher_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>fk_course_teacher<span class="token punctuation">`</span></span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>teacher_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>tid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">innoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">5</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>sid<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>course_id<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>sid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>fk_score_student<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>fk_score_course<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>course_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>fk_score_course<span class="token punctuation">`</span></span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>course_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>course<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>cid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>fk_score_student<span class="token punctuation">`</span></span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>student_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>sid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">innoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">53</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="21_68"></a>2.1、基础查询</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 全部查询</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 只查询部分字段</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>sname<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 别名 列明 不要用关键字</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>sname<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> <span class="token string">'姓名'</span> <span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token keyword">AS</span> <span class="token string">'班级ID'</span>
<span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
<span class="token comment">-- 把查询出来的结果的重复记录去掉</span>
<span class="token keyword">SELECT</span> <span class="token keyword">distinct</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="22_81"></a>2.2、条件查询</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询姓名为 fly1 的学生信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>sname<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">'fly1'</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询性别为 男，并且班级为 2 的学生信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">"男"</span> <span class="token operator">AND</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="23_89"></a>2.3、范围查询</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询班级id 1 到 3 的学生的信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token operator">BETWEEN</span> <span class="token number">1</span> <span class="token operator">AND</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="24_95"></a>2.4、判空查询</h3> 
<p>is null 判断造成索引失效。</p> 
<pre><code class="prism language-sql"><span class="token comment"># 索引 B+ 树</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span> <span class="token comment">#判断不为空</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>class_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span><span class="token comment">#判断为空</span>


<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span> <span class="token operator">&lt;&gt;</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token comment">#判断不为空字符串</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token comment">#判断为空字符串</span>
</code></pre> 
<h3><a id="25_108"></a>2.5、模糊查询</h3> 
<p>使用 like关键字，"%"代表任意数量的字符，”_”代表占位符。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询名字为 m 开头的学生的信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>tname<span class="token punctuation">`</span></span> <span class="token operator">LIKE</span> <span class="token string">'谢%'</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询姓名里第二个字为 小 的学生的信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>tname<span class="token punctuation">`</span></span> <span class="token operator">LIKE</span> <span class="token string">'_小%'</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="26_117"></a>2.6、分页查询</h3> 
<p>分页查询主要用于查看第N条 到 第M条的信息，通常和排序查询一起使用。</p> 
<p>使用limit关键字，第一个参数表示从条记录开始显示，第二个参数表示要显示的数目。表中默认第一条记录的参数为0。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询第二条到第三条内容</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="27_126"></a>2.7、查询后排序</h3> 
<p>关键字：order by field。<br> asc:升序。<br> desc:降序</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span> <span class="token keyword">ASC</span><span class="token punctuation">;</span>
<span class="token comment">-- 按照多个字段排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token identifier"><span class="token punctuation">`</span>course_id<span class="token punctuation">`</span></span> <span class="token keyword">DESC</span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="28_136"></a>2.8、聚合查询</h3> 
<table><thead><tr><th>聚合函数</th><th>描述</th></tr></thead><tbody><tr><td>sum()</td><td>计算某列的总和</td></tr><tr><td>avg()</td><td>计算某列的平均值</td></tr><tr><td>max()</td><td>计算某列的最大值</td></tr><tr><td>min()</td><td>计算某列的最小值</td></tr><tr><td>count()</td><td>计算某列的行数</td></tr></tbody></table> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">avg</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>num<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="29_153"></a>2.9、分组查询</h3> 
<p>分组加group_concat。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 分组加group_concat</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token punctuation">,</span> group_concat<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>age<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span> ages <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token comment">-- 可以把查询出来的结果根据某个条件来分组显示</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token comment">-- 分组加聚合</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token comment">-- 分组加条件</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token identifier"><span class="token punctuation">`</span>gender<span class="token punctuation">`</span></span> <span class="token keyword">HAVING</span> num <span class="token operator">&gt;</span> <span class="token number">6</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_167"></a>三、联表查询</h2> 
<p>可以把表想象成集合。<br> 联表查询分为内联（inner join）和外联（left join，right join，full join）。内联类似交集，full join类似并集。<br> 如果只写了join，那么默认是内联。<br> <img src="https://images2.imgbox.com/46/79/FDSsOwz6_o.png" alt="sql_joins"></p> 
<h3><a id="31INNER_JOIN_172"></a>3.1、INNER JOIN</h3> 
<p>只取两张表有对应关系的记录。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> cid <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>course<span class="token punctuation">`</span></span> <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token keyword">ON</span> course<span class="token punctuation">.</span>teacher_id <span class="token operator">=</span> teacher<span class="token punctuation">.</span>tid<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="32LEFT_JOIN_178"></a>3.2、LEFT JOIN</h3> 
<p>在内连接的基础上保留左表没有对应关系的记录。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> course<span class="token punctuation">.</span>cid <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>course<span class="token punctuation">`</span></span> <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token keyword">on</span> course<span class="token punctuation">.</span>teacher_id <span class="token operator">=</span> teacher<span class="token punctuation">.</span>tid<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="33RIGHT_JOIN_184"></a>3.3、RIGHT JOIN</h3> 
<p>在内连接的基础上保留右表没有对应关系的记录。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> course<span class="token punctuation">.</span>cid <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>course<span class="token punctuation">`</span></span> <span class="token keyword">right</span> <span class="token keyword">join</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token keyword">on</span> course<span class="token punctuation">.</span>teacher_id <span class="token operator">=</span> teacher<span class="token punctuation">.</span>tid<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_190"></a>四、子查询/合并查询</h2> 
<h3><a id="41_191"></a>4.1、单行子查询</h3> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> course <span class="token keyword">where</span> teacher_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> tid <span class="token keyword">from</span> teacher <span class="token keyword">where</span> tname <span class="token operator">=</span> <span class="token string">'lucien'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="42_196"></a>4.2、多行子查询</h3> 
<p>多行子查询即返回多行记录的子查询。</p> 
<p><strong>IN</strong> 关键字：运算符可以检测结果集中是否存在某个特定的值，如果检测成功就执行外部的查询。<br> <strong>EXISTS</strong> 关键字：内层查询语句不返回查询的记录。而是返回一个真假值。如果内层查询语句查询到满足条件的记录，就返回一个真值（ true ），否则，将返回一个假值（ false ）。当返回的值为 true 时，外层查询语句将进行查询；当返回的为false 时，外层查询语句不进行查询或者查询不出任何记录。<br> <strong>ALL</strong> 关键字：表示满足所有条件。使用 ALL 关键字时，只有满足内层查询语句返回的所有结果，才可以执行外层查询语句。<br> <strong>ANY</strong> 关键字：允许创建一个表达式，对子查询的返回值列表，进行比较，只要满足内层子查询中的，任意一个比较条件，就返回一个结果作为外层查询条件。</p> 
<p>在 FROM 子句中使用子查询：子查询出现在 from 子句中，这种情况下将子查询当做一个临时表使用。</p> 
<p>示例：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> class_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> cid <span class="token keyword">from</span> course <span class="token keyword">where</span> teacher_id <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student <span class="token keyword">where</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> cid <span class="token keyword">from</span> course <span class="token keyword">where</span> cid <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">select</span> student_id<span class="token punctuation">,</span>sname <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> score <span class="token keyword">WHERE</span> course_id <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">OR</span> course_id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> A <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> student <span class="token keyword">ON</span> A<span class="token punctuation">.</span>student_id <span class="token operator">=</span> student<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>

</code></pre> 
<h3><a id="43__216"></a>4.3 正则表达式</h3> 
<p>使用关键字：REGEXP。</p> 
<table><thead><tr><th>选项</th><th>说明（自动加匹配二字）</th><th>例子</th><th>匹配值示例</th></tr></thead><tbody><tr><td>^</td><td>文本开始字符</td><td>'^b’匹配以字母b开头的字符串</td><td>book, big,banana,bike</td></tr><tr><td>.</td><td>任何单个字符</td><td>'b.t’匹配任何b和t之间有一个字符</td><td>bit, bat,but, bite</td></tr><tr><td>*</td><td>0个或多个在它前面的字符</td><td>'f*n’匹配字符n前面有任意多个字符f</td><td>fn, fan,faan, abcn</td></tr><tr><td>+</td><td>前面的字符一次或多次</td><td>'ba+'匹配以b开头后面紧跟至少一个a</td><td>ba, bay,bare, battle</td></tr><tr><td>&lt;字符串&gt;</td><td>包含指定字符串的文本</td><td>‘fa’</td><td>fan, afa,faad</td></tr><tr><td>[字符集合]</td><td>字符集合中的任一个字符</td><td>'[xz]'匹配x或者z</td><td>dizzy,zebra, xray,extra</td></tr><tr><td>[^]</td><td>不在括号中的任何字符</td><td>'[^abc]'匹配任何不包含a、b或c的字符串</td><td>desk, fox,f8ke</td></tr><tr><td>字符串{n}</td><td>前面的字符串至少n次</td><td>b{2}匹配2个或更多的b</td><td>bbb, bbbb,bbbbbb</td></tr><tr><td>字符串{n,m}</td><td>前面的字符串至少n次，至多m次</td><td>b{2,4}匹配最少2个，最多4个b</td><td>bb, bbb,bbbb</td></tr></tbody></table> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>teacher<span class="token punctuation">`</span></span> <span class="token keyword">WHERE</span> <span class="token identifier"><span class="token punctuation">`</span>tname<span class="token punctuation">`</span></span> <span class="token operator">REGEXP</span> <span class="token string">'^long'</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_234"></a>总结</h2> 
<ol><li>在实际使用中最好不要使用select *的方式查询数据，这种查询方式既不好分析数据，也会使查询效率降低。</li><li>SQL查询中，如果不清楚名称是不是关键字，最好使用反引号括起来，避免在词法语法分析时被当成关键字处理。</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e90d3bcc11c19a9ba03bb6edb8363ea5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关系数据库SQL数据查询</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/33d87a1cf1bb1ff6d1df6401beda752e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Oracle笔记】最详细的操作命令大全（基础版）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>