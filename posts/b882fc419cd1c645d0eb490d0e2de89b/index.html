<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java 邮件操作 email - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java 邮件操作 email" />
<meta property="og:description" content="本文转载从新浪微博：http://blog.sina.com.cn/s/blog_793797f001013c9z.html
（转载）学习javax.mail API(2012-05-18 23:46:51) 找了好久，终于见到某位仁兄给出了javax.mail运行机制的详细分析，感激感激，收藏了，以防找不到。
&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;&#43;
打开JavaMail.jar文件，我们将发现在javax.mail的包下面存在着一些核心类：Session、Message、Address、Authenticator、Transport、Store、Folder。而且在 javax.mail.internet包中还有一些常用的子类。
A．Session
Session类定义了基本的邮件会话。就像Http会话那样，我们进行收发邮件的工作都是基于这个会话的。Session对象利用了java.util.Properties对象获得了邮件服务器、用户名、密码信息和整个应用程序都要使用到的共享信息。
Session类的构造方法是私有的，所以我们可以使用Session类提供的getDefaultInstance()这个静态工厂方法获得一个默认的Session对象：
1 Properties props = new Properties();// fill props with any information 2 Session session = Session.getDefaultInstance(props, null); 或者使用getInstance()这个静态工厂方法获得自定义的Session:
1 Properties props = new Properties();// fill props with any information 2 Session session = Session.getInstance(props, null); 从上面的两个例子中不难发现，getDefaultInstance()和getInstance()方法的第二个参数都是null，这是因为在上面的例子中并没有使用到邮件授权，下文中将对授权进行详细介绍。 从很多的实例看，在对mail server进行访问的过程中使用共享的Session是足够的，即使是工作在多个用户邮箱的模式下也不例外。
B．Message
当我们建立了Session对象后，便可以构造被发送的信息体了。在这里SUN提供了Message类型来帮助开发者完成这项工作。由于Message是一个抽象类，大多数情况下，我们使用 javax.mail.internet.MimeMessage这个子类，该类是使用MIME类型、MIME信息头的邮箱信息。信息头只能使用US- ASCII字符，而非ASCII字符将通过编码转换为ASCII的方式使用。
为了建立一个MimeMessage对象，我们必须将Session对象作为MimeMessage构造方法的参数传入：
1 MimeMessage message = new MimeMessage(session); 注意：对于MimeMessage类来讲存在着多种构造方法，比如使用输入流作为参数的构造方法。
在建立了MimeMessage对象后，我们需要设置它的各个part，对于MimeMessage类来说，这些part就是MimePart接口。最基本的设置信息内容的方法就是通过表示信息内容和米么类型的参数调用setContent()方法：
1 message.setContent(“Hello”, “text/plain”); 然而，如果我们所使用的MimeMessage中信息内容是文本的话，我们便可以直接使用setText()方法来方便的设置文本内容：
1 message.setText(“Hello”); 前面所讲的两种方法，对于文本信息，后者更为合适。而对于其它的一些信息类型，比如HTML信息，则要使用前者。 别忘记了，使用setSubject()方法对邮件设置邮件主题：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b882fc419cd1c645d0eb490d0e2de89b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-06-05T13:49:38+08:00" />
<meta property="article:modified_time" content="2012-06-05T13:49:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java 邮件操作 email</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文转载从新浪微博：<a href="http://blog.sina.com.cn/s/blog_793797f001013c9z.html" rel="nofollow">http://blog.sina.com.cn/s/blog_793797f001013c9z.html</a></p> 
<p> </p> 
<p>（转载）学习javax.mail API<span class="time SG_txtc">(2012-05-18 23:46:51)</span> </p> 
<div class="turnBoxzz">
    
</div> 
<div class="articalContent  " id="sina_keyword_ad_area2"> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px; background-color:rgb(247,247,247); text-align:left"> <span style="font-size:12px; color:#333333"><span style="line-height:18px">找了好久，终于见到某位仁兄给出了javax.mail运行机制的详细分析，感激感激，收藏了，以防找不到。</span></span></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> ++++++++++++++++++++++++++++++++++++++++++++</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 打开JavaMail.jar文件，我们将发现在javax.mail的包下面存在着一些核心类：Session、Message、Address、Authenticator、Transport、Store、Folder。而且在 javax.mail.internet包中还有一些常用的子类。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left">  <wbr></wbr></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> <strong style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">A．Session</strong></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> Session类定义了基本的邮件会话。就像Http会话那样，我们进行收发邮件的工作都是基于这个会话的。Session对象利用了java.util.Properties对象获得了邮件服务器、用户名、密码信息和整个应用程序都要使用到的共享信息。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> Session类的构造方法是私有的，所以我们可以使用Session类提供的getDefaultInstance()这个静态工厂方法获得一个默认的Session对象：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Properties props = new Properties();// fill props with any information 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2   
    <wbr></wbr>Session session = Session.getDefaultInstance(props, null); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 或者使用getInstance()这个静态工厂方法获得自定义的Session:</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Properties props = new Properties();// fill props with any information 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2   
    <wbr></wbr>Session session = Session.getInstance(props, null); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 从上面的两个例子中不难发现，getDefaultInstance()和getInstance()方法的第二个参数都是null，这是因为在上面的例子中并没有使用到邮件授权，下文中将对授权进行详细介绍。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 从很多的实例看，在对mail <wbr></wbr>server进行访问的过程中使用共享的Session是足够的，即使是工作在多个用户邮箱的模式下也不例外。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> <strong style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">B．Message</strong></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 当我们建立了Session对象后，便可以构造被发送的信息体了。在这里SUN提供了Message类型来帮助开发者完成这项工作。由于Message是一个抽象类，大多数情况下，我们使用 javax.mail.internet.MimeMessage这个子类，该类是使用MIME类型、MIME信息头的邮箱信息。信息头只能使用US- ASCII字符，而非ASCII字符将通过编码转换为ASCII的方式使用。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 为了建立一个MimeMessage对象，我们必须将Session对象作为MimeMessage构造方法的参数传入：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 MimeMessage message = new MimeMessage(session); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 注意：对于MimeMessage类来讲存在着多种构造方法，比如使用输入流作为参数的构造方法。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 在建立了MimeMessage对象后，我们需要设置它的各个part，对于MimeMessage类来说，这些part就是MimePart接口。最基本的设置信息内容的方法就是通过表示信息内容和米么类型的参数调用setContent()方法：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 message.setContent(“Hello”, “text/plain”); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 然而，如果我们所使用的MimeMessage中信息内容是文本的话，我们便可以直接使用setText()方法来方便的设置文本内容：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 message.setText(“Hello”); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 前面所讲的两种方法，对于文本信息，后者更为合适。而对于其它的一些信息类型，比如HTML信息，则要使用前者。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 别忘记了，使用setSubject()方法对邮件设置邮件主题：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 message.setSubject(“First”); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> <strong style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">C．Address</strong></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 到这里，我们已经建立了Session和Message，下面将介绍如何使用邮件地址类：Address。像Message一样，Address类也是一个抽象类，所以我们将使用javax.mail.internet.InternetAddress这个子类。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 通过传入代表邮件地址的字符串，我们可以建立一个邮件地址类：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Address address = new InternetAddress(“president@whitehouse.gov”); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 如果要在邮件地址后面增加名字的话，可以通过传递两个参数：代表邮件地址和名字的字符串来建立一个具有邮件地址和名字的邮件地址类：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Address address = new InternetAddress(“president@whitehouse.gov”, “George Bush”); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 本文在这里所讲的邮件地址类是为了设置邮件信息的发信人和收信人而准备的，在建立了邮件地址类后，我们通过message的setFrom()和setReplyTo()两种方法设置邮件的发信人：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 message.setFrom(address);message.setReplyTo(address); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 若在邮件中存在多个发信人地址，我们可用addForm()方法增加发信人：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Address address[] = …; 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2 message.addFrom(address); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 为了设置收信人，我们使用addRecipient()方法增加收信人，此方法需要使用Message.RecipientType的常量来区分收信人的类型：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 message.addRecipient(type, address) 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 下面是Message.RecipientType的三个常量：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Message.RecipientType.TO 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2 Message.RecipientType.CC 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 3 Message.RecipientType.BCC 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 因此，如果我们要发送邮件给总统，并发用一个副本给第一夫人的话，下面的方法将被用到：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Address toAddress = new InternetAddress(“vice.president@whitehouse.gov”); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2 Address ccAddress = new InternetAddress(“first.lady@whitehouse.gov”); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 3 message.addRecipient(Message.RecipientType.TO, toAddress); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 4 message.addRecipient(Message.RecipientType.CC, ccAddress); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> JavaMail <wbr></wbr>API并没有提供检查邮件地址有效性的机制。当然我们可以自己完成这个功能：验证邮件地址的字符是否按照RFC822规定的格式书写或者通过DNS服务器上的MX记录验证等。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> <strong style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">D．Authenticator</strong></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 像java.net类那样，JavaMail <wbr></wbr>API通过使用授权者类（Authenticator）以用户名、密码的方式访问那些受到保护的资源，在这里“资源”就是指邮件服务器。在javax.mail包中可以找到这个 JavaMail的授权者类（Authenticator）。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 在使用Authenticator这个抽象类时，我们必须采用继承该抽象类的方式，并且该继承类必须具有返回PasswordAuthentication对象（用于存储认证时要用到的用户名、密码）getPasswordAuthenticatio<wbr></wbr>n()方法。并且要在Session中进行注册，使Session能够了解在认证时该使用哪个类。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 下面代码片断中的MyAuthenticator就是一个Authenticator的子类：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Properties props = new Properties();// fill props with any information 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2   
    <wbr></wbr>Authenticator auth = new MyAuthenticator(); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 3 Session session = Session.getDefaultInstance(props, auth); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> <strong style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">E．Transport</strong></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 在发送信息时，Transport类将被用到。这个类实现了发送信息的协议（通称为SMTP），此类是一个抽象类，我们可以使用这个类的静态方法send()来发送消息：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Transport.send(message); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 当然，方法是多样的。我们也可由Session获得相应协议对应的Transport实例。并通过传递用户名、密码、邮件服务器主机名等参数建立与邮件服务器的连接，并使用sendMessage()方法将信息发送，最后关闭连接：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 message.saveChanges(); // implicit with send() 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2   
    <wbr></wbr>Transport transport = session.getTransport(“smtp”); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 3 transport.connect(host, username, password); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 4 transport.sendMessage(message, message.getAllRecipients()); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 5 transport.close(); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 评论：上面的方法是一个很好的方法，尤其是在我们在同一个邮件服务器上发送多个邮件时。因为这时我们将在连接邮件服务器后连续发送邮件，然后再关闭掉连接。send()这个基本的方法是在每次调用时进行与邮件服务器的连接的，对于在同一个邮件服务器上发送多个邮件来讲可谓低效的方式。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 注意：如果需要在发送邮件过程中监控mail命令的话，可以在发送前设置debug标志：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 session.setDebug(true)； 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> <strong style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">F．Store和Folder</strong></p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 接收邮件和发送邮件很类似都要用到Session。但是在获得Session后，我们需要从Session中获取特定类型的Store，然后连接到 Store，这里的Store代表了存储邮件的邮件服务器。在连接Store的过程中，极有可能需要用到用户名、密码或者Authenticator。</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Store store = session.getStore(“pop3″); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2 store.connect(host, username, password); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 在连接到Store后，一个Folder对象即目录对象将通过Store的getFolder()方法被返回，我们可从这个Folder中读取邮件信息：</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 Folder folder = store.getFolder(“INBOX”); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2 folder.open(Folder.READ_ONLY); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 3 Message message[] = folder.getMessages(); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 上面的例子首先从Store中获得INBOX这个Folder（对于POP3协议只有一个名为INBOX的Folder有效），然后以只读（Folder.READ_ONLY）的方式打开Folder，最后调用Folder的 getMessages()方法得到目录中所有Message的数组。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 注意：对于POP3协议只有一个名为INBOX的Folder有效，而对于IMAP协议，我们可以访问多个Folder（想想前面讲的IMAP协议）。而且SUN在设计 Folder的getMessages()方法时采取了很智能的方式：首先接收新邮件列表，然后再需要的时候（比如读取邮件内容）才从邮件服务器读取邮件内容。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 在读取邮件时，我们可以用Message类的getContent()方法接收邮件或是writeTo()方法将邮件保存，getContent()方法只接收邮件内容（不包含邮件头），而writeTo()方法将包括邮件头。</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 System.out.println(((MimeMessage)message).getContent()); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 在读取邮件内容后，别忘记了关闭Folder和Store。</p> 
 <div style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px; color:rgb(51,51,51); line-height:normal; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 
  <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
   <div style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px">
     1 folder.close(aBoolean); 
    <br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2 store.close(); 
   </div> 
  </blockquote> 
 </div> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left"> 传递给Folder.close()方法的boolean类型参数表示是否在删除操作邮件后更新Folder。</p> 
 <p style="padding-right:0px; padding-left:0px; font-size:13px; padding-bottom:0px; margin:0px 0px 18px; color:rgb(51,51,51); line-height:18px; padding-top:0px; font-family:Tahoma,Arial,Helvetica,sans-serif; background-color:rgb(247,247,247); text-align:left">  <wbr></wbr></p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 1．发送邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 在获得了Session后，建立并填入邮件信息，然后发送它到邮件服务器。这便是使用Java <wbr></wbr>Mail <wbr></wbr>API发送邮件的过程，在发送邮件之前，我们需要设置SMTP服务器：通过设置Properties的mail.smtp.host属性。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> String <wbr></wbr>host <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> String <wbr></wbr>from <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> String <wbr></wbr>to <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>system <wbr></wbr>properties<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Properties <wbr></wbr>props <wbr></wbr>= <wbr></wbr>System.getProperties();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Setup <wbr></wbr>mail <wbr></wbr>server<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> props.put(“mail.smtp.host”, <wbr></wbr>host);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>session<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Session <wbr></wbr>session <wbr></wbr>= <wbr></wbr>Session.getDefaultInstance(props, <wbr></wbr>null);// <wbr></wbr>Define <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> MimeMessage <wbr></wbr>message <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMessage(session);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setFrom(new <wbr></wbr>InternetAddress(from));message.addRecipient(Message.RecipientType.TO, <wbr></wbr> <wbr></wbr> <wbr></wbr>new <wbr></wbr>InternetAddress(to));message.setSubject(“Hello <wbr></wbr>JavaMail”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setText(“Welcome <wbr></wbr>to <wbr></wbr>JavaMail”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Send <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Transport.send(message);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 由于建立邮件信息和发送邮件的过程中可能会抛出异常，所以我们需要将上面的代码放入到try-catch结构块中。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 2．接收邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 为了在读取邮件，我们获得了session，并且连接到了邮箱的相应store，打开相应的Folder，然后得到我们想要的邮件，当然别忘记了在结束时关闭连接。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> String <wbr></wbr>host <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> String <wbr></wbr>username <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> String <wbr></wbr>password <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>empty <wbr></wbr>properties<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Properties <wbr></wbr>props <wbr></wbr>= <wbr></wbr>new <wbr></wbr>Properties();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>session<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Session <wbr></wbr>session <wbr></wbr>= <wbr></wbr>Session.getDefaultInstance(props, <wbr></wbr>null);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>the <wbr></wbr>store<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Store <wbr></wbr>store <wbr></wbr>= <wbr></wbr>session.getStore(“pop3″);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> store.connect(host, <wbr></wbr>username, <wbr></wbr>password);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>folder<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Folder <wbr></wbr>folder <wbr></wbr>= <wbr></wbr>store.getFolder(“INBOX”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> folder.open(Folder.READ_ONLY);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>directory<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Message <wbr></wbr>message[] <wbr></wbr>= <wbr></wbr>folder.getMessages();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> for <wbr></wbr>(int <wbr></wbr>i=0, <wbr></wbr>n=message.length; <wbr></wbr>i++)…</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 上面的代码所作的是从邮箱中读取每个邮件，并且显示邮件的发信人地址和主题。从技术角度讲，这里存在着一个异常的可能：当发信人地址为空时，getFrom()[0]将抛出异常。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 下面的代码片断有效的说明了如何读取邮件内容，在显示每个邮件发信人和主题后，将出现用户提示从而得到用户是否读取该邮件的确认，如果输入YES的话，我们可用Message.writeTo(java.io.OutputStream <wbr></wbr>os)方法将邮件内容输出到控制台上，关于 Message.writeTo()的具体用法请看JavaMail <wbr></wbr>API。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> BufferedReader <wbr></wbr>reader <wbr></wbr>= <wbr></wbr>new <wbr></wbr>BufferedReader <wbr></wbr>( <wbr></wbr> <wbr></wbr>new <wbr></wbr>InputStreamReader(System.in));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>directory<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Message <wbr></wbr>message[] <wbr></wbr>= <wbr></wbr>folder.getMessages();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> for <wbr></wbr>(int <wbr></wbr>i=0, <wbr></wbr>n=message.length; <wbr></wbr>i…</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 3．删除邮件和标志<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 设置与message相关的Flags是删除邮件的常用方法。这些Flags表示了一些系统定义和用户定义的不同状态。在Flags类的内部类Flag中预定义了一些标志：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> Flags.Flag.ANSWERED<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Flags.Flag.DELETED<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Flags.Flag.DRAFT<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Flags.Flag.FLAGGED<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Flags.Flag.RECENT<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Flags.Flag.SEEN<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Flags.Flag.USER</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 但需要在使用时注意的：标志存在并非意味着这个标志被所有的邮件服务器所支持。例如，对于删除邮件的操作，POP协议不支持上面的任何一个。所以要确定哪些标志是被支持的??通过访问一个已经打开的Folder对象的getPermanetFlags()方法，它将返回当前被支持的Flags类对象。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 删除邮件时，我们可以设置邮件的DELETED标志：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> message.setFlag(Flags.Flag.DELETED, <wbr></wbr>true);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 但是首先要采用READ_WRITE的方式打开Folder：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> folder.open(Folder.READ_WRITE);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 在对邮件进行删除操作后关闭Folder时，需要传递一个true作为对删除邮件的擦除确认。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> folder.close(true);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> Folder类中另一种用于删除邮件的方法expunge()也同样可删除邮件，但是它并不为sun提供的POP3实现支持，而其它第三方提供的POP3实现支持或者并不支持这种方法。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 另外，介绍一种检查某个标志是否被设置的方法：Message.isSet(Flags.Flag <wbr></wbr>flag)方法，其中参数为被检查的标志。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 4．邮件认证<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 我 们在前面已经学会了如何使用Authenticator类来代替直接使用用户名和密码这两字符串作为 Session.getDefaultInstance()或者Session.getInstance()方法的参数。在前面的小试牛刀后，现在我们将了解到全面认识一下邮件认证。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 我们在此取代了直接使用邮件服务器主机名、用户名、密码这三个字符串作为连接到POP3 <wbr></wbr>Store的方式，使用存储了邮件服务器主机名信息的属性文件，并在获得Session时传入自定义的Authenticator实例：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> // <wbr></wbr>Setup <wbr></wbr>properties<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Properties <wbr></wbr>props <wbr></wbr>= <wbr></wbr>System.getProperties();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> props.put(“mail.pop3.host”, <wbr></wbr>host);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Setup <wbr></wbr>authentication, <wbr></wbr>get <wbr></wbr>session<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Authenticator <wbr></wbr>auth <wbr></wbr>= <wbr></wbr>new <wbr></wbr>PopupAuthenticator();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Session <wbr></wbr>session <wbr></wbr>= <wbr></wbr>Session.getDefaultInstance(props, <wbr></wbr>auth);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Get <wbr></wbr>the <wbr></wbr>store<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Store <wbr></wbr>store <wbr></wbr>= <wbr></wbr>session.getStore(“pop3″);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> store.connect();</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> PopupAuthenticator 类继承了抽象类Authenticator，并且通过重载Authenticator类的getPasswordAuthenticatio<wbr></wbr>n()方法返回PasswordAuthentication类对象。而getPasswordAuthenticatio<wbr></wbr>n()方法的参数param是以逗号分割的用户名、密码组成的字符串。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> import <wbr></wbr>javax.mail.*;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> import <wbr></wbr>java.util.*;</p> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> public <wbr></wbr>class <wbr></wbr>PopupAuthenticator <wbr></wbr>extends <wbr></wbr>Authenticator <wbr></wbr>{<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> public <wbr></wbr>PasswordAuthentication <wbr></wbr>getPasswordAuthenticatio<wbr></wbr>n(String <wbr></wbr>param) <wbr></wbr>{<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> String <wbr></wbr>username, <wbr></wbr>password;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> StringTokenizer <wbr></wbr>st <wbr></wbr>= <wbr></wbr>new <wbr></wbr>StringTokenizer(param, <wbr></wbr>”,”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> username <wbr></wbr>= <wbr></wbr>st.nextToken();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> password <wbr></wbr>= <wbr></wbr>st.nextToken();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> return <wbr></wbr>new <wbr></wbr>PasswordAuthentication(username, <wbr></wbr>password);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> }<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> }</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 5．回复邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 回复邮件的方法很简单：使用Message类的reply()方法，通过配置回复邮件的收件人地址和主题（如果没有提供主题的话，系统将默认将“Re：”作为邮件的主体），这里不需要设置任何的邮件内容，只要复制发信人或者 reply-to到新的收件人。而reply()方法中的boolean参数表示是否将邮件回复给发送者（参数值为false），或是恢复给所有人（参数值为true）。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 补充一下，reply-to地址需要在发信时使用setReplyTo()方法设置。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> MimeMessage <wbr></wbr>reply <wbr></wbr>= <wbr></wbr>(MimeMessage)message.reply(false);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> reply.setFrom(new <wbr></wbr>InternetAddress(“president@whitehouse.gov”));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> reply.setText(“Thanks”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Transport.send(reply);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 6．转发邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 转发邮件的过程不如前面的回复邮件那样简单，它将建立一个转发邮件，这并非一个方法就能做到。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 每个邮件是由多个部分组成，每个部分称为一个邮件体部分，是一个BodyPart类对象，对于MIME类型邮件来讲就是MimeBodyPart类对象。这些邮件体包含在成为Multipart的容器中对于MIME类型邮件来讲就是MimeMultiPart类对象。在转发邮件时，我们建立一个文字邮件体部分和一个被转发的文字邮件体部分，然后将这两个邮件体放到一个Multipart中。说明一下，复制一个邮件内容到另一个邮件的方法是仅复制它的 DataHandler（数据处理者）即可。这是由JavaBeans <wbr></wbr>Activation <wbr></wbr>Framework定义的一个类，它提供了对邮件内容的操作命令的访问、管理了邮件内容操作，是不同的数据源和数据格式之间的一致性接口。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>the <wbr></wbr>message <wbr></wbr>to <wbr></wbr>forward<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Message <wbr></wbr>forward <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMessage(session);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Fill <wbr></wbr>in <wbr></wbr>header<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> forward.setSubject(“Fwd: <wbr></wbr>” <wbr></wbr>+ <wbr></wbr>message.getSubject());<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> forward.setFrom(new <wbr></wbr>InternetAddress(from));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> forward.addRecipient(Message.RecipientType.TO, <wbr></wbr> <wbr></wbr> <wbr></wbr>new <wbr></wbr>InternetAddress(to));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>your <wbr></wbr>new <wbr></wbr>message <wbr></wbr>part<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> BodyPart <wbr></wbr>messageBodyPart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeBodyPart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setText( <wbr></wbr> <wbr></wbr>”Here <wbr></wbr>you <wbr></wbr>go <wbr></wbr>with <wbr></wbr>the <wbr></wbr>original <wbr></wbr>message:\n\n”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>a <wbr></wbr>multi-part <wbr></wbr>to <wbr></wbr>combine <wbr></wbr>the <wbr></wbr>parts<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Multipart <wbr></wbr>multipart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMultipart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> multipart.addBodyPart(messageBodyPart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>and <wbr></wbr>fill <wbr></wbr>part <wbr></wbr>for <wbr></wbr>the <wbr></wbr>forwarded <wbr></wbr>content<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeBodyPart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setDataHandler(message.getDataHandler());<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Add <wbr></wbr>part <wbr></wbr>to <wbr></wbr>multi <wbr></wbr>part<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> multipart.addBodyPart(messageBodyPart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Associate <wbr></wbr>multi-part <wbr></wbr>with <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> forward.setContent(multipart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Send <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Transport.send(forward);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 7．使用附件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 附件作为与邮件相关的资源经常以文本、表格、图片等格式出现，如流行的邮件客户端一样，我们可以用JavaMail <wbr></wbr>API从邮件中获取附件或是发送带有附件的邮件。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> A．发送带有附件的邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 发送带有附件的邮件的过程有些类似转发邮件，我们需要建立一个完整邮件的各个邮件体部分，在第一个部分（即我们的邮件内容文字）后，增加一个具有DataHandler的附件而不是在转发邮件时那样复制第一个部分的DataHandler。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 如果我们将文件作为附件发送，那么要建立FileDataSource类型的对象作为附件数据源；如果从URL读取数据作为附件发送，那么将要建立URLDataSource类型的对象作为附件数据源。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 然后将这个数据源（FileDataSource或是URLDataSource）对象作为DataHandler类构造方法的参数传入，从而建立一个DataHandler对象作为数据源的DataHandler。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 接着将这个DataHandler设置为邮件体部分的DataHandler。这样就完成了邮件体与附件之间的关联工作，下面的工作就是BodyPart的setFileName()方法设置附件名为原文件名。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 最后将两个邮件体放入到Multipart中，设置邮件内容为这个容器Multipart，发送邮件。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> // <wbr></wbr>Define <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Message <wbr></wbr>message <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMessage(session);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setFrom(new <wbr></wbr>InternetAddress(from));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.addRecipient(Message.RecipientType.TO, <wbr></wbr> <wbr></wbr> <wbr></wbr>new <wbr></wbr>InternetAddress(to));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setSubject(“Hello <wbr></wbr>JavaMail <wbr></wbr>Attachment”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>the <wbr></wbr>message <wbr></wbr>part<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> BodyPart <wbr></wbr>messageBodyPart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeBodyPart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Fill <wbr></wbr>the <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setText(“Pardon <wbr></wbr>Ideas”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Multipart <wbr></wbr>multipart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMultipart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> multipart.addBodyPart(messageBodyPart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Part <wbr></wbr>two <wbr></wbr>is <wbr></wbr>attachment<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeBodyPart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> DataSource <wbr></wbr>source <wbr></wbr>= <wbr></wbr>new <wbr></wbr>FileDataSource(filename);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setDataHandler(new <wbr></wbr>DataHandler(source));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setFileName(filename);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> multipart.addBodyPart(messageBodyPart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Put <wbr></wbr>parts <wbr></wbr>in <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setContent(multipart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Send <wbr></wbr>the <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Transport.send(message);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 如果我们使用servlet实现发送带有附件的邮件，则必须上传附件给servlet，这时需要注意提交页面form中对编码类型的设置应为multipart/form-data。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> B．读取邮件中的附件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 读取邮件中的附件的过程要比发送它的过程复杂一点。因为带有附件的邮件是多部分组成的，我们必须处理每一个部分获得邮件的内容和附件。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 但是如何辨别邮件信息内容和附件呢？Sun在Part类（BodyPart类实现的接口类）中提供了getDisposition()方法让开发者获得邮件体部分的部署类型，当该部分是附件时，其返回之将是Part.ATTACHMENT。但附件也可以没有部署类型的方式存在或者部署类型为 Part.INLINE，无论部署类型为Part.ATTACHMENT还是Part.INLINE，我们都能把该邮件体部分导出保存。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> Multipart <wbr></wbr>mp <wbr></wbr>= <wbr></wbr>(Multipart)message.getContent();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> for <wbr></wbr>(int <wbr></wbr>i=0, <wbr></wbr>n=multipart.getCount(); <wbr></wbr>i…</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 下列代码中使用了saveFile方法是自定义的方法，它根据附件的文件名建立一个文件，如果本地磁盘上存在名为附件的文件，那么将在文件名后增加数字表示区别。然后从邮件体中读取数据写入到本地文件中（代码省略）。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> // <wbr></wbr>from <wbr></wbr>saveFile()<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> File <wbr></wbr>file <wbr></wbr>= <wbr></wbr>new <wbr></wbr>File(filename);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> for <wbr></wbr>(int <wbr></wbr>i=0; <wbr></wbr>file.exists(); <wbr></wbr>i++)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> {<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> file <wbr></wbr>= <wbr></wbr>new <wbr></wbr>File(filename+i);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> }</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 以上是邮件体部分被正确设置的简单例子，如果邮件体部分的部署类型为null，那么我们通过获得邮件体部分的MIME类型来判断其类型作相应的处理，代码结构框架如下：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> if <wbr></wbr>(disposition <wbr></wbr>== <wbr></wbr>null) <wbr></wbr>{<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Check <wbr></wbr>if <wbr></wbr>plain<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> MimeBodyPart <wbr></wbr>mbp <wbr></wbr>= <wbr></wbr>(MimeBodyPart)part;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> if <wbr></wbr>(mbp.isMimeType(“text/plain”)) <wbr></wbr>{<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Handle <wbr></wbr>plain<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> } <wbr></wbr>else <wbr></wbr>{<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Special <wbr></wbr>non-attachment <wbr></wbr>cases <wbr></wbr>here <wbr></wbr>of<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>image/gif, <wbr></wbr>text/html, <wbr></wbr>.<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> ..<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> }<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> …<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> }</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 8．处理HTML邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 前面的例子中发送的邮件都是以文本为内容的（除了附件），下面将介绍如何接收和发送基于HTML的邮件。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> A．发送HTML邮件<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 假如我们需要发送一个HTML文件作为邮件内容，并使邮件客户端在读取邮件时获取相关的图片或者文字的话，只要设置邮件内容为html代码，并设置内容类型为text/html即可：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> String <wbr></wbr>htmlText <wbr></wbr>= <wbr></wbr>”&lt;h1&gt;Hello&lt;/h1&gt;” ;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setContent(htmlText, <wbr></wbr>”text/html”));</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 请注意：这里的图片并不是在邮件中内嵌的，而是在URL中定义的。邮件接收者只有在线时才能看到。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 在接收邮件时，如果我们使用JavaMail <wbr></wbr>API接收邮件的话是无法实现以HTML方式显示邮件内容的。因为JavaMail <wbr></wbr>API邮件内容视为二进制流。所以要显示HTML内容的邮件，我们必须使用JEditorPane或者第三方HTML展现组件。</p> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 以下代码显示了如何使用JEditorPane显示邮件内容：</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> if <wbr></wbr>(message.getContentType().equals(“text/html”)) <wbr></wbr>{<!-- --><br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> String <wbr></wbr>content <wbr></wbr>= <wbr></wbr>(String)message.getContent();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> JFrame <wbr></wbr>frame <wbr></wbr>= <wbr></wbr>new <wbr></wbr>JFrame();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> JEditorPane <wbr></wbr>text <wbr></wbr>= <wbr></wbr>new <wbr></wbr>JEditorPane(“text/html”, <wbr></wbr>content);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> text.setEditable(false);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> JScrollPane <wbr></wbr>pane <wbr></wbr>= <wbr></wbr>new <wbr></wbr>JScrollPane(text);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> frame.getContentPane().add(pane);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> frame.setSize(300, <wbr></wbr>300);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> frame.setDefaultCloseOperation<wbr></wbr>(JFrame.DISPOSE_ON_CLOSE);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> frame.show();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> }</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> B．在邮件中包含图片<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 如果我们在邮件中使用HTML作为内容，那么最好将HTML中使用的图片作为邮件的一部分，这样无论是否在线都会正确的显示HTML中的图片。处理方法就是将HTML中用到的图片作为邮件附件并使用特殊的cid <wbr></wbr>URL作为图片的引用，这个cid就是对图片附件的Content-ID头的引用。<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 处理内嵌图片就像向邮件中添加附件一样，不同之处在于我们必须通过设置图片附件所在的邮件体部分的header中Content-ID为一个随机字符串，并在HTML中img的src标记中设置为该字符串。这样就完成了图片附件与HTML的关联。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> String <wbr></wbr>file <wbr></wbr>= <wbr></wbr>…;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>the <wbr></wbr>messageMessage <wbr></wbr>message <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMessage(session);// <wbr></wbr>Fill <wbr></wbr>its <wbr></wbr>headers<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setSubject(“Embedded <wbr></wbr>Image”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setFrom(new <wbr></wbr>InternetAddress(from));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.addRecipient(Message.RecipientType.TO, <wbr></wbr> <wbr></wbr> <wbr></wbr>new <wbr></wbr>InternetAddress(to));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>your <wbr></wbr>new <wbr></wbr>message <wbr></wbr>part<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> BodyPart <wbr></wbr>messageBodyPart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeBodyPart();String <wbr></wbr>htmlText <wbr></wbr>= <wbr></wbr>”"&lt;h1&gt;Hello&lt;/h1&gt;” ;<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setContent(htmlText, <wbr></wbr>”text/html”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>a <wbr></wbr>related <wbr></wbr>multi-part <wbr></wbr>to <wbr></wbr>combine <wbr></wbr>the <wbr></wbr>parts<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> MimeMultipart <wbr></wbr>multipart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeMultipart(“related”);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> multipart.addBodyPart(messageBodyPart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Create <wbr></wbr>part <wbr></wbr>for <wbr></wbr>the <wbr></wbr>image<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart <wbr></wbr>= <wbr></wbr>new <wbr></wbr>MimeBodyPart();<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Fetch <wbr></wbr>the <wbr></wbr>image <wbr></wbr>and <wbr></wbr>associate <wbr></wbr>to <wbr></wbr>part<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> DataSource <wbr></wbr>fds <wbr></wbr>= <wbr></wbr>new <wbr></wbr>FileDataSource(file);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setDataHandler(new <wbr></wbr>DataHandler(fds));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> messageBodyPart.setHeader(“Content-ID”,”");<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Add <wbr></wbr>part <wbr></wbr>to <wbr></wbr>multi-part<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> multipart.addBodyPart(messageBodyPart);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> // <wbr></wbr>Associate <wbr></wbr>multi-part <wbr></wbr>with <wbr></wbr>message<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> message.setContent(multipart);</p> 
 </blockquote> 
 <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; padding-top:0px"> 9．在邮件中搜索短语<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> JavaMail <wbr></wbr>API提供了过滤器机制，它被用来建立搜索短语。这个短语由javax.mail.search包中的SearchTerm抽象类来定义，在定义后我们便可以使用Folder的Search()方法在Folder中查找邮件：<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> SearchTerm <wbr></wbr>st <wbr></wbr>= <wbr></wbr>…;Message[] <wbr></wbr>msgs <wbr></wbr>= <wbr></wbr>folder.search(st);<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 下面有22个不同的类（继承了SearchTerm类）供我们使用：<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> AND <wbr></wbr>terms <wbr></wbr>(class <wbr></wbr>AndTerm)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> OR <wbr></wbr>terms <wbr></wbr>(class <wbr></wbr>OrTerm)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> NOT <wbr></wbr>terms <wbr></wbr>(class <wbr></wbr>NotTerm)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> SENT <wbr></wbr>DATE <wbr></wbr>terms <wbr></wbr>(class <wbr></wbr>SentDateTerm)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> CONTENT <wbr></wbr>terms <wbr></wbr>(class <wbr></wbr>BodyTerm)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> HEADER <wbr></wbr>terms <wbr></wbr>(FromTerm <wbr></wbr>/ <wbr></wbr>FromStringTerm, <wbr></wbr>RecipientTerm <wbr></wbr>/ <wbr></wbr>RecipientStringTerm, <wbr></wbr>SubjectTerm, <wbr></wbr>etc.)<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> 使用这些类定义的断语集合，我们可以构造一个逻辑表达式，并在Folder中进行搜索。下面是一个实例：在Folder中搜索邮件主题含有“ADV”字符串或者发信人地址为friend@public.com的邮件。</p> 
 <blockquote style="border-right:rgb(221,221,221) 1px solid; padding-right:10px; border-top:rgb(221,221,221) 1px solid; padding-left:10px; padding-bottom:10px; margin:0px 0px 20px; border-left:rgb(221,221,221) 1px solid; color:rgb(85,85,85); line-height:normal; padding-top:10px; border-bottom:rgb(221,221,221) 1px solid; background-color:rgb(238,238,238)"> 
  <p style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px 0px 18px; line-height:18px; padding-top:0px"> SearchTerm <wbr></wbr>st <wbr></wbr>= <wbr></wbr>new <wbr></wbr>OrTerm(new <wbr></wbr>SubjectTerm(“ADV:”), new <wbr></wbr>FromStringTerm(“friend@public.com”));<br style="padding-right:0px; padding-left:0px; padding-bottom:0px; margin:0px; padding-top:0px"> Message[] <wbr></wbr>msgs <wbr></wbr>= <wbr></wbr>folder.search(st);</p> 
 </blockquote> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5a5cbca51e45739a0c685d989211e31f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于IRET指令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/531c093d84d0a6b2da94a4b7b499bd0f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VC&#43;&#43;实现视频压缩编码标准 MPEG-4</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>