<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>php随机跳转到某一图片链接 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="php随机跳转到某一图片链接" />
<meta property="og:description" content="文章目录 引言直接显示（不适用于主题）正确方式：跳转链接附录 引言 本文章首发于博主的个人网站
在WordPress的Sakurairo主题中，可以设置随机封面图片的api地址。
初始时就设定好了两个api链接，分别适配pc端和移动端的封面大小。
PC端（点击访问）移动端（点击访问） 每次在浏览器打开上面的链接，都会随机返回一张图片。不过，与之前 随机句子的直接返回显示方式不同，这个api是每次访问会自动调转到某一图片链接，即使不断刷新，显示的还是同一张图片。从地址栏可以发现访问的链接的地址已经从（xxx.php）变成了图片的链接地址（xxx.webp）。
示例：
直接显示（不适用于主题） 参考来源/转载自：CSDN 「海拥✘」
思路：
（1）准备图片放入文件夹中。（示例：网站/random/imagesapi/pcbg文件夹）
（2）同路径下新建index.php文件（示例：网站/random/imagesapi/index.php），,使得访问该路径时就能默认访问index.php。
（3）编写index.php，使其随机显示一张文件夹中的图片。
（4）上传以上文件到网站服务器，通过访问到路径即可。(示例：https://www.georgewahson.club/random/imagesapi/)
index.php代码解释：图片文件夹路径： $imageFolder = &#39;image/&#39;; 获取图片文件列表： $imageFiles = scandir($imageFolder); 过滤掉&#34;.“和”..&#34;目录： $imageFiles = array_diff($imageFiles, array(&#39;..&#39;, &#39;.&#39;)); 随机选择一张图片： $randomImage = $imageFiles[array_rand($imageFiles)]; 图片显示： echo &#39;&lt;img src=&#34;&#39; . $imageFolder . $randomImage . &#39;&#34; alt=&#34;随机图片&#34;&gt;&#39;; 完整代码：
&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;随机调用图片&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;?php // 图片文件夹路径 $imageFolder = &#39;image/&#39;; // 获取图片文件列表 $imageFiles = scandir($imageFolder); // 过滤掉&#34;.&#34;和&#34;..&#34;目录 $imageFiles = array_diff($imageFiles, array(&#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/764930658e12a66d309c9849fc97e3c0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-22T20:36:13+08:00" />
<meta property="article:modified_time" content="2023-10-22T20:36:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">php随机跳转到某一图片链接</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">引言</a></li><li><a href="#_19" rel="nofollow">直接显示（不适用于主题）</a></li><li><a href="#_86" rel="nofollow">正确方式：跳转链接</a></li><li><a href="#_119" rel="nofollow">附录</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>引言</h3> 
<blockquote> 
 <p>本文章首发于博主的<a href="https://www.georgewahson.club/51.html" rel="nofollow">个人网站</a></p> 
</blockquote> 
<p>在WordPress的Sakurairo主题中，可以设置随机封面图片的api地址。<br> <img src="https://images2.imgbox.com/6f/f3/sutJnEJt_o.png" alt="在这里插入图片描述"></p> 
<p>初始时就设定好了两个api链接，分别适配pc端和移动端的封面大小。</p> 
<ul><li><a target="_blank" href="https://api.maho.cc/random-img/pc.php" rel="noopener noopener noreferrer"><font color="blue">PC端（点击访问）</font></a></li><li><a target="_blank" href="https://api.maho.cc/random-img/mobile.php" rel="noopener noopener noreferrer"><font color="blue">移动端（点击访问）</font></a></li></ul> 
<p>每次在浏览器打开上面的链接，都会随机返回一张图片。<strong>不过</strong>，与之前 <a target="_blank" href="https://www.georgewahson.club/34.html" rel="noopener noopener noreferrer">随机句子</a>的<strong>直接返回显示</strong>方式不同，这个api是每次访问会自动<strong>调转</strong>到某一图片链接，即使不断刷新，显示的还是同一张图片。从地址栏可以发现访问的链接的地址已经从（<code>xxx.php</code>）变成了图片的链接地址（<code>xxx.webp</code>）。</p> 
<ul><li>示例：<br> <img src="https://images2.imgbox.com/d4/d1/KpszuEGx_o.gif" alt="在这里插入图片描述"></li></ul> 
<hr> 
<h3><a id="_19"></a>直接显示（不适用于主题）</h3> 
<blockquote> 
 <p>参考来源/转载自：<a href="https://blog.csdn.net/qq_44273429/article/details/132336696" title="CSDN">CSDN 「海拥✘」</a></p> 
</blockquote> 
<p>思路：<br> （1）准备图片放入文件夹中。（示例：网站/random/imagesapi/pcbg文件夹）<br> （2）同路径下新建<code>index.php</code>文件（示例：网站/random/imagesapi/index.php），,使得访问该路径时就能默认访问<code>index.php</code>。<br> （3）编写<code>index.php</code>，使其随机<strong>显示</strong>一张文件夹中的图片。<br> （4）上传以上文件到网站服务器，通过访问到路径即可。(示例：https://www.georgewahson.club/random/imagesapi/)</p> 
<ul><li><code>index.php</code>代码解释：</li><li>图片文件夹路径：</li></ul> 
<pre><code class="prism language-php"><span class="token variable">$imageFolder</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'image/'</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>获取图片文件列表：</li></ul> 
<pre><code class="prism language-php"><span class="token variable">$imageFiles</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token variable">$imageFolder</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>过滤掉"<code>.</code>“和”<code>..</code>"目录：</li></ul> 
<pre><code class="prism language-php"><span class="token variable">$imageFiles</span> <span class="token operator">=</span> <span class="token function">array_diff</span><span class="token punctuation">(</span><span class="token variable">$imageFiles</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>随机选择一张图片：</li></ul> 
<pre><code class="prism language-php"><span class="token variable">$randomImage</span> <span class="token operator">=</span> <span class="token variable">$imageFiles</span><span class="token punctuation">[</span><span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token variable">$imageFiles</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>图片显示：</li></ul> 
<pre><code>echo '&lt;img src="' . $imageFolder . $randomImage . '" alt="随机图片"&gt;';
</code></pre> 
<p><strong>完整代码：</strong></p> 
<pre><code class="prism language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>随机调用图片<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">?</span>php
    <span class="token comment">// 图片文件夹路径</span>
    <span class="token variable">$imageFolder</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'image/'</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 获取图片文件列表</span>
    <span class="token variable">$imageFiles</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token variable">$imageFolder</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 过滤掉"."和".."目录</span>
    <span class="token variable">$imageFiles</span> <span class="token operator">=</span> <span class="token function">array_diff</span><span class="token punctuation">(</span><span class="token variable">$imageFiles</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 随机选择一张图片</span>
    <span class="token variable">$randomImage</span> <span class="token operator">=</span> <span class="token variable">$imageFiles</span><span class="token punctuation">[</span><span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token variable">$imageFiles</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 图片显示</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src="'</span> <span class="token operator">.</span> <span class="token variable">$imageFolder</span> <span class="token operator">.</span> <span class="token variable">$randomImage</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'" alt="随机图片"&gt;'</span><span class="token punctuation">;</span>
    <span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>

</code></pre> 
<p>虽说我不懂<code>PHP</code>，但多少能看得出来，上面的<code>HTML</code>标签使得整个窗口显示被返回的图片。用来替换Sakurairo主题封面的外部api是无效的。（起码从前者访问后地址不变，后者访问后地址发生了变化上也能够看出）</p> 
<p>那假如去掉html标签呢（ {<!-- -->{guilian}} doge），笑死，效果是一样的。<code>index.php</code>代码中的<code>echo</code>就决定了这图片是被显示出来的。</p> 
<hr> 
<h3><a id="_86"></a>正确方式：跳转链接</h3> 
<p>以下回答来自 <a href="https://yiyan.baidu.com/" rel="nofollow" title="百度文心一言">百度文心一言</a></p> 
<p><strong>提问：</strong><br> 需求：现有一个images文件夹，内有照片若干<code>1.jpg</code>，<code>2.jpg</code>等等，通过网页 <code>www.test.com/images/1.jpg</code> 即可在线访问照片中的照片，请你编写<code>pc.php</code>文件，通过访问 <code>www.test.com/pc.php</code> 即可随机跳转到某一个图片的链接。请注意，是实现链接的跳转至 <code>www.test.com/images/x.jpg</code> ，而不是返回图片。</p> 
<hr> 
<p><strong>回答：</strong><br> 你可以使用<code>PHP</code>的<code>rand()</code>函数来随机生成一个图片文件名，并将其添加到你的图片文件夹的<code>URL</code>后面。以下是一个简单的示例：</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>  
<span class="token variable">$images</span> <span class="token operator">=</span> <span class="token function">glob</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'images/*.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取images文件夹下所有的.jpg文件  </span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$images</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token variable">$randomImage</span> <span class="token operator">=</span> <span class="token variable">$images</span><span class="token punctuation">[</span><span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token variable">$images</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 随机选择一个图片  </span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: http://www.test.com/images/'</span> <span class="token operator">.</span> <span class="token variable">$randomImage</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 跳转到随机图片的URL  </span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'没有找到任何图片'</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
<p>这个脚本首先获取<code>images</code>文件夹下的所有<code>.jpg</code>文件，然后从数组中随机选择一个元素。然后，它使用<code>PHP</code>的<code>header()</code>函数将用户的浏览器重定向到随机选择的图片<code>URL</code>。</p> 
<p>请注意，此脚本假设你的图片文件都在<code>"images"</code>文件夹中，且所有的图片文件都是<code>.jpg</code>格式。如果你的情况不同，那么你可能需要修改脚本以适应你的环境。</p> 
<p>还要注意的是，因为<code>header()</code>函数需要在输出任何内容之前使用，所以如果你在你的脚本中已经有了一些输出（例如在脚本的开头部分），那么你可能会遇到问题。为了避免这种问题，你可以将这段代码放在你的脚本的顶部，或者在任何可能产生输出的地方使用<code>ob_start()</code>函数。</p> 
<hr> 
<p>此时，将通过访问该php文件（<a target="_blank" href="https://www.georgewahson.club/random/imagesapi/pc.php" rel="noopener noopener noreferrer"><font color="blue">点我试试</font></a>）即可实现和主题默认api同样的功能。唯一不同的是示例代码中给的是<code>jpg</code>这一单一图片格式。（其实大部分情况下，用做图片背景的图片一般格式都是一致的，如统一使用<code>webp</code>。）但，如果非要使用不同格式的图片，那么把代码第二行中的<code>.jpg</code>改为<code>*</code>即可：</p> 
<pre><code class="prism language-php"><span class="token variable">$images</span> <span class="token operator">=</span> <span class="token function">glob</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'pcbg/*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_119"></a>附录</h3> 
<p>同一个问题，我也一字不差的问了 <a href="https://qianwen.aliyun.com/" rel="nofollow" title="阿里通义千问">阿里通义千问</a>进行比较。结果非常差劲，一眼就能看出来它给的代码有问题。即使重新生成重新提问也是一样。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/55c4eec5d0abc01eaead4ccfb9b3be8b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a009e5819566ca089988734939d9b295/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">开发一个ebpf程序</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>