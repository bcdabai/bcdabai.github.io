<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HDU4624Endless Spin(clj计数ppt） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="HDU4624Endless Spin(clj计数ppt）" />
<meta property="og:description" content="链接：http://acm.hdu.edu.cn/showproblem.php?pid=4624 题意：总共有n个球，每次随机选择一段区间染黑（每段区间被选择的概率相同），求期望多少次所有球都被染黑。
分析：虽然ppt中说显然，但我认为这个问题最为精妙的地方就在第一步：
期望次数=∑i=1∞p[i] ，其中 p[i] 为i次之后仍然存在白球的概率。 这个公式怎么来的呢？直观的理解就是假如当前还有白球，那么必然还要染一次，而这一次对整体期望的贡献就是p[i].这之后就是传统的处理方法，枚举哪些球是白球，那么可以染黑的区间是固定的，由于这当中会有重复计算，只需要把奇数个白球的情况减去偶数个白球的方案数就是总的方案数，这种容斥方法在后面的Substring Pairs一题中也有体现。 另外，这题要保留15位小数，要用java才能通过。 java进行文件读写，可以使用Printwriter来做写操作，不过要记得close. java可以方便的使用printf; java的BigDecimal进行divide操作时，要设置scale和舍入mode 附上java代码
import java.io.File; import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.io.PrintWriter; import java.math.BigDecimal; import java.math.BigInteger; import java.util.*; public class Main { public static void main(String[] args) throws FileNotFoundException { File fp2=new File(&#34;/home/poursoul/J.out&#34;); PrintWriter cout=new PrintWriter(fp2); Long [][][]dp=new Long[55][2500][2]; BigDecimal []rep=new BigDecimal[100]; for(int i=0;i&lt;60;i&#43;&#43;)rep[i]=new BigDecimal(&#34;0&#34;); for(int i=0;i&lt;55;i&#43;&#43;)for(int j=0;j&lt;2500;j&#43;&#43;)for(int k=0;k&lt;2;k&#43;&#43;)dp[i][j][k]=new Long(0); dp[0][0][0]=(long)1; BigDecimal t1=new BigDecimal(&#34;1&#34;); for(int i=1;i&lt;=51;i&#43;&#43;) { for(int j=0;j&lt;i*(i-1)/2;j&#43;&#43;) { for(int k=0;k&lt;2;k&#43;&#43;) { for(int ni=0;ni&lt;i;ni&#43;&#43;) { int tot=i-ni-1; tot=tot*(tot&#43;1)/2; if(j&gt;=tot) dp[i][j][k]&#43;=dp[ni][j-tot][k^1]; } } Long tp=(long)i*(i-1)/2; BigDecimal p=new BigDecimal(j)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/95d57b08f49f7d87d1160087e35ee0d2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-10-15T19:46:16+08:00" />
<meta property="article:modified_time" content="2015-10-15T19:46:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">HDU4624Endless Spin(clj计数ppt）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>链接：<a href="http://acm.hdu.edu.cn/showproblem.php?pid=4624" rel="nofollow">http://acm.hdu.edu.cn/showproblem.php?pid=4624</a> <br> 题意：总共有n个球，每次随机选择一段区间染黑（每段区间被选择的概率相同），求期望多少次所有球都被染黑。</p> 
<p>分析：虽然ppt中说显然，但我认为这个问题最为精妙的地方就在第一步：<span class="MathJax_Preview"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-455-Frame"> 
   
   <span class="math" id="MathJax-Span-7572" style="width: 8.619em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.116em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.009em 1000.003em 4.154em -0.563em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-7573"><span class="texatom" id="MathJax-Span-7574"><span class="mrow" id="MathJax-Span-7575"><span class="mo" id="MathJax-Span-7576"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">期</span></span></span></span><span class="texatom" id="MathJax-Span-7577"><span class="mrow" id="MathJax-Span-7578"><span class="mo" id="MathJax-Span-7579"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">望</span></span></span></span><span class="texatom" id="MathJax-Span-7580"><span class="mrow" id="MathJax-Span-7581"><span class="mo" id="MathJax-Span-7582"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">次</span></span></span></span><span class="texatom" id="MathJax-Span-7583"><span class="mrow" id="MathJax-Span-7584"><span class="mo" id="MathJax-Span-7585"><span style="font-family: STIXGeneral, 'Arial Unicode MS', serif; font-size: 94%; font-style: normal; font-weight: normal;">数</span></span></span></span><span class="mo" id="MathJax-Span-7586" style="font-family: MathJax_Main; padding-left: 0.255em;">=</span><span class="munderover" id="MathJax-Span-7587" style="padding-left: 0.255em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.582em 1000.003em 4.343em -0.5em); top: -3.708em; left: 0.003em;"><span class="mo" id="MathJax-Span-7588" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.714em;"></span></span><span style="position: absolute; clip: rect(1.701em 1000.003em 2.645em -0.563em); top: -1.255em; left: 0.066em;"><span class="texatom" id="MathJax-Span-7589"><span class="mrow" id="MathJax-Span-7590"><span class="mi" id="MathJax-Span-7591" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-7592" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-7593" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span><span style="position: absolute; clip: rect(1.701em 1000.003em 2.519em -0.5em); top: -3.456em; left: 0.318em;"><span class="mi" id="MathJax-Span-7594" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span style="display: inline-block; width: 0px; height: 2.33em;"></span></span></span></span><span class="mi" id="MathJax-Span-7595" style="font-family: MathJax_Math-italic; padding-left: 0.192em;">p</span><span class="mo" id="MathJax-Span-7596" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-7597" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-7598" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.07em; vertical-align: -1.33em;"></span></span> 
  </span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-455">期望次数=\sum_{i=1}^\infty p[i]</script>，其中 
<span class="MathJax_Preview"></span> 
<span class="MathJax" id="MathJax-Element-456-Frame"> 
  
  <span class="math" id="MathJax-Span-7599" style="width: 1.575em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px; font-size: 106%;"><span style="position: absolute; clip: rect(1.827em 1000.003em 3.211em -0.626em); top: -2.764em; left: 0.003em;"><span class="mrow" id="MathJax-Span-7600"><span class="mi" id="MathJax-Span-7601" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-7602" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-7603" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-7604" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.77em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.33em;"></span></span> 
 </span><script type="math/tex" id="MathJax-Element-456">p[i]</script>为i次之后仍然存在白球的概率。 
<br> 这个公式怎么来的呢？直观的理解就是假如当前还有白球，那么必然还要染一次，而这一次对整体期望的贡献就是p[i].这之后就是传统的处理方法，枚举哪些球是白球，那么可以染黑的区间是固定的，由于这当中会有重复计算，只需要把奇数个白球的情况减去偶数个白球的方案数就是总的方案数，这种容斥方法在后面的Substring Pairs一题中也有体现。 
<br> 另外，这题要保留15位小数，要用java才能通过。 
<br> java进行文件读写，可以使用Printwriter来做写操作，不过要记得close. 
<br> java可以方便的使用printf; 
<br> java的BigDecimal进行divide操作时，要设置scale和舍入mode 
<p></p> 
<p>附上java代码</p> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.FileInputStream;
<span class="hljs-keyword">import</span> java.io.FileNotFoundException;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.PrintWriter;
<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.math.BigInteger;
<span class="hljs-keyword">import</span> java.util.*;
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span>
{<!-- --></span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(String[] args) <span class="hljs-keyword">throws</span> FileNotFoundException 
        {
            File fp2=<span class="hljs-keyword">new</span> File(<span class="hljs-string">"/home/poursoul/J.out"</span>);
            PrintWriter cout=<span class="hljs-keyword">new</span> PrintWriter(fp2);
            Long [][][]dp=<span class="hljs-keyword">new</span> Long[<span class="hljs-number">55</span>][<span class="hljs-number">2500</span>][<span class="hljs-number">2</span>];
            BigDecimal []rep=<span class="hljs-keyword">new</span> BigDecimal[<span class="hljs-number">100</span>];
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">60</span>;i++)rep[i]=<span class="hljs-keyword">new</span> BigDecimal(<span class="hljs-string">"0"</span>);
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">55</span>;i++)<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">2500</span>;j++)<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>;k&lt;<span class="hljs-number">2</span>;k++)dp[i][j][k]=<span class="hljs-keyword">new</span> Long(<span class="hljs-number">0</span>);
            dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=(<span class="hljs-keyword">long</span>)<span class="hljs-number">1</span>;
            BigDecimal t1=<span class="hljs-keyword">new</span> BigDecimal(<span class="hljs-string">"1"</span>);

            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">51</span>;i++)
            {
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;i*(i-<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>;j++)
                {
                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>;k&lt;<span class="hljs-number">2</span>;k++)
                    {
                        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> ni=<span class="hljs-number">0</span>;ni&lt;i;ni++)
                        {
                            <span class="hljs-keyword">int</span> tot=i-ni-<span class="hljs-number">1</span>;
                            tot=tot*(tot+<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>;
                            <span class="hljs-keyword">if</span>(j&gt;=tot)
                               dp[i][j][k]+=dp[ni][j-tot][k^<span class="hljs-number">1</span>];
                        }
                    }
                    Long tp=(<span class="hljs-keyword">long</span>)i*(i-<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>;
                    BigDecimal p=<span class="hljs-keyword">new</span> BigDecimal(j).divide(<span class="hljs-keyword">new</span> BigDecimal(tp.toString()), <span class="hljs-number">50</span>, BigDecimal.ROUND_HALF_UP);
                    Long tp2=dp[i][j][<span class="hljs-number">1</span>]-dp[i][j][<span class="hljs-number">0</span>];
                    rep[i-<span class="hljs-number">1</span>]=rep[i-<span class="hljs-number">1</span>].add(t1.divide(t1.subtract(p), <span class="hljs-number">50</span>, BigDecimal.ROUND_HALF_UP).multiply(<span class="hljs-keyword">new</span> BigDecimal(tp2.toString())));
                }
               dp[i][i*(i-<span class="hljs-number">1</span>)/<span class="hljs-number">2</span>][<span class="hljs-number">0</span>]=<span class="hljs-keyword">new</span> Long(<span class="hljs-number">1</span>);
            }
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> n=<span class="hljs-number">1</span>;n&lt;=<span class="hljs-number">50</span>;n++)
                cout.printf(<span class="hljs-string">"\"%.15f\",\n"</span>,rep[n]);
            cout.close();
        }
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/91d66c6a756d09d80906129ee97b27c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">电源软启动的实用设计技巧</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/76b78a786d03e9752a547f7ba413c986/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">经典的面试题：用 4 个线程疯狂的打印 abcd 持续 5 秒钟，但是要按照顺序打印，不能是乱序的。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>