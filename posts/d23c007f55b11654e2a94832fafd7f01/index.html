<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深刻理解GPIO(上拉输入、下拉输入、模拟输入、浮空输入，开漏输出，推挽输出的区别，以STM32为例) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深刻理解GPIO(上拉输入、下拉输入、模拟输入、浮空输入，开漏输出，推挽输出的区别，以STM32为例)" />
<meta property="og:description" content="目录 前言GPIO是什么GPIO的八大模式输入模式浮空输入上拉输入下拉输入模拟输入 输出模式开漏输出推挽输出复用开漏输出复用推挽输出 GPIO的输出速率 前言 学习了这么久的单片机，说来羞愧，直到写这篇文章之前，我都没有仔细去理解GPIO的八种使用模式，之前只是傻傻的用着，直到把模电，数电学完，到今天重新回顾了一遍这一个知识，发现自己终于看懂了之前没有理解透彻的知识，特此总结下来。
GPIO是什么 从最基础的51单片机，Arduino，到STM32，树莓派等等，这些上面都会有GPIO口这么一个概念，如果你点开了我这个博客，说明你大概率开始学习单片机，那么你应该了解的就是这些口可以输出高低电平，或者是读取引脚上的输入电平。
GPIO的总述功能如下
GPIO(general porpose intputoutput):通用输入输出端口的简称。可以通过软件控制其输出和输入。stm32芯片的GPIO引脚与外部设备连接起来，从而实现与外部通信，控制以及数据采集的功能。
———GPIO简介
下面摆一张以STM32内部GPIO口为例的内部原理图，大伙也不要着急，先有一个这个图的概念，下面就是开始讲怎么理解GPIO口。
先来一点最基础的知识
上拉和下拉：
当我们闭合上拉电阻的开关，断开下拉电阻的开关的时候，也就是此时为上拉通路导通。根据我们最基础的电路知识，如果I/O口断开不接外设，或者接了外设但是电路也断开，此时整条回路是断路的时候，电阻相当于不存在，此时O点的电位，也就被钳制在了VDD(供电电压正极)，于是O点就处于高电平。
同理，闭合上拉电阻的开关，断开下拉电阻的开关，那么在电路断开的时候，根据电路知识，电阻相当于不存在，O点的电压就就被钳制**在了VSS(GND)，也就是O点处于低电平。
数字信号和模拟信号：
数字信号：就是根据一些规则，将一个范围内的电压规定为1，一个范围内的电压规定为0，也就是一连串的0,1信号
模拟信号：就是连续的读取到的电压值。
关于图上的TTL施密特触发器和P-MOS和N-MOS，后面讲到对应部分的时候会讲到。
GPIO的八大模式 GPIO可以分为输入或者输出，加起来一共有八种模式。
输入模式 在输入模式下，一共有四种输出模式，分别是
模拟输入上拉输入下拉输入浮空输入 浮空输入 浮空输入需要走的路径如图所示。首先得知道，浮空输出走的这一条路径，是对一个数字信号的读取。
需要的电路如下：
VDD和VSS所在路径的两个开关同时断开。此时没有上拉和下拉的情况，所以当IO口没有接输入的时候，此时的电平会是一个不确定的值，也就是我们所说的浮空。电平会处于一个跳变的状态，一会高，一会低。只有输入了一个高/低电平才会确定下来。
注意： 上拉和下拉电阻电路的开关在实际应用中一般使用MOS管来代替开关来提到。
再往前面走，就是走到了TTL施密特触发器这一个部分。我们知道，由于电源的特性，或者是由于外部开关输入的特性，输入的数字信号，极有可能会出现脉冲等噪声的影响，为了让我们的波形更好看，或者信号更加清晰，所以就设置了TTL施密特触发器这个东西。经过之后，我们就会把这个数字信息存储在输入数据寄存器中。
这样我们就读到了IO过来的数字信号
优势： 这一种输入模式的电平会完全取决于外部电路而与内部电路无关。有时候会用作对开关按键的读取。
但是在没有外部电路接入的时候，IO脚浮空会使得电平不确定
上拉输入 上拉输入需要走的路径如图所示。首先得知道，上拉输出走的这一条路径，是对一个数字信号的读取。
需要的电路如下:
VDD所在上拉电阻开关闭合，下拉电阻的开关断开。
根据前面浮空输入里面所提的，在没有信号输入的时候，根据电路知识，此时的电平就是VDD的电平，此时读取到的电平就是高电平。如果输入了一个高电平，VDD和O点(最上面的图中的O点)之间就几乎没有电势差，此时O点的电平就仍然是高电平，读取到的电平就是高电平。但是由于在没有电压输入的时候，电平也是高电平，所以这一种输入情况下是没有办法确定信号是否输入了。
当输入信号是一个低电平的时候，此时O点的电平的电平就会变成低电平，那么VDD和O点之间形成了电势差，但是因为上拉电阻的存在，所以不会出现一个大电流。此时单片机读取到的一个电平就是一个低电平。在上拉输入的情况下，低电平的是能够非常明显的读取到的。
上拉输入的好处就是输入的电平不会上下浮动而导致输入信号不稳定，在没有信号输入的情况下可以稳定在高电平。
下拉输入 下拉输入需要走的路径如图所示。首先得知道，下拉输出走的这一条路径，是对一个数字信号的读取。
需要的电路如下:
VDD所在上拉电阻开关断开，下拉电阻的开关闭合。
根据前面浮空输入里面所提的，在没有信号输入的时候，根据电路知识，电平就是VSS的电平，此时读取到的电平就是低电平。此时输入的电平如果是一个低电平，就没有办法和之前的情况进行区分。但如果输入的是一个高电平，O点和VSS之间同样形成了电势差，O点的电平会变成外部的高电平，那么单片机得到的就是一个高电平信号。
下拉输入的好处就是输入的电平不会上下浮动而导致输入信号不稳定，在没有信号输入的情况下可以稳定在低电平。
模拟输入 模拟输入需要走的路径如图所示。首先得知道，模拟输出走的这一条路径，是我们需要对一个模拟信号进行读取。
在我们使用单片机的时候，我们有时候需要用AD采集到IO口上面的真实电压。这就有了我们所需要的模拟输入。为了让外部的电压真实的读取到单片机的AD模块，我们既不能闭合上拉和下拉的开关，也不能让信号经过施密特触发器。
优势：可以让AD读取电压。还可以在低功耗模式下运行，实现省电的作用。
输出模式 在输出模式下，同样也有四种输出模式，分别是
开漏输出
推挽输出
复用开漏输出
复用推挽输出
开漏输出 ④⑤⑥⑦是读取的过程，此处不管。
开漏输出的电路路径是①②③④，②前面的步骤就是一个对输出信号的控制，不是重点，开漏输出里面最重要的是③，也就是N-MOS这一部分，下面来补充一下模电知识。
我们可以把这一个MOS管当成一个三极管，对于图中所示的这种三极管我们可以简单的理解成一个水龙头，左侧就是一个水龙头开关，当给一个高电平的时候， O点和GND就会导通。（O点的输出就是一种反向器的输出，也就是O点的电平会和左侧MOS的栅极(三极管的基极)相反）
所以说，开漏输出就很好理解了。当我们给一个低电平的时候，MOS管关闭，此时输出的电压就是一个浮空，即不确定的电压。如果给一个高电平，那么MOS管导通，相当于IO口与VSS相连，此处就输出了一个低电平电压。
优势①
虽然我们可以看到开漏输出是没有办法在内部输出一个高电平，但是这一个看似是缺点。其实实际上是一种优点。我们可以得到，当给一个低电平的时候，MOS管没有导通，此时电压不确定导致无法输出高电平，但是一旦我们在外部增加一个上拉，那么这一个缺点就会被有效避免。并且，因为是我们自己设计一个上拉，这个上拉的电压是由我们自己确定，这样我们就可以根据外部电路需要多少V的高电平来给这一个上拉的电压，可以更好的适应更多情况。 如下图，我们可以给定任意的VDD电压，来适应我们实际所需要的情况。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d23c007f55b11654e2a94832fafd7f01/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-25T21:08:16+08:00" />
<meta property="article:modified_time" content="2021-10-25T21:08:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深刻理解GPIO(上拉输入、下拉输入、模拟输入、浮空输入，开漏输出，推挽输出的区别，以STM32为例)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">前言</a></li><li><a href="#GPIO_6" rel="nofollow">GPIO是什么</a></li><li><a href="#GPIO_27" rel="nofollow">GPIO的八大模式</a></li><li><ul><li><a href="#_30" rel="nofollow">输入模式</a></li><li><ul><li><a href="#_39" rel="nofollow">浮空输入</a></li><li><a href="#_54" rel="nofollow">上拉输入</a></li><li><a href="#_65" rel="nofollow">下拉输入</a></li><li><a href="#_75" rel="nofollow">模拟输入</a></li></ul> 
   </li><li><a href="#_83" rel="nofollow">输出模式</a></li><li><ul><li><a href="#_92" rel="nofollow">开漏输出</a></li><li><a href="#_109" rel="nofollow">推挽输出</a></li><li><a href="#_119" rel="nofollow">复用开漏输出</a></li><li><a href="#_123" rel="nofollow">复用推挽输出</a></li></ul> 
  </li></ul> 
  </li><li><a href="#GPIO_127" rel="nofollow">GPIO的输出速率</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_3"></a>前言</h2> 
<p>学习了这么久的单片机，说来羞愧，直到写这篇文章之前，我都没有仔细去理解GPIO的八种使用模式，之前只是傻傻的用着，直到把模电，数电学完，到今天重新回顾了一遍这一个知识，发现自己终于看懂了之前没有理解透彻的知识，特此总结下来。</p> 
<h2><a id="GPIO_6"></a>GPIO是什么</h2> 
<p>从最基础的51单片机，Arduino，到STM32，树莓派等等，这些上面都会有GPIO口这么一个概念，如果你点开了我这个博客，说明你大概率开始学习单片机，那么你应该了解的就是这些口可以输出高低电平，或者是读取引脚上的输入电平。<br> GPIO的总述功能如下</p> 
<blockquote> 
 <p>GPIO(general porpose intputoutput):通用输入输出端口的简称。可以通过软件控制其输出和输入。stm32芯片的GPIO引脚与外部设备连接起来，从而实现与外部通信，控制以及数据采集的功能。<br> ———GPIO简介</p> 
</blockquote> 
<p>下面摆一张以STM32内部GPIO口为例的内部原理图，大伙也不要着急，先有一个这个图的概念，下面就是开始讲怎么理解GPIO口。</p> 
<p><img src="https://images2.imgbox.com/04/39/Mw5AOlr8_o.png" alt="在这里插入图片描述"></p> 
<p>先来一点最基础的知识<br> <strong>上拉和下拉：</strong><br> 当我们闭合上拉电阻的开关，断开下拉电阻的开关的时候，也就是此时为上拉通路导通。根据我们最基础的电路知识，如果I/O口断开不接外设，或者接了外设但是电路也断开，此时整条回路是断路的时候，电阻相当于不存在，此时O点的电位，也就被钳制在了VDD(供电电压正极)，于是O点就处于高电平。<br> 同理，闭合上拉电阻的开关，断开下拉电阻的开关，那么在电路断开的时候，根据电路知识，电阻相当于不存在，O点的电压就就被钳制**在了VSS(GND)，也就是O点处于低电平。</p> 
<p><strong>数字信号和模拟信号：</strong><br> 数字信号：就是根据一些规则，将一个范围内的电压规定为1，一个范围内的电压规定为0，也就是一连串的0,1信号<br> 模拟信号：就是连续的读取到的电压值。<br> 关于图上的TTL施密特触发器和P-MOS和N-MOS，后面讲到对应部分的时候会讲到。</p> 
<h2><a id="GPIO_27"></a>GPIO的八大模式</h2> 
<p>GPIO可以分为输入或者输出，加起来一共有八种模式。</p> 
<h3><a id="_30"></a>输入模式</h3> 
<p>在输入模式下，一共有四种输出模式，分别是</p> 
<ul><li>模拟输入</li><li>上拉输入</li><li>下拉输入</li><li>浮空输入</li></ul> 
<h4><a id="_39"></a>浮空输入</h4> 
<p><img src="https://images2.imgbox.com/f8/60/9mvAFONA_o.png" alt="在这里插入图片描述"></p> 
<p>浮空输入需要走的路径如图所示。首先得知道，浮空输出走的这一条路径，是对一个数字信号的读取。<br> 需要的电路如下：<br> VDD和VSS所在路径的两个开关同时断开。此时没有上拉和下拉的情况，所以当IO口没有接输入的时候，此时的电平会是一个不确定的值，也就是我们所说的浮空。电平会处于一个跳变的状态，一会高，一会低。只有输入了一个高/低电平才会确定下来。<br> <strong>注意：</strong> 上拉和下拉电阻电路的开关在实际应用中一般使用MOS管来代替开关来提到。</p> 
<p>再往前面走，就是走到了TTL施密特触发器这一个部分。我们知道，由于电源的特性，或者是由于外部开关输入的特性，输入的数字信号，极有可能会出现脉冲等噪声的影响，为了让我们的波形更好看，或者信号更加清晰，所以就设置了TTL施密特触发器这个东西。经过之后，我们就会把这个数字信息存储在输入数据寄存器中。<br> 这样我们就读到了IO过来的数字信号</p> 
<p><strong>优势：</strong> 这一种输入模式的电平会完全取决于外部电路而与内部电路无关。有时候会用作对开关按键的读取。</p> 
<p>但是在没有外部电路接入的时候，IO脚浮空会使得电平不确定</p> 
<h4><a id="_54"></a>上拉输入</h4> 
<p><img src="https://images2.imgbox.com/8f/df/wd32KHWP_o.png" alt="在这里插入图片描述"></p> 
<p>上拉输入需要走的路径如图所示。首先得知道，上拉输出走的这一条路径，是对一个数字信号的读取。<br> 需要的电路如下:<br> VDD所在上拉电阻开关闭合，下拉电阻的开关断开。<br> 根据前面浮空输入里面所提的，在没有信号输入的时候，根据电路知识，此时的电平就是VDD的电平，此时读取到的电平就是高电平。如果输入了一个高电平，VDD和O点(最上面的图中的O点)之间就几乎没有电势差，此时O点的电平就仍然是高电平，读取到的电平就是高电平。但是由于在没有电压输入的时候，电平也是高电平，所以这一种输入情况下是没有办法确定信号是否输入了。<br> 当输入信号是一个低电平的时候，此时O点的电平的电平就会变成低电平，那么VDD和O点之间形成了电势差，但是因为上拉电阻的存在，所以不会出现一个大电流。此时单片机读取到的一个电平就是一个低电平。在上拉输入的情况下，低电平的是能够非常明显的读取到的。<br> 上拉输入的好处就是输入的电平不会上下浮动而导致输入信号不稳定，在没有信号输入的情况下可以稳定在高电平。</p> 
<h4><a id="_65"></a>下拉输入</h4> 
<p><img src="https://images2.imgbox.com/df/63/aEYl112n_o.png" alt="在这里插入图片描述"></p> 
<p>下拉输入需要走的路径如图所示。首先得知道，下拉输出走的这一条路径，是对一个数字信号的读取。<br> 需要的电路如下:<br> VDD所在上拉电阻开关断开，下拉电阻的开关闭合。<br> 根据前面浮空输入里面所提的，在没有信号输入的时候，根据电路知识，电平就是VSS的电平，此时读取到的电平就是低电平。此时输入的电平如果是一个低电平，就没有办法和之前的情况进行区分。但如果输入的是一个高电平，O点和VSS之间同样形成了电势差，O点的电平会变成外部的高电平，那么单片机得到的就是一个高电平信号。<br> 下拉输入的好处就是输入的电平不会上下浮动而导致输入信号不稳定，在没有信号输入的情况下可以稳定在低电平。</p> 
<h4><a id="_75"></a>模拟输入</h4> 
<p><img src="https://images2.imgbox.com/5b/11/mfcyKGMY_o.png" alt="在这里插入图片描述"></p> 
<p>模拟输入需要走的路径如图所示。首先得知道，模拟输出走的这一条路径，是我们需要对一个模拟信号进行读取。<br> 在我们使用单片机的时候，我们有时候需要用AD采集到IO口上面的真实电压。这就有了我们所需要的模拟输入。为了让外部的电压真实的读取到单片机的AD模块，我们既不能闭合上拉和下拉的开关，也不能让信号经过施密特触发器。</p> 
<p>优势：可以让AD读取电压。还可以在低功耗模式下运行，实现省电的作用。</p> 
<h3><a id="_83"></a>输出模式</h3> 
<p>在输出模式下，同样也有四种输出模式，分别是</p> 
<p>开漏输出<br> 推挽输出<br> 复用开漏输出<br> 复用推挽输出</p> 
<h4><a id="_92"></a>开漏输出</h4> 
<p><img src="https://images2.imgbox.com/a4/29/aQcfQF8U_o.png" alt="在这里插入图片描述"></p> 
<p>④⑤⑥⑦是读取的过程，此处不管。<br> 开漏输出的电路路径是①②③④，②前面的步骤就是一个对输出信号的控制，不是重点，开漏输出里面最重要的是③，也就是N-MOS这一部分，下面来补充一下模电知识。</p> 
<p><img src="https://images2.imgbox.com/69/07/hDvCsBbn_o.png" alt="在这里插入图片描述"><br> 我们可以把这一个MOS管当成一个三极管，对于图中所示的这种三极管我们可以简单的理解成一个水龙头，左侧就是一个水龙头开关，当给一个高电平的时候， O点和GND就会导通。（O点的输出就是一种反向器的输出，也就是O点的电平会和左侧MOS的栅极(三极管的基极)相反）<br> 所以说，开漏输出就很好理解了。当我们给一个低电平的时候，MOS管关闭，此时输出的电压就是一个浮空，即不确定的电压。如果给一个高电平，那么MOS管导通，相当于IO口与VSS相连，此处就输出了一个低电平电压。<br> <strong>优势①</strong><br> 虽然我们可以看到开漏输出是没有办法在内部输出一个高电平，但是这一个看似是缺点。其实实际上是一种优点。我们可以得到，当给一个低电平的时候，MOS管没有导通，此时电压不确定导致无法输出高电平，但是一旦我们在外部增加一个上拉，那么这一个缺点就会被有效避免。并且，因为是我们自己设计一个上拉，这个上拉的电压是由我们自己确定，<strong>这样我们就可以根据外部电路需要多少V的高电平来给这一个上拉的电压，可以更好的适应更多情况。</strong> 如下图，我们可以给定任意的VDD电压，来适应我们实际所需要的情况。</p> 
<p><img src="https://images2.imgbox.com/45/1a/lNFAnV99_o.png" alt="在这里插入图片描述"></p> 
<p>优势②<br> 开漏输出的实质其实就是一个OD门（OD：漏极输出(Open Drain)）。而在数电中，OD门有一个非常重要的特性就是可以实现线与的功能，简单来说，就是在像IIC这样的总线协议中，只要有一个给低电平，那么总线都会被拉低。</p> 
<h4><a id="_109"></a>推挽输出</h4> 
<p><img src="https://images2.imgbox.com/f6/17/OLp485yH_o.png" alt="在这里插入图片描述"></p> 
<p>推挽输出就是可以需要利用两个不同的MOS管来实现输出。<br> P-MOS和N-MOS是不同的控制方式，当给一个高电平的时候，N-MOS导通，P-MOS不导通，此时IO口接通在VSS，此时输出的是低电平。当给一个低电平的时候，P-MOS导通，N-MOS导通，此时IO口接通在VDD电源上面，此时输出的是高电平。<br> <strong>一定要把这个MOS管理解成开关控制的水龙头！！！</strong><br> <strong>优势</strong><br> 带载能力强。</p> 
<h4><a id="_119"></a>复用开漏输出</h4> 
<p><strong>复用推挽和复用开漏其实很简单，在你理解了开漏和推挽的原理之后，如果你不想用单片机内部来输出，那么你可以进行复用，将输出转移到其他外设上面</strong></p> 
<h4><a id="_123"></a>复用推挽输出</h4> 
<p><img src="https://images2.imgbox.com/61/ed/bh7Go7hA_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="GPIO_127"></a>GPIO的输出速率</h2> 
<p><img src="https://images2.imgbox.com/ac/f6/yobVKliE_o.png" alt="在这里插入图片描述"></p> 
<p>————————————————<br> 版权声明：本文为CSDN博主「暮尘依旧」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br> 原文链接：https://blog.csdn.net/scarecrow_sun/article/details/120287852</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/005604ab4a55735b72ca60ab3048c01a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Android 逆向】Android 中常用的 so 动态库 ( /system/lib/libc.so 动态库 | libc&#43;&#43;.so 动态库 | libstdc&#43;&#43;.so 动态库 )</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/052b4c9af05fe7f812c197caaf4f38b9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">自媒体人员不可或缺的技能：在线修图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>