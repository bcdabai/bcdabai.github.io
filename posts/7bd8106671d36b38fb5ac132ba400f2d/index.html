<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>将QT开发的界面程序封装成DLL，在VC中成功调用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="将QT开发的界面程序封装成DLL，在VC中成功调用" />
<meta property="og:description" content=" 最近手头的一个项目需要做一个QT界面，并且封装成DLL，然后再动态调用DLL给出的接口函数，使封装在DLL内部的QT界面跑起来，在网上查了很多资料，今天终于成功了，经验不敢独享，因为CSDN给了我很多帮助，将心得写在这里供大家参考。 PS:本文中谈的是用QT封装一个包含界面的DLL，然后在其他任何地方使用任何语言来调用这个DLL，不是那种在qt creator里面建一个dll工程，然后再在qt creator里建一个调用该dll的工程的情况（这种示例可参考该链接http://download.csdn.net/source/2855817）。 本文所讲的例子在qt 4.7.3 opensource 以及VC6.0/VS2005成功运行 首先，在qt creator中是可以直接建立一个C&#43;&#43; DLL工程的，编译以后也可以生成dll，但是这样生成的dll拿VC去调是不会成功的。后来在CSDN上看到有人发的这样一篇帖子（原文链接http://blog.csdn.net/normallife/article/details/5397980）。里面谈到 “因为 QT 必须有调用 QApplication 的 exec 方法，这样才能产生消息循环， QT 的程序才可以运行。所以说如果我们使用了 QT 编写了 dll 程序，在普通的 windows 程序中是不能调用的。在调用的时候会出现错误。当然 QT 提供了解决方法：那就是 QTWinmigrate”。喜出望外啊，赶紧的把QTWinmigrate下下来。 打开QTWinmigrate文件夹，里面有几个目录，buildlib,doc,examples,lib,src。 在examples目录下给出几个应用QTWinmigrate的例子，其中有一个就是qtdll,嘿嘿，用qt creator打开其中的qtdll.pro工程文件。因为这个是已经做好的程序，所以可以直接在此基础上修改。右键单击 目录树最上层的工程名qtdll，选择“添加新有文件”，然后新建一个“QT设计师界面类”，类名什么的自己填上，点确定返回，可以看到后缀为.ui的界面文件及界面文件的.h文件和.cpp文件已经加入到qtdll工程里面了，界面你怎么画都行，剩下的步骤就是修改工程中的main.cpp文件 首先在main.cpp文件里面把界面文件的头文件include进来，然后将DLL发布接口函数的部分修改为如下所示： extern &#34;C&#34; __declspec(dllexport) int main(int argc, char *argv[]) { QApplication a(argc, argv); ****** w; w.show(); return a.exec(); } 其中******是你界面文件的.h文件中定义的界面类名 这样我们得DLL就做好了，然后点构建，就可以生成封装了QT界面并且可以用VC调用的DLL了 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7bd8106671d36b38fb5ac132ba400f2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-09-06T16:38:36+08:00" />
<meta property="article:modified_time" content="2014-09-06T16:38:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">将QT开发的界面程序封装成DLL，在VC中成功调用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">最近手头的一个项目需要做一个QT界面，并且封装成DLL，然后再动态调用DLL给出的接口函数，使封装在DLL内部的QT界面跑起来，在网上查了很多资料，今天终于成功了，经验不敢独享，因为CSDN给了我很多帮助，将心得写在这里供大家参考。</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    PS:本文中谈的是用QT封装一个包含界面的DLL，然后在其他任何地方使用任何语言来调用这个DLL，不是那种在qt creator里面建一个dll工程，然后再在qt creator里建一个调用该dll的工程的情况（这种示例可参考该链接http://download.csdn.net/source/2855817）。</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">本文所讲的例子在qt 4.7.3 opensource 以及VC6.0/VS2005成功运行</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">     首先，在qt creator中是可以直接建立一个C++ DLL工程的，编译以后也可以生成dll，但是这样生成的dll拿VC去调是不会成功的。后来在CSDN上看到有人发的这样一篇帖子（原文链接http://blog.csdn.net/normallife/article/details/5397980）。里面谈到  “因为 QT 必须有调用 QApplication 的 exec 方法，这样才能产生消息循环， QT 的程序才可以运行。所以说如果我们使用了 QT 编写了 dll 程序，在普通的 windows 程序中是不能调用的。在调用的时候会出现错误。当然 QT 提供了解决方法：那就是 QTWinmigrate”。喜出望外啊，赶紧的把QTWinmigrate下下来。</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">   打开QTWinmigrate文件夹，里面有几个目录，buildlib,doc,examples,lib,src。</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">   在examples目录下给出几个应用QTWinmigrate的例子，其中有一个就是qtdll,嘿嘿，用qt creator打开其中的qtdll.pro工程文件。因为这个是已经做好的程序，所以可以直接在此基础上修改。右键单击</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">目录树最上层的工程名qtdll，选择“添加新有文件”，然后新建一个“QT设计师界面类”，类名什么的自己填上，点确定返回，可以看到后缀为.ui的界面文件及界面文件的.h文件和.cpp文件已经加入到qtdll工程里面了，界面你怎么画都行，剩下的步骤就是修改工程中的main.cpp文件</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">   首先在main.cpp文件里面把界面文件的头文件include进来，然后将DLL发布接口函数的部分修改为如下所示：</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">   extern "C" __declspec(dllexport) int main(int argc, char *argv[])</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">{<!-- --></span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    QApplication a(argc, argv);</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    ****** w;</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    w.show();</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    return a.exec();</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">}</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    其中******是你界面文件的.h文件中定义的界面类名</span> 
<br style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)"> 
<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:14px; line-height:24px; background-color:rgb(245,245,245)">    这样我们得DLL就做好了，然后点构建，就可以生成封装了QT界面并且可以用VC调用的DLL了</span>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0df504f18bfea4a6f15116b4cc10f572/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">详解 Qt 下 QLibrary 动态加载 dll (Fortran)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e2a2d538d5bf95f737b3491327eb92f2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">软件设计师之路 --------UML类图符号，各关系说明</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>