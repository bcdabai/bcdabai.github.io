<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C&#43;&#43;】-8.2- string〔string类模拟实现〕 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【C&#43;&#43;】-8.2- string〔string类模拟实现〕" />
<meta property="og:description" content="文章目录 //模拟实现string类，并完成测试• string类的基本结构• Destructor• Construct〔构造函数〕‹ 无参构造 ›‹ 单参数构造 ›‹ 全缺省参数构造 › 〔拷贝构造〕 • operator= 赋值重载• Element access（operator[]）补充：const 变量的场景• Iterator• Relational Operators（比较大小）• Capacity〔size〕&amp;〔capacity〕&amp;〔empty〕〔reserve〕〔resize〕 • Modify〔push_back〕&amp;〔append〕〔&#43;=〕〔swap〕〔clear〕&amp; 〔c_str〕 • 「insert」在 pos 位置插入字符或字符串• 「erase」从 pos 位置删除 len 个字符注：npos的声明和定义• 「find」• 「流插入&lt;&lt;、流提取&gt;&gt;」‹ 流插入 ›‹ 流提取 › //模拟实现string类，并完成测试 头文件声明：
//anolog_string.h #pragma once #include &lt;iostream&gt; namespace RoundBottle//与库里面的string类做区分 { class string { public: typedef char* iterator; typedef const char* const_iterator; //全缺省构造 string(const char* str = &#34;&#34;); //拷贝构造 string(const string&amp; s); //赋值重载是关于两个已经存在的对象 string&amp; operator=(const string&amp; s); ~string(); / // access char&amp; operator[](size_t index); const char&amp; operator[](size_t index)const; // // iterator iterator begin(); iterator end(); const_iterator begin()const; const_iterator end()const; / // modify void push_back(char c); string&amp; operator&#43;=(char c); void append(const char* str); string&amp; operator&#43;=(const char* str); void clear(); void swap(string&amp; s); const char* c_str()const; / // capacity size_t size()const; size_t capacity()const; bool empty()const; void resize(size_t n, char c = &#39;\0&#39;); void reserve(size_t n); / //relational operators bool operator&lt;(const string&amp; s); bool operator&lt;=(const string&amp; s); bool operator&gt;(const string&amp; s); bool operator&gt;=(const string&amp; s); bool operator==(const string&amp; s); bool operator!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4371f6ba24669b75087ad288dfbf2143/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-21T17:38:17+08:00" />
<meta property="article:modified_time" content="2023-06-21T17:38:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C&#43;&#43;】-8.2- string〔string类模拟实现〕</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#string_2" rel="nofollow">//模拟实现string类，并完成测试</a></li><li><a href="#_string_121" rel="nofollow">• string类的基本结构</a></li><li><a href="#_Destructor_131" rel="nofollow">• Destructor</a></li><li><a href="#_Construct_142" rel="nofollow">• Construct</a></li><li><ul><li><a href="#_143" rel="nofollow">〔构造函数〕</a></li><li><ul><li><a href="#___144" rel="nofollow">‹ 无参构造 ›</a></li><li><a href="#___185" rel="nofollow">‹ 单参数构造 ›</a></li><li><a href="#___211" rel="nofollow">‹ 全缺省参数构造 ›</a></li></ul> 
   </li><li><a href="#_227" rel="nofollow">〔拷贝构造〕</a></li></ul> 
  </li><li><a href="#_operator__240" rel="nofollow">• operator= 赋值重载</a></li><li><a href="#_Element_accessoperator_272" rel="nofollow">• Element access（operator[]）</a></li><li><a href="#const__286" rel="nofollow">补充：const 变量的场景</a></li><li><a href="#_Iterator_309" rel="nofollow">• Iterator</a></li><li><a href="#_Relational_Operators_364" rel="nofollow">• Relational Operators（比较大小）</a></li><li><a href="#_Capacity_393" rel="nofollow">• Capacity</a></li><li><ul><li><a href="#sizecapacityempty_394" rel="nofollow">〔size〕&amp;〔capacity〕&amp;〔empty〕</a></li><li><a href="#reserve_410" rel="nofollow">〔reserve〕</a></li><li><a href="#resize_433" rel="nofollow">〔resize〕</a></li></ul> 
  </li><li><a href="#_Modify_463" rel="nofollow">• Modify</a></li><li><ul><li><a href="#push_backappend_464" rel="nofollow">〔push_back〕&amp;〔append〕</a></li><li><a href="#_497" rel="nofollow">〔+=〕</a></li><li><a href="#swap_515" rel="nofollow">〔swap〕</a></li><li><a href="#clear_c_str_538" rel="nofollow">〔clear〕&amp; 〔c_str〕</a></li></ul> 
  </li><li><a href="#_insert_pos__553" rel="nofollow">• 「insert」在 pos 位置插入字符或字符串</a></li><li><a href="#_erase_pos__len__610" rel="nofollow">• 「erase」从 pos 位置删除 len 个字符</a></li><li><a href="#npos_637" rel="nofollow">注：npos的声明和定义</a></li><li><a href="#_find_662" rel="nofollow">• 「find」</a></li><li><a href="#__695" rel="nofollow">• 「流插入&lt;&lt;、流提取&gt;&gt;」</a></li><li><ul><li><a href="#___697" rel="nofollow">‹ 流插入 ›</a></li><li><a href="#___710" rel="nofollow">‹ 流提取 ›</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="string_2"></a>//模拟实现string类，并完成测试</h2> 
<p>头文件声明：</p> 
<pre><code class="prism language-cpp"><span class="token comment">//anolog_string.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">namespace</span> RoundBottle<span class="token comment">//与库里面的string类做区分</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">class</span> <span class="token class-name">string</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token keyword">typedef</span> <span class="token keyword">char</span><span class="token operator">*</span> iterator<span class="token punctuation">;</span>
		<span class="token keyword">typedef</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> const_iterator<span class="token punctuation">;</span>

		<span class="token comment">//全缺省构造</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//拷贝构造</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//赋值重载是关于两个已经存在的对象</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">/</span>

		<span class="token comment">// access</span>
		<span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>

		<span class="token comment">//</span>

		<span class="token comment">// iterator</span>
		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>
		const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>

		<span class="token comment">/</span>

		<span class="token comment">// modify</span>
		<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>

		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>

		<span class="token comment">/</span>

		<span class="token comment">// capacity</span>
		size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>
		size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">/</span>

		<span class="token comment">//relational operators</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 返回c在string中第一次出现的位置</span>
		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

		<span class="token comment">// 返回子串s在string中第一次出现的位置</span>
		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

		<span class="token comment">// 在pos位置上插入字符c/字符串str，并返回该字符的位置</span>
		string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 删除pos位置上的元素，并返回该元素的下一个位置</span>
		string<span class="token operator">&amp;</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span><span class="token operator">:</span>
		<span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>
		size_t _capacity<span class="token punctuation">;</span>
		size_t _size<span class="token punctuation">;</span>
		<span class="token keyword">static</span> size_t npos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	size_t string<span class="token double-colon punctuation">::</span>npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

	std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> _cout<span class="token punctuation">,</span> <span class="token keyword">const</span> RoundBottle<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> _cin<span class="token punctuation">,</span> RoundBottle<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//测试</span>
	<span class="token keyword">void</span> <span class="token function">string_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//test.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"analog_string.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">try</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token class-name">RoundBottle</span><span class="token double-colon punctuation">::</span><span class="token function">string_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>exception<span class="token operator">&amp;</span> e<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_string_121"></a>• string类的基本结构</h2> 
<pre><code class="prism language-cpp"><span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>
	size_t _capacity<span class="token punctuation">;</span>
	size_t _size<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5d/39/eAuuU1Py_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_Destructor_131"></a>• Destructor</h2> 
<pre><code class="prism language-cpp"><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span>
	_str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	_size <span class="token operator">=</span> _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_Construct_142"></a>• Construct</h2> 
<h3><a id="_143"></a>〔构造函数〕</h3> 
<h4><a id="___144"></a>‹ 无参构造 ›</h4> 
<ul><li><strong>方式一</strong>：<code>_str 置空指针</code></li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//全缺省构造</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_capacity</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<p>//cout 自动识别类型，<em>对于指针，会进行解引用！</em><br> <br> <code>cout &lt;&lt; s.c_str() &lt;&lt;endl;</code> 👉 s.c_str()成员函数 会返回对象 s 中的成员变量 _str，若 _str==nullptr 则 <strong>cout 会对空指针进行解引用！</strong></p> 
<ul><li><strong>方式二</strong>：给_str所指向的空间开新空间——<code>new char</code></li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//全缺省构造</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_capacity</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<p>//析构函数执行的语句是：<strong><mark>delete []</mark> _str;</strong> 与 new 不匹配（关于new和delete详见文章<a href="http://t.csdn.cn/oimr5" rel="nofollow">C++ -5- 内存管理</a>）</p> 
<ul><li><strong>方式三</strong>：<code>_str = new char [1]</code></li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//全缺省构造</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">char</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_capacity</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="___185"></a>‹ 单参数构造 ›</h4> 
<ul><li>方式一：直接赋值</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//全缺省构造</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_str</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token comment">//权限放大</span>
	<span class="token punctuation">,</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_capacity</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<p>将 str 中的地址赋值给 _str 很明显是权限放大，如下图：<br> <img src="https://images2.imgbox.com/b5/8a/AxT8n6cz_o.png" alt="在这里插入图片描述"></p> 
<ul><li>方式二：</li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//全缺省构造</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>
	_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>关于 capacity： 
  <ul><li>能存多少个<strong>有效数据</strong>（不包括’\0’）→ 所以开空间要多开一个留给’\0’</li><li>尽量不要再初始化列表里面用 size 来初始化 capacity，因为初始化的顺序是变量声明的顺序，变量声明顺序更改会影响初始化的结果。</li></ul> </li></ul> 
<h4><a id="___211"></a>‹ 全缺省参数构造 ›</h4> 
<p>无参构造和单参数构造可以合成一个全缺省参数构造</p> 
<pre><code class="prism language-cpp"><span class="token comment">//全缺省构造</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_size</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>
	_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li><code>""</code> 常量字符串默认以 ‘\0’ 结束 （字符串为不为空都是如此）</li><li><code>const char* str = '\0'</code> 不可以！ ‘\0’ 只是一个 char 类型的字符，将 char 类型的数据赋值给 const char* 类型不匹配，会发生<strong>类型转换，char 类型转化为 int 类型</strong>，类型仍然不匹配，则 str 会被赋值为<strong>空指针</strong>。</li><li><code>“\0”</code>才是一个常量字符串</li><li><code>const char* str = ""</code> == <code>const char* str = "\0"</code></li></ul> 
<h3><a id="_227"></a>〔拷贝构造〕</h3> 
<p>开新空间 + 拷贝数据</p> 
<pre><code class="prism language-cpp"><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
	_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="_operator__240"></a>• operator= 赋值重载</h2> 
<ul><li><strong><code>delete</code> 原空间</strong> 
  <ul><li>自己赋值给自己（ s = s ）？<strong>自己给自己 delete 之后就什么都没了</strong>~，所以如果是自己给自己赋值，这里需要判断一下，什么也不执行就行了。</li></ul> </li><li><strong><code>new</code> 新空间</strong> 
  <ul><li>为了防止开空间失败，这个可以先创建临时变量</li></ul> </li><li><code>strcpy</code> 内容到新空间</li><li>修改 <code>size</code> 和 <code>capacity</code></li></ul> 
<p>❗❗赋值重载是关于两个<strong>已经存在</strong>的对象</p> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//防止开空间失败</span>
		<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//</span>

		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span><span class="token comment">//销毁原空间</span>
		_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span><span class="token comment">//拷贝数据</span>
		_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="_Element_accessoperator_272"></a>• Element access（operator[]）</h2> 
<pre><code class="prism language-cpp"><span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> _str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> _str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="const__286"></a>补充：const 变量的场景</h2> 
<blockquote> 
 <p><strong>const 变量不可以调用非 const 成员函数</strong>，不修改成员函数变量数据的函数最好都加 const<br> 例如如下代码：参数为 const string 类型</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t index<span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> _str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token comment">//size()</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token comment">//[]操作符重载</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_Iterator_309"></a>• Iterator</h2> 
<p>这里用指针来模拟实现迭代器，但库中的迭代器不一定都是用指针实现的。<br> <br> 另外，begin() 和 end() 遵循 <strong>“左闭右开”</strong> 的原则。<br> <img src="https://images2.imgbox.com/7f/d2/emXFnaLl_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">char</span><span class="token operator">*</span> iterator<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> const_iterator<span class="token punctuation">;</span>

<span class="token comment">// iterator</span>
iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>实现了迭代器之后，范围for也可以用。</p> 
<p>应用示例：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">string_test6</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	string <span class="token function">s</span><span class="token punctuation">(</span><span class="token string">"abcdefghijklm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	string<span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>	
		cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
		<span class="token operator">++</span>it<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> e <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="_Relational_Operators_364"></a>• Relational Operators（比较大小）</h2> 
<p>比较ASCII码值的大小，复用 <code>strcmp</code></p> 
<pre><code class="prism language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">==</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="_Capacity_393"></a>• Capacity</h2> 
<h3><a id="sizecapacityempty_394"></a>〔size〕&amp;〔capacity〕&amp;〔empty〕</h3> 
<pre><code class="prism language-cpp">size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="reserve_410"></a>〔reserve〕</h3> 
<ul><li>reverse 是管理容量的函数</li><li><strong>不缩容</strong>原则，如果要更改的容量大小小于原容量大小则不执行操作</li><li>实现思路： 
  <ul><li>按指定容量大小<strong>开新空间</strong>（永远多开一个位置给’\0’）</li><li><strong>拷贝数据</strong>到新空间</li><li><strong>释放</strong>原空间</li><li>新空间地址赋值给 _str</li><li>修改容量大小</li></ul> </li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span>
		_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="resize_433"></a>〔resize〕</h3> 
<ul><li>resize ：开空间（size_t n） + 初始化（char c）</li><li><code>if (n &lt;= _size)</code> 容量不缩，只保留前 n 个数据</li><li><code>if (n &gt; _capacity)</code> 扩容</li><li>ps. size &gt;= capacity</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">int</span> cout <span class="token operator">=</span> n <span class="token operator">-</span> _size<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>cout<span class="token operator">--</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
			<span class="token operator">++</span>_size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="_Modify_463"></a>• Modify</h2> 
<h3><a id="push_backappend_464"></a>〔push_back〕&amp;〔append〕</h3> 
<p>插入数据就要考虑容量问题，势必要进行扩容，由于原本的空间就是 new 出来的，扩容肯定不能用 realloc 直接扩容，所以最终我们选择手动扩容 → 调用 reserve 函数<br> <img src="https://images2.imgbox.com/fc/aa/7h1HdscH_o.png" alt="在这里插入图片描述"><br> 整体思路：</p> 
<ul><li>检查容量</li><li>插入数据</li><li>修改 _size</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//扩容</span>
		<span class="token keyword">int</span> new_capacity <span class="token operator">=</span> _capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">7</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>new_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>_size <span class="token operator">+</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h3><a id="_497"></a>〔+=〕</h3> 
<p>复用 push_back 和 append</p> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">push_back</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="swap_515"></a>〔swap〕</h3> 
<p>可以复用 std 库里的 swap 函数</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">/*char* ptmp = _str;
	_str = s._str;
	s._str = _str;

	char size = _size;
	_size = s._size;
	s._size = _size;

	char capacity = _capacity;
	_capacity = s._capacity;
	s._capacity = _capacity;*/</span>

	std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="clear_c_str_538"></a>〔clear〕&amp; 〔c_str〕</h3> 
<p>clear ：清空数据</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_insert_pos__553"></a>• 「insert」在 pos 位置插入字符或字符串</h2> 
<blockquote> 
 <p>插入字符就相当于插入只有单个字符的字符串，所以这里详细分析插入字符串时的情况，插入字符的思路与之类似。</p> 
</blockquote> 
<p>基本思路：①检查容量；②挪动数据（strncpy）；③插入数据。（注意检查 pos 位置的有效性）</p> 
<p>如下图，在 pos 位置插入长度为 len 的字符串：则我们需要把 <strong>红色区域 的数据</strong>往后<strong>挪动 len个单位长度</strong>，再将要插入的数据从原 pos 位置往后依此插入。<br> <img src="https://images2.imgbox.com/85/27/nlEryLfA_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>可以选择 index 从 size 位置开始吗？？👉不可以</strong><br> 当 pos == 0 时情况如下：<br> <img src="https://images2.imgbox.com/1d/f7/zJx3DarE_o.png" alt="在这里插入图片描述"><br> ①<code>size_t index</code> 是<strong>无符号整型，-1即为整型的最大值</strong>，以 index &gt;= pos 作为循环判断条件，在 pos ==0 的情况下将进入死循环；<br> ②若声明 <code>int index</code>，仍以 index &gt;= pos 作为循环判断条件，&gt;=<strong>操作符左右变量的类型不同，会发生类型转换</strong>，通常是比较范围小的向范围大的转换，即在该情况下，有符号整型一般转化为无符号整型。</li></ul> 
<p>简单说明一下strnpy函数：strncpy( dst-copy到哪 , scr-从哪copy , 从scr copy 多少个)</p> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span><span class="token comment">//扩容</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> new_capacity <span class="token operator">=</span> _capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">7</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>new_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t index <span class="token operator">=</span> _size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> index <span class="token operator">&gt;=</span> pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">--</span>index<span class="token punctuation">)</span><span class="token comment">//挪动数据</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string<span class="token operator">&amp;</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pos <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span><span class="token comment">//扩容</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> new_capacity <span class="token operator">=</span> _size <span class="token operator">+</span> len<span class="token punctuation">;</span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>new_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> _size <span class="token operator">+</span> len<span class="token punctuation">;</span> index <span class="token operator">&gt;=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span> <span class="token operator">--</span>index<span class="token punctuation">)</span><span class="token comment">//挪动数据</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>index <span class="token operator">-</span> len<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">strncpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="_erase_pos__len__610"></a>• 「erase」从 pos 位置删除 len 个字符</h2> 
<ol><li>pos 往后还有 &gt;= len 个长度的字符：挪动覆盖数据（memmove/strcpy）</li><li>pos 往后不足 len 个长度的字符：从 pos 往后全部删除（包括 pos 位置的数据）</li></ol> 
<p>注意：<code>pos + len &gt;= _size || len == npos</code> len == npos必须单独判断，npos 已经是整型的最大值。</p> 
<pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pos <span class="token operator">+</span> len <span class="token operator">&gt;=</span> _size <span class="token operator">||</span> len <span class="token operator">==</span> npos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t index <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span> index <span class="token operator">&lt;=</span> _size<span class="token punctuation">;</span> <span class="token operator">++</span>index<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>index <span class="token operator">-</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//strcpy(_str+pos,_str+pos+len)</span>
		_size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="npos_637"></a>注：npos的声明和定义</h2> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">string</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		<span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>
		size_t _capacity<span class="token punctuation">;</span>
		size_t _size<span class="token punctuation">;</span>
		<span class="token keyword">static</span> size_t npos<span class="token punctuation">;</span>
		<span class="token comment">//static size_t npos = -1;error</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
size_t string<span class="token double-colon punctuation">::</span>npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>静态成员变量：类内声明，类外定义。</strong><br> （ps. C++中加 const 的静态成员变量可以给缺省值，但是只针对整型变量）（最好不要这么用）</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">string</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		<span class="token keyword">const</span> <span class="token keyword">static</span> size_t npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<h2><a id="_find_662"></a>• 「find」</h2> 
<ul><li>找字符：找到就返回该字符下标，没有找到返回 npos</li><li>找字串：strstr函数暴力匹配 
  <ul><li>为 nullptr 即没找到</li><li>找到返回子串第一个字符的地址 👉 <strong>地址 - 地址 = 下标</strong></li></ul> </li></ul> 
<pre><code class="prism language-cpp"><span class="token comment">//找字符c</span>
size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> c<span class="token punctuation">)</span>
			<span class="token keyword">return</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//找字串s</span>
size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">char</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="__695"></a>• 「流插入&lt;&lt;、流提取&gt;&gt;」</h2> 
<p>肯定不能写成成员函数，可以用友元函数，但也不一定要写成友元函数。</p> 
<h3><a id="___697"></a>‹ 流插入 ›</h3> 
<ul><li>流插入重载要<strong>根据 size 打印</strong>，即使字符串间夹杂着 ‘\0’</li><li>不能直接访问成员变量，可以<strong>通过成员函数间接访问</strong>。（ iterator / 范围for / [下标] ）</li></ul> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> _cout<span class="token punctuation">,</span> <span class="token keyword">const</span> RoundBottle<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> _cout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="___710"></a>‹ 流提取 ›</h3> 
<p>cin 和 scanf 对于空格和换行不识别 👉 采用 <strong>istream 的成员函数</strong> <code>get() </code></p> 
<p>优化：不断输入字符会导致频繁的扩容，这里可以用一个临时数组储存输入字符，临时数组每满一次就追加到 string s 中，知道输入结束后，将临时数组里剩下的字符再追加到 string s 中。</p> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>istream<span class="token operator">&amp;</span> _cin<span class="token punctuation">,</span> RoundBottle<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	s<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> tmp<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> c <span class="token operator">=</span> _cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token char">'\0'</span> <span class="token operator">&amp;&amp;</span> c <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		tmp<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>
		<span class="token operator">++</span>index<span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">127</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			tmp<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			s <span class="token operator">+=</span> tmp<span class="token punctuation">;</span>
			index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		c <span class="token operator">=</span> _cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		tmp<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
		s <span class="token operator">+=</span> tmp<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> _cin<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<p>END</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f3c077b779a01174448319222e96e7a6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CC2530基础实验：(8)串口通讯-发送字符串控制LED</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f34f26133f3774e8949198ecf0cc9c58/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Docker】进入docker下的mysql</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>