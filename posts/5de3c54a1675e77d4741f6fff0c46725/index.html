<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>（三）Apache log4net™ 手册 -演示 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="（三）Apache log4net™ 手册 -演示" />
<meta property="og:description" content="0、引言 在开始本文之前，推荐您首先阅读 Apache log4net™ 手册中有关 介绍 与 配置 的相关内容。本文将通过实践分别为您演示如何使用 Visual Studio 2022 在 .NET Framework 项目和 .NET 项目下配置并使用 Log4Net。
1、为 .NET Framework 项目配置 Log4Net 1.1、先决条件 一个简单的 .NET Framework 项目（比如：控制台应用(.NET Framework)） 1.2、引用 Log4Net NuGet 包 在 1.1 小节中，笔者创建了一个新的 .NET Framework 控制台项目。解决方案名称为 “Log4NetDemo”, 项目名称为 “ConsoleApp4DotNetFramework”：
项目目标框架为 .NET Framework 4.8.1
前往 Visual Studio 菜单栏的【工具】-【NuGet 包管理器】-【管理解决方案的 NuGet 程序包】：
在打开的标签页中切换到【浏览】页面，搜索 “Log4Net” 并选中；在右方的配置页面勾选要安装的项目，点击【安装】按钮：
安装完成后，可以看到解决方案资源管理器内新增了一个 package.config 文件：
内容如下：
1.3、配置 Log4Net 完成 1.2 小节的内容后，在解决方案资源管理器内右击项目名称，点击【添加】-【新建项】。在打开的对话框中搜索找到“应用程序配置文件” C# 项，修改文件名为 log4net.config，点击【添加】：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5de3c54a1675e77d4741f6fff0c46725/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-09T20:15:36+08:00" />
<meta property="article:modified_time" content="2023-10-09T20:15:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">（三）Apache log4net™ 手册 -演示</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="0_0"></a>0、引言</h2> 
<p>在开始本文之前，推荐您首先阅读 Apache log4net™ 手册中有关 <a href="https://blog.csdn.net/YMGogre/article/details/133643325">介绍</a> 与 <a href="https://blog.csdn.net/YMGogre/article/details/133684857">配置</a> 的相关内容。本文将通过实践分别为您演示如何使用 Visual Studio 2022 在 .NET Framework 项目和 .NET 项目下配置并使用 Log4Net。</p> 
<h2><a id="1_NET_Framework__Log4Net_4"></a>1、为 .NET Framework 项目配置 Log4Net</h2> 
<a id="AnchorPoint-11"> </a> 
<h3><a id="11_8"></a>1.1、先决条件</h3> 
<ul><li>一个简单的 .NET Framework 项目（比如：控制台应用(.NET Framework)）</li></ul> 
<a id="AnchorPoint-12"> </a> 
<h3><a id="12_Log4Net_NuGet__14"></a>1.2、引用 Log4Net NuGet 包</h3> 
<ol><li> <p>在 <a href="#AnchorPoint-11" rel="nofollow">1.1 小节</a>中，笔者创建了一个新的 .NET Framework 控制台项目。<a href="https://learn.microsoft.com/zh-cn/visualstudio/ide/solutions-and-projects-in-visual-studio?view=vs-2022#solutions" rel="nofollow">解决方案</a>名称为 “<strong>Log4NetDemo</strong>”, 项目名称为 “<strong>ConsoleApp4DotNetFramework</strong>”：<br><img src="https://images2.imgbox.com/c9/5c/K90mT3L7_o.png" alt="项目资源"></p> 
  <blockquote> 
   <p>项目目标框架为 .NET Framework 4.8.1</p> 
  </blockquote> </li><li> <p>前往 Visual Studio 菜单栏的【工具】-【NuGet 包管理器】-【管理解决方案的 NuGet 程序包】：<br><img src="https://images2.imgbox.com/c2/cc/BDmYjIfc_o.png" alt="管理 NuGet 包"></p> </li><li> <p>在打开的标签页中切换到【浏览】页面，搜索 “Log4Net” 并选中；在右方的配置页面勾选要安装的项目，点击【安装】按钮：<br><img src="https://images2.imgbox.com/ae/91/9tN7pdCC_o.png" alt="安装 log4net NuGet 包"></p> </li><li> <p>安装完成后，可以看到<a href="https://learn.microsoft.com/zh-cn/visualstudio/ide/use-solution-explorer?view=vs-2022#open-solution-explorer" rel="nofollow">解决方案资源管理器</a>内新增了一个 <code>package.config</code> 文件：<br><img src="https://images2.imgbox.com/93/4f/d2DA7TS8_o.png" alt="新增 packages.config"><br>内容如下：<br><img src="https://images2.imgbox.com/a2/07/ZCD2CZkH_o.png" alt="packages.config 文件内容"></p> </li></ol> 
<h3><a id="13_Log4Net_24"></a>1.3、配置 Log4Net</h3> 
<ol><li> <p>完成 <a href="#AnchorPoint-12" rel="nofollow">1.2 小节</a>的内容后，在解决方案资源管理器内右击项目名称，点击【添加】-【新建项】。在打开的对话框中搜索找到“应用程序配置文件” C# 项，修改文件名为 <code>log4net.config</code>，点击【添加】：<br><img src="https://images2.imgbox.com/65/1b/L7xXAHyP_o.png" alt="添加配置文件"></p> </li><li> <p>在解决方案资源管理器内右击 <code>log4net.config</code>，点击【属性】，将“复制到输出目录”属性的值修改为“如果较新则复制”：<br><img src="https://images2.imgbox.com/9c/bf/sP1dymeR_o.png" alt="修改属性"></p> </li><li> <p>双击打开 <code>log4net.config</code> 文件，将其修改为以下内容并保存：</p> <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log4net</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 定义一个控制台 appender --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Appender.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 日志输出格式 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Layout.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionPattern</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>%5level [%thread] (%file:%line) - %message%newline<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 定义一个文件 appender --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFile<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Appender.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 保存文件的名称 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.log<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appendToFile</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 文件的编码方式 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Encoding<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 每个文件的大小 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maximumFileSize</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100KB<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 保存文件数量 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxSizeRollBackups</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token comment">&lt;!-- 日志输出格式 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Layout.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionPattern</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>%level %thread %logger - %message%newline<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 定义 root logger 的配置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 定义 root logger 的日志级别 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ALL<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 引用 Console appender --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 引用 RollingFile appender --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFile<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log4net</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>在解决方案资源管理器内展开项目下的 <code>Properties</code> 属性文件夹，可以看到下属有一个 <code>AssemblyInfo.cs</code> 的文件，双击打开该文件：<br><img src="https://images2.imgbox.com/d5/46/wV83nFhB_o.png" alt="打开 AssemblyInfo.cs"></p> </li><li> <p>在该文件的末尾<strong>附加</strong>如下内容并保存：</p> <pre><code class="prism language-csharp"><span class="token comment">// 指定log4net 的配置文件</span>
<span class="token punctuation">[</span>assembly<span class="token punctuation">:</span> log4net<span class="token punctuation">.</span>Config<span class="token punctuation">.</span><span class="token function">XmlConfigurator</span><span class="token punctuation">(</span>ConfigFile <span class="token operator">=</span> <span class="token string">"log4net.config"</span><span class="token punctuation">,</span> Watch <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre> </li></ol> 
<h3><a id="14_Log4Net_79"></a>1.4、测试 Log4Net</h3> 
<ol><li> <p>在解决方案资源管理器内双击打开 <code>Program.cs</code>，将其修改为以下内容并保存：</p> <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">ConsoleApp4DotNetFramework</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">internal</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 定义一个静态 logger 变量，其引用名为 "Program" 的 Logger 实例</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">log4net<span class="token punctuation">.</span>ILog</span> log <span class="token operator">=</span> log4net<span class="token punctuation">.</span>LogManager<span class="token punctuation">.</span><span class="token function">GetLogger</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Program</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">"开始调试"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">"Entering application."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"异常信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"致命错误"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"异常信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>运行项目，将得到以下输出：<br><img src="https://images2.imgbox.com/8b/90/W6bD0VrD_o.png" alt="输出"></p> </li><li> <p>在应用程序的基目录将会生成一个名为 <code>example.log</code> 的日志文件，内容如下：<br><img src="https://images2.imgbox.com/79/83/hcVgK6qv_o.png" alt="日志文件"></p> </li></ol> 
<h2><a id="2_NET__Log4Net_112"></a>2、为 .NET 项目配置 Log4Net</h2> 
<a id="AnchorPoint-21"> </a> 
<h3><a id="21_116"></a>2.1、先决条件</h3> 
<ul><li>一个简单的 .NET 项目（比如：<a href="https://learn.microsoft.com/zh-cn/dotnet/core/tutorials/with-visual-studio?pivots=dotnet-7-0" rel="nofollow">使用 Visual Studio 创建 .NET 控制台应用程序</a>）。</li></ul> 
<a id="AnchorPoint-22"> </a> 
<h3><a id="22_Log4Net_NuGet__122"></a>2.2、引用 Log4Net NuGet 包</h3> 
<ol><li> <p>在 <a href="#AnchorPoint-21" rel="nofollow">2.1 小节</a>中，笔者在解决方案 “<strong>Log4NetDemo</strong>” 中继续新建了一个 .NET 控制台项目, 项目名称为 “<strong>ConsoleApp4DotNet</strong>”。<a href="https://learn.microsoft.com/zh-cn/visualstudio/get-started/csharp/run-program?view=vs-2022#start-from-a-project" rel="nofollow">设置该项目为启动项目</a>: <br><img src="https://images2.imgbox.com/29/7c/If90JKv5_o.png" alt="项目资源"></p> 
  <blockquote> 
   <p>目标框架为 .NET 6.0</p> 
  </blockquote> </li><li> <p>前往 Visual Studio 菜单栏的【工具】-【NuGet 包管理器】-【管理解决方案的 NuGet 程序包】：<br><img src="https://images2.imgbox.com/45/66/XK0Ing5j_o.png" alt="管理 NuGet 包"></p> </li><li> <p>在打开的标签页中切换到【已安装】页面，选中 “Log4Net”；在右方的配置页面勾选要安装的项目，点击【安装】按钮：<br><img src="https://images2.imgbox.com/06/72/CIlGSXcK_o.png" alt="安装 log4net NuGet 包"></p> </li><li> <p>安装完成后，在<a href="https://learn.microsoft.com/zh-cn/visualstudio/ide/use-solution-explorer?view=vs-2022#open-solution-explorer" rel="nofollow">解决方案资源管理器</a>内双击项目名称打开项目（<code>.csproj</code>）文件，可以看到项目文件中添加了对 Log4Net NuGet 包的引用：<br><img src="https://images2.imgbox.com/87/4e/QrSzgXoi_o.png" alt="PackageReference"></p> 
  <blockquote> 
   <p><a href="https://stackoverflow.com/questions/51549551/nuget-packages-config-csproj-and-references" rel="nofollow" title="c# - NuGet, Packages.config, .csproj and references - Stack Overflow"><code>package.config</code> or <code>PackageReference</code>?</a></p> 
  </blockquote> </li></ol> 
<h3><a id="23_Log4Net_134"></a>2.3、配置 Log4Net</h3> 
<ol><li> <p>完成 <a href="#AnchorPoint-22" rel="nofollow">2.2 小节</a>的内容后，在解决方案资源管理器内右击项目名称，点击【添加】-【新建项】。在打开的对话框中搜索找到“应用程序配置文件” C# 项，修改文件名为 <code>log4net.config</code>，点击【添加】：<br><img src="https://images2.imgbox.com/be/2e/nQZLbVLU_o.png" alt="添加配置文件"></p> </li><li> <p>在解决方案资源管理器内右击 <code>log4net.config</code>，点击【属性】，将“复制到输出目录”属性的值修改为“如果较新则复制”：<br><img src="https://images2.imgbox.com/2c/2a/ETb4x5UB_o.png" alt="修改属性"></p> </li><li> <p>双击打开 <code>log4net.config</code> 文件，将其修改为以下内容并保存：</p> <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log4net</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 定义一个控制台 appender --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Appender.ConsoleAppender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 日志输出格式 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Layout.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionPattern</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>%5level [%thread] (%file:%line) - %message%newline<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 定义一个文件 appender --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFile<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Appender.RollingFileAppender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 保存文件的名称 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.log<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appendToFile</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 文件的编码方式 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Encoding<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 每个文件的大小 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maximumFileSize</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100KB<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 保存文件数量 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxSizeRollBackups</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token comment">&lt;!-- 日志输出格式 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layout</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log4net.Layout.PatternLayout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>conversionPattern</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>%level %thread %logger - %message%newline<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 定义 root logger 的配置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 定义 root logger 的日志级别 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ALL<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 引用 Console appender --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Console<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 引用 RollingFile appender --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RollingFile<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log4net</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>由于 .NET Core 项目中，<code>AssemblyInfo.cs</code> 文件是自动生成的。所以我们无法在解决方案树内找到该文件。<s>我们可以选择关闭自动生成（参考<a href="https://stackoverflow.com/questions/42138418/equivalent-to-assemblyinfo-in-dotnet-core-csproj" rel="nofollow">这里</a>），手动创建 <code>AssemblyInfo.cs</code>（参考<a href="https://stackoverflow.com/questions/68780672/where-is-the-properties-or-assemblyinfo-cs-file-folder" rel="nofollow">这里</a>以及<a href="https://stackoverflow.com/questions/74196299/no-assemblyinfo-cs-file-when-generating-a-project-in-visual-studio-2019" rel="nofollow">这里</a>），最后使用 <a href="https://blog.csdn.net/YMGogre/article/details/133684857#t2">assembly-level attribute 来配置 log4net</a></s>。不过还是算了，让我们直接使用编程方式指定 log4net 的配置文件吧（见下一节）。</p> </li></ol> 
<h3><a id="24_Log4Net_183"></a>2.4、测试 Log4Net</h3> 
<ol><li> <p>在解决方案资源管理器内双击打开 <code>Program.cs</code>，将其修改为以下内容并保存：</p> <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 定义一个静态 logger 变量，其引用名为 "Program" 的 Logger 实例</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">log4net<span class="token punctuation">.</span>ILog</span> log <span class="token operator">=</span> log4net<span class="token punctuation">.</span>LogManager<span class="token punctuation">.</span><span class="token function">GetLogger</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Program</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 使用 XmlConfigurator 直接读取 XML 文件并使用它来配置 log4net</span>
        log4net<span class="token punctuation">.</span>Config<span class="token punctuation">.</span>XmlConfigurator<span class="token punctuation">.</span><span class="token function">Configure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>FileInfo</span><span class="token punctuation">(</span><span class="token string">"log4net.config"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        log<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">"开始调试"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">"Entering application."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"异常信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"致命错误"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"异常信息"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>运行项目，将得到以下输出：<br><img src="https://images2.imgbox.com/67/4f/MwuuczIA_o.png" alt="输出"></p> </li><li> <p>在应用程序的基目录将会生成一个名为 <code>example.log</code> 的日志文件，内容如下：<br><img src="https://images2.imgbox.com/c7/9c/0zw2l8yM_o.png" alt="日志文件"></p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4dcfb187ddebc4a4bc37817fae597c86/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">flask python 设置定时任务 flask 周期性执行任务方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7017e1f579a6158cb701d62a0f025d31/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C&#43;&#43;】面向对象编程（六）在派生类中定义一个虚函数、虚函数的静态解析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>