<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端路由模式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="前端路由模式" />
<meta property="og:description" content="文章目录 一、hash 模式Hash 模式的特点window.onhashchange 事件 二、history 模式history APIwindow.onpopstate 事件解决history模式下页面刷新404问题 如何选择合适的路由模式 一、hash 模式 hash 模式是一种把前端路由的路径用 # 拼接在真实 url 后面的模式，通过 hashchange 事件监听 hash 值的改变来渲染页面对应的组件。hash 模式不会向后端发送 http 请求，所有的 hash 值操作都与后端无关。
使用 location.hash 获取 hash 值。
Hash 模式的特点 兼容性好：Hash 模式支持所有现代浏览器，并且在不支持 HTML5 History API 的旧版浏览器上也能正常工作。简单配置：在 Vue 路由中，默认使用 Hash 模式，不需要额外的配置。易于部署：由于使用了 hash，URL 发生变化时不会触发页面刷新，因此部署时只需将静态文件部署到服务器即可。 window.onhashchange 事件 当 URL 的片段标识符（hash 值）更改时，将触发 hashchange 事件 (跟在＃符号后面的 URL 部分，包括＃符号)。
使用 addEventListener 监听 hashchange 事件： window.addEventListener(&#39;hashchange&#39;, function() { console.log(&#39;hash值被修改了&#39;) }, false); 使用 onhashchange 事件处理程序 function locationHashChanged() { if (location." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b9013a050d27674d21679efb596c2aad/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-20T10:35:20+08:00" />
<meta property="article:modified_time" content="2023-12-20T10:35:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端路由模式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#hash__1" rel="nofollow">一、hash 模式</a></li><li><ul><li><a href="#Hash__6" rel="nofollow">Hash 模式的特点</a></li><li><a href="#windowonhashchange__11" rel="nofollow">window.onhashchange 事件</a></li></ul> 
  </li><li><a href="#history__46" rel="nofollow">二、history 模式</a></li><li><ul><li><a href="#history_API_53" rel="nofollow">history API</a></li><li><a href="#windowonpopstate__57" rel="nofollow">window.onpopstate 事件</a></li><li><a href="#history404_80" rel="nofollow">解决history模式下页面刷新404问题</a></li></ul> 
  </li><li><a href="#_98" rel="nofollow">如何选择合适的路由模式</a></li></ul> 
</div> 
<p></p> 
<h2><a id="hash__1"></a>一、hash 模式</h2> 
<p><code>hash</code> 模式是一种把前端路由的路径用 <code>#</code> 拼接在真实 url 后面的模式，通过 <code>hashchange</code> 事件监听 hash 值的改变来渲染页面对应的组件。hash 模式不会向后端发送 http 请求，所有的 hash 值操作都与后端无关。</p> 
<p>使用 <code>location.hash</code> 获取 hash 值。<br> <img src="https://images2.imgbox.com/24/77/gWagiWP1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Hash__6"></a>Hash 模式的特点</h3> 
<ul><li>兼容性好：Hash 模式支持所有现代浏览器，并且在不支持 HTML5 History API 的旧版浏览器上也能正常工作。</li><li>简单配置：在 Vue 路由中，默认使用 Hash 模式，不需要额外的配置。</li><li>易于部署：由于使用了 hash，URL 发生变化时不会触发页面刷新，因此部署时只需将静态文件部署到服务器即可。</li></ul> 
<h3><a id="windowonhashchange__11"></a>window.onhashchange 事件</h3> 
<p>当 URL 的片段标识符（hash 值）更改时，将触发 <code>hashchange</code> 事件 (跟在＃符号后面的 URL 部分，包括＃符号)。</p> 
<ul><li>使用 <code>addEventListener</code> 监听 <code>hashchange</code> 事件：</li></ul> 
<pre><code class="prism language-javascript">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hash值被修改了'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<ul><li>使用 <code>onhashchange</code> 事件处理程序</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">locationHashChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash <span class="token operator">===</span> <span class="token string">'#/about'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"欢迎进入about页面"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span>onhashchange <span class="token operator">=</span> locationHashChanged<span class="token punctuation">;</span>

</code></pre> 
<p>修改 hash 值会优先触发 <code>popstate</code> 事件，然后再触发 <code>hashchange</code> 事件</p> 
<pre><code class="prism language-javascript">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hashchage 事件被触发了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// hash值的改变也会触发 window.onpopstate事件，onpopstate事件在 history模式中再做介绍</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"popstate"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"popstate 事件被触发了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<h2><a id="history__46"></a>二、history 模式</h2> 
<p><code>history</code> 是 HTML5 提供的新特性，允许开发者直接更改前端路由，也就是更改 url 地址而无需向后端发送 http 请求。</p> 
<p>history 是 <code>window.history</code> 的简写模式，是 History 构造函数的实例化对象。</p> 
<p>History 里面保存着当前标签页的所有浏览页面的访问记录</p> 
<h3><a id="history_API_53"></a>history API</h3> 
<p><img src="https://images2.imgbox.com/d5/b6/kxGbPDNQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/75/99/5J7SuyEw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="windowonpopstate__57"></a>window.onpopstate 事件</h3> 
<p><code>window.onpopstate</code> 事件是用来监听浏览历史记录变化的。</p> 
<p>调用 <code>history.pushState()</code> 或者 <code>history.replaceState()</code> 不会触发 popstate 事件。popstate 事件只会在浏览器某些行为下触发，比如点击前进、后退按钮（或者在 JavaScript 中调用 <code>history.back()</code>、<code>history.forward()</code>、 <code>history.go()</code> 方法）。即，在同一文档的两个历史记录条目之间导航会触发该事件。</p> 
<ul><li>使用 <code>addEventListener</code> 监听 popstate 事件：</li></ul> 
<pre><code class="prism language-javascript">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<ul><li>使用 <code>onpopstate</code> 事件处理程序</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">historyStateChanged</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span>onpopstate<span class="token operator">=</span> historyStateChanged<span class="token punctuation">;</span>

</code></pre> 
<h3><a id="history404_80"></a>解决history模式下页面刷新404问题</h3> 
<p>在 history 下，你可以自由的修改 path，但刷新页面时，如果服务器中没有相应的响应或者资源，则会出现404页面，因为刷新页面会发送 http 请求。也就是说，使用 history 路由模式，需要通过服务端来允许地址可访问，后端也必须配置了当前资源路径地址才行。</p> 
<p>如果后台部署使用了 nginx，可以对 nginx 进行如下配置来解决页面刷新问题（摘录）：</p> 
<pre><code class="prism language-javascript">server <span class="token punctuation">{<!-- --></span>
	listen	<span class="token number">8080</span><span class="token punctuation">;</span>
	server_name  localhost<span class="token punctuation">;</span>
	location <span class="token operator">/</span> <span class="token punctuation">{<!-- --></span>
	    root  <span class="token string">'E:\dist'</span><span class="token punctuation">;</span>
	    index  <span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
	    try_files $uri $uri<span class="token operator">/</span> <span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="_98"></a>如何选择合适的路由模式</h2> 
<p>使用 Hash 模式：</p> 
<ul><li>如果你的项目不需要考虑兼容性问题，或者需要在旧版浏览器中支持路由功能。</li><li>如果你希望简化部署过程，只需将静态文件部署到服务器即可。</li></ul> 
<p>使用 History 模式：</p> 
<ul><li>如果你希望 URL 更加美观、简洁，不希望在 URL 中出现 # 符号。</li><li>如果你可以进行服务器配置，确保在直接访问 URL 时返回正确的页面。</li><li>如果你的项目不需要考虑旧版浏览器的兼容性问题。</li></ul> 
<p>在 Vue 项目中，可以通过在路由配置中设置 <code>mode</code> 属性来切换路由模式：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span> <span class="token comment">// 或者 'hash'</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6435ecc5e011dc9e20be604c32716460/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">利用prometheus&#43;grafana进行Linux主机监控</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b30aceabba0d9ee23e372a3bfa4618c1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序ts&#43;less模版引入Rant Weapp</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>