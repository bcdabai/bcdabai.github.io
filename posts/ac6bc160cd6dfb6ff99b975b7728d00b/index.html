<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux服务器监控之万能命令、进程追踪、监控工具与分析、定时任务 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux服务器监控之万能命令、进程追踪、监控工具与分析、定时任务" />
<meta property="og:description" content="一、万能命令
1、sar简介
（System Activity Reporter系统活动情况报告）是目前Linux上最为全面的系统性能分析工具之一，可以从多方面对系统的活动进行报告。
sar的性能监控范围：文件的读写情况、系统调用的使用情况、磁盘I/O、CPU效率、内存使用状况、进程活动及IPC有关的活动等
sar语法：
sar [options] [-A] [-o file] t [n]
sar语法说明：在命令行中，n和t两个参数组合起来定义采样间隔和次数，t为采样间隔，是必须有的参数，n为采样次数，是可选的，默认值是1，-o file表示将命令结果以二进制格式存放在文件中，file在此处不是关键字，是文件名。option为命令行选项。
sar选项：
- A：所有报告的总和。
- u：CPU利用率
- v：进程、节点、文件和锁表状态
- r：显示系统内存的使用情况
- B：内存分页情况
- b：缓冲区使用情况
二、Linux下的进程追踪命令
1、strace简介
strace命令是一个集诊断、调试、统计于一体的工具，我们可以使用strace对应用的系统调用和信号传递的跟踪结果来对应用进行分析，以达到解决问题或者是了解应用工作过程的目的。
strace选项：
- p：跟踪指定的进程
- f：跟踪由fork子进程系统调用
- c：统计每一系统调用的所执行的时间，次数和出错的次数等
- t：在输出中的每一行前加上时间信息。-tt时间确定到微秒级
- e expr：输出过滤器，通过表达式，可以过滤掉你不想要的输出。
- o filename：默认strace将结果输出到stdout。通过-o可以将输出写入到filename文件中。
三、Linux监控工具
1、nmon简介
nmon是一种在linux操作系统上广泛使用的监控与分析工具，nmon所记录的信息是比较全面的，它能在系统运行过程中实时地捕捉系统资源的使用情况，并且能输出结果到文件中，然后通过nmon-analyzer工具产生数据文件与图形化结果。
nmon下载与安装：
wget Download nmon_linux_14i.tar.gz (nmon for Linux)
tar gxvf nmon_linux_14i.tar.gz
mv nmon_x86_64_centos7 nmon
cp nmon /usr/bin/
nmon用法：
- f：这是nmon必选参数，并且必须放在第一个，就是输出文件的意思；用该参数的话，nmon输出的文件名就是默认名称：hostname_date_time.nmon;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ac6bc160cd6dfb6ff99b975b7728d00b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-23T11:50:40+08:00" />
<meta property="article:modified_time" content="2023-03-23T11:50:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux服务器监控之万能命令、进程追踪、监控工具与分析、定时任务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <p>一、万能命令</p> 
 <p></p> 
 <p>1、sar简介</p> 
 <ul><li> <p>（System Activity Reporter系统活动情况报告）是目前Linux上最为全面的系统性能分析工具之一，可以从多方面对系统的活动进行报告。</p> </li><li> <p>sar的性能监控范围：文件的读写情况、系统调用的使用情况、磁盘I/O、CPU效率、内存使用状况、进程活动及IPC有关的活动等</p> </li><li> <p> sar语法：</p> </li></ul> 
 <p>            sar [options] [-A] [-o file] t [n]</p> 
 <ul><li> <p>sar语法说明：在命令行中，n和t两个参数组合起来定义采样间隔和次数，t为采样间隔，是必须有的参数，n为采样次数，是可选的，默认值是1，-o file表示将命令结果以二进制格式存放在文件中，file在此处不是关键字，是文件名。option为命令行选项。</p> </li><li> <p> sar选项：</p> </li></ul> 
 <p>                         - A：所有报告的总和。</p> 
 <p>                         - u：CPU利用率</p> 
 <p>                         - v：进程、节点、文件和锁表状态</p> 
 <p>                         - r：显示系统内存的使用情况</p> 
 <p>                         - B：内存分页情况</p> 
 <p>                         - b：缓冲区使用情况</p> 
 <p><img alt="" height="1110" src="https://images2.imgbox.com/b4/af/3s1jsCS2_o.png" width="1200"></p> 
 <p></p> 
 <p></p> 
 <p>二、Linux下的进程追踪命令</p> 
 <p></p> 
 <p>1、strace简介</p> 
 <ul><li> <p>strace命令是一个集诊断、调试、统计于一体的工具，我们可以使用strace对应用的系统调用和信号传递的跟踪结果来对应用进行分析，以达到解决问题或者是了解应用工作过程的目的。</p> </li><li> <p> strace选项：</p> </li></ul> 
 <p>                         - p：跟踪指定的进程</p> 
 <p>                         - f：跟踪由fork子进程系统调用</p> 
 <p>                         - c：统计每一系统调用的所执行的时间，次数和出错的次数等</p> 
 <p>                         - t：在输出中的每一行前加上时间信息。-tt时间确定到微秒级</p> 
 <p>                         - e expr：输出过滤器，通过表达式，可以过滤掉你不想要的输出。</p> 
 <p>                         - o filename：默认strace将结果输出到stdout。通过-o可以将输出写入到filename文件中。</p> 
 <p><img alt="" height="746" src="https://images2.imgbox.com/b5/79/0ephxSi9_o.png" width="1200"><img alt="" height="490" src="https://images2.imgbox.com/51/1a/SkaVt1gu_o.png" width="1200"></p> 
 <p></p> 
 <p><img alt="" height="580" src="https://images2.imgbox.com/e4/2b/7mRtH51H_o.png" width="1200"></p> 
 <p><img alt="" height="712" src="https://images2.imgbox.com/fa/ab/kcRalcPM_o.png" width="1200"></p> 
 <p>三、Linux监控工具</p> 
 <p></p> 
 <p>1、nmon简介</p> 
 <ul><li> <p>nmon是一种在linux操作系统上广泛使用的监控与分析工具，nmon所记录的信息是比较全面的，它能在系统运行过程中实时地捕捉系统资源的使用情况，并且能输出结果到文件中，然后通过nmon-analyzer工具产生数据文件与图形化结果。</p> </li><li> <p> nmon下载与安装：</p> </li></ul> 
 <p>            wget <a href="http://sourceforge.net/projects/nmon/files/nmon_linux_14i.tar.gz" rel="nofollow" title="Download nmon_linux_14i.tar.gz (nmon for Linux)">Download nmon_linux_14i.tar.gz (nmon for Linux)</a></p> 
 <p>            tar gxvf nmon_linux_14i.tar.gz</p> 
 <p>            mv nmon_x86_64_centos7 nmon</p> 
 <p>            cp nmon /usr/bin/</p> 
 <ul><li> <p>  nmon用法：</p> </li></ul> 
 <p>                         - f：这是nmon必选参数，并且必须放在第一个，就是输出文件的意思；用该参数的话，nmon输出的文件名就是默认名称：hostname_date_time.nmon;</p> 
 <p>                         - F &lt;filename&gt;：这个参数和-f相同，只不过用户可以自己定义文件名称；</p> 
 <p>                         - s：采集数据频率，也就是保存数据的频率；</p> 
 <p>                         - c：采集数据次数；</p> 
 <p>                         - t：输出最小号资源的进程数据；</p> 
 <p>                         - h：查看帮助；</p> 
 <p></p> 
 <p>2、nmon安装</p> 
 <p>一、安装方法：</p> 
 <p>1.使用yum安装</p> 
 <p>首先安装第三方yum源：</p> 
 <p># yum -y install wget ; wget -O /etc/yum.repos.d/epel.repo <a href="http://mirrors.aliyun.com/repo/epel-7.repo" rel="nofollow" title="http://mirrors.aliyun.com/repo/epel-7.repo">http://mirrors.aliyun.com/repo/epel-7.repo</a></p> 
 <p> 更新yum源（可不更）</p> 
 <p># yum makecache</p> 
 <p> 安装nmon</p> 
 <p># yum -y install nmon</p> 
 <p> 打开nmon</p> 
 <p># nmon</p> 
 <p><img alt="" height="998" src="https://images2.imgbox.com/ff/33/KTe20Hq7_o.png" width="1200"><img alt="" height="998" src="https://images2.imgbox.com/76/db/z1kq8phX_o.png" width="1200"><img alt="" height="956" src="https://images2.imgbox.com/32/7b/I5GJgSKz_o.png" width="1200"></p> 
 <p>3、nmon使用方法</p> 
 <p>1）实时监控</p> 
 <p>输入以下命令：</p> 
 <p>c         可显示CPU的信息</p> 
 <p>m       对应内存</p> 
 <p>n        对应网络</p> 
 <p>d        可以查看磁盘信息</p> 
 <p>t         可以查看系统的进程信息</p> 
 <p><img alt="" height="964" src="https://images2.imgbox.com/c0/15/l8uE1HDl_o.png" width="1200"></p> 
 <p>2）采集数据</p> 
 <p>nmon -f -F demo.nmon -s 1 -c 10 -t</p> 
 <p></p> 
 <p><img alt="" height="1042" src="https://images2.imgbox.com/9d/8f/XHpuDz6D_o.png" width="1200"></p> 
 <p><img alt="" height="1028" src="https://images2.imgbox.com/f9/57/euWYDnXm_o.png" width="1200"></p> 
 <p></p> 
 <p>四、nmon结果的分析</p> 
 <p></p> 
 <p>1、nmon_analyzer简介</p> 
 <ul><li> <p>nmon_analyser的作用就是分析nmon数据采集后的结果，nmon analyser需要借助Excel的宏，WPS默认没有安装宏，需要下载插件。</p> </li><li> <p> nmon_analyser下载：</p> </li></ul> 
 <p>            Https://www.ibm.com/developerworks/community/wikis/home?lang=en#!/wiki/Power+Systems/page/nmon_analyser</p> 
 <ul><li> <p>nmon_analyser重点sheet</p> </li></ul> 
 <p>           SYS_SUMM: 系统汇总页，包含cpu占有率变化情况，磁盘IO的变化情况等信息；</p> 
 <p>           AAA: 关于操作系统以及nmon本身的一些信息；</p> 
 <p>           CPUnn: 显示执行时间内CPU占用情况；</p> 
 <p>           CPU_ALL: 所有CPU概述，显示所有CPU平均占用情况；</p> 
 <p>           CPU_SUMM: 每一个CPU在执行时间内的占用情况；</p> 
 <p>           DGBUSY: 磁盘组每个hdisk设备平均占用情况；</p> 
 <p>           DGREAD: 每个磁盘组的平均读情况；</p> 
 <p>           DGSIZE: 每个磁盘组的平均读写情况；</p> 
 <p>           DGWRITE: 每个磁盘组的平均写情况；</p> 
 <p>           DGXFER: 每个磁盘组的I/O每秒操作；</p> 
 <p>           MEN: 内存相关的主要信息，使用、空闲内存大小等；</p> 
 <p>           NET :显示系统中每个网络适配器的数据传输速率（千字节/秒）</p> 
 <p>           PAGE : 本sheet统计相关页信息的记录</p> 
 <p></p> 
 <p></p> 
 <p>五、Linux定时任务</p> 
 <p></p> 
 <p>1、crontab</p> 
 <ul><li> <p>linux系统是cron这个系统服务来控制的。linux系统上包含很多的计划性工作。使用者自己也可以设置计划任务，所以linux系统提供了使用者控制计划任务的命令。</p> </li><li> <p>crontab的启动</p> </li></ul> 
 <p>           /sbin/service crond status  查看定时任务的服务是否启动</p> 
 <p>           start /stop/restart  启动服务/停止服务/重新启动服务</p> 
 <p>           reload   重新载入配置</p> 
 <ul><li> <p>crontab的服务权限</p> </li></ul> 
 <p>           1）crontab的权限管理存储在cron.allow文件与cron.deny文件中。如果没有可创建在ect目录下；</p> 
 <p>           2）cron.allow文件存储的是允许哪些用户使用crontab；</p> 
 <p>           3）cron.deny文件存储的是不允许哪些用户使用crontab；</p> 
 <ul><li> <p>crontab的使用场景说明</p> </li></ul> 
 <p>           1）当两个文件都不存在时，那么只允许root用户使用crontab；</p> 
 <p>           2）当 cron.allow文件存在，而cron.deny文件不存在时，那么只允许cron.allow文件中的用户使用crontab；</p> 
 <p>           3）当 cron.deny文件存在，而cron.allow文件不存在时，那么只允许没有列在 cron.deny文件中的用户可以使用crontab；</p> 
 <p>           4）如果两个文件都存在，而一个用户在两个文件中都有，那么以cron.allow文件中的为准，只要cron.allow文件拥有该用户，则该用户就可以使用crontab；</p> 
 <ul><li> <p>crontab的使用</p> </li></ul> 
 <p>           命令：crontab -e  在编辑页面输入命令即可</p> 
 <ul><li> <p>crontab的编辑格式</p> </li></ul> 
 <p>           基本格式：minute  hour  day  month  week  command</p> 
 <p>           对应单位：      分      时     日      月         周         命令</p> 
 <ul><li> <p>crontab的时间单位说明</p> </li></ul> 
 <p>           第1列表示分钟00～59每分钟用*或者*/1表示</p> 
 <p>           第2列表示小时00～23（0表示0点）</p> 
 <p>           第3列表示日期01～31</p> 
 <p>           第4列表示月份01～12</p> 
 <p>           第5列表示星期0～6（0表示星期天）</p> 
 <p>           第6列表示要运行的命令</p> 
 <ul><li> <p>crontab的符号说明</p> </li></ul> 
 <p>           * 代表取值范围内的所有值</p> 
 <p>           / 代表每的意思</p> 
 <p>           - 代表从某个数字到某个数字</p> 
 <p>           , 分隔开几个不同的数字</p> 
 <p></p> 
 <p><img alt="" height="528" src="https://images2.imgbox.com/54/92/DC3z45n2_o.png" width="1200"></p> 
</div> 
<div></div> 
<div></div> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3a2c6a0f6c70658a552bc4baa860c908/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">controller层使用@Transactional事务注解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dc5aa4a1fe07af64a4460692fa3be0ef/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">操作系统之调度算法（学习笔记）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>