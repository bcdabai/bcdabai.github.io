<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring Boot之使用thymeleaf和jpa增删改查简单实例 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spring Boot之使用thymeleaf和jpa增删改查简单实例" />
<meta property="og:description" content="这篇文章介绍如何使用jpa和thymeleaf做一个增删改查的示例。
配置文件 pom包配置 pom包里面添加jpa和thymeleaf的相关包引用
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; 在application.properties中添加配置 spring.datasource.url = jdbc:mysql://localhost:3309/springboot?useSSL\=false&amp;characterEncoding\=UTF-8&amp;autoReconnect\=true spring.datasource.username=root spring.datasource.password=123456 spring.datasource.driver-class-name=com.mysql.jdbc.Driver #启动时会根据实体类生成数据表，或者更新表结构，不清空数据，开发阶段使用；validate：表结构稳定后使用，可用于正式环境； spring.jpa.properties.hibernate.hbm2ddl.auto=update spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect # 控制台打印sql spring.jpa.show-sql= true spring.thymeleaf.cache=false 其中propertiesspring.thymeleaf.cache=false是关闭thymeleaf的缓存，不然在开发过程中修改页面不会立刻生效需要重启，生产可配置为true。
在项目resources目录下会有两个文件夹：static目录用于放置网站的静态内容如css、js、图片；templates目录用于放置项目使用的页面模板。
启动类 启动类需要添加Servlet的支持
import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.builder.SpringApplicationBuilder; import org.springframework.boot.context.web.SpringBootServletInitializer; @SpringBootApplication //若打包成war包,则需要继承SpringBootServletInitializer类,覆盖其configure(SpringApplicationBuilder)方法 public class JpaThymeleafApplication extends SpringBootServletInitializer { //添加servlet依赖 @Override protected SpringApplicationBuilder configure(SpringApplicationBuilder application){ return application.sources(JpaThymeleafApplication.class); } public static void main(String[] args) { SpringApplication." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0aa411bc121627dc03a70a1455dd4b15/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-08T17:42:49+08:00" />
<meta property="article:modified_time" content="2019-03-08T17:42:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring Boot之使用thymeleaf和jpa增删改查简单实例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>这篇文章介绍如何使用jpa和thymeleaf做一个增删改查的示例。</p> 
<h2>配置文件</h2> 
<h4>pom包配置</h4> 
<p>pom包里面添加jpa和thymeleaf的相关包引用</p> 
<pre class="has"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre> 
<h4><strong>在application.properties中添加配置</strong></h4> 
<pre class="has"><code>spring.datasource.url = jdbc:mysql://localhost:3309/springboot?useSSL\=false&amp;characterEncoding\=UTF-8&amp;autoReconnect\=true
spring.datasource.username=root
spring.datasource.password=123456
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
#启动时会根据实体类生成数据表，或者更新表结构，不清空数据，开发阶段使用；validate：表结构稳定后使用，可用于正式环境；
spring.jpa.properties.hibernate.hbm2ddl.auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
# 控制台打印sql
spring.jpa.show-sql= true

spring.thymeleaf.cache=false</code></pre> 
<p>其中<code>propertiesspring.thymeleaf.cache=false</code>是关闭thymeleaf的缓存，不然在开发过程中修改页面不会立刻生效需要重启，生产可配置为true。</p> 
<p>在项目resources目录下会有两个文件夹：static目录用于放置网站的静态内容如css、js、图片；templates目录用于放置项目使用的页面模板。</p> 
<h4 id="启动类">启动类</h4> 
<p>启动类需要添加Servlet的支持</p> 
<pre class="has"><code>import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.context.web.SpringBootServletInitializer;

@SpringBootApplication
//若打包成war包,则需要继承SpringBootServletInitializer类,覆盖其configure(SpringApplicationBuilder)方法
public class JpaThymeleafApplication extends SpringBootServletInitializer {
	
	//添加servlet依赖
	@Override
	protected SpringApplicationBuilder configure(SpringApplicationBuilder application){
		return application.sources(JpaThymeleafApplication.class);
	}
	
	public static void main(String[] args) {
		SpringApplication.run(JpaThymeleafApplication.class, args);
	}

}</code></pre> 
<h4 id="数据库层代码">数据库层代码</h4> 
<p>实体类映射数据库表</p> 
<pre class="has"><code>@Entity
@Table(name="user")
public class UserDo {
	@Id @GeneratedValue
	private Integer id;
	private String name;
	public Integer getId() {
		return id;
	}
	public void setId(Integer id) {
		this.id = id;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
		
}</code></pre> 
<p>继承JpaRepository类会自动实现很多内置的方法，包括增删改查。也可以根据方法名来自动生成相关sql</p> 
<pre class="has"><code>public interface UserRepository extends JpaRepository&lt;UserDo, Integer&gt; {
	UserDo findById(Integer id);
	
	Integer deleteById(Integer id);
}
</code></pre> 
<p> </p> 
<h4 id="业务层处理">业务层处理</h4> 
<p>service调用jpa实现相关的增删改查，实际项目中service层处理具体的业务代码。</p> 
<pre class="has"><code>@Service
public class UserService {
	@Resource 
	private UserRepository userRepository;
	
	
	public List&lt;UserDo&gt; getUserList(){
		return userRepository.findAll();
	}
	
	public UserDo findUserById(Integer id){
		return userRepository.findById(id);
	}
	
	@Transactional
	public UserDo saveUser(UserDo user){
		return userRepository.save(user);
	}
	
	@Transactional
	public UserDo editUser(UserDo user){
		return userRepository.save(user);
	}
	
	@Transactional
	public Integer deleteUser(Integer id){
		return userRepository.deleteById(id);
	}
}</code></pre> 
<p> 注意，需要事务处理的方法需要注解@Transactional，否则后面调用时可能会出现报错。</p> 
<p>Controller负责接收请求，处理完后将页面内容返回给前端。</p> 
<pre class="has"><code>@Controller
public class UserController {
	
	@Resource
	private UserService userService;
	
	@RequestMapping("/")
	public String index() {
		return "redirect:/list";//页面重定向到list
	}
	
	@RequestMapping("/list")
	public String list(Model model){
		List&lt;UserDo&gt; userList = userService.getUserList();
		model.addAttribute("userList", userList);
		return "user/list";//代表会直接去resources目录下找相关的文件
	}
	
	@RequestMapping("/toAdd")
	public String toAdd(UserDo user){
		return "user/userAdd";
	}
	
	@RequestMapping("/add")
    public String add(UserDo user) {
        userService.saveUser(user);
        return "redirect:/list";
    }
	
	@RequestMapping("/toEdit")
	public String toEdit(Model model, Integer id){
		UserDo user = userService.findUserById(id);
		model.addAttribute("user", user);
		return "user/userEdit";
	}
	
	@RequestMapping("/edit")
    public String edit(UserDo user) {
        userService.editUser(user);
        return "redirect:/list";
    }
	
	@RequestMapping("/delete")
    public String delete(Integer id) {
        userService.deleteUser(id);
        return "redirect:/list";//删除内容之后自动调整到list请求，然后再输出到页面。
    }
}</code></pre> 
<ul><li><code>return "user/userEdit";</code> 代表会直接去resources目录下找相关的文件。</li><li><code>return "redirect:/list";</code> 代表转发到对应的controller，这个示例就相当于删除内容之后自动调整到list请求，然后再输出到页面。</li></ul> 
<h4 id="页面内容">页面内容</h4> 
<p>在resource/templates下创建user文件夹</p> 
<p>在user文件夹下创建list.html</p> 
<pre class="has"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
	&lt;head&gt;
	    &lt;meta charset="UTF-8"/&gt;
	    &lt;title&gt;userList&lt;/title&gt;
	&lt;/head&gt;
&lt;body class="container"&gt;
	&lt;br/&gt;
	&lt;h1&gt;用户列表&lt;/h1&gt;
	&lt;br/&gt;&lt;br/&gt;
	&lt;div class="with:80%"&gt;
	    &lt;table&gt;
	        &lt;thead&gt;
	        &lt;tr&gt;
	            &lt;th&gt;#&lt;/th&gt;
	            &lt;th&gt;UserName&lt;/th&gt;
	            &lt;th&gt;Edit&lt;/th&gt;
	            &lt;th&gt;Delete&lt;/th&gt;
	        &lt;/tr&gt;
	        &lt;/thead&gt;
	        &lt;tbody&gt;
	        &lt;tr  th:each="user : ${userList}"&gt;
	            &lt;th scope="row" th:text="${user.id}"&gt;&lt;/th&gt;
	            &lt;td th:text="${user.name}"&gt;&lt;/td&gt;
	            &lt;td&gt;&lt;a th:href="@{/toEdit(id=${user.id})}"&gt;编辑&lt;/a&gt;&lt;/td&gt;
	            &lt;td&gt;&lt;a th:href="@{/delete(id=${user.id})}"&gt;删除&lt;/a&gt;&lt;/td&gt;
	        &lt;/tr&gt;
	        &lt;/tbody&gt;
	    &lt;/table&gt;
	&lt;/div&gt;
	&lt;div&gt;
	    &lt;div&gt;
	        &lt;a href="/toAdd" th:href="@{/toAdd}"&gt;添加&lt;/a&gt;
	    &lt;/div&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>效果图：</p> 
<p><img alt="" class="has" height="334" src="https://images2.imgbox.com/fd/35/W6VZ7sOg_o.png" width="479"></p> 
<p><code>&lt;tr th:each="user : ${userList}"&gt;</code> 这里会从controler层model set的对象去获取相关的内容，<code>th:each</code>表示会循环遍历对象内容。</p> 
<p>其实还有其它的写法，读者可以去学习尝试其他写法</p> 
<p>在同级目录下添加userAdd作为添加用户界面：</p> 
<pre class="has"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"/&gt;
    &lt;title&gt;userAdd&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;br/&gt;
	&lt;h2&gt;添加用户&lt;/h2&gt;
	&lt;br/&gt;
	&lt;div&gt;
	    &lt;form th:action="@{/add}" th:object="${user}" method="post"&gt;
	        &lt;div&gt;
	            &lt;label for="name"&gt;用户名：&lt;/label&gt;
	            &lt;div&gt;
	                &lt;input type="text" name="name"  id="name"/&gt;
	            &lt;/div&gt;
	        &lt;/div&gt;
	        &lt;div&gt;
	            &lt;div&gt;
	                &lt;input type="submit" value="提交"/&gt;
	                &amp;nbsp;&amp;nbsp;&amp;nbsp;
	                &lt;a href="/list" th:href="@{/list}"&gt;返回&lt;/a&gt;
	            &lt;/div&gt;
	        &lt;/div&gt;
	    &lt;/form&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>同理添加userEdit页面作为编辑页面</p> 
<pre class="has"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"/&gt;
    &lt;title&gt;user&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;br/&gt;
	&lt;h2&gt;修改用户&lt;/h2&gt;
	&lt;br/&gt;
	&lt;div&gt;
	    &lt;form th:action="@{/edit}" th:object="${user}" method="post"&gt;
	        &lt;input type="hidden" name="id" th:value="*{id}" /&gt;
	        &lt;div&gt;
	            &lt;label for="name"&gt;用户名&lt;/label&gt;
	            &lt;div&gt;
	                &lt;input type="text" name="name"  id="name" th:value="*{name}" placeholder="name"/&gt;
	            &lt;/div&gt;
	        &lt;/div&gt;
	        &lt;div&gt;
	            &lt;div&gt;
	                &lt;input type="submit" value="提交"/&gt;
	                &amp;nbsp; &amp;nbsp; &amp;nbsp;
	                &lt;a href="/list" th:href="@{/list}"&gt;返回&lt;/a&gt;
	            &lt;/div&gt;
	
	        &lt;/div&gt;
	    &lt;/form&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>效果图：</p> 
<p><img alt="" class="has" height="169" src="https://images2.imgbox.com/be/da/TjScgDuc_o.png" width="224"><img alt="" class="has" height="176" src="https://images2.imgbox.com/09/d8/mO3ggHc6_o.png" width="235"></p> 
<p> 这样一个使用jpa和thymeleaf的增删改查示例就完成了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f9aa7d26e7a20ee708948b95bfd12448/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot部署web容器SpringBootServletInitializer用途</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1a410058d3cc5186b41640acc621215b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ResultSet.next() 速度慢 怎么办</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>