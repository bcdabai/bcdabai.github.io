<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UDS-会话层服务 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="UDS-会话层服务" />
<meta property="og:description" content="1.会话层服务
该服务接口定义了一组用于获取会话层功能的服务，如数据的发送、接收、协议参数的设置。
所有会话层服务定义了三组服务原语(service primitives)，服务原语定义了服务使用者（如，diagnostic application）与服务提供者（如， session layer）间的相互合作。三组服务原语如下：
-服务请求原语 S_Data.request: 应用层用来向会话层传递控制信息或需要发送的数据。结构如下：（S_Mtype, S_SA, S_TA, S_TAtype, [S_AE],S_Data [Data#1, Data#2,...], S_Length）
-服务指示原语 S_Data.indication: 会话层用来向应用层传递状态信息或接收到的数据。结构如下：（S_Mtype, S_SA, S_TA, S_TAtype, [S_AE], S_Result）
-服务确认原语 S_Data.confirm：应用层用来向会话层传递控制信息。结构如下：
（S_Mtype, S_SA, S_TA, S_TAtype, [S_AE], S_Data [Data#1, Data#2,...], S_Length, S_Result）
注：
S_Mtype: 会话层报文类型，有diagnositics, remote diagnostics两种. 如果为diagnositcs, 地址信息包括S_SA, S_TA, S_TAtype; 如果为remote diagnositcs, 地址信息包括S_SA, S_TA, S_TAtype, S_-AE;
S_SA: 会话层源地址，2 byte的无符号整型，范围0x0000 - 0xFFFF;
S_TA: 会话层目标地址，2 byte的无符号整型，范围0x0000 - 0xFFFF;
S_TAtype: 会话层目标地址类型，有physical（1对1通信），functional（1对多通信）两种；
S_AE: 会话层地址扩展（可选），2 byte的无符号整型，范围0x0000 - 0xFFFF;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9452ddab311221a82b95d26951470a5f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-09T16:45:43+08:00" />
<meta property="article:modified_time" content="2020-08-09T16:45:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">UDS-会话层服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>1.会话层服务</strong></p> 
<p>该服务接口定义了一组用于获取会话层功能的服务，如数据的发送、接收、协议参数的设置。</p> 
<p>所有会话层服务定义了三组服务原语(service primitives)，服务原语定义了服务使用者（如，diagnostic application）与服务提供者（如， session layer）间的相互合作。三组服务原语如下：</p> 
<p><strong>-服务请求原语 S_Data.request</strong>: 应用层用来向会话层传递控制信息或需要发送的数据。结构如下：（S_Mtype, S_SA, S_TA, S_TAtype, [S_AE],S_Data [Data#1, Data#2,...], S_Length）</p> 
<p><strong>-服务指示原语 S_Data.indication: </strong>会话层用来向应用层传递状态信息或接收到的数据。结构如下：（S_Mtype, S_SA, S_TA, S_TAtype, [S_AE], S_Result）</p> 
<p><strong>-服务确认原语 S_Data.confirm：</strong>应用层用来向会话层传递控制信息。结构如下：</p> 
<p>（S_Mtype, S_SA, S_TA, S_TAtype, [S_AE], S_Data [Data#1, Data#2,...], S_Length, S_Result）</p> 
<p>注：</p> 
<p>S_Mtype: 会话层报文类型，有diagnositics, remote diagnostics两种. 如果为diagnositcs, 地址信息包括S_SA, S_TA, S_TAtype; 如果为remote diagnositcs, 地址信息包括S_SA, S_TA, S_TAtype, S_-AE;</p> 
<p>S_SA: 会话层源地址，2 byte的无符号整型，范围0x0000 - 0xFFFF;</p> 
<p>S_TA: 会话层目标地址，2 byte的无符号整型，范围0x0000 - 0xFFFF;</p> 
<p>S_TAtype: 会话层目标地址类型，有physical（1对1通信），functional（1对多通信）两种；</p> 
<p>S_AE: 会话层地址扩展（可选），2 byte的无符号整型，范围0x0000 - 0xFFFF;</p> 
<p>S_Length: 4 byte的无符号整型，范围0x0000 0000 - 0xFFFF FFFF;</p> 
<p> </p> 
<div style="text-align:center;"> 
 <figure class="image"> 
  <img alt="图1 会话层服务原语-单帧" src="https://images2.imgbox.com/ca/9f/1YpEnMhP_o.png"> 
  <figcaption>
    图1 会话层服务原语-单帧 
  </figcaption> 
 </figure> 
</div> 
<p> </p> 
<div style="text-align:center;"> 
 <figure class="image"> 
  <img alt="" src="https://images2.imgbox.com/85/09/5FFJvqES_o.png"> 
  <figcaption>
    图2 会话层服务原语-多帧 
  </figcaption> 
 </figure> 
</div> 
<p> </p> 
<p><strong>会话层协议数据单元(S_PDU)与传输/网络层协议数据单元(T_PDU)的对应关系：</strong></p> 
<div style="text-align:center;"> 
 <figure class="image"> 
  <img alt="" src="https://images2.imgbox.com/cc/9e/3BccYyfM_o.png"> 
  <figcaption>
    图3 S_PDU与T_PDU的对应关系 
  </figcaption> 
 </figure> 
</div> 
<p> </p> 
<p><strong><strong>2.时间参数定义</strong></strong></p> 
<p><strong><strong>2.1 一般应用程序计时注意事项</strong></strong></p> 
<p><strong>服务端（ECU）：</strong>ECU使用单个应用程序计时器P2Server，该计时器由T_Data服务原语接口（T_Data.ind, T_Data.con, T_Data.req）来触发(开始计时，结束计时)。<strong>P2</strong>Server加载P2Server_max/P2*Server_max的值。</p> 
<p><strong>P</strong><strong>2</strong>Server<strong>:</strong> Performance requirement for the server to start with the response message after the receptionof a request message (indicated via T_Data.ind). ECU接收到请求报文到发送响应报文之间的时间；ECU应在该时间内进行响应；推荐50ms。</p> 
<p><br><strong>P4</strong>Server: This is the time between the reception of a request (T_Data.indication) and the start of the transmission of the final response (T_Data.request) at the server side. ECU接收到请求后到最终返回正响应或负响应(除0x78)的时间；P4server定义的是从接收到请求（T_Data.indiaction）到final response(T_Data.request)间的时间；final response指的是正响应或负响应（除了0x78);P4server属于一个性能方面的要求。如果P4server与P2server相同，则意味着，该服务或数据不支持负响应码0x78。</p> 
<p><strong>客户端（Tester）:</strong> Tester使用单个应用程序计时器PClient，该计时器由T_Data服务原语接口（T_Data.ind, T_Data.con, T_DataSOM.ind）来触发(开始、重载、停止)。<strong>P2S</strong>erver加载P2Client_max/P2*Client_max的值。(T_DataSOM.ind: The transport/network layer indication for the reception of a StartOfMessage T_PDU. it is only used within the session layer to perform the session layer timing.)</p> 
<p><strong>P2</strong>Client<strong>:</strong> Timeout for the client to wait after the successful transmission of a request message (indicatedvia T_Data.con) for the start of incoming response messages (indicated via T_DataSOM.ind of a multi-frame message or T_Data.ind of a SingleFrame message). Client发送请求报文后的等待时间, 若该时间内未收到响应则超时。</p> 
<p><strong>P2*</strong>Client<strong>: </strong>Enhanced timeout for the client to wait after the reception of a negative response messagewith negative response code 0x78 (indicated via T_Data.ind) for the start of incomingresponse messages (indicated via T_DataSOM.ind of a multi-frame message or T_Data.indof a SingleFrame message). Client接收到0x78负响应后的等待的时间;若该时间内未收到响应则超时。</p> 
<div style="text-align:center;"> 
 <figure class="image"> 
  <img alt="" src="https://images2.imgbox.com/e1/c3/33bJQskX_o.png"> 
  <figcaption>
    图4 Example for each timing parameter 
  </figcaption> 
 </figure> 
</div> 
<p> </p> 
<p><strong><strong>2.2 非默认会话模式下的会话层时间参数要求</strong></strong></p> 
<p>在非默认诊断会话模式下，还需满足如下会话层时间参数的要求：</p> 
<p><strong>S3</strong>Client: Time between functionally addressed TesterPresent (0x3E) request messages transmitted by the client to keep a diagnostic session other than the defaultSession active inmultiple servers (functional communication) or maximum time between physically transmitted request messages to a single server (physical communication). The S3Client timeout value includes the travel time of the message on the network (gateway delays,etc.). 为使ECU保持非默认会话不退出，Client应在该时间内发送0x3E服务; 推荐2000ms。</p> 
<p><strong>S3</strong>Server: Time for the server to keep a diagnostic session other than the defaultSession active while not receiving any diagnostic requestmessage. The tolerance of S3Server is -0 ms, +200 ms. ECU在该时间内，如果没有接受到<strong>任何诊断请求报文（包括其不支持的服务）</strong>，则退出当前非默认会话。</p> 
<p>ECU在进入某非默认会话时，其应用层参数P2Server、P2*Server可能会改变。ECU会通过DiagnosticSessionControl 服务返回这些参数给Client端. 此时，Client端需要调整其内部时间参数。</p> 
<p>Client应对TesterPresent(0x3E)请求的寻址方式进行区分，Server无需进行区分。此外，一旦接收到诊断请求报文，即使该服务Server不支持，<strong>S3</strong>Server也重新计时。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/63/1c/YObJzLeB_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/00/f3/M9FFENEI_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/bc/ba/tHPPgT6c_o.png"></p> 
<p>                                          图5 Functional communication during non-default session</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cfd16194945c934a69b89519d746cfe6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于vue2.0的活动倒计时组件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6334979a78aa61fd25f34d33e89fe8c2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL Server 行转列，列转行。多行转成一列（含STUFF()函数的用法）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>