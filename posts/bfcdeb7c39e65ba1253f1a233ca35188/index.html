<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pywinauto基础 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pywinauto基础" />
<meta property="og:description" content="本博客仅为个人学习使用，是看大佬视频做的笔记，侵权可联系作者删除~~
pywinauto的安装，在cmd命令行窗口直接输入pip install pywinauto即可 1、通过进程号或句柄连接 from pywinauto.application import Application # 通过pywinauto去连接已经打开的应用程序 # 通过进程号进行连接，可以使用ViewWizard查看进程号等信息 # 通过PID连接，需要先打开程序 # app = Application(&#39;uia&#39;).connect(process=6136) # print(app) # 通过窗口句柄进行连接 # 同样需要先打开程序，然后使用ViewWizard获取句柄，句柄是动态的 app = Application(&#39;uia&#39;).connect(handle=131914) &#39;&#39;&#39; 这个uia，在启动navicat的时候需要，不然报错； 启动文本文件的时候不用，不然找不到弹出的窗口 初步推论：win32(可不填)在自带程序中使用，其他需下载安装等程序使用uia Win32 API（backend=&#34;win32&#34;） - 现在的默认后端 MFC，VB6，VCL，简单的WinForms控件和大多数旧的遗留应用程序,win32 MS UI Automation（backend=&#34;uia&#34;） WinForms，WPF，商店应用，Qt5，浏览器，navicat 注意：Chrome --force-renderer-accessibility在启动前需要cmd标志。 由于comtypes Python库限制，不支持自定义属性和控件。&#39;&#39;&#39; print(app) 2、通过路径打开app并选择窗口 from pywinauto.application import Application # 启动navicat,路径也可以通过ViewWizard工具获取 app = Application(&#39;uia&#39;).start(r&#39;E:\Navicat Premium 15\navicat.exe&#39;) # 方式一 app[类名/标题] # 使用窗口类名来选择窗口 # dlg = app[&#34;TNavicatMainForm&#34;] # 使用窗口标题来选择窗口 dlg = app[&#39;Navicat Premium&#39;] dlg." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bfcdeb7c39e65ba1253f1a233ca35188/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-27T12:26:54+08:00" />
<meta property="article:modified_time" content="2022-05-27T12:26:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pywinauto基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本博客仅为个人学习使用，是看大佬视频做的笔记，侵权可联系作者删除~~</p> 
<h5><a id="pywinautocmdpip_install_pywinauto_1"></a>pywinauto的安装，在cmd命令行窗口直接输入pip install pywinauto即可</h5> 
<h3><a id="1_2"></a>1、通过进程号或句柄连接</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application
<span class="token comment"># 通过pywinauto去连接已经打开的应用程序</span>

<span class="token comment"># 通过进程号进行连接，可以使用ViewWizard查看进程号等信息</span>
<span class="token comment"># 通过PID连接，需要先打开程序</span>
<span class="token comment"># app = Application('uia').connect(process=6136)</span>
<span class="token comment"># print(app)</span>

<span class="token comment"># 通过窗口句柄进行连接</span>
<span class="token comment"># 同样需要先打开程序，然后使用ViewWizard获取句柄，句柄是动态的</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">131914</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
这个uia，在启动navicat的时候需要，不然报错；
启动文本文件的时候不用，不然找不到弹出的窗口
初步推论：win32(可不填)在自带程序中使用，其他需下载安装等程序使用uia

Win32 API（backend="win32"） - 现在的默认后端
    MFC，VB6，VCL，简单的WinForms控件和大多数旧的遗留应用程序,win32
MS UI Automation（backend="uia"）
    WinForms，WPF，商店应用，Qt5，浏览器，navicat
注意：Chrome --force-renderer-accessibility在启动前需要cmd标志。
由于comtypes Python库限制，不支持自定义属性和控件。'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2app_28"></a>2、通过路径打开app并选择窗口</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

<span class="token comment"># 启动navicat,路径也可以通过ViewWizard工具获取</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">r'E:\Navicat Premium 15\navicat.exe'</span><span class="token punctuation">)</span>

<span class="token comment"># 方式一 app[类名/标题]</span>
<span class="token comment"># 使用窗口类名来选择窗口</span>
<span class="token comment"># dlg = app["TNavicatMainForm"]</span>

<span class="token comment"># 使用窗口标题来选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>
dlg<span class="token punctuation">.</span>maximize<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 方式二 app.窗口类名</span>
<span class="token comment"># dlg = app.TNavicatMainForm</span>

<span class="token comment"># 打印窗口中所有的控件</span>
<span class="token comment"># dlg.print_control_identifiers()</span>
</code></pre> 
<h3><a id="3_50"></a>3、选择控件</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

<span class="token comment"># 启动navicat</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">r'D:\tools\Navicat Premium 15\navicat.exe'</span><span class="token punctuation">)</span>

<span class="token comment"># 通过窗口标题选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>
<span class="token comment"># dlg.print_control_identifiers()</span>

<span class="token comment"># 选择控件  ----  选择当前窗口的各级菜单</span>
<span class="token comment"># 方式一</span>
<span class="token comment"># menu = dlg.Menu</span>
<span class="token comment"># print(menu.print_control_identifiers())</span>

<span class="token comment"># 方式二</span>
menu <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">'Menu'</span><span class="token punctuation">]</span>
<span class="token comment"># print(menu.print_control_identifiers())</span>

<span class="token comment"># ------报错------------</span>
<span class="token comment"># file = dlg['Menu']['文件']</span>
<span class="token comment"># print(file.print_control_identifiers())</span>

<span class="token comment"># 方式三</span>
<span class="token comment"># menu下面的中括号显示的是['MenuItem', '文件MenuItem', '文件', 'MenuItem0', 'MenuItem1']</span>
<span class="token comment"># 文件是第一个子菜单,根据菜单名查找就好，不用管中括号里面有几个</span>
<span class="token builtin">file</span> <span class="token operator">=</span>  menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"MenuItem"</span><span class="token punctuation">)</span>
<span class="token builtin">file</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4_81"></a>4、选择菜单项、获取文本等</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

<span class="token comment"># 启动navicat，选择应用程序</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">r'D:\tools\Navicat Premium 15\navicat.exe'</span><span class="token punctuation">)</span>

<span class="token comment"># 通过窗口标题选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>

<span class="token comment"># 选择窗口的菜单</span>
menu <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">'Menu'</span><span class="token punctuation">]</span>

<span class="token comment"># 选择菜单项：文件</span>
<span class="token builtin">file</span> <span class="token operator">=</span> menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">)</span>

<span class="token comment"># 查看控件类型：wrapper_object</span>
<span class="token comment"># print(dlg.wrapper_object())   # Dialog 对话框</span>
<span class="token comment"># print(menu.wrapper_object())  # Menu 菜单</span>
<span class="token comment"># print(file.wrapper_object())  # MenuItem 菜单项</span>

<span class="token comment"># dir 查看对象所支持的方法</span>
<span class="token comment"># print(dir(dlg.wrapper_object()))</span>

<span class="token comment"># 控件的文本内容获取：texts   --- 得到的是列表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 获取子元素：children</span>
<span class="token comment"># print(dlg.children())</span>
<span class="token comment"># 获取菜单的子元素</span>
<span class="token comment"># print(menu.children())</span>
<span class="token comment"># print(file.children())</span>

<span class="token comment"># 获取控件的类名</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>menu<span class="token punctuation">.</span>class_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 获取控件的属性、返回的字典</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>menu<span class="token punctuation">.</span>get_properties<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="5_122"></a>5、截图处理</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

<span class="token comment"># 启动navicat</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">r'E:\Navicat Premium 15\navicat.exe'</span><span class="token punctuation">)</span>

<span class="token comment"># 通过窗口标题选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>

menu <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">'Menu'</span><span class="token punctuation">]</span>
<span class="token comment">#</span>
<span class="token comment"># # 选择菜单项：文件</span>
<span class="token builtin">file</span> <span class="token operator">=</span> menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">)</span>

<span class="token comment"># 截图窗口：</span>
pic <span class="token operator">=</span> dlg<span class="token punctuation">.</span>capture_as_image<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'01.png'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pic<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="6_143"></a>6、菜单的相关操作</h3> 
<pre><code class="prism language-python"><span class="token comment"># 点击菜单项用click_input(),点击按钮可直接用click()</span>
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">r'E:\Navicat Premium 15\navicat.exe'</span><span class="token punctuation">)</span>

dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>

menu <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">'Menu'</span><span class="token punctuation">]</span>

<span class="token builtin">file</span> <span class="token operator">=</span> menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"MenuItem"</span><span class="token punctuation">)</span>
<span class="token comment"># -------菜单控件和相关操作---------------</span>
<span class="token comment"># 获取菜单的子菜单项</span>
<span class="token comment"># print(menu.items())</span>


<span class="token comment"># 通过下标去选择菜单项：item_by_path</span>
<span class="token comment"># m = menu.item_by_index(1)</span>
<span class="token comment"># print(m)</span>


<span class="token comment"># 通过路径去选择菜单项：item_by_path  ，相对路径</span>
<span class="token comment"># m = menu.item_by_path('查看')</span>
<span class="token comment"># print(m)</span>


<span class="token comment"># 通过路径去选择菜单项：item_by_path  ，相对路径</span>
<span class="token comment"># m = menu.item_by_path('文件-&gt;导入连接...')</span>
<span class="token comment"># print(m)</span>


<span class="token comment"># ----- 菜单项的操作方法-----</span>
<span class="token comment"># 获取子菜单项：items</span>
<span class="token comment"># print(file.items())</span>

<span class="token comment"># 点击菜单项的方法：click_input</span>
<span class="token comment"># 注意：先点击文件，然后点击新建连接</span>
<span class="token builtin">file</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
menu<span class="token punctuation">.</span>item_by_path<span class="token punctuation">(</span><span class="token string">'文件-&gt;新建连接'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="7_186"></a>7、等待机制</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">r'E:\Navicat Premium 15\navicat.exe'</span><span class="token punctuation">)</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>
menu <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">'Menu'</span><span class="token punctuation">]</span>
<span class="token comment"># menu.print_control_identifiers()</span>

<span class="token builtin">file</span> <span class="token operator">=</span> menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"MenuItem"</span><span class="token punctuation">)</span>

<span class="token comment"># 点击文件</span>
<span class="token builtin">file</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 点击新建连接</span>
menu<span class="token punctuation">.</span>item_by_path<span class="token punctuation">(</span><span class="token string">'文件-&gt;新建连接'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
等待机制一
wait方法: 等待窗口处于某个状态
参数:
    wait_for :等待的状态(状态有以下几种)
    exists: 表示该窗口是有效的句柄
    visible:表示该窗口未隐藏
    enabled:表示未禁用窗口
    ready:表示该窗口可见并启用
    active:表示该窗口处于活动状态
    timeout : 超时时间
    retry_interval :重试时间间隔
'''</span>

<span class="token comment"># 选择新建连接的窗口</span>
new_dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'新建连接'</span><span class="token punctuation">]</span>

<span class="token comment"># 等待窗口处于可见状态</span>
<span class="token comment"># new_dlg.wait(wait_for="ready", timeout=10, retry_interval=1)</span>
<span class="token comment"># print('等待通过，当前新建连接窗口处于可见状态')</span>

<span class="token triple-quoted-string string">'''
等待机制二
Wait_not方法: 等待窗口不处于某个特定状态
参数:
    wait_for_no :等待的状态(状态有以下几种)
    exists: 表示该窗口是有效的句柄
    visible:表示该窗口未隐藏
    enabled:表示未禁用窗口
    ready :表示该窗口可见并启用
    active:表示该窗口处于活动状态
    timeout : 超时时间
    retry_interval :重试时间间隔
'''</span>

new_dlg<span class="token punctuation">.</span>wait_not<span class="token punctuation">(</span>wait_for_not<span class="token operator">=</span><span class="token string">"ready"</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> retry_interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'等待通过，当前新建连接窗口处于不可见状态'</span><span class="token punctuation">)</span>


<span class="token triple-quoted-string string">'''
等待机制三
wait_cpu_usage_lower 方法
    等待该进程的cup的使用率低于某个阀值
    注意:此方法仅适用于整个应用程序进程，不适用于窗口/元素。
参数:
    threshold :该进程cup占用率
    timeout : 超时时间
    retry_interval :重试时间间隔
'''</span>
app1 <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>process<span class="token operator">=</span><span class="token number">8728</span><span class="token punctuation">)</span>
app1<span class="token punctuation">.</span>wait_cpu_usage_lower<span class="token punctuation">(</span>threshold<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> usage_interval<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'等待通过，当前该进程cpu占用了低于1%'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8timing_258"></a>8、timing相当于显示等待</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>timings <span class="token keyword">import</span> wait_until
<span class="token triple-quoted-string string">'''
timings模块
wait_until方法:
参数:
    Timeout: 超时时间
    retry_interval  重试时间
    func 执行的函数
    value  比较的值
    Op  比较方式函数(默认为相等)
    args   给执行函数传位置参数
    kwargs 给执行函数传关键字参数

'''</span>

<span class="token triple-quoted-string string">'''
全局计时变量值的设置方法
Timings.defaults() :将全局计时设为默认值
Timings.slow() :将所有时间加倍(使脚本执行速度降低约2倍)
Timings.fast(): # 将所有计时除以2 (快2倍) 
'''</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">def</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> i
    i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'当前i的值为:'</span> <span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token keyword">return</span> i

<span class="token comment"># 等待work返回的结果为5，继续往下执行</span>
<span class="token comment"># wait_until(10, 1, work, 5)</span>
<span class="token comment"># print('等待通过')</span>

wait_until<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> work<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'等待超时'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="9_296"></a>9、编辑类控件的基本操作</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>keyboard <span class="token keyword">import</span> send_keys


<span class="token comment"># 选择应用程序</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'win32'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token string">'notepad.exe'</span><span class="token punctuation">)</span>
<span class="token comment"># app = Application('uia').start('notepad.exe')</span>
<span class="token comment"># 不使用uia，因为文本文件是自带程序</span>

<span class="token comment"># 选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'无标题 - 记事本'</span><span class="token punctuation">]</span>
<span class="token comment"># dlg.print_control_identifiers()</span>

<span class="token comment"># 选择窗口中的控件</span>
dlg<span class="token punctuation">[</span><span class="token string">'Edit'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"hello world，哈哈？为什么空格不能显示为什么？？"</span><span class="token punctuation">)</span>

<span class="token comment"># menu.print_control_identifiers()</span>

<span class="token comment"># 为啥不用点击编辑，就可以直接点击替换啊？奇怪</span>
<span class="token comment"># edit_btn = menu.child_window(title="编辑(E)", control_ty pe="MenuItem")</span>
<span class="token comment"># edit_btn.click_input()</span>

<span class="token comment"># 写法二、dlg.menu_select('编辑(E)-&gt;替换(R)')   有时候会不可用</span>
dlg<span class="token punctuation">.</span>menu_select<span class="token punctuation">(</span><span class="token string">'编辑(E)-&gt;替换(R)'</span><span class="token punctuation">)</span>
<span class="token comment"># 写法一、menu.item_by_path('编辑(E)-&gt;替换(R)').click_input()</span>

<span class="token comment"># 切换到替换的窗口</span>
replace <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'替换'</span><span class="token punctuation">]</span>
replace<span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 输入查找内容</span>
replace<span class="token punctuation">[</span><span class="token string">'Edit1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">'哈'</span><span class="token punctuation">)</span>

<span class="token comment"># 输入需要替换的内容</span>
replace<span class="token punctuation">[</span><span class="token string">'Edit2'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">'嗯哼'</span><span class="token punctuation">)</span>

<span class="token comment"># 点击全部替换</span>
replace<span class="token punctuation">[</span><span class="token string">'Button3'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 点击取消按钮</span>
replace<span class="token punctuation">[</span><span class="token string">'Button4'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="10_343"></a>10、模拟键盘操作</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>keyboard <span class="token keyword">import</span> send_keys

<span class="token comment"># send_keys("{F1}")</span>

<span class="token comment"># 通过按键打开cmd，输入python</span>

send_keys<span class="token punctuation">(</span><span class="token string">'{VK_LWIN}cmd{VK_RETURN}{VK_RETURN}'</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">'python'</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">'{VK_RETURN}'</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="11_358"></a>11、键盘修饰符的使用</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>keyboard <span class="token keyword">import</span> send_keys

<span class="token triple-quoted-string string">'''
"+"    --&gt;      按Shift
"^"    --&gt;      按CtrI
"%"   --&gt;      按Alt 
"^s"  --&gt;      按CtrI+S进行保存的操作
'''</span>

send_keys<span class="token punctuation">(</span><span class="token string">'^a'</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">'^c'</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">'^v'</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">'^v'</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">"%+{VK_F10}"</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="12_378"></a>12、模拟鼠标操作</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> mouse

<span class="token comment"># 鼠标单击(默认左键)</span>
<span class="token comment"># 默认button左键点击，coords参数为像素，可用截图查看</span>
<span class="token comment"># mouse.click(button='left',coords=(485, 18))</span>

<span class="token comment"># 鼠标右键</span>
<span class="token comment"># mouse.right_click(coords=(1060, 580))</span>

<span class="token comment"># 鼠标双击(默认双击左键)</span>
<span class="token comment"># mouse.double_click(button='left', coords=(48, 176))</span>

<span class="token comment"># 点击鼠标中键</span>
<span class="token comment"># mouse.wheel_click(coords=(500, 1000))</span>

<span class="token comment"># 按下鼠标(会一直按住，移动鼠标即可实现拖动效果)</span>
<span class="token comment"># mouse.press(coords=(80, 20))</span>
<span class="token comment"># 释放鼠标(位置A按下，位置B释放，即可实现拖动到位置B的效果)</span>
<span class="token comment"># mouse.release(coords=(500, 1000))</span>


<span class="token comment"># 滑动鼠标滚轮(wheel_dist滚轮滚几圈，正数向上滚，负数向下滚)</span>
<span class="token comment"># mouse.scroll(coords=(1000, 500),wheel_dist=3)</span>


<span class="token comment"># 移动鼠标位置--将鼠标移动到某个位置</span>
<span class="token comment"># mouse.move(coords=(0, 0))</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    mouse<span class="token punctuation">.</span>move<span class="token punctuation">(</span>coords<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="13_413"></a>13、系统提示区(右下角任务栏)的操作</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> Application

app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">"uia"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">65722</span><span class="token punctuation">)</span>
<span class="token comment"># 不知道为什么这行报错，跟老师代码一模一样的</span>
app<span class="token punctuation">[</span><span class="token string">"任务栏"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 到任务栏中选择用户提示通知区域，点击QQ</span>
qq <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">"任务栏"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"QQ: 慎\r\n声音: 关闭\r\n消息提醒框: 关闭\r\n会话消息: 任务栏头像闪动"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"Button"</span><span class="token punctuation">)</span>
qq<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="14_427"></a>14、隐藏通知区域的操作</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> Application
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">"uia"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">65722</span><span class="token punctuation">)</span>

task <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">"任务栏"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"通知 V 形"</span><span class="token punctuation">,</span> auto_id<span class="token operator">=</span><span class="token string">"1502"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"Button"</span><span class="token punctuation">)</span>
task<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#选择通知溢出的窗口，然后就可以进行相关的操作</span>
<span class="token comment"># 隐藏区域需要先点击然后对应的窗口才会显示，可以使用inspect.exe工具</span>
app<span class="token punctuation">[</span><span class="token string">"通知溢出"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">[</span><span class="token string">"通知溢出"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"Windows 安全中心"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="15pywinautoselenium_442"></a>15、pywinauto结合selenium实现文件上传</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>keyboard <span class="token keyword">import</span> send_keys
<span class="token keyword">import</span> pywinauto
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'http://XXX.baidu.com/uploadimg?picIdFlag=pic02&amp;category_id=1'</span><span class="token punctuation">)</span>

<span class="token comment"># 点击上传图片按钮</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span><span class="token string">'btnSelect'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 上传图片弹出的窗口需要用pywinauto选择图片</span>
app <span class="token operator">=</span> pywinauto<span class="token punctuation">.</span>Desktop<span class="token punctuation">(</span><span class="token punctuation">)</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">"打开"</span><span class="token punctuation">]</span>
dlg<span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 选中文件地址输入的工具框,</span>
<span class="token comment"># 因为不是输入框不能直接输入，需要通过键盘输入</span>

<span class="token comment"># 输入文件地址</span>
dlg<span class="token punctuation">[</span><span class="token string">'Toolbar3'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">"图片{VK_RETURN}"</span><span class="token punctuation">)</span>

<span class="token comment"># 输入图片名</span>
dlg<span class="token punctuation">[</span><span class="token string">'Edit'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
send_keys<span class="token punctuation">(</span><span class="token string">"壁纸.jpg{VK_RETURN}"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="16pywinauto_473"></a>16、pywinauto实现多文件上传及代码封装</h3> 
<pre><code class="prism language-python"><span class="token comment"># Button类型的就可以直接调用click()</span>
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>keyboard <span class="token keyword">import</span> send_keys
<span class="token keyword">import</span> pywinauto
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'http://XXXX.baidu.com/uploadimg?picIdFlag=pic02&amp;category_id=1'</span><span class="token punctuation">)</span>

<span class="token comment"># 点击上传图片按钮</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'btnSelect'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">upload_img</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># 上传图片弹出的窗口需要用pywinauto选择图片</span>
    app <span class="token operator">=</span> pywinauto<span class="token punctuation">.</span>Desktop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">"打开"</span><span class="token punctuation">]</span>
    dlg<span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 选中文件地址输入的工具框,</span>
    <span class="token comment"># 因为不是输入框不能直接输入，需要通过键盘输入</span>

    <span class="token comment"># 输入文件地址</span>
    dlg<span class="token punctuation">[</span><span class="token string">'Toolbar3'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
    send_keys<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

    <span class="token comment"># 输入图片名</span>
    dlg<span class="token punctuation">[</span><span class="token string">'Edit'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
    dlg<span class="token punctuation">[</span><span class="token string">'Edit'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">file</span><span class="token punctuation">}</span></span><span class="token string">"'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> args<span class="token punctuation">:</span>
        <span class="token comment"># 选择多个文件</span>
        send_keys<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">"'</span></span><span class="token punctuation">)</span>

    dlg<span class="token punctuation">[</span><span class="token string">'打开(&amp;O)'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

upload_img<span class="token punctuation">(</span><span class="token string">"图片{VK_RETURN}"</span><span class="token punctuation">,</span> <span class="token string">"壁纸.jpg"</span><span class="token punctuation">,</span> <span class="token string">"壁纸2.jpg"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="17_navicat_514"></a>17、项目实战之一 ——navicat新建连接</h3> 
<pre><code class="prism language-python"><span class="token comment"># 实现navicat的新建连接功能</span>
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application

<span class="token comment"># app = Application('uia').start(r'E:\Navicat Premium 15\navicat.exe')</span>

<span class="token comment"># 为了不每次都重新打开navicat，运行一次打开新建连接页面后，使用句柄进行连接即可</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">526170</span><span class="token punctuation">)</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>
<span class="token comment"># # 选择菜单栏</span>
menu <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">"Menu"</span><span class="token punctuation">]</span>
<span class="token comment"># menu.print_control_identifiers()</span>
<span class="token comment"># # 点击文件</span>
<span class="token comment"># 不可用  --&gt;  menu['文件'].click_input()</span>
<span class="token builtin">file</span> <span class="token operator">=</span> menu<span class="token punctuation">.</span>MenuItem1
<span class="token builtin">file</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 与上面的方法一样</span>
<span class="token comment"># file = menu.child_window(title="文件", control_type="MenuItem")</span>
<span class="token comment"># file.click_input()</span>


<span class="token comment"># 报错 --- menu.child_window(title="新建连接", control_type="MenuItem").click_input()</span>
<span class="token comment"># # 点击新建连接</span>

menu<span class="token punctuation">.</span>item_by_path<span class="token punctuation">(</span><span class="token string">"文件-&gt;新建连接"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 只是使用这个不行，需要先点击文件，然后点击新建连接，然后点击mysql才行</span>
menu<span class="token punctuation">.</span>item_by_path<span class="token punctuation">(</span><span class="token string">"文件-&gt;新建连接-&gt;MySQL..."</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># =================================================</span>
<span class="token comment"># 填写连接数据</span>
<span class="token comment"># 选择新建连接窗口</span>

<span class="token comment"># dlg.print_control_identifiers()</span>
dlg<span class="token punctuation">[</span><span class="token string">"Pane2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 连接名</span>
dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit5<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"测试新建连接"</span><span class="token punctuation">)</span>
<span class="token comment"># ip输入框</span>
<span class="token comment"># new_dlg["常规"]["Edit1"],报错，此时应该更换.的方式</span>
dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit1<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span>
<span class="token comment"># 端口输入框</span>
dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit4<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"3306"</span><span class="token punctuation">)</span>
<span class="token comment"># 用户名输入框</span>
dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit3<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
<span class="token comment"># 密码输入框</span>
dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit2<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span>

<span class="token comment"># 点击确定按钮,Button类型的就可以直接调用click()</span>
dlg<span class="token punctuation">[</span><span class="token string">"确定"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="18___571"></a>18、项目实战之二 —— 打开连接</h3> 
<pre><code class="prism language-python"><span class="token comment"># 重要：当控件不能点击的时候获取位置进行点击</span>
<span class="token comment"># 实现点击新建成的连接，</span>
<span class="token comment"># 因为该数据库是treeView不可点击的，所以要通过鼠标定位点击</span>
<span class="token keyword">import</span> pywinauto
<span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> mouse

<span class="token comment"># 根据PID选择程序</span>
app <span class="token operator">=</span> pywinauto<span class="token punctuation">.</span>Application<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">"uia"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">131914</span><span class="token punctuation">)</span>

<span class="token comment"># 根据窗口标题选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">"Navicat Premium"</span><span class="token punctuation">]</span>
<span class="token comment"># dlg.print_control_identifiers(depth=3)</span>

<span class="token comment"># 选择树状视图控件</span>
<span class="token comment"># [TVTFilterFrame][TPanel][TNavicatMainForm][#32769]</span>
<span class="token comment"># dlg["TTreeView"].print_control_identifiers()</span>
dlg<span class="token punctuation">[</span><span class="token string">"TPanel"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 点击连接</span>
db_name <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">"TVirtualStringTree"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"测试新建连接"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>
<span class="token comment"># db_name.click()  # 会报错，不可以点击</span>

<span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
mouse<span class="token punctuation">.</span>double_click<span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

</code></pre> 
<h3><a id="19___603"></a>19、项目实战之三 —— 删除连接</h3> 
<pre><code class="prism language-python"><span class="token comment"># 重要：点击后出现的窗口用viewwizard定位时消失的处理方法</span>
<span class="token comment"># 就是通过app.windows()获取当前应用程序的所有窗口定位</span>
<span class="token comment"># 实现点击删除连接，如何定位到该应用程序的其他窗口</span>
<span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> Application
<span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> mouse

<span class="token comment"># 根据PID选择程序</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">"uia"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>process<span class="token operator">=</span><span class="token number">4176</span><span class="token punctuation">)</span>

<span class="token comment"># 根据窗口标题选择窗口</span>
dlg <span class="token operator">=</span> app<span class="token punctuation">[</span><span class="token string">"Navicat Premium"</span><span class="token punctuation">]</span>

<span class="token comment"># 选择树状视图控件</span>
dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 点击连接</span>
db_name <span class="token operator">=</span> dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"测试新建连接"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>
<span class="token comment"># db_name.click()  # 会报错，不可以点击</span>

<span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

<span class="token comment"># 鼠标在控件中心点，右击</span>
mouse<span class="token punctuation">.</span>right_click<span class="token punctuation">(</span>coords<span class="token operator">=</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 获取该应用程序的所有窗口</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>windows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 选择右击出现的上下文窗口</span>
<span class="token comment"># app["上下文"].print_control_identifiers()</span>
<span class="token comment"># 打开连接</span>
<span class="token comment"># app["上下文"]["MenuItem1"].click_input()</span>

<span class="token comment"># 删除连接</span>
app<span class="token punctuation">[</span><span class="token string">"上下文"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"MenuItem5"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 选择删除窗口</span>
app<span class="token punctuation">[</span><span class="token string">"确认删除"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"删除"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="20_648"></a>20、项目实战之代码封装一</h3> 
<pre><code class="prism language-python"><span class="token comment"># 将连接的动作封装起来</span>
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application
<span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> mouse

<span class="token keyword">class</span> <span class="token class-name">NavicatTest</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> precess<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> path<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 为了不每次都重新打开navicat，运行一次打开新建连接页面后，使用句柄进行连接即可</span>
            self<span class="token punctuation">.</span>app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>dlg <span class="token operator">=</span> self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">new_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        menu <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"Menu"</span><span class="token punctuation">]</span>
        <span class="token comment"># 点击文件</span>
        menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 点击新建连接</span>
        menu<span class="token punctuation">.</span>item_by_path<span class="token punctuation">(</span><span class="token string">"文件-&gt;新建连接"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 选择新建连接窗口</span>
        new_dlg <span class="token operator">=</span> self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"新建连接"</span><span class="token punctuation">]</span>

        <span class="token comment"># 连接名</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit5<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"1111"</span><span class="token punctuation">)</span>
        <span class="token comment"># ip输入框</span>
        <span class="token comment"># new_dlg["常规"]["Edit1"],报错，此时应该更换.的方式</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit1<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"1111"</span><span class="token punctuation">)</span>
        <span class="token comment"># 端口输入框</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit4<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"1111"</span><span class="token punctuation">)</span>
        <span class="token comment"># 用户名输入框</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit3<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"1111"</span><span class="token punctuation">)</span>
        <span class="token comment"># 密码输入框</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit2<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span><span class="token string">"1111"</span><span class="token punctuation">)</span>

        <span class="token comment"># 点击确定按钮,Button类型的就可以直接调用click()</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"确定"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">open_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 根据窗口标题选择窗口</span>
        <span class="token comment"># self.dlg = self.app["Navicat Premium"]</span>

        <span class="token comment"># 选择树状视图控件</span>
        self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 点击连接</span>
        db_name <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"测试新建连接"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>
        <span class="token comment"># db_name.click()  # 会报错，不可以点击</span>

        <span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
        rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
        mouse<span class="token punctuation">.</span>double_click<span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">del_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 选择树状视图控件</span>
        self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 点击连接</span>
        db_name <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"测试新建连接"</span><span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>

        <span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
        rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 鼠标在控件中心点，右击</span>
        mouse<span class="token punctuation">.</span>right_click<span class="token punctuation">(</span>coords<span class="token operator">=</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment"># 获取该应用程序的所有窗口</span>
        <span class="token comment"># print(self.app.windows())</span>
        <span class="token comment"># 删除连接</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"上下文"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"MenuItem5"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 选择删除窗口</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"确认删除"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"删除"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>


nav <span class="token operator">=</span> NavicatTest<span class="token punctuation">(</span>precess<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
nav<span class="token punctuation">.</span>new_connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="21_731"></a>21、项目实战之代码封装二</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application
<span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> mouse

<span class="token keyword">class</span> <span class="token class-name">NavicatTest</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> precess<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> path<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 为了不每次都重新打开navicat，运行一次打开新建连接页面后，使用句柄进行连接即可</span>
            self<span class="token punctuation">.</span>app <span class="token operator">=</span> Application<span class="token punctuation">(</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>handle<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>dlg <span class="token operator">=</span> self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">'Navicat Premium'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">new_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> title<span class="token punctuation">,</span> host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''新建连接'''</span>
        menu <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"Menu"</span><span class="token punctuation">]</span>
        <span class="token comment"># 点击文件</span>
        menu<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"文件"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 点击新建连接</span>
        menu<span class="token punctuation">.</span>item_by_path<span class="token punctuation">(</span><span class="token string">"文件-&gt;新建连接"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 选择新建连接窗口</span>
        new_dlg <span class="token operator">=</span> self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"新建连接"</span><span class="token punctuation">]</span>

        <span class="token comment"># 连接名</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit5<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
        <span class="token comment"># ip输入框</span>
        <span class="token comment"># new_dlg["常规"]["Edit1"],报错，此时应该更换.的方式</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit1<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span>host<span class="token punctuation">)</span>
        <span class="token comment"># 端口输入框</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit4<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span>port<span class="token punctuation">)</span>
        <span class="token comment"># 用户名输入框</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit3<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
        <span class="token comment"># 密码输入框</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"常规"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Edit2<span class="token punctuation">.</span>type_keys<span class="token punctuation">(</span>password<span class="token punctuation">)</span>

        <span class="token comment"># 点击确定按钮,Button类型的就可以直接调用click()</span>
        new_dlg<span class="token punctuation">[</span><span class="token string">"确定"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">open_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> db_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''打开连接
        打开连接和打开数据库的方法是一样的，
        参数传数据库即可打开数据库，传连接名即可打开连接'''</span>
        <span class="token comment"># 根据窗口标题选择窗口</span>
        <span class="token comment"># self.dlg = self.app["Navicat Premium"]</span>

        <span class="token comment"># 选择树状视图控件</span>
        self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 点击连接</span>
        db_name <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span>db_name<span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>
        <span class="token comment"># db_name.click()  # 会报错，不可以点击</span>

        <span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
        rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
        mouse<span class="token punctuation">.</span>double_click<span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">del_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''删除连接'''</span>
        <span class="token comment"># 选择树状视图控件</span>
        self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 点击连接</span>
        db_name <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span>title<span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>

        <span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
        rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 鼠标在控件中心点，右击</span>
        mouse<span class="token punctuation">.</span>right_click<span class="token punctuation">(</span>coords<span class="token operator">=</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment"># 获取该应用程序的所有窗口</span>
        <span class="token comment"># print(self.app.windows())</span>
        <span class="token comment"># 删除连接</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"上下文"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"MenuItem5"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 选择删除窗口</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"确认删除"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"删除"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">close_connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''关闭连接
        关闭连接和关闭数据库的方法是一样的，
        参数传数据库即可关闭数据库，传连接名即可关闭连接'''</span>
        <span class="token comment"># 选择树状视图控件</span>
        self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 点击连接</span>
        db_name <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span>title<span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>
        <span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
        rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 鼠标在控件中心点，右击</span>
        mouse<span class="token punctuation">.</span>right_click<span class="token punctuation">(</span>coords<span class="token operator">=</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 获取该应用程序的所有窗口</span>
        <span class="token comment"># print(self.app.windows())</span>
        <span class="token comment"># 关闭连接</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"上下文"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"MenuItem2"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">del_database</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''删除数据库'''</span>
        <span class="token comment"># 选择树状视图控件</span>
        self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>print_control_identifiers<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 点击连接</span>
        db_name <span class="token operator">=</span> self<span class="token punctuation">.</span>dlg<span class="token punctuation">[</span><span class="token string">"TTreeView"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>title<span class="token operator">=</span>title<span class="token punctuation">,</span> control_type<span class="token operator">=</span><span class="token string">"TreeItem"</span><span class="token punctuation">)</span>
        <span class="token comment"># rectangle() 获取控件上下左右的位置;mid_point()获取中心点的位置</span>
        rect <span class="token operator">=</span> db_name<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mid_point<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 鼠标在控件中心点，右击</span>
        mouse<span class="token punctuation">.</span>right_click<span class="token punctuation">(</span>coords<span class="token operator">=</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 获取该应用程序的所有窗口</span>
        <span class="token comment"># print(self.app.windows())</span>
        <span class="token comment"># 删除数据库</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"上下文"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"MenuItem4"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click_input<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 选择删除窗口</span>
        self<span class="token punctuation">.</span>app<span class="token punctuation">[</span><span class="token string">"确认删除"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"删除"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

nav <span class="token operator">=</span> NavicatTest<span class="token punctuation">(</span>precess<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
nav<span class="token punctuation">.</span>new_connect<span class="token punctuation">(</span><span class="token string">'测试连接'</span><span class="token punctuation">,</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token string">'3306'</span><span class="token punctuation">,</span><span class="token string">'root'</span><span class="token punctuation">,</span><span class="token string">'123456'</span><span class="token punctuation">)</span>
nav<span class="token punctuation">.</span>open_connect<span class="token punctuation">(</span><span class="token string">'测试连接'</span><span class="token punctuation">)</span>
nav<span class="token punctuation">.</span>del_connect<span class="token punctuation">(</span><span class="token string">"测试连接"</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/12019e06c8361f2b60b7e9833de19293/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2022年安全员-C证试题及模拟考试</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a619ceec9db53dcc5bcaab6d7367c6f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">超图leaflet临时图层：在子图层中过滤特定属性的要素生成临时地图服务</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>