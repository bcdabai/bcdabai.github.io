<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Linux】Linux中Crontab（定时任务）命令详解及使用教程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Linux】Linux中Crontab（定时任务）命令详解及使用教程" />
<meta property="og:description" content="文章目录 前言1.使用yum命令安装Crontab：2.查看Crontab状态：3.添加定时任务：4.查看任务列表：5.Crontab相关命令：6.部分脚本无法执行问题：7.Crontab默认调度任务：8.注意清理系统用户的邮件日志：9.Crontab日志路径：10.Crontab命令在线验证工具： 前言 Crontab介绍：
Linux crontab是用来crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中，以供之后读取和执行。该词来源于希腊语 chronos(χρ?νο?)，原意是时间。通常，crontab储存的指令被守护进程激活， crond常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为cron jobs。当安装完成操作系统之后，默认便会启动此任务调度命令。crond 命令每分锺会定期检查是否有要执行的工作，如果有要执行的工作便会自动执行该工作。
注意：新创建的 cron 任务，不会马上执行，至少要过 2 分钟后才可以，当然你可以重启 cron 来马上执行。
1.使用yum命令安装Crontab： yum install vixie-cron yum install crontabs 注：vixie-cron软件包是cron的主程序； crontabs软件包是用来安装、卸装、或列举用来驱动 cron 守护进程的表格的程序。 cron是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务： /sbin/service crond start #启动服务 /sbin/service crond stop #关闭服务 /sbin/service crond restart #重启服务 /sbin/service crond reload #重新载入配置 2.查看Crontab状态： service crond status ntsysv #查看crontab服务是否已设置为开机启动 chkconfig –level 35 crond on #加入开机自动启动 3.添加定时任务： crontab -e #编辑cron任务模式 i #默认文字编辑器为vim，按i字母键即可添加cron任务 30 3 * * * /usr/local/etc/rc.d/lighttpd restart #将命令代码放入，此命令意义为每天的03:30 重启apache ESC #按ESC键退出编辑模式 :wq #键入:wq保存 service crond restart #重启crontab服务 4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/af25234980e02252c3d572d193581c1e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-24T21:17:45+08:00" />
<meta property="article:modified_time" content="2023-10-24T21:17:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Linux】Linux中Crontab（定时任务）命令详解及使用教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#1yumCrontab_8" rel="nofollow">1.使用yum命令安装Crontab：</a></li><li><a href="#2Crontab_22" rel="nofollow">2.查看Crontab状态：</a></li><li><a href="#3_32" rel="nofollow">3.添加定时任务：</a></li><li><a href="#4_44" rel="nofollow">4.查看任务列表：</a></li><li><a href="#5Crontab_50" rel="nofollow">5.Crontab相关命令：</a></li><li><a href="#6_93" rel="nofollow">6.部分脚本无法执行问题：</a></li><li><a href="#7Crontab_107" rel="nofollow">7.Crontab默认调度任务：</a></li><li><a href="#8_118" rel="nofollow">8.注意清理系统用户的邮件日志：</a></li><li><a href="#9Crontab_128" rel="nofollow">9.Crontab日志路径：</a></li><li><a href="#10Crontab_131" rel="nofollow">10.Crontab命令在线验证工具：</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>前言</h2> 
<p>Crontab介绍：<br> Linux crontab是用来crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将其存放于“crontab”文件中，以供之后读取和执行。该词来源于希腊语 chronos(χρ?νο?)，原意是时间。通常，crontab储存的指令被守护进程激活， crond常常在后台运行，每一分钟检查是否有预定的作业需要执行。这类作业一般称为cron jobs。当安装完成操作系统之后，默认便会启动此任务调度命令。crond 命令每分锺会定期检查是否有要执行的工作，如果有要执行的工作便会自动执行该工作。</p> 
<p>注意：新创建的 cron 任务，不会马上执行，至少要过 2 分钟后才可以，当然你可以重启 cron 来马上执行。</p> 
<h2><a id="1yumCrontab_8"></a>1.使用yum命令安装Crontab：</h2> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> vixie-cron 
yum <span class="token function">install</span> crontabs
注：vixie-cron软件包是cron的主程序；
crontabs软件包是用来安装、卸装、或列举用来驱动 <span class="token function">cron</span> 守护进程的表格的程序。
cron是linux的内置服务，但它不自动起来，可以用以下的方法启动、关闭这个服务：
/sbin/service crond start <span class="token comment">#启动服务</span>
/sbin/service crond stop <span class="token comment">#关闭服务</span>
/sbin/service crond restart <span class="token comment">#重启服务</span>
/sbin/service crond reload <span class="token comment">#重新载入配置</span>
</code></pre> 
<h2><a id="2Crontab_22"></a>2.查看Crontab状态：</h2> 
<pre><code class="prism language-bash"><span class="token function">service</span> crond status
ntsysv <span class="token comment">#查看crontab服务是否已设置为开机启动</span>
<span class="token function">chkconfig</span> –level <span class="token number">35</span> crond on <span class="token comment">#加入开机自动启动</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ed/23/4h6oRELz_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_32"></a>3.添加定时任务：</h2> 
<pre><code class="prism language-bash"><span class="token function">crontab</span> <span class="token parameter variable">-e</span> <span class="token comment">#编辑cron任务模式</span>
i <span class="token comment">#默认文字编辑器为vim，按i字母键即可添加cron任务</span>
<span class="token number">30</span> <span class="token number">3</span> * * * /usr/local/etc/rc.d/lighttpd restart <span class="token comment">#将命令代码放入，此命令意义为每天的03:30 重启apache</span>
ESC <span class="token comment">#按ESC键退出编辑模式</span>
:wq <span class="token comment">#键入:wq保存</span>
<span class="token function">service</span> crond restart <span class="token comment">#重启crontab服务</span>
</code></pre> 
<h2><a id="4_44"></a>4.查看任务列表：</h2> 
<pre><code class="prism language-bash"><span class="token function">crontab</span> <span class="token parameter variable">-l</span>
</code></pre> 
<h2><a id="5Crontab_50"></a>5.Crontab相关命令：</h2> 
<pre><code class="prism language-bash"><span class="token comment">## （1）语法：</span>
<span class="token function">crontab</span> <span class="token punctuation">[</span>-u <span class="token operator">&lt;</span>用户名称<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>配置文件<span class="token punctuation">]</span> 或 <span class="token function">crontab</span> <span class="token punctuation">{<!-- --></span> <span class="token parameter variable">-l</span> <span class="token operator">|</span> <span class="token parameter variable">-r</span> <span class="token operator">|</span> <span class="token parameter variable">-e</span> <span class="token punctuation">}</span>
<span class="token parameter variable">-u</span>   <span class="token comment">#&lt;用户名称&gt; 是指设定指定&lt;用户名称&gt;的定时任务，这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表。如果不使用 -u user 的话，就是表示设定自己的定时任务。</span>
<span class="token parameter variable">-l</span> 　<span class="token comment">#列出该用户的定时任务设置。</span>
<span class="token parameter variable">-r</span> 　<span class="token comment">#删除该用户的定时任务设置。</span>
<span class="token parameter variable">-e</span> 　<span class="token comment">#编辑该用户的定时任务设置。</span>
 
<span class="token comment">## （2）命令时间格式 :</span>
*     * 　  *　  *　  *　　<span class="token builtin class-name">command</span>
分　  时　  日　  月　 周　  命令
第1列表示分钟1～59 每分钟用*或者 */1表示
第2列表示小时1～23（0表示0点）
第3列表示日期1～31
第4列表示月份1～12
第5列标识号星期0～6（0表示星期天）
第6列要运行的命令
 
<span class="token comment">## （3）一些Crontab定时任务例子：</span>
<span class="token number">30</span> <span class="token number">21</span> * * * /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每晚的21:30 重启apache</span>
<span class="token number">45</span> <span class="token number">4</span> <span class="token number">1,10</span>,22 * * /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每月1、10、22日的4 : 45重启apache</span>
<span class="token number">10</span> <span class="token number">1</span> * * <span class="token number">6,0</span> /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每周六、周日的1 : 10重启apache</span>
<span class="token number">0,30</span> <span class="token number">18</span>-23 * * * /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每天18 : 00至23 : 00之间每隔30分钟重启apache</span>
<span class="token number">0</span> <span class="token number">23</span> * * <span class="token number">6</span> /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每星期六的11 : 00 pm重启apache</span>
* <span class="token number">23</span>-7/1 * * * /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#晚上11点到早上7点之间，每隔一小时重启apache</span>
* */1 * * * /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每一小时重启apache</span>
<span class="token number">0</span> <span class="token number">11</span> <span class="token number">4</span> * mon-wed /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#每月的4号与每周一到周三的11点重启apache</span>
<span class="token number">0</span> <span class="token number">4</span> <span class="token number">1</span> jan * /usr/local/etc/rc.d/lighttpd restart  <span class="token comment">#一月一号的4点重启apache</span>
 
*/30 * * * * /usr/sbin/ntpdate cn.pool.ntp.org  <span class="token comment">#每半小时同步一下时间</span>
<span class="token number">0</span> */2 * * * /sbin/service httpd restart  <span class="token comment">#每两个小时重启一次apache </span>
<span class="token number">50</span> <span class="token number">7</span> * * * /sbin/service sshd start  <span class="token comment">#每天7：50开启ssh服务 </span>
<span class="token number">50</span> <span class="token number">22</span> * * * /sbin/service sshd stop  <span class="token comment">#每天22：50关闭ssh服务 </span>
<span class="token number">0</span> <span class="token number">0</span> <span class="token number">1,15</span> * * <span class="token function">fsck</span> /home  <span class="token comment">#每月1号和15号检查/home 磁盘 </span>
<span class="token number">1</span> * * * * /home/bruce/backup  <span class="token comment">#每小时的第一分执行 /home/bruce/backup这个文件 </span>
00 03 * * <span class="token number">1</span>-5 <span class="token function">find</span> /home <span class="token string">"*.xxx"</span> <span class="token parameter variable">-mtime</span> +4 <span class="token parameter variable">-exec</span> <span class="token function">rm</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token punctuation">\</span><span class="token punctuation">;</span>  <span class="token comment">#每周一至周五3点钟，在目录/home中，查找文件名为*.xxx的文件，并删除4天前的文件。</span>
<span class="token number">30</span> <span class="token number">6</span> */10 * * <span class="token function">ls</span>  <span class="token comment">#每月的1、11、21、31日是的6：30执行一次ls命令</span>
</code></pre> 
<h2><a id="6_93"></a>6.部分脚本无法执行问题：</h2> 
<p>如果我们使用 crontab 来定时执行脚本，无法执行，但是如果直接通过命令（如：./test.sh)又可以正常执行，这主要是因为无法读取环境变量的原因。<br> 解决方法：<br> （1）所有命令需要写成绝对路径形式，如: <code>/usr/local/bin/docker。</code><br> （2）在 shell 脚本开头使用以下代码：</p> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/sh</span>
 
<span class="token builtin class-name">.</span> /etc/profile
<span class="token builtin class-name">.</span> ~/.bash_profile
</code></pre> 
<h2><a id="7Crontab_107"></a>7.Crontab默认调度任务：</h2> 
<p>cron默认配置了调度任务，分别为：hourly、daily、weekly、mouthly，默认配置文件为/etc/anacrontab<br> 将需要执行的脚本放到相应的目录下即可，目录分别为：</p> 
<pre><code class="prism language-bash">/etc/cron.hourly
/etc/cron.daily
/etc/cron.weekly
/ect/cron.mouthly
</code></pre> 
<h2><a id="8_118"></a>8.注意清理系统用户的邮件日志：</h2> 
<p>每条任务调度执行完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行，因此，将每条任务进行重定向处理非常重要。<br> 例如，可以在crontab文件中设置如下形式，忽略日志输出：</p> 
<pre><code class="prism language-bash"><span class="token number">0</span> */3 * * * /usr/local/apache2/apachectl restart <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
</code></pre> 
<p>“/dev/null 2&gt;&amp;1”表示先将标准输出重定向到/dev/null，然后将标准错误重定向到标准输出，由于标准输出已经重定向到了/dev/null，因此标准错误也会重定向到/dev/null，这样日志输出问题就解决了。</p> 
<h2><a id="9Crontab_128"></a>9.Crontab日志路径：</h2> 
<p><code>ll /var/log/cron* #/var/log/cron</code>只会记录是否执行了某些计划的脚本，但是具体执行是否正确以及脚本执行过程中的一些信息则linux会每次都发邮件到该用户下。</p> 
<h2><a id="10Crontab_131"></a>10.Crontab命令在线验证工具：</h2> 
<p>crontab执行时间计算 - 在线工具<br> <img src="https://images2.imgbox.com/f8/d2/AfRd3Oug_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5da36ee6563109224d252453425e00da/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【鸿蒙软件开发】ArkTS基础组件之DataPanel(数据面板)、DatePicker(日期选择)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3b8aa57935ec77c4d24825cf0fbd4c42/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【equals, hashCode, compareTo对比分析】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>