<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【VMware环境下Linux磁盘空间（LVM）扩容方法】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【VMware环境下Linux磁盘空间（LVM）扩容方法】" />
<meta property="og:description" content="VMware环境下Linux磁盘空间（LVM）扩容方法 引言环境目标步骤检查磁盘VMware扩展磁盘空间创建分区配置LVM 引言 最近在安装Oracle ASM的过程中，解压文件被迫终止，提示可用空间不足。下面简单描述磁盘扩容的步骤。
环境 环境：VMware Workstation 16 PRO下的虚拟机系统：Oracle Linux Server 7.9 （Redhat 7系列可参考）内核：Linux 5.4.17-2102.201.3.el7uek.x86_64文件系统类型：LVM [root@oracle19c-asm ~]# lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT sdb 8:16 0 40G 0 disk sdc 8:32 0 40G 0 disk sda 8:0 0 20G 0 disk ├─sda2 8:2 0 19G 0 part │ ├─ol-swap 252:1 0 2G 0 lvm [SWAP] │ └─ol-root 252:0 0 17G 0 lvm / # 根目录挂载点为LVM └─sda1 8:1 0 1G 0 part /boot 目标 安装系统时分配磁盘空间共20G，采用默认分区配置，根目录分到19G空间。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/976b45b7f151f00759c4dd6266651b0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-08T22:54:18+08:00" />
<meta property="article:modified_time" content="2022-11-08T22:54:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【VMware环境下Linux磁盘空间（LVM）扩容方法】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>VMware环境下Linux磁盘空间（LVM）扩容方法</h4> 
 <ul><li><a href="#_2" rel="nofollow">引言</a></li><li><a href="#_6" rel="nofollow">环境</a></li><li><a href="#_24" rel="nofollow">目标</a></li><li><a href="#_42" rel="nofollow">步骤</a></li><li><ul><li><a href="#_43" rel="nofollow">检查磁盘</a></li><li><a href="#VMware_49" rel="nofollow">VMware扩展磁盘空间</a></li><li><a href="#_68" rel="nofollow">创建分区</a></li><li><a href="#LVM_166" rel="nofollow">配置LVM</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>引言</h2> 
<p>最近在安装Oracle ASM的过程中，解压文件被迫终止，提示可用空间不足。下面简单描述磁盘扩容的步骤。</p> 
<h2><a id="_6"></a>环境</h2> 
<ol><li><strong>环境</strong>：VMware Workstation 16 PRO下的虚拟机</li><li><strong>系统</strong>：Oracle Linux Server 7.9 （Redhat 7系列可参考）</li><li><strong>内核</strong>：Linux 5.4.17-2102.201.3.el7uek.x86_64</li><li><strong>文件系统类型</strong>：LVM</li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># lsblk
<span class="token constant">NAME</span>        <span class="token constant">MAJ</span><span class="token operator">:</span><span class="token constant">MIN</span> <span class="token constant">RM</span>  <span class="token constant">SIZE</span> <span class="token constant">RO</span> <span class="token constant">TYPE</span> <span class="token constant">MOUNTPOINT</span>
sdb           <span class="token number">8</span><span class="token operator">:</span><span class="token number">16</span>   <span class="token number">0</span>   40G  <span class="token number">0</span> disk 
sdc           <span class="token number">8</span><span class="token operator">:</span><span class="token number">32</span>   <span class="token number">0</span>   40G  <span class="token number">0</span> disk 
sda           <span class="token number">8</span><span class="token operator">:</span><span class="token number">0</span>    <span class="token number">0</span>   20G  <span class="token number">0</span> disk 
├─sda2        <span class="token number">8</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token number">0</span>   19G  <span class="token number">0</span> part 
│ ├─ol<span class="token operator">-</span>swap <span class="token number">252</span><span class="token operator">:</span><span class="token number">1</span>    <span class="token number">0</span>    2G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span><span class="token constant">SWAP</span><span class="token punctuation">]</span>
│ └─ol<span class="token operator">-</span>root <span class="token number">252</span><span class="token operator">:</span><span class="token number">0</span>    <span class="token number">0</span>   17G  <span class="token number">0</span> lvm  <span class="token operator">/</span>   # 根目录挂载点为<span class="token constant">LVM</span>
└─sda1        <span class="token number">8</span><span class="token operator">:</span><span class="token number">1</span>    <span class="token number">0</span>    1G  <span class="token number">0</span> part <span class="token operator">/</span>boot
</code></pre> 
<h2><a id="_24"></a>目标</h2> 
<p>安装系统时分配磁盘空间共20G，采用默认分区配置，根目录分到19G空间。<br> 现将磁盘扩容至30G，可用空间全部分配给根目录。</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># df <span class="token operator">-</span><span class="token constant">H</span>
Filesystem           Size  Used Avail Use<span class="token operator">%</span> Mounted on
devtmpfs             <span class="token number">1</span><span class="token punctuation">.</span>9G     <span class="token number">0</span>  <span class="token number">1</span><span class="token punctuation">.</span>9G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G     <span class="token number">0</span>  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev<span class="token operator">/</span>shm
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G   11M  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G     <span class="token number">0</span>  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>sys<span class="token operator">/</span>fs<span class="token operator">/</span>cgroup
<span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>root   19G   18G  416M  <span class="token number">98</span><span class="token operator">%</span> <span class="token operator">/</span>  # 根目录空间不足
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1            <span class="token number">1</span><span class="token punctuation">.</span>1G  245M  819M  <span class="token number">23</span><span class="token operator">%</span> <span class="token operator">/</span>boot
tmpfs                383M   37k  383M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>user<span class="token operator">/</span><span class="token number">0</span>
Server<span class="token punctuation">.</span>x86_64
</code></pre> 
<blockquote> 
 <p>LVM是 Logical Volume Manager(逻辑卷管理)的简写，LVM将若干个磁盘或者磁盘分区连接为一个整块的卷组，形成一个存储池。管理员可以在卷组上任意创建逻辑卷，并进一步在逻辑卷上创建文件系统。管理员通过LVM可以方便的调整存储卷组的大小，并且可以对磁盘存储按照组的方式进行命名、管理和分配。</p> 
</blockquote> 
<h2><a id="_42"></a>步骤</h2> 
<h3><a id="_43"></a>检查磁盘</h3> 
<p>用 <em>root</em> 用户登录，使用 <em>df -H</em> 检查磁盘使用情况，如上图所示，根目录使用了98%了，急需扩容。<br> 使用lsblk检查所有磁盘情况，以及挂载类型。</p> 
<blockquote> 
 <p>sdb和sdc为新磁盘，大小为40G，理论上可用此空间去扩容根目录，因后期需要另作它用，所以本次实验不使用sdb和sdc，而是直接扩容sda。<br> 检查根目录挂载类型为lvm。</p> 
</blockquote> 
<h3><a id="VMware_49"></a>VMware扩展磁盘空间</h3> 
<ol><li><strong>关闭虚拟机</strong></li><li><strong>VMware扩展磁盘空间</strong><br> <img src="https://images2.imgbox.com/2e/ca/rETh4L4l_o.jpg" alt="请添加图片描述"><br> 因为是先操作后截图，导致图中硬盘原始大小为30G，请忽略该细节问题。</li><li><strong>开启虚拟机</strong></li><li><strong>检查扩容情况</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># lsblk 
<span class="token constant">NAME</span>        <span class="token constant">MAJ</span><span class="token operator">:</span><span class="token constant">MIN</span> <span class="token constant">RM</span>  <span class="token constant">SIZE</span> <span class="token constant">RO</span> <span class="token constant">TYPE</span> <span class="token constant">MOUNTPOINT</span>
sdb           <span class="token number">8</span><span class="token operator">:</span><span class="token number">16</span>   <span class="token number">0</span>   40G  <span class="token number">0</span> disk 
sdc           <span class="token number">8</span><span class="token operator">:</span><span class="token number">32</span>   <span class="token number">0</span>   40G  <span class="token number">0</span> disk 
sda           <span class="token number">8</span><span class="token operator">:</span><span class="token number">0</span>    <span class="token number">0</span>   30G  <span class="token number">0</span> disk  # 由原来的20G变为扩容后的30G
├─sda2        <span class="token number">8</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token number">0</span>   19G  <span class="token number">0</span> part 
│ ├─ol<span class="token operator">-</span>swap <span class="token number">252</span><span class="token operator">:</span><span class="token number">1</span>    <span class="token number">0</span>    2G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span><span class="token constant">SWAP</span><span class="token punctuation">]</span>
│ └─ol<span class="token operator">-</span>root <span class="token number">252</span><span class="token operator">:</span><span class="token number">0</span>    <span class="token number">0</span>   17G  <span class="token number">0</span> lvm  <span class="token operator">/</span>
└─sda1        <span class="token number">8</span><span class="token operator">:</span><span class="token number">1</span>    <span class="token number">0</span>    1G  <span class="token number">0</span> part <span class="token operator">/</span>boot
</code></pre> 
<p>此时sda磁盘总容量为30G，说明扩容成功。</p> 
<h3><a id="_68"></a>创建分区</h3> 
<ol><li>如上图所示，sda共30G，其中sda1和sda2共20G，<strong>还有10G未显示</strong>。</li><li><strong>查看磁盘分区类型</strong>，使用命令 <em>prarted /dev/xxx print</em></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># parted <span class="token operator">/</span>dev<span class="token operator">/</span>sda print
<span class="token literal-property property">Model</span><span class="token operator">:</span> VMware<span class="token punctuation">,</span> VMware Virtual <span class="token constant">S</span> <span class="token punctuation">(</span>scsi<span class="token punctuation">)</span>
Disk <span class="token operator">/</span>dev<span class="token operator">/</span>sda<span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">.</span>2GB
Sector <span class="token function">size</span> <span class="token punctuation">(</span>logical<span class="token operator">/</span>physical<span class="token punctuation">)</span><span class="token operator">:</span> 512B<span class="token operator">/</span>512B
Partition Table<span class="token operator">:</span> msdos
Disk Flags<span class="token operator">:</span> 

Number  Start   End     Size    Type     File system  Flags
 <span class="token number">1</span>      1049kB  1075MB  1074MB  primary  xfs          boot
 <span class="token number">2</span>      1075MB  <span class="token number">21</span><span class="token punctuation">.</span>5GB  <span class="token number">20</span><span class="token punctuation">.</span>4GB  primary               lvm
</code></pre> 
<blockquote> 
 <p>其中Partition Table: msdos显示我们用的MBR分区，后续我们使用fdisk去操作。如果是gpt，则为GPT分区，则应该使用gdisk分区。这个细节问题很多人都没提，主义不要搞错，否则会导致分区失败。</p> 
</blockquote> 
<ol start="3"><li><strong>使用命令 <em>fdisk -l</em> 查看磁盘情况</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># fdisk <span class="token operator">-</span>l

Disk <span class="token operator">/</span>dev<span class="token operator">/</span>sda<span class="token operator">:</span> <span class="token number">32.2</span> <span class="token constant">GB</span><span class="token punctuation">,</span> <span class="token number">32212254720</span> bytes<span class="token punctuation">,</span> <span class="token number">62914560</span> sectors
Units <span class="token operator">=</span> sectors <span class="token keyword">of</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector <span class="token function">size</span> <span class="token punctuation">(</span>logical<span class="token operator">/</span>physical<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span> <span class="token function">size</span> <span class="token punctuation">(</span>minimum<span class="token operator">/</span>optimal<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
Disk label type<span class="token operator">:</span> dos
Disk identifier<span class="token operator">:</span> <span class="token number">0x000d3163</span>

   Device Boot      Start         End      Blocks   Id  System
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1   <span class="token operator">*</span>        <span class="token number">2048</span>     <span class="token number">2099199</span>     <span class="token number">1048576</span>   <span class="token number">83</span>  Linux
<span class="token operator">/</span>dev<span class="token operator">/</span>sda2         <span class="token number">2099200</span>    <span class="token number">41943039</span>    <span class="token number">19921920</span>   8e  Linux <span class="token constant">LVM</span>

Disk <span class="token operator">/</span>dev<span class="token operator">/</span>sdb<span class="token operator">:</span> <span class="token number">42.9</span> <span class="token constant">GB</span><span class="token punctuation">,</span> <span class="token number">42949672960</span> bytes<span class="token punctuation">,</span> <span class="token number">83886080</span> sectors
Units <span class="token operator">=</span> sectors <span class="token keyword">of</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector <span class="token function">size</span> <span class="token punctuation">(</span>logical<span class="token operator">/</span>physical<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span> <span class="token function">size</span> <span class="token punctuation">(</span>minimum<span class="token operator">/</span>optimal<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes


Disk <span class="token operator">/</span>dev<span class="token operator">/</span>sdc<span class="token operator">:</span> <span class="token number">42.9</span> <span class="token constant">GB</span><span class="token punctuation">,</span> <span class="token number">42949672960</span> bytes<span class="token punctuation">,</span> <span class="token number">83886080</span> sectors
Units <span class="token operator">=</span> sectors <span class="token keyword">of</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector <span class="token function">size</span> <span class="token punctuation">(</span>logical<span class="token operator">/</span>physical<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span> <span class="token function">size</span> <span class="token punctuation">(</span>minimum<span class="token operator">/</span>optimal<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes


Disk <span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>root<span class="token operator">:</span> <span class="token number">18.2</span> <span class="token constant">GB</span><span class="token punctuation">,</span> <span class="token number">18249416704</span> bytes<span class="token punctuation">,</span> <span class="token number">35643392</span> sectors
Units <span class="token operator">=</span> sectors <span class="token keyword">of</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector <span class="token function">size</span> <span class="token punctuation">(</span>logical<span class="token operator">/</span>physical<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span> <span class="token function">size</span> <span class="token punctuation">(</span>minimum<span class="token operator">/</span>optimal<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes


Disk <span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>swap<span class="token operator">:</span> <span class="token number">2147</span> <span class="token constant">MB</span><span class="token punctuation">,</span> <span class="token number">2147483648</span> bytes<span class="token punctuation">,</span> <span class="token number">4194304</span> sectors
Units <span class="token operator">=</span> sectors <span class="token keyword">of</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector <span class="token function">size</span> <span class="token punctuation">(</span>logical<span class="token operator">/</span>physical<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span> <span class="token function">size</span> <span class="token punctuation">(</span>minimum<span class="token operator">/</span>optimal<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">512</span> bytes <span class="token operator">/</span> <span class="token number">512</span> bytes
</code></pre> 
<blockquote> 
 <p>为便于全面理解，我尽可能多贴代码，对排版上造成的影响，还请大家理解。<br> 关注sda：sda1和sda2共约21G（1048576 + 19921920），而sda总大小32.2G，因此可以判断该磁盘有剩余空间，接下来的流程会使用到该剩余空间。</p> 
</blockquote> 
<blockquote> 
 <p>也会有人问我们分配的不是总大小30G，而为啥到这个界面就是32.2G了，这主要是因为两种计算方式不一致，程序按照1024M=1G计算，而计算机按照1000M=1G，因此会产生一定误差，比如生活中常见的U盘，实际容量会小于标注容量。</p> 
</blockquote> 
<blockquote> 
 <p>关于sdb和sdc，没有分区，所以不显示Device等信息。</p> 
</blockquote> 
<ol start="3"><li><strong>将未分配的磁盘空间划分为新区</strong>，由前面内容可判断应该使用 <em>fdisk</em> 命令。</li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># fdisk <span class="token operator">/</span>dev<span class="token operator">/</span>sda
Welcome to <span class="token function">fdisk</span> <span class="token punctuation">(</span>util<span class="token operator">-</span>linux <span class="token number">2.23</span><span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>

Changes will remain <span class="token keyword">in</span> memory only<span class="token punctuation">,</span> until you decide to write them<span class="token punctuation">.</span>
Be careful before using the write command<span class="token punctuation">.</span>


<span class="token function">Command</span> <span class="token punctuation">(</span>m <span class="token keyword">for</span> help<span class="token punctuation">)</span><span class="token operator">:</span> n  # n代表新建分区，m可以列出帮助文档
Partition type<span class="token operator">:</span>
   p   <span class="token function">primary</span> <span class="token punctuation">(</span><span class="token number">2</span> primary<span class="token punctuation">,</span> <span class="token number">0</span> extended<span class="token punctuation">,</span> <span class="token number">2</span> free<span class="token punctuation">)</span>
   e   extended
<span class="token function">Select</span> <span class="token punctuation">(</span><span class="token keyword">default</span> p<span class="token punctuation">)</span><span class="token operator">:</span> p  # 选择<span class="token constant">P</span>，新建主分区
Partition <span class="token function">number</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token keyword">default</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">:</span>   # 编号为<span class="token number">3</span>，默认即可
First <span class="token function">sector</span> <span class="token punctuation">(</span><span class="token number">41943040</span><span class="token operator">-</span><span class="token number">62914559</span><span class="token punctuation">,</span> <span class="token keyword">default</span> <span class="token number">41943040</span><span class="token punctuation">)</span><span class="token operator">:</span>   # 开始扇区 默认即可
Using <span class="token keyword">default</span> value <span class="token number">41943040</span>
Last sector<span class="token punctuation">,</span> <span class="token operator">+</span>sectors or <span class="token operator">+</span>size<span class="token punctuation">{<!-- --></span><span class="token constant">K</span><span class="token punctuation">,</span><span class="token constant">M</span><span class="token punctuation">,</span><span class="token constant">G</span><span class="token punctuation">}</span> <span class="token punctuation">(</span><span class="token number">41943040</span><span class="token operator">-</span><span class="token number">62914559</span><span class="token punctuation">,</span> <span class="token keyword">default</span> <span class="token number">62914559</span><span class="token punctuation">)</span><span class="token operator">:</span>   # 结束扇区，可根据提示调整，我默认分配整个剩余扇区，直接回车
Using <span class="token keyword">default</span> value <span class="token number">62914559</span>
Partition <span class="token number">3</span> <span class="token keyword">of</span> type Linux and <span class="token keyword">of</span> size <span class="token number">10</span> GiB is <span class="token keyword">set</span>

<span class="token function">Command</span> <span class="token punctuation">(</span>m <span class="token keyword">for</span> help<span class="token punctuation">)</span><span class="token operator">:</span> #然后输入w代表保存，q代表退出
</code></pre> 
<ol start="4"><li><strong>检查分区情况</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># lsblk 
<span class="token constant">NAME</span>        <span class="token constant">MAJ</span><span class="token operator">:</span><span class="token constant">MIN</span> <span class="token constant">RM</span>  <span class="token constant">SIZE</span> <span class="token constant">RO</span> <span class="token constant">TYPE</span> <span class="token constant">MOUNTPOINT</span>
sdb           <span class="token number">8</span><span class="token operator">:</span><span class="token number">16</span>   <span class="token number">0</span>   40G  <span class="token number">0</span> disk 
sdc           <span class="token number">8</span><span class="token operator">:</span><span class="token number">32</span>   <span class="token number">0</span>   40G  <span class="token number">0</span> disk 
sda           <span class="token number">8</span><span class="token operator">:</span><span class="token number">0</span>    <span class="token number">0</span>   30G  <span class="token number">0</span> disk 
├─sda2        <span class="token number">8</span><span class="token operator">:</span><span class="token number">2</span>    <span class="token number">0</span>   19G  <span class="token number">0</span> part 
│ ├─ol<span class="token operator">-</span>swap <span class="token number">252</span><span class="token operator">:</span><span class="token number">1</span>    <span class="token number">0</span>    2G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span><span class="token constant">SWAP</span><span class="token punctuation">]</span>
│ └─ol<span class="token operator">-</span>root <span class="token number">252</span><span class="token operator">:</span><span class="token number">0</span>    <span class="token number">0</span>   17G  <span class="token number">0</span> lvm  <span class="token operator">/</span>
├─sda3        <span class="token number">8</span><span class="token operator">:</span><span class="token number">3</span>    <span class="token number">0</span>   10G  <span class="token number">0</span> part   # 新增sda3分区
└─sda1        <span class="token number">8</span><span class="token operator">:</span><span class="token number">1</span>    <span class="token number">0</span>    1G  <span class="token number">0</span> part <span class="token operator">/</span>boot
</code></pre> 
<p>出现sda3，共10G空间，代表分区成功。</p> 
<h3><a id="LVM_166"></a>配置LVM</h3> 
<ol><li><strong>创建物理卷</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># pvcreate <span class="token operator">/</span>dev<span class="token operator">/</span>sda3
  Physical volume <span class="token string">"/dev/sda3"</span> successfully created<span class="token punctuation">.</span>
</code></pre> 
<ol start="2"><li><strong>查看PV和VG的信息</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># pvdisplay 
  <span class="token operator">--</span><span class="token operator">-</span> Physical volume <span class="token operator">--</span><span class="token operator">-</span>
  <span class="token constant">PV</span> Name               <span class="token operator">/</span>dev<span class="token operator">/</span>sda2  
  <span class="token constant">VG</span> Name               ol
  <span class="token constant">PV</span> Size               <span class="token operator">&lt;</span><span class="token number">19.00</span> GiB <span class="token operator">/</span> not usable <span class="token number">3.00</span> MiB
  Allocatable           <span class="token function">yes</span> <span class="token punctuation">(</span>but full<span class="token punctuation">)</span>
  <span class="token constant">PE</span> Size               <span class="token number">4.00</span> MiB
  Total <span class="token constant">PE</span>              <span class="token number">4863</span>
  Free <span class="token constant">PE</span>               <span class="token number">0</span>
  Allocated <span class="token constant">PE</span>          <span class="token number">4863</span>
  <span class="token constant">PV</span> <span class="token constant">UUID</span>               P4dWEe<span class="token operator">-</span>BCvh<span class="token operator">-</span>WrZg<span class="token operator">-</span>a0Bc<span class="token operator">-</span>NYda<span class="token operator">-</span>p9Pd<span class="token operator">-</span>bJb13R
   
  <span class="token string">"/dev/sda3"</span> is a <span class="token keyword">new</span> <span class="token class-name">physical</span> volume <span class="token keyword">of</span> <span class="token string">"10.00 GiB"</span>
  <span class="token operator">--</span><span class="token operator">-</span> <span class="token constant">NEW</span> Physical volume <span class="token operator">--</span><span class="token operator">-</span>
  <span class="token constant">PV</span> Name               <span class="token operator">/</span>dev<span class="token operator">/</span>sda3
  <span class="token constant">VG</span> Name               
  <span class="token constant">PV</span> Size               <span class="token number">10.00</span> GiB
  Allocatable           <span class="token constant">NO</span>
  <span class="token constant">PE</span> Size               <span class="token number">0</span>   
  Total <span class="token constant">PE</span>              <span class="token number">0</span>
  Free <span class="token constant">PE</span>               <span class="token number">0</span>
  Allocated <span class="token constant">PE</span>          <span class="token number">0</span>
  <span class="token constant">PV</span> <span class="token constant">UUID</span>               AjbAO2<span class="token operator">-</span>KDQj<span class="token operator">-</span><span class="token constant">VIIB</span><span class="token operator">-</span>s8rJ<span class="token operator">-</span>Zdwe<span class="token operator">-</span>dLr1<span class="token operator">-</span><span class="token constant">CDU2D3</span>

</code></pre> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># vgdisplay 
  <span class="token operator">--</span><span class="token operator">-</span> Volume group <span class="token operator">--</span><span class="token operator">-</span>
  <span class="token constant">VG</span> Name               ol  # 记住<span class="token constant">VG</span>的名称
  System <span class="token constant">ID</span>             
  Format                lvm2
  Metadata Areas        <span class="token number">1</span>
  Metadata Sequence No  <span class="token number">3</span>
  <span class="token constant">VG</span> Access             read<span class="token operator">/</span>write
  <span class="token constant">VG</span> Status             resizable
  <span class="token constant">MAX</span> <span class="token constant">LV</span>                <span class="token number">0</span>
  Cur <span class="token constant">LV</span>                <span class="token number">2</span>
  Open <span class="token constant">LV</span>               <span class="token number">2</span>
  Max <span class="token constant">PV</span>                <span class="token number">0</span>
  Cur <span class="token constant">PV</span>                <span class="token number">1</span>
  Act <span class="token constant">PV</span>                <span class="token number">1</span>
  <span class="token constant">VG</span> Size               <span class="token operator">&lt;</span><span class="token number">19.00</span> GiB
  <span class="token constant">PE</span> Size               <span class="token number">4.00</span> MiB
  Total <span class="token constant">PE</span>              <span class="token number">4863</span>
  Alloc <span class="token constant">PE</span> <span class="token operator">/</span> Size       <span class="token number">4863</span> <span class="token operator">/</span> <span class="token operator">&lt;</span><span class="token number">19.00</span> GiB
  Free  <span class="token constant">PE</span> <span class="token operator">/</span> Size       <span class="token number">0</span> <span class="token operator">/</span> <span class="token number">0</span>   # <span class="token constant">VG</span>剩余空间为<span class="token number">0</span>
  <span class="token constant">VG</span> <span class="token constant">UUID</span>               G9n7aL<span class="token operator">-</span>bdnz<span class="token operator">-</span>qeVO<span class="token operator">-</span><span class="token constant">Y3GA</span><span class="token operator">-</span>edf4<span class="token operator">-</span>lUNe<span class="token operator">-</span>4tI80Z
</code></pre> 
<p>由图中可以看出卷组的名称为ol，卷组剩余空间为0</p> 
<ol start="3"><li><strong>将创建的物理卷加入到卷组中</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># vgextend ol <span class="token operator">/</span>dev<span class="token operator">/</span>sda3
  Volume group <span class="token string">"ol"</span> successfully extended
</code></pre> 
<ol start="4"><li><strong>再次查看卷组信息</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># vgdisplay 
  <span class="token operator">--</span><span class="token operator">-</span> Volume group <span class="token operator">--</span><span class="token operator">-</span>
  <span class="token constant">VG</span> Name               ol
  System <span class="token constant">ID</span>             
  Format                lvm2
  Metadata Areas        <span class="token number">2</span>
  Metadata Sequence No  <span class="token number">4</span>
  <span class="token constant">VG</span> Access             read<span class="token operator">/</span>write
  <span class="token constant">VG</span> Status             resizable
  <span class="token constant">MAX</span> <span class="token constant">LV</span>                <span class="token number">0</span>
  Cur <span class="token constant">LV</span>                <span class="token number">2</span>
  Open <span class="token constant">LV</span>               <span class="token number">2</span>
  Max <span class="token constant">PV</span>                <span class="token number">0</span>
  Cur <span class="token constant">PV</span>                <span class="token number">2</span>
  Act <span class="token constant">PV</span>                <span class="token number">2</span>
  <span class="token constant">VG</span> Size               <span class="token number">28.99</span> GiB
  <span class="token constant">PE</span> Size               <span class="token number">4.00</span> MiB
  Total <span class="token constant">PE</span>              <span class="token number">7422</span>
  Alloc <span class="token constant">PE</span> <span class="token operator">/</span> Size       <span class="token number">4863</span> <span class="token operator">/</span> <span class="token operator">&lt;</span><span class="token number">19.00</span> GiB
  Free  <span class="token constant">PE</span> <span class="token operator">/</span> Size       <span class="token number">2559</span> <span class="token operator">/</span> <span class="token operator">&lt;</span><span class="token number">10.00</span> GiB  # <span class="token constant">VG</span>剩余10G空间
  <span class="token constant">VG</span> <span class="token constant">UUID</span>               G9n7aL<span class="token operator">-</span>bdnz<span class="token operator">-</span>qeVO<span class="token operator">-</span><span class="token constant">Y3GA</span><span class="token operator">-</span>edf4<span class="token operator">-</span>lUNe<span class="token operator">-</span>4tI80Z
</code></pre> 
<p>卷组剩余空间为10G</p> 
<ol start="5"><li><strong>再次使用 <em>df -H</em> 命令查看磁盘情况</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm <span class="token operator">~</span><span class="token punctuation">]</span># df <span class="token operator">-</span><span class="token constant">H</span>
Filesystem           Size  Used Avail Use<span class="token operator">%</span> Mounted on
devtmpfs             <span class="token number">1</span><span class="token punctuation">.</span>9G     <span class="token number">0</span>  <span class="token number">1</span><span class="token punctuation">.</span>9G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G     <span class="token number">0</span>  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev<span class="token operator">/</span>shm
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G   11M  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G     <span class="token number">0</span>  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>sys<span class="token operator">/</span>fs<span class="token operator">/</span>cgroup
<span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>root   19G   19G  159M <span class="token number">100</span><span class="token operator">%</span> <span class="token operator">/</span>  # 此时还未成功扩容
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1            <span class="token number">1</span><span class="token punctuation">.</span>1G  245M  819M  <span class="token number">23</span><span class="token operator">%</span> <span class="token operator">/</span>boot
tmpfs                383M   21k  383M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>user<span class="token operator">/</span><span class="token number">0</span>
Server<span class="token punctuation">.</span>x86_64
</code></pre> 
<p>记住根目录所对应的文件系统 <em>/dev/mapper/ol-root</em></p> 
<ol start="6"><li><strong>扩展逻辑卷大小</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm ol<span class="token punctuation">]</span># lvextend <span class="token operator">/</span>dev<span class="token operator">/</span>ol<span class="token operator">/</span>root <span class="token operator">/</span>dev<span class="token operator">/</span>sda3
  Size <span class="token keyword">of</span> logical volume ol<span class="token operator">/</span>root changed from <span class="token operator">&lt;</span><span class="token number">17.00</span> <span class="token function">GiB</span> <span class="token punctuation">(</span><span class="token number">4351</span> extents<span class="token punctuation">)</span> to <span class="token number">26.99</span> <span class="token function">GiB</span> <span class="token punctuation">(</span><span class="token number">6910</span> extents<span class="token punctuation">)</span><span class="token punctuation">.</span>
  Logical volume ol<span class="token operator">/</span>root successfully resized<span class="token punctuation">.</span>
</code></pre> 
<p>也可以使用 <em>lvextend /dev/mapper/ol-root /dev/sda3</em></p> 
<blockquote> 
 <p>参考： /dev/mapper/ol-root的意思是说你有一个VG (volume group卷组)叫作ol, 这个ol里面有一个LV叫作root。其实这个/dev/mapper/ol-root文件是一个连接文件，是连接到/dev/dm-0的，你可以用命令ll /dev/mapper/ol-root进行查看。</p> 
</blockquote> 
<blockquote> 
 <p>其实在系统里/dev/ol/root 和 /dev/mapper/ol-root以及/dev/dm-0都是一个东西，都可当作一个分区来对待。</p> 
</blockquote> 
<ol start="7"><li><strong>检查数据块大小和数量</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm ol<span class="token punctuation">]</span># xfs_growfs <span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>root 
meta<span class="token operator">-</span>data<span class="token operator">=</span><span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>root    isize<span class="token operator">=</span><span class="token number">256</span>    agcount<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> agsize<span class="token operator">=</span><span class="token number">1113856</span> blks
         <span class="token operator">=</span>                       sectsz<span class="token operator">=</span><span class="token number">512</span>   attr<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> projid32bit<span class="token operator">=</span><span class="token number">1</span>
         <span class="token operator">=</span>                       crc<span class="token operator">=</span><span class="token number">0</span>        finobt<span class="token operator">=</span><span class="token number">0</span> spinodes<span class="token operator">=</span><span class="token number">0</span>
data     <span class="token operator">=</span>                       bsize<span class="token operator">=</span><span class="token number">4096</span>   blocks<span class="token operator">=</span><span class="token number">4455424</span><span class="token punctuation">,</span> imaxpct<span class="token operator">=</span><span class="token number">25</span>
         <span class="token operator">=</span>                       sunit<span class="token operator">=</span><span class="token number">0</span>      swidth<span class="token operator">=</span><span class="token number">0</span> blks
naming   <span class="token operator">=</span>version <span class="token number">2</span>              bsize<span class="token operator">=</span><span class="token number">4096</span>   ascii<span class="token operator">-</span>ci<span class="token operator">=</span><span class="token number">0</span> ftype<span class="token operator">=</span><span class="token number">1</span>
log      <span class="token operator">=</span>internal               bsize<span class="token operator">=</span><span class="token number">4096</span>   blocks<span class="token operator">=</span><span class="token number">2560</span><span class="token punctuation">,</span> version<span class="token operator">=</span><span class="token number">2</span>
         <span class="token operator">=</span>                       sectsz<span class="token operator">=</span><span class="token number">512</span>   sunit<span class="token operator">=</span><span class="token number">0</span> blks<span class="token punctuation">,</span> lazy<span class="token operator">-</span>count<span class="token operator">=</span><span class="token number">1</span>
realtime <span class="token operator">=</span>none                   extsz<span class="token operator">=</span><span class="token number">4096</span>   blocks<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> rtextents<span class="token operator">=</span><span class="token number">0</span>
data blocks changed from <span class="token number">4455424</span> to <span class="token number">7075840</span>  # 扩容成功
</code></pre> 
<ol start="8"><li><strong>最后再使用 <em>df -H</em> 命令</strong></li></ol> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@oracle19c<span class="token operator">-</span>asm ol<span class="token punctuation">]</span># df <span class="token operator">-</span><span class="token constant">H</span>
Filesystem           Size  Used Avail Use<span class="token operator">%</span> Mounted on
devtmpfs             <span class="token number">1</span><span class="token punctuation">.</span>9G     <span class="token number">0</span>  <span class="token number">1</span><span class="token punctuation">.</span>9G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G     <span class="token number">0</span>  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>dev<span class="token operator">/</span>shm
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G   11M  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run
tmpfs                <span class="token number">2</span><span class="token punctuation">.</span>0G     <span class="token number">0</span>  <span class="token number">2</span><span class="token punctuation">.</span>0G   <span class="token number">0</span><span class="token operator">%</span> <span class="token operator">/</span>sys<span class="token operator">/</span>fs<span class="token operator">/</span>cgroup
<span class="token operator">/</span>dev<span class="token operator">/</span>mapper<span class="token operator">/</span>ol<span class="token operator">-</span>root   29G   19G   11G  <span class="token number">63</span><span class="token operator">%</span> <span class="token operator">/</span>  # 扩容成功
<span class="token operator">/</span>dev<span class="token operator">/</span>sda1            <span class="token number">1</span><span class="token punctuation">.</span>1G  245M  819M  <span class="token number">23</span><span class="token operator">%</span> <span class="token operator">/</span>boot
tmpfs                383M   21k  383M   <span class="token number">1</span><span class="token operator">%</span> <span class="token operator">/</span>run<span class="token operator">/</span>user<span class="token operator">/</span><span class="token number">0</span>
Server<span class="token punctuation">.</span>x86_64
</code></pre> 
<p><strong>自此，根目录成功扩容。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4990d35e538d37ea995cfc45e0b75810/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Control】Python控制第三方程序之SecureCRT</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f68d4110ea3a0402c6ab23cdf747a1d7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">训练记录番外篇（3）：2019-2020 ICPC Southeastern European Regional Programming Contest (SEERC 2019)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>