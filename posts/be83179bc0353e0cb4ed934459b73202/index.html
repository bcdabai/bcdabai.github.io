<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>scrapyæ¡†æ¶å®æˆ˜ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="scrapyæ¡†æ¶å®æˆ˜" />
<meta property="og:description" content="ğŸ‘¨â€ğŸ’»æ›´å¤šç²¾å½©å°½åœ¨åšä¸»é¦–é¡µï¼šiæ–°æœ¨ä¼˜å­ğŸ‘€
ğŸ‰æ¬¢è¿å…³æ³¨ğŸ”ç‚¹èµğŸ‘æ”¶è—â­ç•™è¨€ğŸ“
ğŸ§šâ€â™‚ï¸å¯„è¯­:å½“ä½ å°†ä¿¡å¿ƒæ”¾åœ¨è‡ªå·±èº«ä¸Šæ—¶ï¼Œä½ å°†æ°¸è¿œå……æ»¡åŠ›é‡ğŸ‘£
âœ¨æœ‰ä»»ä½•ç–‘é—®æ¬¢è¿è¯„è®ºæ¢è®¨
ä»€ä¹ˆæ˜¯å…¨ç«™æ•°æ®crawlingå‘¢ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å°†ä¸€ä¸ªç½‘ç«™çš„å…¨éƒ¨æ•°æ®éƒ½crawlingä¸‹æ¥ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨scrapyæ¡†æ¶ï¼Œè¿™é‡Œæˆ‘æä¾›äº†å¾ˆå¤šæ–¹å¼ï¼Œå¯ä»¥æŒ‘é€‰è‡ªå·±å–œæ¬¢çš„ç©ä¸€ç©
æ¥ä¸‹æ¥æœ‰è¯·æˆ‘ä»¬çš„å¹¸è¿å„¿ï¼šä¸èƒ½è¯´çš„ç½‘ç«™åï¼Œæˆ‘æ€•ä¸è¿‡å®¡ğŸš—
0ï¸âƒ£1ï¸âƒ£åˆ›å»ºscrapyé¡¹ç›®
scrapy startproject æ–‡ä»¶å cd æ–‡ä»¶å scrapy genspider åç§° è¦crawlingç½‘ç«™çš„åŸŸå 0ï¸âƒ£2ï¸âƒ£æ›´æ”¹settingsé…ç½®æ–‡ä»¶
USER_AGENT ----------&gt;è®¾ç½®UA ROBOTSTXT_OBEY ----------&gt;å›å­åè®®ï¼ˆæˆ‘ä»¬çˆ¬è™«å½“ç„¶ä¸ä¼šéµå®ˆå•¦ğŸ˜ï¼‰ LOG_LEVEL ----------&gt;æ—¥å¿—ç­‰çº§ï¼ˆå»ºè®®è®¾ç½®ä¸ºWARNINGï¼‰ â—â—â—ä¸€å®šè¦è®°å¾—è®¾ç½®Â·DOWNLOAD_DELAYÂ·é™åˆ¶è®¿é—®é¢‘ç‡
å› ä¸ºscrapyçš„åº•å±‚æ˜¯åç¨‹ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œå¦‚æœä¸è®¾ç½®å¯èƒ½ç”¨ä¸äº†å‡ åˆ†é’Ÿå°±ä¼šå¼¹å‡ºå®‰å…¨éªŒè¯æ— æ³•æŠ“å–ç½‘é¡µã€‚æœ‰äº›ç½‘ç«™å¦‚æœä¸è®¾ç½®ï¼ŒæŠ“å–çš„æ•°æ®é‡å¤Ÿå¤šå‡ åˆ†é’Ÿå°±ä¼šæŠŠç½‘ç«™è·‘dieäº†,æ¯•ç«Ÿæˆ‘ä»¬æ˜¯å–„è‰¯çš„spiderï¼Œä¸è¦ç ´åç½‘ç«™å“¦ğŸ˜„
é¦–å…ˆï¼Œæˆ‘ä»¬è¿›å…¥ç½‘é¡µæŒ‰é”®ç›˜ä¸Šçš„F12è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼Œåœ¨Elementsä¸­åšå‚è€ƒï¼ŒElementså¯ä»¥åšå‚è€ƒä¸èƒ½ä½œä¸ºä¾æ®ï¼Œå› ä¸ºElementsæ˜¯ç»è¿‡csså’Œjsæ¸²æŸ“ä¹‹åå½¢æˆçš„ï¼Œä½œä¸ºä¾æ®çš„åªèƒ½æ˜¯é¡µé¢æºä»£ç ï¼ˆSourcesï¼‰ã€‚å¯ä»¥è§‚å¯Ÿåˆ°æ¯ä¸€ä¸ªliæ ‡ç­¾å°±æ˜¯ä¸€æ¡æ•°æ®ï¼ˆè¿™é‡Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘åˆ†é¡µï¼Œå…ˆæŠ“å–ä¸€é¡µçš„æ•°æ®ï¼Œä¸€é¡µæå®šäº†åˆ†é¡µå°±å¾ˆç®€å•äº†ï¼‰
æˆ‘ä»¬è¦æ˜¯åªæŠ“å–é¦–é¡µä¸Šçš„æ•°æ®å°±å¾ˆæ²¡æ„æ€ï¼Œæ›´å¤šçš„æ˜¯æƒ³ç‚¹å‡»è¿›å…¥è¯¦æƒ…é¡µ,æŠ“å–è¯¦æƒ…é¡µä¸­çš„æ•°æ®ï¼Œè¯¦æƒ…é¡µçš„æ•°æ®æ‰æ›´å…¨é¢
0ï¸âƒ£3ï¸âƒ£è§£æé¦–é¡µæ•°æ®æ‹¿åˆ°è¯¦æƒ…é¡µçš„url
li_list = resp.xpath(&#34;//ul[@class=&#39;viewlist_ul&#39;]/li&#34;) # æ‹¿åˆ°æ¯ä¸€ä¸ªli for li in li_list: href = li.xpath(&#34;./a/@href&#34;).extract_first() print(href) 0ï¸âƒ£4ï¸âƒ£æ‹¿åˆ°çš„urlå¦‚ä¸Šå›¾ï¼Œå‘ç°è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„urlå®ƒä¸å®Œæ•´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†hrefè¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°çœŸæ­£çš„url
href = resp.urljoin(href) 0ï¸âƒ£5ï¸âƒ£è¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†çœŸæ­£çš„urlï¼Œä»”ç»†è§‚å¯Ÿå‘ç°æœ€åä¸€æ¡æ•°æ®å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼ˆæœ€åä¸€æ¡urlæ˜¯å¹¿å‘Šï¼‰ï¼ŒåŠ ä¸€ä¸ªifåˆ¤æ–­å°±å¯ä»¥ä¸ªå°†æ²¡ç”¨çš„urlå»é™¤
if &#34;topicm&#34; in href: continue 0ï¸âƒ£6ï¸âƒ£åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†æ¯ä¸€æ¡è¯¦æƒ…é¡µçš„urlï¼Œåªéœ€å†ä¸€æ¬¡å‘é€è¯·æ±‚è¿›å…¥è¯¦æƒ…é¡µï¼Œè§£æè¯¦æƒ…é¡µæ‹¿åˆ°æˆ‘ä»¬è¦çš„æ•°æ®å³å¯
âš âš âš æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†å®ç°å…¨ç«™æ•°æ®crawling,æ•°æ®é‡æ˜¯éå¸¸å¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æå‰é¢„ä¼°é£é™©ï¼Œå°±åƒä¸Šå›¾ä¸­çš„æ•°æ®å¯èƒ½æŸä¸€æ¡æˆ–æŸå‡ æ¡ä¼šç¼ºå¤±ï¼Œè¿™å°±æ¶‰åŠåˆ°ç¼ºçœå€¼çš„å¤„ç†
0ï¸âƒ£7ï¸âƒ£ğŸ’ç¼ºçœå€¼çš„å¤„ç†ï¼š
æ–¹å¼ä¸€ï¼š
å¯ä»¥ç”¨ifæ¡ä»¶åˆ¤æ–­ï¼Œé€šè¿‡åˆ¤æ–­å°æ ‡é¢˜æ‹¿å¯¹åº”çš„å†…å®¹ï¼ˆè¿™ç§æ¯”è¾ƒéº»çƒ¦ï¼Œæ•°æ®è¶Šå¤šéš¾åº¦è¶Šå¤§ï¼‰æ–¹å¼äºŒï¼ˆæ¨èï¼‰ï¼š
è‡ªå·±å®šä¹‰ä¸€ç§æ•°æ®ç»“æ„ä½œä¸ºæ˜ å°„ï¼ˆç®€ä¾¿ä¸”æ•°æ®è§„æ•´ï¼‰ ä»£ç å’Œè¿è¡Œå›¾ç‰‡å¦‚ä¸‹ï¼š
car_tag = { &#34;è¡¨æ˜¾é‡Œç¨‹&#34;: &#34;mileage&#34;, &#34;ä¸Šç‰Œæ—¶é—´&#34;: &#34;time&#34;, &#34;æŒ¡ä½/æ’é‡&#34;: &#34;displace&#34;, &#34;è½¦è¾†æ‰€åœ¨åœ°&#34;: &#34;location&#34;, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/be83179bc0353e0cb4ed934459b73202/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-14T21:09:49+08:00" />
<meta property="article:modified_time" content="2022-05-14T21:09:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">scrapyæ¡†æ¶å®æˆ˜</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>ğŸ‘¨â€ğŸ’»æ›´å¤šç²¾å½©å°½åœ¨åšä¸»é¦–é¡µï¼š<a href="https://blog.csdn.net/weixin_56382303?spm=1011.2419.3001.5343">iæ–°æœ¨ä¼˜å­</a>ğŸ‘€<br> ğŸ‰æ¬¢è¿å…³æ³¨ğŸ”ç‚¹èµğŸ‘æ”¶è—â­ç•™è¨€ğŸ“<br> ğŸ§šâ€â™‚ï¸å¯„è¯­:å½“ä½ å°†ä¿¡å¿ƒæ”¾åœ¨è‡ªå·±èº«ä¸Šæ—¶ï¼Œä½ å°†æ°¸è¿œå……æ»¡åŠ›é‡ğŸ‘£<br> âœ¨æœ‰ä»»ä½•ç–‘é—®æ¬¢è¿è¯„è®ºæ¢è®¨</p> 
</blockquote> 
<hr> 
<p><code>ä»€ä¹ˆæ˜¯å…¨ç«™æ•°æ®crawlingå‘¢ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å°†ä¸€ä¸ªç½‘ç«™çš„å…¨éƒ¨æ•°æ®éƒ½crawlingä¸‹æ¥ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨scrapyæ¡†æ¶ï¼Œè¿™é‡Œæˆ‘æä¾›äº†å¾ˆå¤šæ–¹å¼ï¼Œå¯ä»¥æŒ‘é€‰è‡ªå·±å–œæ¬¢çš„ç©ä¸€ç©</code><br> æ¥ä¸‹æ¥æœ‰è¯·æˆ‘ä»¬çš„å¹¸è¿å„¿ï¼š<a href="https://www.che168.com/china/a0_0msdgscncgpi1ltocsp1exx0/" rel="nofollow">ä¸èƒ½è¯´çš„ç½‘ç«™åï¼Œæˆ‘æ€•ä¸è¿‡å®¡ğŸš—</a><br> <img src="https://images2.imgbox.com/4e/87/eKXdEwia_o.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<hr> 
<blockquote> 
 <p>0ï¸âƒ£1ï¸âƒ£<code>åˆ›å»ºscrapyé¡¹ç›®</code></p> 
 <pre><code class="prism language-python">scrapy startproject æ–‡ä»¶å
cd æ–‡ä»¶å
scrapy genspider åç§° è¦crawlingç½‘ç«™çš„åŸŸå
</code></pre> 
 <p><img src="https://images2.imgbox.com/b6/fa/su6KPeay_o.png" alt=""><br> 0ï¸âƒ£2ï¸âƒ£<code>æ›´æ”¹settingsé…ç½®æ–‡ä»¶</code></p> 
 <pre><code class="prism language-python">USER_AGENT       <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>è®¾ç½®UA
ROBOTSTXT_OBEY   <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>å›å­åè®®ï¼ˆæˆ‘ä»¬çˆ¬è™«å½“ç„¶ä¸ä¼šéµå®ˆå•¦ğŸ˜ï¼‰
LOG_LEVEL        <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>æ—¥å¿—ç­‰çº§ï¼ˆå»ºè®®è®¾ç½®ä¸ºWARNINGï¼‰
</code></pre> 
 <p><img src="https://images2.imgbox.com/6a/7c/HUQNUskn_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> â—â—â—<code>ä¸€å®šè¦è®°å¾—è®¾ç½®Â·DOWNLOAD_DELAYÂ·é™åˆ¶è®¿é—®é¢‘ç‡</code><br> <mark>å› ä¸ºscrapyçš„åº•å±‚æ˜¯åç¨‹ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œå¦‚æœä¸è®¾ç½®å¯èƒ½ç”¨ä¸äº†å‡ åˆ†é’Ÿå°±ä¼šå¼¹å‡ºå®‰å…¨éªŒè¯æ— æ³•æŠ“å–ç½‘é¡µã€‚<font color="red">æœ‰äº›ç½‘ç«™å¦‚æœä¸è®¾ç½®ï¼ŒæŠ“å–çš„æ•°æ®é‡å¤Ÿå¤šå‡ åˆ†é’Ÿå°±ä¼šæŠŠç½‘ç«™è·‘dieäº†,æ¯•ç«Ÿæˆ‘ä»¬æ˜¯<strong>å–„è‰¯çš„spider</strong>ï¼Œä¸è¦ç ´åç½‘ç«™å“¦ğŸ˜„</font></mark><br> <img src="https://images2.imgbox.com/ab/26/tgVYgvc9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
</blockquote> 
<blockquote> 
 <p>é¦–å…ˆï¼Œæˆ‘ä»¬è¿›å…¥ç½‘é¡µæŒ‰é”®ç›˜ä¸Šçš„<code>F12</code>è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼Œåœ¨<code>Elements</code>ä¸­åš<mark>å‚è€ƒ</mark>ï¼Œ<mark>Elementså¯ä»¥åšå‚è€ƒä¸èƒ½ä½œä¸ºä¾æ®</mark>ï¼Œå› ä¸ºElementsæ˜¯ç»è¿‡csså’Œjsæ¸²æŸ“ä¹‹åå½¢æˆçš„ï¼Œä½œä¸ºä¾æ®çš„åªèƒ½æ˜¯<code>é¡µé¢æºä»£ç </code>ï¼ˆSourcesï¼‰ã€‚å¯ä»¥è§‚å¯Ÿåˆ°æ¯ä¸€ä¸ª<code>liæ ‡ç­¾</code>å°±æ˜¯ä¸€æ¡æ•°æ®ï¼ˆ<mark><font color="red">è¿™é‡Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘åˆ†é¡µï¼Œå…ˆæŠ“å–ä¸€é¡µçš„æ•°æ®ï¼Œä¸€é¡µæå®šäº†åˆ†é¡µå°±å¾ˆç®€å•äº†</font></mark>ï¼‰<br> æˆ‘ä»¬è¦æ˜¯åªæŠ“å–é¦–é¡µä¸Šçš„æ•°æ®å°±å¾ˆæ²¡æ„æ€ï¼Œæ›´å¤šçš„æ˜¯æƒ³ç‚¹å‡»è¿›å…¥<code>è¯¦æƒ…é¡µ</code>,æŠ“å–è¯¦æƒ…é¡µä¸­çš„æ•°æ®ï¼Œè¯¦æƒ…é¡µçš„æ•°æ®æ‰æ›´å…¨é¢</p> 
</blockquote> 
<hr> 
<p>0ï¸âƒ£3ï¸âƒ£<font color="#944bb1">è§£æé¦–é¡µæ•°æ®æ‹¿åˆ°è¯¦æƒ…é¡µçš„url</font></p> 
<pre><code class="prism language-python">li_list <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//ul[@class='viewlist_ul']/li"</span><span class="token punctuation">)</span>  <span class="token comment"># æ‹¿åˆ°æ¯ä¸€ä¸ªli</span>
<span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
	href <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"./a/@href"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/18/9b/ql2GjIwX_o.png" alt="æ‹¿åˆ°çš„href"><br> 0ï¸âƒ£4ï¸âƒ£<font color="#944bb1">æ‹¿åˆ°çš„urlå¦‚ä¸Šå›¾ï¼Œå‘ç°è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„urlå®ƒä¸å®Œæ•´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†hrefè¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°çœŸæ­£çš„url</font></p> 
<pre><code class="prism language-python">href <span class="token operator">=</span> resp<span class="token punctuation">.</span>urljoin<span class="token punctuation">(</span>href<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/83/47/S8n27u8A_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> 0ï¸âƒ£5ï¸âƒ£<font color="#944bb1">è¿™æ ·æˆ‘ä»¬å°±æ‹¿åˆ°äº†çœŸæ­£çš„urlï¼Œä»”ç»†è§‚å¯Ÿå‘ç°æœ€åä¸€æ¡æ•°æ®å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼ˆæœ€åä¸€æ¡urlæ˜¯å¹¿å‘Šï¼‰ï¼ŒåŠ ä¸€ä¸ªifåˆ¤æ–­å°±å¯ä»¥ä¸ªå°†æ²¡ç”¨çš„urlå»é™¤</font></p> 
<pre><code class="prism language-python"><span class="token keyword">if</span> <span class="token string">"topicm"</span> <span class="token keyword">in</span> href<span class="token punctuation">:</span>
		<span class="token keyword">continue</span>
</code></pre> 
<p>0ï¸âƒ£6ï¸âƒ£<font color="#944bb1">åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†æ¯ä¸€æ¡è¯¦æƒ…é¡µçš„urlï¼Œåªéœ€å†ä¸€æ¬¡å‘é€è¯·æ±‚è¿›å…¥è¯¦æƒ…é¡µï¼Œè§£æè¯¦æƒ…é¡µæ‹¿åˆ°æˆ‘ä»¬è¦çš„æ•°æ®å³å¯</font></p> 
<hr> 
<blockquote> 
 <p>âš âš âš <code>æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†å®ç°å…¨ç«™æ•°æ®crawling,æ•°æ®é‡æ˜¯éå¸¸å¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æå‰é¢„ä¼°é£é™©ï¼Œå°±åƒä¸Šå›¾ä¸­çš„æ•°æ®å¯èƒ½æŸä¸€æ¡æˆ–æŸå‡ æ¡ä¼šç¼ºå¤±ï¼Œè¿™å°±æ¶‰åŠåˆ°ç¼ºçœå€¼çš„å¤„ç†</code><br> 0ï¸âƒ£7ï¸âƒ£ğŸ’<strong>ç¼ºçœå€¼çš„å¤„ç†</strong>ï¼š</p> 
 <ul><li>æ–¹å¼ä¸€ï¼š<br> å¯ä»¥ç”¨ifæ¡ä»¶åˆ¤æ–­ï¼Œé€šè¿‡åˆ¤æ–­å°æ ‡é¢˜æ‹¿å¯¹åº”çš„å†…å®¹ï¼ˆè¿™ç§æ¯”è¾ƒéº»çƒ¦ï¼Œæ•°æ®è¶Šå¤šéš¾åº¦è¶Šå¤§ï¼‰</li><li>æ–¹å¼äºŒï¼ˆæ¨èï¼‰ï¼š<br> è‡ªå·±å®šä¹‰ä¸€ç§æ•°æ®ç»“æ„ä½œä¸ºæ˜ å°„ï¼ˆç®€ä¾¿ä¸”æ•°æ®è§„æ•´ï¼‰</li></ul> 
</blockquote> 
<blockquote> 
 <p>ä»£ç å’Œè¿è¡Œå›¾ç‰‡å¦‚ä¸‹ï¼š</p> 
 <pre><code class="prism language-python">car_tag <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token string">"è¡¨æ˜¾é‡Œç¨‹"</span><span class="token punctuation">:</span> <span class="token string">"mileage"</span><span class="token punctuation">,</span>
	<span class="token string">"ä¸Šç‰Œæ—¶é—´"</span><span class="token punctuation">:</span> <span class="token string">"time"</span><span class="token punctuation">,</span>
	<span class="token string">"æŒ¡ä½/æ’é‡"</span><span class="token punctuation">:</span> <span class="token string">"displace"</span><span class="token punctuation">,</span>
	<span class="token string">"è½¦è¾†æ‰€åœ¨åœ°"</span><span class="token punctuation">:</span> <span class="token string">"location"</span><span class="token punctuation">,</span>
	<span class="token string">"æŸ¥çœ‹é™è¿åœ°"</span><span class="token punctuation">:</span> <span class="token string">"standard"</span>
<span class="token punctuation">}</span>  <span class="token comment"># æ˜ å°„</span>
dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
   <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
   <span class="token string">'mileage'</span><span class="token punctuation">:</span> <span class="token string">'0å…¬é‡Œ'</span><span class="token punctuation">,</span>
   <span class="token string">'time'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
   <span class="token string">'displace'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
   <span class="token string">'location'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
   <span class="token string">'standard'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span>
<span class="token punctuation">}</span>  <span class="token comment"># æ‰¿è½½æœ€ç»ˆçš„æ•°æ®</span>
name <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//div[@class='car-box']/h3/text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
dic<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">=</span> name
lis <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//div[@class='car-box']/ul/li"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> li <span class="token keyword">in</span> lis<span class="token punctuation">:</span>
   p_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"./p//text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
   p_value <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"./h4/text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
   p_name <span class="token operator">=</span> p_name<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
   p_value <span class="token operator">=</span> p_value<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

   data_key <span class="token operator">=</span> self<span class="token punctuation">.</span>car_tag<span class="token punctuation">[</span>p_name<span class="token punctuation">]</span>
   dic<span class="token punctuation">[</span>data_key<span class="token punctuation">]</span> <span class="token operator">=</span> p_value

<span class="token keyword">print</span><span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
</code></pre> 
 <p><img src="https://images2.imgbox.com/29/3d/3I5NyEuT_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
</blockquote> 
<blockquote> 
 <p>0ï¸âƒ£8ï¸âƒ£ä¸€é¡µçš„æ•°æ®æ‹¿åˆ°äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åˆ†é¡µè¿™é‡Œæˆ‘ä¹Ÿæä¾›ä¸¤ç§æ–¹å¼ï¼š</p> 
 <ul><li>æ–¹å¼ä¸€ï¼š<br> ä»”ç»†çš„è§‚å¯Ÿç½‘å€ï¼š<br> https://www.che168.com/china/a0_0msdgscncgpi1ltocsp<code>1</code>exx0/?pvareaid=102179#currengpostion<br> https://www.che168.com/china/a0_0msdgscncgpi1ltocsp<code>2</code>exx0/?pvareaid=102179#currengpostion<br> https://www.che168.com/china/a0_0msdgscncgpi1ltocsp<code>3</code>exx0/?pvareaid=102179#currengpostion<br> åªè¦æˆ‘ä»¬å°†æ•°å­—ä¾æ¬¡æ›¿æ¢å°±å¯ä»¥å®ç°ç¿»é¡µ<br> <strong>æˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªforå¾ªç¯å°±å¯ä»¥æå®šå“¦</strong>ğŸ</li><li>æ–¹å¼äºŒï¼š<br> æ–¹å¼ä¸€æ˜¯æœ€åŸºæœ¬çš„ç¿»é¡µé€»è¾‘ï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨çš„æ˜¯scrapyï¼Œ<strong>scrapyæœ‰è‡ªå·±çš„æ–¹å¼</strong><br> åªéœ€è¦æ‹¿åˆ°ç¿»é¡µçš„urlå‘é€è¯·æ±‚å³å¯å®ç°ç¿»é¡µï¼ˆ<mark><font color="red">è¿™é‡Œä¸éœ€è¦æ‹…å¿ƒæœ‰é‡å¤çš„url,scrapyæ¡†æ¶ä¸­æœ‰ä¸€ä¸ªè°ƒåº¦å™¨ï¼ˆschedulerï¼‰ä¼šè‡ªåŠ¨çš„å¸®åŠ©æˆ‘ä»¬å®ç°å»é‡ï¼Œè¿™æ ·å°±å¯ä»¥å°†100é¡µçš„æ•°æ®å…¨éƒ¨æŠ“å–åˆ°</font></mark>ï¼‰</li></ul> 
 <pre><code class="prism language-python">hrefs <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//div[@id='listpagination']/a/@href"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> href <span class="token keyword">in</span> hrefs<span class="token punctuation">:</span>
	 <span class="token keyword">if</span> href<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"javascript"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">continue</span>
	 href <span class="token operator">=</span> resp<span class="token punctuation">.</span>urljoin<span class="token punctuation">(</span>href<span class="token punctuation">)</span>
     <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>
               url<span class="token operator">=</span>href<span class="token punctuation">,</span>
               callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse
     <span class="token punctuation">)</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <p>0ï¸âƒ£9ï¸âƒ£<code>æ•°æ®å…¨éƒ¨crawlingåˆ°äº†ï¼Œå°±å‰©ä¸‹å­˜å‚¨äº†</code><br> <font color="hotpink">å­˜å‚¨ä¹‹å‰ä¸€å®šè¦è®°å¾—åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰“å¼€ç®¡é“<br> <img src="https://images2.imgbox.com/6b/2a/MIHxEmVL_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å­˜å‚¨æ•°æ®å°±è¦åœ¨ç®¡é“ï¼ˆpipelineï¼‰ä¸­å†™ä»£ç ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©å­˜å‚¨åœ¨<strong>csvæ–‡ä»¶</strong>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©<strong>Mysql</strong>ã€<strong>MongoDB</strong>ç­‰ç­‰</font></p> 
 <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
   self<span class="token punctuation">.</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"car.csv"</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"w"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
   self<span class="token punctuation">.</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
   self<span class="token punctuation">.</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'mileage'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'displace'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'standard'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> item
</code></pre> 
 <p><img src="https://images2.imgbox.com/dc/a9/Dv5YWMLC_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <font color="blue">åªè¦ç¨‹åºä¸€ç›´è·‘ä¸‹å»å°±å¯ä»¥å°†æ•°æ®å…¨éƒ¨è·å–åˆ°ï¼Œåªéœ€è€å¿ƒç­‰å¾…å³å¯ï¼ˆå…¨ç«™æ•°æ®crawlingçš„æ—¶é—´å¯èƒ½å¾ˆé•¿ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†å…¨ç«™æ•°æ®crawlingï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ğŸ˜¼</font></p> 
</blockquote> 
<p>1ï¸âƒ£0ï¸âƒ£æ¥ä¸‹æ¥å°±æ˜¯å°ä¼™ä¼´ä»¬æœ€å–œæ¬¢çš„æºä»£ç ç¯èŠ‚ğŸ˜€<br> <code>jia.py</code></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> scrapy


<span class="token keyword">class</span> <span class="token class-name">JiaSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'jia'</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'che168.com'</span><span class="token punctuation">]</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.che168.com/china/a0_0msdgscncgpi1ltocsp1exx0/'</span><span class="token punctuation">]</span>

    car_tag <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"è¡¨æ˜¾é‡Œç¨‹"</span><span class="token punctuation">:</span> <span class="token string">"mileage"</span><span class="token punctuation">,</span>
        <span class="token string">"ä¸Šç‰Œæ—¶é—´"</span><span class="token punctuation">:</span> <span class="token string">"time"</span><span class="token punctuation">,</span>
        <span class="token string">"æŒ¡ä½/æ’é‡"</span><span class="token punctuation">:</span> <span class="token string">"displace"</span><span class="token punctuation">,</span>
        <span class="token string">"è½¦è¾†æ‰€åœ¨åœ°"</span><span class="token punctuation">:</span> <span class="token string">"location"</span><span class="token punctuation">,</span>
        <span class="token string">"æŸ¥çœ‹é™è¿åœ°"</span><span class="token punctuation">:</span> <span class="token string">"standard"</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> resp<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># print(resp.url)</span>
        li_list <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//ul[@class='viewlist_ul']/li"</span><span class="token punctuation">)</span>  <span class="token comment"># æ‹¿åˆ°æ¯ä¸€ä¸ªli</span>
        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
            href <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"./a/@href"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            href <span class="token operator">=</span> resp<span class="token punctuation">.</span>urljoin<span class="token punctuation">(</span>href<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">"topicm"</span> <span class="token keyword">in</span> href<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            <span class="token comment"># print(href)</span>
            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>
                url<span class="token operator">=</span>href<span class="token punctuation">,</span>
                callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse_detail
            <span class="token punctuation">)</span>

        <span class="token comment"># åˆ†é¡µ</span>
        hrefs <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//div[@id='listpagination']/a/@href"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> href <span class="token keyword">in</span> hrefs<span class="token punctuation">:</span>
            <span class="token keyword">if</span> href<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"javascript"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            href <span class="token operator">=</span> resp<span class="token punctuation">.</span>urljoin<span class="token punctuation">(</span>href<span class="token punctuation">)</span>
            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>
                url<span class="token operator">=</span>href<span class="token punctuation">,</span>
                callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse
            <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_detail</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> resp<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
            <span class="token string">'mileage'</span><span class="token punctuation">:</span> <span class="token string">'0å…¬é‡Œ'</span><span class="token punctuation">,</span>
            <span class="token string">'time'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
            <span class="token string">'displace'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
            <span class="token string">'location'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">,</span>
            <span class="token string">'standard'</span><span class="token punctuation">:</span> <span class="token string">'æœªçŸ¥'</span>
        <span class="token punctuation">}</span>  <span class="token comment"># æœ€ç»ˆçš„æ•°æ®</span>
        name <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//div[@class='car-box']/h3/text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        dic<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">=</span> name
        lis <span class="token operator">=</span> resp<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//div[@class='car-box']/ul/li"</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> li <span class="token keyword">in</span> lis<span class="token punctuation">:</span>
            p_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"./p//text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            p_value <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"./h4/text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
            p_name <span class="token operator">=</span> p_name<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            p_value <span class="token operator">=</span> p_value<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

            data_key <span class="token operator">=</span> self<span class="token punctuation">.</span>car_tag<span class="token punctuation">[</span>p_name<span class="token punctuation">]</span>
            dic<span class="token punctuation">[</span>data_key<span class="token punctuation">]</span> <span class="token operator">=</span> p_value

        <span class="token keyword">yield</span> dic
</code></pre> 
<p><code>settings.py</code></p> 
<pre><code class="prism language-python"><span class="token comment"># Scrapy settings for car project</span>
<span class="token comment">#</span>
<span class="token comment"># For simplicity, this file contains only settings considered important or</span>
<span class="token comment"># commonly used. You can find more settings consulting the documentation:</span>
<span class="token comment">#</span>
<span class="token comment">#     https://docs.scrapy.org/en/latest/topics/settings.html</span>
<span class="token comment">#     https://docs.scrapy.org/en/latest/topics/downloader-middleware.html</span>
<span class="token comment">#     https://docs.scrapy.org/en/latest/topics/spider-middleware.html</span>

BOT_NAME <span class="token operator">=</span> <span class="token string">'car'</span>

SPIDER_MODULES <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'car.spiders'</span><span class="token punctuation">]</span>
NEWSPIDER_MODULE <span class="token operator">=</span> <span class="token string">'car.spiders'</span>

<span class="token comment"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>
USER_AGENT <span class="token operator">=</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36'</span>

<span class="token comment"># Obey robots.txt rules</span>
ROBOTSTXT_OBEY <span class="token operator">=</span> <span class="token boolean">False</span>
LOG_LEVEL <span class="token operator">=</span> <span class="token string">"WARNING"</span>

<span class="token comment"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>
<span class="token comment"># CONCURRENT_REQUESTS = 32</span>

<span class="token comment"># Configure a delay for requests for the same website (default: 0)</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/settings.html#download-delay</span>
<span class="token comment"># See also autothrottle settings and docs</span>
DOWNLOAD_DELAY <span class="token operator">=</span> <span class="token number">3</span>
<span class="token comment"># The download delay setting will honor only one of:</span>
<span class="token comment"># CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>
<span class="token comment"># CONCURRENT_REQUESTS_PER_IP = 16</span>

<span class="token comment"># Disable cookies (enabled by default)</span>
COOKIES_ENABLED <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token comment"># Disable Telnet Console (enabled by default)</span>
<span class="token comment"># TELNETCONSOLE_ENABLED = False</span>

<span class="token comment"># Override the default request headers:</span>
DEFAULT_REQUEST_HEADERS <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span><span class="token punctuation">,</span>
    <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'en'</span><span class="token punctuation">,</span>
    <span class="token string">"Cookie"</span><span class="token punctuation">:</span> <span class="token string">"listuserarea=0; fvlid=1652426719616u4Xrt5cvwi40; Hm_lvt_d381ec2f88158113b9b76f14c497ed48=1652426720; sessionid=8f823055-9b43-44fd-96a7-6ebeaabb8c5f; sessionip=39.154.171.103; area=150699; sessionvisit=0ac66484-306b-41b1-a2b1-caae86be6f16; sessionvisitInfo=8f823055-9b43-44fd-96a7-6ebeaabb8c5f||0; che_sessionid=1CC9EB24-B4F9-4B9D-B2F7-389ED89C1BB9%7C%7C2022-05-13+15%3A25%3A20.567%7C%7C0; che_sessionvid=FA117386-76D5-4F08-B102-914CDFD4E4F6; userarea=110100; UsedCarBrowseHistory=0%3A43635729; carDownPrice=1; ahpvno=3; Hm_lpvt_d381ec2f88158113b9b76f14c497ed48=1652427405; ahuuid=3EC672D4-DFF9-4DA7-956D-F9D7A2B89915; v_no=3; visit_info_ad=1CC9EB24-B4F9-4B9D-B2F7-389ED89C1BB9||FA117386-76D5-4F08-B102-914CDFD4E4F6||-1||-1||3; che_ref=0%7C0%7C0%7C0%7C2022-05-13+15%3A36%3A45.754%7C2022-05-13+15%3A25%3A20.567; showNum=3; sessionuid=8f823055-9b43-44fd-96a7-6ebeaabb8c5f"</span>
<span class="token punctuation">}</span>

<span class="token comment"># Enable or disable spider middlewares</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/spider-middleware.html</span>
<span class="token comment"># SPIDER_MIDDLEWARES = {<!-- --></span>
<span class="token comment">#    'car.middlewares.CarSpiderMiddleware': 543,</span>
<span class="token comment"># }</span>

<span class="token comment"># Enable or disable downloader middlewares</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/downloader-middleware.html</span>
<span class="token comment"># DOWNLOADER_MIDDLEWARES = {<!-- --></span>
<span class="token comment">#    'car.middlewares.CarDownloaderMiddleware': 543,</span>
<span class="token comment"># }</span>

<span class="token comment"># Enable or disable extensions</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/extensions.html</span>
<span class="token comment"># EXTENSIONS = {<!-- --></span>
<span class="token comment">#    'scrapy.extensions.telnet.TelnetConsole': None,</span>
<span class="token comment"># }</span>

<span class="token comment"># Configure item pipelines</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span>
ITEM_PIPELINES <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
   <span class="token string">'car.pipelines.CarPipeline'</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment"># Enable and configure the AutoThrottle extension (disabled by default)</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/autothrottle.html</span>
<span class="token comment"># AUTOTHROTTLE_ENABLED = True</span>
<span class="token comment"># The initial download delay</span>
<span class="token comment"># AUTOTHROTTLE_START_DELAY = 5</span>
<span class="token comment"># The maximum download delay to be set in case of high latencies</span>
<span class="token comment"># AUTOTHROTTLE_MAX_DELAY = 60</span>
<span class="token comment"># The average number of requests Scrapy should be sending in parallel to</span>
<span class="token comment"># each remote server</span>
<span class="token comment"># AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>
<span class="token comment"># Enable showing throttling stats for every response received:</span>
<span class="token comment"># AUTOTHROTTLE_DEBUG = False</span>

<span class="token comment"># Enable and configure HTTP caching (disabled by default)</span>
<span class="token comment"># See https://docs.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>
<span class="token comment"># HTTPCACHE_ENABLED = True</span>
<span class="token comment"># HTTPCACHE_EXPIRATION_SECS = 0</span>
<span class="token comment"># HTTPCACHE_DIR = 'httpcache'</span>
<span class="token comment"># HTTPCACHE_IGNORE_HTTP_CODES = []</span>
<span class="token comment"># HTTPCACHE_STORAGE = 'scrapy.extensions.httpcache.FilesystemCacheStorage'</span>
</code></pre> 
<p><code>pipelines.py</code></p> 
<pre><code class="prism language-python"><span class="token comment"># Define your item pipelines here</span>
<span class="token comment">#</span>
<span class="token comment"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span>
<span class="token comment"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span>


<span class="token comment"># useful for handling different item types with a single interface</span>
<span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter


<span class="token keyword">class</span> <span class="token class-name">CarPipeline</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"car.csv"</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"w"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'mileage'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'displace'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'standard'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> item
</code></pre> 
<p><code>runner.py</code></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>cmdline <span class="token keyword">import</span> execute

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    execute<span class="token punctuation">(</span><span class="token string">"scrapy crawl jia"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><code>ä¸Šé¢çš„åªæ˜¯ä¸€ç§æ–¹å¼ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼ç®€å•ç²—æš´çš„æ–¹å¼ä¹Ÿå¯ä»¥å®ç°å…¨ç«™æ•°æ®crawling</code><br> <mark>åªæŠ“ä¸€ä¸ªå€’éœ‰è›‹å¾€dieé‡Œæï¼Œç»ˆç©¶å¤ªè¿‡äºæ®‹å¿ğŸ˜ƒï¼Œä¸‹é¢æœ‰è¯·ç¬¬äºŒä¸ªå€’éœ‰è›‹ï¼š</mark><a href="https://www.shicimingjv.com/tangshi/index_1.html" rel="nofollow">æŸè¯—è¯ç½‘ç«™ğŸ“š</a></p> 
<blockquote> 
 <p><code>åˆ›å»ºCrawlSpideré¡¹ç›®</code></p> 
 <pre><code class="prism language-python">scrapy startproject æ–‡ä»¶å
cd æ–‡ä»¶å
scrapy genspider <span class="token operator">-</span>t crawl åç§° è¦çˆ¬å–ç½‘ç«™çš„åŸŸå
</code></pre> 
 <p><code>é…ç½®æ–‡ä»¶è¿˜å’Œä¹‹å‰ä¸€æ ·</code><br> <mark>è¿™ä¸ªç½‘ç«™å’Œä¸Šè¿°ç½‘ç«™çš„ç»“æ„ä¸€æ¨¡ä¸€æ ·ï¼Œä¹Ÿéœ€è¦è¿›å…¥åˆ°è¯¦æƒ…é¡µcrawlingæ•°æ®ï¼Œå¹¶ä¸”åˆ†é¡µ</mark></p> 
 <p><font color="green">æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬åœ¨ç½‘é¡µä¸Šç‚¹å‡»çš„éƒ½æ˜¯è¶…é“¾æ¥ï¼Œé‚£æˆ‘ä»¬åªè¦èƒ½æ‹¿åˆ°æ¯ä¸€ä¸ªè¶…é“¾æ¥ï¼Œå°±å¯ä»¥å®ç°é¡µé¢æ•°æ®çš„crawlingï¼Œæ‰€ä»¥CrawlSpiderå°±ä¸ºæˆ‘ä»¬å‡†å¤‡å¥½äº†é“¾æ¥æå–å™¨</font></p> 
</blockquote> 
<p>ğŸ²<mark>è®©æˆ‘ä»¬ä»¥ä»£ç ä¸ºä¾‹ï¼Œè®²ä¸€ä¸‹é“¾æ¥æå–å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼š</mark></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>linkextractors <span class="token keyword">import</span> LinkExtractor  <span class="token comment"># å¯¼å…¥é“¾æ¥æå–å™¨</span>
<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>spiders <span class="token keyword">import</span> CrawlSpider<span class="token punctuation">,</span> Rule


<span class="token keyword">class</span> <span class="token class-name">TangSpider</span><span class="token punctuation">(</span>CrawlSpider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'tang'</span>  <span class="token comment"># åç§°</span>
    allowed_domains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'shicimingjv.com'</span><span class="token punctuation">]</span>  <span class="token comment"># åŸŸå</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.shicimingjv.com/tangshi/index_1.html'</span><span class="token punctuation">]</span>  <span class="token comment"># é¦–é¡µçš„ç½‘å€</span>

	<span class="token comment"># lk1 = LinkExtractor()  è¡¨ç¤ºé€ ä¸€ä¸ªé“¾æ¥æå–å™¨ï¼Œæ‹¬å·ä¸­çš„è¡¨ç¤ºæå–è§„åˆ™ï¼Œä¸‹å›¾æœ‰æºç çš„è¯¦ç»†è¯´æ˜</span>
    <span class="token comment"># è¯¦æƒ…é¡µçš„urlåœ°å€</span>
    lk1 <span class="token operator">=</span> LinkExtractor<span class="token punctuation">(</span>restrict_xpaths<span class="token operator">=</span><span class="token string">"//div[@class='sec-panel-body']/ul/li/div[1]/h3/a"</span><span class="token punctuation">)</span>
    <span class="token comment"># åˆ†é¡µçš„urlåœ°å€</span>
    lk2 <span class="token operator">=</span> LinkExtractor<span class="token punctuation">(</span>restrict_xpaths<span class="token operator">=</span><span class="token string">"//ul[@class='pagination']/li/a"</span><span class="token punctuation">)</span>

    rules <span class="token operator">=</span> <span class="token punctuation">(</span>
        Rule<span class="token punctuation">(</span>lk1<span class="token punctuation">,</span> callback<span class="token operator">=</span><span class="token string">'parse_item'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># callbackè¡¨ç¤ºè¯·æ±‚å›æ¥è¦æ‰§è¡Œçš„å‡½æ•°</span>
        Rule<span class="token punctuation">(</span>lk2<span class="token punctuation">,</span> follow<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># follow=Trueè¡¨ç¤ºæ˜¯å¦è¦é‡æ–°æ‰§è¡Œä¸€æ¬¡rules</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">parse_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è§£æè¯¦æƒ…é¡µçš„å†…å®¹</span>
        title <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">"//h1[@class='mp3']/text()"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
</code></pre> 
<p><mark>é€šè¿‡å¯¹æ¯”ä¹‹å‰çš„å…¨ç«™æå–æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°CrawlSpiderå°±æ˜¯çœç•¥äº†parseè¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºCrawlSpideræ˜¯é«˜åº¦åˆ†è£…çš„ï¼Œæ‰€ä»¥ä»–çš„çµæ´»æ€§ä¸å¦‚ä¹‹å‰çš„é«˜</mark></p> 
<blockquote> 
 <p>ğŸ†è®©æˆ‘ä»¬è¿›å…¥<code>LinkExtractoræºç </code>ä¸­ä¸€æ¢ç©¶ç«Ÿï¼Œçœ‹çœ‹æå–å™¨çš„æå–æ–¹å¼æ˜¯ä»€ä¹ˆæ ·å­çš„</p> 
 <p><img src="https://images2.imgbox.com/f2/db/1l6zxjZC_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
</blockquote> 
<p>åªè¦æ˜¯é¡µé¢ä¸Šçš„é“¾æ¥ï¼Œç”¨è¿æ¥æå–å™¨éƒ½èƒ½æå–åˆ°ï¼Œæ‰¾åˆ°å¯¹åº”çš„é“¾æ¥å‘é€è¯·æ±‚è¿›è¡Œè§£æï¼Œå°±å¯ä»¥å®ç°çœŸæ­£çš„å…¨ç«™æ•°æ®crawling<br> <mark><font color="red">è¿™äº›å°ä¼™ä¼´ä»¬éƒ½å¯ä»¥è‡ªç”±å‘æŒ¥ï¼Œåˆ‡è®°ä¸è¦å¤ªè¿‡åˆ†ï¼ŒæŠŠäººå®¶ç½‘ç«™å¾€dieé‡Œæï¼Œæ¯•ç«Ÿæˆ‘ä»¬æ˜¯æŠ±ç€å­¦ä¹ çš„ç›®çš„å»çš„ï¼Œåš<strong>å–„è‰¯çš„spider</strong></font></mark></p> 
<hr> 
<blockquote> 
 <p>è®²åˆ°æœ€åï¼Œæœ‰äº›å°ä¼™ä¼´å¯èƒ½ä¸ä¼šè¿è¡Œscrapyï¼Œè¿™é‡Œæˆ‘ä»¬è¯´ä¸¤ç§æ–¹å¼ï¼š</p> 
 <ul><li>æ–¹å¼ä¸€ï¼š<br> è¿›å…¥terminalè¾“å…¥<code>scrapy crawl åç§°</code></li><li>æ–¹å¼äºŒï¼ˆæ¨èï¼‰ï¼š<br> å»ºä¸€ä¸ªpyæ–‡ä»¶runner,å³å‡»å³å¯è¿è¡Œ</li></ul> 
 <pre><code class="prism language-python"><span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>cmdline <span class="token keyword">import</span> execute

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
   execute<span class="token punctuation">(</span><span class="token string">"scrapy crawl åç§°"</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
</blockquote> 
<p>ğŸ™å› å®¡æ ¸çš„åŸå› ï¼Œæœ‰äº›ç»†èŠ‚æ²¡æœ‰åŠæ³•è¯´æ˜ï¼Œåšäº†å¾ˆå¤šçš„åˆ å‡ï¼Œæœ›è°…è§£</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/638619bec63428b0bb2f5766ee004490/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">linuxä¸‹å®‰è£…yumæ­¥éª¤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/378e9a026ef9f06b85293fe384deb558/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">è½¬å½•ç»„-å·®å¼‚åŸºå› çƒ­å›¾</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>