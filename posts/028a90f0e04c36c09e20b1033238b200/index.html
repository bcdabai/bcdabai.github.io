<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hive函数大全 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Hive函数大全" />
<meta property="og:description" content="目录
第四章 Hive函数
4.1 聚合函数
4.2 关系函数
4.3 数学运算
4.4 逻辑运算
4.5 数值运算
4.6 条件函数
4.7 日期函数
4.8 字符串函数
4.9 字符串截取函数 4.10 去空格函数
4.11 正则表达式与解析函数
4.12 explode函数
4.13 行转列与列转行
4.14 基础窗口函数与分析函数
4.14.1 窗口函数简介
4.14.2 窗口的含义
4.14.3 窗口函数分类
4.14.4 窗口函数的使用
4.14.5 窗口函数与group by区别
4.16 高级窗口函数 （todo）
4.17集合操作函数(todo)
4.18类型转换函数
第四章 Hive函数 4.1 聚合函数 Hive支持count(),max(),min(),avg()等常用的聚合函数。
4.2 关系函数 支持 =, !=, &lt;&gt;, &lt; , &gt;, &lt;= , &gt;, &gt;=
空值判断：is null， is not null." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/028a90f0e04c36c09e20b1033238b200/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-12T18:08:23+08:00" />
<meta property="article:modified_time" content="2021-11-12T18:08:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hive函数大全</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E7%AC%AC%E5%9B%9B%E7%AB%A0%20Hive%E5%87%BD%E6%95%B0-toc" style="margin-left:0px;"><a href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0%20Hive%E5%87%BD%E6%95%B0" rel="nofollow" title="第四章 Hive函数">第四章 Hive函数</a></p> 
<p id="4.1%20%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.1%20%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0" rel="nofollow" title="4.1 聚合函数">4.1 聚合函数</a></p> 
<p id="4.2%20%E5%85%B3%E7%B3%BB%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.2%20%E5%85%B3%E7%B3%BB%E5%87%BD%E6%95%B0" rel="nofollow" title="4.2 关系函数">4.2 关系函数</a></p> 
<p id="4.3%20%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97-toc" style="margin-left:40px;"><a href="#4.3%20%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97" rel="nofollow" title="4.3 数学运算">4.3 数学运算</a></p> 
<p id="4.4%20%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97-toc" style="margin-left:40px;"><a href="#4.4%20%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97" rel="nofollow" title="4.4 逻辑运算">4.4 逻辑运算</a></p> 
<p id="4.5%20%E6%95%B0%E5%80%BC%E8%BF%90%E7%AE%97-toc" style="margin-left:40px;"><a href="#4.5%20%E6%95%B0%E5%80%BC%E8%BF%90%E7%AE%97" rel="nofollow" title="4.5 数值运算">4.5 数值运算</a></p> 
<p id="4.6%20%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.6%20%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0" rel="nofollow" title="4.6 条件函数">4.6 条件函数</a></p> 
<p id="4.7%20%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.7%20%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0" rel="nofollow" title="4.7 日期函数">4.7 日期函数</a></p> 
<p id="4.8%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.8%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0" rel="nofollow" title="4.8 字符串函数">4.8 字符串函数</a></p> 
<p id="4.9%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96%E5%87%BD%E6%95%B0%C2%A0-toc" style="margin-left:40px;"><a href="#4.9%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96%E5%87%BD%E6%95%B0%C2%A0" rel="nofollow" title="4.9 字符串截取函数 ">4.9 字符串截取函数 </a></p> 
<p id="4.10%20%E5%8E%BB%E7%A9%BA%E6%A0%BC%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.10%20%E5%8E%BB%E7%A9%BA%E6%A0%BC%E5%87%BD%E6%95%B0" rel="nofollow" title="4.10 去空格函数">4.10 去空格函数</a></p> 
<p id="4.11%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E8%A7%A3%E6%9E%90%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.11%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E8%A7%A3%E6%9E%90%E5%87%BD%E6%95%B0" rel="nofollow" title="4.11 正则表达式与解析函数">4.11 正则表达式与解析函数</a></p> 
<p id="4.12%20explode%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.12%20explode%E5%87%BD%E6%95%B0" rel="nofollow" title="4.12 explode函数">4.12 explode函数</a></p> 
<p id="4.13%20%E8%A1%8C%E8%BD%AC%E5%88%97%E4%B8%8E%E5%88%97%E8%BD%AC%E8%A1%8C-toc" style="margin-left:40px;"><a href="#4.13%20%E8%A1%8C%E8%BD%AC%E5%88%97%E4%B8%8E%E5%88%97%E8%BD%AC%E8%A1%8C" rel="nofollow" title="4.13 行转列与列转行">4.13 行转列与列转行</a></p> 
<p id="4.14%20%E5%9F%BA%E7%A1%80%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E4%B8%8E%E5%88%86%E6%9E%90%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.14%20%E5%9F%BA%E7%A1%80%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E4%B8%8E%E5%88%86%E6%9E%90%E5%87%BD%E6%95%B0" rel="nofollow" title="4.14 基础窗口函数与分析函数">4.14 基础窗口函数与分析函数</a></p> 
<p id="4.14.1%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B-toc" style="margin-left:80px;"><a href="#4.14.1%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B" rel="nofollow" title="4.14.1 窗口函数简介">4.14.1 窗口函数简介</a></p> 
<p id="4.14.2%20%E7%AA%97%E5%8F%A3%E7%9A%84%E5%90%AB%E4%B9%89-toc" style="margin-left:80px;"><a href="#4.14.2%20%E7%AA%97%E5%8F%A3%E7%9A%84%E5%90%AB%E4%B9%89" rel="nofollow" title="4.14.2 窗口的含义">4.14.2 窗口的含义</a></p> 
<p id="4.14.3%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%88%86%E7%B1%BB-toc" style="margin-left:80px;"><a href="#4.14.3%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%88%86%E7%B1%BB" rel="nofollow" title="4.14.3 窗口函数分类">4.14.3 窗口函数分类</a></p> 
<p id="4.14.4%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#4.14.4%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8" rel="nofollow" title="4.14.4 窗口函数的使用">4.14.4 窗口函数的使用</a></p> 
<p id="4.14.5%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E4%B8%8Egroup%20by%E5%8C%BA%E5%88%AB-toc" style="margin-left:80px;"><a href="#4.14.5%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E4%B8%8Egroup%20by%E5%8C%BA%E5%88%AB" rel="nofollow" title="4.14.5 窗口函数与group by区别">4.14.5 窗口函数与group by区别</a></p> 
<p id="4.16%20%E9%AB%98%E7%BA%A7%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%20%EF%BC%88todo%EF%BC%89-toc" style="margin-left:40px;"><a href="#4.16%20%E9%AB%98%E7%BA%A7%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%20%EF%BC%88todo%EF%BC%89" rel="nofollow" title="4.16 高级窗口函数 （todo）">4.16 高级窗口函数 （todo）</a></p> 
<p id="4.17%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0(todo)-toc" style="margin-left:40px;"><a href="#4.17%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0%28todo%29" rel="nofollow" title="4.17集合操作函数(todo)">4.17集合操作函数(todo)</a></p> 
<p id="4.18%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0-toc" style="margin-left:40px;"><a href="#4.18%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0" rel="nofollow" title="4.18类型转换函数">4.18类型转换函数</a></p> 
<hr id="hr-toc"> 
<h2 id="%E7%AC%AC%E5%9B%9B%E7%AB%A0%20Hive%E5%87%BD%E6%95%B0"><strong id="docs-internal-guid-00469a4e-7fff-d05e-b2e2-f61d7723980b">第四章 Hive函数</strong></h2> 
<h3 id="4.1%20%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><strong>4.1 聚合函数</strong></h3> 
<p><strong>        Hive支持count(),max(),min(),avg()等常用的聚合函数。</strong></p> 
<h3 id="4.2%20%E5%85%B3%E7%B3%BB%E5%87%BD%E6%95%B0"><strong>4.2 关系函数</strong></h3> 
<p><strong>        支持 =, !=, &lt;&gt;, &lt; , &gt;, &lt;= , &gt;, &gt;=</strong></p> 
<p><strong>        空值判断：is null， is not null.</strong></p> 
<p><strong>        relike， regexp操作。</strong></p> 
<h3 id="4.3%20%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><strong>4.3 数学运算</strong></h3> 
<p><strong>        支持所有的数值类型： + , - , * , /， % ，&amp; , | , ^, ~等。</strong></p> 
<h3 id="4.4%20%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><strong>4.4 逻辑运算</strong></h3> 
<p><strong>        逻辑与： and</strong></p> 
<p><strong>        逻辑或： or</strong></p> 
<p><strong>        逻辑非： not</strong></p> 
<h3 id="4.5%20%E6%95%B0%E5%80%BC%E8%BF%90%E7%AE%97"><strong>4.5 数值运算</strong></h3> 
<ul><li> <p><strong>取整函数: round()</strong></p> </li></ul> 
<p><strong>round(double a)    返回值bigint，返回double类型的整数值部门(遵循四舍五入)</strong></p> 
<ul><li> <p><strong>指定精度取整函数</strong></p> </li></ul> 
<p><strong>round(double a, int d)  返回值double。返回指定指定精度d的double类型。</strong></p> 
<ul><li> <p><strong>向下取整函数</strong></p> </li></ul> 
<p><strong>floor(double a )返回等于或者大于该double变量的最小的整数。</strong></p> 
<ul><li> <p><strong>向上取整函数</strong></p> </li></ul> 
<p><strong>ceil(double  a)   返回等于或者大于该double 变量的最小的整数；</strong></p> 
<ul><li> <p><strong>取随机函数</strong></p> </li></ul> 
<p><strong>rand(), rand(int  seed):返回一个0到1范围内的随机数。</strong></p> 
<ul><li> <p><strong>自然指数函数</strong></p> </li></ul> 
<p><strong>exp():  返回自然对数e的a次方。</strong></p> 
<ul><li> <p><strong>幂运算函数</strong></p> </li></ul> 
<p><strong>pow(double  a, double  p)：  返回a的p次幂。</strong></p> 
<ul><li> <p><strong>开平方函数</strong></p> </li></ul> 
<p><strong>sqrt(double a)： 返回a的平方根。</strong></p> 
<h3 id="4.6%20%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0"><strong>4.6 条件函数</strong></h3> 
<ul><li> <p><strong>if函数</strong></p> </li></ul> 
<p><strong>if(boolean  testCondition,T  valueTrue,  T  valueFalseOrNull)</strong></p> 
<p><strong>当条件testCondition为True时候，返回valueTrue,否则返回valueFalseOrNull</strong></p> 
<ul><li> <p><strong>非空查找函数coalesce</strong></p> </li></ul> 
<p><strong>coalesce(T  v1,  T v2,.....) </strong></p> 
<p><strong>返回参数中第一个非空值，如果所有值都为null，那么返回Null。</strong></p> 
<ul><li> <p><strong>条件判断函数case when</strong></p> </li></ul> 
<p><strong>case when写法一：</strong></p> 
<p><strong>case sex </strong></p> 
<p><strong>        when   ‘1’    then   ‘男’</strong></p> 
<p><strong>        when   ‘2’    then   ‘女’</strong></p> 
<p><strong>else   ‘其他’  end</strong></p> 
<p><strong>case when写法二：</strong></p> 
<p><strong>case when sex = ‘1’  then  ‘男’</strong></p> 
<p><strong>         when sex = ‘2’  then  ‘女’</strong></p> 
<p><strong>else   ‘其他’  end</strong></p> 
<h3 id="4.7%20%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><strong>4.7 日期函数</strong></h3> 
<p><strong>1.unix_timestamp函数的三种情况：</strong></p> 
<ul><li> <p><strong>获取当前时间戳函数:  unix_timestamp</strong></p> </li></ul> 
<p><strong>            语法：unix_timestamp();     </strong></p> 
<p><strong>            返回值：bigint ,获得当前时区的unix时间戳</strong></p> 
<p><strong>            样例：select  unix_timestamp()  from  table;</strong></p> 
<ul><li> <p><strong>日期转unix时间戳函数:unit_timestamp</strong></p> </li></ul> 
<p><strong>            语法：unix_timestamp(String  date)</strong></p> 
<p><strong>            返回值：bigint</strong></p> 
<p><strong>            说明：将格式为”yyyy-MM-dd HH:ss”的日期转换到unix时间戳，如果转换失败，则返回0.</strong></p> 
<ul><li> <p><strong>将指定格式日期转unix时间戳函数:unix_timestamp() </strong></p> </li></ul> 
<p><strong>语法：unix_timestamp(string date, string pattern)</strong></p> 
<p><strong>返回值：bigint</strong></p> 
<p><strong>说明：转换pattern格式日期到unix时间戳。如果转化失败，则返回0.</strong></p> 
<p><strong>样例：select  unix_timestamp(‘2021-03-08 14:21:11’,’yyyy-MM-dd HH:mm:ss’) from table</strong></p> 
<p><strong>2.unit时间戳转日期函数: from_unixtime</strong></p> 
<ul><li> <p><strong>from_unixtime()</strong></p> </li></ul> 
<p><strong>            语法：from_unixtime(bigint  unixtime)</strong></p> 
<p><strong>            返回值：string</strong></p> 
<p><strong>            说明：把具体的秒转化为时间日期。</strong></p> 
<p><strong>3.获取当前的时间精确到毫秒</strong></p> 
<ul><li> <p><strong>current_timestamp()</strong></p> </li></ul> 
<p><strong>            样例:select current_timestamp()  -- 2011-09-02 10:11:09.234212000</strong></p> 
<p><strong>4.日期时间转日期函数:to_date</strong></p> 
<ul><li> <p><strong>年月日时分秒只取其中的年月日部分：to_date（）</strong></p> </li></ul> 
<p><strong>            语法：to_date(string  timestamp)</strong></p> 
<p><strong>            返回值：string   返回日期时间部分的日期。</strong></p> 
<p><strong>            样例：select  to_date(‘2021-09-02 12:09:09’) from table</strong></p> 
<p><strong>5.日期转年/月/日/小时/分钟/秒/周函数</strong></p> 
<ul><li> <p><strong>日期转年函数year()</strong></p> </li></ul> 
<p><strong>语法：year(String date)</strong></p> 
<p><strong>返回值:int   返回日期中的年</strong></p> 
<p><strong>样例：select  year(‘2021-03-21 10:11:02’) from table</strong></p> 
<ul><li> <p><strong>日期转月函数mounth</strong></p> </li></ul> 
<p><strong>            返回日期中的月</strong></p> 
<ul><li> <p><strong>日期转天函数day</strong></p> </li></ul> 
<p><strong>返回日期中的天</strong></p> 
<ul><li> <p><strong>日期转小时函数:hour</strong></p> </li></ul> 
<p><strong>返回日期中小时函数</strong></p> 
<ul><li> <p><strong>日期转分钟函数minute</strong></p> </li></ul> 
<p><strong>            返回日期中的分钟</strong></p> 
<ul><li> <p><strong>日期转秒函数second</strong></p> </li></ul> 
<p><strong>            返回日期中的秒</strong></p> 
<ul><li> <p><strong>日期转周函数 weekofyear</strong></p> </li></ul> 
<p><strong>            weekofyear(string  date)</strong></p> 
<p><strong>            返回值为int，返回日期在当前的周数</strong></p> 
<p><strong>6.日期操作函数</strong></p> 
<ul><li> <p><strong>日期比较函数：datediff</strong></p> </li></ul> 
<p><strong>            语法:datediff(string   enddate, string  startdate)</strong></p> 
<p><strong>            返回值:int  返回结束日期减去开始日期</strong></p> 
<ul><li> <p><strong>日期增加函数 ：date_add</strong></p> </li></ul> 
<p><strong>语法：date_add(string startdate, int days)</strong></p> 
<p><strong>返回值string，返回开始日期startdate增加days天的日期。</strong></p> 
<ul><li> <p><strong>日期减少函数 date_sub</strong></p> </li></ul> 
<p><strong>            语法：date_sub(string startdate, int days)</strong></p> 
<p><strong>            返回值：string. 返回开始日期startdate减少days天后的日期。</strong></p> 
<h3 id="4.8%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><strong>4.8 字符串函数</strong></h3> 
<ul><li> <p><strong>字符串长度函数: length()</strong></p> </li></ul> 
<p><strong>            length(string a): 返回字符串a的长度</strong></p> 
<ul><li> <p><strong>字符串反转函数：reverse</strong></p> </li></ul> 
<p><strong>            reverse(string  a) ：返回字符串a的反转结果</strong></p> 
<ul><li> <p><strong>字符串连接函数</strong></p> </li></ul> 
<p><strong>            不带分隔符的字符串连接函数concat()</strong></p> 
<p><strong>                    语法:concat(string A, string B，........)</strong></p> 
<p><strong>                    返回输入字符串连接后的结果，支持任意个输入字符串</strong></p> 
<p><strong>            带分隔符字符串连接函数 concat_ws()</strong></p> 
<p><strong>                    concat_ws(String SEP, string a, string b)</strong></p> 
<p><strong>                    返回输入字符串连接后的结果，sep表示各个字符串之间的分隔符。</strong></p> 
<h3 id="4.9%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96%E5%87%BD%E6%95%B0%C2%A0"><strong>4.9 字符串截取函数 </strong></h3> 
<ul><li> <p><strong>substr(string a, int start, int len)</strong></p> </li></ul> 
<p><strong>            返回字符串a从start位置开始，长度为len的字符串。</strong></p> 
<ul><li> <p><strong>substring(string a, int start, int len)</strong></p> </li></ul> 
<p><strong>返回字符串a从start位置开始，长度为len的字符串。</strong></p> 
<ul><li> <p><strong>字符串分割函数：split</strong></p> </li></ul> 
<p><strong> 语法：split(string  str, string pat) </strong></p> 
<h3 id="4.10%20%E5%8E%BB%E7%A9%BA%E6%A0%BC%E5%87%BD%E6%95%B0"><strong>4.10 去空格函数</strong></h3> 
<ul><li> <p><strong>去空格函数trim</strong></p> </li></ul> 
<p><strong>             去掉字符串两边的空格</strong></p> 
<ul><li> <p><strong>左边去空格ltrim</strong></p> </li></ul> 
<p><strong>            ltrim(string  a) 去掉字符串左边的空格。</strong></p> 
<ul><li> <p><strong>右边去空格函数</strong></p> </li></ul> 
<p><strong>rtrim(string a)去掉字符串右边的空格。</strong></p> 
<h3 id="4.11%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E8%A7%A3%E6%9E%90%E5%87%BD%E6%95%B0"><strong>4.11 正则表达式与解析函数</strong></h3> 
<ul><li> <p><strong>正则表达式替换函数regexp_replace(string a, string b, string c)</strong></p> </li></ul> 
<p><strong>            将字符串a中符合java正则表达式b的部分替换为c.注意在有些情况下需要使用转义字符.    <br>             样例：select  regexp_replace(‘foobar’, ‘oo|ar’ , ‘’) from table_Name;</strong></p> 
<ul><li> <p><strong>正则表达式解析函数：regexp_extract(string subject, string pattern, int index)</strong></p> </li></ul> 
<p><strong>            样例：select  regexp_extract(‘foothebar’, ‘foo(.*?)(bar)’, 1) from tableName; </strong></p> 
<p><strong>             将字符串subject按照pattern正则表达式的规则拆分，返回index指定的字符。</strong></p> 
<ul><li> <p><strong>url解析函数: parse_url</strong></p> </li></ul> 
<p><strong>样例：parse_url(string  urlString, string  partToExtract  [,  string  keyToExtract] )</strong></p> 
<p><strong>说明：返回url中指定的部分。</strong></p> 
<ul><li> <p><strong>json解析：get_json_object()</strong></p> </li></ul> 
<p><strong>            语法：get_json_object(string  json_string, string  path)</strong></p> 
<p><strong>            样例：select  get_json_object(‘{......}’, ‘$.owner’)  from  tableName;</strong></p> 
<h3 id="4.12%20explode%E5%87%BD%E6%95%B0"><strong>4.12 explode函数</strong></h3> 
<p><strong>    todo:结合百度需求进行总结</strong></p> 
<h3 id="4.13%20%E8%A1%8C%E8%BD%AC%E5%88%97%E4%B8%8E%E5%88%97%E8%BD%AC%E8%A1%8C"><strong>4.13 行转列与列转行</strong></h3> 
<p><strong>1.行转列</strong></p> 
<ul><li> <p><strong>concat(string a/col, string b/col,.....):返回输入字符串连接后的结果，支持任意个输入字符串。</strong></p> </li><li> <p><strong>concat_ws(separator, str1, str2,....):它是一个特殊形式的concat</strong></p> </li><li> <p><strong>collect_set(col):将某字段的值进行去重汇总，产生array类型字段。</strong></p> </li></ul> 
<p><strong>2.列转行</strong></p> 
<ul><li> <p><strong>explode(col)</strong></p> </li></ul> 
<p><strong>           将hive一列中复杂的array或者map结构拆成多行。可以结合lateral view进行使用。</strong></p> 
<h3 id="4.14%20%E5%9F%BA%E7%A1%80%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E4%B8%8E%E5%88%86%E6%9E%90%E5%87%BD%E6%95%B0"><strong>4.14 基础窗口函数与分析函数</strong></h3> 
<h4 id="4.14.1%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%AE%80%E4%BB%8B"><strong>4.14.1 窗口函数简介</strong></h4> 
<p><strong>        在sql中有一类函数叫做聚合函数，例如sum(), avg(),max()等等，这类函数可以将多行数据按照规则聚集为一行，一般来讲，聚集后的行数是要少于聚集前的行数的。但是有时候我们既想要显示聚集前的数据，又要显示聚集后的函数，这个时候，我们便引入了窗口函数。窗口函数又叫OLAP函数/分析函数.</strong></p> 
<p><strong>        窗口函数最重要的关键字是partition by和 order by.具体语法是：over(partition  by  用于分组的列名  order  by  用于排序的列名)。</strong></p> 
<h4 id="4.14.2%20%E7%AA%97%E5%8F%A3%E7%9A%84%E5%90%AB%E4%B9%89"><strong>4.14.2 窗口的含义</strong></h4> 
<p><strong>1）如果不指定rows between,默认为从起点到当前行；</strong></p> 
<p><strong>2）如果不指定order by,则将分组内所有值累加；</strong></p> 
<p><strong>3）理解rows between的含义，也叫window子句：</strong></p> 
<p><strong>          preceding:往前；</strong></p> 
<p><strong>          following：往后；</strong></p> 
<p><strong>          current row: 当前行；</strong></p> 
<p><strong>          unbounded:起点；</strong></p> 
<p><strong>          unbounded  preceding : 表示从前面的起点；</strong></p> 
<p><strong>          unbounded  following : 表示到后面的终点；</strong></p> 
<h4 id="4.14.3%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%88%86%E7%B1%BB"><strong>4.14.3 窗口函数分类</strong></h4> 
<p><strong>1）专用窗口函数：包括dense_rank(),rank(),row_number()等。</strong></p> 
<p><strong>2）聚合函数：例如sum(), avg(),max(),min(),count().</strong></p> 
<p><strong>样例1：</strong></p> 
<p><strong>select   *,        </strong></p> 
<p><strong>sum(play_rate) over(order by user_id),        </strong></p> 
<p><strong>avg(play_rate) over(order by user_id),        </strong></p> 
<p><strong>max(play_rate) over(order by user_id),        </strong></p> 
<p><strong>min(play_rate) over(order by user_id),        </strong></p> 
<p><strong>count(play_rate) over(order by user_id) </strong></p> 
<p><strong>from haokan_ads_test02;</strong></p> 
<p><strong>样例1测试结果：</strong></p> 
<p></p> 
<p><strong>样例1分析：</strong></p> 
<p><strong>    聚合函数在窗口函数中，是对自身记录及位于自身记录以上的数据进行求和的结果。eg:user_id为4的时候，在使用sum()窗口函数后的结果，是对1，2，3，4号deplat_rate求和。</strong></p> 
<p><strong>注意1：可以注意到专用窗口函数括号里面是空的，什么也没有写，但是聚合函数后面括号不能为空，需要指定聚合的列名。</strong></p> 
<p><strong>注意2：因为窗口函数是对where或者group by子句处理后的结果进行的操作，所以窗口函数原则上只能写在select子句中。</strong></p> 
<p><strong>注意3：聚合函数对应的窗口函数都是对自身记录，以及自身记录之上的所有数据进行计算。如果想看所有人的聚合情况，我们直接看输出结果的最后一行即可。</strong></p> 
<h4 id="4.14.4%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8"><strong>4.14.4 窗口函数的使用</strong></h4> 
<p><strong>1）为什么叫窗口函数：这是因为partition by分组以后的结果叫做窗口，这里的窗口是范围的意思。窗口函数同时具有分组和排序的功能；不减少原有表的行数</strong></p> 
<p><strong>2）带partition by使用区别：</strong></p> 
<p><strong>      窗口函数中的partition by子句可以省去，但是此时就失去了分组的功能。</strong></p> 
<p><strong>      窗口函数一般用于排名问题和top-N问题。</strong></p> 
<p></p> 
<p><strong>3）dense_rank(),rank(),row_number()区别</strong></p> 
<ul><li> <p><strong>DENSE_RANK() :排序相同时，会重复、总数会减少。1,1,2</strong></p> </li><li> <p><strong>Rank()  :排序相同时，会重复，但是总数不会变。 1,1,3</strong></p> </li><li> <p><strong>ROW_NUMBER(): 会根据顺序计算。1，2,3</strong></p> </li></ul> 
<h4 id="4.14.5%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E4%B8%8Egroup%20by%E5%8C%BA%E5%88%AB"><strong>4.14.5 窗口函数与group by区别</strong></h4> 
<p><strong>         group by分组汇总会改变行数（默认返回每组中的第一行）；而窗口函数不会减少原表中的行数。</strong></p> 
<p></p> 
<h3 id="4.16%20%E9%AB%98%E7%BA%A7%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%20%EF%BC%88todo%EF%BC%89"><strong>4.16 高级窗口函数 （todo）</strong></h3> 
<p><strong>ntile;</strong></p> 
<p><strong>lag:</strong></p> 
<p><strong>     lag(col,n,default)用于统计窗口内往上第n行值；第一个参数为列名，第二个参数为往上第n行（可选，默认为1），第三个参数为默认值（当往上第n行为null时候，取默认值，如果不指定，则为null）</strong></p> 
<p><strong>lead:</strong></p> 
<p><strong>        与lag相反。lead(col,n, default)用于统计窗口内往下第n行值。第一个参数为列名，第二个参数为往下第n行，第三个参数为默认值。</strong></p> 
<p><strong>first_value</strong></p> 
<p><strong>        取分组内排序后，截止到当前行，第一个值。</strong></p> 
<p><strong>last_value:</strong></p> 
<p><strong>         取分组内排序后，截止到当前行，最后一个值。</strong></p> 
<h3 id="4.17%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0(todo)"><strong>4.17集合操作函数(todo)</strong></h3> 
<p><strong>grouping  sets</strong></p> 
<p><strong>grouping_id</strong></p> 
<p><strong>cube</strong></p> 
<p><strong>rollup</strong></p> 
<h3 id="4.18%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0"><strong>4.18类型转换函数</strong></h3> 
<p><strong>    cast (字段名  as   转换的类型)</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bf2c9638a4cb659ce2f7eac3c2368f99/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决火狐浏览器52版本，es6无法编译问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/227c0810acb873a5eaa6ec18727bc989/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#JIT的概念及作用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>