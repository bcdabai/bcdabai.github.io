<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>关系数据库SQL数据查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="关系数据库SQL数据查询" />
<meta property="og:description" content="关系数据库SQL数据查询 数据查询 一、单表查询 1.查询仅涉及一个表，选择表中的若干列 [例1] 查询全体学生的学号与姓名。 SELECT Sno,Sname FROM Student; [例2] 查询全体学生的姓名、学号、所在系。 SELECT Sname,Sno,Sdept FROM Student; 查询全部列
选出所有属性列：在SELECT关键字后面列出所有列名将&lt;目标列表达式&gt;指定为 * [例3] 查询全体学生的详细记录 SELECT Sno,Sname,Ssex,Sage,Sdept FROM Student; 或 SELECT * FROM Student; 查询经过计算的值
SELECT子句的&lt;目标列表达式&gt;不仅可以为表中的属性列，也可以是表达式 [例4] 查全体学生的姓名及其出生年份。 SELECT Sname,2014-Sage /*假设当时为2014年*/ FROM Student; 输出结果： Sname 2014-Sage 李勇 1994 刘晨 1995 王敏 1996 张立 1995 使用列别名改变查询结果的列标题:
SELECT Sname NAME,&#39;Year of Birth:&#39; BIRTH, 2014-Sage BIRTHDAY,LOWER(Sdept) DEPARTMENT FROM Student; 输出结果： NAME BIRTH BIRTHDAY DEPARTMENT 李勇 Year of Birth: 1994 cs 刘晨 Year of Birth: 1995 cs 王敏 Year of Birth: 1996 ma 张立 Year of Birth: 1995 is 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e90d3bcc11c19a9ba03bb6edb8363ea5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-16T23:34:47+08:00" />
<meta property="article:modified_time" content="2023-06-16T23:34:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">关系数据库SQL数据查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SQL_0"></a>关系数据库SQL数据查询</h2> 
<h2><a id="_2"></a>数据查询</h2> 
<h3><a id="_4"></a>一、单表查询</h3> 
<h4><a id="1_6"></a>1.查询仅涉及一个表，选择表中的若干列</h4> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>例<span class="token number">1</span><span class="token punctuation">]</span>  查询全体学生的学号与姓名。
	<span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span>Sname
	<span class="token keyword">FROM</span> Student<span class="token punctuation">;</span> 

<span class="token punctuation">[</span>例<span class="token number">2</span><span class="token punctuation">]</span>  查询全体学生的姓名、学号、所在系。
	<span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span>Sno<span class="token punctuation">,</span>Sdept
	<span class="token keyword">FROM</span> Student<span class="token punctuation">;</span>
</code></pre> 
<p><strong>查询全部列</strong></p> 
<ul><li>选出所有属性列：</li><li>在SELECT关键字后面列出所有列名</li><li>将&lt;目标列表达式&gt;指定为 *</li></ul> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例<span class="token number">3</span><span class="token punctuation">]</span>  查询全体学生的详细记录
	<span class="token keyword">SELECT</span>  Sno<span class="token punctuation">,</span>Sname<span class="token punctuation">,</span>Ssex<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>Sdept 
	<span class="token keyword">FROM</span> Student<span class="token punctuation">;</span> 
	或
	<span class="token keyword">SELECT</span>  <span class="token operator">*</span>
	<span class="token keyword">FROM</span> Student<span class="token punctuation">;</span> 
</code></pre> 
<p><strong>查询经过计算的值</strong></p> 
<ul><li>SELECT子句的&lt;目标列表达式&gt;不仅可以为表中的属性列，也可以是表达式</li></ul> 
<pre><code class="prism language-sql"> <span class="token punctuation">[</span>例<span class="token number">4</span><span class="token punctuation">]</span>  查全体学生的姓名及其出生年份。
 <span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span><span class="token number">2014</span><span class="token operator">-</span>Sage          <span class="token comment">/*假设当时为2014年*/</span>
 <span class="token keyword">FROM</span> Student<span class="token punctuation">;</span>
 输出结果：
             Sname   <span class="token number">2014</span><span class="token operator">-</span>Sage
                李勇         <span class="token number">1994</span>
                刘晨         <span class="token number">1995</span>
                王敏         <span class="token number">1996</span>
                张立         <span class="token number">1995</span> 
</code></pre> 
<p><strong>使用列别名改变查询结果的列标题:</strong></p> 
<pre><code class="prism language-sql">	     <span class="token keyword">SELECT</span> Sname NAME<span class="token punctuation">,</span><span class="token string">'Year of Birth:'</span>  BIRTH<span class="token punctuation">,</span>
	       <span class="token number">2014</span><span class="token operator">-</span>Sage  BIRTHDAY<span class="token punctuation">,</span>LOWER<span class="token punctuation">(</span>Sdept<span class="token punctuation">)</span>  DEPARTMENT
		<span class="token keyword">FROM</span> Student<span class="token punctuation">;</span>
	输出结果：
	    NAME      BIRTH         BIRTHDAY   DEPARTMENT
	   
	     李勇    <span class="token keyword">Year</span> <span class="token keyword">of</span> Birth:    <span class="token number">1994</span>             cs
	     刘晨    <span class="token keyword">Year</span> <span class="token keyword">of</span> Birth:    <span class="token number">1995</span>             cs
	     王敏    <span class="token keyword">Year</span> <span class="token keyword">of</span> Birth:    <span class="token number">1996</span>             ma
	     张立    <span class="token keyword">Year</span> <span class="token keyword">of</span> Birth:    <span class="token number">1995</span>             <span class="token operator">is</span>
</code></pre> 
<h4><a id="2_64"></a>2.选择表中的若干元组</h4> 
<p><strong>消除取值重复的行</strong></p> 
<p>如果没有指定DISTINCT关键词，则缺省为ALL</p> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例<span class="token number">5</span><span class="token punctuation">]</span>  查询选修了课程的学生学号。
	    <span class="token keyword">SELECT</span> Sno   <span class="token keyword">FROM</span> SC<span class="token punctuation">;</span>
		等价于：
		<span class="token keyword">SELECT</span> <span class="token keyword">ALL</span>  Sno  <span class="token keyword">FROM</span> SC<span class="token punctuation">;</span>
		执行上面的<span class="token keyword">SELECT</span>语句后，结果为： 
						    Sno
	
						<span class="token number">201215121</span>
						<span class="token number">201215121</span>
						<span class="token number">201215121</span>
						<span class="token number">201215122</span>
						<span class="token number">201215122</span>
</code></pre> 
<p><strong>指定DISTINCT关键词，去掉表中重复的行</strong></p> 
<pre><code class="prism language-sql">	   <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Sno
	    <span class="token keyword">FROM</span> SC<span class="token punctuation">;</span> 
	
	    执行结果：
						    Sno
	
						<span class="token number">201215121</span>
						<span class="token number">201215122</span>
</code></pre> 
<h5><a id="_98"></a><strong>常用的查询条件：</strong></h5> 
<p><img src="https://images2.imgbox.com/a2/0d/EwCaVtSS_o.png" alt="在这里插入图片描述"></p> 
<p><strong>1. 比较大小：</strong></p> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例<span class="token number">6</span><span class="token punctuation">]</span> 查询计算机科学系全体学生的名单。
	    <span class="token keyword">SELECT</span> Sname
	    <span class="token keyword">FROM</span>     Student
	    <span class="token keyword">WHERE</span>  Sdept<span class="token operator">=</span>‘CS’<span class="token punctuation">;</span> 
	<span class="token punctuation">[</span>例<span class="token number">7</span><span class="token punctuation">]</span>查询所有年龄在<span class="token number">20</span>岁以下的学生姓名及其年龄。
	     <span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span>Sage 
	     <span class="token keyword">FROM</span>     Student    
	     <span class="token keyword">WHERE</span>  Sage <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token punctuation">[</span>例<span class="token number">8</span><span class="token punctuation">]</span>查询考试成绩有不及格的学生的学号。
	    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Sn
	    <span class="token keyword">FROM</span>  SC
	    <span class="token keyword">WHERE</span> Grade<span class="token operator">&lt;</span><span class="token number">60</span><span class="token punctuation">;</span> 
</code></pre> 
<p><strong>2. 确定范围：</strong><br> 谓词: BETWEEN … AND …</p> 
<p>NOT BETWEEN … AND …</p> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例<span class="token number">9</span><span class="token punctuation">]</span> 查询年龄在<span class="token number">20</span><span class="token operator">~</span><span class="token number">23</span>岁（包括<span class="token number">20</span>岁和<span class="token number">23</span>岁）之间的学生的姓名、系别和年龄
	     <span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span> Sdept<span class="token punctuation">,</span> Sage
	<span class="token keyword">FROM</span>     Student
	<span class="token keyword">WHERE</span>   Sage <span class="token operator">BETWEEN</span> <span class="token number">20</span> <span class="token operator">AND</span> <span class="token number">23</span><span class="token punctuation">;</span> 
	
	<span class="token punctuation">[</span>例<span class="token number">10</span><span class="token punctuation">]</span>  查询年龄不在<span class="token number">20</span><span class="token operator">~</span><span class="token number">23</span>岁之间的学生姓名、系别和年龄
		       <span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span> Sdept<span class="token punctuation">,</span> Sage
		       <span class="token keyword">FROM</span>    Student
		       <span class="token keyword">WHERE</span> Sage <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">20</span> <span class="token operator">AND</span> <span class="token number">23</span><span class="token punctuation">;</span> 
</code></pre> 
<p><strong>3. 确定集合：</strong><br> 谓词：IN &lt;值表&gt;, NOT IN &lt;值表&gt;</p> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例<span class="token number">11</span><span class="token punctuation">]</span>查询计算机科学系（CS）、数学系（MA）和信息系（<span class="token operator">IS</span>）学生的姓名和性别。
		<span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span> Ssex
		<span class="token keyword">FROM</span>  Student
		<span class="token keyword">WHERE</span> Sdept <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'CS'</span><span class="token punctuation">,</span><span class="token string">'MA’,'</span><span class="token operator">IS</span><span class="token string">' );
	
	[例12]查询既不是计算机科学系、数学系，也不是信息系的学生的姓名和性别。
		SELECT Sname, Ssex
		FROM Student
		      WHERE Sdept NOT IN ('</span><span class="token operator">IS</span><span class="token string">','</span>MA’<span class="token punctuation">,</span><span class="token string">'CS'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="4"><li>字符匹配：</li></ol> 
<ul><li> <p>谓词： [NOT] LIKE ‘&lt;匹配串&gt;’ [ESCAPE ‘ &lt;换码字符&gt;’]</p> </li><li> <p>&lt;匹配串&gt;可以是一个完整的字符串，也可以含有通配符%和 _</p> </li><li> <p>% （百分号） 代表任意长度（长度可以为0）的字符串</p> </li><li> <p>例如a%b表示以a开头，以b结尾的任意长度的字符串<br> _ （下横线） 代表任意单个字符。</p> </li><li> <p>例如a_b表示以a开头，以b结尾的长度为3的任意字符串</p> </li></ul> 
<pre><code class="prism language-sql"> 匹配串为固定字符串
 
 <span class="token punctuation">[</span>例<span class="token number">13</span><span class="token punctuation">]</span>  查询学号为<span class="token number">201215121</span>的学生的详细情况。
       <span class="token keyword">SELECT</span> <span class="token operator">*</span>    
      <span class="token keyword">FROM</span>  Student  
      <span class="token keyword">WHERE</span>  Sno <span class="token operator">LIKE</span> ‘<span class="token number">201215121</span><span class="token string">';
 
 等价于： 
        SELECT  * 
       FROM  Student 
       WHERE Sno = '</span> <span class="token number">201215121</span> <span class="token string">';

 匹配串为含通配符的字符串
 [例14]  查询所有姓刘学生的姓名、学号和性别。
        SELECT Sname, Sno, Ssex
       FROM Student
       WHERE  Sname LIKE '</span>刘<span class="token operator">%</span><span class="token string">';
 
 [例15]  查询姓"欧阳"且全名为三个汉字的学生的姓名。
        SELECT Sname
       FROM   Student
       WHERE  Sname LIKE '</span>欧阳__'<span class="token punctuation">;</span>

</code></pre> 
<p><em>使用换码字符将通配符转义为普通字符</em></p> 
<pre><code class="prism language-sql">	 <span class="token punctuation">[</span>例<span class="token number">16</span><span class="token punctuation">]</span>  查询DB_Design课程的课程号和学分。
	      <span class="token keyword">SELECT</span> Cno，Ccredit
	      <span class="token keyword">FROM</span>     Course
	      <span class="token keyword">WHERE</span>  Cname <span class="token operator">LIKE</span> <span class="token string">'DB\_Design'</span> <span class="token keyword">ESCAPE</span> <span class="token string">'\ '</span> <span class="token punctuation">;</span>
	<span class="token punctuation">[</span>例<span class="token number">17</span><span class="token punctuation">]</span>  查询以<span class="token string">"DB_"</span>开头，且倒数第<span class="token number">3</span>个字符为 i的课程的详细情况。
	      <span class="token keyword">SELECT</span>  <span class="token operator">*</span>
	      <span class="token keyword">FROM</span>    Course
	      <span class="token keyword">WHERE</span>  Cname <span class="token operator">LIKE</span>  <span class="token string">'DB\_%i_ _'</span> <span class="token keyword">ESCAPE</span> <span class="token string">'\ '</span> <span class="token punctuation">;</span>
		
		<span class="token keyword">ESCAPE</span> <span class="token string">'＼'</span> 表示“ ＼” 为换码字符
</code></pre> 
<p><strong>5. 涉及空值的查询：</strong><br> 谓词： IS NULL 或 IS NOT NULL</p> 
<ul><li>“IS” 不能用 “=” 代替</li></ul> 
<pre><code class="prism language-sql"> 	<span class="token punctuation">[</span>例<span class="token number">18</span><span class="token punctuation">]</span>  某些学生选修课程后没有参加考试，所以有选课记录，但没 有考试成绩。查询缺少成绩的学生的学号和相应的课程号。
 	  <span class="token keyword">SELECT</span> Sno，Cno
       <span class="token keyword">FROM</span>    SC
       <span class="token keyword">WHERE</span>  Grade <span class="token operator">IS</span> <span class="token boolean">NULL</span>
 <span class="token punctuation">[</span>例<span class="token number">19</span><span class="token punctuation">]</span>  查所有有成绩的学生学号和课程号。
       <span class="token keyword">SELECT</span> Sno，Cno
       <span class="token keyword">FROM</span>     SC
       <span class="token keyword">WHERE</span>  Grade <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.多重条件查询</p> 
<ul><li>逻辑运算符：AND和 OR来连接多个查询条件<br> AND的优先级高于OR</li><li>可以用括号改变优先级</li></ul> 
<p>[例20] 查询计算机系年龄在20岁以下的学生姓名。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> Sname
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> Sdept<span class="token operator">=</span> ‘CS’ <span class="token operator">AND</span> Sage<span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3ORDER_BY_238"></a>3.ORDER BY子句</h4> 
<p>ORDER BY子句</p> 
<p>​ 可以按一个或多个属性列排序</p> 
<p>​ 升序：ASC;降序：DESC;缺省值为升序</p> 
<p>对于空值，排序时显示的次序由具体系统实现来决定</p> 
<pre><code class="prism language-sql"> <span class="token punctuation">[</span>例<span class="token number">21</span><span class="token punctuation">]</span>查询选修了<span class="token number">3</span>号课程的学生的学号及其成绩，查询结果按分数降序排列。
         <span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span> Grade
         <span class="token keyword">FROM</span>    SC
         <span class="token keyword">WHERE</span>  Cno<span class="token operator">=</span> <span class="token string">' 3 '</span>
         <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Grade <span class="token keyword">DESC</span><span class="token punctuation">;</span>
 
 <span class="token punctuation">[</span>例<span class="token number">22</span><span class="token punctuation">]</span>查询全体学生情况，查询结果按所在系的系号升序排列，同一系中的学生按年龄降序排列。
         <span class="token keyword">SELECT</span>  <span class="token operator">*</span>
         <span class="token keyword">FROM</span>  Student
         <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Sdept<span class="token punctuation">,</span> Sage <span class="token keyword">DESC</span><span class="token punctuation">;</span>  
</code></pre> 
<h4><a id="4_261"></a>4.聚集函数统计元组个数</h4> 
<p>COUNT(*)</p> 
<ol><li> <p>统计一列中值的个数</p> <p>COUNT([DISTINCT|ALL] &lt;列名&gt;)</p> </li><li> <p>计算一列值的总和（此列必须为数值型）</p> <p>SUM([DISTINCT|ALL] &lt;列名&gt;)</p> </li><li> <p>计算一列值的平均值（此列必须为数值型）</p> <p>AVG([DISTINCT|ALL] &lt;列名&gt;)</p> </li><li> <p>求一列中的最大值和最小值</p> <p>MAX([DISTINCT|ALL] &lt;列名&gt;)</p> <p>MIN([DISTINCT|ALL] &lt;列名&gt;)</p> </li></ol> 
<pre><code class="prism language-sql"> 	 <span class="token punctuation">[</span>例<span class="token number">23</span><span class="token punctuation">]</span>  查询学生总人数。
     	<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
     	<span class="token keyword">FROM</span>  Student<span class="token punctuation">;</span> 
      <span class="token punctuation">[</span>例<span class="token number">24</span><span class="token punctuation">]</span>  查询选修了课程的学生人数。
      <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> Sno<span class="token punctuation">)</span>
      <span class="token keyword">FROM</span> SC<span class="token punctuation">;</span>
      <span class="token punctuation">[</span>例<span class="token number">25</span><span class="token punctuation">]</span>  计算<span class="token number">1</span>号课程的学生平均成绩。
           <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>Grade<span class="token punctuation">)</span>
           <span class="token keyword">FROM</span>    SC
           <span class="token keyword">WHERE</span> Cno<span class="token operator">=</span> <span class="token string">' 1 '</span><span class="token punctuation">;</span>
  <span class="token punctuation">[</span>例<span class="token number">26</span><span class="token punctuation">]</span>  查询选修<span class="token number">1</span>号课程的学生最高分数。
    <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>Grade<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> SC
    <span class="token keyword">WHERE</span> Cno<span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span>
 
   <span class="token punctuation">[</span>例<span class="token number">27</span> <span class="token punctuation">]</span> 查询学生<span class="token number">201215012</span>选修课程的总学分数。
     		  <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>Ccredit<span class="token punctuation">)</span>
               <span class="token keyword">FROM</span>  SC<span class="token punctuation">,</span>Course
               <span class="token keyword">WHERE</span> Sno<span class="token operator">=</span><span class="token string">'201215012'</span> <span class="token operator">AND</span> SC<span class="token punctuation">.</span>Cno<span class="token operator">=</span>Course<span class="token punctuation">.</span>Cno<span class="token punctuation">;</span> 
</code></pre> 
<h4><a id="5GROUP_BY_305"></a>5.GROUP BY子句</h4> 
<p><strong>GROUP BY子句分组：</strong><br> 细化聚集函数的作用对象</p> 
<ul><li>如果未对查询结果分组，聚集函数将作用于整个查询结果</li><li>对查询结果分组后，聚集函数将分别作用于每个组</li><li>按指定的一列或多列值分组，值相等的为一组</li></ul> 
<pre><code class="prism language-SQL"> [例28]  求各个课程号及相应的选课人数。
      SELECT Cno，COUNT(Sno)
      FROM    SC
      GROUP BY Cno; 
      查询结果可能为：
          Cno     COUNT(Sno)
  		1             22
     	   2             34
      	    3             44
   		 4             33
              5             48
</code></pre> 
<p><strong>HAVING短语与WHERE子句的区别：</strong></p> 
<ul><li>作用对象不同</li><li>WHERE子句作用于基表或视图，从中选择满足条件的元组</li><li>HAVING短语作用于组，从中选择满足条件的组。</li></ul> 
<h3><a id="_334"></a>二、连接查询</h3> 
<ol><li> <p>连接查询：同时涉及两个以上的表的查询</p> </li><li> <p>连接条件或连接谓词：用来连接两个表的条件<br> 一般格式：</p> </li></ol> 
<p>​ [&lt;表名1&gt;.]&lt;列名1&gt; &lt;比较运算符&gt; [&lt;表名2&gt;.]&lt;列名2&gt;</p> 
<p>​ [&lt;表名1&gt;.]&lt;列名1&gt; BETWEEN [&lt;表名2&gt;.]&lt;列名2&gt; AND [&lt;表名2&gt;.]&lt;列名3&gt;</p> 
<ol start="3"><li>连接字段：连接谓词中的列名称</li></ol> 
<p>​ 连接条件中的各连接字段类型必须是可比的，但名字不必相同</p> 
<h4><a id="1_349"></a>1.等值与非等值连接查询</h4> 
<p><strong>等值连接：连接运算符为=</strong></p> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例 <span class="token number">29</span><span class="token punctuation">]</span>  查询每个学生及其选修课程的情况
			         <span class="token keyword">SELECT</span>  Student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> SC<span class="token punctuation">.</span><span class="token operator">*</span>
			         <span class="token keyword">FROM</span>     Student<span class="token punctuation">,</span> SC
			         <span class="token keyword">WHERE</span>  Student<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno<span class="token punctuation">;</span>
</code></pre> 
<p>结果为</p> 
<p><img src="https://images2.imgbox.com/bb/6a/OJySmUTD_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="1NESTEDLOOP_365"></a>1）嵌套循环法（NESTED-LOOP）</h5> 
<ul><li>首先在表1中找到第一个元组，然后从头开始扫描表2，逐一查找满足连接件的元组，找到后就将表1中的第一个元组与该元组拼接起来，形成结果表中一个元组。</li><li>表2全部查找完后，再找表1中第二个元组，然后再从头开始扫描表2，逐一查找满足连接条件的元组，找到后就将表1中的第二个元组与该元组拼接起来，形成结果表中一个元组。</li><li>重复上述操作，直到表1中的全部元组都处理完毕</li></ul> 
<h5><a id="2SORTMERGE_371"></a>（2）排序合并法（SORT-MERGE）</h5> 
<ul><li> <p>常用于=连接</p> </li><li> <p>首先按连接属性对表1和表2排序</p> </li><li> <p>对表1的第一个元组，从头开始扫描表2，顺序查找满足连接条件的元组，找到后就将表1中的第一个元组与该元组拼接起来，形成结果表中一个元组。当遇到表2中第一条大于表1连接字段值的元组时，对表2的查询不再继续</p> </li><li> <p>找到表1的第二条元组，然后从刚才的中断点处继续顺序扫描表2，查找满足连接条件的元组，找到后就将表1中的第一个元组与该元组拼接起来，形成结果表中一个元组。直接遇到表2</p> <p>中大于表1连接字段值的元组时，对表2的查询不再继续</p> </li><li> <p>重复上述操作，直到表1或表2中的全部元组都处理完毕为止</p> </li></ul> 
<h5><a id="3INDEXJOIN_385"></a>（3）索引连接（INDEX-JOIN）</h5> 
<ul><li>对表2按连接字段建立索引</li><li>对表1中的每个元组，依次根据其连接字段值查询表2的索引，从中找到满足条件的元组，找到后就将表1中的第一个元组与该元组拼接起来，形成结果表中一个元组</li></ul> 
<h5><a id="_390"></a>自然连接</h5> 
<pre><code class="prism language-sql">	<span class="token punctuation">[</span>例 <span class="token number">30</span><span class="token punctuation">]</span>  对<span class="token punctuation">[</span>例 <span class="token number">3.49</span><span class="token punctuation">]</span>用自然连接完成。
	 <span class="token keyword">SELECT</span>  Student<span class="token punctuation">.</span>Sno<span class="token punctuation">,</span>Sname<span class="token punctuation">,</span>Ssex<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>Sdept<span class="token punctuation">,</span>Cno<span class="token punctuation">,</span>Grade
	 <span class="token keyword">FROM</span>     Student<span class="token punctuation">,</span>SC
	 <span class="token keyword">WHERE</span>  Student<span class="token punctuation">.</span>Sno <span class="token operator">=</span> SC<span class="token punctuation">.</span>Sno<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="2_399"></a>2.自身连接</h4> 
<ul><li>自身连接：一个表与其自己进行连接</li><li>需要给表起别名以示区别</li><li>由于所有属性名都是同名属性，因此必须使用别名前缀</li></ul> 
<pre><code class="prism language-sql"> <span class="token punctuation">[</span>例 <span class="token number">32</span><span class="token punctuation">]</span>查询每一门课的间接先修课（即先修课的先修课）
     <span class="token keyword">SELECT</span>  <span class="token keyword">FIRST</span><span class="token punctuation">.</span>Cno<span class="token punctuation">,</span> <span class="token keyword">SECOND</span><span class="token punctuation">.</span>Cpno
      <span class="token keyword">FROM</span>  Course  <span class="token keyword">FIRST</span><span class="token punctuation">,</span> Course  <span class="token keyword">SECOND</span>
      <span class="token keyword">WHERE</span> <span class="token keyword">FIRST</span><span class="token punctuation">.</span>Cpno <span class="token operator">=</span> <span class="token keyword">SECOND</span><span class="token punctuation">.</span>Cno<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/14/e3/EotNiKU1_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_414"></a>3.外连接</h4> 
<h5><a id="_416"></a>外连接与普通连接的区别</h5> 
<ul><li>普通连接操作只输出满足连接条件的元组</li><li>外连接操作以指定表为连接主体，将主体表中不满足连接条件的元组一并输出</li><li>左外连接</li></ul> 
<p>​ 列出左边关系中所有的元组</p> 
<ul><li>右外连接</li></ul> 
<p>​ 列出右边关系中所有的元组</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>例 <span class="token number">33</span><span class="token punctuation">]</span> 改写<span class="token punctuation">[</span>例 <span class="token number">29</span><span class="token punctuation">]</span>
<span class="token keyword">SELECT</span> Student<span class="token punctuation">.</span>Sno<span class="token punctuation">,</span>Sname<span class="token punctuation">,</span>Ssex<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>Sdept<span class="token punctuation">,</span>Cno<span class="token punctuation">,</span>Grade
<span class="token keyword">FROM</span> Student <span class="token keyword">LEFT</span> <span class="token keyword">OUT</span> <span class="token keyword">JOIN</span> SC <span class="token keyword">ON</span>
<span class="token punctuation">(</span>Student<span class="token punctuation">.</span>Sno<span class="token operator">=</span>SC<span class="token punctuation">.</span>Sno<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>执行结果</p> 
<p><img src="https://images2.imgbox.com/bd/75/j1HPNILj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_439"></a>三、嵌套查询</h3> 
<h4><a id="_441"></a>嵌套查询概述</h4> 
<ul><li>一个SELECT-FROM-WHERE语句称为一个查询块</li><li>将一个查询块嵌套在另一个查询块的WHERE子句或HAVING短语的条件中的查询称为嵌套查询</li></ul> 
<pre><code class="prism language-sql">  <span class="token keyword">SELECT</span> Sname	                           <span class="token comment">/*外层查询/父查询*/</span>
  <span class="token keyword">FROM</span> Student
  <span class="token keyword">WHERE</span> Sno <span class="token operator">IN</span>
                     <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> Sno        <span class="token comment">/*内层查询/子查询*/</span>
                       <span class="token keyword">FROM</span> SC
                       <span class="token keyword">WHERE</span> Cno<span class="token operator">=</span> <span class="token string">' 2 '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<ul><li> <p>上层的查询块称为外层查询或父查询</p> </li><li> <p>下层查询块称为内层查询或子查询</p> </li><li> <p>SQL语言允许多层嵌套查询</p> 
  <ul><li>即一个子查询中还可以嵌套其他子查询</li></ul> </li><li> <p>子查询的限制</p> 
  <ul><li>不能使用ORDER BY子句</li></ul> </li></ul> 
<h5><a id="_464"></a>不相关子查询：</h5> 
<p>子查询的查询条件不依赖于父查询</p> 
<ul><li>由里向外 逐层处理。即每个子查询在上一级查询处理之前求解，子查询的结果用于建立其父查询的查找条件。</li></ul> 
<h5><a id="_470"></a>相关子查询：子查询的查询条件依赖于父查询</h5> 
<ul><li>首先取外层查询中表的第一个元组，根据它与内层查询相关的属性值处理内层查询，若WHERE子句返回值为真，则取此元组放入结果表</li><li>然后再取外层表的下一个元组</li><li>重复这一过程，直至外层表全部检查完为止</li></ul> 
<h4><a id="1IN_476"></a>1.带有IN谓词的子查询</h4> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>例 <span class="token number">35</span><span class="token punctuation">]</span>  查询与“刘晨”在同一个系学习的学生。
         此查询要求可以分步来完成
    ① 确定“刘晨”所在系名             
         <span class="token keyword">SELECT</span>  Sdept  
         <span class="token keyword">FROM</span>     Student                            
         <span class="token keyword">WHERE</span>  Sname<span class="token operator">=</span> <span class="token string">' 刘晨 '</span><span class="token punctuation">;</span>
	      结果为： CS
	      ② 查找所有在CS系学习的学生。    
    <span class="token keyword">SELECT</span>   Sno<span class="token punctuation">,</span> Sname<span class="token punctuation">,</span> Sdept     
    <span class="token keyword">FROM</span>      Student                 
    <span class="token keyword">WHERE</span>   Sdept<span class="token operator">=</span> <span class="token string">' CS '</span><span class="token punctuation">;</span> 
</code></pre> 
<p>结果为：</p> 
<p><img src="https://images2.imgbox.com/fb/40/VJL1CIgT_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_497"></a>2.带有比较运算符的子查询</h4> 
<p><strong>当能确切知道内层查询返回单值时，可用比较运算符（&gt;，&lt;，=，&gt;=，&lt;=，!=或&lt; &gt;）。</strong></p> 
<pre><code class="prism language-sql">	在<span class="token punctuation">[</span>例 <span class="token number">36</span><span class="token punctuation">]</span>中，由于一个学生只可能在一个系学习，则可以用 <span class="token operator">=</span> 代替<span class="token operator">IN</span> ：
	     <span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span>Sname<span class="token punctuation">,</span>Sdept
	     <span class="token keyword">FROM</span>    Student
	     <span class="token keyword">WHERE</span> Sdept   <span class="token operator">=</span>
	                   <span class="token punctuation">(</span><span class="token keyword">SELECT</span> Sdept
	                    <span class="token keyword">FROM</span>    Student
	                    <span class="token keyword">WHERE</span> Sname<span class="token operator">=</span> <span class="token string">'刘晨'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			<span class="token punctuation">[</span>例 <span class="token number">37</span> <span class="token punctuation">]</span>找出每个学生超过他选修课程平均成绩的课程号。
			   <span class="token keyword">SELECT</span> Sno<span class="token punctuation">,</span> Cno
			    <span class="token keyword">FROM</span>    SC  x
			    <span class="token keyword">WHERE</span> Grade <span class="token operator">&gt;=</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> AVG（Grade） 
					                        <span class="token keyword">FROM</span>  SC y
			                                   <span class="token keyword">WHERE</span> y<span class="token punctuation">.</span>Sno<span class="token operator">=</span>x<span class="token punctuation">.</span>Sno<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3ANYSOMEALL_518"></a>3.带有ANY（SOME）或ALL谓词的子查询</h4> 
<p>使用ANY或ALL谓词时必须同时使用比较运算</p> 
<h5><a id="_522"></a>语义为：</h5> 
<ul><li> <p>ANY 大于子查询结果中的某个值</p> </li><li> <p>ALL 大于子查询结果中的所有值</p> </li><li> <p>&lt; ANY 小于子查询结果中的某个值</p> </li><li> <p>&lt; ALL 小于子查询结果中的所有值</p> </li><li> <p>= ANY 大于等于子查询结果中的某个值</p> </li><li> <p>= ALL 大于等于子查询结果中的所有值</p> </li><li> <p>&lt;= ANY 小于等于子查询结果中的某个值</p> </li><li> <p>&lt;= ALL 小于等于子查询结果中的所有值</p> </li><li> <p>= ANY 等于子查询结果中的某个值</p> </li><li> <p>=ALL 等于子查询结果中的所有值（通常没有实际意义）</p> </li><li> <p>!=（或&lt;&gt;）ANY 不等于子查询结果中的某个值</p> </li><li> <p>!=（或&lt;&gt;）ALL 不等于子查询结果中的任何一个值</p> </li></ul> 
<pre><code class="prism language-sql"> <span class="token punctuation">[</span>例 <span class="token number">38</span><span class="token punctuation">]</span>  查询非计算机科学系中比计算机科学系任意一个学生年龄小的学生姓名和年龄
     <span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span>Sage
     <span class="token keyword">FROM</span>    Student
     <span class="token keyword">WHERE</span> Sage <span class="token operator">&lt;</span> <span class="token keyword">ANY</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>  Sage
                                          <span class="token keyword">FROM</span>    Student
                                          <span class="token keyword">WHERE</span> Sdept<span class="token operator">=</span> <span class="token string">' CS '</span><span class="token punctuation">)</span>
      <span class="token operator">AND</span> Sdept <span class="token operator">&lt;&gt;</span> ‘CS ' <span class="token punctuation">;</span>           <span class="token comment">/*父查询块中的条件 */</span>
</code></pre> 
<p>结果：<br> <img src="https://images2.imgbox.com/4b/93/zNmP7JxZ_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_556"></a>执行过程：</h5> 
<p>（1）首先处理子查询，找出CS系中所有学生的年龄，构成一个集合（20,19）<br> （2）处理父查询，找所有不是CS系且年龄小于 20 或 19的学生<br> <img src="https://images2.imgbox.com/b2/bf/bkHdXZAx_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/57c3f5aec094edf82971aaee316ca465/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ubantu20.04 一键部署 RocketChat 服务完整教程（极简）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/473a0eb5a7536857aab609e2a5851f7c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL必须懂的高级查询</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>