<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>华为eNSP配置专题-路由策略的配置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="华为eNSP配置专题-路由策略的配置" />
<meta property="og:description" content="文章目录 华为eNSP配置专题-路由策略的配置0、概要介绍1、前置环境1.1、宿主机1.2、eNSP模拟器 2、基本环境搭建2.1、终端构成和连接2.2、终端的基本配置 3、配置路由策略3.1、目标3.2、配置路由策略 华为eNSP配置专题-路由策略的配置 0、概要介绍 路由策略就是通过一系列工具或方法对路由进行各种控制，这种策略能够影响到路由的产生、发布、选择等，进而影响报文的转发路径。
1、前置环境 1.1、宿主机 笔记本电脑，配置如下：Windows10企业版，32GB内存
1.2、eNSP模拟器 eNSP1.3.00
2、基本环境搭建 2.1、终端构成和连接 0、总体拓扑如下：
1、在这里路由策略的需求就是，只把R1的lo1和lo2环回口的网络发布给R3，而lo0的网络则不发布出去。
1、2台PC，1台代表总部，1台代表分公司。
2、3台路由器，1台跑RIP，1台跑OSPF，中间1台既跑RIP也跑OSPF
2.2、终端的基本配置 1、配置R1的接口地址、环回口地址，开启RIPv2，将4个网段都宣告出去。
&lt;Huawei&gt;system-view [Huawei]undo info-center enable [Huawei]sysname R1 [R1]int g0/0/0 [R1-GigabitEthernet0/0/0]ip add 12.1.1.1 30 [R1-GigabitEthernet0/0/0]int lo0 [R1-LoopBack0]ip add 10.1.1.1 24 [R1-LoopBack0]int lo1 [R1-LoopBack1]ip add 10.1.2.1 24 [R1-LoopBack1]int lo3 [R1-LoopBack3]ip add 10.1.3.1 24 [R1-LoopBack3]quit [R1]rip [R1-rip-1]version 2 [R1-rip-1]network 12.0.0.0 [R1-rip-1]network 10.0.0.0 [R1-rip-1]quit 2、配置R2的接口地址，
&lt;Huawei&gt;system-view Enter system view, return user view with Ctrl&#43;Z. [Huawei]undo info-center enable [Huawei]sysname R2 [R2]int g0/0/0 [R2-GigabitEthernet0/0/0]ip add 12." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1f41af01b4ed8583b3917d8b748b9b5e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-26T22:10:42+08:00" />
<meta property="article:modified_time" content="2023-10-26T22:10:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">华为eNSP配置专题-路由策略的配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#eNSP_1" rel="nofollow">华为eNSP配置专题-路由策略的配置</a></li><li><ul><li><a href="#0_3" rel="nofollow">0、概要介绍</a></li><li><a href="#1_7" rel="nofollow">1、前置环境</a></li><li><ul><li><a href="#11_9" rel="nofollow">1.1、宿主机</a></li><li><a href="#12eNSP_14" rel="nofollow">1.2、eNSP模拟器</a></li></ul> 
   </li><li><a href="#2_19" rel="nofollow">2、基本环境搭建</a></li><li><ul><li><a href="#21_21" rel="nofollow">2.1、终端构成和连接</a></li><li><a href="#22_30" rel="nofollow">2.2、终端的基本配置</a></li></ul> 
   </li><li><a href="#3_111" rel="nofollow">3、配置路由策略</a></li><li><ul><li><a href="#31_113" rel="nofollow">3.1、目标</a></li><li><a href="#32_121" rel="nofollow">3.2、配置路由策略</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="eNSP_1"></a>华为eNSP配置专题-路由策略的配置</h2> 
<h3><a id="0_3"></a>0、概要介绍</h3> 
<p>路由策略就是通过一系列工具或方法对路由进行各种控制，这种策略能够影响到路由的产生、发布、选择等，进而影响报文的转发路径。</p> 
<h3><a id="1_7"></a>1、前置环境</h3> 
<h4><a id="11_9"></a>1.1、宿主机</h4> 
<p>笔记本电脑，配置如下：Windows10企业版，32GB内存<br> <img src="https://images2.imgbox.com/10/a2/A2QXhy38_o.png" alt=""></p> 
<h4><a id="12eNSP_14"></a>1.2、eNSP模拟器</h4> 
<p>eNSP1.3.00<br> <img src="https://images2.imgbox.com/80/e9/PsaIVztF_o.png" alt=""></p> 
<h3><a id="2_19"></a>2、基本环境搭建</h3> 
<h4><a id="21_21"></a>2.1、终端构成和连接</h4> 
<p>0、总体拓扑如下：<br> <img src="https://images2.imgbox.com/ef/ca/NPYmhWw2_o.png" alt=""><br> 1、在这里路由策略的需求就是，只把R1的lo1和lo2环回口的网络发布给R3，而lo0的网络则不发布出去。<br> 1、2台PC，1台代表总部，1台代表分公司。<br> 2、3台路由器，1台跑RIP，1台跑OSPF，中间1台既跑RIP也跑OSPF</p> 
<h4><a id="22_30"></a>2.2、终端的基本配置</h4> 
<p>1、配置R1的接口地址、环回口地址，开启RIPv2，将4个网段都宣告出去。</p> 
<pre><code>&lt;Huawei&gt;system-view 
[Huawei]undo info-center enable
[Huawei]sysname R1
[R1]int g0/0/0
[R1-GigabitEthernet0/0/0]ip add 12.1.1.1 30
[R1-GigabitEthernet0/0/0]int lo0
[R1-LoopBack0]ip add 10.1.1.1 24
[R1-LoopBack0]int lo1
[R1-LoopBack1]ip add 10.1.2.1 24
[R1-LoopBack1]int lo3
[R1-LoopBack3]ip add 10.1.3.1 24
[R1-LoopBack3]quit
[R1]rip
[R1-rip-1]version 2
[R1-rip-1]network 12.0.0.0
[R1-rip-1]network 10.0.0.0
[R1-rip-1]quit
</code></pre> 
<p>2、配置R2的接口地址，</p> 
<pre><code>&lt;Huawei&gt;system-view 

Enter system view, return user view with Ctrl+Z.

[Huawei]undo info-center enable
[Huawei]sysname R2
[R2]int g0/0/0
[R2-GigabitEthernet0/0/0]ip add 12.1.1.2 30
[R2-GigabitEthernet0/0/0]int g0/0/1
[R2-GigabitEthernet0/0/1]ip add 23.1.1.1 30
[R2-GigabitEthernet0/0/1]quit
</code></pre> 
<p>3、在R2上开启RIPv2，宣告12网段，然后可以看到R2学到了R1的环回路由。</p> 
<pre><code>[R2]rip
[R2-rip-1]network 12.0.0.0
</code></pre> 
<p><img src="https://images2.imgbox.com/f0/38/Ulw34SUI_o.png" alt=""></p> 
<p>4、在R2上开启OSPF，宣告23网段。</p> 
<pre><code>[R2]ospf 1
[R2-ospf-1]area 0
[R2-ospf-1-area-0.0.0.0]network 23.1.1.0 0.0.0.3
[R2-ospf-1-area-0.0.0.0]quit
</code></pre> 
<p>5、在R3上配置接口地址和环回口地址，配置OSPF，宣告4个网段。</p> 
<pre><code>&lt;Huawei&gt;system-view  
[Huawei]undo info-center enable
[Huawei]sysname R3
[R3]int g0/0/0
[R3-GigabitEthernet0/0/0]ip add 23.1.1.2 30
[R3-GigabitEthernet0/0/0]int lo0
[R3-LoopBack0]ip add 30.1.1.1 24
[R3-LoopBack0]int lo1
[R3-LoopBack1]ip add 30.1.2.1 24
[R3-LoopBack1]int lo2
[R3-LoopBack2]ip add 30.1.3.1 24
[R3-LoopBack2]quit
[R3]ospf 1
[R3-ospf-1]area 0
[R3-ospf-1-area-0.0.0.0]network 23.1.1.0 0.0.0.3
[R3-ospf-1-area-0.0.0.0]network 30.1.1.0 0.0.0.255
[R3-ospf-1-area-0.0.0.0]network 30.1.2.0 0.0.0.255
[R3-ospf-1-area-0.0.0.0]network 30.1.3.0 0.0.0.255
[R3-ospf-1-area-0.0.0.0]quit
[R3-ospf-1]quit
</code></pre> 
<p>6、在R2上可以看到R2学到了R3的环回口地址<br> <img src="https://images2.imgbox.com/a2/aa/D5TToCz6_o.png" alt=""></p> 
<h3><a id="3_111"></a>3、配置路由策略</h3> 
<h4><a id="31_113"></a>3.1、目标</h4> 
<p>1、目前看R1和R3的路由，都只有直连路由。这是因为虽然R2启用了RIP和OSPF，但是R2在12网段的路由R1已经有了，R2在23网段的路由R3之前已经有了。<br> <img src="https://images2.imgbox.com/e0/9b/jeIjHfez_o.png" alt=""><br> <img src="https://images2.imgbox.com/1b/88/7hoIQafx_o.png" alt=""></p> 
<p>2、现在想把R1的环回口路由引入给R3，但只引入lo1和lo2网段的，而不引入Lo3网段的。</p> 
<h4><a id="32_121"></a>3.2、配置路由策略</h4> 
<p>1、在R2上创建一个ACL，将想传播的网段挑选出来</p> 
<pre><code>[R2]acl 2000
[R2-acl-basic-2000]rule 10 permit ip source 10.1.2.0 0.0.0.255
[R2-acl-basic-2000]rule 10 permit source 10.1.2.0 0.0.0.255
[R2-acl-basic-2000]rule 20 permit source 10.1.3.0 0.0.0.255
[R2-acl-basic-2000]quit
</code></pre> 
<p>2、在R2创建一个路由策略：</p> 
<pre><code>[R2]route-policy FROMR1 permit node 10
[R2-route-policy]if-match acl 2000
[R2-route-policy]quit
</code></pre> 
<p>3、在R2的OSPF进程里引入RIP的路由，通过路由策略进行筛选。</p> 
<pre><code>[R2]ospf 1
[R2-ospf-1]import-route rip 1 route-policy FROMR1
[R2-ospf-1]quit
</code></pre> 
<p>4、这时在R3上可以看到通过OSPF引入了10.1.2.0和10.1.3.0两个网段的路由，但没有引入10.1.1.0网段的路由。这样就完成了按照路由策略的路由引入。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b7ada0ec8954e31c7ca29268762613a9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【OS基础】符合AUTOSAR标准的RTA-OS-Task详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d35d3daedcd4c6c4d81d55dd2b4d3264/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">爬虫批量下载科研论文（SciHub）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>