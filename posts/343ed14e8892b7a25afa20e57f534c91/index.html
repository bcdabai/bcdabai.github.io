<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Apache配置ssl证书-实现https访问 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Apache配置ssl证书-实现https访问" />
<meta property="og:description" content="一、准备工作 1.1 安装Apache服务器 #下载安装apache yum install httpd -y #启动apache服务 systemctl start httpd systemctl enable httpd #查看服务状态 netstat -lntp |grep http 1.2 Apache服务器上已经开启了443端口 443为HTTPS服务的默认端口 1.3 Apache服务器上已安装了mod_ssl.so模块 启用SSL功能,安装mod_ssl.so模块 yum install -y mod_ssl 1.4 获取SSL证书 二、配置apache 2.1 配置apache文件 vhost的域名配置文件.conf，在目录：/etc/httpd/conf.d HTTP配置： Listen 80 # 指定域名 ServerName www.example.com # 指定文档根目录 DocumentRoot /var/www/html # 是否启用访问日志 CustomLog /var/log/httpd/access.log combined # 指定错误日志路径 ErrorLog /var/log/httpd/error.log # 配置虚拟主机 &lt;VirtualHost *:80&gt; ServerAdmin admin@example.com DocumentRoot /var/www/html/project # 访问权限 &lt;Directory /var/www/html/project&gt; Options Indexes FollowSymLinks MultiViews AllowOverride All Order allow,deny allow from all Require all granted &lt;/Directory&gt; # 使用PHP解析器处理." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/343ed14e8892b7a25afa20e57f534c91/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-12T15:19:55+08:00" />
<meta property="article:modified_time" content="2024-01-12T15:19:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Apache配置ssl证书-实现https访问</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_2"></a>一、准备工作</h2> 
<h3><a id="11_Apache_3"></a>1.1 安装Apache服务器</h3> 
<pre><code class="prism language-yaml"><span class="token comment">#下载安装apache</span>
yum install httpd <span class="token punctuation">-</span>y

<span class="token comment">#启动apache服务</span>
systemctl start httpd
systemctl enable httpd

<span class="token comment">#查看服务状态</span>
netstat <span class="token punctuation">-</span>lntp  <span class="token punctuation">|</span>grep http

</code></pre> 
<h3><a id="12_Apache443_18"></a>1.2 Apache服务器上已经开启了443端口</h3> 
<pre><code>443为HTTPS服务的默认端口
</code></pre> 
<h3><a id="13_Apachemod_sslso_21"></a>1.3 Apache服务器上已安装了mod_ssl.so模块</h3> 
<pre><code>启用SSL功能,安装mod_ssl.so模块
</code></pre> 
<pre><code class="prism language-yaml">yum install <span class="token punctuation">-</span>y mod_ssl
</code></pre> 
<h3><a id="14_SSL_27"></a>1.4 获取SSL证书</h3> 
<h2><a id="apache_29"></a>二、配置apache</h2> 
<h3><a id="21_apache_31"></a>2.1 配置apache文件</h3> 
<pre><code>vhost的域名配置文件.conf，在目录：/etc/httpd/conf.d
</code></pre> 
<ul><li>HTTP配置：</li></ul> 
<pre><code class="prism language-xml">Listen 80

# 指定域名
ServerName www.example.com

# 指定文档根目录
DocumentRoot /var/www/html

# 是否启用访问日志
CustomLog /var/log/httpd/access.log combined

# 指定错误日志路径
ErrorLog /var/log/httpd/error.log

# 配置虚拟主机
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>80</span><span class="token punctuation">&gt;</span></span>
    ServerAdmin admin@example.com
    DocumentRoot /var/www/html/project
    
    # 访问权限
    &lt;Directory /var/www/html/project&gt;
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
        Require all granted
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>

    # 使用PHP解析器处理.php文件
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FilesMatch</span> <span class="token attr-name">\.php$</span><span class="token punctuation">&gt;</span></span>
        SetHandler "proxy:unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/"
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>

    # 定义PHP脚本的目录索引
    DirectoryIndex index.php index.html
    
    # 自定义错误页面
    ErrorDocument 404 /error_404.html
    
    # 设置HTTP头信息
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>HTTPS配置：</li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>443</span><span class="token punctuation">&gt;</span></span> DocumentRoot /var/www/html/project ServerName www.cpayfinance.com ServerAlias www.cpayfinance.com SSLEngine on SSLCertificateFile          /etc/letsencrypt/live/cpayfinance.com/cert.pem SSLCertificateKeyFile   /etc/letsencrypt/live/cpayfinance.com//privkey.pem SSLCertificateChainFile     /etc/letsencrypt/live/cpayfinance.com//chain.pem

 # 访问权限
    &lt;Directory /var/www/html/project&gt;
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
        Require all granted
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>

    # 使用PHP解析器处理.php文件
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FilesMatch</span> <span class="token attr-name">\.php$</span><span class="token punctuation">&gt;</span></span>
        SetHandler "proxy:unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/"
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>

    # 定义PHP脚本的目录索引
    DirectoryIndex index.php index.html

    # 自定义错误页面
    ErrorDocument 404 /error_404.html

    # 设置HTTP头信息
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block" <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>HTTP &amp; HTTPS 配置</li></ul> 
<pre><code class="prism language-xml">Listen 80

# 指定域名
ServerName www.cpayfinance.com

# 指定文档根目录
DocumentRoot /var/www/html

# 是否启用访问日志
CustomLog /var/log/httpd/access.log combined

# 指定错误日志路径
ErrorLog /var/log/httpd/error.log

# 配置虚拟主机
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>80</span><span class="token punctuation">&gt;</span></span>
    ServerAdmin admin@example.com
    DocumentRoot /var/www/html/project
    
    # 访问权限
    &lt;Directory /var/www/html/project&gt;
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
        Require all granted
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>

    # 使用PHP解析器处理.php文件
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FilesMatch</span> <span class="token attr-name">\.php$</span><span class="token punctuation">&gt;</span></span>
        SetHandler "proxy:unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/"
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>

    # 定义PHP脚本的目录索引
    DirectoryIndex index.php index.html
    
    # 自定义错误页面
    ErrorDocument 404 /error_404.html
    
    # 设置HTTP头信息
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>



<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>443</span><span class="token punctuation">&gt;</span></span>
DocumentRoot /var/www/html/project
ServerName www.cpayfinance.com
ServerAlias www.cpayfinance.com
SSLEngine on
SSLCertificateFile          /etc/letsencrypt/live/cpayfinance.com/cert.pem
SSLCertificateKeyFile       /etc/letsencrypt/live/cpayfinance.com//privkey.pem
SSLCertificateChainFile     /etc/letsencrypt/live/cpayfinance.com//chain.pem

 # 访问权限
    &lt;Directory /var/www/html/project&gt;
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
        Require all granted
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>

    # 使用PHP解析器处理.php文件
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FilesMatch</span> <span class="token attr-name">\.php$</span><span class="token punctuation">&gt;</span></span>
        SetHandler "proxy:unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/"
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>

    # 定义PHP脚本的目录索引
    DirectoryIndex index.php index.html

    # 自定义错误页面
    ErrorDocument 404 /error_404.html

    # 设置HTTP头信息
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>Apache 配置Https多个端口号映射</li></ul> 
<pre><code class="prism language-xml">// 通过下方简单配置
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>443</span><span class="token punctuation">&gt;</span></span>

	&lt;Location /b8082&gt;  //这个可以自定义名称
    ProxyPass http://127.0.0.1:8081  
    ProxyPassReverse http://127.0.0.1:8081
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Location</span><span class="token punctuation">&gt;</span></span>
    
    &lt;Location /b8081&gt;    
    ProxyPass http://127.0.0.1:8082  
    ProxyPassReverse http://127.0.0.1:8082
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Location</span><span class="token punctuation">&gt;</span></span>

    &lt;Location /b8081/a&gt;    
    ProxyPass http://127.0.0.1:8083  
    ProxyPassReverse http://127.0.0.1:8083
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Location</span><span class="token punctuation">&gt;</span></span>
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="22__221"></a>2.2 生效配置文件</h3> 
<ul><li>查看配置文件是否正常</li></ul> 
<pre><code class="prism language-xml"># apachectl -t
Syntax OK
</code></pre> 
<ul><li>重启apache配置</li></ul> 
<pre><code class="prism language-xml">systemctl restart httpd
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b642b7244b90321d11621b7009dcdd58/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【计算机网络】内容整理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b11b2f0fe41d7880701125d46e57ee4c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">算法回忆录——DFS与BFS</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>