<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Wireshark 捕获过滤器的语法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Wireshark 捕获过滤器的语法" />
<meta property="og:description" content="转自：http://blog.csdn.net/qq_29277155/article/details/52077239
前言 我们都知道，wireshark可以实现本地抓包，同时Wireshark也支持remote packet capture protocol（rpcapd）协议远程抓包，只要在远程主机上安装相应的rpcapd服务例程就可以实现在本地电脑执行wireshark 捕获远程电脑的流量了。但是各种协议的流量非常巨大，如果我们捕获所有协议的流量，那么数小时内，捕获到的流量将到达几百M，甚至几G。硬盘空间很快就被填满了。所以很有必要，只捕获特定的流量或者不捕获某些流量而捕获其他所有的流量。
捕捉过滤器语法 语法：&lt;Protocol&gt; &lt;Direction&gt; &lt;Host(s)&gt; &lt; Value&gt; &lt; Logical Operations&gt; &lt;Other expression&gt;
Protocol（协议）: ether，fddi， ip，arp，rarp，decnet，lat， sca，moprc，mopdl， tcp ， udp 等，如果没指明协议类型，则默认为捕捉所有支持的协议。
Direction（方向）:src， dst，src and dst， src or dst等，如果没指明方向，则默认使用 “src or dst” 作为关键字。
Host(s): net, port, host, portrange等，默认使用”host”关键字，”src 10.1.1.1″与”src host 10.1.1.1″等价。
Logical Operations（逻辑运算）:not, and, or 等，否(“not”)具有最高的优先级。或(“or”)和与(“and”)具有相同的优先级，运算时从左至右进行。
常见使用的捕获过滤语句 1.1 只（不）捕获某主机的HTTP流量
host 192.168.5.231 and port 80 and http#只捕获主机192.168.5.231 的http流量。注意如果你的HTTP端口为8080，把80 改为8080。
port 80 and http#捕获所有经过该接口的http流量。注意如果你的HTTP端口为8080，把80 改为8080。
host 192.168.5.231 and not port 80# 捕获主机192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/738d4b42513c0355c8ea51bbd8a8e680/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-11-29T15:56:00+08:00" />
<meta property="article:modified_time" content="2017-11-29T15:56:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Wireshark 捕获过滤器的语法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>转自：http://blog.csdn.net/qq_29277155/article/details/52077239</p> 
 <h4>前言</h4> 
 <p>    我们都知道，wireshark可以实现本地抓包，同时Wireshark也支持remote packet capture protocol（rpcapd）协议远程抓包，只要在远程主机上安装相应的rpcapd服务例程就可以实现在本地电脑执行wireshark 捕获远程电脑的流量了。但是各种协议的流量非常巨大，如果我们捕获所有协议的流量，那么数小时内，捕获到的流量将到达几百M，甚至几G。硬盘空间很快就被填满了。所以很有必要，只捕获特定的流量或者不捕获某些流量而捕获其他所有的流量。</p> 
 <p> </p> 
 <h4><strong>捕捉过滤器语法</strong></h4> 
 <p>语法：&lt;<strong>Protocol&gt;  &lt;Direction&gt;  &lt;Host(s)&gt;  &lt; Value&gt;  &lt; Logical  Operations&gt;   &lt;Other expression&gt;</strong></p> 
 <p><strong>Protocol（协议）:</strong> ether，fddi， ip，arp，rarp，decnet，lat， sca，moprc，mopdl， tcp ， udp 等，如果没指明协议类型，则默认为捕捉所有支持的协议。</p> 
 <p><strong>Direction（方向）:</strong>src， dst，src and dst， src or dst等，如果没指明方向，则默认使用 “src or dst” 作为关键字。</p> 
 <p><strong>Host(s):</strong> net, port, host, portrange等，默认使用”host”关键字，”src 10.1.1.1″与”src host 10.1.1.1″等价。</p> 
 <p><strong>Logical Operations（逻辑运算）:</strong>not, and, or 等，否(“not”)具有最高的优先级。或(“or”)和与(“and”)具有相同的优先级，运算时从左至右进行。</p> 
 <p> </p> 
 <h4>常见使用的捕获过滤语句</h4> 
 <p>1.1 只（不）捕获某主机的HTTP流量</p> 
 <p>host 192.168.5.231 and port 80 and http#只捕获主机192.168.5.231 的http流量。注意如果你的HTTP端口为8080，把80 改为8080。</p> 
 <p>port 80 and http#捕获所有经过该接口的http流量。注意如果你的HTTP端口为8080，把80 改为8080。</p> 
 <p>host 192.168.5.231 and not port 80# 捕获主机192.168.5.231除 http 之外的其他所有流量，注意如果你的HTTP端口为8080，把80 改为8080。</p> 
 <p>not port 80 # 捕获除 http 之外的其他所有流量，注意如果你的HTTP端口为8080，把80 改为8080。</p> 
 <p>not port 80 and !http## 捕获除 http 之外的其他所有流量，注意如果你的HTTP端口为8080，把80 改为8080。</p> 
 <p><img src="https://images2.imgbox.com/ec/be/OAWyqQLm_o.png" alt=""></p> 
 <p>1.2  只捕获某主机的所有流量</p> 
 <p>host 192.168.5.231#捕获源目主机均为192.168.5.231</p> 
 <p>dst 192.168.5.231#捕获目的主机均为192.168.5.231</p> 
 <p>src 192.168.5.231#捕获来源主机均为192.168.5.231</p> 
 <p>net 192.168.5.0/24#捕获网段为d192.168.5的所有主机的所有流量</p> 
 <p><img src="https://images2.imgbox.com/cd/83/NbxuyWq2_o.png" alt=""></p> 
 <p>1.3 只捕获某主机的DNS流量</p> 
 <p>host 192.168.5.231 and port 53 # 只捕获主机192.168.5.231 的dns流量。</p> 
 <p>src 192.168.5.231 and port 53  #只捕获主机192.168.5.231 对外的dns 的流量。</p> 
 <p>dst 192.168.5.231 and port 53 #只捕获dns服务器相应主机192.168.5.231的dns流量。</p> 
 <p>port 53          #捕获接口中的所有主机的dns流量</p> 
 <p><img src="https://images2.imgbox.com/a9/6e/khtjSOqv_o.png" alt=""></p> 
 <p> </p> 
 <p>1.4 只（不）捕获APR流量</p> 
 <p>host 192.168.5.231 and arp#只捕获主机192.168.5.231 的arp流量。</p> 
 <p>host 192.168.5.231 and !arp #只捕获主机192.168.5.231 除arp外的所有流量。</p> 
 <p>arp#捕获接口中的所有arp请求</p> 
 <p>!arp #捕获接口中所有非arpq请求。</p> 
 <p><img src="https://images2.imgbox.com/53/b1/aHeAus6R_o.png" alt=""></p> 
 <p>1.5 只捕获特定端口的流量</p> 
 <p>tcp portrange 8000-9000 an port 80#捕获端口8000-9000之间和80端口的流量</p> 
 <p>port 5060#捕获sip流量，因为sip的默认端口是5060。举一反三：port 22 #捕获ssh流量</p> 
 <p> </p> 
 <p>1.6 捕获电子邮件的流量</p> 
 <p>host 192.168.5.231 and port 25      # 捕获主机192.168.5.231 的POP3协议的流量。</p> 
 <p>port 25 and portrange 110-143 #因为电子邮件的协议：SMTP、POP3、IMAP4，所以捕获端口的流量。</p> 
 <p><img src="https://images2.imgbox.com/fb/fc/v5uaL3Zo_o.png" alt=""></p> 
 <p>1.7 捕获vlan 的流量</p> 
 <p>vlan #捕获所有vlan 的流量</p> 
 <p>vlan and (host 192.168.5.0 and port 80)#捕获vlan 中主机192.168.5.0 ，前提是有vlan，在wifi中不一定可以捕获到相应的流量，局域网（公司，学校里面的网络应该有vlan)</p> 
 <p> </p> 
 <p>1.8 捕获 PPPoE 流量</p> 
 <p>pppoes #捕获所有的pppoes流量<br>pppoes and (host 192.168.5.231 and port 80)  #捕获主机</p> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/SZxiaochun/p/7920962.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/aa539d8958f57186e7f17166b7e99897/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ES6: import和export</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/26c05d045efa299b96cc647e1c27e5ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ceph集群部署文档（4节点）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>