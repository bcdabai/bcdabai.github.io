<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux环境中ElasticSearch启动时常见错误、解决 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux环境中ElasticSearch启动时常见错误、解决" />
<meta property="og:description" content="● ES启动常见报错及解决措施 说明 文章基于ElasicSearch版本：7.3.2，Linux版本：CentOS-7.7。供其他版本参考。
启动报错 报错1—— [xpack.ml.enabled: false] Caused by: org.elasticsearch.ElasticsearchException: Failure running machine learning native code. This could be due to running on an unsupported OS or distribution, missing OS libraries, or a problem with the temp directory. To bypass this problem by running Elasticsearch without machine learning functionality set [xpack.ml.enabled: false]. 解决措施：
vi ElasticSearch-7.3.2/config/elasticsearch.yml 编辑ElasticSearch-7.3.2\config\elasticsearch.yml文件，文件最后追加xpack.ml.enabled: false。注意“:”号存在空格！
报错2——Cannot allocate memory output: # # There is insufficient memory for the Java Runtime Environment to continue." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7e6d13326268f26bd333ea7b2020a1e3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-14T17:16:41+08:00" />
<meta property="article:modified_time" content="2020-03-14T17:16:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux环境中ElasticSearch启动时常见错误、解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="	font_size6ESfont_0"></a>● <font size="6"><em><strong>ES启动常见报错及解决措施</strong></em></font></h2> 
<h3><a id="font_size5font_1"></a><font size="5"><em>说明</em></font></h3> 
<p>   文章基于ElasicSearch版本：7.3.2，Linux版本：CentOS-7.7。供其他版本参考。</p> 
<h3><a id="font_size5font_3"></a><font size="5"><em>启动报错</em></font></h3> 
<h4><a id="font_size4emsp1_xpackmlenabled_falsefont_4"></a><font size="4"> 报错1—— [xpack.ml.enabled: false]</font></h4> 
<pre><code class="prism language-yaml">Caused by<span class="token punctuation">:</span> <span class="token key atrule">org.elasticsearch.ElasticsearchException</span><span class="token punctuation">:</span> Failure running machine learning native code. 
This could be due to running on an unsupported OS or distribution<span class="token punctuation">,</span> missing OS libraries<span class="token punctuation">,</span> or a 
problem with the temp directory. To bypass this problem by running Elasticsearch without machine 
learning functionality set <span class="token punctuation">[</span><span class="token key atrule">xpack.ml.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token punctuation">]</span>.
</code></pre> 
<p>  解决措施：</p> 
<pre><code class="prism language-yaml">vi ElasticSearch<span class="token punctuation">-</span>7.3.2/config/elasticsearch.yml
</code></pre> 
<p>   编辑ElasticSearch-7.3.2\config\elasticsearch.yml文件，文件最后追加<code>xpack.ml.enabled: false</code>。注意“:”号存在空格！</p> 
<h4><a id="font_size4emsp2Cannot_allocate_memoryfont_17"></a><font size="4"> 报错2——Cannot allocate memory</font></h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">output</span><span class="token punctuation">:</span>
<span class="token comment">#</span>
<span class="token comment"># There is insufficient memory for the Java Runtime Environment to continue.</span>
<span class="token comment"># Native memory allocation (mmap) failed to map 3946053632 bytes for committing reserved memory.</span>
<span class="token comment"># An error report file with more information is saved as:</span>
<span class="token comment"># logs/hs_err_pid3518.log</span>
<span class="token key atrule">error</span><span class="token punctuation">:</span>
Java HotSpot(TM) 64<span class="token punctuation">-</span>Bit Server VM warning<span class="token punctuation">:</span> <span class="token key atrule">INFO</span><span class="token punctuation">:</span> os<span class="token punctuation">:</span><span class="token punctuation">:</span>commit_memory(0x00000006d4cc0000<span class="token punctuation">,</span> <span class="token number">3946053632</span><span class="token punctuation">,</span> 0) 
failed; error='Cannot allocate memory' (errno=12)
</code></pre> 
<p>  解决措施：</p> 
<pre><code class="prism language-yaml">vi ElasticSearch<span class="token punctuation">-</span>7.3.2/config/jvm.options
<span class="token punctuation">...</span>
<span class="token punctuation">-</span>Xms4g
<span class="token punctuation">-</span>Xmx4g
</code></pre> 
<p>   jvm.options中jvm内存设置偏大，启动时系统无法提供设置的内存。将ElasticSearch-7.3.2\config\jvm.options中-Xms和-Xmx参数调小，具体内存大小根据机器设定。</p> 
<h4><a id="font_size4emsp3can_not_run_elasticsearch_as_rootfont_37"></a><font size="4"> 报错3——can not run elasticsearch as root</font></h4> 
<pre><code class="prism language-yaml">Caused by<span class="token punctuation">:</span> <span class="token key atrule">java.lang.RuntimeException</span><span class="token punctuation">:</span> can not run elasticsearch as root
</code></pre> 
<p>  解决措施：<br>    该用户没有启动ES权限，切换到部署ES的用户下启动即可。</p> 
<h4><a id="font_size4emsp4main_ERROR_Null_object_returned_font_43"></a><font size="4"> 报错4——main ERROR Null object returned …</font></h4> 
<pre><code class="prism language-yaml">main ERROR Null object returned for RollingFile in Appenders.
main ERROR Null object returned for RollingFile in Appenders.
main ERROR Unable to locate appender "rolling" for logger config "root"
main ERROR Unable to locate appender "rolling_old" for logger config "root"
</code></pre> 
<p>  解决措施：</p> 
<pre><code class="prism language-yaml">vi ElasticSearch<span class="token punctuation">-</span>7.3.2/config/log4j2.properties
<span class="token punctuation">...</span>
<span class="token comment">#################################################</span>
logger.deprecation.name = org.elasticsearch.deprecation
logger.deprecation.level = warn
</code></pre> 
<p>   将ElasticSearch-7.3.2\config\log4j2.properties文件中，<code>logger.deprecation.level = warn</code>改为error。</p> 
<h4><a id="font_size4emsp5bootstrap_checks_failedmax_filefont_59"></a><font size="4"> 报错5——bootstrap checks failed…max file…</font></h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">ERROR</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> bootstrap checks failed
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> max file descriptors <span class="token punctuation">[</span><span class="token number">4096</span><span class="token punctuation">]</span> for elasticsearch process is too low<span class="token punctuation">,</span> increase to at least <span class="token punctuation">[</span><span class="token number">65535</span><span class="token punctuation">]</span>
</code></pre> 
<p>  解决措施：</p> 
<pre><code class="prism language-yaml">vi /etc/security/limits.conf
<span class="token punctuation">...</span>
* soft nofile 65536
* hard nofile 65536
</code></pre> 
<p>   编辑/etc/security/limits.conf，追加如上内容。此文件需root权限修改，且重新登录用户后才会生效。</p> 
<h4><a id="font_size4emsp6bootstrap_checks_failedvmmax_map_countfont_72"></a><font size="4"> 报错6——bootstrap checks failed…vm.max_map_count…</font></h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">ERROR</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> bootstrap checks failed
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> max virtual memory areas vm.max_map_count <span class="token punctuation">[</span><span class="token number">65530</span><span class="token punctuation">]</span> is too low<span class="token punctuation">,</span> increase to at least <span class="token punctuation">[</span><span class="token number">262144</span><span class="token punctuation">]</span>
</code></pre> 
<p>  解决措施：</p> 
<pre><code class="prism language-yaml">vi /etc/sysctl.conf
<span class="token punctuation">...</span>
vm.max_map_count=655360
</code></pre> 
<p>   编辑/etc/sysctl.conf，追加如上内容。此文件需root权限修改，保存后，执行：<code>sysctl -p</code>重新启动。</p> 
<h3><a id="font_size5font_84"></a><font size="5"><em>结束</em></font></h3> 
<p>  启动ES，出现<code>[INFO ][o.e.n.Node ] [node-2] started</code>即正常启动。此时访问9200端口可查看ES详细信息。希望本文能对您有所帮助！</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/7c/a4/dsDHeJUK_o.png" height="" width="60%" alt=""> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/31751350de9eae8274f337a9e9b656c3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python操作百度网盘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cfd236e30dbe0a0d1dd17fdc89ee0c84/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">redis分布式锁？坑那么多</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>