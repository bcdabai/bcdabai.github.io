<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#ä½¿ç”¨RabbitMQ-1_Dockeréƒ¨ç½²å¹¶åœ¨c#ä¸­å®ç°ç®€å•æ¨¡å¼æ¶ˆæ¯ä»£ç† - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#ä½¿ç”¨RabbitMQ-1_Dockeréƒ¨ç½²å¹¶åœ¨c#ä¸­å®ç°ç®€å•æ¨¡å¼æ¶ˆæ¯ä»£ç†" />
<meta property="og:description" content="ä»‹ç» RabbitMQæ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼Œå®ç°äº†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼ˆAMQPï¼‰ã€‚
ğŸ€RabbitMQèµ·æºäºé‡‘èç³»ç»Ÿï¼Œç°åœ¨å¹¿æ³›åº”ç”¨äºå„ç§åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åœ¨åº”ç”¨ç¨‹åºä¹‹é—´æä¾›å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ï¼Œå®ç°ç³»ç»Ÿé—´çš„è§£è€¦å’Œæ¶ˆæ¯çš„å¯é ä¼ é€’ã€‚RabbitMQä½¿ç”¨Erlangè¯­è¨€å¼€å‘ï¼Œæ”¯æŒå¤šç§å®¢æˆ·ç«¯è¯­è¨€å¦‚Pythonã€Rubyã€.NETã€Javaç­‰ã€‚
æ­¤å¤–ï¼ŒRabbitMQå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
æ˜“ç”¨æ€§ï¼šæä¾›äº†ç®€å•æ˜“ç”¨çš„APIï¼Œä½¿å¾—ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯ä»¥æ–¹ä¾¿åœ°å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚æ‰©å±•æ€§ï¼šå¯ä»¥æ°´å¹³æ‰©å±•ä»¥å¤„ç†å¤§é‡çš„æ¶ˆæ¯ï¼Œæ”¯æŒé›†ç¾¤éƒ¨ç½²æ¥æé«˜ç³»ç»Ÿçš„ååé‡å’Œå¯ç”¨æ€§ã€‚é«˜å¯ç”¨æ€§ï¼šé€šè¿‡é•œåƒé˜Ÿåˆ—ç­‰æœºåˆ¶ä¿è¯æ¶ˆæ¯ä¸ä¼šå› æœåŠ¡å™¨æ•…éšœè€Œä¸¢å¤±ï¼Œç¡®ä¿äº†ç³»ç»Ÿçš„ç¨³å¥è¿è¡Œã€‚å¤šç§äº¤æ¢æ¨¡å¼ï¼šæ”¯æŒç›´æ¥äº¤æ¢ã€æ‰‡å½¢äº¤æ¢ã€ä¸»é¢˜äº¤æ¢å’Œå¤´äº¤æ¢ç­‰å¤šç§äº¤æ¢æ¨¡å¼ï¼Œæ»¡è¶³ä¸åŒçš„æ¶ˆæ¯è·¯ç”±éœ€æ±‚ã€‚å¤šåè®®æ”¯æŒï¼šé™¤äº†AMQPåè®®ï¼Œè¿˜æ”¯æŒSTOMPç­‰å…¶ä»–æ¶ˆæ¯åè®®ã€‚ åœ¨dockerä¸­éƒ¨ç½²RabbitMQ ğŸ€é¦–å…ˆåœ¨dockerHubä¸­æ‰¾åˆ°RabbitMQçš„é•œåƒ
rabbitmq - å®˜æ–¹å›¾ç‰‡ (docker.com)
ğŸ€æ‰§è¡Œå‘½ä»¤æ‹‰å–é•œåƒ
docker pull rabbitmq ğŸ€é•œåƒæ‹‰å–å®Œæˆä¹‹åå¯åŠ¨é•œåƒ
docker run -d -p 5672:5672 -p 15672:15672 --name rabbitmq rabbitmq ğŸ€æ­¤æ—¶æˆ‘ä»¬æ‰“å¼€Â http://localhost:15672/ä¼šå‘ç°æ— æ³•è®¿é—®ï¼Œè¿™æ˜¯å› ä¸ºç®¡ç†æ’ä»¶è¿˜æœªè¢«æ¿€æ´»
ğŸ€é€šè¿‡docker ps -aæŸ¥çœ‹éƒ¨ç½²çš„RabbitMQå®¹å™¨idï¼Œåœ¨é€šè¿‡ä½¿ç”¨å‘½ä»¤
docker exec -it å®¹å™¨id /bin/bashÂ ğŸ€è¿›å…¥å®¹å™¨å†…éƒ¨å†è¿è¡Œï¼šrabbitmq-plugins enable rabbitmq_management
ğŸ€æ­¤æ—¶å°±å¯ä»¥æ‰“å¼€ç®¡ç†æ’ä»¶äº†ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨ RabbitMQ ç®¡ç†ç•Œé¢ï¼Œéœ€è¦ä½¿ç”¨é»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç ï¼ˆÂ guest/guestï¼‰æ¥ç™»å½•
æ¶ˆæ¯é˜Ÿåˆ—ç®€å•æ¨¡å¼ï¼ˆç›´è¿äº¤æ¢æœºï¼‰ ğŸ€simpleæ¨¡å¼ï¼Œæ˜¯RabbitMQæœ€ç®€å•çš„ä¸€ç§æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåªæœ‰ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…å’Œä¸€ä¸ªé˜Ÿåˆ—
ğŸ€ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨å‘é€å’Œæ¥å—æ¶ˆæ¯æ—¶ï¼Œåªéœ€è¦æŒ‡å®šé˜Ÿåˆ—åï¼Œè€Œä¸éœ€è¦æŒ‡å®šå‘é€åˆ°å“ªä¸ªExchange
ç”Ÿäº§è€…ä»£ç  class MyClass { public static void Main(string[] args) { var factory = new ConnectionFactory(); factory.HostName = &#34;localhost&#34;; //RabbitMQæœåŠ¡åœ¨æœ¬åœ°è¿è¡Œ factory.UserName = &#34;guest&#34;; //ç”¨æˆ·å factory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0e778da51c38db1912017fd01954b649/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-26T10:11:23+08:00" />
<meta property="article:modified_time" content="2024-01-26T10:11:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#ä½¿ç”¨RabbitMQ-1_Dockeréƒ¨ç½²å¹¶åœ¨c#ä¸­å®ç°ç®€å•æ¨¡å¼æ¶ˆæ¯ä»£ç†</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>ä»‹ç»</h2> 
<p><strong>RabbitMQæ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼Œå®ç°äº†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼ˆAMQPï¼‰</strong>ã€‚</p> 
<p>ğŸ€RabbitMQèµ·æºäºé‡‘èç³»ç»Ÿï¼Œç°åœ¨å¹¿æ³›åº”ç”¨äºå„ç§åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åœ¨åº”ç”¨ç¨‹åºä¹‹é—´æä¾›å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ï¼Œå®ç°ç³»ç»Ÿé—´çš„è§£è€¦å’Œæ¶ˆæ¯çš„å¯é ä¼ é€’ã€‚RabbitMQä½¿ç”¨Erlangè¯­è¨€å¼€å‘ï¼Œæ”¯æŒå¤šç§å®¢æˆ·ç«¯è¯­è¨€å¦‚Pythonã€Rubyã€.NETã€Javaç­‰ã€‚</p> 
<p>æ­¤å¤–ï¼ŒRabbitMQå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p> 
<ol><li><strong>æ˜“ç”¨æ€§</strong>ï¼šæä¾›äº†ç®€å•æ˜“ç”¨çš„APIï¼Œä½¿å¾—ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯ä»¥æ–¹ä¾¿åœ°å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚</li><li><strong>æ‰©å±•æ€§</strong>ï¼šå¯ä»¥æ°´å¹³æ‰©å±•ä»¥å¤„ç†å¤§é‡çš„æ¶ˆæ¯ï¼Œæ”¯æŒé›†ç¾¤éƒ¨ç½²æ¥æé«˜ç³»ç»Ÿçš„ååé‡å’Œå¯ç”¨æ€§ã€‚</li><li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šé€šè¿‡é•œåƒé˜Ÿåˆ—ç­‰æœºåˆ¶ä¿è¯æ¶ˆæ¯ä¸ä¼šå› æœåŠ¡å™¨æ•…éšœè€Œä¸¢å¤±ï¼Œç¡®ä¿äº†ç³»ç»Ÿçš„ç¨³å¥è¿è¡Œã€‚</li><li><strong>å¤šç§äº¤æ¢æ¨¡å¼</strong>ï¼šæ”¯æŒç›´æ¥äº¤æ¢ã€æ‰‡å½¢äº¤æ¢ã€ä¸»é¢˜äº¤æ¢å’Œå¤´äº¤æ¢ç­‰å¤šç§äº¤æ¢æ¨¡å¼ï¼Œæ»¡è¶³ä¸åŒçš„æ¶ˆæ¯è·¯ç”±éœ€æ±‚ã€‚</li><li><strong>å¤šåè®®æ”¯æŒ</strong>ï¼šé™¤äº†AMQPåè®®ï¼Œè¿˜æ”¯æŒSTOMPç­‰å…¶ä»–æ¶ˆæ¯åè®®ã€‚</li></ol> 
<h2>åœ¨dockerä¸­éƒ¨ç½²RabbitMQ</h2> 
<p>ğŸ€é¦–å…ˆåœ¨dockerHubä¸­æ‰¾åˆ°RabbitMQçš„é•œåƒ</p> 
<p><a href="https://hub.docker.com/_/rabbitmq" rel="nofollow" title="rabbitmq - å®˜æ–¹å›¾ç‰‡ (docker.com)">rabbitmq - å®˜æ–¹å›¾ç‰‡ (docker.com)</a></p> 
<p>ğŸ€æ‰§è¡Œå‘½ä»¤æ‹‰å–é•œåƒ</p> 
<pre><code>docker pull rabbitmq</code></pre> 
<p>ğŸ€é•œåƒæ‹‰å–å®Œæˆä¹‹åå¯åŠ¨é•œåƒ</p> 
<pre><code>docker run -d -p 5672:5672 -p 15672:15672 --name rabbitmq rabbitmq</code></pre> 
<p>ğŸ€æ­¤æ—¶æˆ‘ä»¬æ‰“å¼€Â <a href="http://localhost:15672/" rel="nofollow" title="http://localhost:15672/">http://localhost:15672/</a>ä¼šå‘ç°æ— æ³•è®¿é—®ï¼Œè¿™æ˜¯å› ä¸ºç®¡ç†æ’ä»¶è¿˜æœªè¢«æ¿€æ´»</p> 
<p><img alt="" height="198" src="https://images2.imgbox.com/9a/ae/D1Hmv0j8_o.png" width="340"></p> 
<p>ğŸ€é€šè¿‡<span style="color:#fe2c24;"><code>docker ps -a</code></span>æŸ¥çœ‹éƒ¨ç½²çš„RabbitMQå®¹å™¨idï¼Œåœ¨é€šè¿‡ä½¿ç”¨å‘½ä»¤</p> 
<p>Â <code>docker exec -it <span style="color:#fe2c24;">å®¹å™¨id</span> /bin/bash</code>Â </p> 
<p>ğŸ€è¿›å…¥å®¹å™¨å†…éƒ¨å†è¿è¡Œï¼š<code>rabbitmq-plugins enable rabbitmq_management</code></p> 
<p><img alt="" height="289" src="https://images2.imgbox.com/f0/2f/jzZNdduR_o.png" width="546"></p> 
<p>ğŸ€æ­¤æ—¶å°±å¯ä»¥æ‰“å¼€ç®¡ç†æ’ä»¶äº†ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨ RabbitMQ ç®¡ç†ç•Œé¢ï¼Œéœ€è¦ä½¿ç”¨é»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç ï¼ˆÂ <code>guest</code>/<code>guest</code>ï¼‰æ¥ç™»å½•</p> 
<p><img alt="" height="331" src="https://images2.imgbox.com/3d/7e/eYrQb21u_o.png" width="602"></p> 
<h2>Â æ¶ˆæ¯é˜Ÿåˆ—ç®€å•æ¨¡å¼ï¼ˆç›´è¿äº¤æ¢æœºï¼‰</h2> 
<p>ğŸ€simpleæ¨¡å¼ï¼Œæ˜¯RabbitMQæœ€ç®€å•çš„ä¸€ç§æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåªæœ‰ä¸€ä¸ªç”Ÿäº§è€…ï¼Œä¸€ä¸ªæ¶ˆè´¹è€…å’Œä¸€ä¸ªé˜Ÿåˆ—</p> 
<p><img alt="" height="295" src="https://images2.imgbox.com/ba/1b/ksN41fi7_o.png" width="1200"></p> 
<p>ğŸ€ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨å‘é€å’Œæ¥å—æ¶ˆæ¯æ—¶ï¼Œåªéœ€è¦æŒ‡å®šé˜Ÿåˆ—åï¼Œè€Œä¸éœ€è¦æŒ‡å®šå‘é€åˆ°å“ªä¸ªExchange</p> 
<h3>ç”Ÿäº§è€…ä»£ç </h3> 
<pre><code class="language-cs">class MyClass
{
    public static void Main(string[] args)
    {
        var factory = new ConnectionFactory();
        factory.HostName = "localhost"; //RabbitMQæœåŠ¡åœ¨æœ¬åœ°è¿è¡Œ
        factory.UserName = "guest"; //ç”¨æˆ·å
        factory.Password = "guest"; //å¯†ç 

        //åˆ›å»ºè¿æ¥
        using (var connection = factory.CreateConnection())
        {
            //åˆ›å»ºé€šé“
            using (var channel = connection.CreateModel())
            {
                //å£°æ˜ä¸€ä¸ªåç§°ä¸ºhelloçš„æ¶ˆæ¯é˜Ÿåˆ—
                channel.QueueDeclare("hello", false, false, false, null); 

                for (int i = 0; i &lt; 5; i++)
                {
                    string message = "Hello Word ! " + i; //ä¼ é€’çš„æ¶ˆæ¯å†…å®¹
                    var body = Encoding.UTF8.GetBytes(message);
                    //æ­¤å¤„çš„å‚æ•°"hello" å°±å¯¹åº”çš„å°±æ˜¯ä¸Šé¢å£°æ˜çš„æ¶ˆæ¯é˜Ÿåˆ—çš„è·¯ç”±é”®
                    channel.BasicPublish("", "hello", null, body); //å¼€å§‹ä¼ é€’
                    Console.WriteLine("å·²å‘é€ï¼š {0}", message);
                }
            }
        }
    }
}</code></pre> 
<h3>æ¶ˆè´¹è€…ä»£ç ï¼ˆè‡ªåŠ¨æ¨¡å¼ï¼‰</h3> 
<pre><code class="language-cs">class MyClass
{
    static void Main(string[] args)
    {
        //åˆ›å»ºè¿æ¥å·¥å‚
        var factory = new ConnectionFactory();
        factory.HostName = "localhost";
        factory.UserName = "guest";
        factory.Password = "guest";
        //åˆ›å»ºè¿æ¥
        using (var connection = factory.CreateConnection())
        {
            //åˆ›å»ºé€šé“
            using (var channel = connection.CreateModel())
            {
                //å£°æ˜é˜Ÿåˆ—
                channel.QueueDeclare("hello", false, false, false, null);
                
                //äº‹ä»¶çš„åŸºæœ¬æ¶ˆè´¹è€…
                var consumer = new EventingBasicConsumer(channel);
                
                consumer.Received += (model, ea) =&gt;
                {
                    var body = ea.Body.ToArray();
                    var message = Encoding.UTF8.GetString(body);
                    Console.WriteLine("å·²æ¥æ”¶ï¼š {0}", message);
                    //å‘é€æ¶ˆæ¯ç¡®è®¤ä¿¡å·ï¼ˆæ‰‹åŠ¨ç¡®è®¤ï¼‰    
                    //channel.BasicAck(ea.DeliveryTag,false);
                };
                
                //å½“ autoAckè®¾ç½®ä¸ºtrueæ—¶ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼Œä¸€æ—¦æ¶ˆæ¯é˜Ÿåˆ—å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆæ¯æ¶ˆè´¹è€…åï¼Œå°±ä¼šä»å†…å­˜ä¸­å°†è¿™ä¸ªæ¶ˆæ¯åˆ é™¤ã€‚
                //å½“autoAckè®¾ç½®ä¸ºfalseæ—¶ï¼Œä¹Ÿå°±æ˜¯æ‰‹åŠ¨æ¨¡å¼ï¼Œå¦‚æœæ­¤æ—¶çš„æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å®•æœºï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±ä¼šå°†è¿™æ¡æ¶ˆæ¯ç»§ç»­å‘é€ç»™å…¶ä»–çš„æ¶ˆè´¹è€…ï¼Œè¿™æ ·æ•°æ®åœ¨æ¶ˆæ¯æ¶ˆè´¹è€…é›†ç¾¤çš„ç¯å¢ƒä¸‹ï¼Œå°±ä¸ä¼šä¸ä¸¢å¤±äº†ã€‚
                channel.BasicConsume("hello", true, consumer);
                Console.ReadKey();
            }
        }
    }
}</code></pre> 
<p>ğŸ€åœ¨æ¶ˆè´¹è€…ä»£ç ä¸­ï¼Œè¦æ³¨æ„çš„æ˜¯autoAckè®¾ç½®ä¸ºtrueæ—¶ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨ç¡®è®¤æ¨¡å¼çš„æ—¶å€™ï¼Œè¦å»æ‰æ‰‹åŠ¨å‘é€ç¡®è®¤ä¿¡å·ä»£ç ï¼šchannel.BasicAck(ea.DeliveryTag,false);Â Â </p> 
<h3>ä»£ç è°ƒè¯•</h3> 
<p><img alt="" height="251" src="https://images2.imgbox.com/d8/d1/eXiTyVrK_o.png" width="1200"></p> 
<p>ğŸ€Â åœ¨ä»£ç æ‰§è¡Œåˆ°</p> 
<pre>channel.QueueDeclare("hello", false, false, false, null);</pre> 
<p>Â ğŸ€å£°æ˜ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æ—¶ï¼Œåœ¨RabbitMQçš„å¯è§†åŒ–ç•Œé¢å°±å¯ä»¥çœ‹è§å¤šäº†ä¸€ä¸ªåç§°ä¸ºhelloçš„æ¶ˆæ¯é˜Ÿåˆ—</p> 
<p><img alt="" height="179" src="https://images2.imgbox.com/5c/8b/dVphvJSq_o.png" width="516"></p> 
<p>ğŸ€å½“æ‰§è¡Œå®Œäº”æ¬¡æ¶ˆæ¯ä¼ é€’æ—¶ï¼Œç‚¹å‡»ä¸Šå›¾çš„helloæ¶ˆæ¯é˜Ÿåˆ—ï¼ŒMessages:è®¾ç½®ä¸º5ï¼Œç„¶åç‚¹å‡»GetÂ Messagesï¼Œå°±å¯ä»¥çœ‹åˆ°ä¼ é€’è¿‡æ¥çš„5æ¡æ¶ˆæ¯é˜Ÿåˆ—äº†</p> 
<p><img alt="" height="246" src="https://images2.imgbox.com/ba/ef/42x6n0rT_o.png" width="510"></p> 
<p>Â <img alt="" height="348" src="https://images2.imgbox.com/83/64/lBnuWBwb_o.png" width="517"></p> 
<p>ğŸ€æ­¤æ—¶æˆ‘ä»¬æ‰§è¡Œæ¶ˆè´¹è€…ä»£ç ï¼Œå› ä¸ºautoAckè®¾ç½®ä¸ºtrueäº†ï¼Œå½“æ¶ˆæ¯é˜Ÿåˆ—å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€…åï¼Œå°±ä¼šç«‹é©¬å°†æ¶ˆæ¯åˆ é™¤ï¼Œæ­¤æ—¶å†ç‚¹å‡»GetÂ Messageså°±ä¼šæç¤ºQueue is empty</p> 
<p><img alt="" height="545" src="https://images2.imgbox.com/5e/fd/HrpSkXRn_o.png" width="1200"></p> 
<h3>æ¶ˆè´¹è€…ä»£ç ï¼ˆæ‰‹åŠ¨æ¨¡å¼ï¼‰</h3> 
<p>åœ¨æ‰‹åŠ¨æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬å°†åŸæ¥å£°æ˜çš„é˜Ÿåˆ—åˆ é™¤è°ƒï¼Œç„¶åå°†<span style="color:#fe2c24;">ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…</span>çš„å£°æ˜é˜Ÿåˆ—ä»£ç ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°éƒ½æ”¹ä¸ºtrueï¼Œæ„å‘³ç€è¿™ä¸ªé˜Ÿåˆ—æ˜¯æŒä¹…çš„ã€‚åœ¨ RabbitMQ æœåŠ¡å™¨é‡å¯ä¹‹åï¼ŒæŒä¹…çš„é˜Ÿåˆ—å’Œå®ƒçš„æ¶ˆæ¯éƒ½ä¸ä¼šä¸¢å¤±</p> 
<pre><code class="language-cs">channel.QueueDeclare("hello", true, false, false, null);</code></pre> 
<p>ç„¶åæ·»åŠ ä¸€è¡Œä»£ç ï¼Œè®¾ç½®å½“å‰æ¶ˆè´¹è€…çš„é¢„å–æ¨¡å¼ä¸ºåªé¢„å–ä¸€æ¡æ¶ˆæ¯</p> 
<pre><code class="language-cs">channel.BasicQos(0, 1, false);</code></pre> 
<p>Â æ¥ç€æ˜¯ å‘é€æ¶ˆæ¯ç¡®è®¤ä¿¡å· ä¸ å¼€å¯æ‰‹åŠ¨ç¡®è®¤æ¨¡å¼</p> 
<pre><code class="language-cs">channel.BasicAck(ea.DeliveryTag,false);
channel.BasicConsume("hello", false, consumer);</code></pre> 
<p>è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œä¸€å®šè¦åœ¨ç»“å°¾å¤„åŠ ä¸Šä¸‹æ–¹ä»£ç ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°è¿˜æ²¡å‘é€æ¶ˆæ¯ç¡®è®¤ä¿¡å·ï¼Œè¿›ç¨‹å°±ç»“æŸäº†ï¼Œè¿™æ—¶å°±ä¼šå‘ç°å°†æ¥æ”¶åˆ°çš„hellowordæ‰“å°åˆ°æ§åˆ¶å°äº†ï¼Œå»RabbitMQå¯è§†ä¹ç®¡ç†ç•Œé¢å‘ç°äº‹ä»¶è¿˜æœªè¢«æ¶ˆè€—æ‰ã€‚</p> 
<pre><code class="language-cs">Console.ReadKey();</code></pre> 
<pre><code class="language-cs">  static void Main(string[] args)
    {
        //åˆ›å»ºè¿æ¥å·¥å‚
        var factory = new ConnectionFactory();
        factory.HostName = "localhost";
        factory.UserName = "guest";
        factory.Password = "guest";
        //åˆ›å»ºè¿æ¥
        using (var connection = factory.CreateConnection())
        {
            //åˆ›å»ºé€šé“
            using (var channel = connection.CreateModel())
            {
                //å£°æ˜é˜Ÿåˆ—
                channel.QueueDeclare("hello", true, false, false, null);
                channel.BasicQos(0, 1, false);
                //äº‹ä»¶çš„åŸºæœ¬æ¶ˆè´¹è€…
                var consumer = new EventingBasicConsumer(channel);
                
                consumer.Received += (model, ea) =&gt;
                {
                    var body = ea.Body.ToArray();
                    var message = Encoding.UTF8.GetString(body);
                    Console.WriteLine("å·²æ¥æ”¶ï¼š {0}", message);
                    //å‘é€æ¶ˆæ¯ç¡®è®¤ä¿¡å·ï¼ˆæ‰‹åŠ¨ç¡®è®¤ï¼‰    
                    channel.BasicAck(ea.DeliveryTag,false);
                };
                
                //å½“ autoAckè®¾ç½®ä¸ºtrueæ—¶ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨ç¡®è®¤æ¨¡å¼ï¼Œä¸€æ—¦æ¶ˆæ¯é˜Ÿåˆ—å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆæ¯æ¶ˆè´¹è€…åï¼Œå°±ä¼šä»å†…å­˜ä¸­å°†è¿™ä¸ªæ¶ˆæ¯åˆ é™¤ã€‚
                //å½“autoAckè®¾ç½®ä¸ºfalseæ—¶ï¼Œä¹Ÿå°±æ˜¯æ‰‹åŠ¨æ¨¡å¼ï¼Œå¦‚æœæ­¤æ—¶çš„æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å®•æœºï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±ä¼šå°†è¿™æ¡æ¶ˆæ¯ç»§ç»­å‘é€ç»™å…¶ä»–çš„æ¶ˆè´¹è€…ï¼Œè¿™æ ·æ•°æ®åœ¨æ¶ˆæ¯æ¶ˆè´¹è€…é›†ç¾¤çš„ç¯å¢ƒä¸‹ï¼Œå°±ä¸ä¼šä¸ä¸¢å¤±äº†ã€‚
                channel.BasicConsume("hello", false, consumer);
                Console.ReadKey();
            }
        }
    }</code></pre> 
<h3>ä»£ç è°ƒè¯•</h3> 
<p>æŒ‰ç…§ä¸Šé¢æ”¹æˆæ‰‹åŠ¨æ¨¡å¼åï¼Œæ¶ˆè´¹è€…åªé¢„å–ä¸€æ¡æ¶ˆæ¯ï¼Œå¦‚ä¸‹å›¾0ã€1ã€2è¢«æ¶ˆè´¹æ‰äº†ï¼Œæ­¤æ—¶å†å»RabbitMQçš„å¯è§†ä¹ç®¡ç†ç•Œé¢ç‚¹å‡»GetMessageï¼Œåªå‰©ä¸‹3ã€4çš„æ¶ˆæ¯å†…å®¹äº†</p> 
<p><img alt="" height="331" src="https://images2.imgbox.com/fb/c4/9fWfuSyS_o.png" width="602"></p> 
<p>Â <img alt="" height="382" src="https://images2.imgbox.com/6c/f7/5Hqw8Qci_o.png" width="553"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c36961933e6f9ef290e4561edeb8cfa7/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">æ·±å…¥äº†è§£å¡å°”æ›¼æ»¤æ³¢ï¼šæœ€ä¼˜çŠ¶æ€ä¼°è®¡çš„æ•°å­¦ç¥å™¨</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/31f4329d446d87b12315efc77d0753bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">C#ä½¿ç”¨RabbitMQ-2_è¯¦è§£å·¥ä½œé˜Ÿåˆ—æ¨¡å¼</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>