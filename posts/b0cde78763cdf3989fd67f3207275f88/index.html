<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>EGE基础：输入篇 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="EGE基础：输入篇" />
<meta property="og:description" content="EGE专栏：EGE专栏
EGE基础：输入篇 文章目录 一、sys_edit 类1. 头文件检查 二、 sys_edit类的使用1. 使用步骤1.1 输入框的创建1.2 设置输入框参数1.2.1 必要设置1.2.1.1 输入框位置1.2.1.2 输入框大小 1.2.2 非必要设置1.2.2.1 允许输入的最大字符数1.2.2.2 输入框背景颜色1.2.2.3 输入框文字的颜色1.2.2.4 输入框文字的字体1.2.2.5 只读模式 1.3 设置输入框可见1.4 设置输入框获取焦点 (非必要设置) 2. 输入框内容的获取2.1 注意事项2.2 宽字符 3. sys_edit类的其它操作3.1 设置输入框的内容3.2 清空输入框内容3.3 获取输入框位置和大小3.4 隐藏输入框3.5 销毁输入框 4. 输入框说明4.1 输入框相关的一些事项4.2 变量的生命周期问题 三、输入框使用例程1. 文本输入实例1.1 字符char型1.2 宽字符wchar_t 型 2. 多个输入框2.1 多个输入框的使用2.2 相同样式输入框统一初始化 3. getch()无法阻塞、窗口闪退的情况4. 获取数字等输入4.1 从输入框获取参数示例 5. EGE自带的输入对话框inputbox_getline() EGE中的输入是基于 &lt;ege/sys_edit.h&gt; 头文件中是 sys_edit 类的。这个类提供一个输入框，可以用来输入。
缺点是sys_edit 类中检测是否获得焦点的 isfocus() 失效，那创建多个输入框时，就不可以通过回车来获取输入内容，因为不知道焦点在哪个输入框。
如果能检测焦点，那输入后回车就可以判断焦点在哪个输入框，然后获取该输入框的内容。现在不能检测，那就只能 通过添加按钮 的方式，当点击某个按钮时，就获取对应的输入框的内容。
一、sys_edit 类 使用前需要先包含 sys_edit." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b0cde78763cdf3989fd67f3207275f88/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-19T14:46:55+08:00" />
<meta property="article:modified_time" content="2022-04-19T14:46:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">EGE基础：输入篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>EGE专栏：<a href="https://blog.csdn.net/qq_39151563/category_9311717.html">EGE专栏</a></p> 
<center> 
 <font size="6"><b>EGE基础：输入篇</b></font> 
</center> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#sys_edit__10" rel="nofollow">一、sys_edit 类</a></li><li><ul><li><a href="#1__21" rel="nofollow">1. 头文件检查</a></li></ul> 
  </li><li><a href="#_sys_edit_33" rel="nofollow">二、 sys_edit类的使用</a></li><li><ul><li><a href="#1__55" rel="nofollow">1. 使用步骤</a></li><li><ul><li><a href="#11__56" rel="nofollow">1.1 输入框的创建</a></li><li><a href="#12__76" rel="nofollow">1.2 设置输入框参数</a></li><li><ul><li><a href="#121__77" rel="nofollow">1.2.1 必要设置</a></li><li><ul><li><a href="#1211__78" rel="nofollow">1.2.1.1 输入框位置</a></li><li><a href="#1212__83" rel="nofollow">1.2.1.2 输入框大小</a></li></ul> 
     </li><li><a href="#122__98" rel="nofollow">1.2.2 非必要设置</a></li><li><ul><li><a href="#1221__101" rel="nofollow">1.2.2.1 允许输入的最大字符数</a></li><li><a href="#1222__106" rel="nofollow">1.2.2.2 输入框背景颜色</a></li><li><a href="#1223__110" rel="nofollow">1.2.2.3 输入框文字的颜色</a></li><li><a href="#1224__114" rel="nofollow">1.2.2.4 输入框文字的字体</a></li><li><a href="#1225__120" rel="nofollow">1.2.2.5 只读模式</a></li></ul> 
    </li></ul> 
    </li><li><a href="#13__127" rel="nofollow">1.3 设置输入框可见</a></li><li><a href="#14___137" rel="nofollow">1.4 设置输入框获取焦点 (非必要设置)</a></li></ul> 
   </li><li><a href="#2__144" rel="nofollow">2. 输入框内容的获取</a></li><li><ul><li><a href="#21__175" rel="nofollow">2.1 注意事项</a></li><li><a href="#22__178" rel="nofollow">2.2 宽字符</a></li></ul> 
   </li><li><a href="#3_sys_edit_208" rel="nofollow">3. sys_edit类的其它操作</a></li><li><ul><li><a href="#31__209" rel="nofollow">3.1 设置输入框的内容</a></li><li><a href="#32__214" rel="nofollow">3.2 清空输入框内容</a></li><li><a href="#33__219" rel="nofollow">3.3 获取输入框位置和大小</a></li><li><a href="#34__235" rel="nofollow">3.4 隐藏输入框</a></li><li><a href="#35__253" rel="nofollow">3.5 销毁输入框</a></li></ul> 
   </li><li><a href="#4__265" rel="nofollow">4. 输入框说明</a></li><li><ul><li><a href="#41___266" rel="nofollow">4.1 输入框相关的一些事项</a></li><li><a href="#42__271" rel="nofollow">4.2 变量的生命周期问题</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_303" rel="nofollow">三、输入框使用例程</a></li><li><ul><li><a href="#1__306" rel="nofollow">1. 文本输入实例</a></li><li><ul><li><a href="#11_char_308" rel="nofollow">1.1 字符char型</a></li><li><a href="#12_wchar_t__392" rel="nofollow">1.2 宽字符wchar_t 型</a></li></ul> 
   </li><li><a href="#2__478" rel="nofollow">2. 多个输入框</a></li><li><ul><li><a href="#21__479" rel="nofollow">2.1 多个输入框的使用</a></li><li><a href="#22__519" rel="nofollow">2.2 相同样式输入框统一初始化</a></li></ul> 
   </li><li><a href="#3_getch_569" rel="nofollow">3. getch()无法阻塞、窗口闪退的情况</a></li><li><a href="#4__676" rel="nofollow">4. 获取数字等输入</a></li><li><ul><li><a href="#41__783" rel="nofollow">4.1 从输入框获取参数示例</a></li></ul> 
   </li><li><a href="#5_EGE_888" rel="nofollow">5. EGE自带的输入对话框</a></li><li><ul><li><a href="#inputbox_getline_889" rel="nofollow">inputbox_getline()</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p>  EGE中的输入是基于 <strong>&lt;ege/sys_edit.h&gt;</strong> 头文件中是 <strong>sys_edit</strong> 类的。这个类提供一个输入框，可以用来输入。</p> 
<p>  缺点是<strong>sys_edit</strong> 类中检测是否获得焦点的 <strong>isfocus()</strong> 失效，那创建多个输入框时，就不可以通过回车来获取输入内容，因为不知道焦点在哪个输入框。<br>   如果能检测焦点，那输入后回车就可以判断焦点在哪个输入框，然后获取该输入框的内容。现在不能检测，那就只能 <strong>通过添加按钮</strong> 的方式，当点击某个按钮时，就获取对应的输入框的内容。</p> 
<h2><a id="sys_edit__10"></a>一、sys_edit 类</h2> 
<blockquote> 
 <p>  使用前需要先包含 <code>sys_edit.h</code>头文件。sys_edit.h头文件是放在ege文件夹下，所以使用<code>#include &lt;ege/sys_edit.h&gt;</code><br>   <strong>sys_edit.h</strong> 头文件需要在<strong>graphics.h</strong> 或<strong>ege.h</strong>之后包含，不能放在它们的前面。</p> 
</blockquote> 
<p>  包含 <strong>sys_edit.h</strong> 头文件如下所示：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>
</code></pre> 
<h3><a id="1__21"></a>1. 头文件检查</h3> 
<blockquote> 
 <p>  <strong>sys_edit</strong> 类 定义在EGE的 <strong>sys_edit.h</strong> 头文件中，可能有些人按照的是别人的教程安装的EGE，所以头文件路径不正确，显示 <strong>No such File or Directory</strong> 。现在统一按照EGE安装包中的文件放置。</p> 
</blockquote> 
<p>  可以看到，EGE安装包中，在include 目录下有两个头文件和一个ege文件夹，ege文件夹中有五个头文件，这些都是EGE自带的控件。<strong>所以复制头文件时，直接把include文件夹中的文件全选，复制到安装目录的inlcude目录即可</strong>。<br> <img src="https://images2.imgbox.com/9a/50/KS1nMdYa_o.png" alt="在这里插入图片描述" width="500"><br> <img src="https://images2.imgbox.com/52/81/OudH8Bfz_o.png" alt="在这里插入图片描述" width="500"></p> 
<ul><li>然后到安装目录的<strong>include目录</strong>检查你的头文件<code>(这个是VS2017，根据自己使用的IDE来查看)</code><br> <img src="https://images2.imgbox.com/c0/b9/58ozEtPa_o.png" alt="在这里插入图片描述" width="700"><br> <img src="https://images2.imgbox.com/fa/66/hkvX4BBo_o.png" alt="在这里插入图片描述" width="600"></li></ul> 
<h2><a id="_sys_edit_33"></a>二、 sys_edit类的使用</h2> 
<blockquote> 
 <p>  需要包含 <strong>&lt;ege/sys_edit.h&gt;</strong> 头文件，需要注意的是， <strong>sys_edit.h</strong> 头文件需要在<strong>graphics.h</strong> 或<strong>ege.h</strong>之后包含，不能放在它们的前面。</p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>
</code></pre> 
<p>  输入框使用前需要创建并进行一些设置，设置示例如下所示。</p> 
<pre><code class="prism language-cpp">sys_edit editBox<span class="token punctuation">;</span>
editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//创建，false表示单行，true表示多行</span>
editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//设置位置</span>
editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>fontHeight <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> fontHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置尺寸</span>
editBox<span class="token punctuation">.</span><span class="token function">setmaxlen</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//设置允许输入的字符数</span>
editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//设置可见性</span>
editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>							<span class="token comment">//设置获取焦点</span>
</code></pre> 
<p>  下面是具体的使用步骤。</p> 
<h3><a id="1__55"></a>1. 使用步骤</h3> 
<h4><a id="11__56"></a>1.1 输入框的创建</h4> 
<p>  先创建 <strong>sys_edit</strong> 对象</p> 
<pre><code class="prism language-cpp">sys_edit editBox<span class="token punctuation">;</span>
</code></pre> 
<p>  然后调用成员函数 <strong>create()</strong> 来创建输入框。</p> 
<p><strong>函数声明</strong>：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> sys_edit<span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">bool</span> multline<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  函数参数为 <strong>bool</strong> 型，控制输入框是多行输入框还是单行输入框。</p> 
<blockquote> 
 <p>参数: bool型</p> 
 <ul><li><strong>true</strong> 表示<strong>多行输入框</strong>，这样输入超过输入框宽度时会自动换行，并且可以输入回车换行。</li><li><strong>false</strong> 表示<strong>单行输入框</strong>，即使超过输入框长度，依然不会换行，都在同一行内，无法输入回车进行换行。</li></ul> 
</blockquote> 
<p>创建输入框</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="12__76"></a>1.2 设置输入框参数</h4> 
<h5><a id="121__77"></a>1.2.1 必要设置</h5> 
<h6><a id="1211__78"></a>1.2.1.1 输入框位置</h6> 
<p>  设置输入框左上角在窗口上的位置坐标，单位为像素。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//设置输入框位置</span>
</code></pre> 
<h6><a id="1212__83"></a>1.2.1.2 输入框大小</h6> 
<p>  设置输入框的宽高，单位为像素。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置输入框大小</span>
</code></pre> 
<p>  <strong>这个宽度大小是包含输入框边框</strong>的，所以如果你正好设置为文字的高度，那么部分文字会被遮挡，输入框高度可以多加 8。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span>fontHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//设置输入框字体高度</span>
editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>editBoxWidth<span class="token punctuation">,</span> fontHeight <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置输入框大小</span>
</code></pre> 
<h5><a id="122__98"></a>1.2.2 非必要设置</h5> 
<p>  这里是一些其它设置，可以根据需要进行设置</p> 
<h6><a id="1221__101"></a>1.2.2.1 允许输入的最大字符数</h6> 
<p>  设置后，输入的字符数量不会超过这个值。当输入框中字符数量达到最大长度后，其它字符无法输入到输入框中。<code>(中文字符和英文字符都算做一个字符)</code></p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setmaxlen</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="1222__106"></a>1.2.2.2 输入框背景颜色</h6> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>输入框背景颜色<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="1223__110"></a>1.2.2.3 输入框文字的颜色</h6> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setcolor</span><span class="token punctuation">(</span>输入框文字颜色<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h6><a id="1224__114"></a>1.2.2.4 输入框文字的字体</h6> 
<p>  设置相应输入框的文字字体，和全局字体无关。<br>   参数是（height, width, “字体”）。<code>(width为0时，表示文字在设置的高度下按照原比例所对应的宽度; width不为0时则强制字体变形为对应宽度。)</code></p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"宋体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		
</code></pre> 
<h6><a id="1225__120"></a>1.2.2.5 只读模式</h6> 
<p>  可以控制输入框是否允许用户输入。设置为只读模式后，输入框不允许用户输入。(<mark>输入框默认为<strong>允许输入</strong></mark>)</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setreadonly</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//设置为只读模式，不允许输入</span>
editBox<span class="token punctuation">.</span><span class="token function">setreadonly</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//设置输入框允许输入</span>
</code></pre> 
<h4><a id="13__127"></a>1.3 设置输入框可见</h4> 
<p>  创建好后， 需要调用成员函数<strong>visible()</strong> 设置<strong>输入框可见</strong>，否则是看不到输入框的，因为输入框创建后<strong>默认是隐藏</strong>的(设置完成后再进行显示)。<br>   <code>(如果你用的是19.01版本的EGE, 那应该是 visable() 函数，别问visable是什么单词，问就是visible)</code></p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>参数:(bool)</p> 
 <ul><li>true : 输入框可见。</li><li>false : 输入框隐藏 <strong>(默认)</strong></li></ul> 
</blockquote> 
<h4><a id="14___137"></a>1.4 设置输入框获取焦点 (非必要设置)</h4> 
<p>可设置输入框获取焦点。输入框获取焦点后，输入框将会有光标闪烁，此时用户可以进行输入。</p> 
<ul><li>输入框获取焦点后，用户按下按键便可直接向输入框字符。</li><li>不设置获取焦点时，用户需要先用鼠标点击一下输入框，让输入框获取焦点，才能进行输入。</li></ul> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2__144"></a>2. 输入框内容的获取</h3> 
<p>  输入框内容的获取需要调用成员函数 <strong>gettext()</strong> 。</p> 
<pre><code class="prism language-cpp"><span class="token function">gettext</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxLen<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> 字符缓冲区首地址<span class="token punctuation">)</span><span class="token punctuation">;</span> 			<span class="token comment">//char型</span>
<span class="token function">gettext</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxLen<span class="token punctuation">,</span> <span class="token keyword">wchar_t</span><span class="token operator">*</span> 字符缓冲区首地址<span class="token punctuation">)</span><span class="token punctuation">;</span> 		<span class="token comment">//宽字符型</span>
</code></pre> 
<p>  其中，参数<strong>maxLen</strong> 表示字符缓冲区所占内存的大小 <strong>(单位为字节)</strong>。字符缓冲区可以是<strong>char</strong>型，也可以是<strong>宽字符</strong>类型。</p> 
<p>  要获取输入框内容，首先需要创建一个<strong>字符数组</strong>或<strong>宽字符数组</strong>作为<strong>缓冲区</strong>，用于存储字符串。<br>   <strong><mark>请根据输入的字符数预留好足够的空间大小，如果最大输入N个字符，缓冲区请至少预留2 * (N +1 )个字节的空间大小(汉字占两个字节，加上末尾’\0’字符)</mark></strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<p>使用示例：</p> 
<pre><code class="prism language-cpp"><span class="token comment">//创建一个字符数组来保存输入框中的内容</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//获取输入框的内容，保存到字符数组strBuffer[]中</span>
editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span>  strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//可以对得到字符串做其它处理</span>
<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//输出内容</span>

<span class="token keyword">int</span> a<span class="token punctuation">;</span>
<span class="token function">sscanf</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//如果输入框输入的是数字，读取到a中</span>
</code></pre> 
<p>  这样就获取到了输入框的内容。<strong>输入的内容保存在char数组strBuffer[ ]中</strong>。</p> 
<h4><a id="21__175"></a>2.1 注意事项</h4> 
<p>  输入框是可以输入汉字的，但汉字在GB2312编码下正常会占两个字节，如果使用用char数组，将占用两个char。使用 <strong>printf()</strong> 也是可以正常输出的。<br>   <mark>按一次回车键会输入<strong>回车符</strong>和<strong>换行符</strong>两个字符</mark>。</p> 
<h4><a id="22__178"></a>2.2 宽字符</h4> 
<p>  如果你想要不管什么内容，一个字符都占用一个字符变量的大小，那可以使用宽字符类型 <strong>wchar_t</strong> 。 <code>(宽字符类型占用两个字节)</code></p> 
<p><strong>头文件包含</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wchar.h&gt;</span></span>
</code></pre> 
<p><strong>宽字符数组</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">wchar_t</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token string">""</span><span class="token punctuation">;</span>
</code></pre> 
<p><mark>宽字符串要使用 <strong>L" " 来表示</strong>, 而不是 <strong>" "</strong></mark></p> 
<p><strong>获取输入框内容到宽字符数组缓存中：</strong></p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p>buffSize是缓存区大小，这个要设置正确，设置的值可以小于缓存区大小，这样缓冲区有剩余部分不使用，但是不能超出缓冲区大小，否则输入框内容多时会出现写入内容越界，容易造成程序崩溃。</p> 
</blockquote> 
<p>  获取宽字符数组长度可以使用 <strong>wcslen()</strong> 函数， 这个函数在头文件<strong>wchar.h</strong> 中声明。(<code>即 wide char string length 的缩写</code>)</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">wcslen</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  <mark>使用<strong>xyprintf()</strong> 输出宽字符串时, 格式字符串也要用 <strong>L" "</strong> 表示，否则可能会输出不完整。</mark></p> 
<pre><code class="prism language-cpp"><span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> L<span class="token string">"输入内容：%s"</span><span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="3_sys_edit_208"></a>3. sys_edit类的其它操作</h3> 
<h4><a id="31__209"></a>3.1 设置输入框的内容</h4> 
<p>使用 <strong>settext()</strong> 来设置输入框的内容</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">settext</span><span class="token punctuation">(</span><span class="token string">"输入框内容"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="32__214"></a>3.2 清空输入框内容</h4> 
<p>调用 <strong>settext("")</strong> 即可把输入框内容清空(<code>即把内容设为空字符串</code>)</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">settext</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="33__219"></a>3.3 获取输入框位置和大小</h4> 
<p>获取输入框位置</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">getx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//获取左上角x坐标</span>
editBox<span class="token punctuation">.</span><span class="token function">gety</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//获取左上角y坐标</span>
</code></pre> 
<p>获取输入框大小</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//获取输入框宽度</span>
editBox<span class="token punctuation">.</span><span class="token function">getw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//获取输入框宽度</span>

editBox<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//获取输入框高度</span>
editBox<span class="token punctuation">.</span><span class="token function">geth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//获取输入框高度</span>
</code></pre> 
<h4><a id="34__235"></a>3.4 隐藏输入框</h4> 
<p>  调用 <strong>editBox.visible(false)</strong> 就能将设置为不可见。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  如果焦点在输入框上时输入框隐藏，此时焦点仍在输入框上，除非用户点击了窗口，否则用户还是能通过按键继续输入。<br>   如果想隐藏输入框的同时不允许用户继续输入，可以同时将输入框设置为<strong>只读</strong>。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//隐藏输入框</span>
editBox<span class="token punctuation">.</span><span class="token function">setreadonly</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//设置输入框为只读</span>
</code></pre> 
<p>  当输入框恢复可见时，不要忘记设置允许输入。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//输入框可见</span>
editBox<span class="token punctuation">.</span><span class="token function">setreadonly</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//输入框允许输入</span>
</code></pre> 
<h4><a id="35__253"></a>3.5 销毁输入框</h4> 
<p>  如果已经不需要输入框了，可以调用 <strong>destroy()</strong> 将输入框销毁。这样输入框就没了。</p> 
<pre><code class="prism language-cpp">editBox<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  销毁后，如果想再次输入，需要按照以上流程重新创建。</p> 
<blockquote> 
 <p>  需要注意的是，EGE 19.01及之前版本函数名是 <strong>destory</strong>。<code>如果编译错误，说找不到destroy，请改成 editBox.destory()</code></p> 
</blockquote> 
<p>  <strong>sys_edit对象会在超出所在块后自动销毁。</strong> 所以一般情况下不需要调用。</p> 
<h3><a id="4__265"></a>4. 输入框说明</h3> 
<h4><a id="41___266"></a>4.1 输入框相关的一些事项</h4> 
<ul><li>输入框作为子窗口位于EGE图形窗口之上，不会被绘图覆盖。</li><li>点击输入框，光标闪烁，对应输入框会获取焦点。如果开始没有调用 <strong>setfocus()</strong>, 那么需要自己点击，输入框才会获取焦点。</li><li>在输入框输入的时候依然会EGE图形窗口中产生按键消息，退出帧循环时，可以用<strong>flushkey()</strong> 清空一下消息队列，以免影响到其它如getch() ,getkey()之类的函数。</li></ul> 
<h4><a id="42__271"></a>4.2 变量的生命周期问题</h4> 
<p>  对于一个变量，生命周期从程序执行到变量初始化处开始，程序执行到超出变量作用域后结束。<br>   如果变量是创建在块内，那么运行超出这个块后，这个变量将被销毁。这个在循环中很常见。<strong>一个循环需要多次执行语句块，所以会多次进入块、退出块的操作</strong>。因此定义在块中局部变量，会被多次创建和销毁。<br>   按如下代码所示，<strong>输入框会被多次创建和销毁</strong>，而输入框创建后默认是隐藏的，如果在输入框生命周期中将输入框设置为可见，那么输入框会在不断地创建、使用和销毁过程中闪烁，并且无法输入内容。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token punctuation">;</span> <span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	sys_edit editBox<span class="token punctuation">;</span>	<span class="token comment">//放在循环内，每次循环都会重新创建一个新的sys_edit</span>
	
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	<span class="token comment">//输入框初始化，参数配置等等操作</span>
	
	<span class="token comment">//继续运行将超过editBox所在块，editBox自动销毁</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  所以在输入框的使用过程中，应该保证不超出输入框的生命周期范围之外。输入框应该定义在帧循环之外。按如下所示，循环过程中</p> 
<pre><code class="prism language-cpp">sys_edit editBox<span class="token punctuation">;</span>	<span class="token comment">//定义在循环之外，循环执行过程不会重复创建</span>
editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	<span class="token comment">//输入框初始化，参数配置等等操作</span>
	
<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token punctuation">;</span> <span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>


<span class="token punctuation">}</span>
</code></pre> 
<p>  那如果同一个输入框在不同的函数里使用怎么办？此时就不能定义成函数的局部变量，应该<strong>使用动态分配或者定义成全局变量</strong>，保证使用过程一直在输入框的生命周期内。</p> 
<h2><a id="_303"></a>三、输入框使用例程</h2> 
<p>下面来做个输入框示例（宽字符型<strong>wchar_t</strong> 和 字符型 <strong>char</strong> 分别做个示例）</p> 
<h3><a id="1__306"></a>1. 文本输入实例</h3> 
<p>  这里简单做个输入框输入的示例，按下回车便会在窗口上显示内容。对于char型和wchar_t型，使用上没有多大的区别，仅仅只是字符串存储上的不同。</p> 
<h4><a id="11_char_308"></a>1.1 字符char型</h4> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> INIT_RENDERMANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> fontHeight <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token function">setfont</span><span class="token punctuation">(</span>fontHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkmode</span><span class="token punctuation">(</span>TRANSPARENT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox<span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//创建，false表示单行</span>
	editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//设置位置</span>
	<span class="token keyword">int</span> editTextHeight <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>editTextHeight <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> editTextHeight <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置尺寸，高度一般要比字的高多一点，因为输入框的边框也占一定大小。</span>
	editBox<span class="token punctuation">.</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置背景颜色</span>
	editBox<span class="token punctuation">.</span><span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置文字颜色</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span>editTextHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置字体</span>

	<span class="token keyword">int</span> maxLen <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>

	editBox<span class="token punctuation">.</span><span class="token function">setmaxlen</span><span class="token punctuation">(</span>maxLen<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置输入最大长度</span>
	<span class="token comment">//editBox.setreadonly(false);				//默认允许输入</span>
	editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//使可见</span>
	<span class="token comment">//获取焦点</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//创建输入缓存区</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> buffLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">bool</span> isOutput <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">//检测到回车键弹起就标记输出</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">kbmsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			key_msg msg <span class="token operator">=</span> <span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>key <span class="token operator">==</span> key_enter<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>msg <span class="token operator">==</span> key_msg_up<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				isOutput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">//需要输出</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>isOutput<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//获取输入框内容字符串</span>
			editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//计算字符串长度</span>
			buffLen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//如果你想获取后清空输入框，设置内容为空字符串</span>
			<span class="token comment">//editBox.settext("");</span>
		<span class="token punctuation">}</span>

		<span class="token function">cleardevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"缓存区大小：%d"</span><span class="token punctuation">,</span> buffSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"限制最大输入长度：%d"</span><span class="token punctuation">,</span> maxLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//如果缓存区有内容就输出</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>strBuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">"输入文本长度：%d"</span><span class="token punctuation">,</span> buffLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//区域输出，因为内容较多,xyprintf不会自动换行，所以用下面这个</span>
			<span class="token function">outtextxy</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">"输入内容:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">rectprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"%s"</span><span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//如果退出循环，直接getch()是无法阻塞的，因为输入的时候也在产生按键消息</span>
	<span class="token comment">//需要先清空按键消息</span>
	<span class="token function">flushkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1b/db/VHgXevYB_o.png" alt="在这里插入图片描述" width="500"></p> 
<h4><a id="12_wchar_t__392"></a>1.2 宽字符wchar_t 型</h4> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wchar.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setrendermode</span><span class="token punctuation">(</span>RENDER_MANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> fontHeight <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token function">setfont</span><span class="token punctuation">(</span>fontHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkmode</span><span class="token punctuation">(</span>TRANSPARENT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox<span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//创建，false表示单行</span>
	editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> editTextHeight <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>editTextHeight <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> editTextHeight <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置尺寸</span>
	editBox<span class="token punctuation">.</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置背景颜色</span>
	editBox<span class="token punctuation">.</span><span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置文字颜色</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span>editTextHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置字体</span>

	<span class="token keyword">int</span> maxLen <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>

	editBox<span class="token punctuation">.</span><span class="token function">setmaxlen</span><span class="token punctuation">(</span>maxLen<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置输入最大长度</span>
	<span class="token comment">//editBox.setreadonly(false);				//默认允许输入</span>
	editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//使可见</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>							<span class="token comment">//获取焦点</span>

	<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token comment">//初始值给一个空字符串，方便判断是否有内容，否则未初始化，不好处理</span>
	<span class="token comment">//宽字符串用 L""表示</span>
	<span class="token keyword">wchar_t</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token string">""</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> buffLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">bool</span> press <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>		<span class="token comment">//用来标记是否按下</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">bool</span> isOutput <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">//检测到回车键抬起就标记输出</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">kbmsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			key_msg msg <span class="token operator">=</span> <span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>key <span class="token operator">==</span> key_enter<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>msg <span class="token operator">==</span> key_msg_up<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				isOutput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//需要进行输出</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>isOutput <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//获取输入框内容字符串</span>
			editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//计算字符串长度</span>
			buffLen <span class="token operator">=</span> <span class="token function">wcslen</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">cleardevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"缓存区大小：%d"</span><span class="token punctuation">,</span> buffSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"限制最大输入长度：%d"</span><span class="token punctuation">,</span> maxLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//如果缓存区有内容就输出</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>strBuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">"输入文本长度：%d"</span><span class="token punctuation">,</span> buffLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">outtextxy</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">"输入内容:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//注意这里要用 L""</span>
			<span class="token function">rectprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> L<span class="token string">"%s"</span><span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//如果退出循环，直接getch()是无法阻塞的，因为输入的时候也在产生按键消息</span>
	<span class="token comment">//需要先清空按键消息</span>
	<span class="token function">flushkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1f/d7/YHpbIlzR_o.png" alt="在这里插入图片描述" width="500"></p> 
<h3><a id="2__478"></a>2. 多个输入框</h3> 
<h4><a id="21__479"></a>2.1 多个输入框的使用</h4> 
<p>多个输入框就创建多个<strong>sys_edit</strong>对象，分别对其初始化即可。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">,</span> INIT_RENDERMANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox<span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">24</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox1<span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox1<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//帧循环，处理交互，不可少，否则直接退出</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="22__519"></a>2.2 相同样式输入框统一初始化</h4> 
<p>  较多情况下，输入框的样式基本都是一样的，只是大小，位置不同，这时可以将配置输入框的函数封装，只留下位置和大小参数。<br>   如果觉得输入框需要各种不同的样式，可以自己定义一个包含各种设置参数的结构体，当做参数传入即可。<code>(EGE的输入框也没提供什么样式，小搞一下就行)</code></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">initEditBox</span><span class="token punctuation">(</span>sys_edit<span class="token operator">*</span> editBox<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	editBox<span class="token operator">-&gt;</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token operator">-&gt;</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>YELLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token operator">-&gt;</span><span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token operator">-&gt;</span><span class="token function">move</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token operator">-&gt;</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token operator">-&gt;</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">,</span> INIT_RENDERMANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> width <span class="token operator">=</span> <span class="token number">280</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> text<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">300</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">;</span>

		<span class="token function">initEditBox</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>editBox<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">sprintf</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"editbox %d"</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		editBox<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">settext</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//帧循环，处理交互，不可少，否则直接退出</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/da/55/LClezpOn_o.png" alt="在这里插入图片描述" width="600"></p> 
<h3><a id="3_getch_569"></a>3. getch()无法阻塞、窗口闪退的情况</h3> 
<p>  因为你在输入框输入的时候会产生按键消息，所以当你退出循环后，因为存有按键消息，getch()会直接从按键消息队列里面获取，而不会阻塞，所以如果后面就是<strong>closegraph()</strong>,看到窗口闪一下就关闭了。<br>   对于有输入框的程序，可以考虑是否需要使用 <strong>flushkey()</strong> 清空消息队列。</p> 
<p><strong>下面先看一下出问题时情况：</strong><br>   这个程序在帧循环里仅仅只是检测回车键有没有按下，按下就退出循环，并且没有读取按键消息。那么这时<strong>消息队列里就会堆积一定数量的消息</strong>。退出循环后，程序就会读取队列里剩余的按键消息并计数。这样可以看到在退出循环后，会剩余多少个按键消息，这就是getch()不阻塞的原因。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">,</span> INIT_RENDERMANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	sys_edit editBox<span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token string">"输入后按回车， 看看有多少个按键消息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token string">"和你输入时按下的按键数和速度有关"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">keystate</span><span class="token punctuation">(</span>key_enter<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">//这里用来计数并清空剩余按键消息</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">kbmsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		count<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">setcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token string">"剩余字符数：%d"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token string">"按任意键退出"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e4/9b/nAZGyxLm_o.png" alt="在这里插入图片描述" width="500"></p> 
<p>  所以在输入框中输入完成后，可以考虑用 <strong>flushkey()</strong> 清空按键消息，或者在帧循环中处理按键消息。==</p> 
<p>如下所示</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">,</span> INIT_RENDERMANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox<span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">24</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setfont</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token string">"输入后按回车， 看看有多少个按键消息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token string">"和你输入时按下的按键数和速度有关"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">bool</span> exit <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">kbmsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			key_msg msg <span class="token operator">=</span> <span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//检测到按键按下就退出</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>key <span class="token operator">==</span> key_enter<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>msg <span class="token operator">==</span> key_msg_up<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				exit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>exit<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>	
	<span class="token punctuation">}</span>

	<span class="token comment">//注意这里，清空按键消息队列里的消息</span>
	<span class="token function">flushkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token string">"按任意键退出"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="4__676"></a>4. 获取数字等输入</h3> 
<p>  可能有人只会在控制台程序中使用 <strong>scanf()</strong> 获取数字输入，而对于从输入框获取到的字符串不知如何得到参数，因为它只给我们提供了获取字符串内容的<strong>gettext()</strong>。</p> 
<p>  在控制台中获取输入，我们可能会这样：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>
<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  然后从控制台输入两个数据，就完成了变量的赋值。但其实呢，我们输入进控制台的，就是字符串， 只不过是 <mark><strong>scanf()</strong> 函数 对这个字符串进行了解析，从里面提取出了我们想要的值</mark>。</p> 
<p>  你可能见过这样的编程题：</p> 
<blockquote> 
 <p><strong>函数填空</strong><br>   <strong>calculateN</strong> 函数的功能是计算出由字符串表示的数值。<br>   函数参数为一个只包含十进制数字字符(‘0’~‘9’)的字符串，字符串长度最小为1，最大为5。字符串所对应的十进制数字为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          N 
         
        
          ( 
         
        
          0 
         
        
          ⩽ 
         
        
          N 
         
        
          ⩽ 
         
        
          9999 
         
        
          ) 
         
        
       
         N(0 \leqslant N \leqslant 9999) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.82em; vertical-align: -0.13667em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span><span class="mclose">)</span></span></span></span></span>，要求计算出<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          N 
         
        
       
         N 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">N</span></span></span></span></span>的值并返回。</p> 
 <pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">calculateN</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>
</code></pre> 
 <p>我们可以写下这样的答案:</p> 
 <pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">calculateN</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> p <span class="token operator">=</span> str<span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> str<span class="token punctuation">;</span> <span class="token operator">*</span>p <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		sum <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> sum <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
 <p>这样就能将字符串转成数字了。</p> 
</blockquote> 
<p>  那标准库中有没有这样的函数能实现同样的效果呢？当然有，<strong>&lt;stdlib.h&gt;</strong> 头文件中的 <strong>atoi()</strong> 就能将十进制数字字符串转成相应的值。<br>   所以函数可以改成如下所示：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">calculateN</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
 	<span class="token keyword">return</span> <span class="token function">atoi</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  那对于更复杂的输入，想像 <strong>scanf()</strong> 一样从字符串读取各种数据呢？那就是同在 <strong>&lt;stdio.h&gt;</strong> 头文件中的 <strong>sscanf()</strong>。<br>   <mark><strong>sscanf()</strong> 可以和 <strong>scanf()</strong> 一样读取出各种不同的数据</mark>，区别仅仅是 <strong>scanf()</strong> 控制台的输入中读取，而 <strong>sscanf()</strong> 从字符串中读取。类似的，还有从文件中读取的 <strong>fscanf()</strong>。</p> 
<p><strong>函数声明：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span> <span class="token keyword">const</span> _Format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">sscanf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span> <span class="token keyword">const</span> _Buffer<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span> <span class="token keyword">const</span> _Format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  可以看到 <strong>sscanf()</strong> 前面多了一个字符串类型的 <strong>_Buffer</strong> 参数，对于从 <strong>输入框得到的字符串</strong> ，我们可以将其传入 <strong>sscanf()</strong> 来获取我们需要的值。</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span>	<span class="token comment">//sscanf()所需头文件 &lt;stdio.h&gt;</span></span>


<span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span>  strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">sscanf</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">,</span> <span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  其中，<strong>strBuffer是字符数组首地址</strong>。<br>   可以看到，除了前面多了个 <strong>strBuffer</strong>参数 ， 其它参数和 <strong>scanf()</strong> 是一样的。这和我们在控制台是一样的， 只不过<strong>scanf()</strong> 处理的是我们在控制台窗口输入的字符，而<strong>sscanf()</strong> 处理的是字符串中的内容。</p> 
<p>  <mark>对于宽字符类型的字符串， 则可以使用 <strong>swscanf()</strong></mark>。</p> 
<pre><code class="prism language-cpp">
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span>	<span class="token comment">//swscanf()所需头文件 &lt;stdio.h&gt;</span></span>


<span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">wchar_t</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span>  strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">swscanf</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">,</span> L<span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>  上面我们已经能通过 <strong>sys_edit::gettext()</strong>，获取输入框内容了，假设是存入<strong>strBuff</strong> 中，那么就可以用下面的方法获取输入的数字:</p> 
<pre><code class="prism language-cpp">这是之前定义的缓存区
<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

这是变量
<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>在输入框输入完成后<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span> strBuff<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">sscanf</span><span class="token punctuation">(</span>strBuffer<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	这样就已经完成了数字的输入
<span class="token punctuation">}</span>
</code></pre> 
<p>  可以看到, <strong>sscanf()</strong> 相比于 <strong>scanf()</strong> 除了字符串的来源不同，其它都是一样的，你可以输入小数,用 <strong>"%f "</strong>, 输入整数，用 <strong>“%d”</strong>, 输入两个数字，用 <strong>"%d %d"</strong></p> 
<h4><a id="41__783"></a>4.1 从输入框获取参数示例</h4> 
<p>  实现从输入框中获取输入的数字，然后计算平方值。<br> <img src="https://images2.imgbox.com/d3/f7/DXUXiSEC_o.png" alt="在这里插入图片描述" width="300"></p> 
<p>  要注意的是，因为输入框可以随便输入，输入的格式不一定正确，所以要好好利用 <strong>scanf</strong> 的返回值，返回值是读入的数值个数，如果和我们要读入的变量数不等，那就不操作，或者提示输入有误，直到输入正确。</p> 
<p>  下面有很多判断的代码是 <strong>为了检测输入框内容是否要求,如果能确保格式符合要求，<strong>gettext()</strong> 后直接 <strong>ssanf()</strong> 就完成了。</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;graphics.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ege/sys_edit.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> INIT_RENDERMANUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> fontHeight <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
	<span class="token function">setfont</span><span class="token punctuation">(</span>fontHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setbkmode</span><span class="token punctuation">(</span>TRANSPARENT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	sys_edit editBox<span class="token punctuation">;</span>
	editBox<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//单行</span>
	editBox<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//设置位置</span>

	<span class="token keyword">int</span> editTextHeight <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>

	<span class="token comment">//设置尺寸，高度一般要比字的高多一点，因为输入框的边框也占一定大小。</span>
	editBox<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span>editTextHeight <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> editTextHeight <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	

	editBox<span class="token punctuation">.</span><span class="token function">setbgcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置背景颜色</span>
	editBox<span class="token punctuation">.</span><span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">//设置文字颜色</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfont</span><span class="token punctuation">(</span>editTextHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//设置输入框字体</span>
	editBox<span class="token punctuation">.</span><span class="token function">setmaxlen</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//设置输入最大长度</span>
	editBox<span class="token punctuation">.</span><span class="token function">visible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">//使可见</span>
	editBox<span class="token punctuation">.</span><span class="token function">setfocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>							<span class="token comment">//获取焦点</span>

	<span class="token comment">//创建输入缓存区</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> buffSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> strBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

	<span class="token keyword">bool</span> flag_press <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>		<span class="token comment">//用来标记是否按下</span>
	<span class="token keyword">bool</span> hasInput <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>			<span class="token comment">//标记是否有数字输入</span>
	<span class="token keyword">bool</span> error <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>				<span class="token comment">//标记是否输入错误</span>
	<span class="token keyword">double</span> a<span class="token punctuation">;</span>
	<span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token function">is_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">delay_fps</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">bool</span> calculate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

		<span class="token comment">//检测到回车键抬起就标记输出</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">kbmsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			key_msg msg <span class="token operator">=</span> <span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>key <span class="token operator">==</span> key_enter<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>msg <span class="token operator">==</span> key_msg_up<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				calculate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//需要进行计算</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>calculate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//获取输入框内容字符串</span>
			editBox<span class="token punctuation">.</span><span class="token function">gettext</span><span class="token punctuation">(</span>buffSize<span class="token punctuation">,</span> strBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//判断输入是否为空</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>strBuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				hasInput <span class="token operator">=</span> error <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//判断是否成功读取到数字</span>
			<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sscanf</span><span class="token punctuation">(</span>strBuff<span class="token punctuation">,</span> <span class="token string">"%lf"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				result <span class="token operator">=</span> a <span class="token operator">*</span> a<span class="token punctuation">;</span>
				error <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
				hasInput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">//输入错误</span>
			<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
				hasInput <span class="token operator">=</span> error <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/* --------绘图部分-------*/</span>
		<span class="token function">cleardevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//清屏</span>
		<span class="token function">setcolor</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">outtextxy</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"输入数字:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">outtextxy</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">"平方结果:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>hasInput<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>		<span class="token comment">//有输入</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>	<span class="token comment">//有输入但是输入错误</span>
				<span class="token comment">//输出错误提示</span>
				<span class="token function">setcolor</span><span class="token punctuation">(</span>RED<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">outtextxy</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">"输入错误，请重新输入"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>		<span class="token comment">//有输入并且输入正确</span>
				<span class="token function">xyprintf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">"%f"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token function">closegraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="5_EGE_888"></a>5. EGE自带的输入对话框</h3> 
<h4><a id="inputbox_getline_889"></a>inputbox_getline()</h4> 
<p>  对话框样式是这个函数自己画的，不是很好看，可以自己画个背景其实。<strong>并且在ege20.08版本中出了点问题，导致对话框全黑。</strong> <mark>(个人不建议使用)</mark></p> 
<p><strong>功能：</strong><br>   使用对话框让用户输入一个字符串。<br>   不过这个对话框不能自己设置样式。对话框其实都是自己画的，想要样式可以使用<strong>sys_edit</strong> 类，然后<strong>自己贴个对话框背景图</strong>。</p> 
<p><strong>函数声明：</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">inputbox_getline</span><span class="token punctuation">(</span>LPCSTR  title<span class="token punctuation">,</span> LPCSTR  text<span class="token punctuation">,</span> LPSTR  buf<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">inputbox_getline</span><span class="token punctuation">(</span>LPCWSTR title<span class="token punctuation">,</span> LPCWSTR text<span class="token punctuation">,</span> LPWSTR buf<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><strong>参数：</strong></p> 
 <ul><li>title: 对话框标题</li><li>text: 对话框内显示的提示文字，可以使用’\n’或者’\t’进行格式控制。</li><li>buf: 用于接收输入的字符串指针，指向一个缓冲区</li><li>len: 指定buf指向的缓冲区的大小，同时也会限制在对话框里输入的最大长度</li></ul> 
</blockquote> 
<p><strong>返回值：</strong><br>   返回 <strong>true</strong> 表示输入有效，buf中的内容为用户所输入的数据，返回 <strong>false</strong> 表示输入无效，同时buf清空。</p> 
<p><strong>示例程序：</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"graphics.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">initgraph</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">480</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setbkcolor</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">inputbox_getline</span><span class="token punctuation">(</span><span class="token string">"这是一个对话框"</span><span class="token punctuation">,</span> <span class="token string">"请随便\n输入一串字符，输入完请回车"</span><span class="token punctuation">,</span>
                    str<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">outtextxy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/65/e7/MZ9YEfxF_o.png" alt="在这里插入图片描述" width="600"></p> 
<hr> 
<p>EGE专栏：<a href="https://blog.csdn.net/qq_39151563/category_9311717.html">EGE专栏</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/30c446c984e9093b2533ec77967c6cf0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【做项目】基于SpringBoot从零开发的个人博客 —— 从技术选型到部署实战（附学习路线）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fbf2c421d6c51b1762b1036583b5f0e5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Tensorflow-gpu安装&#43;Keras安装&#43;Pytorch-gpu安装 经验分享/Win10 (conda安装Cuda和Cudnn) 含测试代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>