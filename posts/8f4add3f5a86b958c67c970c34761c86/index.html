<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>达摩院开源预训练数据微调框架UOT NeurIPS论文深入解读 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="达摩院开源预训练数据微调框架UOT NeurIPS论文深入解读" />
<meta property="og:description" content="​​​​​​​ 团队模型、论文、博文、直播合集，点击此处浏览 一、论文 论文链接: Improved Fine-Tuning by Better Leveraging Pre-Training Data 代码链接：https://github.com/ziquanliu/NeurIPS2022_UOT_fine_tuning
二、背景 在下游任务中对预训练模型进行微调被广泛用于许多深度学习的应用中。最近的深度学习的研究主要聚焦在预训练数据充分的情况下如何训练更强大的预训练模型，然而预训练模型在下游的使用往往面临着数据不充分的困难。另一方面，最近的研究经验表明，一旦在某些视觉任务中增加了训练样本的数量，从头开始训练的最终性能并不比这种预训练策略差。在这项工作中，我们使用学习理论中流行的超额风险界限，从泛化分析的角度重新审视了这一现象。当下游数据有限时，我们提出利用预训练数据进行微调。使用预训练数据来进行微调的泛化结果表明，当微调中包含适当的预训练数据时，可以改善目标任务的过度风险界限。基于我们的理论分析，我们提出了一种新的选择策略，从预训练数据中选择一个子集，以帮助提高对目标任务的泛化能力。我们的方法如下图所示。
三、理论分析 首先定义下游的目标函数和上游预训练函数，然后我们对这两个函数的性质做出如下四个假设。其中第一个假设是对两个训练分布的相似性给一个上界，第二和第三是描述优化目标函数的unbiased, bounded variance和smoothness性质，第四个是常用的PL condition.
给定以上四个假设，我们可以得到下面的引理。引理1说明了当下游数据的数据量到达一定程度的时候，预训练模型对于随机初始化来说其实没有什么优势。这个引理也解释了之前人们在实验中发现的现象[1]。
当下游任务的数据量有限时，我们提出在fine-tuning时重复利用预训练数据。具体来说我们在fine-tuning时把两个训练数据的损失函数做一个加权，然后用两部分数据训练这个网络。在实际的操作中，我们对于下游数据和预训练数据使用不同的线性分类器，以便我们可以使用任意数量的下游类别，而且下游和预训练的标签互不影响。
对于这种joint fine-tuning的效果，我们推导了如下定理。该定理说明，如果我们能够选取适当的预训练数据，使得两个训练数据的距离缩小，那么joint fine-tuning的效果会变得更好。
四、数据选择 我们提出一种基于unbalanced optimal transport的通用的数据选择方法，简记为UOT数据选择。我们的思想是找到一个运输方式把预训练数据运输到下游数据，而这种运输方式体现了预训练数据的某个类和下游数据的距离。我们发现这种UOT数据选择的方式在选择相似数据上非常的有效，如下图所示。因为CUB数据只包含鸟类图片，所以我们知道这时候需要从预训练集上选择的数据是鸟类。UOT成功地选择了几乎所有ImageNet中的鸟类
五、结果 1. 效果展示 我们分别用有监督和无监督的预训练模型在8个下游数据集上做了我们的实验。当预训练数据集无标签时，我们用K-means聚类给数据打上伪标签。实验结果表明，我们的UOT joint-fine-tuning在多数数据集上取得了最优的效果。
2. 小数据集与长尾类分布 我们进一步模拟了下游的小数据集和长尾类分布的情况。左图中我们展示了对CUB和Caltech数据集按类进行数据量下采样的实验结果。当数据量越小时，我们的UOT方法取得了越大的提升。右表显示了我们对于3个数据集进行长尾累分布采样后，再进行UOT和标准微调的结果。我们的方法在这种情况下取得了显著更好的结果。
六、参考文献 [1] He, Kaiming, Ross Girshick, and Piotr Dollár. &#34;Rethinking imagenet pre-training.&#34; Proceedings of the IEEE/CVF International Conference on Computer Vision. 2019.
七、应用 接下来给大家介绍下我们研发的各个域上的开源免费模型，欢迎大家体验、下载（大部分手机端即可体验）：
ModelScope 魔搭社区
ModelScope 魔搭社区
ModelScope 魔搭社区
ModelScope 魔搭社区
ModelScope 魔搭社区" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8f4add3f5a86b958c67c970c34761c86/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-30T10:58:30+08:00" />
<meta property="article:modified_time" content="2023-03-30T10:58:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">达摩院开源预训练数据微调框架UOT NeurIPS论文深入解读</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:0px;text-align:center;">​​​​​​​  <a href="https://www.modelscope.cn/topic/fa2736f56c4c42a789a2a99b0bd3d959/pub/summary" rel="nofollow" title="团队模型、论文、博文、直播合集，点击此处浏览">团队模型、论文、博文、直播合集，点击此处浏览</a></h2> 
<h2 style="margin-left:0;"><span style="color:#000000;">一、论文</span></h2> 
<p style="margin-left:0;"><a name="u73d8cf45"><span style="color:#000000;">论文</span></a><span style="color:#000000;">链接</span><span style="color:#000000;">: </span><a href="https://openreview.net/pdf?id=YTXIIc7cAQ" rel="nofollow" title="Improved Fine-Tuning by Better Leveraging Pre-Training Data">Improved Fine-Tuning by Better Leveraging Pre-Training Data</a><u> </u></p> 
<p style="margin-left:0;"><a name="u383fdced"><span style="color:#0d0016;">代码链接：</span></a><a class="link-info" href="https://github.com/ziquanliu/NeurIPS2022_UOT_fine_tuning" title="https://github.com/ziquanliu/NeurIPS2022_UOT_fine_tuning">https://github.com/ziquanliu/NeurIPS2022_UOT_fine_tuning</a></p> 
<h2 style="margin-left:0px;"></h2> 
<h2 style="margin-left:0px;"><a name="qkIPD"><span style="color:#0d0016;">二、背景</span></a></h2> 
<p style="margin-left:0;"><a name="lb0PA">        <span style="color:#0d0016;">在下游任务中对预训练模型进行微调被广泛用于许多深度学习的应用中。最近的深度学习的研究主要聚焦在预训练数据充分的情况下如何训练更强大的预训练模型，然而预训练模型在下游的使用往往面临着数据不充分的困难。另一方面，最近的研究经验表明，一旦在某些视觉任务中增加了训练样本的数量，从头开始训练的最终性能并不比这种预训练策略差。在这项工作中，我们使用学习理论中流行的超额风险界限，从泛化分析的角度重新审视了这一现象。当下游数据有限时，我们提出利用预训练数据进行微调。使用预训练数据来进行微调的泛化结果表明，当微调中包含适当的预训练数据时，可以改善目标任务的过度风险界限。基于我们的理论分析，我们提出了一种新的选择策略，从预训练数据中选择一个子集，以帮助提高对目标任务的泛化能力。我们的方法如下图所示。</span></a></p> 
<p class="img-center"><img alt="" height="364" src="https://images2.imgbox.com/55/f9/HH0olfx8_o.png" width="904"></p> 
<p></p> 
<p style="margin-left:0;"></p> 
<h2 style="margin-left:0;"><span style="color:#000000;">三、理论分析</span></h2> 
<p style="margin-left:0;">        首先定义下游的目标函数和上游预训练函数，然后我们对这两个函数的性质做出如下四个假设。其中第一个假设是对两个训练分布的相似性给一个上界，第二和第三是描述优化目标函数的unbiased, bounded variance和smoothness性质，第四个是常用的PL condition.</p> 
<p class="img-center"><img alt="" height="452" src="https://images2.imgbox.com/ef/4f/Ezu3bcDJ_o.png" width="904"></p> 
<p>         给定以上四个假设，我们可以得到下面的引理。引理1说明了当下游数据的数据量到达一定程度的时候，预训练模型对于随机初始化来说其实没有什么优势。这个引理也解释了之前人们在实验中发现的现象[1]。</p> 
<p class="img-center"><img alt="" height="382" src="https://images2.imgbox.com/38/57/tYFvSnCP_o.png" width="904"></p> 
<p>         当下游任务的数据量有限时，我们提出在fine-tuning时重复利用预训练数据。具体来说我们在fine-tuning时把两个训练数据的损失函数做一个加权，然后用两部分数据训练这个网络。在实际的操作中，我们对于下游数据和预训练数据使用不同的线性分类器，以便我们可以使用任意数量的下游类别，而且下游和预训练的标签互不影响。</p> 
<p class="img-center"><img alt="" height="250" src="https://images2.imgbox.com/89/52/VXcxjZNT_o.png" width="904"></p> 
<p>         对于这种joint fine-tuning的效果，我们推导了如下定理。该定理说明，如果我们能够选取适当的预训练数据，使得两个训练数据的距离缩小，那么joint fine-tuning的效果会变得更好。</p> 
<p class="img-center"><img alt="" height="158" src="https://images2.imgbox.com/d7/41/KZgoKdCD_o.png" width="904"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<p style="margin-left:0;"></p> 
<h2 style="margin-left:0;"><span style="color:#000000;">四、数据选择</span></h2> 
<p style="margin-left:0;">        我们提出一种基于unbalanced optimal transport的通用的数据选择方法，简记为UOT数据选择。我们的思想是找到一个运输方式把预训练数据运输到下游数据，而这种运输方式体现了预训练数据的某个类和下游数据的距离。我们发现这种UOT数据选择的方式在选择相似数据上非常的有效，如下图所示。因为CUB数据只包含鸟类图片，所以我们知道这时候需要从预训练集上选择的数据是鸟类。UOT成功地选择了几乎所有ImageNet中的鸟类</p> 
<p class="img-center"><img alt="" height="276" src="https://images2.imgbox.com/d2/ac/5D0UJQZO_o.png" width="812"></p> 
<p class="img-center"><img alt="" height="286" src="https://images2.imgbox.com/67/87/S4OYAWPP_o.png" width="904"></p> 
<h2></h2> 
<h2><a name="KpBHR"><span style="color:#0d0016;">五、结果</span></a></h2> 
<p style="margin-left:0;"></p> 
<h3 style="margin-left:0px;"><a name="ujkwK"><span style="color:#0d0016;">1. </span></a><span style="color:#0d0016;">效果展示</span></h3> 
<p style="margin-left:0;">        我们分别用有监督和无监督的预训练模型在8个下游数据集上做了我们的实验。当预训练数据集无标签时，我们用K-means聚类给数据打上伪标签。实验结果表明，我们的UOT joint-fine-tuning在多数数据集上取得了最优的效果。</p> 
<p class="img-center"><img alt="" height="394" src="https://images2.imgbox.com/01/bc/UkK8JmfM_o.png" width="904"></p> 
<p></p> 
<h3 style="margin-left:0;"><span style="color:#000000;"><a name="ub169d493"></a></span></h3> 
<h3 style="margin-left:0px;"><a name="fqkEh"><span style="color:#0d0016;">2. </span></a><span style="color:#0d0016;">小数据集与长尾类分布</span><a name="u92d4ce00"></a><a name="ubfeba096"></a></h3> 
<p style="margin-left:0;">        我们进一步模拟了下游的小数据集和长尾类分布的情况。左图中我们展示了对CUB和Caltech数据集按类进行数据量下采样的实验结果。当数据量越小时，我们的UOT方法取得了越大的提升。右表显示了我们对于3个数据集进行长尾累分布采样后，再进行UOT和标准微调的结果。我们的方法在这种情况下取得了显著更好的结果。</p> 
<p class="img-center"><img alt="" height="366" src="https://images2.imgbox.com/90/a2/M1xJnPK3_o.png" width="904"></p> 
<p></p> 
<h2 style="margin-left:0;"><span style="color:#000000;">六、参考文献</span></h2> 
<p style="margin-left:0;">[1] He, Kaiming, Ross Girshick, and Piotr Dollár. "Rethinking imagenet pre-training." Proceedings of the IEEE/CVF International Conference on Computer Vision. 2019.</p> 
<h2></h2> 
<h2>七、应用</h2> 
<p>        接下来给大家介绍下我们研发的各个域上的开源免费模型，欢迎大家体验、下载（大部分手机端即可体验）：</p> 
<p><a href="https://modelscope.cn/models/damo/cv_resnet50_face-detection_retinaface/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_resnet101_face-detection_cvpr22papermogface/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_manual_face-detection_tinymog/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_manual_face-detection_ulfd/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_manual_face-detection_mtcnn/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_resnet_face-recognition_facemask/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_ir50_face-recognition_arcface/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_manual_face-liveness_flir/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_manual_face-liveness_flrgb/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_manual_facial-landmark-confidence_flcm/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_vgg19_facial-expression-recognition_fer/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p> 
<p><a href="https://modelscope.cn/models/damo/cv_resnet34_face-attribute-recognition_fairface/summary" rel="nofollow" title="ModelScope 魔搭社区">ModelScope 魔搭社区</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/61474adbb123c6ffb5dad0726a6de815/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RK3588 RGA 图像操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b12a3ff29b83cefa844108bd0342777b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CV2与PIL</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>