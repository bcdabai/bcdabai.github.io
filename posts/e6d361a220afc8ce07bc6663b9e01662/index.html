<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL多表关系及多表查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL多表关系及多表查询" />
<meta property="og:description" content="多表关系 在关系型数据库中存在着三种多表关系，分别是一对多（多对一）、多对多以及一对一。之所以会产生这些关系，是因为在进行数据设计的时候，分析得出业务之间存在着一定的关系，进而在数据中也就存在了这些关系。
一对多 一对多是最基础的表间关系，意思是一张表A中的一条记录可以对应另一张表B中的多条记录，另一张表B中的一条记录只能对应一张表A中的一条记录。
案例: 部门 与 员工的关系
关系: 一个部门对应多个员工，一个员工对应一个部门
实现: 在多的一方建立外键，指向一的一方的主键
对应的SQL脚本
-- 创建部门表 create table dept ( id int primary key auto_increment comment &#39;编号&#39;, name varchar(10) comment &#39;姓名&#39; ) comment &#39;部门表&#39;; -- 创建员工表 create table emp ( id int primary key auto_increment comment &#39;编号&#39;, name varchar(10) comment &#39;姓名&#39;, age int comment &#39;年龄&#39;, dept_id int comment &#39;部门编号&#39;, constraint fk_dept_emp foreign key (dept_id) references dept (id) ) comment &#39;员工表&#39;; 多对多 一张表A中的一条记录可以对应另一张表B中的多条记录，另一张表B中的一条记录也可以对应一张表A中的多条记录。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e6d361a220afc8ce07bc6663b9e01662/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-18T20:58:50+08:00" />
<meta property="article:modified_time" content="2023-03-18T20:58:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL多表关系及多表查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>多表关系</h2> 
<p>在关系型数据库中存在着三种多表关系，分别是<code>一对多</code>（<code>多对一</code>）、<code>多对多</code>以及<code>一对一</code>。之所以会产生这些关系，是因为在进行数据设计的时候，分析得出业务之间存在着一定的关系，进而在数据中也就存在了这些关系。</p> 
<h3><a id="_3"></a>一对多</h3> 
<blockquote> 
 <p>一对多是最基础的表间关系，意思是一张表A中的一条记录可以对应另一张表B中的多条记录，另一张表B中的一条记录只能对应一张表A中的一条记录。</p> 
</blockquote> 
<p><strong>案例</strong>: <code>部门</code> 与 <code>员工</code>的关系<br> <strong>关系</strong>: 一个部门对应多个员工，一个员工对应一个部门<br> <strong>实现</strong>: 在多的一方建立外键，指向一的一方的主键<br> <img src="https://images2.imgbox.com/00/22/2hsIoRI9_o.png" alt=""><br> 对应的SQL脚本</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建部门表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> dept
<span class="token punctuation">(</span>
    id   <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'姓名'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'部门表'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建员工表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> emp
<span class="token punctuation">(</span>
    id      <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
    name    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    age     <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'年龄'</span><span class="token punctuation">,</span>
    dept_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'部门编号'</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_dept_emp <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">references</span> dept <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'员工表'</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_31"></a>多对多</h3> 
<blockquote> 
 <p>一张表A中的一条记录可以对应另一张表B中的多条记录，另一张表B中的一条记录也可以对应一张表A中的多条记录。</p> 
</blockquote> 
<p><strong>案例</strong>: <code>学生</code> 与 <code>课程</code>的关系<br> <strong>关系</strong>: 一个学生可以选修多门课程，一门课程也可以供多个学生选择<br> <strong>实现</strong>: 建立第三张中间表，中间表至少包含两个外键，分别关联两方主键<br> <img src="https://images2.imgbox.com/86/cf/XzKEs7OQ_o.png" alt=""><br> 对应的SQL脚本</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建学生表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> student
<span class="token punctuation">(</span>
    id   <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    <span class="token keyword">no</span>   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学号'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学生表'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建课程表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> course
<span class="token punctuation">(</span>
    id   <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'课程名称'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'课程表'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建学生与课程的关系表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> student_course
<span class="token punctuation">(</span>
    id         <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键'</span><span class="token punctuation">,</span>
    student_id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
    course_id  <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_courseId <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>course_id<span class="token punctuation">)</span> <span class="token keyword">references</span> course <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_studentId <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">)</span> <span class="token keyword">references</span> student <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学生课程关系表'</span><span class="token punctuation">;</span>

</code></pre> 
<h3><a id="_66"></a>一对一</h3> 
<blockquote> 
 <p>一对一的关系就是一种特殊的多对多的关系，一张表A中的一条记录只能对应另一张表B中的一条记录，另一张表B中的一条记录也只能对应一张表A中的一条记录。</p> 
</blockquote> 
<p><strong>案例</strong>: <code>用户</code> 与 <code>用户</code>详情的关系<br> <strong>关系</strong>: 一对一关系，多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率<br> <strong>实现</strong>: 在任意一方加入外键，关联另外一方的主键，并且设置外键为唯一的(UNIQUE)<br> <img src="https://images2.imgbox.com/e6/be/xcLVdabO_o.png" alt=""><br> 对应的SQL脚本</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建用户表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> tb_user
<span class="token punctuation">(</span>
    id     <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    name   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    age    <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'年龄'</span><span class="token punctuation">,</span>
    gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'1: 男 , 2: 女'</span><span class="token punctuation">,</span>
    phone  <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'手机号'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'用户基本信息表'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建用户教育表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> tb_user_edu
<span class="token punctuation">(</span>
    id             <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    degree         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学历'</span><span class="token punctuation">,</span>
    major          <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'专业'</span><span class="token punctuation">,</span>
    primary_school <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'小学'</span><span class="token punctuation">,</span>
    middle_school  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'中学'</span><span class="token punctuation">,</span>
    university     <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'大学'</span><span class="token punctuation">,</span>
    userid         <span class="token keyword">int</span> <span class="token keyword">unique</span> <span class="token keyword">comment</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_userid <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>userid<span class="token punctuation">)</span> <span class="token keyword">references</span> tb_user <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'用户教育信息表'</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_100"></a>多表查询概述</h2> 
<h3><a id="span_id_jump1span_101"></a><span id="jump1">准备数据</span></h3> 
<pre><code class="prism language-sql">
<span class="token comment">-- 删除员工表（若存在）</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> emp<span class="token punctuation">;</span>

<span class="token comment">-- 删除部门表（若存在）</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dept<span class="token punctuation">;</span>

<span class="token comment">-- 创建dept表，并插入数据</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> dept
<span class="token punctuation">(</span>
    id   <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">'ID'</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'部门名称'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'部门表'</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> dept <span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'研发部'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'市场部'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'财务部'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'销售部'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'总经办'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'人事部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 创建emp表，并插入数据</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> emp
<span class="token punctuation">(</span>
    id         <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">'ID'</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    name       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    age        <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'年龄'</span><span class="token punctuation">,</span>
    job        <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'职位'</span><span class="token punctuation">,</span>
    salary     <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'薪资'</span><span class="token punctuation">,</span>
    entry_date <span class="token keyword">date</span> <span class="token keyword">comment</span> <span class="token string">'入职时间'</span><span class="token punctuation">,</span>
    manager_id <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'直属领导ID'</span><span class="token punctuation">,</span>
    dept_id    <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'部门ID'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'员工表'</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加外键</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> emp
    <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_emp_dept_id <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">references</span> dept <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp <span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> entry_date<span class="token punctuation">,</span> manager_id<span class="token punctuation">,</span> dept_id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'金庸'</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token string">'总裁'</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">,</span> <span class="token string">'2000-01-01'</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'张无忌'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'项目经理'</span><span class="token punctuation">,</span> <span class="token number">12500</span><span class="token punctuation">,</span> <span class="token string">'2005-12-05'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'杨逍'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token string">'开发'</span><span class="token punctuation">,</span> <span class="token number">8400</span><span class="token punctuation">,</span> <span class="token string">'2000-11-03'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'韦一笑'</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token string">'开发'</span><span class="token punctuation">,</span> <span class="token number">11000</span><span class="token punctuation">,</span> <span class="token string">'2002-02-05'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'常遇春'</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token string">'开发'</span><span class="token punctuation">,</span> <span class="token number">10500</span><span class="token punctuation">,</span> <span class="token string">'2004-09-07'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'小昭'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'程序员鼓励师'</span><span class="token punctuation">,</span> <span class="token number">6600</span><span class="token punctuation">,</span> <span class="token string">'2004-10-12'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'灭绝'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token string">'财务总监'</span><span class="token punctuation">,</span> <span class="token number">8500</span><span class="token punctuation">,</span> <span class="token string">'2002-09-12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'周芷若'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'会计'</span><span class="token punctuation">,</span> <span class="token number">48000</span><span class="token punctuation">,</span> <span class="token string">'2006-06-02'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'丁敏君'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'出纳'</span><span class="token punctuation">,</span> <span class="token number">5250</span><span class="token punctuation">,</span> <span class="token string">'2009-05-13'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'赵敏'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'市场部总监'</span><span class="token punctuation">,</span> <span class="token number">12500</span><span class="token punctuation">,</span> <span class="token string">'2004-10-12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token string">'鹿杖客'</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token string">'职员'</span><span class="token punctuation">,</span> <span class="token number">3750</span><span class="token punctuation">,</span> <span class="token string">'2006-10-03'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">'鹤笔翁'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'职员'</span><span class="token punctuation">,</span> <span class="token number">3750</span><span class="token punctuation">,</span> <span class="token string">'2007-05-09'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token string">'方东白'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'职员'</span><span class="token punctuation">,</span> <span class="token number">5500</span><span class="token punctuation">,</span> <span class="token string">'2009-02-12'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">'张三丰'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token string">'销售总监'</span><span class="token punctuation">,</span> <span class="token number">14000</span><span class="token punctuation">,</span> <span class="token string">'2004-10-12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">'俞莲舟'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token string">'销售'</span><span class="token punctuation">,</span> <span class="token number">4600</span><span class="token punctuation">,</span> <span class="token string">'2004-10-12'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">'宋远桥'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">'销售'</span><span class="token punctuation">,</span> <span class="token number">4600</span><span class="token punctuation">,</span> <span class="token string">'2004-10-12'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token string">'陈友谅'</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token string">'2011-10-12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>表之间的对应关系如下：<br> <img src="https://images2.imgbox.com/05/29/QMc3YxhU_o.png" alt=""></p> 
<h3><a id="_165"></a>概述</h3> 
<blockquote> 
 <p>多表查询就是指从多张表中查询数据。</p> 
</blockquote> 
<p>原来查询单表数据，执行的SQL形式为：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">;</span>
</code></pre> 
<p>那么我们要执行多表查询，就只需要使用逗号分隔多张表即可，如：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     dept<span class="token punctuation">;</span>
</code></pre> 
<p>具体的执行结果如下:<br> <img src="https://images2.imgbox.com/6b/f6/WPbFTiBh_o.png" alt=""></p> 
<p>此时,我们看到查询结果中包含了大量的结果集，总共102条记录，而这其实就是员工表emp所有的记录(17条) 与 部门表dept所有记录(6条) 的所有组合情况，这种现象称之为<a href="https://www.bing.com/search?q=%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF" rel="nofollow">笛卡尔积</a>。<br> 可以通过查询时，加上连接条件来消除无效的笛卡尔积。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp<span class="token punctuation">,</span>
     dept
<span class="token keyword">where</span> emp<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> dept<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/77/8ypOm7un_o.png" alt=""><br> 而由于id为17的员工，没有dept_id字段值，所以在多表查询时，根据连接查询的条件并没有查询到。</p> 
<h3><a id="_197"></a>分类</h3> 
<ul><li>连接查询 
  <ul><li>内连接：相当于查询A、B交集部分数据</li><li>外连接： 
    <ul><li>左外连接：查询左表所有数据，以及两张表交集部分数据</li><li>右外连接：查询右表所有数据，以及两张表交集部分数据</li></ul> </li><li>自连接：当前表与自身的连接查询，自连接必须使用表别名</li></ul> </li><li>子查询</li></ul> 
<h2><a id="_205"></a>内连接</h2> 
<blockquote> 
 <p>内连接查询的是两张表交集部分的数据。</p> 
</blockquote> 
<p>内连接的语法分为两种: 隐式内连接、显式内连接。</p> 
<p>隐式内连接</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token punctuation">,</span> 表<span class="token number">2</span> <span class="token keyword">WHERE</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre> 
<p>显式内连接</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token punctuation">[</span> <span class="token keyword">INNER</span> <span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 连接条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_220"></a>案例</h3> 
<p>A. 查询每一个员工的姓名 , 及关联的部门的名称 (隐式内连接实现)<br> 表结构: <code>emp</code> , <code>dept</code><br> 连接条件: <code>emp.dept_id = dept.id</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> dept d<span class="token punctuation">,</span>
     emp e
<span class="token keyword">where</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>
</code></pre> 
<p>B. 查询每一个员工的姓名 , 及关联的部门的名称 (显式内连接实现) — INNER JOIN … ON …<br> 表结构: <code>emp</code> , <code>dept</code><br> 连接条件: <code>emp.dept_id = dept.id</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> dept d
         <span class="token keyword">inner</span> <span class="token keyword">join</span>
     emp e
     <span class="token keyword">on</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>
</code></pre> 
<p><strong>注意</strong>：一旦为表起了别名，就不能再使用表名来指定对应的字段了，此时只能够使用别名来指定字段。</p> 
<h2><a id="_245"></a>外连接</h2> 
<p>外连接分为两种，分别是：左外连接 和 右外连接。</p> 
<h3><a id="_248"></a>左外连接</h3> 
<p>具体的语法结构为：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token keyword">LEFT</span> <span class="token punctuation">[</span> <span class="token keyword">OUTER</span> <span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre> 
<p>左外连接相当于查询表1(左表)的所有数据，当然也包含表1和表2交集部分的数据。</p> 
<h3><a id="_254"></a>右外连接</h3> 
<p>具体的语法结构为：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token keyword">RIGHT</span> <span class="token punctuation">[</span> <span class="token keyword">OUTER</span> <span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre> 
<p>右外连接相当于查询表2(右表)的所有数据，当然也包含表1和表2交集部分的数据。</p> 
<h3><a id="_262"></a>案例</h3> 
<p>A. 查询emp表的所有数据, 和对应的部门信息<br> 由于需求中提到，要查询emp的所有数据，所以是不能内连接查询的，需要考虑使用外连接查询。<br> 表结构: <code>emp</code> , <code>dept</code><br> 连接条件: <code>emp.dept_id = dept.id</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp e
         <span class="token keyword">left</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/f4/qhvIRmZ3_o.png" alt=""></p> 
<p>B. 查询dept表的所有数据, 和对应的员工信息(右外连接)<br> 由于需求中提到，要查询dept表的所有数据，所以是不能内连接查询的，需要考虑使用外连接查询。<br> 表结构: <code>emp</code> , <code>dept</code><br> 连接条件: <code>emp.dept_id = dept.id</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">from</span> emp e
         <span class="token keyword">right</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/86/51/IaVvo19O_o.png" alt=""><br> <strong>注意</strong>：左外连接和右外连接是可以相互替换的，只需要调整在连接查询时SQL中，表结构的先后顺<br> 序就可以了。在日常开发使用时，更偏向于左外连接。</p> 
<h2><a id="_288"></a>自连接</h2> 
<h3><a id="_289"></a>自连接查询</h3> 
<p>自连接查询，顾名思义，就是自己连接自己，也就是把一张表连接查询多次。<br> 自连接的查询语法：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表A 别名A <span class="token keyword">JOIN</span> 表A 别名B <span class="token keyword">ON</span> 条件 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">;</span>
</code></pre> 
<p>而对于自连接查询，可以是内连接查询，也可以是外连接查询。</p> 
<p>案例：<br> A. 查询员工 及其 所属领导的名字<br> 表结构: <code>emp</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp a
         <span class="token keyword">inner</span> <span class="token keyword">join</span> emp b <span class="token keyword">on</span> a<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ac/e6/QU8OXmyq_o.png" alt=""></p> 
<p>B. 查询所有员工 及其领导的名字 , 如果员工没有领导, 也需要查询出来<br> 表结构: <code>emp a</code> , <code>emp b</code></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> a<span class="token punctuation">.</span>name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp a
         <span class="token keyword">left</span> <span class="token keyword">join</span> emp b <span class="token keyword">on</span> a<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fc/86/NmYK9LmE_o.png" alt=""><br> <strong>注意</strong>:在自连接查询中，必须要为表起别名，要不然我们不清楚所指定的条件、返回的字段，到底是哪一张表的字段。</p> 
<h3><a id="_320"></a>联合查询</h3> 
<blockquote> 
 <p>对于union查询，就是把多次查询的结果合并起来，形成一个新的查询结果集。</p> 
</blockquote> 
<p>基本语法结构：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表A <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">UNION</span> <span class="token punctuation">[</span> <span class="token keyword">ALL</span> <span class="token punctuation">]</span>
<span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表B <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre> 
<p>对于联合查询的多张表的列数必须保持一致，字段类型也需要保持一致。<br> <code>union all</code>会将全部的数据直接合并在一起，<code>union</code>会对合并之后的数据去重。</p> 
<h4><a id="_333"></a>案例</h4> 
<p>A. 将薪资低于 5000 的员工 , 和 年龄大于 50 岁的员工全部查询出来.<br> 当前对于这个需求，我们可以直接使用多条件查询，使用逻辑运算符 <code>or</code> 连接即可。 那这里呢，也可以通过 <code>union all</code> / <code>union</code> 来联合查询.</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> salary <span class="token operator">&lt;</span> <span class="token number">5000</span>
<span class="token keyword">union</span> <span class="token keyword">all</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> age <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>union all</code> 查询出来的结果，仅仅进行简单的合并，并未去重。<br> <img src="https://images2.imgbox.com/cc/aa/SLtFLmpD_o.png" alt=""></p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> salary <span class="token operator">&lt;</span> <span class="token number">5000</span>
<span class="token keyword">union</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> age <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>union</code> 联合查询，会对查询出来的结果进行去重处理。<br> <img src="https://images2.imgbox.com/0d/ad/sDWApQJG_o.png" alt=""><br> <strong>注意</strong>：如果多条查询语句查询出来的结果，字段数量不一致，在进行 <code>union all</code> / <code>union</code> 联合查询时，将会报错<code>[21000][1222] The used SELECT statements have a different number of columns</code>。如：<br> <img src="https://images2.imgbox.com/59/70/t4TaY7is_o.png" alt=""></p> 
<h2><a id="_362"></a>子查询</h2> 
<h3><a id="_363"></a>概述</h3> 
<h4><a id="_364"></a>概念</h4> 
<blockquote> 
 <p>SQL语句中嵌套SELECT语句，称为嵌套查询，又称子查询。</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t1 <span class="token keyword">WHERE</span> column1 <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> column1 <span class="token keyword">FROM</span> t2 <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>子查询外部的语句可以是<code>INSERT</code> / <code>UPDATE</code> / <code>DELETE</code> / <code>SELECT</code> 的任何一个。</p> 
<h4><a id="_372"></a>分类</h4> 
<p>根据子查询<strong>结果</strong>不同，分为：</p> 
<ul><li>标量子查询（子查询结果为单个值）</li><li>列子查询(子查询结果为一列)</li><li>行子查询(子查询结果为一行)</li><li>表子查询(子查询结果为多行多列)</li></ul> 
<p>根据子查询<strong>位置</strong>，分为：</p> 
<ul><li>WHERE之后</li><li>FROM之后</li><li>SELECT之后</li></ul> 
<h3><a id="_386"></a>标量子查询</h3> 
<blockquote> 
 <p>子查询返回的结果是单个值（数字、字符串、日期等），最简单的形式，这种子查询称为标量子查询。</p> 
</blockquote> 
<p>常用的操作符：<code>=</code> <code>&lt;&gt;</code> <code>&gt;</code> <code>&gt;=</code> <code>&lt;</code> <code>&lt;=</code></p> 
<h4><a id="_390"></a>案例</h4> 
<p>A. 查询 “销售部” 的所有员工信息<br> 完成这个需求时，我们可以将需求分解为两步：</p> 
<p>①. 查询 “销售部” 部门ID</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id
<span class="token keyword">from</span> dept
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'销售部'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/44/92/rul27e1P_o.png" alt=""></p> 
<p>②. 根据 “销售部” 部门ID, 查询员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id
                 <span class="token keyword">from</span> dept
                 <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'销售部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/5a/77/GNPR2xuf_o.png" alt=""><br> B. 查询在 “方东白” 入职之后的员工信息<br> 完成这个需求时，我们可以将需求分解为两步：</p> 
<p>①. 查询 方东白 的入职日期</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> entry_date
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'方东白'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/50/04/DqOjbNib_o.png" alt=""><br> ②. 查询指定入职日期之后入职的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> entry_date <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> entry_date
                    <span class="token keyword">from</span> emp
                    <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'方东白'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/93/45/y53KpVu5_o.png" alt=""></p> 
<h3><a id="_435"></a>列子查询</h3> 
<blockquote> 
 <p>子查询返回的结果是一列（可以是多行），这种子查询称为列子查询。</p> 
</blockquote> 
<p>常用的操作符：<code>IN</code> 、<code>NOT IN</code> 、 <code>ANY</code> 、<code>SOME</code> 、 <code>ALL</code></p> 
<table><thead><tr><th>操作符</th><th>描述</th></tr></thead><tbody><tr><td>IN</td><td>在指定的集合范围之内，多选一</td></tr><tr><td>NOT IN</td><td>不在指定的集合范围之内</td></tr><tr><td>ANY</td><td>子查询返回列表中，有任意一个满足即可</td></tr><tr><td>SOME</td><td>与ANY等同，使用SOME的地方都可以使用ANY</td></tr><tr><td>ALL</td><td>子查询返回列表的所有值都必须满足</td></tr></tbody></table> 
<h4><a id="_448"></a>案例</h4> 
<p>A. 查询 “销售部” 和 “市场部” 的所有员工信息<br> 分解为以下两步:</p> 
<p>①. 查询 “销售部” 和 “市场部” 的部门ID</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id
<span class="token keyword">from</span> dept
<span class="token keyword">where</span> name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'销售部'</span><span class="token punctuation">,</span> <span class="token string">'市场部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1f/ba/HXLfU7jp_o.png" alt=""><br> ②. 根据部门ID, 查询员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> dept_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id
             <span class="token keyword">from</span> dept
             <span class="token keyword">where</span> name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'销售部'</span><span class="token punctuation">,</span> <span class="token string">'市场部'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/42/df/AagftS3D_o.png" alt=""></p> 
<p>B. 查询比 财务部 所有人工资都高的员工信息<br> 分解为以下三步:</p> 
<p>①. 查询所有 财务部 的部门ID</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id
<span class="token keyword">from</span> dept
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'财务部'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f8/d0/uiXgKRiH_o.png" alt=""></p> 
<p>②. 查询所有 财务部 人员工资</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> salary
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id
            <span class="token keyword">from</span> dept
            <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'财务部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/50/aZb3X86A_o.png" alt=""></p> 
<p>③. 比 财务部 所有人工资都高的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token keyword">all</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary
                    <span class="token keyword">from</span> emp
                    <span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id
                                     <span class="token keyword">from</span> dept
                                     <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'财务部'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a5/23/TzTFvuUi_o.png" alt=""></p> 
<p>C. 查询比研发部其中任意一人工资高的员工信息<br> 分解为以下三步:</p> 
<p>①. 查询 研发部 部门ID</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> id
<span class="token keyword">from</span> dept
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'研发部'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/5d/JfP1wMTi_o.png" alt=""></p> 
<p>②. 查询 研发部 所有人工资</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> salary
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id
                 <span class="token keyword">from</span> dept
                 <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'研发部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/b5/7D5Nv20M_o.png" alt=""></p> 
<p>③. 比 研发部 其中任意一人工资高的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token keyword">any</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary
                    <span class="token keyword">from</span> emp
                    <span class="token keyword">where</span> dept_id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> id
                                     <span class="token keyword">from</span> dept
                                     <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'研发部'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/06/FTlcCm4Q_o.png" alt=""></p> 
<h3><a id="_543"></a>行子查询</h3> 
<blockquote> 
 <p>子查询返回的结果是一行（可以是多列），这种子查询称为行子查询。</p> 
</blockquote> 
<p>常用的操作符：<code>=</code> 、<code>&lt;&gt;</code> 、<code>IN</code> 、<code>NOT IN</code></p> 
<h4><a id="_548"></a>案例</h4> 
<p>查询与 “张无忌” 的薪资及直属领导相同的员工信息 ;<br> 这个需求同样可以拆解为两步进行:</p> 
<p>①. 查询 “张无忌” 的薪资及直属领导</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> salary<span class="token punctuation">,</span> manager_id
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张无忌'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ee/6d/gsEGxlZQ_o.png" alt=""><br> ②. 查询与 “张无忌” 的薪资及直属领导相同的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> <span class="token punctuation">(</span>salary<span class="token punctuation">,</span> manager_id<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary<span class="token punctuation">,</span> manager_id
                              <span class="token keyword">from</span> emp
                              <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张无忌'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6f/82/g2YmKRKy_o.png" alt=""></p> 
<h3><a id="_570"></a>表子查询</h3> 
<blockquote> 
 <p>子查询返回的结果是多行多列，这种子查询称为表子查询。</p> 
</blockquote> 
<p>常用的操作符：<code>IN</code></p> 
<h4><a id="_574"></a>案例</h4> 
<p>A. 查询与 “鹿杖客” , “宋远桥” 的职位和薪资相同的员工信息<br> 分解为两步执行:</p> 
<p>①. 查询 “鹿杖客” , “宋远桥” 的职位和薪资</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> job<span class="token punctuation">,</span> salary
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'鹿杖客'</span><span class="token punctuation">,</span> <span class="token string">'宋远桥'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/eb/e9/7K5z3F3R_o.png" alt=""></p> 
<p>②. 查询与 “鹿杖客” , “宋远桥” 的职位和薪资相同的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> <span class="token punctuation">(</span>job<span class="token punctuation">,</span> salary<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job<span class="token punctuation">,</span> salary
                        <span class="token keyword">from</span> emp
                        <span class="token keyword">where</span> name <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'鹿杖客'</span><span class="token punctuation">,</span> <span class="token string">'宋远桥'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/08/a2/jR5tF6VN_o.png" alt=""><br> B. 查询入职日期是 “2006-01-01” 之后的员工信息 , 及其部门信息<br> 分解为两步执行:</p> 
<p>①. 入职日期是 “2006-01-01” 之后的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> entry_date <span class="token operator">&gt;</span> <span class="token string">'2006-01-01'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/73/5e/8zBg7qRz_o.png" alt=""><br> ②. 查询这部分员工, 对应的部门信息;</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span>
      <span class="token keyword">from</span> emp
      <span class="token keyword">where</span> entry_date <span class="token operator">&gt;</span> <span class="token string">'2006-01-01'</span><span class="token punctuation">)</span> e
         <span class="token keyword">left</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/51/MB6cy970_o.png" alt=""></p> 
<h2><a id="_618"></a>多表查询案例</h2> 
<p>准备员工、部门以及薪资等级这三张数据表，其中<a href="#jump1" rel="nofollow">两张表</a>在上面已经创建过来，这里不赘述。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建薪资等级表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> salary_grade
<span class="token punctuation">(</span>
    grade       <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'薪资等级'</span><span class="token punctuation">,</span>
    low_salary  <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'该等级最低薪资'</span><span class="token punctuation">,</span>
    high_salary <span class="token keyword">int</span> <span class="token keyword">comment</span> <span class="token string">'该等级最高薪资'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'薪资等级表'</span><span class="token punctuation">;</span>
    
<span class="token comment">-- 添加数据</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3001</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5001</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">8001</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">,</span> <span class="token number">15000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15001</span><span class="token punctuation">,</span> <span class="token number">20000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20001</span><span class="token punctuation">,</span> <span class="token number">25000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> salary_grade
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">25001</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p>准备学生、课程学生选课这三张表。</p> 
<pre><code class="prism language-sql"><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> student_course<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> student<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> course<span class="token punctuation">;</span>


<span class="token keyword">create</span> <span class="token keyword">table</span> student
<span class="token punctuation">(</span>
    id   <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
    <span class="token keyword">no</span>   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学号'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学生表'</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> student
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'黛绮丝'</span><span class="token punctuation">,</span> <span class="token string">'2000100101'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'谢逊'</span><span class="token punctuation">,</span><span class="token string">'2000100102'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'殷天正'</span><span class="token punctuation">,</span> <span class="token string">'2000100103'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'韦一笑'</span><span class="token punctuation">,</span> <span class="token string">'2000100104'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
<span class="token keyword">create</span> <span class="token keyword">table</span> course
<span class="token punctuation">(</span>
    id   <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">comment</span> <span class="token string">'主键ID'</span><span class="token punctuation">,</span>
    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'课程名称'</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'课程表'</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> course
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'Java'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'PHP'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'MySQL'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'Hadoop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
<span class="token keyword">create</span> <span class="token keyword">table</span> student_course
<span class="token punctuation">(</span>
    id         <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">comment</span> <span class="token string">'主键'</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    student_id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'学生ID'</span><span class="token punctuation">,</span>
    course_id  <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">comment</span> <span class="token string">'课程ID'</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_courseId <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>course_id<span class="token punctuation">)</span> <span class="token keyword">references</span> course <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> fk_studentId <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">)</span> <span class="token keyword">references</span> student <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">'学生课程中间表'</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> student_course
<span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p>1). 查询员工的姓名、年龄、职位、部门信息 （隐式内连接）</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>age<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp e<span class="token punctuation">,</span>
     dept d
<span class="token keyword">where</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/52/ca/AqstPb5X_o.png" alt=""></p> 
<p>2). 查询年龄小于30岁的员工的姓名、年龄、职位、部门信息（显式内连接）</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>age<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp e
         <span class="token keyword">inner</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>age <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b7/13/vtvSrnjr_o.png" alt=""></p> 
<p>3). 查询拥有员工的部门ID、部门名称</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> d<span class="token punctuation">.</span>id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp e
         <span class="token keyword">inner</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>dept_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/48/bd/MEXumYJZ_o.png" alt=""></p> 
<p>4). 查询所有年龄大于40岁的员工, 及其归属的部门名称; 如果员工没有分配部门, 也需要展示出来(外连接)</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>name
<span class="token keyword">from</span> emp e
         <span class="token keyword">left</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> d<span class="token punctuation">.</span>id <span class="token operator">=</span> e<span class="token punctuation">.</span>dept_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>age <span class="token operator">&gt;</span> <span class="token number">40</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7a/dd/Sa79OVbY_o.png" alt=""></p> 
<p>5). 查询所有员工的工资等级</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> sg<span class="token punctuation">.</span>grade
<span class="token keyword">from</span> emp e
         <span class="token keyword">inner</span> <span class="token keyword">join</span> salary_grade sg <span class="token keyword">on</span> e<span class="token punctuation">.</span>salary <span class="token operator">between</span> sg<span class="token punctuation">.</span>low_salary <span class="token operator">and</span> sg<span class="token punctuation">.</span>high_salary<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a7/2b/wuRaSW7g_o.png" alt=""></p> 
<p>6). 查询 “研发部” 所有员工的信息及 工资等级</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> e<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> sg<span class="token punctuation">.</span>grade
<span class="token keyword">from</span> emp e
         <span class="token keyword">inner</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id
         <span class="token keyword">inner</span> <span class="token keyword">join</span> salary_grade sg <span class="token keyword">on</span> e<span class="token punctuation">.</span>salary <span class="token operator">between</span> sg<span class="token punctuation">.</span>low_salary <span class="token operator">and</span> sg<span class="token punctuation">.</span>high_salary
<span class="token keyword">where</span> d<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'研发部'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9c/00/ZpgxYqnI_o.png" alt=""></p> 
<p>7). 查询 “研发部” 员工的平均工资</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> emp e
         <span class="token keyword">inner</span> <span class="token keyword">join</span> dept d <span class="token keyword">on</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id
<span class="token keyword">where</span> d<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'研发部'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8a/cd/eCl5KZtU_o.png" alt=""></p> 
<p>8). 查询工资比 “灭绝” 高的员工信息。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> salary
                <span class="token keyword">from</span> emp
                <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'灭绝'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/2e/ef/0zqJ71ty_o.png" alt=""><br> 9). 查询比平均薪资高的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp
<span class="token keyword">where</span> salary <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
                <span class="token keyword">from</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ff/2e/SCgMVOcv_o.png" alt=""></p> 
<p>10). 查询低于本部门平均工资的员工信息</p> 
<p>①. 查询指定部门平均薪资</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> emp e1
<span class="token keyword">where</span> e1<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/1d/cWLQqWIT_o.png" alt=""></p> 
<p>②. 查询低于本部门平均工资的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> emp e2
<span class="token keyword">where</span> e2<span class="token punctuation">.</span>salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
                   <span class="token keyword">from</span> emp e1
                   <span class="token keyword">where</span> e1<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> e2<span class="token punctuation">.</span>dept_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/52/I3fgSeKA_o.png" alt=""><br> 为了验证结果是否正确，平均薪资也展示出来。</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
        <span class="token keyword">from</span> emp e1
        <span class="token keyword">where</span> e1<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> e2<span class="token punctuation">.</span>dept_id<span class="token punctuation">)</span> <span class="token string">'平均薪资'</span>
<span class="token keyword">from</span> emp e2
<span class="token keyword">where</span> e2<span class="token punctuation">.</span>salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>e1<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
                   <span class="token keyword">from</span> emp e1
                   <span class="token keyword">where</span> e1<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> e2<span class="token punctuation">.</span>dept_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/24/TgmVERzD_o.png" alt=""></p> 
<p>11). 查询所有的部门信息, 并统计部门的员工人数</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> d<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       d<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>dept_id<span class="token punctuation">)</span>
        <span class="token keyword">from</span> emp e
        <span class="token keyword">where</span> e<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token string">'人数'</span>
<span class="token keyword">from</span> dept d<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6a/2b/Xm7TJIrC_o.png" alt=""><br> 12). 查询所有学生的选课情况, 展示出学生名称, 学号, 课程名称</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token keyword">no</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>name
<span class="token keyword">from</span> student s
         <span class="token keyword">inner</span> <span class="token keyword">join</span> student_course sc <span class="token keyword">on</span> s<span class="token punctuation">.</span>id <span class="token operator">=</span> sc<span class="token punctuation">.</span>student_id
         <span class="token keyword">inner</span> <span class="token keyword">join</span> course c <span class="token keyword">on</span> sc<span class="token punctuation">.</span>course_id <span class="token operator">=</span> c<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7c/f7/G2cwjWk8_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/91b66c09d92191eca4ed0ce8900e0127/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">flutter的pubspec.yml中依赖版本号使用any和不使用版本号的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e76e6ed24416846355db31fa4f865395/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【DS】Java实现顺序表</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>