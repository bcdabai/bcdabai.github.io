<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ubuntu系统运行ORB_SLAM3报段错误（核心已转储） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ubuntu系统运行ORB_SLAM3报段错误（核心已转储）" />
<meta property="og:description" content="&lt;先看后面的重要提醒！！！！！！&gt;
运行单目&#43;IMU案例
1.第一个终端：
roscore 2.第二个终端：
在SLAM3工程文件夹下进入终端：
rosrun ORB_SLAM3 Mono_Inertial Vocabulary/ORBvoc.txt Examples_old/Monocular-Inertial/EuRoC.yaml true 查询原因说是cv_bridge对opencv指向问题，cv_bridge默认指向ros安装自带的opencv3.2.0，就会与自己安装的opencv产生冲突
**
cv_bridge与opencv指向解决方法： **
第一种：
修改ros安装路径中的cv_bridge相关文件的路径，指向自己安装的opencv sudo gedit /opt/ros/melodic/share/cv_bridge/cmake/cv_bridgeConfig.cmake 使用sudo apt install ros-melodic-desktop-full安装的ros，会默认安装opencv3.2.0版本到/usr/include，/usr/lib，/usr/share三个目录。
但是如果自己从opencv官网源码编译安装的，opencv会默认安装到usr/local下对应的三个子目录。
将路径改成自己安装opencv默认的对应的子目录。
sudo gedit /opt/ros/melodic/share/cv_bridge/cmake/cv_bridge-extras.cmake 将版本号改为自己安装的版本号
cd /opt/ros/melodic/lib/ sudo gedit pkgconfig/cv_bridge.pc 同样，将相关路径改成自己的
最后catkin_make项目即可。
但在实操中，还是警告了
发现还是关联到ros默认的安装版本，感觉应该是重新编译ros才生效，然后再重新catkin_make项目。
第二种：
下载cv_bridge包编译
下载网址：https://gitee.com/bingobinlw/cv_bridge mkdir -p cv_bridge_ws/src cd cv_bridge_ws/src git clone https://gitee.com/bingobinlw/cv_bridge //此链接适用于18.04 cd .. 将自己安装的opencv编译生成的build文件路径加入CMakeLists.txt
修改为
编译cv_bridge包：
catkin_make 最后，在所需要使用cv_bridge的ros包里的CMakeLists.txt文件中添加opencv路径以及cv_bridge路径
set(OpenCV_DIR &#34;your-path/opencv-x.x.x/build&#34;) set(cv_bridge_DIR your-path/cv_bridge_ws/devel/share/cv_bridge/cmake) 例如：此处修改SLAM3中ros包中slam3的CMakeLists.txt
删除之前编译产生的文件，重新编译项目。真是很糟糕，白忙活一场，这方法对我的还是不起效果，还是报如下错误。
第三种：
卸载ROS自动安装的cv_bridge，重新安装
1）卸载原版本cv_bridge sudo apt-get remove ros-melodic-cv-bridge 2）下载新版本cv_bridge" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/31c8303df8e0381579120e2fedd1cd3d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-11T16:35:53+08:00" />
<meta property="article:modified_time" content="2023-07-11T16:35:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ubuntu系统运行ORB_SLAM3报段错误（核心已转储）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>&lt;先看后面的重要提醒！！！！！！&gt;</strong><br> 运行单目+IMU案例</p> 
<p><strong>1.第一个终端</strong>：</p> 
<pre><code class="prism language-cpp">roscore
</code></pre> 
<p><strong>2.第二个终端</strong>：<br> 在SLAM3工程文件夹下进入终端：</p> 
<pre><code class="prism language-cpp">rosrun ORB_SLAM3 Mono_Inertial Vocabulary<span class="token operator">/</span>ORBvoc<span class="token punctuation">.</span>txt Examples_old<span class="token operator">/</span>Monocular<span class="token operator">-</span>Inertial<span class="token operator">/</span>EuRoC<span class="token punctuation">.</span>yaml <span class="token boolean">true</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7f/b1/qYDEmvOM_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/5f/5d/DSfwtKTG_o.png" alt="在这里插入图片描述"></p> 
<p>查询原因说是cv_bridge对opencv指向问题，cv_bridge默认指向ros安装自带的opencv3.2.0，就会与自己安装的opencv产生冲突</p> 
<p>**</p> 
<h3><a id="cv_bridgeopencv_23"></a>cv_bridge与opencv指向解决方法：</h3> 
<p>**</p> 
<ul><li><strong>第一种</strong>：<br> 修改ros安装路径中的cv_bridge相关文件的路径，指向自己安装的opencv</li></ul> 
<pre><code class="prism language-cpp">sudo gedit <span class="token operator">/</span>opt<span class="token operator">/</span>ros<span class="token operator">/</span>melodic<span class="token operator">/</span>share<span class="token operator">/</span>cv_bridge<span class="token operator">/</span>cmake<span class="token operator">/</span>cv_bridgeConfig<span class="token punctuation">.</span>cmake
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/d6/k74yBYSe_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/16/74/hGzm71wQ_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/c7/96/oGhw9Rt2_o.jpg" alt="在这里插入图片描述"></p> 
<p>使用sudo apt install ros-melodic-desktop-full安装的ros，会默认安装opencv3.2.0版本到/usr/include，/usr/lib，/usr/share三个目录。<br> 但是如果自己从opencv官网源码编译安装的，opencv会默认安装到usr/local下对应的三个子目录。</p> 
<p>将路径改成自己安装opencv默认的对应的子目录。</p> 
<pre><code class="prism language-cpp">sudo gedit <span class="token operator">/</span>opt<span class="token operator">/</span>ros<span class="token operator">/</span>melodic<span class="token operator">/</span>share<span class="token operator">/</span>cv_bridge<span class="token operator">/</span>cmake<span class="token operator">/</span>cv_bridge<span class="token operator">-</span>extras<span class="token punctuation">.</span>cmake
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/ce/I5xbamnU_o.jpg" alt="在这里插入图片描述"></p> 
<p>将版本号改为自己安装的版本号</p> 
<pre><code class="prism language-cpp">cd <span class="token operator">/</span>opt<span class="token operator">/</span>ros<span class="token operator">/</span>melodic<span class="token operator">/</span>lib<span class="token operator">/</span>
sudo gedit pkgconfig<span class="token operator">/</span>cv_bridge<span class="token punctuation">.</span>pc
</code></pre> 
<p><img src="https://images2.imgbox.com/3c/a3/qHoKMCIM_o.jpg" alt="在这里插入图片描述"></p> 
<p>同样，将相关路径改成自己的<br> 最后catkin_make项目即可。<br> 但在实操中，还是警告了<br> <img src="https://images2.imgbox.com/b9/98/rMtUxDOg_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/f6/e6/6FXk2OhS_o.jpg" alt="在这里插入图片描述"></p> 
<p>发现还是关联到ros默认的安装版本，感觉应该是重新编译ros才生效，然后再重新catkin_make项目。</p> 
<ul><li><strong>第二种</strong>：<br> 下载cv_bridge包编译<br> 下载网址：https://gitee.com/bingobinlw/cv_bridge</li></ul> 
<pre><code class="prism language-cpp">mkdir <span class="token operator">-</span>p cv_bridge_ws<span class="token operator">/</span>src
cd cv_bridge_ws<span class="token operator">/</span>src
git clone https<span class="token operator">:</span><span class="token comment">//gitee.com/bingobinlw/cv_bridge //此链接适用于18.04</span>
cd <span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/2c/GDqfkKa9_o.jpg" alt="在这里插入图片描述"></p> 
<p>将自己安装的opencv编译生成的build文件路径加入CMakeLists.txt<br> <img src="https://images2.imgbox.com/4d/b2/O9jdQnr0_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/1d/00/G1EmWRM0_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/5d/12/pJJGkngD_o.jpg" alt="在这里插入图片描述"></p> 
<p>修改为<br> <img src="https://images2.imgbox.com/63/80/YSJUZiMi_o.jpg" alt="在这里插入图片描述"></p> 
<p>编译cv_bridge包：</p> 
<pre><code class="prism language-cpp">catkin_make
</code></pre> 
<p>最后，在所需要使用cv_bridge的ros包里的CMakeLists.txt文件中添加opencv路径以及cv_bridge路径</p> 
<pre><code class="prism language-cpp"><span class="token function">set</span><span class="token punctuation">(</span>OpenCV_DIR <span class="token string">"your-path/opencv-x.x.x/build"</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>cv_bridge_DIR your<span class="token operator">-</span>path<span class="token operator">/</span>cv_bridge_ws<span class="token operator">/</span>devel<span class="token operator">/</span>share<span class="token operator">/</span>cv_bridge<span class="token operator">/</span>cmake<span class="token punctuation">)</span>
</code></pre> 
<p>例如：此处修改SLAM3中ros包中slam3的CMakeLists.txt<br> <img src="https://images2.imgbox.com/a5/f6/5YNgX8nJ_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/8c/a8/1CGdRDhq_o.jpg" alt="在这里插入图片描述"></p> 
<p>删除之前编译产生的文件，重新编译项目。真是很糟糕，白忙活一场，这方法对我的还是不起效果，还是报如下错误。<br> <img src="https://images2.imgbox.com/a7/46/2j85jLPc_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>第三种</strong>：<br> 卸载ROS自动安装的cv_bridge，重新安装<br> 1）卸载原版本cv_bridge</li></ul> 
<pre><code class="prism language-cpp">sudo apt<span class="token operator">-</span>get remove ros<span class="token operator">-</span>melodic<span class="token operator">-</span>cv<span class="token operator">-</span>bridge
</code></pre> 
<p>2）下载新版本cv_bridge<br> 网址：https://github.com/ros-perception/vision_opencv<br> 选择melodic对应的cv_bridge<br> 3）修改cv_bridge中的cmakelists.txt<br> <img src="https://images2.imgbox.com/c4/77/z1gr5ojU_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/87/e2/avT15xWa_o.jpg" alt="在这里插入图片描述"></p> 
<p>将find_package(OpenCV 3.4.5 REQUIRED中的版本号改成你安装的版本号<br> 4）cmake单独编译cv_bridge<br> 在cv_bridge文件夹下，进入终端</p> 
<pre><code class="prism language-cpp">mkdir build
cd build
cmake <span class="token punctuation">.</span><span class="token punctuation">.</span>
make
sudo make install
</code></pre> 
<p>5）在项目中需要的cmaklist.txt中添加cv_bridge的cmake路径</p> 
<pre><code class="prism language-cpp"><span class="token function">set</span><span class="token punctuation">(</span>cv_bridge_DIR <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>share<span class="token operator">/</span>cv_bridge<span class="token operator">/</span>cmake<span class="token punctuation">)</span>  <span class="token comment">//在find_package前面</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e0/92/rfgdOFWd_o.jpg" alt="在这里插入图片描述"></p> 
<p>我在以下三个CMakeLists.txt都添加了cv_bridge的cmake路：<br> /home/fei/ORB_SLAM3/CMakeLists.txt<br> /home/fei/ORB_SLAM3/Thirdparty/DBoW2/CMakeLists.txt<br> /home/fei/ORB_SLAM3/Examples_old/ROS/ORB_SLAM3/CMakeLists.txt<br> 6）重新编译ros版本的ORB_SLAM3<br> 编译时报错：</p> 
<pre><code class="prism language-cpp">– Configuring incomplete<span class="token punctuation">,</span> errors occurred<span class="token operator">!</span>
See also “<span class="token operator">/</span>home<span class="token operator">/</span>fei<span class="token operator">/</span>ORB_SLAM3<span class="token operator">/</span>Examples_old<span class="token operator">/</span>ROS<span class="token operator">/</span>ORB_SLAM3<span class="token operator">/</span>build<span class="token operator">/</span>CMakeFiles<span class="token operator">/</span>CMakeOutput<span class="token punctuation">.</span>log”<span class="token punctuation">.</span>
</code></pre> 
<p>make: *** 没有指明目标并且找不到 makefile。 停止.<br> 首先，我在.bashrc文件添加了该ROS项目的路径，所以不是该原因造成的。<br> 应该是删除了ROS自安装的cv_bridge，而在编译时，系统还是自动从ROS路径查找，所以，将自己的安装的cv_bridge包复制粘贴到ROS的安装对应路径下。<br> 根目录无法复制文件夹，所以终端输入：</p> 
<pre><code class="prism language-cpp">sudo nautilus
</code></pre> 
<p>在弹出的文件界面将/usr/local/share/中的cv_bridge<br> <img src="https://images2.imgbox.com/af/b6/K1ER4kAH_o.jpg" alt="在这里插入图片描述"></p> 
<p>复制到/opt/ros/melodic/share中<br> <img src="https://images2.imgbox.com/61/de/R6McPIyT_o.jpg" alt="在这里插入图片描述"></p> 
<p>删除刚编译产生的文件，再次编译：</p> 
<pre><code class="prism language-cpp">chmod <span class="token operator">+</span>x <span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
<span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
</code></pre> 
<p>没有再报版本冲突警告<br> 继续前面的案例运行到第二个终端：<br> <img src="https://images2.imgbox.com/2f/b5/571w3uh6_o.jpg" alt="在这里插入图片描述"></p> 
<p>测试其他项目是否正常<br> 测试ORB_SLAM2：<br> 第一个终端：<code>roscore</code><br> 第二个终端：<code>roslaunch usb_cam usb_cam-test.launch</code><br> <img src="https://images2.imgbox.com/63/56/CXPUrIJ7_o.jpg" alt="在这里插入图片描述"></p> 
<p>果然报错，解决方案依次运行以下指令：</p> 
<pre><code class="prism language-cpp">sudo apt<span class="token operator">-</span>get install ros<span class="token operator">-</span>melodic<span class="token operator">-</span>usb<span class="token operator">-</span>cam
sudo apt<span class="token operator">-</span>get install ros<span class="token operator">-</span>melodic<span class="token operator">-</span>camera<span class="token operator">-</span>calibration
sudo apt<span class="token operator">-</span>get install ros<span class="token operator">-</span>melodic<span class="token operator">-</span>image<span class="token operator">-</span>view
</code></pre> 
<p>第三个终端：</p> 
<pre><code class="prism language-cpp">rosrun ORB_SLAM2 Mono <span class="token operator">/</span>home<span class="token operator">/</span>fei<span class="token operator">/</span>ORB_SLAM2<span class="token operator">/</span>Vocabulary<span class="token operator">/</span>ORBvoc<span class="token punctuation">.</span>txt <span class="token operator">/</span>home<span class="token operator">/</span>fei<span class="token operator">/</span>ORB_SLAM2<span class="token operator">/</span>ost<span class="token punctuation">.</span>yaml
</code></pre> 
<p>结果正常。<br> 测试VINs_Mono：结果也正常<br> 但是我返回来测试ORB_SLAM3时又不行了，又是冲突，核心已转储。原因是为解决相机问题安装的三个包，又再一次装回了原来的cv_bridge。</p> 
<ul><li><strong>第四种</strong>：<br> 前言：不用卸载ros自安装的cv_bridge，按照上述第三种中cv_bridge安装方法编译，或者这里可以参考下面的安装方法，两种方法随便一种都可以。<br> 另一种cv_bridge安装编译方法：<br> (1)下载安装包<br> 网址：https://github.com/ros-perception/vision_opencv<br> ​<img src="https://images2.imgbox.com/ae/a3/3BojGlmG_o.jpg" alt="在这里插入图片描述"></li></ul> 
<p>选择对应ros版本的vision_opencv</p> 
<p>(2)修改cv_bridge的CMakeLists.txt<br> <img src="https://images2.imgbox.com/f0/72/vTbc8gIy_o.jpg" alt="在这里插入图片描述"></p> 
<p>在vision_opencv/cv_bridge中打开CMakeLists.txt，将其中的opencv版本改成自己安装的版本<br> <img src="https://images2.imgbox.com/97/7f/hGtFwXTM_o.jpg" alt="在这里插入图片描述"></p> 
<p>(3)编译<br> 在cv_bridge文件夹下进入终端：</p> 
<pre><code class="prism language-cpp">mkdir build
cd build
cmake <span class="token punctuation">.</span><span class="token punctuation">.</span>
make
sudo make install
</code></pre> 
<p>(4)覆盖ros默认安装的libcv_bridge.so<br> 终端输入<code>sudo nautilus</code><br> <img src="https://images2.imgbox.com/24/04/Slb1DHj8_o.jpg" alt="在这里插入图片描述"></p> 
<p>将我们刚安装的cv_bridge中产生的libcv_bridge.so复制，粘贴到ros该lib的路径中，覆盖原来的libcv_bridge.so<br> <img src="https://images2.imgbox.com/4a/37/JaBC9xvI_o.jpg" alt="在这里插入图片描述"></p> 
<p>该方法是在各种尝试后，又返回警告，仔细观察：<br> <em>usr/bin/ld: warning: libopencv_core.so.3.2, needed by /opt/ros/melodic/lib/libcv_bridge.so,may conflict with libopencv_core.so.3.4<br> usr/bin/ld: warning: libopencv_imgproc.so.3.2, needed by /opt/ros/melodic/lib/libcv_bridge.so, may conflict with libopencv_imgproc.so.3.4<br> usr/bin/ld: warning: libopencv_core.so.3.2, needed by /opt/ros/melodic/lib/libcv_bridge.so,may conflict with libopencv_core.so.3.4</em><br> 把需要的这几个libopencv_core.so.3.4、libopencv_imgproc.so.3.4、libopencv_imgproc.so.3.4放入跟3.2一样的路径中，再把第一种方法中的cv_bridgeConfig.cmake文件只修改set_libraries中的版本号，重新编译slam3项目还是报一样的错误。随后根据/opt/ros/melodic/lib/libcv_bridge.so，将其覆盖成自己安装的libcv_bridge.so，重新编译slam3通过了。</p> 
<p>（5）测试<br> 重新编译slam3 ros版本</p> 
<pre><code class="prism language-cpp">chmod <span class="token operator">+</span>x <span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
<span class="token punctuation">.</span><span class="token operator">/</span>build_ros<span class="token punctuation">.</span>sh
</code></pre> 
<p><img src="https://images2.imgbox.com/be/76/QI5Ze9w2_o.jpg" alt="在这里插入图片描述"></p> 
<p>没有警告，运行带imu的也没有报核心已转储。<br> 测试ORB_SLAM2和VINs_Mono也没有任何问题。</p> 
<p><em><strong>重要提醒：</strong></em><br> 不是前三种对我不行，而是项目的CMakeLists.txt中引用ROS的方式不一样。<br> 1）如果是：<br> <img src="https://images2.imgbox.com/1f/43/WvafDGY0_o.jpg" alt="在这里插入图片描述"></p> 
<p>则使用第四种方法有效</p> 
<p>2）如果是：<br> <img src="https://images2.imgbox.com/2f/4d/pLr7tfRj_o.jpg" alt="在这里插入图片描述"></p> 
<p>则前三种都有效</p> 
<p><strong>3.第三个终端</strong>:<br> 在有目标数据包文件夹下进入终端：</p> 
<pre><code class="prism language-cpp">rosbag play MH_01_easy<span class="token punctuation">.</span>bag <span class="token operator">/</span>cam0<span class="token operator">/</span>image_raw<span class="token operator">:</span><span class="token operator">=</span><span class="token operator">/</span>camera<span class="token operator">/</span>image_raw <span class="token operator">/</span>imu0<span class="token operator">:</span><span class="token operator">=</span><span class="token operator">/</span>imu
</code></pre> 
<p><img src="https://images2.imgbox.com/3a/3e/0JepjzBX_o.jpg" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/bb/58/bnHE8AB8_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6aba372745a72626b115720b20a3d889/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用docker 部署k8s集群</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4a19f83227dd41f748fee3a097f3e540/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">动态给img的src属性赋值&amp;Vue中通过document的getElementById()获取为空&amp;Vue输入框中使用v-model导致number类型值自动转换成string</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>