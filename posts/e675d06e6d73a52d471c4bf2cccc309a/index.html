<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Win10安装Linux子系统WSL(ubuntu2204)及图形桌面xfce4 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Win10安装Linux子系统WSL(ubuntu2204)及图形桌面xfce4" />
<meta property="og:description" content="WSL简介 什么是 WSL ？ 在计算机上使用 Linux 系统通常有两种方式：使用虚拟机或安装 Linux 系统。使用虚拟机时开销较大，直接使用 Linux 系统虽然可以带来流畅体验，但与 Windows 之间来回切换比较麻烦。为此，微软开发了适用于 Linux 的 Windows 子系统，简称 WSL。
WSL 可以让开发人员可以在 Windows 计算机上同时访问 Windows 和 Linux 系统。 通过WSL开发人员可以安装 Linux 发行版（例如 Ubuntu、OpenSUSE、Kali、Debian、Arch Linux 等），并直接在 Windows 上使用 Linux 应用程序、实用程序和 Bash 命令行工具，不用进行任何修改，也无需承担传统虚拟机或双启动设置的开销。
WSL 1 与 WSL 2 WSL 1 和 WSL 2 之间的主要区别在于，在托管 VM 内使用实际的 Linux 内核、支持完整的系统调用兼容性以及跨 Linux 和 Windows 操作系统的性能。 从上表中可以看出，WSL 2 架构在几个方面优于 WSL 1，但跨 OS 文件系统的性能除外，对于这种情况，可通过将项目文件存储在与处理项目时运行的工具相同的操作系统上进行处理。
WSL 2 仅在 Windows 11 或 Windows 10 版本 1903、内部版本 18362 或更高版本中可用。 通过按 Windows 徽标键 &#43; R，检查你的 Windows 版本，然后键入 winver，选择“确定”。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e675d06e6d73a52d471c4bf2cccc309a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-21T20:52:39+08:00" />
<meta property="article:modified_time" content="2023-02-21T20:52:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Win10安装Linux子系统WSL(ubuntu2204)及图形桌面xfce4</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>WSL简介</h3> 
<h4>什么是 WSL ？</h4> 
<p>在计算机上使用 Linux 系统通常有两种方式：使用虚拟机或安装 Linux 系统。使用虚拟机时开销较大，直接使用 Linux 系统虽然可以带来流畅体验，但与 Windows 之间来回切换比较麻烦。为此，微软开发了适用于 Linux 的 Windows 子系统，简称 WSL。</p> 
<p>WSL 可以让开发人员可以在 Windows 计算机上同时访问 Windows 和 Linux 系统。 通过WSL开发人员可以安装 Linux 发行版（例如 Ubuntu、OpenSUSE、Kali、Debian、Arch Linux 等），并直接在 Windows 上使用 Linux 应用程序、实用程序和 Bash 命令行工具，不用进行任何修改，也无需承担传统虚拟机或双启动设置的开销。</p> 
<h4>WSL 1 与 WSL 2</h4> 
<p>WSL 1 和 WSL 2 之间的主要区别在于，在托管 VM 内使用实际的 Linux 内核、支持完整的系统调用兼容性以及跨 Linux 和 Windows 操作系统的性能。 </p> 
<p><img alt="" height="341" src="https://images2.imgbox.com/e7/1a/FU2qITPa_o.png" width="862"></p> 
<p>从上表中可以看出，WSL 2 架构在几个方面优于 WSL 1，但跨 OS 文件系统的性能除外，对于这种情况，可通过将项目文件存储在与处理项目时运行的工具相同的操作系统上进行处理。</p> 
<p>WSL 2 仅在 Windows 11 或 Windows 10 版本 1903、内部版本 18362 或更高版本中可用。 通过按 Windows 徽标键 + R，检查你的 Windows 版本，然后键入 <em><span style="color:#ff9900;"><strong>winver</strong></span></em>，选择“确定”。</p> 
<h3>安装 WSL</h3> 
<p>如果运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11 ，则可使用命令 <em><strong><span style="color:#ff9900;">wsl --install</span></strong></em>  安装运行 WSL 所需的一切内容，具体步骤参考 <a href="https://learn.microsoft.com/zh-cn/windows/wsl/install" rel="nofollow" title="安装 WSL | Microsoft Learn">安装 WSL | Microsoft Learn</a> 。此命令将启用运行 WSL 并安装 Linux 的 Ubuntu 发行版所需的功能，默认安装在C盘用户的Appdata目录中。下面介绍手动安装 WSL 以及 Linux 发行版的步骤。</p> 
<h4>开启 WSL1</h4> 
<p>需要先启用 “<em><strong>适用于 Linux 的 Windows 子系统</strong></em>“ 可选功能，才能在 Windows 上安装 Linux 分发版。在 <strong><em>设置 -&gt; 更新与安全-&gt;开发者选项</em></strong> 中开启 <em><strong>开发人员模式 </strong></em>，然后在 <strong><em>程序和功能 -&gt; 启用或关闭 Windows 功能 </em></strong>中勾选 <strong><em>适用于 Linux 的 Windows 子系统</em></strong> ，重启计算机。</p> 
<p><img alt="" height="608" src="https://images2.imgbox.com/0d/bc/nkKaLzE1_o.png" width="756">​</p> 
<p><strong>命令行方式：</strong>以管理员身份打开终端 PowerShell 然后输入以下命令：</p> 
<div> 
 <div> 
  <pre><code class="language-bash">dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart</code></pre> 
 </div> 
</div> 
<h4>升级到 WSL2</h4> 
<p>若要更新到 WSL 2，需要运行 Windows 10：</p> 
<ul><li>对于 x64 系统：版本 1903 或更高版本，内部版本为 18362 或更高版本。</li><li>对于 ARM64 系统：版本 2004 或更高版本，内部版本为 19041 或更高版本。</li></ul> 
<p>或 Windows 11。</p> 
<p>安装 WSL 2 之前，必须启用 ”<em><strong>虚拟机平台</strong>”</em> 可选功能。在 <strong><em>程序和功能 -&gt; 启用或关闭 Windows 功能 </em></strong>中勾选 <em><strong>虚拟机平台</strong></em> 可选功能或者以管理员身份打开终端 PowerShell 并运行：</p> 
<div> 
 <div> 
  <pre><code class="language-bash">dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart</code></pre> 
 </div> 
</div> 
<p>重启计算机，以完成 WSL 安装并更新到 WSL 2。</p> 
<h4>安装 Linux 内核更新包</h4> 
<p><strong>1.</strong> 下载最新包：<a class="link-info" href="https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi" rel="nofollow" title="适用于 x64 计算机的 WSL2 Linux 内核更新包">适用于 x64 计算机的 WSL2 Linux 内核更新包</a></p> 
<p><strong>2.</strong> 运行上一步中下载的更新包。（双击运行 - 系统将提示你提供提升的权限，选择“是”）</p> 
<h4>设置 WSL 默认版本</h4> 
<p>打开 PowerShell，然后在安装新的 Linux 发行版时运行以下命令，将 WSL 2 设置为默认版本：</p> 
<div> 
 <pre><code class="language-bash">wsl --set-default-version 2</code></pre> 
</div> 
<h3>安装 Linux 发行版</h3> 
<h4>安装方式</h4> 
<p><strong>1. </strong>通过 <a href="https://aka.ms/wslstore" rel="nofollow" title="Microsoft Store">Microsoft Store</a> 或者使用命令 <em><span style="color:#ff9900;"><strong>wsl --install</strong></span></em> 自动安装。默认安装的 Linux 分发版是 Ubuntu ，可使用命令 <em><strong><span style="color:#ff9900;">wsl --install -d &lt;Distribution Name&gt;</span></strong></em> 来指定安装的发行版，将 <span style="color:#0d0016;"><em>&lt;Distribution Name&gt;</em></span> 替换为要安装的发行版的名称。但这种方式仅适用于 Microsoft Store 支持的版本，使用命令 <span style="color:#ff9900;"><em><strong>wsl --list --online</strong></em> </span>查看可通过在线商店下载的可用 Linux 发行版列表。</p> 
<p><strong>2. </strong><a href="https://learn.microsoft.com/zh-cn/windows/wsl/use-custom-distro" rel="nofollow" title="导入要与 WSL 一起使用的任何 Linux 发行版 | Microsoft Learn">导入要与 WSL 一起使用的任何 Linux 发行版 | Microsoft Learn</a></p> 
<p><strong>3. </strong>使用 LxRunOffline 插件能够安装任意发行版系统到任意目录，且具备转移已安装WSL目录、备份等功能，是一个极好的 WSL 管理软件，下面主要介绍使用 LxRunOffline 安装发行版。</p> 
<h4>安装 LxRunOffline</h4> 
<p>GitHub 下载最新版：<a class="link-info" href="https://github.com/DDoSolitary/LxRunOffline/releases" title="https://github.com/DDoSolitary/LxRunOffline/releases">https://github.com/DDoSolitary/LxRunOffline/releases</a> 下载并解压缩之后直接拷贝到 <strong><em><span style="color:#ff9900;">C:\Windows\System32</span></em></strong> 或者 添加插件目录到环境变量 Path。如果需要通过右键菜单功能执行某些功能操作，则需要以管理员权限打开终端，执行 <span style="color:#ff9900;"><strong><em>regsvr32</em></strong></span> <span style="color:#ff9900;"><em>LxRunOfflineShellExt.dll</em></span> 完成功能注册。最后打开终端输入命令<span style="color:#ff9900;"> <em><strong>lxrunoffline</strong></em> </span>验证是否安装成功。</p> 
<h4>下载发行版镜像</h4> 
<ul><li>Microsoft WSL 离线包：<a class="link-info" href="https://learn.microsoft.com/zh-cn/windows/wsl/install-manual#downloading-distributions" rel="nofollow" title="Manually download Windows Subsystem for Linux (WSL) Distros">Manually download Windows Subsystem for Linux (WSL) Distros</a></li><li>LxRunOffline WiKi 镜像：<a class="link-info" href="https://github.com/DDoSolitary/LxRunOffline/wiki" title="DDoSolitary/LxRunOffline Wiki · GitHub">DDoSolitary/LxRunOffline Wiki · GitHub</a></li><li>从其它渠道下载的发行版镜像包</li></ul> 
<p>如果是从微软官方下载的 WSL 离线包，解压后找到 <em><span style="color:#ff9900;"><strong>install.tar.gz</strong></span></em> 就是后续使用的安装文件。</p> 
<h4>开启目录大小写敏感 </h4> 
<p>Windows 文件系统默认不区分大小写，而Linux是区分的。这就导致在安装、运行部分软件时会报错，我们新建一个用于存放 WSL 的安装目录，打开终端并切换到相应目录，运行以下命令开启当前目录大小写敏感： </p> 
<pre><code class="language-bash">#  .\ 表示当前目录，此处参数可自定义
fsutil.exe file setCaseSensitiveInfo .\ enable
</code></pre> 
<pre><code class="language-bash"># 查看某个目录是否大小写敏感
fsutil.exe file queryCaseSensitiveInfo &lt;path&gt;
# 禁用大小写敏感
fsutil.exe file setCaseSensitiveInfo &lt;path&gt; disable</code></pre> 
<h4>安装发行版</h4> 
<p>输入以下命令进行安装：</p> 
<pre><code class="language-bash"># -s 参数表示在桌面创建WSL快捷图标
lxrunoffline i -s -n &lt;WSL名称&gt; -d &lt;安装路径&gt; -f &lt;安装包路径&gt;.tar.gz</code></pre> 
<p>例如：</p> 
<pre><code class="language-bash">LxRunOffline i -n centos -d D:\linux\centos7 -f D:\downloads\centos-7-x86_64-docker.tar.xz</code></pre> 
<h3>使用 WSL</h3> 
<p>本文所有示例将以 Ubuntu2204 发行版为例，WSL 基本使用命令可参考 Microsoft 官方文档： </p> 
<p><a class="has-card" href="https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands" rel="nofollow" title="WSL 的基本命令 | Microsoft Learn"><span class="link-card-box"><span class="link-title">WSL 的基本命令 | Microsoft Learn</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/cf/df/kJ6W73Vf_o.png">https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands</span></span></a></p> 
<h4>运行 WSL</h4> 
<p>运行默认 Linux 发行版</p> 
<pre><code class="language-bash"># 方式1
wsl
# 方式2
bash
</code></pre> 
<p>运行指定 Linux 发行版</p> 
<pre><code class="language-bash"># wsl命令
wsl -d &lt;WSL名称&gt;

# lxrunoffline 命令
lxrunoffline r -n &lt;WSL名称&gt;</code></pre> 
<h4>设置默认用户</h4> 
<p>使用 LxRunOf­fline 安装的 WSL 默认是以 root 用户登录，如果你需要默认以普通用户登录则需要进行以下操作。首先运行 WSL 并输入以下命令创建用户：</p> 
<pre><code class="language-bash">useradd -m -s /bin/bash &lt;用户名&gt;</code></pre> 
<p>然后对该用户设置密码，输入命令后会提示输入两次密码</p> 
<pre><code class="language-bash">passwd &lt;用户名&gt;</code></pre> 
<p>授予该用户 sudo 权限</p> 
<pre><code class="language-bash">usermod -aG sudo &lt;用户名&gt;</code></pre> 
<p>查看用户 UID ，一般是 1000</p> 
<pre><code class="language-bash">id -u &lt;用户名&gt;</code></pre> 
<p>按 Ctrl+D 退出 WSL ，在 Pow­er­Shell 中输入以下命令设置默认用户：</p> 
<pre><code class="language-bash">lxrunoffline su -n &lt;WSL名称&gt; -v 1000(UID)</code></pre> 
<p>修改 WSL 名称或目录后就无法通过 <a class="link-info" href="https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands#change-the-default-user-for-a-distribution" rel="nofollow" title="官方命令设置默认用户">官方命令设置默认用户</a>，同样可以通过以上方式进行设置。</p> 
<h4>设置默认 WSL</h4> 
<pre><code class="language-bash"># 命令1
wsl --set-default &lt;WSL名称&gt;
# 命令2
lxrunoffline sd -n &lt;WSL名称&gt;
</code></pre> 
<h4>修改 WSL 名称</h4> 
<pre><code class="language-bash"># 查看WSL名称
wsl -l
# 查看WSL安装目录
lxrunoffline di -n &lt;WSL名称&gt;
# 导出指定WSL配置文件到目标路径
lxrunoffline ec -n &lt;WSL名称&gt; -f &lt;配置文件路径&gt;.xml
# 取消注册
lxrunoffline ur -n &lt;WSL名称&gt;
# 使用新名称注册
lxrunoffline rg -n &lt;WSL名称&gt; -d &lt;WSL路径&gt; -c &lt;配置文件路径&gt;.xml</code></pre> 
<h4>列出已安装发行版</h4> 
<p>查看所有已安装的 Linux 发行版列表，其中包括状态（正在运行或已停止）和运行发行版的 WSL 版本（WSL1 或 WSL2）。</p> 
<pre><code class="language-bash">wsl -l -v</code></pre> 
<h4>设置指定 WSL 版本</h4> 
<pre><code class="language-bash">wsl --set-default-version &lt;distribution name&gt; &lt;Version&gt;</code></pre> 
<p>若要指定运行 Linux 发行版的 WSL 版本（1 或 2），请将 <span style="color:#0d0016;"><em>&lt;distribution name&gt;</em></span>  替换为发行版的名称，并将 <span style="color:#0d0016;"><em>&lt;Version&gt;</em></span> 替换为 1 或 2 。</p> 
<h4>创建快捷方式</h4> 
<pre><code class="language-bash">lxrunoffline s -n &lt;WSL名称&gt; -f &lt;快捷方式路径&gt;.lnk</code></pre> 
<h4>关闭 WSL</h4> 
<p><strong>1. </strong>关闭当前正在运行的发行版：在终端中使用快捷键 CTRL+ D</p> 
<p>注意：该方式并不会立即终止 WSL 的运行，会有十几秒的延迟。</p> 
<p><strong>2. </strong>终止指定的发行版或阻止其运行</p> 
<pre><code class="language-bash">wsl -t &lt;WSL名称&gt;</code></pre> 
<p><strong>3.</strong> 立即终止所有正在运行的发行版和 WSL2 轻量级实用工具虚拟机</p> 
<pre><code class="language-bash">wsl --shutdown</code></pre> 
<p>在需要重启 WSL 2 虚拟机环境的情形下，例如<a href="https://learn.microsoft.com/zh-cn/windows/wsl/disk-space" rel="nofollow" title=" 更改内存使用限制"> 更改内存使用限制</a> 或更改 <a href="https://learn.microsoft.com/zh-cn/windows/wsl/manage#" rel="nofollow" title=".wslconfig 文件">.wslconfig 文件</a>，可能必须使用此命令。</p> 
<h4>在 WSL 中访问 Windows 文件</h4> 
<p>WSL 的优势之一是可以通过 Windows 和 Linux 应用或工具访问文件。WSL 将计算机的固定驱动器装载到 Linux 分发版中的 <strong><em><span style="color:#ff9900;">/mnt/&lt;drive&gt;</span></em></strong> 文件夹下。 例如，你的 C: 驱动器装载在<em><span style="color:#ff9900;"> <strong>/mnt/c/</strong></span></em> 。</p> 
<p>例如，使用装载的驱动器，可以使用 Visual Studio 或 VS Code 编辑 <span style="color:#0d0016;"><em>C:\dev\myproj\</em> </span>中的代码，并通过<em><span style="color:#ff9900;"> </span><span style="color:#0d0016;">/mnt/c/dev/myproj<strong> </strong></span></em>访问相同的文件，在 Linux 中测试该代码。</p> 
<blockquote> 
 <p>使用 WSL 的主要限制之一是不支持使用 Windows 应用或工具直接访问/更改 Linux 发行版文件系统中的文件。Windows 和 Linux 中文件元数据的表示方式是不同的。因此，通过 Windows 应用、工具、脚本、终端来访问、创建、修改 Windows 目录中的 Linux 子系统的文件时，会造成数据污染或损坏 Linux 环境，导致需要卸载和重新安装 Linux 子系统。</p> 
</blockquote> 
<p><strong>正确方法：</strong>将工作文件存放在 Windows 文件系统中，这样不仅可以在 Windows 中直接访问，还能在 Linux 中通过 <strong><em><span style="color:#ff9900;">/mnt/&lt;drive&gt;/&lt;path&gt;</span></em></strong> 进行访问，避免在两个系统中来回拷贝文件。</p> 
<h4>更换软件源</h4> 
<p>使用 Linux 子系统时，为了提高软件的安装速度，需要将软件源换成国内的镜像源。</p> 
<p><strong>1. </strong>备份原来的数据源配置文件</p> 
<pre><code class="language-bash">sudo cp /etc/apt/sources.list /etc/apt/sources.list_bak</code></pre> 
<p><strong>2. </strong>修改数据源配置文件：直接使用国内源覆盖文件内容</p> 
<pre><code class="language-bash">sudo vi /etc/apt/sources.list</code></pre> 
<p>这里使用 Ubuntu 22.04 的中科大源，名称为 <strong><span style="color:#ff9900;">jammy</span>，</strong>其他版本则替换为对应的版本名称即可。</p> 
<pre><code class="language-bash"># 默认注释了源码仓库，如有需要可自行取消注释
deb https://mirrors.ustc.edu.cn/ubuntu/ jammy main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-security main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-security main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse</code></pre> 
<p><em>其它软件源请参考：</em> <a class="has-card" href="https://blog.csdn.net/xiangxianghehe/article/details/122856771" title="Ubuntu 22.04换国内源 清华源 阿里源 中科大源 163源_CSDN博客"><span class="link-card-box"><span class="link-title">Ubuntu 22.04换国内源 清华源 阿里源 中科大源 163源_CSDN博客</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/b8/52/NGsI3SRo_o.png">https://blog.csdn.net/xiangxianghehe/article/details/122856771</span></span></a></p> 
<p><strong>3. </strong>更新升级软件 (可选)</p> 
<pre><code class="language-bash">sudo apt-get update
sudo apt-get upgrade</code></pre> 
<h4>安装 systemd 脚本[可选]</h4> 
<p>目前 WSL 不支持 <span style="color:#ff9900;"><em><strong>systemd</strong></em></span>（Linux 服务管理系统），可以安装 <a class="link-info" href="https://github.com/DamionGans/ubuntu-wsl2-systemd-script" title="ubuntu-wsl2-systemd-script">ubuntu-wsl2-systemd-script</a> 脚本来使用相关命令。<em><strong>注：</strong></em>安装该脚本需要将 WSL 版本切换为 WSL2 ，否则使用时可能会报错。</p> 
<pre><code class="language-bash"># 安装git
sudo apt install git
</code></pre> 
<pre><code class="language-bash"># 运行脚本和命令
git clone https://github.com/DamionGans/ubuntu-wsl2-systemd-script.git
cd ubuntu-wsl2-systemd-script/
bash ubuntu-wsl2-systemd-script.sh</code></pre> 
<pre><code class="language-bash"># 重新启动 WSL 并尝试运行 systemctl
systemctl
</code></pre> 
<h3>安装图形界面</h3> 
<h4>安装桌面环境xfce4</h4> 
<pre><code class="language-bash">sudo apt-get install xfce4 xfce4-goodies</code></pre> 
<p>注：display manager 选择 <span style="color:#ff9900;"><em>gdm3</em> </span>或<em> </em><span style="color:#ff9900;"><em>lightdm</em> </span>均可。</p> 
<h4>安装远程桌面服务xrdp</h4> 
<pre><code class="language-bash">sudo apt-get install xrdp</code></pre> 
<h4>修改配置文件xrdp.ini</h4> 
<pre><code class="language-bash"># 复制一份备用
sudo cp /etc/xrdp/xrdp.ini /etc/xrdp/xrdp.ini.bak</code></pre> 
<pre><code class="language-bash"># 配置端口 3389 改为 3390，避免和windows的端口冲突
sudo sed -i 's/3389/3390/g' /etc/xrdp/xrdp.ini
# max_bpp=32 修改为 128（最大位图深度）
sudo sed -i 's/max_bpp=32/#max_bbp=32\nmax_bpp=128/g' /etc/xrdp/xrdp.ini
# #xserverbpp=24 修改为 128，取消注释 #
sudo sed -i 's/xservervpp=24/#xservervpp=24\nxserverbpp=128/g' /etc/xrdp/xrdp.ini</code></pre> 
<h4>新增配置文件.xsession</h4> 
<pre><code class="language-bash"># 告诉系统: 开启桌面环境的时候用xfce4-session
sudo echo xfce4-session &gt; ~/.xsession</code></pre> 
<h4>配置sesman.ini</h4> 
<pre><code class="language-bash">sudo vim /etc/xrdp/sesman.ini</code></pre> 
<p>将 <strong><em><span style="color:#ff9900;">KillDisconnected</span></em></strong> 的值修改为 <strong><span style="color:#ff9900;">true</span> </strong>保存退出。</p> 
<h4>修改配置startwm.sh</h4> 
<pre><code class="language-bash">sudo vim /etc/xrdp/startwm.sh</code></pre> 
<p>注释掉末尾亮行，并添加一行 <span style="color:#ff9900;"><strong><em>startxfce4</em></strong> </span>如图所示：</p> 
<p><img alt="" height="435" src="https://images2.imgbox.com/8d/dc/QaOfKb76_o.png" width="715"></p> 
<h4>启用 xrdp 服务</h4> 
<pre><code class="language-bash">sudo /etc/init.d/xrdp start</code></pre> 
<p>WSL 的图形桌面需借助 Windows 远程桌面进行显示，但必须先开启 xrdp 服务才能使用远程桌面连接。这样每次使用 WSL 桌面都需要手动开启 xrdp，可将 xrdp 服务设置为开机自启。</p> 
<p><a class="has-card" href="https://blog.csdn.net/w47_csdn/article/details/129101896?spm=1001.2014.3001.5501" title="WSL(ubuntu2204)xfce4语言支持报错及配置WSL服务自启_itboone的博客"><span class="link-card-box"><span class="link-title">WSL(ubuntu2204)xfce4语言支持报错及配置WSL服务自启_itboone的博客</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/d7/ac/Ozn5aP1v_o.png">https://blog.csdn.net/w47_csdn/article/details/129101896?spm=1001.2014.3001.5501</span></span></a></p> 
<h4>远程桌面链接</h4> 
<p>按下 <strong><em><span style="color:#ff9900;">Windows+R</span></em></strong> 键，输入 <strong><span style="color:#ff9900;">mstsc</span></strong> 打开远程桌面连接。</p> 
<p><img alt="" height="313" src="https://images2.imgbox.com/c3/00/FOjrdve1_o.png" width="472"></p> 
<p>IP为本机即 localhost，端口为配置的3390，IP 也可以使用 <span style="color:#ff9900;"><strong><em>ifconfig</em></strong> </span>命令查到的 eth0 inet 地址。</p> 
<p><img alt="" height="345" src="https://images2.imgbox.com/e9/be/DhBKKDmp_o.png" width="707"></p> 
<p>连接后进入登录页面，用户名和密码填写 WSL 的用户名和密码。注：不要使用 <strong><span style="color:#fe2c24;">root</span></strong> 用户登录。</p> 
<p> <img alt="" height="430" src="https://images2.imgbox.com/25/26/FK9rTUtP_o.png" width="585"></p> 
<p><img alt="" height="878" src="https://images2.imgbox.com/77/1b/yrxdCtTa_o.png" width="1114"></p> 
<h4>安装 chrome 浏览器</h4> 
<p><strong>1. </strong>为Google Chrome 创建源列表文件</p> 
<pre><code class="language-bash">sudo vim /etc/apt/sources.list.d/google-chrome.list</code></pre> 
<p><strong>2. </strong>在源列表文件中添加以下内容</p> 
<pre><code class="language-bash">deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main</code></pre> 
<p><strong>3. </strong>下载Google的签名密钥</p> 
<pre><code class="language-bash">wget https://dl.google.com/linux/linux_signing_key.pub</code></pre> 
<p><strong>4.</strong> 将密钥添加到密钥环以便包管理器可以验证包的完整性</p> 
<pre><code class="language-bash">sudo apt-key add linux_signing_key.pub</code></pre> 
<p><strong>5. </strong>更新包列表并安装稳定版 Chrome</p> 
<pre><code class="language-bash">sudo apt update
sudo apt install google-chrome-stable</code></pre> 
<p><strong>6.</strong> 从命令行启动 Chrome 浏览器</p> 
<pre><code class="language-bash">google-chrome-stable</code></pre> 
<h4>安装中文环境及中文输入法</h4> 
<p><a class="has-card" href="https://blog.csdn.net/w47_csdn/article/details/129107128?spm=1001.2014.3001.5501" title="WSL(ubuntu2204)xfce4安装中文环境和fcitx5框架及中文输入法_itboone的博客"><span class="link-card-box"><span class="link-title">WSL(ubuntu2204)xfce4安装中文环境和fcitx5框架及中文输入法_itboone的博客</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/a9/9c/jFMh3kj3_o.png">https://blog.csdn.net/w47_csdn/article/details/129107128?spm=1001.2014.3001.5501</span></span></a></p> 
<h3>相关问题</h3> 
<p><a class="has-card" href="https://blog.csdn.net/marin1993/article/details/119841299" title="一劳永逸，wsl2出现“参考的对象类型不支持尝试的操作”的解决办法_桑榆肖物的博客"><span class="link-card-box"><span class="link-title">一劳永逸，wsl2出现“参考的对象类型不支持尝试的操作”的解决办法_桑榆肖物的博客</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/45/1d/onqvujQn_o.png">https://blog.csdn.net/marin1993/article/details/119841299</span></span></a></p> 
<h3>参考资料</h3> 
<p><a class="has-card" href="https://learn.microsoft.com/zh-cn/windows/wsl/" rel="nofollow" title="适用于 Linux 的 Windows 子系统文档 | Microsoft Learn"><span class="link-card-box"><span class="link-title">适用于 Linux 的 Windows 子系统文档 | Microsoft Learn</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/84/34/R6z3jZ5A_o.png">https://learn.microsoft.com/zh-cn/windows/wsl/</span></span></a></p> 
<p><a class="has-card" href="https://oopsdc.com/post/lxrunoffline/" rel="nofollow" title="LxRunOffline使用手册 | 0opsdc (oopsdc.com)"><span class="link-card-box"><span class="link-title">LxRunOffline使用手册 | 0opsdc (oopsdc.com)</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/f7/00/QxvNLsco_o.png">https://oopsdc.com/post/lxrunoffline/</span></span></a></p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/farer_yyh/article/details/113785474" title="使用 LxRunOffline 实现 WSL 自定义安装_farer_yyh的博客"><span class="link-card-box"><span class="link-title">使用 LxRunOffline 实现 WSL 自定义安装_farer_yyh的博客</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/12/35/WVMN8pmr_o.png">https://blog.csdn.net/farer_yyh/article/details/113785474</span></span></a></p> 
<p><a class="has-card" href="https://www.jianshu.com/p/af94731626e3" rel="nofollow" title="WSL GUI图形界面(xfce4)的安装 - 简书 (jianshu.com)"><span class="link-card-box"><span class="link-title">WSL GUI图形界面(xfce4)的安装 - 简书 (jianshu.com)</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/e3/72/nfOk4nx5_o.png">https://www.jianshu.com/p/af94731626e3</span></span></a></p> 
<p><a class="link-info has-card" href="https://blog.csdn.net/sandonz/article/details/120854876" title="WSL(Ubuntu20.04)与其图形界面安装配置_sandonz的博客"><span class="link-card-box"><span class="link-title">WSL(Ubuntu20.04)与其图形界面安装配置_sandonz的博客</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/71/78/aOwaKZvd_o.png">https://blog.csdn.net/sandonz/article/details/120854876</span></span></a></p> 
<p><a class="has-card" href="https://blog.csdn.net/FSKEps/article/details/118493578" title="Win10 系统安装 Linux 子系统教程(WSL2 + Ubuntu 20.04 + Gnome 桌面 ）"><span class="link-card-box"><span class="link-title">Win10 系统安装 Linux 子系统教程(WSL2 + Ubuntu 20.04 + Gnome 桌面 ）</span><span class="link-link"><img alt="" class="link-link-icon" src="https://images2.imgbox.com/eb/25/oHvjleUd_o.png">https://blog.csdn.net/FSKEps/article/details/118493578</span></span></a></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fba987d61fcc443e2cd76f104f17747a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VUE经典面试题总结（一）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7e2da2ad6f7faa2b803fa6d3524d4c89/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Oracle trunc()函数详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>