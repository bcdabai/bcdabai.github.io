<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【QT】QT项目：自制Wireshark - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【QT】QT项目：自制Wireshark" />
<meta property="og:description" content="一、项目总览 二、运行结果 三、项目源码 1、shark.pro
QT &#43;= core gui greaterThan(QT_MAJOR_VERSION, 4): QT &#43;= widgets CONFIG &#43;= c&#43;&#43;11 # The following define makes your compiler emit warnings if you use # any Qt feature that has been marked deprecated (the exact warnings # depend on your compiler). Please consult the documentation of the # deprecated API in order to know how to port your code away from it. DEFINES &#43;= QT_DEPRECATED_WARNINGS # You can also make your code fail to compile if it uses deprecated APIs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3b072c5f756d1a3cb8273535601d32aa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-05T14:29:40+08:00" />
<meta property="article:modified_time" content="2022-09-05T14:29:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【QT】QT项目：自制Wireshark</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>一、项目总览</h4> 
<p><img src="https://images2.imgbox.com/e6/1d/lRZBuTu6_o.png" alt="img"></p> 
<h4><a id="_3"></a>二、运行结果</h4> 
<p><img src="https://images2.imgbox.com/f9/f8/hyJOjH99_o.png" alt="img"></p> 
<p><img src="https://images2.imgbox.com/9c/85/j7qvAxMQ_o.png" alt="img"></p> 
<p><img src="https://images2.imgbox.com/47/44/R4IAClIp_o.png" alt="img"></p> 
<h4><a id="_10"></a>三、项目源码</h4> 
<p>1、shark.pro</p> 
<pre><code class="prism language-cpp">QT       <span class="token operator">+=</span> core gui

<span class="token function">greaterThan</span><span class="token punctuation">(</span>QT_MAJOR_VERSION<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span> QT <span class="token operator">+=</span> widgets

CONFIG <span class="token operator">+=</span> c<span class="token operator">++</span><span class="token number">11</span>

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">The following define makes your compiler emit warnings <span class="token keyword">if</span> you use</span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">any</span> <span class="token expression">Qt feature that has been marked <span class="token function">deprecated</span> <span class="token punctuation">(</span>the exact warnings</span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">depend</span> <span class="token expression">on your compiler<span class="token punctuation">)</span><span class="token punctuation">.</span> Please consult the documentation of the</span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">deprecated</span> <span class="token expression">API in order to know how to port your code away from it<span class="token punctuation">.</span></span></span>
DEFINES <span class="token operator">+=</span> QT_DEPRECATED_WARNINGS

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">You can also make your code fail to compile <span class="token keyword">if</span> it uses deprecated APIs<span class="token punctuation">.</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">In order to <span class="token keyword">do</span> so<span class="token punctuation">,</span> uncomment the following line<span class="token punctuation">.</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">You can also select to disable deprecated APIs only up to a certain version of Qt<span class="token punctuation">.</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">DEFINES <span class="token operator">+=</span> QT_DISABLE_DEPRECATED_BEFORE<span class="token operator">=</span><span class="token number">0x060000</span>    # disables all the APIs deprecated before Qt <span class="token number">6.0</span><span class="token punctuation">.</span><span class="token number">0</span></span></span>

SOURCES <span class="token operator">+=</span> \
    capture<span class="token punctuation">.</span>cpp \
    datapackage<span class="token punctuation">.</span>cpp \
    main<span class="token punctuation">.</span>cpp \
    mainwindow<span class="token punctuation">.</span>cpp \
    readonlydelegate<span class="token punctuation">.</span>cpp

HEADERS <span class="token operator">+=</span> \
    Format<span class="token punctuation">.</span>h \
    capture<span class="token punctuation">.</span>h \
    datapackage<span class="token punctuation">.</span>h \
    mainwindow<span class="token punctuation">.</span>h \
    readonlydelegate<span class="token punctuation">.</span>h

FORMS <span class="token operator">+=</span> \
    mainwindow<span class="token punctuation">.</span>ui

INCLUDEPATH <span class="token operator">+=</span> E<span class="token operator">:</span><span class="token operator">/</span>QT<span class="token operator">/</span>Code<span class="token operator">/</span>QtPro<span class="token operator">/</span>GitPro<span class="token operator">/</span>Program<span class="token operator">/</span>Network<span class="token operator">-</span>capture<span class="token operator">/</span>Network<span class="token operator">-</span>capture<span class="token operator">/</span>Include

LIBS <span class="token operator">+=</span> E<span class="token operator">:</span><span class="token operator">/</span>QT<span class="token operator">/</span>Code<span class="token operator">/</span>QtPro<span class="token operator">/</span>GitPro<span class="token operator">/</span>Program<span class="token operator">/</span>Network<span class="token operator">-</span>capture<span class="token operator">/</span>Network<span class="token operator">-</span>capture<span class="token operator">/</span>Lib<span class="token operator">/</span>x64<span class="token operator">/</span>wpcap<span class="token punctuation">.</span>lib  #libws2_32
LIBS <span class="token operator">+=</span> E<span class="token operator">:</span><span class="token operator">/</span>QT<span class="token operator">/</span>Code<span class="token operator">/</span>QtPro<span class="token operator">/</span>GitPro<span class="token operator">/</span>Program<span class="token operator">/</span>Network<span class="token operator">-</span>capture<span class="token operator">/</span>Network<span class="token operator">-</span>capture<span class="token operator">/</span>Lib<span class="token operator">/</span>x64<span class="token operator">/</span>Packet<span class="token punctuation">.</span>lib

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Default rules <span class="token keyword">for</span> deployment<span class="token punctuation">.</span></span></span>
qnx<span class="token operator">:</span> target<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>$$<span class="token punctuation">{<!-- --></span>TARGET<span class="token punctuation">}</span><span class="token operator">/</span>bin
<span class="token keyword">else</span><span class="token operator">:</span> unix<span class="token operator">:</span><span class="token operator">!</span>android<span class="token operator">:</span> target<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token operator">/</span>opt<span class="token operator">/</span>$$<span class="token punctuation">{<!-- --></span>TARGET<span class="token punctuation">}</span><span class="token operator">/</span>bin
<span class="token operator">!</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token operator">:</span> INSTALLS <span class="token operator">+=</span> target

RESOURCES <span class="token operator">+=</span> \
    src<span class="token punctuation">.</span>qrc
</code></pre> 
<p>2、capture.h</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CAPTURE_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CAPTURE_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QThread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Format.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QQueue&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"pcap.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span></span><span class="token string">"ws2_32.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QString&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"winsock2.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"datapackage.h"</span></span>

<span class="token keyword">class</span> <span class="token class-name">Capture</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QThread</span></span>
<span class="token punctuation">{<!-- --></span>
     Q_OBJECT
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Capture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> <span class="token function">setPointer</span><span class="token punctuation">(</span>pcap_t <span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">resetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">ethernetPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">ipPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>ipPackage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString <span class="token function">arpPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString <span class="token function">icmpPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">tcpPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">,</span>QString <span class="token operator">&amp;</span>info<span class="token punctuation">,</span><span class="token keyword">int</span> ipPackage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">udpPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString <span class="token function">dnsPackageHandle</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">static</span> QString <span class="token function">byteToHex</span><span class="token punctuation">(</span>u_char <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

signals<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span>DataPackage data<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    pcap_t <span class="token operator">*</span>pointer<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">pcap_pkthdr</span><span class="token operator">*</span>header<span class="token punctuation">;</span>
    <span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_data<span class="token punctuation">;</span>
    time_t local_time_version_sec<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">tm</span> local_time<span class="token punctuation">;</span>
    <span class="token keyword">char</span> timeString<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">volatile</span> <span class="token keyword">bool</span> isDone<span class="token punctuation">;</span><span class="token comment">// done flag</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// CAPTURE_H</span></span>
</code></pre> 
<p>3、capture.cpp</p> 
<pre><code class="prism language-CPP">#include "capture.h"
#include &lt;QDebug&gt;
#include &lt;QString&gt;


Capture::Capture(){
    this-&gt;isDone = false;
    this-&gt;pointer = nullptr;
    this-&gt;header = nullptr;
    this-&gt;pkt_data = nullptr;
}
bool Capture::setPointer(pcap_t *pointer){
    this-&gt;pointer = pointer;
    if(pointer)
        return true;
    else return false;
}

void Capture::setFlag(){
    this-&gt;isDone = true;
}

void Capture::resetFlag(){
    this-&gt;isDone = false;
}

QString Capture::byteToHex(u_char *str, int size){
    QString res = "";
    for(int i = 0;i &lt; size;i++){
        char one = str[i] &gt;&gt; 4;
        if(one &gt;= 0x0A)
            one = one + 0x41 - 0x0A;
        else one = one + 0x30;
        char two = str[i] &amp; 0xF;
        if(two &gt;= 0x0A)
            two = two  + 0x41 - 0x0A;
        else two = two + 0x30;
        res.append(one);
        res.append(two);
    }
    return res;
}

void Capture::run(){
    unsigned int number_package = 0;
    while(true){
        if(isDone)
            break;
        int res = pcap_next_ex(pointer,&amp;header,&amp;pkt_data);
        if(res == 0)
            continue;
        local_time_version_sec = header-&gt;ts.tv_sec;
        localtime_s(&amp;local_time,&amp;local_time_version_sec);
        strftime(timeString,sizeof(timeString),"%H:%M:%S",&amp;local_time);
        QString info = "";
        int type = ethernetPackageHandle(pkt_data,info);
        if(type){
            DataPackage data;
            int len = header-&gt;len;
            data.setPackageType(type);
            data.setTimeStamp(QString(timeString));
            data.setDataLength(len);
            data.setPackagePointer(pkt_data,len);
            data.setPackageInfo(info);
            if(data.pkt_content != nullptr){
                emit send(data);
                number_package++;
            }else continue;
        }
        else continue;
    }
    return;
}

int Capture::ethernetPackageHandle(const u_char *pkt_content,QString&amp; info){
    ETHER_HEADER* ethernet;
    u_short ethernet_type;
    ethernet = (ETHER_HEADER*)pkt_content;
    ethernet_type = ntohs(ethernet-&gt;ether_type);

    switch(ethernet_type){
    case 0x0800:{// ip package
        int dataPackage = 0;
        int res = ipPackageHandle(pkt_content,dataPackage);
        switch (res) {
        case 1:{// icmp package
            info = icmpPackageHandle(pkt_content);
            return 2;
        }
        case 6:{// tcp package
            return tcpPackageHandle(pkt_content,info,dataPackage);

        }
        case 17:{ // udp package
            int type = udpPackageHandle(pkt_content,info);
            return type;
        }
        default:break;
        }
        break;
    }
    case 0x0806:{// arp package
        info = arpPackageHandle(pkt_content);
        return 1;
    }
    default:{// undefined package
        break;
    }
    }
    return 0;
}
// ip package
int Capture::ipPackageHandle(const u_char *pkt_content,int&amp; ipPackage){
    /*
+------+-----+-----+
|   1  |  6  |  17 |
+------+-----+-----+
| ICMP | TCP | UDP |
+------+-----+-----+
*/
    IP_HEADER* ip;
    ip = (IP_HEADER*)(pkt_content + 14);
    int protocol = ip-&gt;protocol;
    ipPackage = (htons(ip-&gt;total_length) - (ip-&gt;versiosn_head_length &amp; 0x0F) * 4);
    return protocol;
}
// icmp package
/*
 * part of the protocol of type and code
 * if you need detail information, pls check the official documents
+------+------+------------------------------------------------+
| type | code |                   information                  |
+------+------+------------------------------------------------+
|  0   |   0  |     Echo response (ping command response)      |
+------+------+------------------------------------------------+
|      |   0  |             Network unreachable                |
+      +------+------------------------------------------------+
|      |   1  |             Host unreachable                   |
+      +------+------------------------------------------------+
|      |   2  |              Protocol unreachable              |
+      +------+------------------------------------------------+
|   3  |   3  |              Port unreachable                  |
+      +------+------------------------------------------------+
|      |   4  |    Fragmentation is required, but DF is set    |
+      +------+------------------------------------------------+
|      |   5  |        Source route selection failed           |
+      +------+------------------------------------------------+
|      |   6  |            Unknown target network              |
+------+------+------------------------------------------------+
|   4  |   0  | Source station suppression [congestion control]|
+------+------+------------------------------------------------+
|   5  |  any |                  Relocation                    |
+------+------+------------------------------------------------+
|  8   |   0  |       Echo request (ping command request)      |
+------+------+------------------------------------------------+
......

*/
QString Capture::icmpPackageHandle(const u_char *pkt_content){
    ICMP_HEADER*icmp;
    icmp = (ICMP_HEADER*)(pkt_content + 20 + 14);
    u_char type = icmp-&gt;type;
    u_char code = icmp-&gt;code;
    QString result = "";
    switch (type) {
    case 0:{
        if(!code)
            result = "Echo response (ping)";
        break;
    }
    case 3:{
        switch (code) {
        case 0:{
            result = "Network unreachable";
            break;
        }
        case 1:{
            result = "Host unreachable";
            break;
        }
        case 2:{
            result = "Protocol unreachable";
            break;
        }
        case 3:{
            result = "Port unreachable";
            break;
        }
        case 4:{
            result = "Fragmentation is required, but DF is set";
            break;
        }
        case 5:{
            result = "Source route selection failed";
            break;
        }
        case 6:{
            result = "Unknown target network";
            break;
        }
        default:break;
        }
        break;
    }
    case 4:{
        result = "Source station suppression [congestion control]";
        break;
    }
    case 5:{
        result = "Relocation";
        break;
    }
    case 8:{
        if(!code)
            result = "Echo request (ping)";
        break;
    }
    default:break;
    }
    return result;
}

int Capture::tcpPackageHandle(const u_char *pkt_content,QString &amp;info,int ipPackage){
    TCP_HEADER*tcp;
    tcp = (TCP_HEADER*)(pkt_content + 14 + 20);
    u_short src = ntohs(tcp-&gt;src_port);
    u_short des = ntohs(tcp-&gt;des_port);
    QString proSend = "";
    QString proRecv = "";
    int type = 3;
    int delta = (tcp-&gt;header_length &gt;&gt; 4) * 4;
    int tcpPayLoad = ipPackage - delta;
    if((src == 443 || des == 443) &amp;&amp; (tcpPayLoad &gt; 0)){
        if(src == 443)
            proSend = "(https)";
        else proRecv = "(https)";
        u_char *ssl;
        ssl = (u_char*)(pkt_content + 14 + 20 + delta);
        u_char isTls = *(ssl);
        ssl++;
        u_short*pointer = (u_short*)(ssl);
        u_short version = ntohs(*pointer);
        if(isTls &gt;= 20 &amp;&amp; isTls &lt;= 23 &amp;&amp; version &gt;= 0x0301 &amp;&amp; version &lt;= 0x0304){
            type = 6;
            switch(isTls){
            case 20:{
                info = "Change Cipher Spec";
                break;
            }
            case 21:{
                info = "Alert";
                break;
            }
            case 22:{
                info = "Handshake";
                ssl += 4;
                u_char type = (*ssl);
                switch (type) {
                case 1: {
                    info += " Client Hello";
                    break;
                }
                case 2: {
                    info += " Server hello";
                    break;
                }
                case 4: {
                    info += " New Session Ticket";
                    break;
                }
                case 11:{
                    info += " Certificate";
                    break;
                }
                case 16:{
                    info += " Client Key Exchange";
                    break;
                }
                case 12:{
                    info += " Server Key Exchange";
                    break;
                }
                case 14:{
                    info += " Server Hello Done";
                    break;
                }
                default:break;
                }
                break;
            }
            case 23:{
                info = "Application Data";
                break;
            }
            default:{
                break;
            }
            }
            return type;
        }else type = 7;
    }

    if(type == 7){
        info = "Continuation Data";
    }
    else{
        info += QString::number(src) + proSend+ "-&gt;" + QString::number(des) + proRecv;
        QString flag = "";
        if(tcp-&gt;flags &amp; 0x08) flag += "PSH,";
        if(tcp-&gt;flags &amp; 0x10) flag += "ACK,";
        if(tcp-&gt;flags &amp; 0x02) flag += "SYN,";
        if(tcp-&gt;flags &amp; 0x20) flag += "URG,";
        if(tcp-&gt;flags &amp; 0x01) flag += "FIN,";
        if(tcp-&gt;flags &amp; 0x04) flag += "RST,";
        if(flag != ""){
            flag = flag.left(flag.length()-1);
            info += " [" + flag + "]";
        }
        u_int sequeue = ntohl(tcp-&gt;sequence);
        u_int ack = ntohl(tcp-&gt;ack);
        u_short window = ntohs(tcp-&gt;window_size);
        info += " Seq=" + QString::number(sequeue) + " Ack=" + QString::number(ack) + " win=" + QString::number(window) + " Len=" + QString::number(tcpPayLoad);
    }
    return type;
}

int Capture::udpPackageHandle(const u_char *pkt_content,QString&amp;info){
    UDP_HEADER * udp;
    udp = (UDP_HEADER*)(pkt_content + 14 + 20);
    u_short desPort = ntohs(udp-&gt;des_port);
    u_short srcPort = ntohs(udp-&gt;src_port);
    if(desPort == 53){ // dns query
        info =  dnsPackageHandle(pkt_content);
        return 5;
    }
    else if(srcPort == 53){// dns reply
        info =  dnsPackageHandle(pkt_content);
        return 5;
    }
    else{
        QString res = QString::number(srcPort) + "-&gt;" + QString::number(desPort);
        res += " len=" + QString::number(ntohs(udp-&gt;data_length));
        info = res;
        return 4;
    }
}

QString Capture::arpPackageHandle(const u_char *pkt_content){
    ARP_HEADER*arp;
    arp = (ARP_HEADER*)(pkt_content + 14);
    u_short op = ntohs(arp-&gt;op_code);
    QString res = "";
    u_char*addr = arp-&gt;des_ip_addr;

    QString desIp = QString::number(*addr) + "."
            + QString::number(*(addr+1)) + "."
            + QString::number(*(addr+2)) + "."
            + QString::number(*(addr+3));

    addr = arp-&gt;src_ip_addr;
    QString srcIp = QString::number(*addr) + "."
            + QString::number(*(addr+1)) + "."
            + QString::number(*(addr+2)) + "."
            + QString::number(*(addr+3));

    u_char* srcEthTemp = arp-&gt;src_eth_addr;
    QString srcEth = byteToHex(srcEthTemp,1) + ":"
            + byteToHex((srcEthTemp+1),1) + ":"
            + byteToHex((srcEthTemp+2),1) + ":"
            + byteToHex((srcEthTemp+3),1) + ":"
            + byteToHex((srcEthTemp+4),1) + ":"
            + byteToHex((srcEthTemp+5),1);

    switch (op){
    case 1:{
        res  = "Who has " + desIp + "? Tell " + srcIp;
        break;
    }
    case 2:{
        res = srcIp + " is at " + srcEth;
        break;
    }
    default:break;
    }
    return res;
}

QString Capture::dnsPackageHandle(const u_char *pkt_content){
    DNS_HEADER*dns;
    dns = (DNS_HEADER*)(pkt_content + 14 + 20 + 8);
    u_short identification = ntohs(dns-&gt;identification);
    u_short type = ntohs(dns-&gt;flags);
    QString info = "";
    if((type &amp; 0xf800) == 0x0000){
        info = "Standard query ";
    }
    else if((type &amp; 0xf800) == 0x8000){
        info = "Standard query response ";
    }
    QString name = "";
    char*domain = (char*)(pkt_content + 14 + 20 + 8 + 12);
    while(*domain != 0x00){
        if(domain &amp;&amp; (*domain) &lt;= 64){
            int length = *domain;
            domain++;
            for(int k = 0;k &lt; length;k++){
                name += (*domain);
                domain++;
            }
            name += ".";
        }else break;
    }
    // DNS_QUESITON *qus = (DNS_QUESITON*)(pkt_content + 14 + 20 + 8 + 12 + stringLength);
    // qDebug()&lt;&lt;ntohs(qus-&gt;query_type);
    // qDebug()&lt;&lt;ntohs(qus-&gt;query_class);
    name = name.left(name.length()-1);
    return info + "0x" + QString::number(identification,16) + " " + name;
}
</code></pre> 
<p>4、datapackage.h</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">DATAPACKAGE_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DATAPACKAGE_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QString&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Format.h"</span></span>


<span class="token comment">/*
 * This class is describe the data package infomation
 * +-----+------------+
 * | type| infomation |
 * +-----+------------+
 * |  1  |    arp     |
 * +-----+------------+
 * |  2  |    icmp    |
 * +-----+------------+
 * |  3  |    tcp     |
 * +-----+------------+
 * |  4  |    udp     |
 * +-----+------------+
 * |  5  |    dns     |
 * +-----+------------+
 * |  6  |    tls     |
 * +-----+------------+
 * |  7  |    ssl     |
 * +-----+------------+
*/</span>
<span class="token keyword">class</span> <span class="token class-name">DataPackage</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
    u_int data_length<span class="token punctuation">;</span> <span class="token comment">// data pakage length</span>
    QString timeStamp<span class="token punctuation">;</span> <span class="token comment">// timestamp of package</span>
    QString info<span class="token punctuation">;</span>      <span class="token comment">// a breif introduction of package</span>
    <span class="token keyword">int</span> packageType<span class="token punctuation">;</span>   <span class="token comment">// type</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">;</span> <span class="token comment">// root pointer of package data</span>

<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token comment">/*
     * turn the byteArray to QString
    */</span>
    <span class="token keyword">static</span> QString <span class="token function">byteToHex</span><span class="token punctuation">(</span>u_char<span class="token operator">*</span>str<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// Construction and destruction</span>
    <span class="token function">DataPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">DataPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>

    <span class="token comment">// set the var</span>
    <span class="token keyword">void</span> <span class="token function">setDataLength</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// set the package length</span>
    <span class="token keyword">void</span> <span class="token function">setTimeStamp</span><span class="token punctuation">(</span>QString timeStamp<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">// set timestamp</span>
    <span class="token keyword">void</span> <span class="token function">setPackageType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token comment">// set package type</span>
    <span class="token keyword">void</span> <span class="token function">setPackagePointer</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// set package pointer</span>
    <span class="token keyword">void</span> <span class="token function">setPackageInfo</span><span class="token punctuation">(</span>QString info<span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment">// set package information</span>

    <span class="token comment">// get the var</span>
    QString <span class="token function">getDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get package length</span>
    QString <span class="token function">getTimeStamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// get timestamp</span>
    QString <span class="token function">getPackageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// get package type</span>
    QString <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// get a breif package information</span>
    QString <span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// get the source address of package</span>
    QString <span class="token function">getDestination</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// get the destination address of package</span>

    <span class="token comment">// get the mac info</span>
    QString <span class="token function">getDesMacAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get the destination MAC address</span>
    QString <span class="token function">getSrcMacAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get the source MAC address</span>
    QString <span class="token function">getMacType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// get the type of MAC address</span>

    <span class="token comment">// get the ip info</span>
    QString <span class="token function">getDesIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// get the destination ip address</span>
    QString <span class="token function">getSrcIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// get the source ip address</span>
    QString <span class="token function">getIpVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// get the ip version</span>
    QString <span class="token function">getIpHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// get the ip head length</span>
    QString <span class="token function">getIpTos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">// get the ip tos</span>
    QString <span class="token function">getIpTotalLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// get the ip total package length</span>
    QString <span class="token function">getIpIdentification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// get the ip identification</span>
    QString <span class="token function">getIpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// get the ip flag</span>
    QString <span class="token function">getIpReservedBit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// the reserved bit</span>
    QString <span class="token function">getIpDF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// Don't fragment</span>
    QString <span class="token function">getIpMF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// More fragment</span>
    QString <span class="token function">getIpFragmentOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// get the offset of package</span>
    QString <span class="token function">getIpTTL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">// get ip ttl [time to live]</span>
    QString <span class="token function">getIpProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get the ip protocol</span>
    QString <span class="token function">getIpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get the checksum</span>

    <span class="token comment">// get the icmp info</span>
    QString <span class="token function">getIcmpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// get the icmp type</span>
    QString <span class="token function">getIcmpCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// get the icmp code</span>
    QString <span class="token function">getIcmpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// get the icmp checksum</span>
    QString <span class="token function">getIcmpIdentification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// get the icmp identification</span>
    QString <span class="token function">getIcmpSequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// get the icmp sequence</span>
    QString <span class="token function">getIcmpData</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// get the icmp data</span>

    <span class="token comment">// get the arp info</span>
    QString <span class="token function">getArpHardwareType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// get arp hardware type</span>
    QString <span class="token function">getArpProtocolType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// get arp protocol type</span>
    QString <span class="token function">getArpHardwareLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// get arp hardware length</span>
    QString <span class="token function">getArpProtocolLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// get arp protocol length</span>
    QString <span class="token function">getArpOperationCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// get arp operation code</span>
    QString <span class="token function">getArpSourceEtherAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// get arp source ethernet address</span>
    QString <span class="token function">getArpSourceIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// get arp souce ip address</span>
    QString <span class="token function">getArpDestinationEtherAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// get arp destination ethernet address</span>
    QString <span class="token function">getArpDestinationIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// get arp destination ip address</span>

    <span class="token comment">// get the tcp info</span>
    QString <span class="token function">getTcpSourcePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// get tcp source port</span>
    QString <span class="token function">getTcpDestinationPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// get tcp destination port</span>
    QString <span class="token function">getTcpSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// get tcp sequence</span>
    QString <span class="token function">getTcpAcknowledgment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// get acknowlegment</span>
    QString <span class="token function">getTcpHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// get tcp head length</span>
    QString <span class="token function">getTcpRawHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// get tcp raw head length [default is 0x05]</span>
    QString <span class="token function">getTcpFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// get tcp flags</span>
    QString <span class="token function">getTcpPSH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// PSH flag</span>
    QString <span class="token function">getTcpACK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// ACK flag</span>
    QString <span class="token function">getTcpSYN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// SYN flag</span>
    QString <span class="token function">getTcpURG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// URG flag</span>
    QString <span class="token function">getTcpFIN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// FIN flag</span>
    QString <span class="token function">getTcpRST</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// RST flag</span>
    QString <span class="token function">getTcpWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// get tcp window size</span>
    QString <span class="token function">getTcpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// get tcp checksum</span>
    QString <span class="token function">getTcpUrgentPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// get tcp urgent pointer</span>
    QString <span class="token function">getTcpOperationKind</span><span class="token punctuation">(</span><span class="token keyword">int</span> kind<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// get tcp option kind</span>
    <span class="token keyword">int</span> <span class="token function">getTcpOperationRawKind</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// get tcp raw option kind</span>

    <span class="token comment">/*
     * tcp optional parts
    */</span>
    <span class="token keyword">bool</span> <span class="token function">getTcpOperationMSS</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span> mss<span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment">// kind = 2</span>
    <span class="token keyword">bool</span> <span class="token function">getTcpOperationWSOPT</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>shit<span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">// kind = 3</span>
    <span class="token keyword">bool</span> <span class="token function">getTcpOperationSACKP</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>                                     <span class="token comment">// kind = 4</span>
    <span class="token keyword">bool</span> <span class="token function">getTcpOperationSACK</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_int<span class="token operator">&gt;</span><span class="token operator">&amp;</span>edge<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// kind = 5</span>
    <span class="token keyword">bool</span> <span class="token function">getTcpOperationTSPOT</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_int<span class="token operator">&amp;</span> value<span class="token punctuation">,</span>u_int<span class="token operator">&amp;</span>reply<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// kind = 8</span>

    <span class="token comment">// get the udp info</span>
    QString <span class="token function">getUdpSourcePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// get udp source port</span>
    QString <span class="token function">getUdpDestinationPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// get udp destination port</span>
    QString <span class="token function">getUdpDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// get udp data length</span>
    QString <span class="token function">getUdpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// get udp checksum</span>

    <span class="token comment">// get the dns info</span>
    QString <span class="token function">getDnsTransactionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// get dns transaction id</span>
    QString <span class="token function">getDnsFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// get dns flags</span>
    QString <span class="token function">getDnsFlagsQR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get dns flag QR</span>
    QString <span class="token function">getDnsFlagsOpcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// get dns flag operation code</span>
    QString <span class="token function">getDnsFlagsAA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get dns flag AA</span>
    QString <span class="token function">getDnsFlagsTC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get dns flag TC</span>
    QString <span class="token function">getDnsFlagsRD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get dns flag RD</span>
    QString <span class="token function">getDnsFlagsRA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// get dns flag RA</span>
    QString <span class="token function">getDnsFlagsZ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// get dns flag Z [reserved]</span>
    QString <span class="token function">getDnsFlagsRcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// get dns flag Rcode</span>
    QString <span class="token function">getDnsQuestionNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// get dns question number</span>
    QString <span class="token function">getDnsAnswerNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// get dns answer number</span>
    QString <span class="token function">getDnsAuthorityNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// get dns authority number</span>
    QString <span class="token function">getDnsAdditionalNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// get dns addition number</span>
    <span class="token keyword">void</span> <span class="token function">getDnsQueriesDomain</span><span class="token punctuation">(</span>QString<span class="token operator">&amp;</span>name<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>Type<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>Class<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString <span class="token function">getDnsDomainType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString <span class="token function">getDnsDomainName</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">getDnsAnswersDomain</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>name1<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>Type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span> Class<span class="token punctuation">,</span>u_int<span class="token operator">&amp;</span>ttl<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>dataLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> name2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// get the tls info</span>
    <span class="token keyword">bool</span> <span class="token function">getisTlsProtocol</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsBasicInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>contentType<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>version<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsClientHelloInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>handShakeType<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span> length<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>version<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>random<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>sessionIdLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>sessionId<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>cipherLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span><span class="token operator">&amp;</span>cipherSuit<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span> cmLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span><span class="token operator">&amp;</span>CompressionMethod<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsServerHelloInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>handShakeType<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>version<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> random<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>sessionIdLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>sessionId<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>cipherSuit<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>compressionMethod<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsServerKeyExchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>handShakeType<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>curveType<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>curveName<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>pubLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>pubKey<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>sigAlgorithm<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>sigLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
    u_short <span class="token function">getTlsExtensionType</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/*
     * these functions are used to parse the extension parts
     * extension parts are common in handshake parts (client hello,server hello ...)
     * there are some extension types are not included in, maybe you should refer the official API
    */</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionServerName</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>listLength<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>nameType<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>nameLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionSignatureAlgorithms</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>algorithmLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span><span class="token operator">&amp;</span>signatureAlgorithm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionSupportGroups</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>groupListLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span><span class="token operator">&amp;</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionEcPointFormats</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span> ecLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span><span class="token operator">&amp;</span>EC<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionSessionTicket</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionEncryptThenMac</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionSupportVersions</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>supportLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span><span class="token operator">&amp;</span>supportVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionPskKeyExchangeModes</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>modeLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span><span class="token operator">&amp;</span>mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionKeyShare</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>shareLength<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>group<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>exchangeLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionOther</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionExtendMasterSecret</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">getTlsExtensionPadding</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>type<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/*
     * when transfer data,some types will be encoded,like using 0x01 to represent the MD5 in extension hash part
     * to visual display these types,we need to decode and analysis
     * this functions are used to do these analisis
     * however,some types may be the custom types, so we can't decode
     * also,there are some rules not be included, maybe you should refer the official API
    */</span>
    <span class="token comment">// Parsing the encode data</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment">// Parsing TLS handshake type</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsContentType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment">// Parsing TLS content type</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsVersion</span><span class="token punctuation">(</span><span class="token keyword">int</span> version<span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">// Parsing TLS version</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHandshakeCipherSuites</span><span class="token punctuation">(</span>u_short code<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// Parsing TLS cipher suite</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHandshakeCompression</span><span class="token punctuation">(</span>u_char code<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// Parsing TLS compression</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>u_short type<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// Parsing TLS extension</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHandshakeExtensionECPointFormat</span><span class="token punctuation">(</span>u_char type<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Parsing TLS EC point format</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHandshakeExtensionSupportGroup</span><span class="token punctuation">(</span>u_short type<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Parsing TLS support group</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHadshakeExtensionSignature</span><span class="token punctuation">(</span>u_char type<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// Parsing TLS signature</span>
    <span class="token keyword">static</span> QString <span class="token function">getTlsHadshakeExtensionHash</span><span class="token punctuation">(</span>u_char type<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// Parsing TLS hash</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// DATAPACKAGE_H</span></span>
</code></pre> 
<p>5、datapackage.cpp</p> 
<pre><code class="prism language-cpp">	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"datapackage.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMetaType&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"winsock.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QVector&gt;</span></span>

<span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">DataPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// register the DataPackage type then</span>
    <span class="token generic-function"><span class="token function">qRegisterMetaType</span><span class="token generic class-name"><span class="token operator">&lt;</span>DataPackage<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"DataPackage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>timeStamp <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>data_length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>packageType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>pkt_content <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">setDataLength</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>data_length <span class="token operator">=</span> length<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">setTimeStamp</span><span class="token punctuation">(</span>QString timeStamp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>timeStamp <span class="token operator">=</span> timeStamp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">setPackageType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>packageType <span class="token operator">=</span> type<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">setPackagePointer</span><span class="token punctuation">(</span><span class="token keyword">const</span> u_char <span class="token operator">*</span>pkt_content<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>pkt_content <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>pkt_content <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
        <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">,</span>pkt_content<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>pkt_content <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    <span class="token comment">//  Do not use  `this-&gt;pkt_content = pkt_content;`</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">setPackageInfo</span><span class="token punctuation">(</span>QString info<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>info <span class="token operator">=</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">byteToHex</span><span class="token punctuation">(</span>u_char <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    QString res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span> one <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>one <span class="token operator">&gt;=</span> <span class="token number">0x0A</span><span class="token punctuation">)</span>
            one <span class="token operator">=</span> one <span class="token operator">+</span> <span class="token number">0x41</span> <span class="token operator">-</span> <span class="token number">0x0A</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> one <span class="token operator">=</span> one <span class="token operator">+</span> <span class="token number">0x30</span><span class="token punctuation">;</span>
        <span class="token keyword">char</span> two <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>two <span class="token operator">&gt;=</span> <span class="token number">0x0A</span><span class="token punctuation">)</span>
            two <span class="token operator">=</span> two  <span class="token operator">+</span> <span class="token number">0x41</span> <span class="token operator">-</span> <span class="token number">0x0A</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> two <span class="token operator">=</span> two <span class="token operator">+</span> <span class="token number">0x30</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>one<span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>two<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTimeStamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>timeStamp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>data_length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getPackageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>packageType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> ARP<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> ICMP<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span><span class="token keyword">return</span> TCP<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span><span class="token keyword">return</span> UDP<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span><span class="token keyword">return</span> DNS<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span><span class="token keyword">return</span> TLS<span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span><span class="token keyword">return</span> SSL<span class="token punctuation">;</span>
    <span class="token comment">// TODU ...more protocol you can add</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>packageType <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">getArpSourceIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">getSrcIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDestination</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>packageType <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">getArpDestinationIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token function">getDesIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* Ether */</span>
<span class="token comment">/********************** get destination ethenet address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDesMacAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ETHER_HEADER<span class="token operator">*</span>ethernet<span class="token punctuation">;</span>
    ethernet <span class="token operator">=</span> <span class="token punctuation">(</span>ETHER_HEADER<span class="token operator">*</span><span class="token punctuation">)</span>pkt_content<span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>addr<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ethernet<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        addr <span class="token operator">=</span> ethernet<span class="token operator">-&gt;</span>ether_des_host<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            QString res <span class="token operator">=</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token string">"FF:FF:FF:FF:FF:FF"</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"FF:FF:FF:FF:FF:FF(Broadcast)"</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get source ethenet address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getSrcMacAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ETHER_HEADER<span class="token operator">*</span>ethernet<span class="token punctuation">;</span>
    ethernet <span class="token operator">=</span> <span class="token punctuation">(</span>ETHER_HEADER<span class="token operator">*</span><span class="token punctuation">)</span>pkt_content<span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>addr<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ethernet<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        addr <span class="token operator">=</span> ethernet<span class="token operator">-&gt;</span>ether_src_host<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            QString res <span class="token operator">=</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token string">"FF:FF:FF:FF:FF:FF"</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"FF:FF:FF:FF:FF:FF(Broadcast)"</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ethenet type **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getMacType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ETHER_HEADER<span class="token operator">*</span>ethernet<span class="token punctuation">;</span>
    ethernet <span class="token operator">=</span> <span class="token punctuation">(</span>ETHER_HEADER<span class="token operator">*</span><span class="token punctuation">)</span>pkt_content<span class="token punctuation">;</span>
    u_short ethernet_type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>ethernet<span class="token operator">-&gt;</span>ether_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ethernet_type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0x0800</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"IPv4(0x800)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0806</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"ARP(0x0806)"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* ip */</span>
<span class="token comment">/********************** get destination ip address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDesIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sockaddr_in desAddr<span class="token punctuation">;</span>
    desAddr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> ip<span class="token operator">-&gt;</span>des_addr<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">QString</span><span class="token punctuation">(</span><span class="token function">inet_ntoa</span><span class="token punctuation">(</span>desAddr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get source ip address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getSrcIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sockaddr_in srcAddr<span class="token punctuation">;</span>
    srcAddr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> ip<span class="token operator">-&gt;</span>src_addr<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">QString</span><span class="token punctuation">(</span><span class="token function">inet_ntoa</span><span class="token punctuation">(</span>srcAddr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip version **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>versiosn_head_length <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip header length **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> length <span class="token operator">=</span> ip<span class="token operator">-&gt;</span>versiosn_head_length <span class="token operator">&amp;</span> <span class="token number">0x0F</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token string">"20 bytes (5)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> res <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"bytes ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/********************** get ip TOS **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpTos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>TOS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip total length **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpTotalLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>total_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip indentification **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpIdentification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>identification<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip flag **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>flag_offset<span class="token punctuation">)</span><span class="token operator">&amp;</span> <span class="token number">0xe000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip reverse bit **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpReservedBit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> bit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>flag_offset<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>bit<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip DF flag[Don't Fragment] **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpDF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>flag_offset<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x4000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip MF flag[More Fragment] **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpMF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>flag_offset<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x2000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip Fragment Offset **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpFragmentOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>flag_offset<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1FFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip TTL **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpTTL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>ttl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip protocol **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> protocol <span class="token operator">=</span> ip<span class="token operator">-&gt;</span>protocol<span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>protocol<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"ICMP (1)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TCP (6)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">17</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"UDP (17)"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get ip checksum **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    IP_HEADER<span class="token operator">*</span>ip<span class="token punctuation">;</span>
    ip <span class="token operator">=</span> <span class="token punctuation">(</span>IP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>ip<span class="token operator">-&gt;</span>checksum<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* icmp */</span>
<span class="token comment">/********************** get icmp type **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIcmpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ICMP_HEADER<span class="token operator">*</span>icmp<span class="token punctuation">;</span>
    icmp <span class="token operator">=</span> <span class="token punctuation">(</span>ICMP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>icmp<span class="token operator">-&gt;</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get icmp code **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIcmpCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ICMP_HEADER<span class="token operator">*</span>icmp<span class="token punctuation">;</span>
    icmp <span class="token operator">=</span> <span class="token punctuation">(</span>ICMP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>icmp<span class="token operator">-&gt;</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token comment">/********************** get icmp checksum **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIcmpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ICMP_HEADER<span class="token operator">*</span>icmp<span class="token punctuation">;</span>
    icmp <span class="token operator">=</span> <span class="token punctuation">(</span>ICMP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>icmp<span class="token operator">-&gt;</span>checksum<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get icmp identification **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIcmpIdentification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ICMP_HEADER<span class="token operator">*</span>icmp<span class="token punctuation">;</span>
    icmp <span class="token operator">=</span> <span class="token punctuation">(</span>ICMP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>icmp<span class="token operator">-&gt;</span>identification<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get icmp sequence **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIcmpSequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ICMP_HEADER<span class="token operator">*</span>icmp<span class="token punctuation">;</span>
    icmp <span class="token operator">=</span> <span class="token punctuation">(</span>ICMP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>icmp<span class="token operator">-&gt;</span>sequence<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getIcmpData</span><span class="token punctuation">(</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span><span class="token operator">*</span>icmp<span class="token punctuation">;</span>
    icmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString res<span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        res <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>icmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        icmp<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* arp info */</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpHardwareType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>arp<span class="token operator">-&gt;</span>hardware_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">0x0001</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token string">"Ethernet(1)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> res <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp protocol type **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpProtocolType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>arp<span class="token operator">-&gt;</span>protocol_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">0x0800</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token string">"IPv4(0x0800)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> res <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get hardware length **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpHardwareLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>arp<span class="token operator">-&gt;</span>mac_length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp protocol length **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpProtocolLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>arp<span class="token operator">-&gt;</span>ip_length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp operator code **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpOperationCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> code <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>arp<span class="token operator">-&gt;</span>op_code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> res  <span class="token operator">=</span> <span class="token string">"request(1)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>code <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> res <span class="token operator">=</span> <span class="token string">"reply(2)"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp source ethernet address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpSourceEtherAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>addr<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        addr <span class="token operator">=</span> arp<span class="token operator">-&gt;</span>src_eth_addr<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            QString res <span class="token operator">=</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp destination ethernet address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpDestinationEtherAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>addr<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        addr <span class="token operator">=</span> arp<span class="token operator">-&gt;</span>des_eth_addr<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            QString res <span class="token operator">=</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> <span class="token function">byteToHex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> res<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp source ip address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpSourceIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        u_char<span class="token operator">*</span>addr <span class="token operator">=</span> arp<span class="token operator">-&gt;</span>src_ip_addr<span class="token punctuation">;</span>
        QString srcIp <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>addr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span>
                <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span>
                <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span>
                <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> srcIp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get arp destination ip address **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getArpDestinationIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ARP_HEADER<span class="token operator">*</span>arp<span class="token punctuation">;</span>
    arp <span class="token operator">=</span> <span class="token punctuation">(</span>ARP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arp<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        u_char<span class="token operator">*</span>addr <span class="token operator">=</span> arp<span class="token operator">-&gt;</span>des_ip_addr<span class="token punctuation">;</span>
        QString desIp <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>addr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span>
                <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span>
                <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span>
                <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>addr<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> desIp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* tcp */</span>
<span class="token comment">/********************** get tcp source port **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpSourcePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> port <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>src_port<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>port <span class="token operator">==</span> <span class="token number">443</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"https(443)"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp destination port **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpDestinationPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> port <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>des_port<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>port <span class="token operator">==</span> <span class="token number">443</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"https(443)"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp sequence **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohl</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>sequence<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp acknowledgment **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpAcknowledgment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohl</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>ack<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp header length **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>header_length <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"20 bytes (5)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" bytes ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpRawHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>header_length <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/********************** get tcp flags **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/********************** get tcp PSH **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpPSH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x08</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp ACK **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpACK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x10</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp SYN **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpSYN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x02</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp UGR **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpURG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x20</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp FIN **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpFIN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp RST **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpRST</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x04</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp window size **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>window_size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp checksum **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>checksum<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tcp urgent pointer **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpUrgentPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    TCP_HEADER<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>TCP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>tcp<span class="token operator">-&gt;</span>urgent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationKind</span><span class="token punctuation">(</span><span class="token keyword">int</span> kind<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>kind<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"EOL"</span><span class="token punctuation">;</span>              <span class="token comment">// end of list</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"NOP"</span><span class="token punctuation">;</span>              <span class="token comment">// no operation</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"MSS"</span><span class="token punctuation">;</span>              <span class="token comment">// max segment</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"WSOPT"</span><span class="token punctuation">;</span>            <span class="token comment">// window scaling factor</span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SACK-Premitted"</span><span class="token punctuation">;</span>   <span class="token comment">// support SACK</span>
    <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SACK"</span><span class="token punctuation">;</span>             <span class="token comment">// SACK Block</span>
    <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TSPOT"</span><span class="token punctuation">;</span>            <span class="token comment">// Timestamps</span>
    <span class="token keyword">case</span> <span class="token number">19</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TCP-MD5"</span><span class="token punctuation">;</span>         <span class="token comment">// MD5</span>
    <span class="token keyword">case</span> <span class="token number">28</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"UTP"</span><span class="token punctuation">;</span>             <span class="token comment">// User Timeout</span>
    <span class="token keyword">case</span> <span class="token number">29</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TCP-AO"</span><span class="token punctuation">;</span>          <span class="token comment">// authenticated</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationRawKind</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationSACK</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span>length<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_int<span class="token operator">&gt;</span><span class="token operator">&amp;</span>edge<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        tcp<span class="token operator">++</span><span class="token punctuation">;</span>
        length <span class="token operator">=</span> <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
        tcp<span class="token operator">++</span><span class="token punctuation">;</span>
        u_int<span class="token operator">*</span> pointer <span class="token operator">=</span> <span class="token punctuation">(</span>u_int<span class="token operator">*</span><span class="token punctuation">)</span>tcp<span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            u_int temp <span class="token operator">=</span> <span class="token function">htonl</span><span class="token punctuation">(</span><span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            edge<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pointer<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationMSS</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>mss<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        tcp<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            tcp<span class="token operator">++</span><span class="token punctuation">;</span>
            u_short<span class="token operator">*</span> Mss <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span>tcp<span class="token punctuation">;</span>
            mss <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>Mss<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationSACKP</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationWSOPT</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>shit<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        tcp<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            tcp<span class="token operator">++</span><span class="token punctuation">;</span>
            shit <span class="token operator">=</span> <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTcpOperationTSPOT</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_int <span class="token operator">&amp;</span>value<span class="token punctuation">,</span> u_int <span class="token operator">&amp;</span>reply<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char <span class="token operator">*</span>tcp<span class="token punctuation">;</span>
    tcp <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        tcp<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>tcp <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            tcp<span class="token operator">++</span><span class="token punctuation">;</span>
            u_int <span class="token operator">*</span>pointer <span class="token operator">=</span> <span class="token punctuation">(</span>u_int<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>tcp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            value <span class="token operator">=</span> <span class="token function">ntohl</span><span class="token punctuation">(</span><span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pointer<span class="token operator">++</span><span class="token punctuation">;</span>
            reply <span class="token operator">=</span> <span class="token function">ntohl</span><span class="token punctuation">(</span><span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* udp */</span>
<span class="token comment">/********************** get udp source port **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getUdpSourcePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    UDP_HEADER<span class="token operator">*</span>udp<span class="token punctuation">;</span>
    udp <span class="token operator">=</span> <span class="token punctuation">(</span>UDP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> port <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>udp<span class="token operator">-&gt;</span>src_port<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>port <span class="token operator">==</span> <span class="token number">53</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"domain(53)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get udp destination port **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getUdpDestinationPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    UDP_HEADER<span class="token operator">*</span>udp<span class="token punctuation">;</span>
    udp <span class="token operator">=</span> <span class="token punctuation">(</span>UDP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> port <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>udp<span class="token operator">-&gt;</span>des_port<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>port <span class="token operator">==</span> <span class="token number">53</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"domain(53)"</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get udp data length **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getUdpDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    UDP_HEADER<span class="token operator">*</span>udp<span class="token punctuation">;</span>
    udp <span class="token operator">=</span> <span class="token punctuation">(</span>UDP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>udp<span class="token operator">-&gt;</span>data_length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token comment">/********************** get udp checksum **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getUdpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    UDP_HEADER<span class="token operator">*</span>udp<span class="token punctuation">;</span>
    udp <span class="token operator">=</span> <span class="token punctuation">(</span>UDP_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>udp<span class="token operator">-&gt;</span>checksum<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* dns */</span>
<span class="token comment">/********************** get dns transaction **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsTransactionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>identification<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns flag **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString info <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>type <span class="token operator">&amp;</span> <span class="token number">0xf800</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x0000</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        info <span class="token operator">=</span> <span class="token string">"(Standard query)"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>type <span class="token operator">&amp;</span> <span class="token number">0xf800</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x8000</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        info <span class="token operator">=</span> <span class="token string">"(Standard query response)"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns QR **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsQR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Operation code **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsOpcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x7800</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns AA **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsAA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0400</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns TC **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsTC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0200</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns RD **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsRD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0100</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns RA **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsRA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0080</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Z(reserved) **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsZ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0070</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Response code **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsFlagsRcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>flags<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x000f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Question number **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsQuestionNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>question<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Answer number **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsAnswerNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Authority number **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsAuthorityNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>authority<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns Additional number **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsAdditionalNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span>dns<span class="token operator">-&gt;</span>additional<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns query result **********************/</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsQueriesDomain</span><span class="token punctuation">(</span>QString<span class="token operator">&amp;</span>name<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>Type<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span>Class<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    DNS_HEADER<span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_HEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span><span class="token operator">*</span>domain <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>domain <span class="token operator">!=</span> <span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>domain <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">*</span>domain<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token operator">*</span>domain<span class="token punctuation">;</span>
            domain<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> length<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                name <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
                domain<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            name <span class="token operator">+=</span> <span class="token string">"."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    domain<span class="token operator">++</span><span class="token punctuation">;</span>
    name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    DNS_QUESITON <span class="token operator">*</span>qus <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_QUESITON<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>qus<span class="token operator">-&gt;</span>query_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Class <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>qus<span class="token operator">-&gt;</span>query_class<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns domian name **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsDomainName</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span><span class="token operator">*</span>dns<span class="token punctuation">;</span>
    dns <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>dns <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>dns <span class="token operator">!=</span> <span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token operator">*</span>dns<span class="token punctuation">;</span>
            dns<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>length<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                name <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
                dns<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            name <span class="token operator">+=</span> <span class="token string">"."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xc0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xc0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> accOffset <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dns<span class="token operator">++</span><span class="token punctuation">;</span>
            accOffset <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
            name <span class="token operator">+=</span> <span class="token function">getDnsDomainName</span><span class="token punctuation">(</span>accOffset<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">;</span>
            dns<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns answer result **********************/</span>
<span class="token keyword">int</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsAnswersDomain</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>name1<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>Type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>Class<span class="token punctuation">,</span> u_int <span class="token operator">&amp;</span>ttl<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>dataLength<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>name2<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span><span class="token operator">*</span>dns <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xc0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xc0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> accOffset <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dns<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//</span>
        accOffset <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
        name1 <span class="token operator">=</span> <span class="token function">getDnsDomainName</span><span class="token punctuation">(</span>accOffset<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dns<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//</span>
        DNS_ANSWER<span class="token operator">*</span>answer <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_ANSWER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>answer_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Class <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>answer_class<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ttl <span class="token operator">=</span> <span class="token function">ntohl</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>TTL<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>dataLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dns <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dataLength <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                name2 <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                name2 <span class="token operator">+=</span> <span class="token string">"."</span><span class="token punctuation">;</span>
                dns<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>dataLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token operator">*</span>dns<span class="token punctuation">;</span>
                    dns<span class="token operator">++</span><span class="token punctuation">;</span>
                    k<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        name2 <span class="token operator">+=</span> <span class="token operator">*</span>dns<span class="token punctuation">;</span>
                        dns<span class="token operator">++</span><span class="token punctuation">;</span>
                        k<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    name2 <span class="token operator">+=</span> <span class="token string">"."</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xc0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xc0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> accOffset <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dns<span class="token operator">++</span><span class="token punctuation">;</span>
                    k<span class="token operator">++</span><span class="token punctuation">;</span>
                    accOffset <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    name2 <span class="token operator">+=</span> <span class="token function">getDnsDomainName</span><span class="token punctuation">(</span>accOffset<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">;</span>
                    dns<span class="token operator">++</span><span class="token punctuation">;</span>
                    k<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        name2 <span class="token operator">=</span> name2<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span>name2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataLength <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        name1 <span class="token operator">=</span> <span class="token function">getDnsDomainName</span><span class="token punctuation">(</span>offset <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        DNS_ANSWER<span class="token operator">*</span>answer <span class="token operator">=</span> <span class="token punctuation">(</span>DNS_ANSWER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dns <span class="token operator">+</span> name1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>answer_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Class <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>answer_class<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ttl <span class="token operator">=</span> <span class="token function">ntohl</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>TTL<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>answer<span class="token operator">-&gt;</span>dataLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dataLength <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            dns <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> name1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                name2 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
                dns<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>dataLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token operator">*</span>dns<span class="token punctuation">;</span>
                    dns<span class="token operator">++</span><span class="token punctuation">;</span>
                    k<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        name2 <span class="token operator">+=</span> <span class="token operator">*</span>dns<span class="token punctuation">;</span>
                        dns<span class="token operator">++</span><span class="token punctuation">;</span>
                        k<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    name2 <span class="token operator">+=</span> <span class="token string">"."</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xc0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xc0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">int</span> accOffset <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dns<span class="token operator">++</span><span class="token punctuation">;</span>
                    k<span class="token operator">++</span><span class="token punctuation">;</span>
                    accOffset <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>dns<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    name2 <span class="token operator">+=</span> <span class="token function">getDnsDomainName</span><span class="token punctuation">(</span>accOffset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dns<span class="token operator">++</span><span class="token punctuation">;</span>
                    k<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        name2 <span class="token operator">=</span> name2<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span>name2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataLength <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> name1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get dns domain type **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getDnsDomainType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"A (Host Address)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"NS"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"CNAME (Canonical NAME for an alias)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SOA"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"WSK"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">12</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"PTR"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"HINFO"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">15</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"MX"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">28</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"AAAA"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">252</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"AXFR"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">255</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"ANY"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// tls</span>
<span class="token comment">/********************** get tls protocol to check the data is meet this format or not **********************/</span>
<span class="token keyword">bool</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getisTlsProtocol</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">char</span><span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    u_char type <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">&gt;=</span> <span class="token number">20</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">&lt;=</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        u_short <span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> version <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>version <span class="token operator">&gt;=</span> <span class="token number">0x0301</span> <span class="token operator">&amp;&amp;</span> version <span class="token operator">&lt;=</span> <span class="token number">0x0304</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls basic information **********************/</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsBasicInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>contentType<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>version<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    contentType <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_short<span class="token operator">*</span> pointer <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    version <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pointer<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>pointer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/********************** get tls handshake type **********************/</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls client hello information **********************/</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsClientHelloInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>handShakeType<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>version<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>random<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>sessionIdLength<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>sessionId<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>cipherLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>cipherSuit<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span> cmLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span><span class="token operator">&amp;</span>CompressionMethod<span class="token punctuation">,</span>u_short<span class="token operator">&amp;</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    handShakeType <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4096</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>ssl<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">256</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    u_short<span class="token operator">*</span> ver <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    version <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ver<span class="token operator">++</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        random <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    sessionIdLength <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> sessionIdLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        sessionId <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    u_short<span class="token operator">*</span> clen <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cipherLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>clen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    clen<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> cipherLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        cipherSuit<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>clen<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        clen<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ssl <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> cipherLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cmLength <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span>cmLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        CompressionMethod<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    extensionLength <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">256</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsServerHelloInfo</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>handShakeType<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>version<span class="token punctuation">,</span> QString<span class="token operator">&amp;</span> random<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>sessionIdLength<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>sessionId<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>cipherSuit<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>compressionMethod<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    handShakeType <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4096</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">256</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    u_short<span class="token operator">*</span> ver <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    version <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ver<span class="token operator">++</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        random <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    sessionIdLength <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> sessionIdLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        sessionId <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    u_short<span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cipherSuit <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    compressionMethod <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    extensionLength <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">256</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsServerKeyExchange</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>handShakeType<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>curveType<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>curveName<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>pubLength<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>pubKey<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>sigAlgorithm<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>sigLength<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>sig<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_char<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    handShakeType <span class="token operator">=</span> <span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4096</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">256</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>ssl <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    curveType <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_short<span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    curveName <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    pubLength <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> pubLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        pubKey <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    point <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sigAlgorithm <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    point<span class="token operator">++</span><span class="token punctuation">;</span>
    sigLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> sigLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        sig <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls handshake type **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Client Hello"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Server hello"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Certificate"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">16</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Client Key Exchange"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"New Session Ticket"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">12</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Server Key Exchange"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">14</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Server Hello Done"</span><span class="token punctuation">;</span>

    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls content type **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsContentType</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">20</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"Change Cipher Spec"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">21</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Alert"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">22</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Handshake"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">23</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Application Data"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls version **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsVersion</span><span class="token punctuation">(</span><span class="token keyword">int</span> version<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>version<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0x0300</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SSL 3.0"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0301</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TLS 1.0"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0302</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TLS 1.1"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0303</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TLS 1.2"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0304</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"TLS 1.3"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Unkonwn"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls handshake cipher suites **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeCipherSuites</span><span class="token punctuation">(</span>u_short code<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0x00ff</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_EMPTY_RENEGOTIATION_INFO_SCSV (0x00ff)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc02c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xc02c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc030</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xc030)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x009f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (0x009f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0ad</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_256_CCM (0xc0ad)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc09f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_256_CCM (0xc09f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc024</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 (0xc024)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc028</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (0xc028)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x006b</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 (0x006b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc00a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA (0xc00a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc014</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0039</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_256_CBC_SHA (0x0039)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0af</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 (0xc0af)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a3</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_256_CCM_8 (0xc0a3)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc087</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc087)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc08b</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc08b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc07d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc07d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc073</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc073)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc077</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc077)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00c4</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 (0x00c4)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0088</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA (0x0088)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc02b</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xc02b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc02f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x009e</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 (0x009e)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0ac</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_128_CCM (0xc0ac)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc09e</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_128_CCM (0xc09e)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc023</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 (0xc023)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc027</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (0xc027)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0067</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 (0x0067)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc009</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA (0xc009)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc013</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0033</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_128_CBC_SHA (0x0033)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0ae</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 (0xc0ae)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a2</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_AES_128_CCM_8 (0xc0a2)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc086</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc086)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc08a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc08a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc07c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc07c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc072</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc072)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc076</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc076)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00be</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0x00be)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0045</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA (0x0045)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc008</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA (0xc008)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc012</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA (0xc012)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0016</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA (0x0016)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00ab</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 (0x00ab)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a7</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_256_CCM (0xc0a7)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc038</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384 (0xc038)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00b3</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_256_CBC_SHA384 (0x00b3)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc036</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA (0xc036) "</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0091</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_256_CBC_SHA (0x0091)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc091</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384 (0xc091)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc09b</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc09b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc097</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc097)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0ab</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_DHE_WITH_AES_256_CCM_8 (0xc0ab)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00aa</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 (0x00aa)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a6</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_128_CCM (0xc0a6)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc037</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256 (0xc037)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00b2</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_128_CBC_SHA256 (0x00b2)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc035</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA (0xc035)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0090</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_AES_128_CBC_SHA (0x0090)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc090</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256 (0xc090)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc096</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc096)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc09a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc09a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0aa</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_DHE_WITH_AES_128_CCM_8 (0xc0aa)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc034</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA (0xc034)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x008f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA (0x008f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x009d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_256_GCM_SHA384 (0x009d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc09d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_256_CCM (0xc09d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x003d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_256_CBC_SHA256 (0x003d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0035</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_256_CBC_SHA (0x0035)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc032</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384 (0xc032)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc02a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384 (0xc02a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc00f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA (0xc00f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc02e</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384 (0xc02e)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc026</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384 (0xc026)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc005</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA (0xc005)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a1</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_256_CCM_8 (0xc0a1)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc07b</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc07b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00c0</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256 (0x00c0)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0084</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_CAMELLIA_256_CBC_SHA (0x0084)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc08d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc08d)  "</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc079</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc079)  "</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc089</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc089)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc075</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc075)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x009c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_128_GCM_SHA256 (0x009c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc09c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_128_CCM (0xc09c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x003c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_128_CBC_SHA256 (0x003c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x002f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_128_CBC_SHA (0x002f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc031</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256 (0xc031)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc029</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256 (0xc029)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc00e</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA (0xc00e)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc02d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256 (0xc02d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc025</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256 (0xc025)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc004</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA (0xc004)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a0</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_AES_128_CCM_8 (0xc0a0)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc07a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc07a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00ba</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0x00ba)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0041</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_CAMELLIA_128_CBC_SHA (0x0041)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc08c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc08c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc078</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc078)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc088</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc088)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc074</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc074)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x000a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_3DES_EDE_CBC_SHA (0x000a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc00d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA (0xc00d)  "</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc003</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA (0xc003)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00ad</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 (0x00ad)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00b7</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_AES_256_CBC_SHA384 (0x00b7)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0095</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_AES_256_CBC_SHA (0x0095)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc093</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384 (0xc093)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc099</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc099)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00ac</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 (0x00ac)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00b6</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_AES_128_CBC_SHA256 (0x00b6)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0094</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_AES_128_CBC_SHA (0x0094)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc092</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256 (0xc092)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc098</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc098)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0093</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA (0x0093)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00a9</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_256_GCM_SHA384 (0x00a9)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a5</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_256_CCM (0xc0a5)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00af</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_256_CBC_SHA384 (0x00af)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x008d</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_256_CBC_SHA (0x008d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc08f</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384 (0xc08f)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc095</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc095)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a9</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_256_CCM_8 (0xc0a9)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00a8</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_128_GCM_SHA256 (0x00a8)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a4</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_128_CCM (0xc0a4)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x00ae</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_128_CBC_SHA256 (0x00ae)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x008c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_128_CBC_SHA (0x008c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc08e</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256 (0xc08e)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc094</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc094)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc0a8</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_AES_128_CCM_8 (0xc0a8)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x008b</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_3DES_EDE_CBC_SHA (0x008b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc007</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA (0xc007)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc011</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_RC4_128_SHA (0xc011)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc033</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_PSK_WITH_RC4_128_SHA (0xc033)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x008e</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_PSK_WITH_RC4_128_SHA (0x008e) "</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0005</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_RC4_128_SHA (0x0005)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0004</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_WITH_RC4_128_MD5 (0x0004)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc00c</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_RSA_WITH_RC4_128_SHA (0xc00c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xc002</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDH_ECDSA_WITH_RC4_128_SHA (0xc002) "</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0092</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_RSA_PSK_WITH_RC4_128_SHA (0x0092)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x008a</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_PSK_WITH_RC4_128_SHA (0x008a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x1302</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_AES_256_GCM_SHA384 (0x1302)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x1303</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_CHACHA20_POLY1305_SHA256 (0x1303)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x1301</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_AES_128_GCM_SHA256 (0x1301)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xcca9</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 (0xcca9)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xcca8</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (0xcca8)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0xccaa</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (0xccaa)"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"0x"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/********************** get tls handshake compression **********************/</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeCompression</span><span class="token punctuation">(</span>u_char code<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"null"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>u_short type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"server_name"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">"status_request"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"ec_point_format"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"supported_groups"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">35</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"session_ticket"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">22</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"encrypt_then_mac"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">23</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"extended_master_secret"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"signature_algorithms"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">43</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"supported_versions"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">45</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"psk_key_exchange_modes"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">51</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"key_share"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">21</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"padding"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">18</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"signed_certificate_timestamp"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">39578</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Reserved (GREASE) (39578)"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Unknown type"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeExtensionECPointFormat</span><span class="token punctuation">(</span>u_char type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"EC point format: uncompressed (0)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"EC point format: ansiX962_compressed_prime (1)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"EC point format: ansiX962_compressed_char2 (2)"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHandshakeExtensionSupportGroup</span><span class="token punctuation">(</span>u_short type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">0x001d</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"x25519 (0x001d)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0017</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp256r1 (0x0017)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x001e</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"x448 (0x001e)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0019</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp521r1 (0x0019)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0018</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp384r1 (0x0018)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x001c</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"brainpoolP512r1 (0x001c)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x001b</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"brainpoolP384r1 (0x001b)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0016</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp256k1 (0x0016)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x001a</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"brainpoolP256r1 (0x001a)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0015</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp224r1 (0x0015)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0014</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp224k1 (0x0014)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0013</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp192r1 (0x0013)"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">0x0012</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"secp192k1 (0x0012)"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"0x"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHadshakeExtensionHash</span><span class="token punctuation">(</span>u_char type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SHA256"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SHA384"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SHA512"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SHA1"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"SHA224"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"MD5"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Unknown"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
QString <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsHadshakeExtensionSignature</span><span class="token punctuation">(</span>u_char type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"RSA"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"DSA"</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"ECDSA"</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">return</span> <span class="token string">"Unknown"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
u_short <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionType</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionServerName</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>listLength<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>nameType<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>nameLength<span class="token punctuation">,</span> QString <span class="token operator">&amp;</span>name<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    listLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span>ssl<span class="token punctuation">;</span>
    nameType <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
    p<span class="token operator">++</span><span class="token punctuation">;</span>
    nameLength <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> nameLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        name <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionKeyShare</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>shareLength<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>group<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>exchangeLength<span class="token punctuation">,</span>QString <span class="token operator">&amp;</span>exchange<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    shareLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    group <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    exchangeLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> exchangeLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        exchange <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        point<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionEcPointFormats</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span>u_char<span class="token operator">&amp;</span> ecLength<span class="token punctuation">,</span>QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>EC<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span> point <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ecLength <span class="token operator">=</span> <span class="token operator">*</span>point<span class="token punctuation">;</span>
    point<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> ecLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        EC<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
        point<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionOther</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        data <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        point<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionSupportGroups</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>groupListLength<span class="token punctuation">,</span> QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>group<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    groupListLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> groupListLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        group<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionSessionTicket</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionEncryptThenMac</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionExtendMasterSecret</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionSignatureAlgorithms</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>algorithmLength<span class="token punctuation">,</span> QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>signatureAlgorithm<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    algorithmLength <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> algorithmLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        signatureAlgorithm<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionSupportVersions</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span> u_char <span class="token operator">&amp;</span>supportLength<span class="token punctuation">,</span> QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>supportVersion<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    supportLength <span class="token operator">=</span> <span class="token operator">*</span>point<span class="token punctuation">;</span>
    point<span class="token operator">++</span><span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> supportLength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        supportVersion<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">DataPackage</span><span class="token double-colon punctuation">::</span><span class="token function">getTlsExtensionPadding</span><span class="token punctuation">(</span><span class="token keyword">int</span> offset<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> u_short <span class="token operator">&amp;</span>length<span class="token punctuation">,</span>QString<span class="token operator">&amp;</span> data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    u_short<span class="token operator">*</span>ssl<span class="token punctuation">;</span>
    ssl <span class="token operator">=</span> <span class="token punctuation">(</span>u_short<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pkt_content <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">ntohs</span><span class="token punctuation">(</span><span class="token operator">*</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ssl<span class="token operator">++</span><span class="token punctuation">;</span>
    u_char<span class="token operator">*</span>point <span class="token operator">=</span> <span class="token punctuation">(</span>u_char<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>ssl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        data <span class="token operator">+=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token operator">*</span>point<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        point<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>6、Format.h</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">FORMAT_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FORMAT_H</span></span>

<span class="token comment">/*
   @ This head file is used to define format of packages
   @ auther DJH-sudo
   @ if you have any question,pls contact me at djh113@126.com
*/</span>

<span class="token comment">// define some types and macro defination</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> u_char<span class="token punctuation">;</span>     <span class="token comment">// 1 byte</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">short</span> u_short<span class="token punctuation">;</span>   <span class="token comment">// 2 byte</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> u_int<span class="token punctuation">;</span>       <span class="token comment">// 4 byte</span>
<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> u_long<span class="token punctuation">;</span>     <span class="token comment">// 4 byte</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ARP</span>  <span class="token string">"ARP"</span>                 <span class="token comment">//</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TCP</span>  <span class="token string">"TCP"</span>                 <span class="token comment">//</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">UDP</span>  <span class="token string">"UDP"</span>                 <span class="token comment">//</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ICMP</span> <span class="token string">"ICMP"</span>                <span class="token comment">//</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DNS</span>  <span class="token string">"DNS"</span>                 <span class="token comment">//</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TLS</span>  <span class="token string">"TLS"</span>                 <span class="token comment">//</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SSL</span>  <span class="token string">"SSL"</span>                 <span class="token comment">//</span></span>
<span class="token comment">// Ethernet protocol format</span>
<span class="token comment">/*
+-------------------+-----------------+------+
|       6 byte      |     6 byte      |2 byte|
+-------------------+-----------------+------+
|destination address|  source address | type |
+-------------------+-----------------+------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ether_header</span><span class="token punctuation">{<!-- --></span>   <span class="token comment">// 14 byte</span>
    u_char ether_des_host<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// destination addr [6 byte]</span>
    u_char ether_src_host<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// source addr [6 byte]</span>
    u_short ether_type<span class="token punctuation">;</span>        <span class="token comment">// type [2 byte]</span>
<span class="token punctuation">}</span>ETHER_HEADER<span class="token punctuation">;</span>


<span class="token comment">// Ipv4 header</span>
<span class="token comment">/*
+-------+-----------+---------------+-------------------------+
| 4 bit |   4 bit   |    8 bit      |          16 bit         |
+-------+-----------+---------------+-------------------------+
|version|head length|  TOS/DS_byte  |        total length     |
+-------------------+--+---+---+----+-+-+-+-------------------+
|          identification           |R|D|M|    offset         |
+-------------------+---------------+-+-+-+-------------------+
|       ttl         |     protocal  |         checksum        |
+-------------------+---------------+-------------------------+
|                   source ip address                         |
+-------------------------------------------------------------+
|                 destination ip address                      |
+-------------------------------------------------------------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ip_header</span><span class="token punctuation">{<!-- --></span>           <span class="token comment">// 20 byte</span>
    u_char versiosn_head_length<span class="token punctuation">;</span>    <span class="token comment">// version [4 bit] and length of header [4 bit]</span>
    u_char TOS<span class="token punctuation">;</span>                     <span class="token comment">// TOS/DS_byte [1 byte]</span>
    u_short total_length<span class="token punctuation">;</span>           <span class="token comment">// ip package total length [2 byte]</span>
    u_short identification<span class="token punctuation">;</span>         <span class="token comment">// identification [2 byte]</span>
    u_short flag_offset<span class="token punctuation">;</span>            <span class="token comment">// flag [3 bit] and offset [13 bit]</span>
    u_char ttl<span class="token punctuation">;</span>                     <span class="token comment">// TTL [1 byte]</span>
    u_char protocol<span class="token punctuation">;</span>                <span class="token comment">// protocal [1 byte]</span>
    u_short checksum<span class="token punctuation">;</span>               <span class="token comment">// checksum [2 byte]</span>
    u_int src_addr<span class="token punctuation">;</span>                 <span class="token comment">// source address [4 byte]</span>
    u_int des_addr<span class="token punctuation">;</span>                 <span class="token comment">// destination address [4 byte]</span>
<span class="token punctuation">}</span>IP_HEADER<span class="token punctuation">;</span>
<span class="token comment">// Tcp header</span>
<span class="token comment">/*
+----------------------+---------------------+
|         16 bit       |       16 bit        |
+----------------------+---------------------+
|      source port     |  destination port   |
+----------------------+---------------------+
|              sequence number               |
+----------------------+---------------------+
|                 ack number                 |
+----+---------+-------+---------------------+
|head| reserve | flags |     window size     |
+----+---------+-------+---------------------+
|     checksum         |   urgent pointer    |
+----------------------+---------------------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">tcp_header</span><span class="token punctuation">{<!-- --></span>    <span class="token comment">// 20 byte</span>
    u_short src_port<span class="token punctuation">;</span>         <span class="token comment">// source port [2 byte]</span>
    u_short des_port<span class="token punctuation">;</span>         <span class="token comment">// destination [2 byte]</span>
    u_int sequence<span class="token punctuation">;</span>           <span class="token comment">// sequence number [4 byte]</span>
    u_int ack<span class="token punctuation">;</span>                <span class="token comment">// Confirm serial number [4 byte]</span>
    u_char header_length<span class="token punctuation">;</span>     <span class="token comment">// header length [4 bit]</span>
    u_char flags<span class="token punctuation">;</span>             <span class="token comment">// flags [6 bit]</span>
    u_short window_size<span class="token punctuation">;</span>      <span class="token comment">// size of window [2 byte]</span>
    u_short checksum<span class="token punctuation">;</span>         <span class="token comment">// checksum [2 byte]</span>
    u_short urgent<span class="token punctuation">;</span>           <span class="token comment">// urgent pointer [2 byte]</span>
<span class="token punctuation">}</span>TCP_HEADER<span class="token punctuation">;</span>

<span class="token comment">// Udp header</span>
<span class="token comment">/*
+---------------------+---------------------+
|        16 bit       |        16 bit       |
+---------------------+---------------------+
|    source port      |   destination port  |
+---------------------+---------------------+
| data package length |       checksum      |
+---------------------+---------------------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">udp_header</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// 8 byte</span>
    u_short src_port<span class="token punctuation">;</span>      <span class="token comment">// source port [2 byte]</span>
    u_short des_port<span class="token punctuation">;</span>      <span class="token comment">// destination port [2 byte]</span>
    u_short data_length<span class="token punctuation">;</span>   <span class="token comment">// data length [2 byte]</span>
    u_short checksum<span class="token punctuation">;</span>      <span class="token comment">// checksum [2 byte]</span>

<span class="token punctuation">}</span>UDP_HEADER<span class="token punctuation">;</span>
<span class="token comment">// Icmp header</span>
<span class="token comment">/*
+---------------------+---------------------+
|  1 byte  |  1 byte  |        2 byte       |
+---------------------+---------------------+
|   type   |   code   |       checksum      |
+---------------------+---------------------+
|    identification   |       sequence      |
+---------------------+---------------------+
|                  option                   |
+-------------------------------------------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">icmp_header</span><span class="token punctuation">{<!-- --></span>         <span class="token comment">// at least 8 byte</span>
    u_char type<span class="token punctuation">;</span>                    <span class="token comment">// type [1 byte]</span>
    u_char code<span class="token punctuation">;</span>                    <span class="token comment">// code [1 byte]</span>
    u_short checksum<span class="token punctuation">;</span>               <span class="token comment">// checksum [2 byte]</span>
    u_short identification<span class="token punctuation">;</span>         <span class="token comment">// identification [2 byte]</span>
    u_short sequence<span class="token punctuation">;</span>               <span class="token comment">// sequence [2 byte]</span>
<span class="token punctuation">}</span>ICMP_HEADER<span class="token punctuation">;</span>

<span class="token comment">//Arp</span>
<span class="token comment">/*
|&lt;--------  ARP header  ------------&gt;|
+------+--------+-----+------+-------+----------+---------+---------------+--------------+
|2 byte| 2 byte |1byte| 1byte|2 byte |  6 byte  | 4 byte  |     6 byte    |     4 byte   |
+------+--------+-----+------+-------+----------+---------+---------------+--------------+
| type |protocol|e_len|ip_len|op_type|source mac|source ip|destination mac|destination ip|
+------+--------+-----+------+-------+----------+---------+---------------+--------------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">arp_header</span><span class="token punctuation">{<!-- --></span>   <span class="token comment">// 28 byte</span>
    u_short hardware_type<span class="token punctuation">;</span>   <span class="token comment">// hardware type [2 byte]</span>
    u_short protocol_type<span class="token punctuation">;</span>   <span class="token comment">// protocol [2 byte]</span>
    u_char mac_length<span class="token punctuation">;</span>       <span class="token comment">// MAC address length [1 byte]</span>
    u_char ip_length<span class="token punctuation">;</span>        <span class="token comment">// IP address length [1 byte]</span>
    u_short op_code<span class="token punctuation">;</span>         <span class="token comment">// operation code [2 byte]</span>

    u_char src_eth_addr<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// source ether address [6 byte]</span>
    u_char src_ip_addr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// source ip address [4 byte]</span>
    u_char des_eth_addr<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// destination ether address [6 byte]</span>
    u_char des_ip_addr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// destination ip address [4 byte]</span>

<span class="token punctuation">}</span>ARP_HEADER<span class="token punctuation">;</span>
<span class="token comment">// dns</span>
<span class="token comment">/*
+--------------------------+---------------------------+
|           16 bit         |1b|4bit|1b|1b|1b|1b|3b|4bit|
+--------------------------+--+----+--+--+--+--+--+----+
|      identification      |QR| OP |AA|TC|RD|RA|..|Resp|
+--------------------------+--+----+--+--+--+--+--+----+
|         Question         |       Answer RRs          |
+--------------------------+---------------------------+
|     Authority RRs        |      Additional RRs       |
+--------------------------+---------------------------+
*/</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dns_header</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">// 12 byte</span>
    u_short identification<span class="token punctuation">;</span> <span class="token comment">// Identification [2 byte]</span>
    u_short flags<span class="token punctuation">;</span>          <span class="token comment">// Flags [total 2 byte]</span>
    u_short question<span class="token punctuation">;</span>       <span class="token comment">// Question Number [2 byte]</span>
    u_short answer<span class="token punctuation">;</span>         <span class="token comment">// Answer RRs [2 byte]</span>
    u_short authority<span class="token punctuation">;</span>      <span class="token comment">// Authority RRs [2 byte]</span>
    u_short additional<span class="token punctuation">;</span>     <span class="token comment">// Additional RRs [2 byte]</span>
<span class="token punctuation">}</span>DNS_HEADER<span class="token punctuation">;</span>

<span class="token comment">// dns question</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dns_question</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// char* name;          // Non-fixed</span>
    u_short query_type<span class="token punctuation">;</span>     <span class="token comment">// 2 byte</span>
    u_short query_class<span class="token punctuation">;</span>    <span class="token comment">// 2 byte</span>
<span class="token punctuation">}</span>DNS_QUESITON<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dns_answer</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// char* name          // Non-fixed</span>
    u_short answer_type<span class="token punctuation">;</span>   <span class="token comment">// 2 byte</span>
    u_short answer_class<span class="token punctuation">;</span>  <span class="token comment">// 2 byte</span>
    u_int TTL<span class="token punctuation">;</span>             <span class="token comment">// 4 byte</span>
    u_short dataLength<span class="token punctuation">;</span>    <span class="token comment">// 2 byte</span>
    <span class="token comment">//char* name           // Non-fixed</span>
<span class="token punctuation">}</span>DNS_ANSWER<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// FORMAT_H</span></span>
</code></pre> 
<p>7、mainwindow.h</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MAINWINDOW_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAINWINDOW_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pcap.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span></span><span class="token string">"ws2_32.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"capture.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"readonlydelegate.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QVector&gt;</span></span>

QT_BEGIN_NAMESPACE
<span class="token keyword">namespace</span> Ui <span class="token punctuation">{<!-- --></span> <span class="token keyword">class</span> <span class="token class-name">MainWindow</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
QT_END_NAMESPACE

<span class="token keyword">class</span> <span class="token class-name">MainWindow</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span>
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// construction and destruction</span>
    <span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// show network card</span>
    <span class="token keyword">void</span> <span class="token function">showNetworkCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// capture the data package</span>
    <span class="token keyword">int</span> <span class="token function">capture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">on_comboBox_currentIndexChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_lineEdit_returnPressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_lineEdit_textChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_tableWidget_currentCellChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> currentRow<span class="token punctuation">,</span> <span class="token keyword">int</span> currentColumn<span class="token punctuation">,</span> <span class="token keyword">int</span> previousRow<span class="token punctuation">,</span> <span class="token keyword">int</span> previousColumn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span>DataPackage data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    Ui<span class="token double-colon punctuation">::</span>MainWindow <span class="token operator">*</span>ui<span class="token punctuation">;</span>
    pcap_if_t <span class="token operator">*</span>all_devices<span class="token punctuation">;</span>                 <span class="token comment">// all adapter device</span>
    pcap_if_t <span class="token operator">*</span>device<span class="token punctuation">;</span>                      <span class="token comment">// An adapter</span>
    pcap_t <span class="token operator">*</span>pointer<span class="token punctuation">;</span>                        <span class="token comment">// data package pointer</span>
    ReadOnlyDelegate<span class="token operator">*</span> readOnlyDelegate<span class="token punctuation">;</span>     <span class="token comment">// readonly detegate</span>
    <span class="token keyword">int</span> countNumber<span class="token punctuation">;</span>                        <span class="token comment">// countNumber</span>
    <span class="token keyword">int</span> rowNumber<span class="token punctuation">;</span>                          <span class="token comment">// rowNumber</span>
    QVector<span class="token operator">&lt;</span>DataPackage<span class="token operator">&gt;</span>data<span class="token punctuation">;</span>               <span class="token comment">// store data</span>
    <span class="token keyword">char</span> errbuf<span class="token punctuation">[</span>PCAP_ERRBUF_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>          <span class="token comment">// error buffer</span>
    <span class="token keyword">bool</span> isStart<span class="token punctuation">;</span>                           <span class="token comment">// the thread is start or not</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// MAINWINDOW_H</span></span>
</code></pre> 
<p>8、mainwindow.cpp</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_mainwindow.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"pcap.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDebug&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"winsock.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"capture.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QStringList&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QColor&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMessageBox&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTreeWidgetItem&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QStringList&gt;</span></span>

<span class="token comment">/*
 * MainWindow
 * Constructure function
 * initialize the variables and GUI
*/</span>
<span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">MainWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>MainWindow<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">statusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token string">"welcome to shark!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set the toolbar</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">addAction</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionstart_capture<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">addAction</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionclear_all<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">addAction</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionup<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">addAction</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actiondown<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">addAction</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionTop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">addAction</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// show network card</span>
    <span class="token function">showNetworkCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// initialization</span>
    Capture <span class="token operator">*</span>thread <span class="token operator">=</span> <span class="token keyword">new</span> Capture<span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    isStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">bool</span> index <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    countNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    rowNumber <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    device <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    pointer <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

    <span class="token comment">// add the signal-slot</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionstart_capture<span class="token punctuation">,</span><span class="token operator">&amp;</span>QAction<span class="token double-colon punctuation">::</span>triggered<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
        index <span class="token operator">=</span> <span class="token operator">!</span>index<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">int</span> type <span class="token operator">=</span> <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token string">"information"</span><span class="token punctuation">,</span><span class="token string">"Before restarting do you want to save result?"</span><span class="token punctuation">,</span><span class="token string">"Save"</span><span class="token punctuation">,</span><span class="token string">"Continue"</span><span class="token punctuation">,</span><span class="token string">"Cancel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// save the file...</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"not save"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                    index <span class="token operator">=</span> <span class="token operator">!</span>index<span class="token punctuation">;</span>
                    isStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            countNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            rowNumber <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> dataSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> dataSize<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pkt_content <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token generic-function"><span class="token function">QVector</span><span class="token generic class-name"><span class="token operator">&lt;</span>DataPackage<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token function">capture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>pointer <span class="token operator">&amp;&amp;</span> res <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                thread<span class="token operator">-&gt;</span><span class="token function">resetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                thread<span class="token operator">-&gt;</span><span class="token function">setPointer</span><span class="token punctuation">(</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
                ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                thread<span class="token operator">-&gt;</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ui<span class="token operator">-&gt;</span>actionstart_capture<span class="token operator">-&gt;</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/stop.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                countNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                isStart <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// fail to start</span>
                index <span class="token operator">=</span> <span class="token operator">!</span>index<span class="token punctuation">;</span>
                countNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                rowNumber <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                isStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            thread<span class="token operator">-&gt;</span><span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            thread<span class="token operator">-&gt;</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            thread<span class="token operator">-&gt;</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">pcap_close</span><span class="token punctuation">(</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>actionstart_capture<span class="token operator">-&gt;</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/start.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            isStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionclear_all<span class="token punctuation">,</span><span class="token operator">&amp;</span>QAction<span class="token double-colon punctuation">::</span>triggered<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isStart<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> type <span class="token operator">=</span> <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">"information"</span><span class="token punctuation">,</span><span class="token string">"Do you want to clear all?"</span><span class="token punctuation">,</span><span class="token string">"Yes"</span><span class="token punctuation">,</span><span class="token string">"Cancel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                countNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                rowNumber <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> dataSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> dataSize<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pkt_content <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token generic-function"><span class="token function">QVector</span><span class="token generic class-name"><span class="token operator">&lt;</span>DataPackage<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionup<span class="token punctuation">,</span><span class="token operator">&amp;</span>QAction<span class="token double-colon punctuation">::</span>triggered<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> index <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">currentRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentCell</span><span class="token punctuation">(</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actiondown<span class="token punctuation">,</span><span class="token operator">&amp;</span>QAction<span class="token double-colon punctuation">::</span>triggered<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> index <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">currentRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> index <span class="token operator">&lt;</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentCell</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionTop<span class="token punctuation">,</span><span class="token operator">&amp;</span>QAction<span class="token double-colon punctuation">::</span>triggered<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> index <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">currentRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>actionEnd<span class="token punctuation">,</span><span class="token operator">&amp;</span>QAction<span class="token double-colon punctuation">::</span>triggered<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> index <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setCurrentCell</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">connect</span><span class="token punctuation">(</span>thread<span class="token punctuation">,</span><span class="token operator">&amp;</span>Capture<span class="token double-colon punctuation">::</span>send<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>MainWindow<span class="token double-colon punctuation">::</span>handleMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// initialization</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setShowGrid</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>toolBar<span class="token operator">-&gt;</span><span class="token function">setMovable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">verticalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnCount</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    readOnlyDelegate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ReadOnlyDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItemDelegate</span><span class="token punctuation">(</span>readOnlyDelegate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QStringList title <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"NO."</span><span class="token punctuation">,</span><span class="token string">"Time"</span><span class="token punctuation">,</span><span class="token string">"Source"</span><span class="token punctuation">,</span><span class="token string">"Destination"</span><span class="token punctuation">,</span><span class="token string">"Protocol"</span><span class="token punctuation">,</span><span class="token string">"Length"</span><span class="token punctuation">,</span><span class="token string">"Info"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setHorizontalHeaderLabels</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">verticalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setDefaultSectionSize</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setSelectionBehavior</span><span class="token punctuation">(</span>QAbstractItemView<span class="token double-colon punctuation">::</span>SelectRows<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">setHeaderHidden</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * ~MainWindow
 * Destructure function
 * free memory
*/</span>
<span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">MainWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// free the memory you have allocated!</span>
    <span class="token keyword">int</span> dataSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>dataSize<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pkt_content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pkt_content <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// do not use 'data.clear()' only,it can't free totally!</span>
    <span class="token generic-function"><span class="token function">QVector</span><span class="token generic class-name"><span class="token operator">&lt;</span>DataPackage<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> readOnlyDelegate<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * showNetworkCard
 * scan the network cards and show information about it at combox
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">showNetworkCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token function">pcap_findalldevs</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>all_devices<span class="token punctuation">,</span>errbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">statusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token string">"There is something wrong"</span> <span class="token operator">+</span> <span class="token function">QString</span><span class="token punctuation">(</span>errbuf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">"Cannot find a matching network card, please restart and test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token string">"please chose the Network Card!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>device <span class="token operator">=</span> all_devices<span class="token punctuation">;</span>device<span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>device <span class="token operator">=</span> device<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        QString device_name <span class="token operator">=</span> device<span class="token operator">-&gt;</span>name<span class="token punctuation">;</span>
        device_name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\\Device\\"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString device_description <span class="token operator">=</span> device<span class="token operator">-&gt;</span>description<span class="token punctuation">;</span>
        QString item <span class="token operator">=</span> device_name <span class="token operator">+</span> <span class="token string">"   "</span> <span class="token operator">+</span> device_description<span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>comboBox<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * on_comboBox_currentIndexChanged
 * when item of combox changed,the device pointer will also change
 * this function could ensure device pointer point to the selected network card
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_comboBox_currentIndexChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>device <span class="token operator">=</span> all_devices<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">,</span>device <span class="token operator">=</span> device<span class="token operator">-&gt;</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        device <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * capture
 * starting capture the data package from card
 * the data package in data link layer must meet the IEEE 802.3 protocol
 * or it will be throwed away
*/</span>
<span class="token keyword">int</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">capture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// pcap_t * pcap_open_live(char*device,int snaplen,int promisc,int to_ms,char*errbuf);</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span>
        pointer <span class="token operator">=</span> <span class="token function">pcap_open_live</span><span class="token punctuation">(</span>device<span class="token operator">-&gt;</span>name<span class="token punctuation">,</span><span class="token number">65536</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span>errbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">statusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token string">"pls choose Network Card!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>pointer<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">statusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">showMessage</span><span class="token punctuation">(</span>errbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pcap_freealldevs</span><span class="token punctuation">(</span>all_devices<span class="token punctuation">)</span><span class="token punctuation">;</span>
        device <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// check the data link IEEE 802.3</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">pcap_datalink</span><span class="token punctuation">(</span>pointer<span class="token punctuation">)</span> <span class="token operator">!=</span> DLT_EN10MB<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token function">pcap_close</span><span class="token punctuation">(</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">pcap_freealldevs</span><span class="token punctuation">(</span>all_devices<span class="token punctuation">)</span><span class="token punctuation">;</span>
            device <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">statusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">showMessage</span><span class="token punctuation">(</span>device<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * handleMessage
 * slot function Auto trigger
 * This function will analysis package it received and show in the table
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">handleMessage</span><span class="token punctuation">(</span>DataPackage data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">insertRow</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>data<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString type <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getPackageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QColor color<span class="token punctuation">;</span>
    <span class="token comment">// show different color</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> TCP<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        color <span class="token operator">=</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">216</span><span class="token punctuation">,</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">216</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> TCP<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        color <span class="token operator">=</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">144</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">144</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> ARP<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        color <span class="token operator">=</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">238</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> DNS<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        color <span class="token operator">=</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> TLS <span class="token operator">||</span> type <span class="token operator">==</span> SSL<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        color <span class="token operator">=</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span><span class="token number">149</span><span class="token punctuation">,</span><span class="token number">210</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        color <span class="token operator">=</span> <span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">218</span><span class="token punctuation">,</span><span class="token number">185</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>countNumber <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getTimeStamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getDestination</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set color</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">item</span><span class="token punctuation">(</span>countNumber<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setBackground</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    countNumber<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * on_tableWidget_cellClicked
 * click the table item the detail inforamation will show at the bottom tree widget
 * this function will analysis data pakckage chosed in detail
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>rowNumber <span class="token operator">==</span> row <span class="token operator">||</span> row <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rowNumber <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rowNumber <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> rowNumber <span class="token operator">&gt;</span> data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        QString desMac <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDesMacAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString srcMac <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getSrcMacAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getMacType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QString tree1 <span class="token operator">=</span> <span class="token string">"Ethernet, Src:"</span> <span class="token operator">+</span>srcMac <span class="token operator">+</span> <span class="token string">", Dst:"</span> <span class="token operator">+</span> desMac<span class="token punctuation">;</span>
        QTreeWidgetItem<span class="token operator">*</span>item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>tree1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>

        item<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Destination:"</span> <span class="token operator">+</span> desMac<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        item<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Source:"</span> <span class="token operator">+</span> srcMac<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        item<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type:"</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        QString packageType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getPackageType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// arp package analysis</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> ARP<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            QString ArpType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpOperationCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QTreeWidgetItem<span class="token operator">*</span>item2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Address Resolution Protocol "</span> <span class="token operator">+</span> ArpType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>item2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString HardwareType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpHardwareType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString protocolType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpProtocolType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString HardwareSize <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpHardwareLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString protocolSize <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpProtocolLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString srcMacAddr <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpSourceEtherAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString desMacAddr <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpDestinationEtherAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString srcIpAddr <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpSourceIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString desIpAddr <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getArpDestinationIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Hardware type:"</span> <span class="token operator">+</span> HardwareType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Protocol type:"</span> <span class="token operator">+</span> protocolType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Hardware size:"</span> <span class="token operator">+</span> HardwareSize<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Protocol size:"</span> <span class="token operator">+</span> protocolSize<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Opcode:"</span> <span class="token operator">+</span> ArpType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Sender MAC address:"</span> <span class="token operator">+</span> srcMacAddr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Sender IP address:"</span> <span class="token operator">+</span> srcIpAddr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Target MAC address:"</span> <span class="token operator">+</span> desMacAddr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item2<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Target IP address:"</span> <span class="token operator">+</span> desIpAddr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// ip package analysis</span>
            QString srcIp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getSrcIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString desIp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDesIpAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            QTreeWidgetItem<span class="token operator">*</span>item3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Internet Protocol Version 4, Src:"</span> <span class="token operator">+</span> srcIp <span class="token operator">+</span> <span class="token string">", Dst:"</span> <span class="token operator">+</span> desIp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>item3<span class="token punctuation">)</span><span class="token punctuation">;</span>

            QString version <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString headerLength <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString Tos <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpTos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString totalLength <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpTotalLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString id <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpIdentification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString flags <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>flags<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span>
                flags <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> flags<span class="token punctuation">;</span>
            flags <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> flags<span class="token punctuation">;</span>
            QString FragmentOffset <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpFragmentOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString ttl <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpTTL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString protocol <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString checksum <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> dataLengthofIp <span class="token operator">=</span> totalLength<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"0100 .... = Version:"</span> <span class="token operator">+</span> version<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... 0101 = Header Length:"</span> <span class="token operator">+</span> headerLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TOS:"</span> <span class="token operator">+</span> Tos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Total Length:"</span> <span class="token operator">+</span> totalLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Identification:"</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            QString reservedBit <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpReservedBit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString DF <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpDF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString MF <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpMF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString FLAG <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>reservedBit <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                FLAG <span class="token operator">+=</span> <span class="token string">"Reserved bit"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>DF <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                FLAG <span class="token operator">+=</span> <span class="token string">"Don't fragment"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>MF <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                FLAG <span class="token operator">+=</span> <span class="token string">"More fragment"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>FLAG<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
                FLAG <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            QTreeWidgetItem<span class="token operator">*</span>bitTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Flags:"</span> <span class="token operator">+</span> flags <span class="token operator">+</span> FLAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>bitTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
            QString temp <span class="token operator">=</span> reservedBit <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
            bitTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>reservedBit <span class="token operator">+</span> <span class="token string">"... .... = Reserved bit:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            temp <span class="token operator">=</span> DF <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
            bitTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"."</span> <span class="token operator">+</span> DF <span class="token operator">+</span> <span class="token string">".. .... = Don't fragment:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            temp <span class="token operator">=</span> MF <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
            bitTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".."</span> <span class="token operator">+</span> MF <span class="token operator">+</span> <span class="token string">". .... = More fragment:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Fragment Offset:"</span> <span class="token operator">+</span> FragmentOffset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Time to Live:"</span> <span class="token operator">+</span> ttl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Protocol:"</span> <span class="token operator">+</span> protocol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Header checksum:"</span> <span class="token operator">+</span> checksum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Source Address:"</span> <span class="token operator">+</span> srcIp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            item3<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Destination Address:"</span> <span class="token operator">+</span> desIp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> TCP <span class="token operator">||</span> packageType <span class="token operator">==</span> TLS <span class="token operator">||</span> packageType <span class="token operator">==</span> SSL<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                QString desPort <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpDestinationPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString srcPort <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpSourcePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString ack <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpAcknowledgment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString seq <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpSequence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString headerLength <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> rawLength <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpRawHeaderLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataLengthofIp <span class="token operator">-=</span> <span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString dataLength <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>dataLengthofIp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString flag <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span>
                    flag <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> flag<span class="token punctuation">;</span>
                flag <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> flag<span class="token punctuation">;</span>
                QTreeWidgetItem<span class="token operator">*</span>item4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Transmission Control Protocol, Src Port:"</span> <span class="token operator">+</span> srcPort <span class="token operator">+</span> <span class="token string">", Dst Port:"</span> <span class="token operator">+</span> desPort <span class="token operator">+</span> <span class="token string">",Seq:"</span> <span class="token operator">+</span> seq <span class="token operator">+</span> <span class="token string">", Ack:"</span> <span class="token operator">+</span> ack <span class="token operator">+</span> <span class="token string">", Len:"</span> <span class="token operator">+</span> dataLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

                ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>item4<span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Source Port:"</span> <span class="token operator">+</span> srcPort<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Destination Port:"</span> <span class="token operator">+</span> desPort<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Sequence Number (raw) :"</span> <span class="token operator">+</span> seq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Ackowledgment Number (raw) :"</span> <span class="token operator">+</span> ack<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


                QString sLength <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>rawLength<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span>sLength<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span>
                    sLength <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> sLength<span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>sLength <span class="token operator">+</span> <span class="token string">" .... = Header Length:"</span> <span class="token operator">+</span> headerLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                QString PSH <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpPSH</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString URG <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpURG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString ACK <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpACK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString RST <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpRST</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString SYN <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpSYN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString FIN <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpFIN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString FLAG <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span><span class="token punctuation">(</span>PSH <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
                    FLAG <span class="token operator">+=</span> <span class="token string">"PSH,"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>URG <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
                    FLAG <span class="token operator">+=</span> <span class="token string">"UGR,"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>ACK <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
                    FLAG <span class="token operator">+=</span> <span class="token string">"ACK,"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>RST <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
                    FLAG <span class="token operator">+=</span> <span class="token string">"RST,"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>SYN <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
                    FLAG <span class="token operator">+=</span> <span class="token string">"SYN,"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>FIN <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span>
                    FLAG <span class="token operator">+=</span> <span class="token string">"FIN,"</span><span class="token punctuation">;</span>
                FLAG <span class="token operator">=</span> FLAG<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span>FLAG<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>SYN <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Sequence Number: 0 (relative sequence number)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Acknowledgment Number: 0 (relative ack number)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>SYN <span class="token operator">==</span> <span class="token string">"1"</span> <span class="token operator">&amp;&amp;</span> ACK <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Sequence Number: 0 (relative sequence number)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Acknowledgment Number: 1 (relative ack number)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                QTreeWidgetItem<span class="token operator">*</span>flagTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Flags:"</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> FLAG <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>flagTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString temp <span class="token operator">=</span> URG <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
                flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .."</span> <span class="token operator">+</span> URG <span class="token operator">+</span> <span class="token string">". .... = Urgent(URG):"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                temp <span class="token operator">=</span> ACK <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
                flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... ..."</span> <span class="token operator">+</span> ACK <span class="token operator">+</span> <span class="token string">" .... = Acknowledgment(ACK):"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                temp <span class="token operator">=</span> PSH <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
                flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... "</span> <span class="token operator">+</span> PSH <span class="token operator">+</span> <span class="token string">"... = Push(PSH):"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                temp <span class="token operator">=</span> RST <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
                flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... ."</span> <span class="token operator">+</span> RST <span class="token operator">+</span> <span class="token string">".. = Reset(RST):"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                temp <span class="token operator">=</span> SYN <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
                flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... .."</span> <span class="token operator">+</span> SYN <span class="token operator">+</span> <span class="token string">". = Syn(SYN):"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                temp <span class="token operator">=</span> FIN <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Set"</span><span class="token operator">:</span><span class="token string">"Not set"</span><span class="token punctuation">;</span>
                flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... ..."</span> <span class="token operator">+</span> FIN <span class="token operator">+</span> <span class="token string">" = Fin(FIN):"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                QString window <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString checksum <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString urgent <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpUrgentPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"window:"</span> <span class="token operator">+</span> window<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"checksum:"</span> <span class="token operator">+</span> checksum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Urgent Pointer:"</span> <span class="token operator">+</span> urgent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    QTreeWidgetItem <span class="token operator">*</span> optionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Options: ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">") bytes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>optionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> <span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">int</span> kind <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpOperationRawKind</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">switch</span> <span class="token punctuation">(</span>kind<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - End of List (EOL)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"kind:End of List (0)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            j<span class="token operator">++</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - No-Operation (NOP)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"kind: No-Operation (1)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            j<span class="token operator">++</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            u_short mss<span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpOperationMSS</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>mss<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - Maximun Segment Size: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>mss<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" bytes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"kind: Maximun Segment Size (2)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: 4"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"MSS Value: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>mss<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                j <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            u_char shift<span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpOperationWSOPT</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>shift<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                <span class="token keyword">int</span> factor <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> shift<span class="token punctuation">;</span>
                                QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - Window scale: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>shift<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" (multiply by "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>factor<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"kind: Window scale (3)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: 3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Shift Count: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>shift<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"[Multiplier: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>factor<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                j <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpOperationSACKP</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - SACK Permitted"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Kind: SCAK Permitted (4)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: 2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                j <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            u_char length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                            QVector<span class="token operator">&lt;</span>u_int<span class="token operator">&gt;</span>edge<span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpOperationSACK</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>length<span class="token punctuation">,</span>edge<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - SACK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Kind: SCAK (5)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">int</span> num <span class="token operator">=</span> edge<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> num<span class="token punctuation">;</span>k <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"left edge = "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"right edge = "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>edge<span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                                j <span class="token operator">+=</span> length<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            u_int value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                            u_int reply <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTcpOperationTSPOT</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>value<span class="token punctuation">,</span>reply<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                QString val <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                QString rep <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>reply<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                QTreeWidgetItem <span class="token operator">*</span> subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Option - TimeStamps: TSval "</span> <span class="token operator">+</span>val <span class="token operator">+</span> <span class="token string">", TSecr "</span> <span class="token operator">+</span> rep<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                optionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Kind: Time Stamp Option (8)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: 10"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Timestamp value: "</span> <span class="token operator">+</span> val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Timestamp echo reply: "</span> <span class="token operator">+</span> rep<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                j <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">19</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            j <span class="token operator">+=</span> <span class="token number">18</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">28</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            j <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            j<span class="token operator">++</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dataLengthofIp <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    item4<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"TCP Payload ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>dataLengthofIp<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> TLS<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        QTreeWidgetItem<span class="token operator">*</span> tlsTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Transport Layer Security"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>tlsTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        u_char contentType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        u_short version <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        u_short length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsBasicInfo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>contentType<span class="token punctuation">,</span>version<span class="token punctuation">,</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsContentType</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        QString vs <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsVersion</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">switch</span> <span class="token punctuation">(</span>contentType<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">case</span> <span class="token number">20</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// ... TODO</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">21</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            QTreeWidgetItem<span class="token operator">*</span> tlsSubree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>vs <span class="token operator">+</span> <span class="token string">" Record Layer: Encrypted Alert"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>tlsSubree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Content Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> vs <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Alert Message: Encrypted Alert"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">22</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// handshake</span>
                            u_char handshakeType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>handshakeType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>handshakeType <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// client hello</span>
                                <span class="token keyword">int</span> tlsLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_short rawVersion <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QString random <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                u_char sessionLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QString sessionId <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                u_short cipherLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>cipher<span class="token punctuation">;</span>
                                u_char cmLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span>compressionMethod<span class="token punctuation">;</span>
                                u_short extensionLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsClientHelloInfo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>handshakeType<span class="token punctuation">,</span>tlsLength<span class="token punctuation">,</span>rawVersion<span class="token punctuation">,</span>random<span class="token punctuation">,</span>sessionLength<span class="token punctuation">,</span>sessionId<span class="token punctuation">,</span>cipherLength<span class="token punctuation">,</span>cipher<span class="token punctuation">,</span>cmLength<span class="token punctuation">,</span>compressionMethod<span class="token punctuation">,</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span>handshakeType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                QString tlsVersion <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsVersion</span><span class="token punctuation">(</span>rawVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QTreeWidgetItem<span class="token operator">*</span> tlsSubTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>vs <span class="token operator">+</span> <span class="token string">" Record Layer: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" Protocol: "</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>tlsSubTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Content Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> vs <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QTreeWidgetItem<span class="token operator">*</span> handshakeTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Handshake Protocol: "</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>handshakeTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Handshake Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>handshakeType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tlsLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> tlsVersion <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>rawVersion<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Random: "</span> <span class="token operator">+</span> random<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Session ID Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>sessionLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>sessionLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Session ID: "</span> <span class="token operator">+</span> sessionId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Cipher Suites Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>cipherLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>cipherLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    QTreeWidgetItem<span class="token operator">*</span> cipherTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Cipher Suites ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>cipherLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" suites)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>cipherTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> cipherLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                        QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeCipherSuites</span><span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        cipherTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Cipher Suite: "</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span>
                                <span class="token punctuation">}</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Compression Method Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>cmLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>cmLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    QTreeWidgetItem<span class="token operator">*</span> cmTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Compression Methods ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>cmLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" method)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>cmTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> cmLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                        QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeCompression</span><span class="token punctuation">(</span>compressionMethod<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        cmTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Compression Methods: "</span> <span class="token operator">+</span> temp <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>compressionMethod<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span>
                                <span class="token punctuation">}</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extensions Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>extensionLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    <span class="token keyword">int</span> exOffset <span class="token operator">=</span> <span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>tlsLength <span class="token operator">-</span> extensionLength <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> extensionLength<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                        <span class="token keyword">int</span> code <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionType</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        u_short exType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                        u_short exLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                        <span class="token keyword">switch</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// server_name</span>
                                            u_short listLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_char nameType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_short nameLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QString name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionServerName</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>listLength<span class="token punctuation">,</span>nameType<span class="token punctuation">,</span>nameLength<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">if</span><span class="token punctuation">(</span>exLength <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> listLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QTreeWidgetItem<span class="token operator">*</span>serverTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name Indication extension"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>serverTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name list length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>listLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name Type: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>nameType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>nameLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name: "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// ec_point_format</span>
                                            u_char ecLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span>EC<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionEcPointFormats</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>ecLength<span class="token punctuation">,</span>EC<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"EC point formats Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ecLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> EXTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Elliptic curves point formats ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ecLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>EXTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> ecLength<span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtensionECPointFormat</span><span class="token punctuation">(</span>EC<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                EXTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// supported_groups</span>
                                            u_short groupListLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>group<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSupportGroups</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>groupListLength<span class="token punctuation">,</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Groups List Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>groupListLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> sptTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Groups ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>groupListLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" groups)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>sptTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> groupListLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtensionSupportGroup</span><span class="token punctuation">(</span>group<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                sptTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Group: "</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">35</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// session_ticket</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSessionTicket</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">22</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// encrypt_then_mac</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionEncryptThenMac</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">23</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// extended_master_secret</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionExtendMasterSecret</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// signature_algorithms</span>
                                            u_short algorithmLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>algorithm<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSignatureAlgorithms</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>algorithmLength<span class="token punctuation">,</span>algorithm<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithms Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithmLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> sigTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithms ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithmLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" algorithms)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>sigTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> algorithmLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QTreeWidgetItem<span class="token operator">*</span>subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Algorithm: 0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                sigTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                QString hash <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHadshakeExtensionHash</span><span class="token punctuation">(</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                QString sig <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHadshakeExtensionSignature</span><span class="token punctuation">(</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithm Hash: "</span> <span class="token operator">+</span> hash <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithm Signature: "</span> <span class="token operator">+</span> sig <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">43</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// supported_versions</span>
                                            u_char supportLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>supportVersion<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSupportVersions</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>supportLength<span class="token punctuation">,</span>supportVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Versions length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>supportLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> supportLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsVersion</span><span class="token punctuation">(</span>supportVersion<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Version: "</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">51</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// key_share</span>
                                            u_short shareLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_short group <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_short exchangeLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QString exchange <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionKeyShare</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>shareLength<span class="token punctuation">,</span>group<span class="token punctuation">,</span>exchangeLength<span class="token punctuation">,</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                            QTreeWidgetItem<span class="token operator">*</span>subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Share extension"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Client Key Share Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>shareLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> entryTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Share Entry: Group "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>entryTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            entryTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Group: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            entryTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Exchange Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exchangeLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            entryTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Exchange: "</span> <span class="token operator">+</span> exchange<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">21</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// padding</span>
                                            QString rdata <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionPadding</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>rdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (21)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Padding Data: "</span> <span class="token operator">+</span> rdata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                                            QString rdata <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionOther</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>rdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Data: "</span> <span class="token operator">+</span> rdata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token punctuation">}</span>
                                        k <span class="token operator">+=</span> <span class="token punctuation">(</span>exLength <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        exOffset <span class="token operator">+=</span> <span class="token punctuation">(</span>exLength <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>handshakeType <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">// Server hello</span>
                                <span class="token keyword">int</span> tlsLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_short rawVersion <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QString random <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                u_char sessionLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QString sessionId <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                u_short cipher <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_char compressionMethod <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_short extensionLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsServerHelloInfo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>handshakeType<span class="token punctuation">,</span>tlsLength<span class="token punctuation">,</span>rawVersion<span class="token punctuation">,</span>random<span class="token punctuation">,</span>sessionLength<span class="token punctuation">,</span>sessionId<span class="token punctuation">,</span>cipher<span class="token punctuation">,</span>compressionMethod<span class="token punctuation">,</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span>handshakeType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                QString tlsVersion <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsVersion</span><span class="token punctuation">(</span>rawVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QTreeWidgetItem<span class="token operator">*</span> tlsSubTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>vs <span class="token operator">+</span> <span class="token string">" Record Layer: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" Protocol: "</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>tlsSubTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Content Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> vs <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QTreeWidgetItem<span class="token operator">*</span> handshakeTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Handshake Protocol: "</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>handshakeTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Handshake Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>handshakeType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tlsLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> tlsVersion <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>rawVersion<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Random: "</span> <span class="token operator">+</span> random<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Session ID Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>sessionLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>sessionLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Session ID: "</span> <span class="token operator">+</span> sessionId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeCipherSuites</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Cipher Suites: "</span> <span class="token operator">+</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeCompression</span><span class="token punctuation">(</span>compressionMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Compression Methods: "</span> <span class="token operator">+</span> temp <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>compressionMethod<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extensions Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>extensionLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                <span class="token keyword">if</span><span class="token punctuation">(</span>extensionLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                    <span class="token keyword">int</span> exOffset <span class="token operator">=</span> <span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>tlsLength <span class="token operator">-</span> extensionLength <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> extensionLength<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                        <span class="token keyword">int</span> code <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionType</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        u_short exType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                        u_short exLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                        <span class="token keyword">switch</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                        <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// server_name</span>
                                            u_short listLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_char nameType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_short nameLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QString name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionServerName</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>listLength<span class="token punctuation">,</span>nameType<span class="token punctuation">,</span>nameLength<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">if</span><span class="token punctuation">(</span>exLength <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> listLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QTreeWidgetItem<span class="token operator">*</span>serverTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name Indication extension"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>serverTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name list length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>listLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name Type: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>nameType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>nameLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                serverTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Server Name: "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// ec_point_format</span>
                                            u_char ecLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_char<span class="token operator">&gt;</span>EC<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionEcPointFormats</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>ecLength<span class="token punctuation">,</span>EC<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"EC point formats Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ecLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> EXTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Elliptic curves point formats ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ecLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>EXTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> ecLength<span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtensionECPointFormat</span><span class="token punctuation">(</span>EC<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                EXTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// supported_groups</span>
                                            u_short groupListLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>group<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSupportGroups</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>groupListLength<span class="token punctuation">,</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Groups List Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>groupListLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> sptTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Groups ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>groupListLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" groups)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>sptTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> groupListLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtensionSupportGroup</span><span class="token punctuation">(</span>group<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                sptTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Group: "</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">35</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// session_ticket</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSessionTicket</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">22</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// encrypt_then_mac</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionEncryptThenMac</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">23</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// extended_master_secret</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionExtendMasterSecret</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// signature_algorithms</span>
                                            u_short algorithmLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>algorithm<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSignatureAlgorithms</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>algorithmLength<span class="token punctuation">,</span>algorithm<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithms Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithmLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> sigTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithms ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithmLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" algorithms)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>sigTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> algorithmLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QTreeWidgetItem<span class="token operator">*</span>subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Algorithm: 0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                sigTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                QString hash <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHadshakeExtensionHash</span><span class="token punctuation">(</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                QString sig <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHadshakeExtensionSignature</span><span class="token punctuation">(</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithm Hash: "</span> <span class="token operator">+</span> hash <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Signature Hash Algorithm Signature: "</span> <span class="token operator">+</span> sig <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">43</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// supported_versions</span>
                                            u_char supportLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QVector<span class="token operator">&lt;</span>u_short<span class="token operator">&gt;</span>supportVersion<span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionSupportVersions</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>supportLength<span class="token punctuation">,</span>supportVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Versions length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>supportLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>g <span class="token operator">&lt;</span> supportLength<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                                QString temp <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsVersion</span><span class="token punctuation">(</span>supportVersion<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Supported Version: "</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">51</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// key_share</span>
                                            u_short shareLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_short group <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            u_short exchangeLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                            QString exchange <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionKeyShare</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>shareLength<span class="token punctuation">,</span>group<span class="token punctuation">,</span>exchangeLength<span class="token punctuation">,</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                            QTreeWidgetItem<span class="token operator">*</span>subTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Share extension"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>subTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Client Key Share Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>shareLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span> entryTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Share Entry: Group "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            subTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>entryTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            entryTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Group: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            entryTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Exchange Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exchangeLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            entryTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Key Exchange: "</span> <span class="token operator">+</span> exchange<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">case</span> <span class="token number">21</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token comment">// padding</span>
                                            QString rdata <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionPadding</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>rdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (21)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Padding Data: "</span> <span class="token operator">+</span> rdata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                                            QString rdata <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                            data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsExtensionOther</span><span class="token punctuation">(</span>exOffset<span class="token punctuation">,</span>exType<span class="token punctuation">,</span>exLength<span class="token punctuation">,</span>rdata<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QString subType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeExtension</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            QTreeWidgetItem<span class="token operator">*</span>extensionTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Extension: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" (len="</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>extensionTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type: "</span> <span class="token operator">+</span> subType <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>exLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                            extensionTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Data: "</span> <span class="token operator">+</span> rdata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token punctuation">}</span>
                                        k <span class="token operator">+=</span> <span class="token punctuation">(</span>exLength <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        exOffset <span class="token operator">+=</span> <span class="token punctuation">(</span>exLength <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span>
                                <span class="token punctuation">}</span>

                            <span class="token punctuation">}</span>
                            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>handshakeType <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">// Server Key Exchange</span>
                                <span class="token keyword">int</span> tlsLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_char curveType <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_short curveName <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_char pubLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QString pubKey <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                u_short sigAlgorithm <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                u_short sigLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                                QString sig <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsServerKeyExchange</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rawLength <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>handshakeType<span class="token punctuation">,</span>tlsLength<span class="token punctuation">,</span>curveType<span class="token punctuation">,</span>curveName<span class="token punctuation">,</span>pubLength<span class="token punctuation">,</span>pubKey<span class="token punctuation">,</span>sigAlgorithm<span class="token punctuation">,</span>sigLength<span class="token punctuation">,</span>sig<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getTlsHandshakeType</span><span class="token punctuation">(</span>handshakeType<span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QTreeWidgetItem<span class="token operator">*</span> tlsSubTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>vs <span class="token operator">+</span> <span class="token string">" Record Layer: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" Protocol: "</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>tlsSubTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Content Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> vs <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                                QTreeWidgetItem<span class="token operator">*</span> handshakeTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Handshake Protocol: "</span> <span class="token operator">+</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                tlsSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>handshakeTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Handshake Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>handshakeType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                handshakeTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length: "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>tlsLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                            <span class="token punctuation">}</span>
                            <span class="token comment">// ... TODO</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">case</span> <span class="token number">23</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            QTreeWidgetItem<span class="token operator">*</span> tlsSubree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>vs <span class="token operator">+</span> <span class="token string">" Record Layer: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" Protocol: http-over-tls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>tlsSubree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Content Type: "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>contentType<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Version: "</span> <span class="token operator">+</span> vs <span class="token operator">+</span> <span class="token string">" (0x0"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>version<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Length "</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tlsSubree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Encrypted Application Data: ..."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">default</span><span class="token operator">:</span><span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> SSL<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Transport Layer Security"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> UDP <span class="token operator">||</span> packageType <span class="token operator">==</span> DNS<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                QString srcPort <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getUdpSourcePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString desPort <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getUdpDestinationPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString Length <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getUdpDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString checksum <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getUdpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QTreeWidgetItem<span class="token operator">*</span>item5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"User Datagram Protocol, Src Port:"</span> <span class="token operator">+</span> srcPort <span class="token operator">+</span> <span class="token string">", Dst Port:"</span> <span class="token operator">+</span> desPort<span class="token punctuation">)</span><span class="token punctuation">;</span>
                ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>item5<span class="token punctuation">)</span><span class="token punctuation">;</span>
                item5<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Source Port:"</span> <span class="token operator">+</span> srcPort<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item5<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Destination Port:"</span> <span class="token operator">+</span> desPort<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item5<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"length:"</span> <span class="token operator">+</span> Length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item5<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Checksum:"</span> <span class="token operator">+</span> checksum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> udpLength <span class="token operator">=</span> Length<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>udpLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    item5<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"UDP PayLoad ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>udpLength <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" bytes)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> DNS<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    QString transaction <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsTransactionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString QR <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsQR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString temp <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>QR <span class="token operator">==</span> <span class="token string">"0"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"query"</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>QR <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"response"</span><span class="token punctuation">;</span>
                    QString flags <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QTreeWidgetItem<span class="token operator">*</span>dnsTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Domain Name System ("</span> <span class="token operator">+</span> temp <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>dnsTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Transaction ID:"</span> <span class="token operator">+</span> transaction<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QTreeWidgetItem<span class="token operator">*</span> flagTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Flags:"</span> <span class="token operator">+</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>flagTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    temp <span class="token operator">=</span> QR <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Message is a response"</span><span class="token operator">:</span><span class="token string">"Message is a query"</span><span class="token punctuation">;</span>
                    flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>QR <span class="token operator">+</span> <span class="token string">"... .... .... .... = Response:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString Opcode <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsOpcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>Opcode <span class="token operator">==</span> <span class="token string">"0"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Standard query (0)"</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Opcode <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Reverse query (1)"</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Opcode <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Status request (2)"</span><span class="token punctuation">;</span>
                    flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".000 "</span> <span class="token operator">+</span> Opcode <span class="token operator">+</span> <span class="token string">"... .... .... = Opcode:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>QR <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        QString AA <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsAA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        temp <span class="token operator">=</span> AA <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Server is an authority for domain"</span><span class="token operator">:</span><span class="token string">"Server is not an authority for domain"</span><span class="token punctuation">;</span>
                        flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... ."</span> <span class="token operator">+</span> AA <span class="token operator">+</span> <span class="token string">".. .... .... = Authoritative:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    QString TC <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsTC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    temp <span class="token operator">=</span> TC <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Message is truncated"</span><span class="token operator">:</span><span class="token string">"Message is not truncated"</span><span class="token punctuation">;</span>
                    flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .."</span> <span class="token operator">+</span> TC <span class="token operator">+</span> <span class="token string">". .... .... = Truncated:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    QString RD <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsRD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    temp <span class="token operator">=</span> RD <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Do query recursively"</span><span class="token operator">:</span><span class="token string">"Do query not recursively"</span><span class="token punctuation">;</span>
                    flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... ..."</span> <span class="token operator">+</span> RD <span class="token operator">+</span> <span class="token string">" .... .... = Recursion desired:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">if</span><span class="token punctuation">(</span>QR <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        QString RA <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsRA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        temp <span class="token operator">=</span> RA <span class="token operator">==</span> <span class="token string">"1"</span><span class="token operator">?</span><span class="token string">"Server can do recursive queries"</span><span class="token operator">:</span><span class="token string">"Server can not do recursive queries"</span><span class="token punctuation">;</span>
                        flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... "</span> <span class="token operator">+</span> RA <span class="token operator">+</span> <span class="token string">"... .... = Recursion available:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    QString Z <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsZ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">while</span><span class="token punctuation">(</span>Z<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">)</span>
                        Z <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> Z<span class="token punctuation">;</span>
                    flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... ."</span> <span class="token operator">+</span> Z <span class="token operator">+</span> <span class="token string">" .... = Z:reserved("</span> <span class="token operator">+</span> Z <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>QR <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        QString Rcode <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsFlagsRcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>Rcode <span class="token operator">==</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
                            temp <span class="token operator">=</span> <span class="token string">"No error (0)"</span><span class="token punctuation">;</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Rcode <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Format error (1)"</span><span class="token punctuation">;</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Rcode <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Server failure (2)"</span><span class="token punctuation">;</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Rcode <span class="token operator">==</span> <span class="token string">"3"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Name Error (3)"</span><span class="token punctuation">;</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Rcode <span class="token operator">==</span> <span class="token string">"4"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Not Implemented (4)"</span><span class="token punctuation">;</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Rcode <span class="token operator">==</span> <span class="token string">"5"</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"Refused (5)"</span><span class="token punctuation">;</span>
                        <span class="token keyword">int</span> code <span class="token operator">=</span> Rcode<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        QString bCode <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>bCode<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">)</span>
                            bCode <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> bCode<span class="token punctuation">;</span>
                        flagTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">".... .... .... "</span> <span class="token operator">+</span> bCode <span class="token operator">+</span> <span class="token string">" = Reply code:"</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    QString question <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsQuestionNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Questions:"</span> <span class="token operator">+</span> question<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString answer <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsAnswerNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Answer RRs:"</span> <span class="token operator">+</span> answer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString authority <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsAuthorityNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Authority RRs:"</span> <span class="token operator">+</span> authority<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString additional <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsAdditionalNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Additional RRs:"</span> <span class="token operator">+</span> additional<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">int</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>question <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        QString domainInfo<span class="token punctuation">;</span>
                        <span class="token keyword">int</span> Type<span class="token punctuation">;</span>
                        <span class="token keyword">int</span> Class<span class="token punctuation">;</span>
                        data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsQueriesDomain</span><span class="token punctuation">(</span>domainInfo<span class="token punctuation">,</span>Type<span class="token punctuation">,</span>Class<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        QTreeWidgetItem<span class="token operator">*</span>queryDomainTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Queries"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>queryDomainTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        offset <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">+</span> domainInfo<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsDomainType</span><span class="token punctuation">(</span>Type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        QTreeWidgetItem<span class="token operator">*</span>querySubTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>domainInfo <span class="token operator">+</span> <span class="token string">" type "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">", class IN"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        queryDomainTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>querySubTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        querySubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Name:"</span> <span class="token operator">+</span> domainInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        querySubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"[Name Length:"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>domainInfo<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        querySubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type:"</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>Type<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        querySubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Class: IN (0x000"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>Class<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">int</span> answerNumber <span class="token operator">=</span> answer<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>answerNumber <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        QTreeWidgetItem<span class="token operator">*</span>answerTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Answers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dnsTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>answerTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> answerNumber<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                            QString name1<span class="token punctuation">;</span>
                            QString name2<span class="token punctuation">;</span>
                            u_short type<span class="token punctuation">;</span>
                            u_short Class<span class="token punctuation">;</span>
                            u_int ttl<span class="token punctuation">;</span>
                            u_short length<span class="token punctuation">;</span>

                            <span class="token keyword">int</span> tempOffset <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsAnswersDomain</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span>name1<span class="token punctuation">,</span>type<span class="token punctuation">,</span>Class<span class="token punctuation">,</span>ttl<span class="token punctuation">,</span>length<span class="token punctuation">,</span>name2<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            QString sType <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDnsDomainType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            QString temp <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"addr"</span><span class="token punctuation">;</span>
                            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> temp <span class="token operator">=</span> <span class="token string">"cname"</span><span class="token punctuation">;</span>
                            QTreeWidgetItem<span class="token operator">*</span>answerSubTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>name1 <span class="token operator">+</span> <span class="token string">": type "</span> <span class="token operator">+</span> sType <span class="token operator">+</span> <span class="token string">",class IN, "</span> <span class="token operator">+</span> temp <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> name2<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>answerSubTree<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Name:"</span> <span class="token operator">+</span> name1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Type:"</span> <span class="token operator">+</span> sType <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Class: IN (0x000"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>Class<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Time to live:"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ttl<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>ttl<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" second)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Data length:"</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            answerSubTree<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>sType <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> name2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                            offset <span class="token operator">+=</span> tempOffset<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>packageType <span class="token operator">==</span> ICMP<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                dataLengthofIp <span class="token operator">-=</span> <span class="token number">8</span><span class="token punctuation">;</span>
                QTreeWidgetItem<span class="token operator">*</span>item6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Internet Message Protocol"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                ui<span class="token operator">-&gt;</span>treeWidget<span class="token operator">-&gt;</span><span class="token function">addTopLevelItem</span><span class="token punctuation">(</span>item6<span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString type <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIcmpType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString code <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIcmpCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString info <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString checksum <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIcmpCheckSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString id <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIcmpIdentification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                QString seq <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIcmpSequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"type:"</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> info <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"code:"</span> <span class="token operator">+</span> code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Checksum:"</span> <span class="token operator">+</span> checksum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"type:"</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> info <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Identifier:"</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Sequence Number:"</span> <span class="token operator">+</span> seq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>dataLengthofIp <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    QTreeWidgetItem<span class="token operator">*</span> dataItem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Data ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>dataLengthofIp<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">") bytes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item6<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span>dataItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    QString icmpData <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIcmpData</span><span class="token punctuation">(</span>dataLengthofIp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataItem<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>icmpData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// the ethernet may have padding to ensure that the minimum length of the data packet is greater than 46</span>
        <span class="token keyword">int</span> macDataLength <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getIpTotalLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> dataPackageLength <span class="token operator">=</span> data<span class="token punctuation">[</span>rowNumber<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getDataLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> delta <span class="token operator">=</span> dataPackageLength <span class="token operator">-</span> macDataLength<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>delta <span class="token operator">&gt;</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> padding <span class="token operator">=</span> delta <span class="token operator">-</span> <span class="token number">14</span><span class="token punctuation">;</span>
            QString pad <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>pad<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> padding <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                pad <span class="token operator">+=</span> <span class="token string">"00"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            item<span class="token operator">-&gt;</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span><span class="token function">QStringList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Padding: "</span> <span class="token operator">+</span> pad<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * on_lineEdit_returnPressed
 * if you press the enter key,when capture is stopped
 * table will Filter eligible item
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_lineEdit_returnPressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString text <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>lineEdit<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    text <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">toUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString target <span class="token operator">=</span> <span class="token string">"#"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"UDP"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"TCP"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"DNS"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"ARP"</span><span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"ICMP"</span><span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"SSL"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"TLS"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>lineEdit<span class="token operator">-&gt;</span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QLineEdit {background-color: rgb(154,255,154);}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        target <span class="token operator">=</span> text<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>lineEdit<span class="token operator">-&gt;</span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QLineEdit {background-color: rgb(250,128,114);}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> number <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isStart <span class="token operator">&amp;&amp;</span> target <span class="token operator">!=</span> <span class="token string">"#"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> number<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> target<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setRowHidden</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                    ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setRowHidden</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    count<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> number <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> number<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                ui<span class="token operator">-&gt;</span>tableWidget<span class="token operator">-&gt;</span><span class="token function">setRowHidden</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                count<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">double</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>number <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token punctuation">(</span>count<span class="token operator">*</span><span class="token number">100.0</span><span class="token punctuation">)</span><span class="token operator">/</span>number<span class="token punctuation">;</span>
    <span class="token function">statusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token string">"Have show ("</span> <span class="token operator">+</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">") "</span> <span class="token operator">+</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * on_lineEdit_textChanged
 * when text at lineEdit changed,it will check input information is correct or not
 * if it is corrected,the color is green or it will be red
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_lineEdit_textChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString text <span class="token operator">=</span> arg1<span class="token punctuation">;</span>
    text <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">toLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>text <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"udp"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"tcp"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"dns"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"arp"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"icmp"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"tls"</span> <span class="token operator">||</span> text <span class="token operator">==</span> <span class="token string">"ssl"</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>lineEdit<span class="token operator">-&gt;</span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QLineEdit {background-color: rgb(154,255,154);}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        ui<span class="token operator">-&gt;</span>lineEdit<span class="token operator">-&gt;</span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QLineEdit {background-color: rgb(250,128,114);}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * on_tableWidget_currentCellChanged
 * this fucntion can response to up-down key
 * when you use the keyboard to manipulate,this bottom treewidget will also show information as well as you use mouse
*/</span>
<span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_tableWidget_currentCellChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> currentRow<span class="token punctuation">,</span> <span class="token keyword">int</span> currentColumn<span class="token punctuation">,</span> <span class="token keyword">int</span> previousRow<span class="token punctuation">,</span> <span class="token keyword">int</span> previousColumn<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>currentRow <span class="token operator">!=</span> previousRow<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> previousRow <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">on_tableWidget_cellClicked</span><span class="token punctuation">(</span>currentRow<span class="token punctuation">,</span>currentColumn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>9、readonlydelegate.h</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">READONLYDELEGATE_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">READONLYDELEGATE_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;QWidget&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;QItemDelegate&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;QStyleOptionViewItem&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">ReadOnlyDelegate</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QItemDelegate</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">ReadOnlyDelegate</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">QItemDelegate</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

    QWidget <span class="token operator">*</span><span class="token function">createEditor</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">,</span> <span class="token keyword">const</span> QStyleOptionViewItem <span class="token operator">&amp;</span>option<span class="token punctuation">,</span>
<span class="token keyword">const</span> QModelIndex <span class="token operator">&amp;</span>index<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">override</span> <span class="token comment">//final</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">Q_UNUSED</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
        <span class="token function">Q_UNUSED</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span>
        <span class="token function">Q_UNUSED</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// READONLYDELEGATE_H</span></span>
</code></pre> 
<p>10、main.cpp</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"mainwindow.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QApplication&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*
      * pls modify the shark.pro:
      * INCLUDEPATH += yourpath/Include
      * LIBS += your path/Lib/wpcap.lib  libws2_32
      * or IDE will warn you can't find some headerfiles!
      * this step helps us to add winpcap to our project actually
   */</span>
    QApplication <span class="token function">a</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    MainWindow w<span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"Shark - @copyright by 卡布诺奇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>11、mainwindow.ui</p> 
<p><img src="https://images2.imgbox.com/99/85/qc3g5Qpd_o.png" alt="img"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d969b163174109a6565633ba7a22dab6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决：PicGo插件安装失败，失败码为1（404）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8305c8df411780c00b5d3a2735de445b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">kettle学习--基础--3.3--案例--将oracle的数据，导入到mysql中</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>