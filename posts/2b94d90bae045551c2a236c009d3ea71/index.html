<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[神经网络]U2Net语义分割网络 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[神经网络]U2Net语义分割网络" />
<meta property="og:description" content=" 一、概述 U2Net是针对SOD任务设计的网络（SOD任务：将图片中最吸引人的目标/区域分割出来；即只有前景和背景两个部分，是一个二分类问题）
二、网络结构 1.特征提取网络 在编码器阶段，每个block会下采样2倍(maxpool)；在解码器阶段，在每个block前会上采样2倍(bilinear)。
EN_1和DE_1采用的模块为RSU-7（下采样5次，上采样5次，总压缩倍率为32），结构如下图所示。
EN_2和DE_2采用的是RSU-6，相较于RSU-7少了一个上采样和一个下采样，总压缩倍率变为了16倍；EN_3和DE_3采用的是RSU-5,（比RSU-6少2倍的压缩倍率）；EN_4和DE_4采用的是RSU-4（比RSU-5少2倍的压缩倍率）
而EN_5、EN_6和DE_5采用的则是RSU-4F结构（如下图所示），相较于RSU-4，本结构没有下采样结构。采用此结构的原因是经过数次下采样后，特征图的尺寸已经很小了。如再下采样势必丢失一些信息。
2.特征融合网络 分别取DE_1、DE_2、DE_3、DE_4、DE_5和EN_6的输出特征图，分别进行3x3卷积（kernel=1，经过卷积后通道数为1）；
再通过双线性插值将特征图还原为输入图的尺寸；
最后将这6个特征图进行concat拼接。拼接后的特征图经过1x1卷积核sigmoid激活函数得到最终的预测。
三、网络配置参数 上面的是标准网络，下面的是轻量化网络。对应的参数如下图。
四、损失函数 该损失函数可以分为两部分：表示6个特征图与标注的Ground Turth计算损失，为二值交叉熵损失。代表每个损失的权重；为最终结果与Ground Turth之间的损失。所有的权重默认为1。
五、评价指标 1.F-measure 的取值范围为0~1，值越大效果越好
2.MAE " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2b94d90bae045551c2a236c009d3ea71/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-16T09:17:07+08:00" />
<meta property="article:modified_time" content="2023-03-16T09:17:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[神经网络]U2Net语义分割网络</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、概述</h2> 
<p>        U2Net是针对SOD任务设计的网络（SOD任务：将图片中最吸引人的目标/区域分割出来；即只有前景和背景两个部分，是一个二分类问题）</p> 
<h2>二、网络结构</h2> 
<p class="img-center"><img alt="" height="400" src="https://images2.imgbox.com/eb/12/oIH5LFrf_o.png" width="365"></p> 
<h2>        1.特征提取网络 </h2> 
<p>                 在编码器阶段，每个block会下采样2倍(maxpool)；在解码器阶段，在每个block前会上采样2倍(bilinear)。</p> 
<p>                EN_1和DE_1采用的模块为<strong>RSU-7</strong>（下采样5次，上采样5次，总压缩倍率为32），结构如下图所示。</p> 
<p class="img-center"><img alt="" height="645" src="https://images2.imgbox.com/9e/c7/raSSZwps_o.png" width="444"></p> 
<p>                 EN_2和DE_2采用的是RSU-6，相较于RSU-7少了一个上采样和一个下采样，总压缩倍率变为了16倍；EN_3和DE_3采用的是RSU-5,（比RSU-6少2倍的压缩倍率）；EN_4和DE_4采用的是RSU-4（比RSU-5少2倍的压缩倍率）</p> 
<p>                而EN_5、EN_6和DE_5采用的则是<strong>RSU-4F</strong>结构（如下图所示），相较于RSU-4，本结构没有下采样结构。采用此结构的原因是经过数次下采样后，特征图的尺寸已经很小了。如再下采样势必丢失一些信息。</p> 
<p class="img-center"><img alt="" height="400" src="https://images2.imgbox.com/64/3b/SYIICYPG_o.png" width="455"></p> 
<h3>         2.特征融合网络</h3> 
<p>                分别取DE_1、DE_2、DE_3、DE_4、DE_5和EN_6的输出特征图，分别进行3x3卷积（kernel=1，经过卷积后通道数为1）；</p> 
<p>                再通过双线性插值将特征图还原为输入图的尺寸；</p> 
<p>                最后将这6个特征图进行concat拼接。拼接后的特征图经过1x1卷积核sigmoid激活函数得到最终的预测。</p> 
<h2>三、网络配置参数</h2> 
<p>        上面的是标准网络，下面的是轻量化网络。对应的参数如下图。</p> 
<p><img alt="" height="278" src="https://images2.imgbox.com/bf/58/skmfu62W_o.png" width="1200"></p> 
<p class="img-center"><img alt="" height="300" src="https://images2.imgbox.com/f1/c8/2Xu0xOw5_o.png" width="275"></p> 
<h2> 四、损失函数</h2> 
<p>        <img alt="L=\sum w^{(m)}_{side}l^{(m)}_{side}+w_{fuse}l_{fuse}" class="mathcode" src="https://images2.imgbox.com/38/79/S3ZCpWQt_o.png"></p> 
<p>        该损失函数可以分为两部分：<img alt="w^{(m)}_{side}l^{(m)}_{side}" class="mathcode" src="https://images2.imgbox.com/d3/b7/ViaD8QG9_o.png">表示6个特征图与标注的Ground Turth计算损失，<img alt="l" class="mathcode" src="https://images2.imgbox.com/26/ad/liaxko9b_o.png">为<strong>二值交叉熵损失</strong>。<img alt="w" class="mathcode" src="https://images2.imgbox.com/c3/7b/bG8zULCq_o.png">代表每个损失的权重；<img alt="w_{fuse}l_{fuse}" class="mathcode" src="https://images2.imgbox.com/cb/d9/cBiJ0wzj_o.png">为最终结果与Ground Turth之间的损失。所有的权重默认为1。</p> 
<h2>五、评价指标</h2> 
<h3>        1.F-measure</h3> 
<p>                <img alt="F_\beta=\frac{(1+\beta^2)\times Precision\times Recall}{\beta^2\times Precision+Recall}" class="mathcode" src="https://images2.imgbox.com/50/24/gGAY8W9P_o.png"></p> 
<p>                        <img alt="F_\beta" class="mathcode" src="https://images2.imgbox.com/6d/c8/B3Phr4sY_o.png">的取值范围为0~1，值越大效果越好</p> 
<h3>        2.MAE</h3> 
<p>                 <img alt="MAE=\frac{1}{H\times W}\sum\sum |P(r,c)-G(r,c)|" class="mathcode" src="https://images2.imgbox.com/b7/1f/ahtX87Zu_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/413c77cc75bb8f4c3f3fb10be313c417/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【开发工具】idea配置全局变量Jdk、maven仓库、maven（全文图解）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/20dbb93800e682497bf869bf28f2d0d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">el-table表格无缝滚动,鼠标进入可悬停</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>