<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>教你如何设计ASP网上考试系统 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="教你如何设计ASP网上考试系统" />
<meta property="og:description" content="教你如何设计ASP网上考试系统 为了运行这个应用程序，我们需要在global.asa文件里进行设置数据库的连接。
global.asa:　&lt; SCRIPT LANGUAGE=VBScript RUNAT=Server &gt;
Sub Application_OnStart
dbPath = “DBQ=” &amp; Server.Mappath(“onlinetest.mdb”)
dbConnectionString = &#34;DRIVER={Microsoft Access Driver (*.mdb)}; &#34; &amp; dbPath
Set Application(“Conn”) = Server.CreateObject (“ADODB.Connection”)
Application(“Conn”).Open dbConnectionString
End Sub
Sub Application_OnEnd
Application(“Conn”).Close
Set Application(“Conn”) = Nothing
End Sub
Sub Session_OnStart
End Sub
Sub Session_OnEnd
End Sub
&lt; /SCRIPT &gt;
注册页面index.asp。其中有两个输入域：用户名和口令，这两个输入域需要客户机端的JavaScript确认，以便不把它们作为空白域来传递。非考生要想参加考试必须先注册。这个页面还要显示一些错误信息，如“用户名或口令错误”、“请重新选择一个用户名”等。注册表单中还应包含考生一些个人的信息，如Emai、年龄、教育程度等。登录后，考生就可以参答考试站点的其它试卷了。
index.asp:
if (theForm.username.value == “”)
{
alert(“考生姓名&#34;User Name”“);
theForm.username.focus();
return (false);
}
if (theForm.password.value == “”)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/efef30189c3a7713483a4443dfd032c9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-03T18:16:25+08:00" />
<meta property="article:modified_time" content="2022-05-03T18:16:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">教你如何设计ASP网上考试系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="ASP_0"></a>教你如何设计ASP网上考试系统</h3> 
<p>为了运行这个应用程序，我们需要在global.asa文件里进行设置数据库的连接。</p> 
<p>global.asa:　<br> &lt; SCRIPT LANGUAGE=VBScript RUNAT=Server &gt;<br> Sub Application_OnStart<br> dbPath = “DBQ=” &amp; Server.Mappath(“onlinetest.mdb”)<br> dbConnectionString = "DRIVER={Microsoft Access Driver (*.mdb)}; " &amp; dbPath<br> Set Application(“Conn”) = Server.CreateObject (“ADODB.Connection”)<br> Application(“Conn”).Open dbConnectionString<br> End Sub<br> Sub Application_OnEnd<br> Application(“Conn”).Close<br> Set Application(“Conn”) = Nothing<br> End Sub<br> Sub Session_OnStart<br> End Sub<br> Sub Session_OnEnd<br> End Sub<br> &lt; /SCRIPT &gt;</p> 
<p>注册页面index.asp。其中有两个输入域：用户名和口令，这两个输入域需要客户机端的JavaScript确认，以便不把它们作为空白域来传递。非考生要想参加考试必须先注册。这个页面还要显示一些错误信息，如“用户名或口令错误”、“请重新选择一个用户名”等。注册表单中还应包含考生一些个人的信息，如Emai、年龄、教育程度等。登录后，考生就可以参答考试站点的其它试卷了。</p> 
<p>index.asp:<br> if (theForm.username.value == “”)<br> {<!-- --><br> alert(“考生姓名"User Name”“);<br> theForm.username.focus();<br> return (false);<br> }<br> if (theForm.password.value == “”)<br> {<!-- --><br> alert(“考生口令"Password””);<br> theForm.password.focus();<br> return (false);<br> }<br> &lt; table border=“0” cellpadding=“0” &gt;<br> &lt; tr &gt;<br> &lt; td width=“50%” &gt;<br> &lt; font face=“Verdana” size=“2” &gt;姓名:&lt; /font &gt;<br> &lt; /td &gt;<br> &lt; td width=“50%” &gt;<br> &lt; font face=“Verdana” size=“2” &gt;&lt; input type=text name=username size=20 maxlength=50 &gt;&lt; /font &gt;<br> &lt; /td &gt;<br> &lt; /tr &gt;<br> &lt; tr &gt;<br> &lt; td width=“50%” &gt;<br> &lt; font face=“Verdana” size=“2” &gt;口令:&lt; /font &gt;<br> &lt; /td &gt;<br> &lt; td width=“50%” &gt;<br> &lt; font face=“Vedana” size=2 &gt;&lt; input type=password name=password size=20 maxlength= 50 &gt;&lt; /font &gt;<br> &lt; /td &gt;<br> &lt; /tr &gt;<br> &lt; tr &gt;<br> &lt; td width=“100%” colspan=“2” align=“center” &gt;<br> &lt; font face=“Verdana” size=“2” &gt;&lt; br &gt; &lt; input type=“submit” value=“提交” name=“B3” &gt;<br> &lt; input type=“reset” value=“重写” name=“B4” &gt;<br> &lt; /font &gt;<br> &lt; /td &gt;<br> &lt; /tr &gt;<br> &lt; /table &gt;<br> 登录文件register.asp，当考生登录或新注册后，就显示这一页。我们可以利用它来询问考生的个人信息。该表单被提交后，转到sendregister.asp页面。<br> 验证和发送文件sendregister.asp。该页面从register.asp 中取得表单域的内容，查询数据库验证输入的用户名是否已经存在，如果存在，则将考生重新引回register.asp页面，并被提示要求重新选择用户名；如果用户名通过，则输入的内容就被传递并插入到数据库中。<br> sendregister.asp:<br> sql_findmember = “select count(<em>) from loginuser where username = ‘" &amp; username &amp;"’"<br> Set RS_findmember = Application(“Conn”).Execute(sql_findmember)<br> If RS_findmember(0) &lt; &gt; 0 Then<br> Session(“message”) = “噢,您输入的名字已经存在,请重新选择一个名字!”<br> response.redirect “register.asp”<br> ’ 如果RS_findmember(0) 返回的值大于0,用户就被引导回注册主页,并被要求填写一个新的用户名<br> End If<br> If RS_findmember(0) = 0 Then<br> sql_insert = “insert into loginuser (username,useremail,password) _<br> values('” &amp; username &amp; “‘,’” &amp; useremail &amp; “', '” &amp; pwd &amp;“') "<br> Set RS_insert = Application(“Conn”).Execute(sql_insert)<br> Session(“message”) = “THE ENTRY HAS BEEN INSERTED … Thank You”<br> response.redirect “index.asp”<br> ’ 如果RS_findmember(0) 返回的值是0,就表示用户名在数据库中不存在,名字就被存入.这意味着,考生可以参答站点其它的试卷了<br> End If<br> username = replace(request.form(“txt_name”),”‘“,”’‘“)<br> ’ 防止非法进入数据库哦.替换函数,当访问者键入了”’“单撇号,就用”‘’"代替<br> checkuser.asp<br> ’ 考生登录验证文件<br> sql_check = "select count(</em>) from loginuser where username ='” &amp; _<br> username &amp;“’ and password = '” &amp; useremail &amp;“'”<br> ’ 验证用户名和口令是否存在于数据库中<br> Set RS_check = Application(“Conn”).Execute(sql_check)<br> If RS_check(0) &lt; &gt; 0 Then<br> Session(“username”) = request.form(“username”)<br> response.redirect “default.asp”<br> ’ 如果已注册,引导到default.asp页<br> End If<br> If RS_check(0) = 0 Then<br> Session(“error”) = “对不起,您的姓名或口令无效,请重新输入!”<br> response.redirect “index.asp”<br> ’ 检查用户是否已经注册,如果返回值为0,表明用户名或口令无效，回注册页<br> End If<br> username = replace(request.form(“username”),“'”,“‘’”)<br> useremail = replace(request.form(“password”),“'”,“‘’”)<br> ’ 替换函数<br> 选择试卷页面default.asp。登录成功后，进入该页面。在这儿，考生可以选择的考试科目列表。在本设计中，用了001HTML 和002HTML两个，在实际应用中，可以增加表格以增加考试科目数。default.asp 要求表格安装一个下拉菜单，其中包含科目的列表，然后查询数据库，从试卷的表格中搜集两个域。<br> default.asp<br> sql_papers = “select *id, topic from paper sort order by topic asc”<br> SET RS_papers = Application(“Conn”).Execute(sql_papers)</p> 
<p>’ 以下代码是为了在下拉菜单中显示结果<br> SELECT size=1 name=select1 οnchange=“msec(document.form1._<br> select1.options[document.form1.select1.selectedIndex].value);” &gt;<br> &lt; option value=“0” &gt;选择科目考试<br> &lt; %Do while not RS_papers.EOF% &gt;<br> &lt; option value=“&lt; %=RS_papers(“id”)% &gt;” &gt;&lt; %=lcase(RS_papers(“topic”))% &gt;&lt; /OPTION &gt;<br> &lt; %<br> RS_papers.MoveNext<br> Loop<br> % &gt;</p> 
<p>function msec(x)<br> ’ msec函数在X值的基础上调用 redirect.asp,把查询字符串: ?x的值作为下拉菜单中被选择的项的值<br> {if (x==0)<br> { alert(“欢迎参加精彩春风之精英考试,请选择一个考试科目!”)<br> }<br> else<br> { location.href=“redirect.asp?section=” + x<br> }<br> }<br> 终于可以参加精英赛了！我们进入了试题页面redirect.asp。它将考生送到实际生成试题的ASP页面，如果数据库中没有所选择的科目的任何题目，就会显示错误信息和返回链接。如果数据库有题，则这一页就被重新引导到exam.asp页面，考生就可以进行在线考试了。<br> redirect.asp<br> id = Request.QueryString (“section”)<br> ’ 先调用查询字符串部分,将值存入变量 id中</p> 
<p>SQL = “select tbl_name from paper where id=”&amp;id<br> Set RS = Application(“Conn”).Execute(SQL)<br> subject= RS(0)<br> ’ 再使用SQL声明传递试卷表格中的域名table_name,结果存储在subject中</p> 
<p>MyString = Split(subject,“tbl”,-1,1)<br> ’ 分离变量subject,将其存储在MyString中.注意,此处用Split 函数在客户端显示测验名是为了更好地显示<br> IF RS_subject.BOF AND RS_subject.EOF Then<br> Response.Write Online " &amp; MyString(1) &amp; 题库正在创建中,请稍后再来! &lt; a href=default.asp &gt;返回&lt; /a &gt;"<br> Else<br> Response.Redirect (“exam.asp?section=”&amp;id )<br> End If<br> exam.asp是标准试卷页面，代码共分两大部分：计时器函数和本页查询选取试题。显示试题，并以单选按钮方式供考生答题。从数据库中选择的试题，本设计采用了随机函数，这也是目前题库生成试卷的通用方式。题目的个数设定为10个，考生每次回答5个。时间限定为20秒，剩余的时间在屏幕底部的状态窗口中显示。所有的试题都一起显示出来，然后开始计时。时间和试题个数都可以改变。<br> exam.asp<br> ’ 以下是计时器函数<br> &lt; script language=“JavaScript” &gt;<br> var ck=0;<br> var tf=0;<br> var timeUp=0;<br> var timeLeft=0;<br> var tcount=0;<br> TimerFunc();<br> function TimerFunc() {<!-- --><br> tf=window.setTimeout(“TimerFunc();”,1000);<br> tcount++;<br> timeLeft=20 - tcount;<br> window.status = “嘻嘻,做得的好快哦,还剩” +timeLeft + “秒”;<br> }<br> &lt; /script &gt;</p> 
<p>id = Request.QueryString (“section”)<br> session(“id”) = id<br> ’ 查询字符串存储在一个 session(“id”)中,按顺序启动查询<br> sql_tblname = “select tbl_name from paper where id=”&amp;id<br> ’ SQL声明的目的是从试卷表格中找到表格名,如果找到了表格名就开始向指定表格的查询<br> Set RS_tblname = Application(“Conn”).Execute(sql_tblname)<br> subject= RS_tblname(0)<br> MyString = Split(subject,“tbl”,-1,1)<br> ’ split 函数从结果中去掉tbl, 本设计使用了表格名前加tbl前缀的命名惯例</p> 
<p>sql_details = “select a.id, a.question, a.choice1, a.choice2,a.choice3, " &amp;_<br> " a.choice4 from " &amp; subject &amp; " a where a.id=”&amp;MyArray(Counter)<br> ’ 用随机函数生成从1-10之间的任意数字, MyArray(Counter)是已经生成的随机数字,用来从指定的科目表格中选取id.id、question、 choice1、choice2、choice3、choice4 都是科目表格域名<br> 考试成绩单result.asp，显示结果，并将这些结果增加到数据库细节表格中，以供查询<br> result.asp<br> for each item in Request.Form<br> sql_check = “select Count(<em>) from “&amp;subject&amp;” where answer =‘" &amp; Request.Form(item) &amp; "’"<br> Set RS_check = Application(“Conn”).Execute(sql_check)<br> if RS_check(0) &gt; 0 then<br> result = result + 1<br> end if<br> next<br> ’ 变量result存储结果。<br> 　　<br> percent = round(( 100 * result )/count)<br> ’ 百分数换算<br> sql_id = “select id from loginuser where username='” &amp; Session(“username”) &amp;“'”<br> Set RS_id = Application(“Conn”).Execute(sql_id)<br> id= RS_id(0)<br> SQL_insert = “insert into details (ref_id,subject,score) values('” &amp; id &amp; “‘,’” _<br> &amp; subject &amp; “', '” &amp; percent &amp;“‘) "<br> ’ 执行查询,将结果存储在数据库中.<br> view.asp 文件查询是否在此参加过考试。<br> view.asp<br> sql_id= "select id from loginuser where username=’” &amp; Session(“username”) &amp;“'”<br> Set RS_id = Application(“Conn”).Execute(sql_id)<br> id= RS_id(0)<br> sql_count = "Select count(</em>) from details where ref_id = '” &amp; id &amp;“'”<br> Set RS_count = Application(“Conn”).Execute(sql_count)<br> If RS_count(0) &lt; &gt; 0 Then<br> response.redirect “viewrecord.asp”<br> ’ 如果已参加过考试,则转到viewrecord.asp页面<br> End If<br> If RS_count(0) = 0 Then<br> Session(“noview”) = “噢,您还没在我们这儿考过试呢!”<br> response.redirect “default.asp”<br> End If<br> viewrecord.asp文件以表格形式显示注册用户的信息。<br> viewrecord.asp<br> sql_details = “Select *subject, score from details where ref_id = '” &amp; id &amp;“'”<br> Set RS_details = Application(“Conn”).Execute(sql_details)<br> 相关数据库结构：<br> 本设计中数据库名为onlinetest.mdb。共有5个表格：loginuser、paper、details、tbl001HTML、tbl002HTML。其中，001HTML、002HTML是按考试科目创建的单独的表格，我们可以根据考试科目的多少继续扩展或添加。</p> 
<p>loginuser表结构：<br> 序号 字段名 数据类型 描述<br> 1 Id Auto Number 主关键字<br> 2 Username Text 注册用户<br> 3 Useremail Text 用户电子邮件地址<br> 4 Password Text 注册口令</p> 
<p>details 表结构：<br> 序号 字段名 数据类型 描述<br> 1 Id Auto Number 主关键字<br> 2 Ref_id Text 考试ID号<br> 3 Subject Text 选择的试题<br> 4 Score Text 成绩</p> 
<p>paper 表结构：<br> 序号 字段名 数据类型 描述<br> 1 Id Auto Number 主关键字<br> 2 Topic Text 在线测验所要覆盖的部分/科目列表<br> 3 Tbl_name Text 包含指定科目的相关表格名</p> 
<p>tbl001HTML 表结构：<br> 序号 字段名 数据类型 描述<br> 1 Id Auto Number 主关键字<br> 2 Question Text 要显示的试题<br> 3 Choice1 Text 供选择的答案A<br> 4 Choice2 Text 供选择的答案B<br> 5 Choice3 Text 供选择的答案C<br> 6 Choice4 Text 供选择的答案D<br> 7 Answer Text 标准答案</p> 
<p>tbl002HTML 表结构：<br> 序号 字段名 数据类型 描述<br> 1 Id Auto Number 主关键字<br> 2 Question Text 要显示的试题<br> 3 Choice1 Text 供选择的答案A<br> 4 Choice2 Text 供选择的答案B<br> 5 Choice3 Text 供选择的答案C<br> 6 Choice4 Text 供选择的答案D<br> 7 Answer Text 标准答案</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/934fc3e38b118944154ccfbb34442b85/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">软件测试面试题：吞吐量大幅度波动有哪些原因？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7b6fd381aa3aa07b9a5d3bf2df6cfa69/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用蓝桥杯嵌入式旧板实现LCD显示波形和幅度谱</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>