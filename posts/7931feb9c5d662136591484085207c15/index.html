<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>libmodbus在ARM linux开发板上使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="libmodbus在ARM linux开发板上使用" />
<meta property="og:description" content="一、源码下载 1、libmodbus官网 libmodbus
2、下载 选择长期稳定版本libmodbus-3.1.6.tar.gz
3.拷贝到虚拟机
通过fillzilla或者vmtools直接拖动到linux虚拟机中
二、交叉编译 1、解压 拷贝到相应目录，解压，例如拷贝在/home/modbus下，modbus目录需要自己创建
在home/modbus下打开terminal 输入解压命令
tar -zxvf libmodbus-3.1.6.tar.gz
解压完成后在同目录下会生成 libmodbus-3.1.6文件夹，进入此文件夹
cd /home/modbus/libmodbus-3.1.6
2、创建安装目录 在/home/modbus/libmodbus-3.1.6目录下创建一个install文件夹
sudo mkdir install
3、配置编译选项 在/home/modbus/libmodbus-3.1.6目录下，打开终端，进行配置编译选项
（注：--prefix选项是安装目录，根据自己环境确定）
./configure --host=[交叉编译工具链前缀] --enable-static --prefix=[安装路径]/install/
[安装路径]例如/usr/local/modbus，[交叉编译工具链]例如arm-none-linux-gnueabihf
我最终程序是要用在ARM芯片上，所以交叉编译工具链这里我输入的是arm-none-linux-gnueabi 注意工具链一定要选对，否则一是makefile时，识别不了so文件，二是在开发板上无法运行。比如生成时用的是gnueabi，makefile时用的是gnueabihf 那就识别不了文件。
如果你使用libmodbus就是用在linux服务器上的，那么编译工具链就输入gcc即可。
我的configure示例:
./configure --host=arm-none-linux-gnueabihf --prefix=/home/modbus/libmodbus-3.1.6/install
5、编译&amp;安装 在/home/modbus/libmodbus-3.1.6目录下，打开终端，输入make 完成后再输入make install
执行此功能后，会在install文件夹生成三个文件夹，include lib share lib中包含了so库 include中包含了modbus.h的文件。 在编程时，要将include中的内容拷贝到自己项目中，lib里的 3个带so的文件要拷贝到虚拟机和开发板的 /usr/lib下。
6. 编写makefile
libmodbus是以so库的形式加载的，编写makefile时，要指明so库的路径。因为用到了modbus.h所以也需要指明modbus.h的路径。
如图中所示 -I指明了modbus.h的路径 -L指明了库所在的路径 -lmodbus指明了要链接的库。 注意:在linux中，libxxx.so文件，他的文件名在链接时只需要lib后的xxx，不需要打lib 比如要链接lib123.so 那就写 -l123即可，后缀也不用写。
编译完成后main放到开发板里运行即可
附上libmodbus函数的中文翻译libmodbus官方手册中文翻译_跃动的风的博客-CSDN博客_libmodbus使用说明" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7931feb9c5d662136591484085207c15/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-31T14:20:52+08:00" />
<meta property="article:modified_time" content="2022-05-31T14:20:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">libmodbus在ARM linux开发板上使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 id="3%E3%80%81%E7%A7%BB%E6%A4%8D%E6%88%90%E5%8A%9F-toc">一、源码下载</h2> 
<h4 id="1%E3%80%81libmodbus%E5%AE%98%E7%BD%91">1、libmodbus官网</h4> 
<p><a href="https://libmodbus.org/download/" rel="nofollow" title="libmodbus">libmodbus</a></p> 
<h4 id="2%E3%80%81%E9%80%89%E6%8B%A9%E9%95%BF%E6%9C%9F%E7%A8%B3%E5%AE%9A%E7%89%88%E6%9C%AClibmodbus-3.0.6.tar.gz">2、下载</h4> 
<p>选择长期稳定版本libmodbus-3.1.6.tar.gz</p> 
<p>3.拷贝到虚拟机</p> 
<p>通过fillzilla或者vmtools直接拖动到linux虚拟机中</p> 
<h2 id="%E4%BA%8C%E3%80%81%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91">二、交叉编译</h2> 
<h4 id="1%E3%80%81%E8%A7%A3%E5%8E%8B">1、解压</h4> 
<p>拷贝到相应目录，解压，例如拷贝在/home/modbus下，modbus目录需要自己创建</p> 
<p>在home/modbus下打开terminal 输入解压命令</p> 
<p>tar   -zxvf   libmodbus-3.1.6.tar.gz</p> 
<p>解压完成后在同目录下会生成 libmodbus-3.1.6文件夹，进入此文件夹</p> 
<p>cd  /home/modbus/libmodbus-3.1.6</p> 
<h4 id="2%E3%80%81%E5%88%9B%E5%BB%BA%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95">2、创建安装目录</h4> 
<p>在/home/modbus/libmodbus-3.1.6目录下创建一个install文件夹</p> 
<p>    sudo mkdir   install</p> 
<h4 id="4%E3%80%81%E9%85%8D%E7%BD%AE%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9">3、配置编译选项</h4> 
<p>在/home/modbus/libmodbus-3.1.6目录下，打开终端，进行配置编译选项</p> 
<p>（注：--prefix选项是安装目录，根据自己环境确定）</p> 
<p>./configure   --host=[交叉编译工具链前缀]   --enable-static   --prefix=[安装路径]/install/</p> 
<p>[安装路径]例如/usr/local/modbus，[交叉编译工具链]例如arm-none-linux-gnueabihf</p> 
<p> <span style="color:#fe2c24;">我最终程序是要用在ARM芯片上，所以交叉编译工具链这里我输入的是arm-none-linux-gnueabi 注意工具链一定要选对，否则一是makefile时，识别不了so文件，二是在开发板上无法运行。比如生成时用的是gnueabi，makefile时用的是gnueabihf 那就识别不了文件。</span></p> 
<p><span style="color:#0d0016;">如果你使用libmodbus就是用在linux服务器上的，那么编译工具链就输入gcc即可</span><span style="color:#fe2c24;">。</span></p> 
<p>我的configure示例:</p> 
<p>./configure   --host=arm-none-linux-gnueabihf      --prefix=/home/modbus/libmodbus-3.1.6/install</p> 
<h4 id="5%E3%80%81%E7%BC%96%E8%AF%91">5、编译&amp;安装</h4> 
<p>在/home/modbus/libmodbus-3.1.6目录下，打开终端，输入make 完成后再输入make install</p> 
<p>执行此功能后，会在install文件夹生成三个文件夹，include lib share   lib中包含了so库 include中包含了modbus.h的文件。 在编程时，要将include中的内容拷贝到自己项目中，<span style="color:#fe2c24;">lib里的 3个带so的文件要拷贝到虚拟机和开发板的 /usr/lib下。</span></p> 
<p></p> 
<p>6. 编写makefile</p> 
<p>    libmodbus是以so库的形式加载的，编写makefile时，要指明so库的路径。因为用到了modbus.h所以也需要指明modbus.h的路径。</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f9/ce/cIU7mdiX_o.jpg"></p> 
<p> 如图中所示 -I指明了modbus.h的路径 -L指明了库所在的路径 -lmodbus指明了要链接的库。 <span style="color:#fe2c24;">注意:在linux中，libxxx.so文件，他的文件名在链接时只需要lib后的xxx，不需要打lib  比如要链接lib123.so 那就写 -l123即可，后缀也不用写。</span></p> 
<p><span style="color:#0d0016;">编译完成后main放到开发板里运行即可</span></p> 
<p><img alt="" height="397" src="https://images2.imgbox.com/cb/14/Cfd2KKWB_o.png" width="395"></p> 
<p>附上libmodbus函数的中文翻译<a href="https://blog.csdn.net/qq_23670601/article/details/82155378" title="libmodbus官方手册中文翻译_跃动的风的博客-CSDN博客_libmodbus使用说明">libmodbus官方手册中文翻译_跃动的风的博客-CSDN博客_libmodbus使用说明</a></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6eada8f844b644293b1218cae9575136/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">详解OpenCV的视频背景/前景分割(背景建模/前景提取)类cv::BackgroundSubtractorMOG2,并利用它实现对道路监控视频前景/背景的提取</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/62410668d05111e8a180ecf0900891e4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ZYNQ处理器系统外部接口</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>