<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android逆向之实战逆向APP - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android逆向之实战逆向APP" />
<meta property="og:description" content="文章目录 前言逆向目标环境准备 开始逆向之旅抓包寻找解压密码so库逆向解压密码生成函数 总结 前言 Android逆向之指令集和CPU架构
Android逆向之必备前置知识
经过前2篇逆向前置知识的铺垫之后，我们终于要开始逆向实操了。以下操作主要是体现一下逆向的流程以及实操，为了安全考虑，并不会直接给出APP名称。
从目标出发，一步步去完成我们的目标，回头再看，大家就会发现，不过如此罢了。
逆向目标 获取APP中的某个功能，例如点击加载模型，模型会自带一些事件触发逻辑。博主的目的是拿到这部分事件逻辑的代码，参考一下。
例如下图的加载模型。
环境准备 安装有linux系统的电脑，此处以manjaro linux 23.1.0-1为例。安装有某APP的手机，此处以iPhone 13为例。linux系统上安装以下程序。 大家可以看到，安装的程序都是我们前置知识里面提过的，是必不可少的工具。 sudo pacman -Sy binutils python jadx radare2 sudo pip install mitmproxy 确保电脑和手机处于同一个网络，方便抓包操作。 开始逆向之旅 抓包 💻 在终端执行mitmweb命令, 此时会在默认浏览器中打开一个新的标签页，如下所示: 📱 在设置-&gt;无线局域网，点击已经连接的Wifi名称右边的编辑按钮，如下所示: 📱 在进入Wifi编译页之后，滚动到页面最下方，点击配置代理，选择手动，之后在出现的服务器输入框中输入电脑的IP地址,** 端口输入框中填写8080**，点击存储，如下所示: 📱 在默认浏览器中，此处为Safari, 打开 http://mitm.it, 滚动页面到对应平台处，此处为iOS, 按照页面提示的步骤，安装mitmproxy需要的CA证书，如下所示: 📱 打开 某 App，点击一个没有下载过的模型，触发下载，如下所示: 💻 在mitmweb打开的浏览器标签页，分析抓到的包列表，注意到有一个下载zip的请求，猜测是该模型对应的资源文件，如下所示: 💻 在终端执行以下命令，下载zip文件: wget http://cdn3.cooolar.com/model/b/e/5/5c6a65be57f782510b26bdb4/ios_192/5c6a65be57f782510b26bdb4.zip 💻 在终端执行以下命令，解压zip文件: unzip 5c6a65be57f782510b26bdb4.zip 提示需要输入解压密码，如下所示，这似乎进一步证实该zip包就是我们需要的模型资源文件。
接下来我们需要找到该zip包解压需要的密码。
寻找解压密码 💻 下载网址可以自己在网上找，当星网-绿色软件_最新绿色下载软件_免费软件下载网站 - 当星网这个网址可以下载到部分的APK文件。下载某APP的APK, 保存为 magicxx.apk。💻** **终端执行以下命令，解压出APK相应的资源文件和Java源码: 还记得吗，就是我们前置知识中说的jadx反编译工具 jadx -d magicxx magicxx." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/884c65808f24447f63045761a8f980a2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-20T19:56:30+08:00" />
<meta property="article:modified_time" content="2024-01-20T19:56:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android逆向之实战逆向APP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">前言</a></li><li><ul><li><a href="#_10" rel="nofollow">逆向目标</a></li><li><a href="#_14" rel="nofollow">环境准备</a></li></ul> 
   </li><li><a href="#_28" rel="nofollow">开始逆向之旅</a></li><li><ul><li><a href="#_30" rel="nofollow">抓包</a></li><li><a href="#_67" rel="nofollow">寻找解压密码</a></li><li><a href="#so_157" rel="nofollow">so库逆向</a></li><li><a href="#_190" rel="nofollow">解压密码生成函数</a></li></ul> 
   </li><li><a href="#_231" rel="nofollow">总结</a></li></ul> 
 </li></ul> 
</div> 
<br> 
 
<p></p> 
<h3><a id="_2"></a>前言</h3> 
<p><a href="https://blog.csdn.net/LJFPHP/article/details/135720523">Android逆向之指令集和CPU架构<br> </a><br> <a href="https://blog.csdn.net/LJFPHP/article/details/135720449">Android逆向之必备前置知识<br> </a><br> 经过前2篇逆向前置知识的铺垫之后，我们终于要开始逆向实操了。以下操作主要是体现一下逆向的流程以及实操，为了安全考虑，并不会直接给出APP名称。<br>从目标出发，一步步去完成我们的目标，回头再看，大家就会发现，不过如此罢了。</p> 
<p></p> 
<h4><a id="_10"></a>逆向目标</h4> 
<p>获取APP中的某个功能，例如点击加载模型，模型会自带一些事件触发逻辑。博主的目的是拿到这部分事件逻辑的代码，参考一下。<br>例如下图的加载模型。<br><img src="https://images2.imgbox.com/2a/e5/MVvMGltR_o.png" alt="image.png"></p> 
<p></p> 
<h4><a id="_14"></a>环境准备</h4> 
<ol><li>安装有linux系统的电脑，此处以<strong>manjaro linux 23.1.0-1</strong>为例。</li><li>安装有<strong>某APP</strong>的手机，此处以<strong>iPhone 13</strong>为例。</li><li>linux系统上安装以下程序。 
  <ol><li>大家可以看到，安装的程序都是我们前置知识里面提过的，是必不可少的工具。</li></ol> </li></ol> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> pacman <span class="token parameter variable">-Sy</span> binutils python jadx radare2
<span class="token function">sudo</span> pip <span class="token function">install</span> mitmproxy
</code></pre> 
<ol start="4"><li>确保电脑和手机处于同一个网络，方便抓包操作。</li></ol> 
<p></p> 
<h3><a id="_28"></a>开始逆向之旅</h3> 
<p></p> 
<h4><a id="_30"></a>抓包</h4> 
<ol><li>💻 在终端执行<strong>mitmweb</strong>命令, 此时会在默认浏览器中打开一个新的标签页，如下所示:</li></ol> 
<p><img src="https://images2.imgbox.com/5a/77/sVmsSjLQ_o.png" alt="image.png"></p> 
<ol start="2"><li>📱 在<strong>设置-&gt;无线局域网</strong>，点击已经连接的Wifi名称右边的编辑按钮，如下所示:</li></ol> 
<p><img src="https://images2.imgbox.com/6c/99/ciyZldYN_o.jpg" alt="IMG_3978.PNG.JPG"></p> 
<ol start="3"><li>📱 在进入Wifi编译页之后，滚动到页面最下方，点击配置代理，选择手动，之后在出现的服务器输入框中输入<strong>电脑的IP地址</strong>,** <strong>端口输入框中填写</strong>8080**，点击存储，如下所示:</li></ol> 
<p><img src="https://images2.imgbox.com/fe/3a/EJsICwWB_o.jpg" alt="x.jpg"></p> 
<ol start="4"><li>📱 在默认浏览器中，此处为Safari, 打开 <strong>http://mitm.it</strong>, 滚动页面到对应平台处，此处为iOS, 按照页面提示的步骤，安装mitmproxy需要的CA证书，如下所示:</li></ol> 
<p><img src="https://images2.imgbox.com/fa/01/jWNf2xzg_o.jpg" alt="x.jpg"></p> 
<ol start="5"><li>📱 打开 <strong>某</strong> App，点击一个没有下载过的模型，触发下载，如下所示:</li></ol> 
<p><img src="https://images2.imgbox.com/f6/21/YSLOF4U2_o.png" alt="image.png"></p> 
<ol start="6"><li>💻 在mitmweb打开的浏览器标签页，分析抓到的包列表，注意到有一个下载zip的请求，猜测是该模型对应的资源文件，如下所示:</li></ol> 
<p><img src="https://images2.imgbox.com/35/46/YfTbhzf2_o.png" alt="image.png"></p> 
<ol start="7"><li>💻 在终端执行以下命令，下载zip文件:</li></ol> 
<pre><code class="prism language-bash"><span class="token function">wget</span> http://cdn3.cooolar.com/model/b/e/5/5c6a65be57f782510b26bdb4/ios_192/5c6a65be57f782510b26bdb4.zip
</code></pre> 
<ol start="8"><li>💻 在终端执行以下命令，解压zip文件:</li></ol> 
<pre><code class="prism language-bash"><span class="token function">unzip</span> 5c6a65be57f782510b26bdb4.zip
</code></pre> 
<p>提示需要输入解压密码，如下所示，这似乎进一步证实该zip包就是我们需要的模型资源文件。<br><img src="https://images2.imgbox.com/df/9d/deOWbBHE_o.png" alt="image.png"><br>接下来我们需要找到该zip包解压需要的密码。<br> </p> 
<h4><a id="_67"></a>寻找解压密码</h4> 
<ol><li>💻 下载网址可以自己在网上找，<a href="https://www.downxing.com/" rel="nofollow">当星网-绿色软件_最新绿色下载软件_免费软件下载网站 - 当星网</a>这个网址可以下载到部分的APK文件。下载某APP的APK, 保存为 <strong>magicxx.apk</strong>。</li><li>💻** **终端执行以下命令，解压出APK相应的资源文件和Java源码: 
  <ol><li><strong>还记得吗，就是我们前置知识中说的jadx反编译工具</strong></li></ol> </li></ol> 
<pre><code class="prism language-bash">jadx <span class="token parameter variable">-d</span> magicxx magicxx.apk
<span class="token builtin class-name">cd</span> magicxx
</code></pre> 
<ol start="3"><li>💻 终端执行以下命令，查找zip相关的Java文件:</li></ol> 
<pre><code class="prism language-bash"><span class="token function">find</span> sources <span class="token parameter variable">-name</span> <span class="token string">"*zip*.java"</span>
</code></pre> 
<p>得到以下结果:</p> 
<pre><code>sources/net/lingala/zip4j/unzip/Unzip.java
sources/net/lingala/zip4j/unzip/UnzipEngine.java
sources/net/lingala/zip4j/unzip/UnzipUtil.java
sources/net/lingala/zip4j/model/UnzipParameters.java
sources/net/lingala/zip4j/model/UnzipEngineParameters.java
sources/com/xx/magicalar/mvp/view/model/IModelUnzipView.java
sources/okio/GzipSink.java
sources/okio/GzipSource.java
</code></pre> 
<p>应该是使用了<strong>net.lingala.zip4j</strong>库进行unzip操作。</p> 
<ol start="4"><li>💻 查看zip4j的<a href="https://javadoc.io/doc/net.lingala.zip4j/zip4j/2.2.4/index.html" rel="nofollow">API文档</a>，发现有一个setPassword函数:</li></ol> 
<p><img src="https://images2.imgbox.com/71/3b/OQFTzKva_o.png" alt="image.png"></p> 
<ol start="5"><li>💻 终端执行以下命令，搜索Java源码中使用setPassword函数的源码:</li></ol> 
<pre><code class="prism language-bash"><span class="token function">grep</span> <span class="token parameter variable">-r</span> setPassword sources
</code></pre> 
<p>得到以下结果:</p> 
<pre><code>sources/net/lingala/zip4j/core/HeaderReader.java:            localFileHeader.setPassword(fileHeader.getPassword());
sources/net/lingala/zip4j/core/ZipFile.java:    public void setPassword(String str) throws ZipException {
sources/net/lingala/zip4j/core/ZipFile.java:        setPassword(str.toCharArray());
sources/net/lingala/zip4j/core/ZipFile.java:    public void setPassword(char[] cArr) throws ZipException {
sources/net/lingala/zip4j/core/ZipFile.java:                ((FileHeader) this.zipModel.getCentralDirectory().getFileHeaders().get(i)).setPassword(cArr);
sources/net/lingala/zip4j/model/ZipParameters.java:    public void setPassword(String str) {
sources/net/lingala/zip4j/model/ZipParameters.java:        setPassword(str.toCharArray());
sources/net/lingala/zip4j/model/ZipParameters.java:    public void setPassword(char[] cArr) {
sources/net/lingala/zip4j/model/FileHeader.java:    public void setPassword(char[] cArr) {
sources/net/lingala/zip4j/model/LocalFileHeader.java:    public void setPassword(char[] cArr) {
sources/com/xx/magicalar/retrofitUtils/downmodel/DownLoadUtil.java:                            zipFile.setPassword(MD5_1.substring(MD5_1.length() - 10).toCharArray());
sources/com/xx/magicalar/retrofitUtils/scandown/ScanDownUtils.java:                        zipFile.setPassword(MD5_1.substring(MD5_1.length() - 10).toCharArray());
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleDrawable(int i) {
sources/android/support/design/widget/TextInputLayout.java:        setPasswordVisibilityToggleDrawable(i != 0 ? AppCompatResources.getDrawable(getContext(), i) : null);
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleDrawable(Drawable drawable) {
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleContentDescription(int i) {
sources/android/support/design/widget/TextInputLayout.java:        setPasswordVisibilityToggleContentDescription(i != 0 ? getResources().getText(i) : null);
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleContentDescription(CharSequence charSequence) {
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleEnabled(boolean z) {
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleTintList(ColorStateList colorStateList) {
sources/android/support/design/widget/TextInputLayout.java:    public void setPasswordVisibilityToggleTintMode(PorterDuff.Mode mode) {
sources/android/support/v4/widget/ExploreByTouchHelper.java:        obtain.setPassword(obtainAccessibilityNodeInfo.isPassword());
sources/android/support/v4/view/accessibility/AccessibilityRecordCompat.java:    public void setPassword(boolean z) {
sources/android/support/v4/view/accessibility/AccessibilityRecordCompat.java:        this.mRecord.setPassword(z);
sources/android/support/v4/view/accessibility/AccessibilityNodeInfoCompat.java:    public void setPassword(boolean z) {
sources/android/support/v4/view/accessibility/AccessibilityNodeInfoCompat.java:        this.mInfo.setPassword(z);
</code></pre> 
<p>其中<strong>sources/com/xx/magicalar/retrofitUtils/downmodel/DownLoadUtil.java</strong>中的setPassword调用应该是和模型下载之后解压相关的。</p> 
<ol start="6"><li>💻 打开<strong>sources/com/xx/magicalar/retrofitUtils/downmodel/DownLoadUtil.java</strong>，找到setPassword调用的地方，只有436行一处调用，如下所示:</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>zipFile<span class="token punctuation">.</span><span class="token function">isEncrypted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> substring <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">".zip"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token constant">MD5_1</span> <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">MD5_1</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>substring<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>substring<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Constant</span><span class="token punctuation">.</span><span class="token function">getZipSecret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    zipFile<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token constant">MD5_1</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token constant">MD5_1</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
zipFile<span class="token punctuation">.</span><span class="token function">extractAll</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>看到密码是通过<strong>zip文件名</strong>以及<strong>Constant.getZipSecret()<strong>函数的返回值计算MD5得到的。其中zip文件名是</strong>5c6a65be57f782510b26bdb4.zip</strong>，还需要得到**Constant.getZipSecret()**返回值。</p> 
<ol start="7"><li>💻 终端执行以下命令，搜索Java源码中<strong>getZipSecret</strong>函数的定义: 
  <ol><li><strong>这里涉及到了Android的native层，前置知识中提到过</strong></li></ol> </li></ol> 
<pre><code class="prism language-bash"><span class="token function">grep</span> <span class="token parameter variable">-r</span> getZipSecret sources
</code></pre> 
<p>得到以下结果:</p> 
<pre><code>sources/com/xx/magicalar/retrofitUtils/downmodel/DownLoadUtil.java:                            String MD5_1 = Signature.MD5_1(new Object[]{substring.substring(substring.length() - 10), Constant.getZipSecret()});
sources/com/xx/magicalar/retrofitUtils/scandown/ScanDownUtils.java:                        String MD5_1 = Signature.MD5_1(new Object[]{substring.substring(substring.length() - 10), Constant.getZipSecret()});
sources/com/xx/magicalar/common/Constant.java:    public static native String getZipSecret();
</code></pre> 
<p>看到该函数是以<strong>native</strong>方式定义在Constant.java中的。需要去APK中的<strong>so库</strong>中寻找<strong>getZipSecret()<strong>函数的实现</strong>。</strong><br> </p> 
<h4><a id="so_157"></a>so库逆向</h4> 
<ol><li>💻 在终端执行以下命令，搜索包含<strong>getZipSecret</strong>相关信息的so库:</li></ol> 
<pre><code class="prism language-bash"><span class="token function">ls</span> resources/lib/armeabi-v7a/*.so <span class="token operator">|</span> <span class="token function">xargs</span> nm <span class="token parameter variable">-A</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">"no symbols"</span> <span class="token operator">|</span> c++filt <span class="token operator">|</span> <span class="token function">grep</span> getZipSecret
</code></pre> 
<p>得到以下结果:</p> 
<pre><code>resources/lib/armeabi-v7a/libnative-lib.so:000116c9 T Java_com_qjtc_magicalar_common_Constant_getZipSecret
</code></pre> 
<p>在<strong>libnative-lib.so</strong>中有<strong>Java_com_xx_magicalar_common_Constant_getZipSecret</strong>函数的定义。</p> 
<ol start="2"><li>💻 在终端执行以下命令，使用<strong>radare2</strong>分析<strong>libnative-lib.so</strong>: 
  <ol><li><strong>重头戏来了，二进制文件分析</strong></li></ol> </li></ol> 
<pre><code class="prism language-bash">r2 resources/lib/armeabi-v7a/libnative-lib.so
</code></pre> 
<ol start="3"><li>💻 在radare2程序中，依次执行以下命令 
  <ol><li><strong>aaaa</strong>：分析这个二进制文件</li><li><strong>s sym.Java_com_qjtc_magicalar_common_Constant_getZipSecret</strong>指令 ：跳转到指定函数地址</li></ol> </li></ol> 
<p>然后我们跳转到<strong>Java_com_qjtc_magicalar_common_Constant_getZipSecret</strong>函数起始地址处, 如下所示:<br><img src="https://images2.imgbox.com/0e/95/vfd0XCRa_o.png" alt="image.png"></p> 
<ol start="4"><li>💻 在radare2程序中，执行<strong>pdf</strong>指令，查看<strong>Java_com_xx_magicalar_common_Constant_getZipSecret</strong>函数的实现, 如下所示: 
  <ol><li><strong>没错，开始需要汇编知识了</strong></li></ol> </li></ol> 
<p><img src="https://images2.imgbox.com/bc/82/TUihcCj8_o.png" alt="image.png"></p> 
<ol start="5"><li>💻 分析函数代码，看到在<strong>libnative-lib.so</strong>文件的<strong>0xf8d5</strong>处有一串字符串<strong>d(EcaK#9cBQL</strong>，就是需要的secret:</li></ol> 
<p><img src="https://images2.imgbox.com/b7/b6/RcNqnOtr_o.png" alt="image.png"><br> </p> 
<h4><a id="_190"></a>解压密码生成函数</h4> 
<p>💻 根据得到的secret数据<strong>d(EcaK#9cBQL</strong>, 以及之前的相关的Java源码:</p> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>zipFile<span class="token punctuation">.</span><span class="token function">isEncrypted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> substring <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">".zip"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token constant">MD5_1</span> <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">MD5_1</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>substring<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>substring<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Constant</span><span class="token punctuation">.</span><span class="token function">getZipSecret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    zipFile<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token constant">MD5_1</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token constant">MD5_1</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
zipFile<span class="token punctuation">.</span><span class="token function">extractAll</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>重新使用Python实现如下代码，保存成<strong>unzip.py</strong>:</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> sys

ZipSecret <span class="token operator">=</span> <span class="token string">'d(EcaK#9cBQL'</span>


<span class="token keyword">def</span> <span class="token function">genPassword</span><span class="token punctuation">(</span>zipFile<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    substring <span class="token operator">=</span> zipFile<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>zipFile<span class="token punctuation">.</span>index<span class="token punctuation">(</span><span class="token string">'.zip'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">(</span>substring<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> ZipSecret<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> md5<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>genPassword<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>在终端执行以下代码，</p> 
<pre><code class="prism language-bash">python unzip.py 5c6a65be57f782510b26bdb4.zip
</code></pre> 
<p>得到解压密码为 <strong>1cfa866766</strong>, 执行 <strong>unzip 5c6a65be57f782510b26bdb4.zip</strong>, 输入加压密码，正常解压。最终得到如下内容:</p> 
<pre><code class="prism language-bash">5c6a65be57f782510b26bdb4
├── 5c6a65be57f782510b26bdb4.bytes
├── 5c6a65be57f782510b26bdb4.png
└── LuaProject
    └── main.lua
</code></pre> 
<p>查看5c6a65be57f782510b26bdb4.png文件，的确是我们下载的模型的缩略图。而这个main.lua就是我们想要参考的事件逻辑代码了。</p> 
<p></p> 
<h3><a id="_231"></a>总结</h3> 
<p>是的，整体流程也许没有大家想象中的那么神秘，但我们确实是实现了最初的逆向目标。在整个流程中也用到了前面提到的必备前置知识。大家可以举一反三，比如逆向目标变成下载所有的模型？比如逆向目标变成更改源代码重新打包？比如逆向目标变成检测自己公司内APP的安全性？ 等等。</p> 
<p>逆向不是银弹，有逆向自然也有防御。逆向的目标并不是只有破坏，很多逆向操作反而是为了完善自己的安全策略。所以呢，<strong>技术没有好坏，有好坏的是使用技术的人。</strong></p> 
<p>再会了各位！</p> 
<p><strong>end</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9ffaa87f6275ee97fe6ce3b3293af4fc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Qt 5.15.2 (MSVC 2019）编译 QWT 6.2.0 : 编译MingW或MSVC遇到的坑</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8a27493b61144ce46ea31aba07561065/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL之索引结构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>