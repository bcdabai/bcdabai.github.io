<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JAVA对接海康威视开发文档 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JAVA对接海康威视开发文档" />
<meta property="og:description" content="日前根据公司需求需要对接海康威视的硬件设备信息。因此特地研究了其开发文档。
萤石开发文档：https://open.ys7.com/help/82
根据业务需求；报警设备安装到所需地址；有人按报警后我们系统会接受该报警消息；可以远程对该报警设备进行操作，比如一键消警。
首先到萤石平台注册开发账号（https://open.ys7.com/cn/s/index）
其次，会得到账号的一些私钥等信息。
然后调用萤石文档提供的获取token接口；可以获取token 信息；每次生成的token有效期是七天。根据自己业务需求可以进行token保存处理。
最后就是利用token进行获取设备信息等操作。
private static Logger logger= LoggerFactory.getLogger(DeviceInfoApi.class); /** * 网关设备信息获取 * @param apiMap * @return */ public static String getDeviceInfoList(String token,String url,String pageStart,String pageSize) throws Exception { Map&lt;String, String&gt; map= new HashMap&lt;&gt;(); map.put(&#34;accessToken&#34;,token); //分页默认0 map.put(&#34;pageStart&#34;,pageStart); //分页大小，默认为10，最大为50：50无效；设置为50返回数据仍为10 map.put(&#34;pageSize&#34;,pageSize); String jsonStr = HttpClientUtil.doPost(url,map); return jsonStr; } /** * * 获取网关设备明细信息 * @return * */ public static String getGatWayDeviceDetail(String token,String url,String deviceSerial){ String message=null; Map&lt;String, String&gt; param=new HashMap&lt;&gt;(); param." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5e5e5802d09989f91ec114432d40bb81/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-18T15:25:40+08:00" />
<meta property="article:modified_time" content="2022-07-18T15:25:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JAVA对接海康威视开发文档</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>日前根据公司需求需要对接海康威视的硬件设备信息。因此特地研究了其开发文档。<br> 萤石开发文档：<a href="https://open.ys7.com/help/82" rel="nofollow">https://open.ys7.com/help/82</a><br> 根据业务需求；报警设备安装到所需地址；有人按报警后我们系统会接受该报警消息；可以远程对该报警设备进行操作，比如一键消警。<br> 首先到萤石平台注册开发账号<a href="https://open.ys7.com/cn/s/index" rel="nofollow">（https://open.ys7.com/cn/s/index）</a></p> 
<p>其次，会得到账号的一些私钥等信息。<br> <img src="https://images2.imgbox.com/54/37/ZoHE7lfW_o.png" alt="在这里插入图片描述"><br> <strong>然后调用萤石文档提供的获取token接口</strong>；可以获取token 信息；每次生成的token有效期是七天。根据自己业务需求可以进行token保存处理。</p> 
<p><strong>最后就是利用token进行获取设备信息等操作</strong>。</p> 
<pre><code>private static Logger logger= LoggerFactory.getLogger(DeviceInfoApi.class);
/**
 * 网关设备信息获取
 * @param apiMap
 * @return
 */
public static String getDeviceInfoList(String token,String url,String pageStart,String pageSize) throws Exception {

    Map&lt;String, String&gt; map= new HashMap&lt;&gt;();
    map.put("accessToken",token);
    //分页默认0
    map.put("pageStart",pageStart);
    //分页大小，默认为10，最大为50：50无效；设置为50返回数据仍为10
    map.put("pageSize",pageSize);

    String jsonStr = HttpClientUtil.doPost(url,map);
    return jsonStr;
}


/**
 *
 * 获取网关设备明细信息
 * @return
 *
 */
public static String getGatWayDeviceDetail(String token,String url,String deviceSerial){
    String message=null;
    Map&lt;String, String&gt; param=new HashMap&lt;&gt;();
    param.put("accessToken",token);
    //设备序列号,存在英文字母的设备序列号，字母需为大写
    param.put("deviceSerial",deviceSerial);
    message = HttpClientUtil.doPost(url,param);
    logger.info(message);
    return message;
}


/**
 *
 * 根据网关查询子设备信息列表
 * @return
 *
 */
public static String getGatWaySonDeviceList(String token,String url,String deviceSerial){
    String message=null;
    Map&lt;String, String&gt; param=new HashMap&lt;&gt;(10);
    param.put("accessToken",token);
    //HUB设备序列号,存在英文字母的设备序列号，字母需为大写
    param.put("deviceSerial",deviceSerial);
    message = HttpClientUtil.doPost(url,param);
    logger.info(message);
    return message;
}


public  static String  getAccessToken(){
	//获取token信息
    String requestUrl = "https://open.ys7.com/api/lapp/token/get";
    String access = null;

    try {
        Map&lt;String, String&gt; param=new HashMap&lt;&gt;();
        param.put("appKey",appKey);
        param.put("appSecret",appSecret);

        String resmsg = HttpClientUtil.doPost(requestUrl,param);
        JsonNode node =  mapper.readTree(resmsg);
        access = node.get("data").get("accessToken").asText();
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
    return access;
}

/**
 *
 * 获取摄像头列表
 * @return
 *
 */
public static String getCameraDeviceList(String token,String url,String pageStart,String pageSize){
    String message=null;
    Map&lt;String, String&gt; param=new HashMap&lt;&gt;(10);
    param.put("accessToken",token);
    //分页默认0
    param.put("pageStart",pageStart);
    //分页大小，默认为10，最大为50
    param.put("pageSize",pageSize);
    message = HttpClientUtil.doPost(url,param);
    logger.info(message);
    return message;
}





/**
 *一键取消报警
 * @return
 */
public static String cancelCall(String url,String token,String deviceSerial){

    String message=null;
    Map&lt;String, String&gt; param=new HashMap&lt;&gt;(10);
    param.put("accessToken",token);
    param.put("deviceSerial",deviceSerial);
    message = HttpClientUtil.doPost(url,param);
    logger.info(message);
    return message;
}


/**
 *
 * 根据设备序列号获取摄像头播放地址
 * accessToken：token
 * deviceSerial:设备序列号
 * channelNo:通道号
 * @return
 */
public static String getCameraLivingRomme(String url,String token,String deviceSerial,String channelNo ){
    String mes = null;
    Map&lt;String, String&gt; param=new HashMap&lt;&gt;(10);
    param.put("accessToken",token);
    //硬盘录像机设备序列表
    param.put("deviceSerial",deviceSerial);
    //通道号(表示不同摄像头)：默认为1
    param.put("channelNo",channelNo);
    mes = HttpClientUtil.doPost(url,param);
    return mes;

}
</code></pre> 
<p>}</p> 
<p>关于对接海康威视开发文档；就这么多了；其次还有就是硬件接口的对接。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/009682e7390f88e6053c8a5c554f3d6b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python 程序设计练习1.2</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/de2425f729a9dbbc6ca26b7d6a35e6c6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">记一个laravel问题Script @php artisan package:discover handling the post-autoload-dump event returned with</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>