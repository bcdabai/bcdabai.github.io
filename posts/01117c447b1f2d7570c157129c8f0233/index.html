<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>线性判别分析(LDA)和python实现（多分类问题） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="线性判别分析(LDA)和python实现（多分类问题）" />
<meta property="og:description" content="上一篇写过线性判别分析处理二分类问题https://blog.csdn.net/z962013489/article/details/79871789，当使用LDA处理多分类问题时，通常是作为一个降维工具来使用的。若我们有一个D维的样本集，该样本集包含C个类别共n个样本，希望将D维降维成K维。之前在二分类问题中，我们定义的类间散度矩阵为：
Sb=(μ1−μ2)(μ1−μ2)T S b = ( μ 1 − μ 2 ) ( μ 1 − μ 2 ) T 当类别为3时就已经不再适用，在这里引出全局散度矩阵的概念：
St=Sw&#43;Sb=∑i=1n(xi−μ)(xi−μ)T S t = S w &#43; S b = ∑ i = 1 n ( x i − μ ) ( x i − μ ) T 其中 μ μ 为整个样本集的均值向量，其中的类内散度矩阵 Sw S w 定义为所有类别的散度矩阵之和，与二分类类似，基于全局散度矩阵，我们就可以求得类间散度矩阵 Sb S b 定义为： Sb=St−Sw=∑i=1nmi(μi−μ)(μi−μ)T S b = S t − S w = ∑ i = 1 n m i ( μ i − μ ) ( μ i − μ ) T 其中 mi m i 为第i个类别样本总数， μi μ i 为第i个类别样本的均值向量。 上图的例子可以作为参考便于理解。 我们要计算一个W矩阵，使样本向量在该投影矩阵的作用下能够实现其与同类样本的中心距离尽量小，而与异类样本的中心距离尽量大。常见的一种优化目标为： maxWtr(WTSbW)tr(WTSwW) max W t r ( W T S b W ) t r ( W T S w W ) 其中的tr()为矩阵的迹，一个n×n的对角矩阵A的主对角线（从左上方至右下方的对角线）上各个元素的总和被称为矩阵A的迹（或迹数），一般记作tr(A)。 这个优化目标实际上等价于求解多个w组合成W，那么该问题就等价于求解多个上一章的优化目标，使用相同的方法，可以求得下式： SbW=λSwW S b W = λ S w W 即 S−1wSbW=λW S w − 1 S b W = λ W W的闭式解为 S−1wSb S w − 1 S b 的k个最大非零广义特征值对应的特征向量组成的矩阵，LDA降维最多可以降至C-1，C为样本类别数，与原始特征维数n无关。 使用python实现LDA降维代码，对Iris数据集从四维降至二维，绘图如下： 其中上图为自己实现的方法降维表现，下图为sklearn自带方法降维表现。 python3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/01117c447b1f2d7570c157129c8f0233/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-12T20:29:26+08:00" />
<meta property="article:modified_time" content="2018-04-12T20:29:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">线性判别分析(LDA)和python实现（多分类问题）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>上一篇写过线性判别分析处理二分类问题<a href="https://blog.csdn.net/z962013489/article/details/79871789">https://blog.csdn.net/z962013489/article/details/79871789</a>，当使用LDA处理多分类问题时，通常是作为一个降维工具来使用的。若我们有一个D维的样本集，该样本集包含C个类别共n个样本，希望将D维降维成K维。之前在二分类问题中，我们定义的类间散度矩阵为：<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;"> 
   
   <span class="math" id="MathJax-Span-1" style="width: 13.316em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.826em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.12em 1010.83em 2.594em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mi" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.257em;">(</span><span class="msubsup" id="MathJax-Span-10"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-12"><span class="mrow" id="MathJax-Span-13"><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="msubsup" id="MathJax-Span-16" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-18"><span class="mrow" id="MathJax-Span-19"><span class="mn" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-23"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-25"><span class="mrow" id="MathJax-Span-26"><span class="mn" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="msubsup" id="MathJax-Span-29" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-31"><span class="mrow" id="MathJax-Span-32"><span class="mn" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.102em 1000.31em 4.423em -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.409em;"><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span> 
  <span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block"> 
    
     
     
       S 
      
      
      
        b 
       
      
     
    
      = 
     
    
      ( 
     
     
     
       μ 
      
      
      
        1 
       
      
     
    
      − 
     
     
     
       μ 
      
      
      
        2 
       
      
     
    
      ) 
     
    
      ( 
     
     
     
       μ 
      
      
      
        1 
       
      
     
    
      − 
     
     
     
       μ 
      
      
      
        2 
       
      
     
     
     
       ) 
      
      
      
        T 
       
      
     
   </span></span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-1">S_{b}=(\mu _{1}-\mu _{2})(\mu _{1}-\mu _{2})^{T}</script> 
<p></p> 
<p>当类别为3时就已经不再适用，在这里引出全局散度矩阵的概念：<span class="MathJax_Preview" style="color: inherit; display: none;"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="text-align: center; position: relative;"> 
   
   <span class="math" id="MathJax-Span-39" style="width: 19.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.856em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.46em 1015.86em 3.559em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-40"><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-43"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-47" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-49"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.206em;">+</span><span class="msubsup" id="MathJax-Span-53" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-59" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em 1001.37em 4.627em -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em 1001.12em 4.271em -999.997em); top: -2.945em; left: 0.155em;"><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em 1000.41em 4.169em -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.51em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-72"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">μ</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.51em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.561em;"><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">μ</span><span class="msubsup" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.102em 1000.31em 4.423em -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.409em;"><span class="texatom" id="MathJax-Span-88"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span> 
  <span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block"> 
    
     
     
       S 
      
      
      
        t 
       
      
     
    
      = 
     
     
     
       S 
      
      
      
        w 
       
      
     
    
      + 
     
     
     
       S 
      
      
      
        b 
       
      
     
    
      = 
     
     
     
       ∑ 
      
      
      
        i 
       
      
        = 
       
      
        1 
       
      
      
      
        n 
       
      
     
    
      ( 
     
     
     
       x 
      
      
      
        i 
       
      
     
    
      − 
     
    
      μ 
     
    
      ) 
     
    
      ( 
     
     
     
       x 
      
      
      
        i 
       
      
     
    
      − 
     
    
      μ 
     
     
     
       ) 
      
      
      
        T 
       
      
     
   </span></span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-2">S_{t}=S_{w}+S_{b}=\sum_{i=1}^{n}(x_{i}-\mu)(x_{i}-\mu)^{T}</script> 
<p></p> 
<p>其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-91" style="width: 0.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.612em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em 1000.61em 2.543em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      μ 
     
   </span></span><script type="math/tex" id="MathJax-Element-3">\mu </script> 为整个样本集的均值向量，其中的类内散度矩阵<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-94" style="width: 1.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em 1001.22em 2.492em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-95"><span class="msubsup" id="MathJax-Span-96"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       S 
      
      
      
        w 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-4">S_{w}</script>定义为所有类别的散度矩阵之和，与二分类类似，基于全局散度矩阵，我们就可以求得类间散度矩阵<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-101" style="width: 1.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em 1001.02em 2.492em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       S 
      
      
      
        b 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-5">S_{b}</script>定义为： <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="text-align: center; position: relative;"> 
   
   <span class="math" id="MathJax-Span-108" style="width: 21.192em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.228em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.46em 1017.23em 3.559em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-109"><span class="msubsup" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="msubsup" id="MathJax-Span-116" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-118"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="msubsup" id="MathJax-Span-122" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="munderover" id="MathJax-Span-128" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 1.425em; height: 0px;"><span style="position: absolute; clip: rect(2.899em 1001.37em 4.627em -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em 1001.12em 4.271em -999.997em); top: -2.945em; left: 0.155em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.458em 1000.41em 4.169em -999.997em); top: -5.18em; left: 0.511em;"><span class="texatom" id="MathJax-Span-135"><span class="mrow" id="MathJax-Span-136"><span class="mi" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-138" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.87em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.866em;"><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">μ</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-155"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.206em;">−</span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic; padding-left: 0.206em;">μ</span><span class="msubsup" id="MathJax-Span-160"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px;"><span style="position: absolute; clip: rect(3.102em 1000.31em 4.423em -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.418em; left: 0.409em;"><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span> 
  <span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block"> 
    
     
     
       S 
      
      
      
        b 
       
      
     
    
      = 
     
     
     
       S 
      
      
      
        t 
       
      
     
    
      − 
     
     
     
       S 
      
      
      
        w 
       
      
     
    
      = 
     
     
     
       ∑ 
      
      
      
        i 
       
      
        = 
       
      
        1 
       
      
      
      
        n 
       
      
     
     
     
       m 
      
      
      
        i 
       
      
     
    
      ( 
     
     
     
       μ 
      
      
      
        i 
       
      
     
    
      − 
     
    
      μ 
     
    
      ) 
     
    
      ( 
     
     
     
       μ 
      
      
      
        i 
       
      
     
    
      − 
     
    
      μ 
     
     
     
       ) 
      
      
      
        T 
       
      
     
   </span></span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-6">S_{b}=S_{t}-S_{w}=\sum_{i=1}^{n}m_{i}(\mu _{i}-\mu )(\mu _{i}-\mu )^{T}</script> 
<br> 其中 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span> 
<span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;"> 
  
  <span class="math" id="MathJax-Span-165" style="width: 1.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em 1001.22em 2.492em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.87em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.866em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span> 
 <span class="MJX_Assistive_MathML"> 
   
    
    
      m 
     
     
     
       i 
      
     
    
  </span></span><script type="math/tex" id="MathJax-Element-7">m_{i}</script>为第i个类别样本总数， 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span> 
<span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;"> 
  
  <span class="math" id="MathJax-Span-172" style="width: 1.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.578em 1000.92em 2.543em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-173"><span class="msubsup" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1000.56em 4.372em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
 <span class="MJX_Assistive_MathML"> 
   
    
    
      μ 
     
     
     
       i 
      
     
    
  </span></span><script type="math/tex" id="MathJax-Element-8">\mu _{i}</script>为第i个类别样本的均值向量。 
<p></p> 
<p></p> 
<center> 
 <img src="https://images2.imgbox.com/e8/6b/iuFRGlth_o.jpg" alt="这里写图片描述" title=""> 
</center> 
<p></p> 
<p>上图的例子可以作为参考便于理解。 <br> 我们要计算一个W矩阵，使样本向量在该投影矩阵的作用下能够实现其与同类样本的中心距离尽量小，而与异类样本的中心距离尽量大。常见的一种优化目标为： <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span></p> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;"> 
   
   <span class="math" id="MathJax-Span-179" style="width: 9.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.879em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(0.46em 1007.88em 3.305em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="munderover" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px;"><span style="position: absolute; clip: rect(3.407em 1001.83em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.356em 1000.76em 4.271em -999.997em); top: -3.351em; left: 0.561em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-186" style="padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 5.643em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.001em 1005.24em 4.423em -999.997em); top: -4.723em; left: 50%; margin-left: -2.64em;"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px;"><span style="position: absolute; clip: rect(3.204em 1001.07em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.367em; left: 1.12em;"><span class="texatom" id="MathJax-Span-193"><span class="mrow" id="MathJax-Span-194"><span class="mi" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-196"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.102em 1005.44em 4.423em -999.997em); top: -3.3em; left: 50%; margin-left: -2.741em;"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-207"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px;"><span style="position: absolute; clip: rect(3.204em 1001.07em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.317em; left: 1.12em;"><span class="texatom" id="MathJax-Span-209"><span class="mrow" id="MathJax-Span-210"><span class="mi" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.866em 1005.64em 1.222em -999.997em); top: -1.268em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.643em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span> 
  <span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block"> 
    
     
     
       max 
      
      
      
        W 
       
      
     
     
      
      
        t 
       
      
        r 
       
      
        ( 
       
       
       
         W 
        
        
        
          T 
         
        
       
       
       
         S 
        
        
        
          b 
         
        
       
      
        W 
       
      
        ) 
       
      
      
      
        t 
       
      
        r 
       
      
        ( 
       
       
       
         W 
        
        
        
          T 
         
        
       
       
       
         S 
        
        
        
          w 
         
        
       
      
        W 
       
      
        ) 
       
      
     
   </span></span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-9">\max_{W}\frac{tr(W^{T}S_{b}W)}{tr(W^{T}S_{w}W)}</script> 
<br> 其中的tr()为矩阵的迹，一个n×n的对角矩阵A的主对角线（从左上方至右下方的对角线）上各个元素的总和被称为矩阵A的迹（或迹数），一般记作tr(A)。 
<br> 这个优化目标实际上等价于求解多个w组合成W，那么该问题就等价于求解多个上一章的优化目标，使用相同的方法，可以求得下式： 
<br> 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="text-align: center; position: relative;"> 
   
   <span class="math" id="MathJax-Span-219" style="width: 7.624em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.202em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.324em 1006.2em 2.492em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-220"><span class="msubsup" id="MathJax-Span-221"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">λ</span><span class="msubsup" id="MathJax-Span-229"><span style="display: inline-block; position: relative; width: 1.222em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-231"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span> 
  <span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block"> 
    
     
     
       S 
      
      
      
        b 
       
      
     
    
      W 
     
    
      = 
     
    
      λ 
     
     
     
       S 
      
      
      
        w 
       
      
     
    
      W 
     
   </span></span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-10">S_{b}W=\lambda S_{w}W</script> 
<br> 即 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span> 
<div class="MathJax_Display" style="text-align: center;"> 
 <span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="text-align: center; position: relative;"> 
   
   <span class="math" id="MathJax-Span-235" style="width: 8.183em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.659em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.171em 1006.66em 2.492em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="msubsup" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em 1000.97em 4.22em -999.997em); top: -4.418em; left: 0.714em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mo" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.559em 1000.56em 4.169em -999.997em); top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-243"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.257em;">=</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic; padding-left: 0.257em;">λ</span><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block"> 
    
     
     
       S 
      
      
      
        w 
       
      
      
      
        − 
       
      
        1 
       
      
     
     
     
       S 
      
      
      
        b 
       
      
     
    
      W 
     
    
      = 
     
    
      λ 
     
    
      W 
     
   </span></span> 
</div><script type="math/tex; mode=display" id="MathJax-Element-11">S_{w}^{-1}S_{b}W=\lambda W</script> 
<br> W的闭式解为 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span> 
<span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;"> 
  
  <span class="math" id="MathJax-Span-255" style="width: 3.305em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.696em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(1.171em 1002.7em 2.492em -999.997em); top: -2.182em; left: 0em;"><span class="mrow" id="MathJax-Span-256"><span class="msubsup" id="MathJax-Span-257"><span style="display: inline-block; position: relative; width: 1.679em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.407em 1000.97em 4.22em -999.997em); top: -4.418em; left: 0.714em;"><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="mo" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.559em 1000.56em 4.169em -999.997em); top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-266"><span style="display: inline-block; position: relative; width: 1.019em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.66em 4.169em -999.997em); top: -4.012em; left: 0em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.859em; left: 0.612em;"><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.188em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
 <span class="MJX_Assistive_MathML"> 
   
    
    
      S 
     
     
     
       w 
      
     
     
     
       − 
      
     
       1 
      
     
    
    
    
      S 
     
     
     
       b 
      
     
    
  </span></span><script type="math/tex" id="MathJax-Element-12">S_{w}^{-1}S_{b}</script>的k个最大非零广义特征值对应的特征向量组成的矩阵，LDA降维最多可以降至C-1，C为样本类别数，与原始特征维数n无关。 
<br> 使用python实现LDA降维代码，对Iris数据集从四维降至二维，绘图如下： 
<br> 其中上图为自己实现的方法降维表现，下图为sklearn自带方法降维表现。 
<br> 
<p></p> 
<center> 
 <img src="https://images2.imgbox.com/ec/98/0tLCCFsA_o.png" alt="这里写图片描述" title=""> 
 <br> 
 <img src="https://images2.imgbox.com/49/6c/oJ1ysgLR_o.png" alt="这里写图片描述" title=""> 
</center> 
<p></p> 
<p>python3.6实现如下：</p> 
<pre class="prettyprint"><code class=" hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_iris
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> sklearn.discriminant_analysis <span class="hljs-keyword">import</span> LinearDiscriminantAnalysis


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">LDA_dimensionality</span><span class="hljs-params">(X, y, k)</span>:</span>
    <span class="hljs-string">'''
    X为数据集，y为label，k为目标维数
    '''</span>
    label_ = list(set(y))

    X_classify = {}

    <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> label_:
        X1 = np.array([X[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(X)) <span class="hljs-keyword">if</span> y[i] == label])
        X_classify[label] = X1

    mju = np.mean(X, axis=<span class="hljs-number">0</span>)
    mju_classify = {}

    <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> label_:
        mju1 = np.mean(X_classify[label], axis=<span class="hljs-number">0</span>)
        mju_classify[label] = mju1

    <span class="hljs-comment">#St = np.dot((X - mju).T, X - mju)</span>

    Sw = np.zeros((len(mju), len(mju)))  <span class="hljs-comment"># 计算类内散度矩阵</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> label_:
        Sw += np.dot((X_classify[i] - mju_classify[i]).T,
                     X_classify[i] - mju_classify[i])

    <span class="hljs-comment"># Sb=St-Sw</span>

    Sb = np.zeros((len(mju), len(mju)))  <span class="hljs-comment"># 计算类内散度矩阵</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> label_:
        Sb += len(X_classify[i]) * np.dot((mju_classify[i] - mju).reshape(
            (len(mju), <span class="hljs-number">1</span>)), (mju_classify[i] - mju).reshape((<span class="hljs-number">1</span>, len(mju))))

    eig_vals, eig_vecs = np.linalg.eig(
        np.linalg.inv(Sw).dot(Sb))  <span class="hljs-comment"># 计算Sw-1*Sb的特征值和特征矩阵</span>

    sorted_indices = np.argsort(eig_vals)
    topk_eig_vecs = eig_vecs[:, sorted_indices[:-k - <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]]  <span class="hljs-comment"># 提取前k个特征向量</span>
    <span class="hljs-keyword">return</span> topk_eig_vecs


<span class="hljs-keyword">if</span> <span class="hljs-string">'__main__'</span> == __name__:

    iris = load_iris()
    X = iris.data
    y = iris.target

    W = LDA_dimensionality(X, y, <span class="hljs-number">2</span>)
    X_new = np.dot((X), W)
    plt.figure(<span class="hljs-number">1</span>)
    plt.scatter(X_new[:, <span class="hljs-number">0</span>], X_new[:, <span class="hljs-number">1</span>], marker=<span class="hljs-string">'o'</span>, c=y)

    <span class="hljs-comment"># 与sklearn中的LDA函数对比</span>
    lda = LinearDiscriminantAnalysis(n_components=<span class="hljs-number">2</span>)
    lda.fit(X, y)
    X_new = lda.transform(X)
    print(X_new)
    plt.figure(<span class="hljs-number">2</span>)
    plt.scatter(X_new[:, <span class="hljs-number">0</span>], X_new[:, <span class="hljs-number">1</span>], marker=<span class="hljs-string">'o'</span>, c=y)

    plt.show()
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d388535a3051d922413ea9c3667929c9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">线性代数笔记11：正定矩阵理解及推导</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5b0de8dba2e086f6f1b48e147d4a887f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">deque用法详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>