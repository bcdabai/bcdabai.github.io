<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python同时执行5个sql_如何在Python脚本中执行多个SQL语句？ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python同时执行5个sql_如何在Python脚本中执行多个SQL语句？" />
<meta property="og:description" content="我正在使用Python中的以下代码模板(使用Atom构建/编写)。在import pyodbc
import pandas as pd
import win32com.client
cnxn = pyodbc.connect(&#39;Trusted_Connection=yes&#39;, driver = &#39;{SQL
Server}&#39;,server =&#39;prodserver&#39;, database = &#39;XXXX&#39;)
cnxn.setdecoding(pyodbc.SQL_WCHAR, encoding=&#39;utf-8&#39;)
cnxn.setencoding(str, encoding=&#39;utf-8&#39;)
cnxn.setencoding(unicode, encoding=&#39;utf-8&#39;, ctype=pyodbc.SQL_CHAR)
cursor = cnxn.cursor()
script =&#34;&#34;&#34;SELECT AccountsCount.AccountClass, COUNT(*) as Count
FROM
(SELECT *
FROM XXXX.dbo.table
where SubNo=&#39;001&#39;
AND (DATENAME(WEEKDAY, GETDATE()) = &#39;Sunday&#39; AND
convert(date,AddDate) = DATEADD(DAY, -2, CAST(GETDATE() as DATE))
) OR
(DATENAME(WEEKDAY, GETDATE()) = &#39;Monday&#39; AND
convert(date,AddDate) = DATEADD(DAY, -3, CAST(GETDATE() as DATE))" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/33ad2b32728bbf28ff251d2aa6cebcd4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-23T14:10:40+08:00" />
<meta property="article:modified_time" content="2020-12-23T14:10:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python同时执行5个sql_如何在Python脚本中执行多个SQL语句？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>我正在使用Python中的以下代码模板(使用Atom构建/编写)。在import pyodbc</p> 
 <p>import pandas as pd</p> 
 <p>import win32com.client</p> 
 <p>cnxn = pyodbc.connect('Trusted_Connection=yes', driver = '{SQL</p> 
 <p>Server}',server ='prodserver', database = 'XXXX')</p> 
 <p>cnxn.setdecoding(pyodbc.SQL_WCHAR, encoding='utf-8')</p> 
 <p>cnxn.setencoding(str, encoding='utf-8')</p> 
 <p>cnxn.setencoding(unicode, encoding='utf-8', ctype=pyodbc.SQL_CHAR)</p> 
 <p>cursor = cnxn.cursor()</p> 
 <p>script ="""SELECT AccountsCount.AccountClass, COUNT(*) as Count</p> 
 <p>FROM</p> 
 <p>(SELECT *</p> 
 <p>FROM XXXX.dbo.table</p> 
 <p>where SubNo='001'</p> 
 <p>AND (DATENAME(WEEKDAY, GETDATE()) = 'Sunday' AND</p> 
 <p>convert(date,AddDate) = DATEADD(DAY, -2, CAST(GETDATE() as DATE))</p> 
 <p>) OR</p> 
 <p>(DATENAME(WEEKDAY, GETDATE()) = 'Monday' AND</p> 
 <p>convert(date,AddDate) = DATEADD(DAY, -3, CAST(GETDATE() as DATE))</p> 
 <p>) OR</p> 
 <p>(DATENAME(WEEKDAY, GETDATE()) = 'Sunday' AND</p> 
 <p>convert(date,AddDate) = DATEADD(DAY, -2, CAST(GETDATE() as DATE))</p> 
 <p>) OR</p> 
 <p>(DATENAME(WEEKDAY, GETDATE()) NOT IN ('Sunday', 'Monday') AND</p> 
 <p>convert(date,AddDate) = DATEADD(DAY, -1, CAST(GETDATE() as DATE))</p> 
 <p>)) AS AccountsCount</p> 
 <p>Group by AccountsCount.AccountClass</p> 
 <p>"""</p> 
 <p>df = pd.read_sql_query(script,cnxn)</p> 
 <p>writer = pd.ExcelWriter ('ExcelFile.xlsx')</p> 
 <p>df.to_excel(writer, sheet_name = 'Data Export')</p> 
 <p>writer.save()</p> 
 <p>xlApp = win32com.client.DispatchEx('Excel.Application')</p> 
 <p>xlsPath = ('OtherExcelFile.xlsm')</p> 
 <p>wb = xlApp.Workbooks.Open(Filename=xlsPath)</p> 
 <p>xlApp.Run('CopyIntoOutlook')</p> 
 <p>wb.Save()</p> 
 <p>xlApp.Quit()</p> 
 <p>我需要做的就是在这个脚本中添加第二个完全独立的SQL命令，它可以完美地运行，并按照上面所述完成我需要的操作。我的附加脚本是这样的</p> 
 <p>^{pr2}$</p> 
 <p>我没有任何运气，我已经尝试加入脚本，任何帮助是非常感谢！您会注意到第二个脚本使用了与原始脚本相同的数据库和表，我只需要YTD数据以及前一天查看的top查询。在</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cefbb329e2fc2f3bb8919f9f98b7837a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">佳能g2810提示5b00_佳能G2810打印机清零软件5B00 5b01废墨清零1700代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f5a6d97000352de340ca80d675002d57/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">lgg7刷机包下载_LGG7One刷机包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>