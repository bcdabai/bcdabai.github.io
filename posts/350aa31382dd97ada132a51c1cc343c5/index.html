<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>excel函数技巧：什么是模糊查找，如何操作？ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="excel函数技巧：什么是模糊查找，如何操作？" />
<meta property="og:description" content="大多数时候我们都需要进行精确查找，但也会遇到需要模糊查找的时候。譬如根据简称查找全称，譬如根据数值划分等级等。模糊查找不等于瞎子摸象，这里分享4种用VLOOKUP和LOOKUP函数进行模糊查找的方法。
今天来跟大家分享模糊查找的几种方法。
常规的模糊查找分为两种情况，一种是数值；一种是文本。
一、数值模糊查找
首先我们分享关于数值的模糊查找。
举例：某公司需要为新员工定制工作服，现在需要根据员工的实际身高匹配需要定制衣服的尺码。
这种情况就需要通过模糊查找来返回每个员工身高所对应的尺寸。有两种方法来完成。
方法一：LOOKUP
函数公式：
=LOOKUP(B2,{0;165;170;175;180;185;190},{&#34;S&#34;;&#34;M&#34;;&#34;L&#34;;&#34;XL&#34;;&#34;XXL&#34;;&#34;XXXL&#34;;&#34;XXXXL&#34;})
公式解析：
这是通过LOOKUP向量形式来完成模糊查找。可以理解为查找B2单元格处于{0;165;170;175;180;185;190}哪个区间，如果在某个区间内就返回对应{&#34;S&#34;;&#34;M&#34;;&#34;L&#34;;&#34;XL&#34;;&#34;XXL&#34;;&#34;XXXL&#34;;&#34;XXXXL&#34;}的文本信息。
譬如169位于165-170之间，那么就返回“M”文本信息。
这里的区间对应关系如下。0到小于165的属于S尺寸；165到小于170的属于M尺寸，依次类推，直到大于等于190的属于XXXXL尺寸。
方法二：VLOOKUP
函数公式：
=IFERROR(VLOOKUP(B2&#43;5,F:G,2,1),&#34;S&#34;)
日常工作中我们使用VLOOKUP函数时第四个参数都是输入0，表示精确查找，此处第四参数为1，表示近似查找。
公式解析：
1.通过函数公式=VLOOKUP(B2,F:G,2,1)即可返回目标区域中小于等于查找值的最大值所对应的尺码。注意：在使用VLOOKUP函数进行模糊查找之前必须要将查找范围F:G处的数据按查找内容（此处为身高）进行升序排序。
例如，我们查找172，那么就返回目标区域中小于等于172的最大值即170，对应的尺码为M。由于服装的尺寸是就高不就低，身高172的员工必须定制身高175的L码的衣服，所以我们在查找匹配时需要在员工身高基础上加5，这样就能返回大于身高的最小尺寸了。
2.员工中有部分身高即使加5后仍小于165，因为F列165就是最小的了，所以这部分数据无法在F列查找到所需值，VLOOKUP函数返回错误值#N/A。我们希望小于165的员工都定制S号，就通过IFERROR函数将VLOOKUP错误结果重定向为文本字符“S”。
二、文本字符模糊查找
下面分享文本的模糊查找，例如，通过查找AB返回查找区域中包含AB的AAAABBB单元格所对应的值。
举例：下表为各公司2018年度营业额数据，公司名称为全称。现在我们在另外一个表中需要根据公司简称来匹配相关的营业额数据。
方法一：VLOOKUP&#43;通配符
函数公式：
=VLOOKUP(&#34;*&#34;&amp;E2&amp;&#34;*&#34;,A:B,2,0)
公式解释：
*代表所有字符，&#34;*&#34;&amp;E2&amp;&#34;*&#34;则表示包含E2单元格文本内容的所有内容。
方法二：LOOKUP&#43;FIND
函数公式：
=LOOKUP(1,0/FIND(E2,A$2:A$8),B$2:B$8)
公式解释：
公式用了LOOKUP查找套路。通过FIND函数判断E2单元格中文本处于A$2:A$8单元格中的位置，如果存在则返回大于0的数值，否则返回错误值；然后0/FIND()，则得到一组0和错误值的数组；最后LOOKUP函数出手，在数组中找到最大的不大于1的值，0，并根据0所在位置，返回对应的B$2:B$8中的值。
顺便说一嘴：如果你只想通过简称查到全称，则公式可以改成=LOOKUP(1,0/FIND(E2,A$2:A$8), A$2:A$8)。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/350aa31382dd97ada132a51c1cc343c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-11T08:07:38+08:00" />
<meta property="article:modified_time" content="2023-02-11T08:07:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">excel函数技巧：什么是模糊查找，如何操作？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="kdocs-document"> 
 <p style="">大多数时候我们都需要进行精确查找，但也会遇到需要模糊查找的时候。譬如根据简称查找全称，譬如根据数值划分等级等。<span class="kdocs-bold" style="font-weight:bold;">模糊查找</span>不等于瞎子摸象，这里分享4种用VLOOKUP和LOOKUP函数进行模糊查找的方法。</p> 
 <p style="text-align:null;">今天来跟大家分享模糊查找的几种方法。</p> 
 <p style="text-align:null;">常规的模糊查找分为两种情况，一种是<span class="kdocs-bold" style="font-weight:bold;">数值</span>；一种是<span class="kdocs-bold" style="font-weight:bold;">文本</span>。</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">一、数值模糊查找</span></p> 
 <p style="text-align:null;">首先我们分享关于数值的模糊查找。</p> 
 <p style="text-align:null;">举例：某公司需要为新员工定制工作服，现在需要根据员工的实际身高匹配需要定制衣服的尺码。</p> 
 <p style="text-align:null;"></p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:508px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:72.83465%;height:0;"> 
    <img src="https://images2.imgbox.com/d3/56/l1YYMLpy_o.png" style="margin-left:;display:block;width:508px;margin-top:-72.83465%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;">这种情况就需要通过模糊查找来返回每个员工身高所对应的尺寸。有两种方法来完成。</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">方法一：LOOKUP</span></p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">函数公式：</span></p> 
 <p style="text-align:null;">=LOOKUP(B2,{0;165;170;175;180;185;190},{"S";"M";"L";"XL";"XXL";"XXXL";"XXXXL"})</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:566px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:68.72792%;height:0;"> 
    <img src="https://images2.imgbox.com/45/9d/YfWX9H0k_o.jpg" style="margin-left:;display:block;width:566px;margin-top:-68.72792%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">公式解析：</span></p> 
 <p style="text-align:null;">这是通过LOOKUP向量形式来完成模糊查找。可以理解为查找B2单元格处于{0;165;170;175;180;185;190}哪个区间，如果在某个区间内就返回对应{"S";"M";"L";"XL";"XXL";"XXXL";"XXXXL"}的文本信息。</p> 
 <p style="text-align:null;">譬如169位于165-170之间，那么就返回“M”文本信息。</p> 
 <p style="text-align:null;">这里的区间对应关系如下。0到小于165的属于S尺寸；165到小于170的属于M尺寸，依次类推，直到大于等于190的属于XXXXL尺寸。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:567px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:8.818342%;height:0;"> 
    <img src="https://images2.imgbox.com/f9/45/7RHZR4U5_o.jpg" style="margin-left:;display:block;width:567px;margin-top:-8.818342%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">方法二：VLOOKUP</span></p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">函数公式：</span></p> 
 <p style="text-align:null;">=IFERROR(VLOOKUP(B2+5,F:G,2,1),"S")</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:553px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:71.79024%;height:0;"> 
    <img src="https://images2.imgbox.com/dd/0a/Li9ZyHe4_o.jpg" style="margin-left:;display:block;width:553px;margin-top:-71.79024%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;">日常工作中我们使用VLOOKUP函数时第四个参数都是输入0，表示精确查找，此处第四参数为1，表示近似查找。</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">公式解析：</span></p> 
 <p style="text-align:null;">1.通过函数公式=VLOOKUP(B2,F:G,2,1)即可返回目标区域中小于等于查找值的最大值所对应的尺码。注意：在使用VLOOKUP函数进行模糊查找之前必须要将查找范围F:G处的数据按查找内容（此处为身高）进行升序排序。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:553px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:77.57686%;height:0;"> 
    <img src="https://images2.imgbox.com/5b/55/VH1XWeP1_o.png" style="margin-left:;display:block;width:553px;margin-top:-77.57686%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;">例如，我们查找172，那么就返回目标区域中小于等于172的最大值即170，对应的尺码为M。由于服装的尺寸是就高不就低，身高172的员工必须定制身高175的L码的衣服，所以我们在查找匹配时需要在员工身高基础上加5，这样就能返回大于身高的最小尺寸了。</p> 
 <p style="text-align:null;">2.员工中有部分身高即使加5后仍小于165，因为F列165就是最小的了，所以这部分数据无法在F列查找到所需值，VLOOKUP函数返回错误值#N/A。我们希望小于165的员工都定制S号，就通过IFERROR函数将VLOOKUP错误结果重定向为文本字符“S”。</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">二、文本字符模糊查找</span></p> 
 <p style="text-align:null;">下面分享文本的模糊查找，例如，通过查找AB返回查找区域中包含AB的AAAABBB单元格所对应的值。</p> 
 <p style="text-align:null;">举例：下表为各公司2018年度营业额数据，公司名称为全称。现在我们在另外一个表中需要根据公司简称来匹配相关的营业额数据。</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:567px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:24.162258%;height:0;"> 
    <img src="https://images2.imgbox.com/a6/06/xyCmBUdp_o.jpg" style="margin-left:;display:block;width:567px;margin-top:-24.162258%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">方法一：VLOOKUP+通配符</span></p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">函数公式：</span></p> 
 <p style="text-align:null;">=VLOOKUP("*"&amp;E2&amp;"*",A:B,2,0)</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:566px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:29.32862%;height:0;"> 
    <img src="https://images2.imgbox.com/8f/e5/ve0RGw7F_o.jpg" style="margin-left:;display:block;width:566px;margin-top:-29.32862%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">公式解释：</span></p> 
 <p style="text-align:null;">*代表所有字符，"*"&amp;E2&amp;"*"则表示包含E2单元格文本内容的所有内容。</p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">方法二：LOOKUP+FIND</span></p> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">函数公式：</span></p> 
 <p style="text-align:null;">=LOOKUP(1,0/FIND(E2,A$2:A$8),B$2:B$8)</p> 
 <div class="kdocs-line-container" style="display:flex;"> 
  <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:566px;justify-content:center;align-items:center;height:auto;"> 
   <div class="kdocs-img" style="padding-top:28.798588%;height:0;"> 
    <img src="https://images2.imgbox.com/fe/c4/IGl2HYV3_o.jpg" style="margin-left:;display:block;width:566px;margin-top:-28.798588%;height:auto;"> 
   </div> 
  </div> 
 </div> 
 <p style="text-align:null;"><span class="kdocs-bold" style="font-weight:bold;">公式解释：</span></p> 
 <p style="text-align:null;">公式用了LOOKUP查找套路。通过FIND函数判断E2单元格中文本处于A$2:A$8单元格中的位置，如果存在则返回大于0的数值，否则返回错误值；然后0/FIND()，则得到一组0和错误值的数组；最后LOOKUP函数出手，在数组中找到最大的不大于1的值，0，并根据0所在位置，返回对应的B$2:B$8中的值。</p> 
 <p style="text-align:null;">顺便说一嘴：如果你只想通过简称查到全称，则公式可以改成=LOOKUP(1,0/FIND(E2,A$2:A$8), A$2:A$8)。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2778b63ab126f314da2e2654df5da4c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux配置静态ip地址</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a297a814315069487b904e9c76e4965e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【MySQL】MySQL 8.0 新特性之 - 公用表表达式（CTE）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>