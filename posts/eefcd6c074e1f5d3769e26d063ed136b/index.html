<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>学习笔记：int 和 size_t互转的最好解决方案 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="学习笔记：int 和 size_t互转的最好解决方案" />
<meta property="og:description" content="#include &lt;boost/cast.hpp&gt; // void test1() { int i = 0; size_t ui = -1; //编译警告：warning C4245: &#39;=&#39; : conversion from &#39;int&#39; to &#39;size_t&#39;, signed/unsigned mismatch //把这个值0xFFFF-FFFF放入ui，按照补码理解-1。 i = (int)ui; //强制转换，无编译警告. i的值为 0xFFFF-FFFF } // void test2() { int i = 0; size_t ui = std::numeric_limits&lt;int&gt;::max() &#43; 1; //把 0x7FFF-FFFF &#43; 1 放入ui i = static_cast&lt;int&gt;(ui); //无编译警告，当强制转换时，也会无警告，是一样的。 //i的值是0x8000-0000 } //由test1和test2可见： //无符号的size_t和有符号int相互转换时，内存是直接拷贝的，二进制值不变，但是对二进制值的解释方式不同。 //编译器会给出警告，也可能不警告（被diable或者因强制转换语法而不显示警告了） // void test3() { int i = 0; size_t ui = std::numeric_limits&lt;int&gt;::max()&#43;1; //这个值，是故意设置的，int容纳不了的最大值。 try{ i = boost::numeric_cast&lt;int&gt;(ui); } catch(boost::bad_numeric_cast&amp;) { std::cout&lt;&lt;&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/eefcd6c074e1f5d3769e26d063ed136b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-02-07T18:05:53+08:00" />
<meta property="article:modified_time" content="2015-02-07T18:05:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">学习笔记：int 和 size_t互转的最好解决方案</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-cpp">#include  &lt;boost/cast.hpp&gt;

//
void test1()
{
    int     i = 0;

    size_t ui = -1; //编译警告：warning C4245: '=' : conversion from 'int' to 'size_t', signed/unsigned mismatch
                    //把这个值0xFFFF-FFFF放入ui，按照补码理解-1。
    i = (int)ui;    //强制转换，无编译警告. i的值为 0xFFFF-FFFF
}

//
void test2()
{
    int    i = 0;
    size_t ui = std::numeric_limits&lt;int&gt;::max() + 1;  //把 0x7FFF-FFFF + 1 放入ui
    i = static_cast&lt;int&gt;(ui); //无编译警告，当强制转换时，也会无警告，是一样的。           
                              //i的值是0x8000-0000
} 

//由test1和test2可见：
//无符号的size_t和有符号int相互转换时，内存是直接拷贝的，二进制值不变，但是对二进制值的解释方式不同。
//编译器会给出警告，也可能不警告（被diable或者因强制转换语法而不显示警告了）

//
void test3()
{
    int     i = 0;
    size_t ui = std::numeric_limits&lt;int&gt;::max()+1;  //这个值，是故意设置的，int容纳不了的最大值。
    try{
        i = boost::numeric_cast&lt;int&gt;(ui);
    }
    catch(boost::bad_numeric_cast&amp;)
    { 
        std::cout&lt;&lt;"测试OK. 0x8000-0000 不能转 int"&lt;&lt;std::endl; 
    } 
}

//
void test4()
{
    int     i = -1;
    size_t ui = 0;
    try{
        ui = boost::numeric_cast&lt;size_t&gt;(i);
    }
    catch(boost::bad_numeric_cast&amp;)
    { 
        std::cout&lt;&lt;"测试OK. -1不能转size_t"&lt;&lt;std::endl; 
    } 
}

//由test3,test4可见：
//运行期的检查，更具有可操作性。

//
int main()
{
    test1();
    test2();
    test3();
    test4();
    system("pause");
}
</code></pre> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9bdf702848dcf1f0a152c972e324209a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">hashMap 的扩展</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a1a04de3fd614b351542ff3084849e97/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C/C&#43;&#43;】实现将一个整数反转</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>