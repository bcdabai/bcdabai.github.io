<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>k8s-(五）最全的安装教程（使用kubeadm在Centos7上部署kubernetes1.18）以及安装异常问题记录 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="k8s-(五）最全的安装教程（使用kubeadm在Centos7上部署kubernetes1.18）以及安装异常问题记录" />
<meta property="og:description" content="k8s使用kubeadm进行安装步骤，使用kubeadm安装k8s会简单很多，一直想总结写一篇简单明了的安装教程，希望能有用。k8s在2020年初发布的第一个版本是1.18.0，目前最新版本是1.19.4，并且1.20的版本应该会在年底发布，但是我们这里安装的版本是1.18。
k8s-基础概念
1.系统准备 搭建虚拟机centos7环境，虚拟机固定IP地址
安装三台虚拟机，一台作master节点，两台作node节点关闭防护墙 [root@master01 ~]# systemctl stop firewalld [root@master01 ~]# systemctl disable firewalld 注：可以不关闭防火墙，但是要设置各个需要的端口的开放规则，比较麻烦，我们自己的开发环境就直接关了防火墙
关闭swap [root@master01 ~]# vi /etc/fstab 注释里面的&#34;/dev/mapper/centos-swap swap&#34;
注：
1.swap相当于“虚拟内存”。当物理内存不足时，拿出部分硬盘空间当SWAP分区（虚拟成内存）使用，从而解决内存容量不足的情况。
2.kubelet 在 1.8 版本以后强制要求 swap 必须关闭
3.free -m 命令可以查看交换区的空间大小，我们注释完再使用这个命令发现交换区swap还没关闭，因为需要重启才生效
关闭selinux [root@master01 ~]# vi /etc/selinux/config 注释掉SELINUX=disabled,然后重启，reboot
注：
1.selinux这个是用来加强安全性的一个组件，挺复杂的，一般直接禁用
2.关闭selinux以允许容器访问宿主机的文件系统
添加阿里源 [root@master01 ~]# rm -rfv /etc/yum.repos.d/* [root@master01 ~]# curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo 注：如果是centos8,则链接最后面的Centos-7.repo修改成Centos-8.repo，否则使用yum安装的时候会提示没有可用的软件包
配置主机名 [root@master01 ~]# hostnamectl set-hostname master01 [root@master01 ~]# more /etc/hostname 注：这一步如果少了的话，后面执行kubeadm join的时候会报错，提示有相同名称的节点，所有其他机器的hostname不能一样，工作节点可以写node01、node02这样子
2.配置内核参数，将桥接的IPv4流量传递到iptables的链 [root@master01 ~]# cat &gt; /etc/sysctl." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/607fdd70b5e67612dde93ba80fadc91e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-26T21:01:40+08:00" />
<meta property="article:modified_time" content="2020-11-26T21:01:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">k8s-(五）最全的安装教程（使用kubeadm在Centos7上部署kubernetes1.18）以及安装异常问题记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>k8s使用kubeadm进行安装步骤，使用kubeadm安装k8s会简单很多，一直想总结写一篇简单明了的安装教程，希望能有用。k8s在2020年初发布的第一个版本是1.18.0，目前最新版本是1.19.4，并且1.20的版本应该会在年底发布，但是我们这里安装的版本是1.18。</p> 
<p><a href="https://blog.csdn.net/qq_21187515/article/details/101290820">k8s-基础概念</a></p> 
<h4><a id="1_3"></a>1.系统准备</h4> 
<ol><li><a href="https://blog.csdn.net/qq_21187515/article/details/102788495">搭建虚拟机centos7环境，虚拟机固定IP地址</a><br> 安装三台虚拟机，一台作master节点，两台作node节点</li><li><strong>关闭防护墙</strong></li></ol> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># systemctl stop firewalld
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># systemctl disable firewalld
</code></pre> 
<p><img src="https://images2.imgbox.com/d4/97/L1yQui4R_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：可以不关闭防火墙，但是要设置各个需要的端口的开放规则，比较麻烦，我们自己的开发环境就直接关了防火墙</p> 
</blockquote> 
<ol start="3"><li><strong>关闭swap</strong></li></ol> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># vi <span class="token operator">/</span>etc<span class="token operator">/</span>fstab
</code></pre> 
<p>注释里面的"/dev/mapper/centos-swap swap"<br> <img src="https://images2.imgbox.com/0e/7e/8t3EMUUw_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/db/01/D9fdPe69_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：<br> 1.swap相当于“虚拟内存”。当物理内存不足时，拿出部分硬盘空间当SWAP分区（虚拟成内存）使用，从而解决内存容量不足的情况。<br> 2.kubelet 在 1.8 版本以后强制要求 swap 必须关闭<br> 3.free -m 命令可以查看交换区的空间大小，我们注释完再使用这个命令发现交换区swap还没关闭，因为需要重启才生效</p> 
</blockquote> 
<ol start="4"><li><strong>关闭selinux</strong></li></ol> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># vi <span class="token operator">/</span>etc<span class="token operator">/</span>selinux<span class="token operator">/</span>config
</code></pre> 
<p>注释掉SELINUX=disabled,然后重启，reboot<br> <img src="https://images2.imgbox.com/c4/53/9kNdsbPd_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：<br> 1.selinux这个是用来加强安全性的一个组件，挺复杂的，一般直接禁用<br> 2.关闭selinux以允许容器访问宿主机的文件系统</p> 
</blockquote> 
<ol start="5"><li><strong>添加阿里源</strong></li></ol> 
<pre><code class="prism language-x">[root@master01 ~]# rm -rfv /etc/yum.repos.d/*
[root@master01 ~]# curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/0e/pDAJTxIR_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：如果是centos8,则链接最后面的Centos-7.repo修改成Centos-8.repo，否则使用yum安装的时候会提示没有可用的软件包</p> 
</blockquote> 
<ol start="6"><li><strong>配置主机名</strong></li></ol> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># hostnamectl set<span class="token operator">-</span>hostname master01
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># more <span class="token operator">/</span>etc<span class="token operator">/</span>hostname  
</code></pre> 
<p><img src="https://images2.imgbox.com/3b/cb/LEUF0yz2_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：这一步如果少了的话，后面执行kubeadm join的时候会报错，提示有相同名称的节点，所有其他机器的hostname不能一样，工作节点可以写node01、node02这样子</p> 
</blockquote> 
<h4><a id="2IPv4iptables_57"></a>2.配置内核参数，将桥接的IPv4流量传递到iptables的链</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># cat <span class="token operator">&gt;</span> <span class="token operator">/</span>etc<span class="token operator">/</span>sysctl<span class="token punctuation">.</span>d<span class="token operator">/</span>k8s<span class="token punctuation">.</span>conf <span class="token operator">&lt;&lt;</span>EOF
net<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>bridge<span class="token operator">-</span>nf<span class="token operator">-</span>call<span class="token operator">-</span>ip6tables <span class="token operator">=</span> <span class="token number">1</span>
net<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>bridge<span class="token operator">-</span>nf<span class="token operator">-</span>call<span class="token operator">-</span>iptables <span class="token operator">=</span> <span class="token number">1</span>
EOF
</code></pre> 
<blockquote> 
 <p>注：k8s该网络需要设置内核参数bridge-nf-call-iptables=1，没有这个后面添加网络的时候会报错。</p> 
</blockquote> 
<h4><a id="3_67"></a>3.安装常用包</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># yum install vim bash<span class="token operator">-</span>completion net<span class="token operator">-</span>tools gcc <span class="token operator">-</span>y
</code></pre> 
<h4><a id="4aliyundockerce_73"></a>4.使用aliyun源安装docker-ce</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># yum install <span class="token operator">-</span>y yum<span class="token operator">-</span>utils device<span class="token operator">-</span>mapper<span class="token operator">-</span>persistent<span class="token operator">-</span>data lvm2
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># yum<span class="token operator">-</span>config<span class="token operator">-</span>manager <span class="token operator">--</span>add<span class="token operator">-</span>repo https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>docker<span class="token operator">-</span>ce<span class="token operator">/</span>linux<span class="token operator">/</span>centos<span class="token operator">/</span>docker<span class="token operator">-</span>ce<span class="token punctuation">.</span>repo
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># yum <span class="token operator">-</span>y install docker<span class="token operator">-</span>ce
</code></pre> 
<blockquote> 
 <p>注：yum-config-manager命令配置aliyun源，但是这个命令来源于yum-utils，所以需要先安装yum-utils</p> 
</blockquote> 
<p>安装完docker后添加aliyun的docker仓库加速器</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># mkdir <span class="token operator">-</span>p <span class="token operator">/</span>etc<span class="token operator">/</span>docker
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># tee <span class="token operator">/</span>etc<span class="token operator">/</span>docker<span class="token operator">/</span>daemon<span class="token punctuation">.</span>json <span class="token operator">&lt;&lt;</span><span class="token operator">-</span><span class="token string">'EOF'</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"https://fl791z1h.mirror.aliyuncs.com"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
EOF
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># systemctl daemon<span class="token operator">-</span>reload
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># systemctl restart docker
</code></pre> 
<p><img src="https://images2.imgbox.com/7a/9e/f80GHq1U_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：tee /etc/docker/daemon.json &lt;&lt;-'EOF’后面的 &lt;&lt;-'EOF’是没有空格的，如图我第一次有空格输入EOF就没有结束</p> 
</blockquote> 
<h4><a id="5kubectlkubeletkubeadm_98"></a>5.安装kubectl、kubelet、kubeadm</h4> 
<p>添加阿里kubernetes源</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># cat <span class="token operator">&lt;&lt;</span>EOF <span class="token operator">&gt;</span> <span class="token operator">/</span>etc<span class="token operator">/</span>yum<span class="token punctuation">.</span>repos<span class="token punctuation">.</span>d<span class="token operator">/</span>kubernetes<span class="token punctuation">.</span>repo
<span class="token punctuation">[</span>kubernetes<span class="token punctuation">]</span>
name<span class="token operator">=</span>Kubernetes
baseurl<span class="token operator">=</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>kubernetes<span class="token operator">/</span>yum<span class="token operator">/</span>repos<span class="token operator">/</span>kubernetes<span class="token operator">-</span>el7<span class="token operator">-</span>x86_64<span class="token operator">/</span>
enabled<span class="token operator">=</span><span class="token number">1</span>
gpgcheck<span class="token operator">=</span><span class="token number">1</span>
repo_gpgcheck<span class="token operator">=</span><span class="token number">1</span>
gpgkey<span class="token operator">=</span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>kubernetes<span class="token operator">/</span>yum<span class="token operator">/</span>doc<span class="token operator">/</span>yum<span class="token operator">-</span>key<span class="token punctuation">.</span>gpg https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>kubernetes<span class="token operator">/</span>yum<span class="token operator">/</span>doc<span class="token operator">/</span>rpm<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">-</span>key<span class="token punctuation">.</span>gpg
EOF
</code></pre> 
<p>安装kubectl、kubelet、kubeadm</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># yum <span class="token operator">-</span>y install kubectl<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span> kubelet<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span> kubeadm<span class="token operator">-</span><span class="token number">1.18</span><span class="token number">.0</span>
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># systemctl enable kubelet
</code></pre> 
<blockquote> 
 <p>注： yum install kubectl kubelet kubeadm，这样写会默认安装最新版1.19.4,但是和我后面执行的kubeadm init --kubernetes-version=1.18.0版本不一致，会报错，所以我这里yum后面指定了版本</p> 
</blockquote> 
<h4><a id="6k8smaster_119"></a>6.初始化k8s集群(master节点)</h4> 
<blockquote> 
 <p>这一步开始区分master、ndoe节点执行的命令了，上面的步骤master、node都是一样</p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># kubeadm init <span class="token operator">--</span>kubernetes<span class="token operator">-</span>version<span class="token operator">=</span><span class="token number">1.18</span><span class="token number">.0</span>  \
<span class="token operator">--</span>apiserver<span class="token operator">-</span>advertise<span class="token operator">-</span>address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span>   \
<span class="token operator">--</span>image<span class="token operator">-</span>repository registry<span class="token punctuation">.</span>aliyuncs<span class="token punctuation">.</span>com<span class="token operator">/</span>google_containers  \
<span class="token operator">--</span>service<span class="token operator">-</span>cidr<span class="token operator">=</span><span class="token number">10.10</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">/</span><span class="token number">16</span> <span class="token operator">--</span>pod<span class="token operator">-</span>network<span class="token operator">-</span>cidr<span class="token operator">=</span><span class="token number">10.122</span><span class="token number">.0</span><span class="token number">.0</span><span class="token operator">/</span><span class="token number">16</span>
</code></pre> 
<p>集群初始化成功后返回如下信息：</p> 
<pre><code class="prism language-java">W1125 <span class="token number">22</span><span class="token operator">:</span><span class="token number">47</span><span class="token operator">:</span><span class="token number">32.274048</span>   <span class="token number">47607</span> configset<span class="token punctuation">.</span>go<span class="token operator">:</span><span class="token number">202</span><span class="token punctuation">]</span> WARNING<span class="token operator">:</span> kubeadm cannot validate component configs <span class="token keyword">for</span> API groups <span class="token punctuation">[</span>kubelet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>k8s<span class="token punctuation">.</span>io kubeproxy<span class="token punctuation">.</span>config<span class="token punctuation">.</span>k8s<span class="token punctuation">.</span>io<span class="token punctuation">]</span>
<span class="token punctuation">[</span>init<span class="token punctuation">]</span> Using Kubernetes version<span class="token operator">:</span> v1<span class="token punctuation">.</span><span class="token number">18.0</span>
<span class="token punctuation">[</span>preflight<span class="token punctuation">]</span> Running pre<span class="token operator">-</span>flight checks
        <span class="token punctuation">[</span>WARNING IsDockerSystemdCheck<span class="token punctuation">]</span><span class="token operator">:</span> detected <span class="token string">"cgroupfs"</span> as the Docker cgroup driver<span class="token punctuation">.</span> The recommended driver is <span class="token string">"systemd"</span><span class="token punctuation">.</span> Please follow the guide at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>kubernetes<span class="token punctuation">.</span>io<span class="token operator">/</span>docs<span class="token operator">/</span>setup<span class="token operator">/</span>cri<span class="token operator">/</span>
<span class="token punctuation">[</span>preflight<span class="token punctuation">]</span> Pulling images required <span class="token keyword">for</span> setting up a Kubernetes cluster
<span class="token punctuation">[</span>preflight<span class="token punctuation">]</span> This might take a minute or two<span class="token punctuation">,</span> depending on the speed of your internet connection
<span class="token punctuation">[</span>preflight<span class="token punctuation">]</span> You can also perform <span class="token keyword">this</span> action in beforehand using <span class="token string">'kubeadm config images pull'</span>
<span class="token punctuation">[</span>kubelet<span class="token operator">-</span>start<span class="token punctuation">]</span> Writing kubelet environment file with flags to file <span class="token string">"/var/lib/kubelet/kubeadm-flags.env"</span>
<span class="token punctuation">[</span>kubelet<span class="token operator">-</span>start<span class="token punctuation">]</span> Writing kubelet configuration to file <span class="token string">"/var/lib/kubelet/config.yaml"</span>
<span class="token punctuation">[</span>kubelet<span class="token operator">-</span>start<span class="token punctuation">]</span> Starting the kubelet
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Using certificateDir folder <span class="token string">"/etc/kubernetes/pki"</span>
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"ca"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"apiserver"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> apiserver serving cert is signed <span class="token keyword">for</span> DNS names <span class="token punctuation">[</span>localhost<span class="token punctuation">.</span>localdomain kubernetes kubernetes<span class="token punctuation">.</span><span class="token keyword">default</span> kubernetes<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">.</span>svc kubernetes<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span>cluster<span class="token punctuation">.</span>local<span class="token punctuation">]</span> and IPs <span class="token punctuation">[</span><span class="token number">10.10</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"apiserver-kubelet-client"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"front-proxy-ca"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"front-proxy-client"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"etcd/ca"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"etcd/server"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> etcd<span class="token operator">/</span>server serving cert is signed <span class="token keyword">for</span> DNS names <span class="token punctuation">[</span>localhost<span class="token punctuation">.</span>localdomain localhost<span class="token punctuation">]</span> and IPs <span class="token punctuation">[</span><span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">:</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"etcd/peer"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> etcd<span class="token operator">/</span>peer serving cert is signed <span class="token keyword">for</span> DNS names <span class="token punctuation">[</span>localhost<span class="token punctuation">.</span>localdomain localhost<span class="token punctuation">]</span> and IPs <span class="token punctuation">[</span><span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">:</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"etcd/healthcheck-client"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"apiserver-etcd-client"</span> certificate and key
<span class="token punctuation">[</span>certs<span class="token punctuation">]</span> Generating <span class="token string">"sa"</span> key and <span class="token keyword">public</span> key
<span class="token punctuation">[</span>kubeconfig<span class="token punctuation">]</span> Using kubeconfig folder <span class="token string">"/etc/kubernetes"</span>
<span class="token punctuation">[</span>kubeconfig<span class="token punctuation">]</span> Writing <span class="token string">"admin.conf"</span> kubeconfig file
<span class="token punctuation">[</span>kubeconfig<span class="token punctuation">]</span> Writing <span class="token string">"kubelet.conf"</span> kubeconfig file
<span class="token punctuation">[</span>kubeconfig<span class="token punctuation">]</span> Writing <span class="token string">"controller-manager.conf"</span> kubeconfig file
<span class="token punctuation">[</span>kubeconfig<span class="token punctuation">]</span> Writing <span class="token string">"scheduler.conf"</span> kubeconfig file
<span class="token punctuation">[</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Using manifest folder <span class="token string">"/etc/kubernetes/manifests"</span>
<span class="token punctuation">[</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Creating <span class="token keyword">static</span> Pod manifest <span class="token keyword">for</span> <span class="token string">"kube-apiserver"</span>
<span class="token punctuation">[</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Creating <span class="token keyword">static</span> Pod manifest <span class="token keyword">for</span> <span class="token string">"kube-controller-manager"</span>
W1125 <span class="token number">22</span><span class="token operator">:</span><span class="token number">47</span><span class="token operator">:</span><span class="token number">35.941950</span>   <span class="token number">47607</span> manifests<span class="token punctuation">.</span>go<span class="token operator">:</span><span class="token number">225</span><span class="token punctuation">]</span> the <span class="token keyword">default</span> kube<span class="token operator">-</span>apiserver authorization<span class="token operator">-</span>mode is <span class="token string">"Node,RBAC"</span><span class="token punctuation">;</span> using <span class="token string">"Node,RBAC"</span>
<span class="token punctuation">[</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Creating <span class="token keyword">static</span> Pod manifest <span class="token keyword">for</span> <span class="token string">"kube-scheduler"</span>
W1125 <span class="token number">22</span><span class="token operator">:</span><span class="token number">47</span><span class="token operator">:</span><span class="token number">35.943106</span>   <span class="token number">47607</span> manifests<span class="token punctuation">.</span>go<span class="token operator">:</span><span class="token number">225</span><span class="token punctuation">]</span> the <span class="token keyword">default</span> kube<span class="token operator">-</span>apiserver authorization<span class="token operator">-</span>mode is <span class="token string">"Node,RBAC"</span><span class="token punctuation">;</span> using <span class="token string">"Node,RBAC"</span>
<span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Creating <span class="token keyword">static</span> Pod manifest <span class="token keyword">for</span> local etcd in <span class="token string">"/etc/kubernetes/manifests"</span>
<span class="token punctuation">[</span>wait<span class="token operator">-</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> the kubelet to boot up the control plane as <span class="token keyword">static</span> Pods from directory <span class="token string">"/etc/kubernetes/manifests"</span><span class="token punctuation">.</span> This can take up to <span class="token number">4</span>m0s
<span class="token punctuation">[</span>apiclient<span class="token punctuation">]</span> All control plane components are healthy after <span class="token number">21.504047</span> seconds
<span class="token punctuation">[</span>upload<span class="token operator">-</span>config<span class="token punctuation">]</span> Storing the configuration used in ConfigMap <span class="token string">"kubeadm-config"</span> in the <span class="token string">"kube-system"</span> Namespace
<span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> Creating a ConfigMap <span class="token string">"kubelet-config-1.18"</span> in namespace kube<span class="token operator">-</span>system with the configuration <span class="token keyword">for</span> the kubelets in the cluster
<span class="token punctuation">[</span>upload<span class="token operator">-</span>certs<span class="token punctuation">]</span> Skipping phase<span class="token punctuation">.</span> Please see <span class="token operator">--</span>upload<span class="token operator">-</span>certs
<span class="token punctuation">[</span>mark<span class="token operator">-</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Marking the node localhost<span class="token punctuation">.</span>localdomain as control<span class="token operator">-</span>plane by adding the label <span class="token string">"node-role.kubernetes.io/master=''"</span>
<span class="token punctuation">[</span>mark<span class="token operator">-</span>control<span class="token operator">-</span>plane<span class="token punctuation">]</span> Marking the node localhost<span class="token punctuation">.</span>localdomain as control<span class="token operator">-</span>plane by adding the taints <span class="token punctuation">[</span>node<span class="token operator">-</span>role<span class="token punctuation">.</span>kubernetes<span class="token punctuation">.</span>io<span class="token operator">/</span>master<span class="token operator">:</span>NoSchedule<span class="token punctuation">]</span>
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> Using token<span class="token operator">:</span> o11ulw<span class="token punctuation">.</span>ovtj9vov7ob34hs7
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> Configuring bootstrap tokens<span class="token punctuation">,</span> cluster<span class="token operator">-</span>info ConfigMap<span class="token punctuation">,</span> RBAC Roles
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> configured RBAC rules to allow Node Bootstrap tokens to get nodes
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order <span class="token keyword">for</span> nodes to get <span class="token keyword">long</span> term certificate credentials
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> configured RBAC rules to allow certificate rotation <span class="token keyword">for</span> all node client certificates in the cluster
<span class="token punctuation">[</span>bootstrap<span class="token operator">-</span>token<span class="token punctuation">]</span> Creating the <span class="token string">"cluster-info"</span> ConfigMap in the <span class="token string">"kube-public"</span> namespace
<span class="token punctuation">[</span>kubelet<span class="token operator">-</span>finalize<span class="token punctuation">]</span> Updating <span class="token string">"/etc/kubernetes/kubelet.conf"</span> to point to a rotatable kubelet client certificate and key
<span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Applied essential addon<span class="token operator">:</span> CoreDNS
<span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Applied essential addon<span class="token operator">:</span> kube<span class="token operator">-</span>proxy

Your Kubernetes control<span class="token operator">-</span>plane has initialized successfully<span class="token operator">!</span>

To start using your cluster<span class="token punctuation">,</span> you need to run the following as a regular user<span class="token operator">:</span>

  mkdir <span class="token operator">-</span>p $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube
  sudo cp <span class="token operator">-</span>i <span class="token operator">/</span>etc<span class="token operator">/</span>kubernetes<span class="token operator">/</span>admin<span class="token punctuation">.</span>conf $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube<span class="token operator">/</span>config
  sudo chown $<span class="token punctuation">(</span>id <span class="token operator">-</span>u<span class="token punctuation">)</span><span class="token operator">:</span>$<span class="token punctuation">(</span>id <span class="token operator">-</span>g<span class="token punctuation">)</span> $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube<span class="token operator">/</span>config

You should now deploy a pod network to the cluster<span class="token punctuation">.</span>
Run <span class="token string">"kubectl apply -f [podnetwork].yaml"</span> with one of the options listed at<span class="token operator">:</span>
  https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>kubernetes<span class="token punctuation">.</span>io<span class="token operator">/</span>docs<span class="token operator">/</span>concepts<span class="token operator">/</span>cluster<span class="token operator">-</span>administration<span class="token operator">/</span>addons<span class="token operator">/</span>

Then you can join any number of worker nodes by running the following on each as root<span class="token operator">:</span>

kubeadm join <span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">6443</span> <span class="token operator">--</span>token o11ulw<span class="token punctuation">.</span>ovtj9vov7ob34hs7 \
    <span class="token operator">--</span>discovery<span class="token operator">-</span>token<span class="token operator">-</span>ca<span class="token operator">-</span>cert<span class="token operator">-</span>hash sha256<span class="token operator">:</span><span class="token number">38</span>a93626ac4e86155583e7ef9b32cb13739d5f5bc3da2b4ed7e74aec8112bea7
</code></pre> 
<p>记录后面的kubeadm join这段内容，此内容需要在其它节点加入Kubernetes集群时执行。</p> 
<pre><code class="prism language-java">kubeadm join <span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">6443</span> <span class="token operator">--</span>token o11ulw<span class="token punctuation">.</span>ovtj9vov7ob34hs7 \
    <span class="token operator">--</span>discovery<span class="token operator">-</span>token<span class="token operator">-</span>ca<span class="token operator">-</span>cert<span class="token operator">-</span>hash sha256<span class="token operator">:</span><span class="token number">38</span>a93626ac4e86155583e7ef9b32cb13739d5f5bc3da2b4ed7e74aec8112bea7
</code></pre> 
<p>创建kubectl</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># mkdir <span class="token operator">-</span>p $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># sudo cp <span class="token operator">-</span>i <span class="token operator">/</span>etc<span class="token operator">/</span>kubernetes<span class="token operator">/</span>admin<span class="token punctuation">.</span>conf $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube<span class="token operator">/</span>config
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># sudo chown $<span class="token punctuation">(</span>id <span class="token operator">-</span>u<span class="token punctuation">)</span><span class="token operator">:</span>$<span class="token punctuation">(</span>id <span class="token operator">-</span>g<span class="token punctuation">)</span> $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube<span class="token operator">/</span>config
</code></pre> 
<blockquote> 
 <p>注：<br> 1.不配置$HOME/.kube/config的话，kubectl命令不可用，<br> 2.node节点写法有点不一样，node节点的这行为：sudo cp -i /etc/kubernetes/kubelet.conf.conf $HOME/.kube/config</p> 
</blockquote> 
<h4><a id="7calicomaster_218"></a>7.安装calico网络（master节点）</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># kubectl apply <span class="token operator">-</span>f https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>docs<span class="token punctuation">.</span>projectcalico<span class="token punctuation">.</span>org<span class="token operator">/</span>manifests<span class="token operator">/</span>calico<span class="token punctuation">.</span>yaml
</code></pre> 
<p><img src="https://images2.imgbox.com/97/b9/dUrjYjLz_o.png" alt="https://docs.projectcalico.org/manifests/calico.yaml"><br> <img src="https://images2.imgbox.com/7a/a2/olJDHcLG_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：<br> 安装calico网络网络后过一会再输入kubectl get node，可以看到节点的STATUS由NotReady变为Ready</p> 
</blockquote> 
<h4><a id="8nodenode_228"></a>8.node节点加入集群（node节点）</h4> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@node01</span> <span class="token operator">~</span><span class="token punctuation">]</span># kubeadm join <span class="token number">192.168</span><span class="token number">.137</span><span class="token number">.110</span><span class="token operator">:</span><span class="token number">6443</span> <span class="token operator">--</span>token o11ulw<span class="token punctuation">.</span>ovtj9vov7ob34hs7     <span class="token operator">--</span>discovery<span class="token operator">-</span>token<span class="token operator">-</span>ca<span class="token operator">-</span>cert<span class="token operator">-</span>hash sha256<span class="token operator">:</span><span class="token number">38</span>a93626ac4e86155583e7ef9b32cb13739d5f5bc3da2b4ed7e74aec8112bea7
</code></pre> 
<blockquote> 
 <p>注：<br> 1.kubeadm init后得到的token有效期为24小时，过期后需要重新创建token,执行：kubeadm token create获取新token<br> 2.kubeadm token list 查看token列表，</p> 
</blockquote> 
<p>创建kubectl</p> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># mkdir <span class="token operator">-</span>p $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># sudo cp <span class="token operator">-</span>i <span class="token operator">/</span>etc<span class="token operator">/</span>kubernetes<span class="token operator">/</span>kubelet<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>conf
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># sudo chown $<span class="token punctuation">(</span>id <span class="token operator">-</span>u<span class="token punctuation">)</span><span class="token operator">:</span>$<span class="token punctuation">(</span>id <span class="token operator">-</span>g<span class="token punctuation">)</span> $HOME<span class="token operator">/</span><span class="token punctuation">.</span>kube<span class="token operator">/</span>config
</code></pre> 
<p>到了这步，把所有的node节点加入mater节点后，k8s的环境已经安装完成了<br> <img src="https://images2.imgbox.com/9b/7a/jwScfny6_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="9kubernetesdashboardmaster_247"></a>9.安装kubernetes-dashboard(master节点)</h4> 
<blockquote> 
 <p>Dashboard是可视化插件，它可以给用户提供一个可视化的 Web 界面来查看当前集群的各种信息。用户可以用 Kubernetes Dashboard 部署容器化的应用、监控应用的状态、执行故障排查任务以及管理 Kubernetes 各种资源。</p> 
</blockquote> 
<ol><li>官方部署dashboard的服务没使用nodeport，将yaml文件下载到本地，在service里添加nodeport</li></ol> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># wget  https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>raw<span class="token punctuation">.</span>githubusercontent<span class="token punctuation">.</span>com<span class="token operator">/</span>kubernetes<span class="token operator">/</span>dashboard<span class="token operator">/</span>v2<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token operator">-</span>rc7<span class="token operator">/</span>aio<span class="token operator">/</span>deploy<span class="token operator">/</span>recommended<span class="token punctuation">.</span>yaml
<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># vim recommended<span class="token punctuation">.</span>yaml
kind<span class="token operator">:</span> Service
apiVersion<span class="token operator">:</span> v1
metadata<span class="token operator">:</span>
  labels<span class="token operator">:</span>
    k8s<span class="token operator">-</span>app<span class="token operator">:</span> kubernetes<span class="token operator">-</span>dashboard
  name<span class="token operator">:</span> kubernetes<span class="token operator">-</span>dashboard
  namespace<span class="token operator">:</span> kubernetes<span class="token operator">-</span>dashboard
spec<span class="token operator">:</span>
  type<span class="token operator">:</span> NodePort
  ports<span class="token operator">:</span>
    <span class="token operator">-</span> port<span class="token operator">:</span> <span class="token number">443</span>
      targetPort<span class="token operator">:</span> <span class="token number">8443</span>
      nodePort<span class="token operator">:</span> <span class="token number">30000</span>
  selector<span class="token operator">:</span>
    k8s<span class="token operator">-</span>app<span class="token operator">:</span> kubernetes<span class="token operator">-</span>dashboard

<span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># kubectl create <span class="token operator">-</span>f recommended<span class="token punctuation">.</span>yaml
</code></pre> 
<p><img src="https://images2.imgbox.com/d5/e1/Qsb791NV_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：这一步很有可能会报错，提示连接拒绝，后面的异常问题记录有详解，是网络原因</p> 
</blockquote> 
<ol start="2"><li>执行kubectl create -f recommended.yaml命令后，再执行下面这行，可以看到dashboard已启动</li></ol> 
<pre><code class="prism language-java"><span class="token punctuation">[</span>root<span class="token annotation punctuation">@master01</span> <span class="token operator">~</span><span class="token punctuation">]</span># kubectl get svc <span class="token operator">-</span>n kubernetes<span class="token operator">-</span>dashboard
</code></pre> 
<p><img src="https://images2.imgbox.com/46/3b/y5f9uhsQ_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li>在浏览器输入我们的这台机器的ip+端口，进入登录页面<br> <img src="https://images2.imgbox.com/23/43/nMg582IF_o.png" alt="在这里插入图片描述"></li><li>获取token</li></ol> 
<pre><code class="prism language-java">kubectl <span class="token operator">-</span>n kubernetes<span class="token operator">-</span>dashboard get secret
kubectl describe secrets <span class="token operator">-</span>n kubernetes<span class="token operator">-</span>dashboard kubernetes<span class="token operator">-</span>dashboard<span class="token operator">-</span>token<span class="token operator">-</span>tljmr  <span class="token operator">|</span> grep token <span class="token operator">|</span> awk <span class="token string">'NR==3{print $2}'</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/47/3d/s8D6ums2_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注：kubectl -n kubernetes-dashboard get secret 查看凭证</p> 
</blockquote> 
<ol start="5"><li>把token粘贴到登录页面上的输入token框，点击登录<br> <img src="https://images2.imgbox.com/8a/9e/HQYvkIpq_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="10_298"></a>10.安装过程的异常问题记录</h4> 
<ol><li><strong>kubeadm init 报错</strong><br> 1）[ERROR NumCPU] thee number of avaliable CPUs 1 is less than the requred 2<br> 2）[ERROR KubeltVersion] the kubelet versionijs higher than the control plane version…kubelet version :“1.19.4” Control plane version :“1.18.0”<br> <img src="https://images2.imgbox.com/00/1c/CYVOKOTy_o.png" alt="在这里插入图片描述"></li></ol> 
<blockquote> 
 <ol><li>第一个问题的错误[ERROR NumCPU] 是由于cpu的核数只有1个，k8s最低配置需要2个，物理机或者虚拟机不满足Kubernetes的基础配置造成的，而Kubernetes对GPU要求至少是2核，2G内存。解决方案：修改虚拟机的CPU核数<br> <img src="https://images2.imgbox.com/2d/87/sj2R9kNX_o.png" alt="在这里插入图片描述"></li><li>第二个错[ERROR KubeltVersion]是指版本不一致，是由于我一开始执行yum install kubelet kubeadm kubectl没有指定版本（默认最新1.19.4），但是我在kubeadm init 指定了1.18.0导致的，解决方案：yum remove kubelet kubeadm kubectl,然后重新安装，yum -y install kubelet-1.18.0 kubeadm-1.18.0 kubectl-1.18.0</li></ol> 
</blockquote> 
<p><strong>2.kubeadm join报错</strong><br> 1)[ERROR FileAvailable–etc-kubernetes-pki-ca.crt]: /etc/kubernetes/pki/ca.crt</p> 
<blockquote> 
 <p>这个问题是因为我这台机器之前安装过k8s，执行kubeadm reset重置即可</p> 
</blockquote> 
<p>2)You must delete the existing Node or change the name of this new joining</p> 
<blockquote> 
 <p>这个错误是说集群已经有相同名称的节点，必须删除同名或改变节点名称重新加入，解决方案：<br> hostnamectl set-hostname node01 修改主机名称后重新执行kubeadm join</p> 
</blockquote> 
<p>3)[ERROR FileContent–proc-sys-net-bridge-bridge-nf-call-iptables]: /proc/sys/</p> 
<blockquote> 
 <p>解决方案：执行这行命令即可<br> echo “1” &gt;/proc/sys/net/bridge/bridge-nf-call-iptables</p> 
</blockquote> 
<p>4)token过期</p> 
<blockquote> 
 <p>kubeadm init后得到的token有效期为24小时，过期后需要重新创建token,执行：<br> kubeadm token create</p> 
</blockquote> 
<p><strong>3.安装kubernetes-dashboard时遇到的错误</strong><br> 1)没有wget命令，安装wget命令接口 yum install wget<br> <img src="https://images2.imgbox.com/d7/b5/yOz9ZPLk_o.png" alt="在这里插入图片描述"><br> 2)拒绝连接 wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-rc7/aio/deploy/recommended.yaml<br> <img src="https://images2.imgbox.com/8a/7a/yxhuvYsi_o.png" alt="在这里插入图片描述"><br> 解决方案：<br> 进入网站：https://site.ip138.com/raw.Githubusercontent.com/<br> 输入 raw.githubusercontent.com<br> 查询其相关的IP地址，然后把ip写进hosts里面<br> <img src="https://images2.imgbox.com/7f/36/GoK3xkoy_o.png" alt="在这里插入图片描述"></p> 
<p>在vi /etc/hosts里面增加<br> 151.101.108.133 raw.githubusercontent.com<br> <img src="https://images2.imgbox.com/f9/07/ESGRkYHe_o.png" alt="在这里插入图片描述"></p> 
<p>错误参考:<a href="https://www.cnblogs.com/mazhiyong/p/13658192.html" rel="nofollow">raw.githubusercontent.com:443连接失败的问题<br> </a><br> 3）上一步配置hosts后还是报错 错误404：Not Found<br> <img src="https://images2.imgbox.com/53/b4/TqCFOpFA_o.png" alt="在这里插入图片描述"><br> 解决方案：多重复尝试几次即可或者过一会再试<br> <img src="https://images2.imgbox.com/ed/a7/5Q3iEDPp_o.png" alt="在这里插入图片描述"><br> 4）执行kubectl create -f recommended.yaml报错<br> 有两个原因，第一个是我一开始少加了type: NodePort这一行，第二个是空格其他的格式错误<br> <img src="https://images2.imgbox.com/02/59/W61xhpqN_o.png" alt="在这里插入图片描述"><br> 解决方案：修改正确的recommended.yaml后，执行</p> 
<pre><code class="prism language-bash">kubectl delete -f recommended.yaml
kubectl create -f recommended.yaml
</code></pre> 
<p><strong>4.安装docker-ce报错，提示已有包</strong></p> 
<blockquote> 
 <p>是因为我之前已经有安装过docker版本，但是我的版本是13.0的，现在想升级到19，卸载之前的版本<br> yum remove docker,然后执行yum -y install docker-ce,但是还是报错，提示docker.xxx.xx的包已存在，再把这个包卸载 yum remove docker.xxx.xx，然后再执行yum -y install docker-ce即可</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ff38ea35873926ea4f1a22a47c4db293/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MATLAB：repmat() 函数的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ffa33ea8b92b3cb37c590bd6be69acf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">EL1008E: Property or field ‘lastMessage‘ cannot be found on object of type ‘java.util.HashMap‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>