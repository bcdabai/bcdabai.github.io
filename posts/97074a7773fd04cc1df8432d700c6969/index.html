<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>电影数据可视化综合分析 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="电影数据可视化综合分析" />
<meta property="og:description" content="数据可视化&amp;分析实战 1.1 沈腾参演电影数据获取
1.2 电影数据可视化分析
目录 数据可视化&amp;分析实战前言1. 数据认知2. 数据可视化2.1 解决matplotlib不能绘制中文字符的问题2.2 折线图2.3 柱状图绘制2.4 箱线图绘制2.5 饼图 3. Na值处理及相关性分析3.1 相关性分析3.2 Na值处理 4. 图（graph）可视化分析总结 前言 大家好✨，这里是bio🦖。点赞&#43;关注不迷路。数据可视化在数据科学和数据分析中非常重要，例如论文中配色精美的结果图、PPT汇报中突出数据差异数据分析图等。通过可视化，我们可以直观地观察和理解数据的分布、趋势、异常值等特征。通过图表和图形，我们可以更轻松地发现数据中的模式和关联。
本文是对上一篇博客中获取的数据利用python进行可视化分析（沈腾参演电影数据获取），看完本文你将学会：
解决matplotlib不能绘制中文的问题如何使用matplotlib包绘制柱状图、折线图、箱线图、饼图等填充na的方法衡量变量之间的关系以及建模图（graph）可视化分析 本文所用的所有代码都在Github仓库，你可以下载在本地运行（提前安装好相关包~）。感兴趣的话可以star我的主页。
1. 数据认知 在可视化开始之前，我们先对数据有一个基础的认识，了解我们的数据能做什么样的可视化分析，分析之后能得到什么样的结果。本文所用数据来源于博客沈腾参演电影数据获取，也可以使用积分从CSDN资源库下载下载链接。本文所用的全部代码已notebook的格式存储在Github，建议下载使用。
首先读入文件，读入时记得使用gbk编码方式，因为我们的数据中具有中文字符。而后将Rating_value转换为浮点数，Year转换为字符，便于后续绘图。
# time: 2023.07.27 # author: bio大恐龙 import pandas as pd film_details_df = pd.read_csv(&#39;/mnt/c/Users/bio_dinosaur/Desktop/films_info.csv&#39;, encoding=&#39;gbk&#39;) film_details_df[&#39;Rating_value&#39;] = [float(i) for i in film_details_df[&#39;Rating_value&#39;]] film_details_df[&#39;Year&#39;] = [str(i) for i in film_details_df[&#39;Year&#39;]] film_details_df.head() 然后看一下数据包含的变量，思考如何进行可视化展示~
Film_name	URL	Year	Director	Actors	Genre	Rating_count	Rating_value	IMDb	Description	Interesting_count	Watched_count 0	超能一家人	https://movie." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/97074a7773fd04cc1df8432d700c6969/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-23T14:17:47+08:00" />
<meta property="article:modified_time" content="2024-01-23T14:17:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">电影数据可视化综合分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_1"></a>数据可视化&amp;分析实战</h2> 
<p><a href="https://editor.csdn.net/md/?articleId=132016703" rel="nofollow">1.1 沈腾参演电影数据获取</a><br> <a href="https://editor.csdn.net/md/?articleId=132131218" rel="nofollow">1.2 电影数据可视化分析</a></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">数据可视化&amp;分析实战</a></li><li><a href="#_11" rel="nofollow">前言</a></li><li><a href="#1__27" rel="nofollow">1. 数据认知</a></li><li><a href="#2__51" rel="nofollow">2. 数据可视化</a></li><li><ul><li><a href="#21_matplotlib_52" rel="nofollow">2.1 解决matplotlib不能绘制中文字符的问题</a></li><li><a href="#22__116" rel="nofollow">2.2 折线图</a></li><li><a href="#23__165" rel="nofollow">2.3 柱状图绘制</a></li><li><a href="#24__193" rel="nofollow">2.4 箱线图绘制</a></li><li><a href="#25__236" rel="nofollow">2.5 饼图</a></li></ul> 
  </li><li><a href="#3_Na_304" rel="nofollow">3. Na值处理及相关性分析</a></li><li><ul><li><a href="#31__305" rel="nofollow">3.1 相关性分析</a></li><li><a href="#32_Na_337" rel="nofollow">3.2 Na值处理</a></li></ul> 
  </li><li><a href="#4_graph_408" rel="nofollow">4. 图（graph）可视化分析</a></li><li><a href="#_515" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_11"></a>前言</h2> 
<p>大家好✨，这里是bio🦖。点赞+关注不迷路。数据可视化在数据科学和数据分析中非常重要，例如论文中配色精美的结果图、PPT汇报中突出数据差异数据分析图等。通过可视化，我们可以直观地观察和理解数据的分布、趋势、异常值等特征。通过图表和图形，我们可以更轻松地发现数据中的模式和关联。<br> 本文是对上一篇博客中获取的数据利用python进行可视化分析（<a href="https://editor.csdn.net/md/?articleId=132016703" rel="nofollow">沈腾参演电影数据获取</a>），看完本文你将学会：</p> 
<ol><li>解决<code>matplotlib</code>不能绘制中文的问题</li><li>如何使用<code>matplotlib</code>包绘制柱状图、折线图、箱线图、饼图等</li><li>填充na的方法</li><li>衡量变量之间的关系以及建模</li><li>图（graph）可视化分析</li></ol> 
<p>本文所用的所有代码都在<a href="https://github.com/CocoConstant/Learning/tree/main/Python/CSDN_codes_document/film_data_analysis">Github仓库</a>，你可以下载在本地运行（提前安装好相关包~）。感兴趣的话可以<code>star</code><a href="https://github.com/CocoConstant/Learning">我的主页</a>。</p> 
<p><img src="https://images2.imgbox.com/8b/0a/IivmPwZW_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="1__27"></a>1. 数据认知</h2> 
<p>在可视化开始之前，我们先对数据有一个基础的认识，了解我们的数据能做什么样的可视化分析，分析之后能得到什么样的结果。本文所用数据来源于博客<a href="https://editor.csdn.net/md/?articleId=132016703" rel="nofollow">沈腾参演电影数据获取</a>，也可以使用积分从CSDN资源库下载<a href="https://download.csdn.net/download/ouyangk1026/88152949">下载链接</a>。本文所用的全部代码已<code>notebook</code>的格式存储在<a href="https://github.com/CocoConstant/Learning/blob/main/daily_work/film_analysis/02_data_analysis.ipynb">Github</a>，建议下载使用。</p> 
<p>首先读入文件，读入时记得使用<code>gbk</code>编码方式，因为我们的数据中具有中文字符。而后将<code>Rating_value</code>转换为浮点数，<code>Year</code>转换为字符，便于后续绘图。</p> 
<pre><code class="prism language-python"><span class="token comment"># time: 2023.07.27</span>
<span class="token comment"># author: bio大恐龙</span>

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
film_details_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/bio_dinosaur/Desktop/films_info.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>
film_details_df<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> film_details_df<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
film_details_df<span class="token punctuation">[</span><span class="token string">'Year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> film_details_df<span class="token punctuation">[</span><span class="token string">'Year'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
film_details_df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>然后看一下数据包含的变量，思考如何进行可视化展示~</p> 
<pre><code class="prism language-python">Film_name	URL	Year	Director	Actors	Genre	Rating_count	Rating_value	IMDb	Description	Interesting_count	Watched_count
<span class="token number">0</span>	超能一家人	https<span class="token punctuation">:</span><span class="token operator">//</span>movie<span class="token punctuation">.</span>douban<span class="token punctuation">.</span>com<span class="token operator">/</span>subject<span class="token operator">/</span><span class="token number">35228789</span><span class="token operator">/</span>	<span class="token number">2023</span>	宋阳	<span class="token string">'艾伦'</span><span class="token punctuation">,</span> <span class="token string">'沈腾'</span><span class="token punctuation">,</span> <span class="token string">'陶慧'</span><span class="token punctuation">,</span> <span class="token string">'张琪'</span><span class="token punctuation">,</span> <span class="token string">'韩彦博'</span><span class="token punctuation">,</span> <span class="token string">'白丽娜'</span><span class="token punctuation">,</span> <span class="token string">'康晞娅'</span><span class="token punctuation">,</span> <span class="token string">'...	'</span>喜剧<span class="token string">', '</span>家庭<span class="token string">', '</span>奇幻'	<span class="token number">52844</span>	<span class="token number">4.0</span>	tt12787014	郑前（艾伦 饰）新开发的APP被狡猾又诚实的反派乞乞科夫（沈腾 饰）盯上了。幸好郑前一家人意<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	<span class="token number">54367.0</span>	<span class="token number">36868.0</span>
<span class="token number">1</span>	满江红	https<span class="token punctuation">:</span><span class="token operator">//</span>movie<span class="token punctuation">.</span>douban<span class="token punctuation">.</span>com<span class="token operator">/</span>subject<span class="token operator">/</span><span class="token number">35766491</span><span class="token operator">/</span>	<span class="token number">2023</span>	张艺谋	<span class="token string">'沈腾'</span><span class="token punctuation">,</span> <span class="token string">'易烊千玺'</span><span class="token punctuation">,</span> <span class="token string">'张译'</span><span class="token punctuation">,</span> <span class="token string">'雷佳音'</span><span class="token punctuation">,</span> <span class="token string">'岳云鹏'</span><span class="token punctuation">,</span> <span class="token string">'王佳怡'</span><span class="token punctuation">,</span> <span class="token string">'潘斌龙'</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	<span class="token string">'剧情'</span><span class="token punctuation">,</span> <span class="token string">'喜剧'</span><span class="token punctuation">,</span> <span class="token string">'悬疑'</span><span class="token punctuation">,</span> <span class="token string">'古装'</span>	<span class="token number">993333</span>	<span class="token number">7.0</span>	tt21148018	南宋绍兴年间，岳飞死后四年，秦桧率兵与金国会谈。会谈前夜，金国使者死在宰相驻地，所携密信也不<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	<span class="token number">1085283.0</span>	<span class="token number">71428.0</span>
<span class="token number">2</span>	独行月球	https<span class="token punctuation">:</span><span class="token operator">//</span>movie<span class="token punctuation">.</span>douban<span class="token punctuation">.</span>com<span class="token operator">/</span>subject<span class="token operator">/</span><span class="token number">35183042</span><span class="token operator">/</span>	<span class="token number">2022</span>	张吃鱼	<span class="token string">'沈腾'</span><span class="token punctuation">,</span> <span class="token string">'马丽'</span><span class="token punctuation">,</span> <span class="token string">'常远'</span><span class="token punctuation">,</span> <span class="token string">'李诚儒'</span><span class="token punctuation">,</span> <span class="token string">'黄才伦'</span><span class="token punctuation">,</span> <span class="token string">'李嘉琦'</span><span class="token punctuation">,</span> <span class="token string">'郝瀚'</span><span class="token punctuation">,</span> <span class="token string">'...	'</span>喜剧<span class="token string">', '</span>科幻'	<span class="token number">677450</span>	<span class="token number">6.6</span>	tt14557302	人类为抵御小行星的撞击，拯救地球，在月球部署了月盾计划。陨石提前来袭，全员紧急撤离时，维修工<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	<span class="token number">815477.0</span>	<span class="token number">40755.0</span>
<span class="token number">3</span>	四海	https<span class="token punctuation">:</span><span class="token operator">//</span>movie<span class="token punctuation">.</span>douban<span class="token punctuation">.</span>com<span class="token operator">/</span>subject<span class="token operator">/</span><span class="token number">35337517</span><span class="token operator">/</span>	<span class="token number">2022</span>	韩寒	<span class="token string">'刘昊然'</span><span class="token punctuation">,</span> <span class="token string">'刘浩存'</span><span class="token punctuation">,</span> <span class="token string">'沈腾'</span><span class="token punctuation">,</span> <span class="token string">'尹正'</span><span class="token punctuation">,</span> <span class="token string">'乔杉'</span><span class="token punctuation">,</span> <span class="token string">'周奇'</span><span class="token punctuation">,</span> <span class="token string">'张宥浩'</span><span class="token punctuation">,</span> <span class="token string">'...	'</span>喜剧<span class="token string">', '</span>动作<span class="token string">', '</span>爱情'	<span class="token number">250478</span>	<span class="token number">5.3</span>	tt14509614	在码头做摩托车特技表演顺便拉客的年轻人吴仁耀（刘昊然 饰），他多年不见的浪荡父亲吴仁腾（沈腾<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	NaN	NaN
<span class="token number">4</span>	我和我的父辈	https<span class="token punctuation">:</span><span class="token operator">//</span>movie<span class="token punctuation">.</span>douban<span class="token punctuation">.</span>com<span class="token operator">/</span>subject<span class="token operator">/</span><span class="token number">35294995</span><span class="token operator">/</span>	<span class="token number">2021</span>	吴京	<span class="token string">'吴京'</span><span class="token punctuation">,</span> <span class="token string">'章子怡'</span><span class="token punctuation">,</span> <span class="token string">'徐峥'</span><span class="token punctuation">,</span> <span class="token string">'沈腾'</span><span class="token punctuation">,</span> <span class="token string">'吴磊'</span><span class="token punctuation">,</span> <span class="token string">'黄轩'</span><span class="token punctuation">,</span> <span class="token string">'袁近辉'</span><span class="token punctuation">,</span> <span class="token string">'任...	'</span>剧情'	<span class="token number">265552</span>	<span class="token number">6.5</span>	tt15465312	继<span class="token number">2019</span>年《我和我的祖国》、<span class="token number">2020</span>年《我和我的家乡》，国庆三部曲之《我和我的父辈》接棒定<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>	NaN	NaN
</code></pre> 
<hr> 
<h2><a id="2__51"></a>2. 数据可视化</h2> 
<h3><a id="21_matplotlib_52"></a>2.1 解决matplotlib不能绘制中文字符的问题</h3> 
<p>如果我们没有中文字体，使用<code>matplotlib</code>绘图时，中文字符将会以空方块展示出来。为了解决这一问题，首先使用下面的代码输出当前你具有的字体。（<strong>如果你能够绘制中文字符，请跳到2.2</strong>）</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>font_manager <span class="token keyword">import</span> FontManager

mpl_fonts <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>name <span class="token keyword">for</span> f <span class="token keyword">in</span> FontManager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ttflist<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'matplotlib.font_manager内的所有字体:'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> f <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>mpl_fonts<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t'</span> <span class="token operator">+</span> f<span class="token punctuation">)</span>
</code></pre> 
<p>我的输出结果如下，如果含有中文字体这可以通过拼音拼出来，显然，我的字体库里面并没有中文字体（防止占用过多的篇幅，我删除了部分字体的展示，不会影响理解）。</p> 
<pre><code class="prism language-python">matplotlib<span class="token punctuation">.</span>font_manager内的所有字体<span class="token punctuation">:</span>
	DejaVu Sans
	DejaVu Sans Display
	STIXGeneral
	STIXSizeThreeSym
	STIXSizeTwoSym
	cmb10
</code></pre> 
<p>没有中文字体就需要去下载中文字体，推荐字体下载网站<a href="https://ziyouziti.com/index-index-list-type-1.html" rel="nofollow">自由字体</a>，里面有很多字体都是可以免费下载的，本文选择的<code>阿里妈妈东方大楷</code>，下载链接为<a href="http://download.ziyouziti.com/f/33689682-769797694-6143f6" rel="nofollow">阿里妈妈东方大楷</a>。当然你也可以下载你喜欢的字体用于图片绘制。</p> 
<p>而后运行下列代码，得到字体存储路径。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib
<span class="token keyword">print</span><span class="token punctuation">(</span>matplotlib<span class="token punctuation">.</span>matplotlib_fname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>结果如下，我们需要到返回结果的上级目录，即<code>/home/ouyangkang/software/anaconda3/envs/ML/lib/python3.9/site-packages/matplotlib/mpl-data/</code>，在该目录下找到<code>fonts</code>文件夹，然后进入<code>fonts</code>文件夹找到<code>ttf</code>文件夹，打开<code>ttf</code>文件夹，我们能看到很多以<code>.ttf</code>为后缀的字体文件。将我们下载<code>阿里妈妈东方大楷</code>字体中以<code>.ttf</code>结尾的文件移入<code>ttf</code>文件夹中。</p> 
<pre><code class="prism language-python"><span class="token operator">/</span>home<span class="token operator">/</span>bio_dinosaur<span class="token operator">/</span>software<span class="token operator">/</span>anaconda3<span class="token operator">/</span>envs<span class="token operator">/</span>ML<span class="token operator">/</span>lib<span class="token operator">/</span>python3<span class="token punctuation">.</span><span class="token number">9</span><span class="token operator">/</span>site<span class="token operator">-</span>packages<span class="token operator">/</span>matplotlib<span class="token operator">/</span>mpl<span class="token operator">-</span>data<span class="token operator">/</span>matplotlibrc
</code></pre> 
<p>而后运行下面的代码，会返回一个目录的路径，在该目录下找到缓存的<code>fontlist-vxxx.json</code>文件（xxx是数字），将其删除，而后重启<code>vscode</code>或者你使用的编译器，会重新生成该文件。</p> 
<pre><code class="prism language-python">matplotlib<span class="token punctuation">.</span>get_cachedir<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>最后再一次运行输出所有字体的代码。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>font_manager <span class="token keyword">import</span> FontManager

mpl_fonts <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>name <span class="token keyword">for</span> f <span class="token keyword">in</span> FontManager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ttflist<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'matplotlib.font_manager内的所有字体:'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> f <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>mpl_fonts<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\t'</span> <span class="token operator">+</span> f<span class="token punctuation">)</span>
</code></pre> 
<p>结果如下（防止占用过多的篇幅，我删除了部分字体的展示，不会影响理解），可以看到第一个便是<code>阿里妈妈东方大楷</code>。</p> 
<pre><code class="prism language-python">matplotlib<span class="token punctuation">.</span>font_manager内的所有字体<span class="token punctuation">:</span>
	Alimama DongFangDaKai
	DejaVu Sans
	DejaVu Sans Display
	DejaVu Sans Mono
	DejaVu Serif
	DejaVu Serif Display
	STIXGeneral
	STIXNonUnicode
	STIXSizeFiveSym
</code></pre> 
<hr> 
<h3><a id="22__116"></a>2.2 折线图</h3> 
<p>我们的数据中包括电影的名称以及电影的评分，可以绘制折线图或者柱状图来展示各个电影的评分，但是柱状图不适用于数据项过多的情况，当数据项过多时，柱状图可能会显得拥挤，不利于数据的清晰表达。因此，在这里我们选择折线图来展示各个电影的评分。</p> 
<p><code>plt.plot()</code>绘制折线图，输入数据为x轴数据, y轴数据，数据格式可以是<code>DataFrame</code>或者<code>List</code><br> <code>plt.text()</code>绘制文本，即下图中各个电影的分数。输入数据x轴数据, y轴数据, lable信息。其中x轴数据, y轴数据用来对应，可视化lable信息。</p> 
<p>可以看到如果我们不对数据进行任何处理，输出折线图波动较大，不利于观察最大值与最小值（同时能够发现囧妈的“囧”字没有展示出来，说明阿里妈妈东方大楷中不包含这个字）。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

movie_score <span class="token operator">=</span> film_details_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
labels <span class="token operator">=</span> movie_score<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 图片大小</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 设置中文字体</span>
plt<span class="token punctuation">.</span>rc<span class="token punctuation">(</span><span class="token string">"font"</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token string">'Alimama DongFangDaKai'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.size'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">12</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>movie_score<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> movie_score<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 字体倾斜</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span>
<span class="token comment"># 绘制对应的分数</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>movie_score<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>movie_score<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> movie_score<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/af/20/XDGO5mE4_o.png" alt="在这里插入图片描述"><br> 为了解决这一问题，我们对数据进行排序，根据得分对数据进行升序排序。其结果更加平滑，能够容易地发现《日不落酒店》是该批数据中评分最低的电影，《夏洛特烦恼》是该批数据中评分最高的电影。在这一步中，我们仅仅是使用<code>sort_values()</code>就完成对数据框完成排序，不得不再次感叹<strong>pandas</strong>的强大。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

movie_score <span class="token operator">=</span> film_details_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'Rating_value'</span><span class="token punctuation">)</span>
labels <span class="token operator">=</span> movie_score<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 设置中文字体</span>
plt<span class="token punctuation">.</span>rc<span class="token punctuation">(</span><span class="token string">"font"</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token string">'Alimama DongFangDaKai'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.size'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">12</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>movie_score<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> movie_score<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>rotation<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>movie_score<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>movie_score<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> movie_score<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/48/33/iEBugWAW_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="23__165"></a>2.3 柱状图绘制</h3> 
<p>数据当中包含年份信息，可以统计每年参演电影的数量以及电影的平均分，从而分析演员参演的电影的一般在什么水平。利用<code>pandas</code>的<code>groupby()</code>函数将相同年份的数据合并到同一个类别中，而后对同类别中的电影评分计算平均分，电影数量。</p> 
<p><code>plt.bar()</code>绘制柱状图，输入数据为x轴数据，这里是年份；y轴数据，这里是统计的电影数量。<br> <code>plt.plot()</code>绘制折线图，同2.2。<br> <code>plt.legend()</code>绘制图例，以<code>plt.bar(), plt.plot()</code>中的<code>label</code>为信息。<br> <code>plt.title()</code>绘制标题。</p> 
<p>通过解读图片可知，2020年该演员参演电影数量最多，达到了5部。同时该演员的参演电影的平均评分为5.48。在2014、2015年，这两年的电影平均分超过了7分。总体而言，该演员的参演的电影平均评分呈现下降的趋势，数量上呈现上升的趋势。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

year_analysis <span class="token operator">=</span> film_details_df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Year'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'Rating_value'</span><span class="token punctuation">:</span><span class="token string">'mean'</span><span class="token punctuation">,</span> <span class="token string">'Film_name'</span><span class="token punctuation">:</span><span class="token string">'count'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>year_analysis<span class="token punctuation">.</span>index<span class="token punctuation">,</span> year_analysis<span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Film count'</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'greenyellow'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>year_analysis<span class="token punctuation">.</span>index<span class="token punctuation">,</span> year_analysis<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Averge score'</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
<span class="token comment"># add score</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>year_analysis<span class="token punctuation">.</span>Rating_value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>year_analysis<span class="token punctuation">.</span>index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> year_analysis<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>year_analysis<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">'bottom'</span><span class="token punctuation">)</span>
<span class="token comment"># add legend</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># add title</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Averge Score And Count of Films Each Year'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9f/05/NKDydBdu_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="24__193"></a>2.4 箱线图绘制</h3> 
<p>对电影的评分对电影划分等级，按照五星档 8.5-10分、四星档 7-8.5分、三星档 6-7分、二星档 4.5-6分、一星档 2-4.5分的标准分级。这部分代码大部分是数据处理的代码，如果有问题可以留言或私信~</p> 
<p>箱线图是一种用于显示数据分布情况的统计图表，它通过展示数据的中位数、四分位数、最大值和最小值等统计信息，帮助我们了解数据的集中趋势、离散程度以及是否存在异常值。</p> 
<p><code>plt.boxplot()</code>绘制箱线图，输入数据是分级数据，这里的数据格式是嵌套的列表，类似于<code>[[level_1_1, level_1_2], [...]], [...]</code>。<br> <code>plt.plot()</code>绘制点图，同2.2，这里选择<code>ro</code>，故不会连接且为红色的圆，<code>alpha</code>是透明度的设置。</p> 
<p>从图中可知，该演员没有五星档的电影，哪怕是人尽皆知的《夏洛特烦恼》也只有四星档。同时在一星档数据、二星档数据中数据较为离散；三星档数据、四星档数据中数据较为集中。箱线图上的透明圆点在三星档最为富集，因此该演员参演的电影评分大部分位于三星档。</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">level_assignment</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> score <span class="token operator">&gt;=</span> <span class="token number">8.5</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'Five'</span>
    <span class="token keyword">elif</span> score <span class="token operator">&gt;=</span> <span class="token number">7</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'Four'</span>
    <span class="token keyword">elif</span> score <span class="token operator">&gt;=</span> <span class="token number">6</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'Three'</span>
    <span class="token keyword">elif</span> score <span class="token operator">&gt;=</span> <span class="token number">4.5</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'Two'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'One'</span>
film_details_df<span class="token punctuation">[</span><span class="token string">'Level'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>level_assignment<span class="token punctuation">,</span> film_details_df<span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># draw box figure</span>
level_analysis <span class="token operator">=</span> <span class="token punctuation">[</span>film_details_df<span class="token punctuation">[</span>film_details_df<span class="token punctuation">[</span><span class="token string">'Level'</span><span class="token punctuation">]</span> <span class="token operator">==</span> level<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> level <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"One"</span><span class="token punctuation">,</span> <span class="token string">"Two"</span><span class="token punctuation">,</span> <span class="token string">"Three"</span><span class="token punctuation">,</span> <span class="token string">"Four"</span><span class="token punctuation">,</span> <span class="token string">"Five"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"One Star"</span><span class="token punctuation">,</span> <span class="token string">"Two Star"</span><span class="token punctuation">,</span> <span class="token string">"Three Star"</span><span class="token punctuation">,</span> <span class="token string">"Four Star"</span><span class="token punctuation">,</span> <span class="token string">"Five Star"</span><span class="token punctuation">]</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'pink'</span><span class="token punctuation">,</span> <span class="token string">'lightblue'</span><span class="token punctuation">,</span> <span class="token string">'lightgreen'</span><span class="token punctuation">,</span> <span class="token string">'turquoise'</span><span class="token punctuation">,</span> <span class="token string">'mediumslateblue'</span><span class="token punctuation">]</span>

bplot <span class="token operator">=</span> plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>level_analysis<span class="token punctuation">,</span> labels<span class="token operator">=</span>labels<span class="token punctuation">,</span> patch_artist<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> vert<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># fill color</span>
<span class="token keyword">for</span> patch<span class="token punctuation">,</span> color <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>bplot<span class="token punctuation">[</span><span class="token string">'boxes'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colors<span class="token punctuation">)</span><span class="token punctuation">:</span>
    patch<span class="token punctuation">.</span>set_facecolor<span class="token punctuation">(</span>color<span class="token punctuation">)</span>

<span class="token comment"># add dots to box</span>
<span class="token keyword">for</span> num<span class="token punctuation">,</span> level <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"One"</span><span class="token punctuation">,</span> <span class="token string">"Two"</span><span class="token punctuation">,</span> <span class="token string">"Three"</span><span class="token punctuation">,</span> <span class="token string">"Four"</span><span class="token punctuation">,</span> <span class="token string">"Five"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>film_details_df<span class="token punctuation">[</span>film_details_df<span class="token punctuation">[</span><span class="token string">'Level'</span><span class="token punctuation">]</span> <span class="token operator">==</span> level<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> film_details_df<span class="token punctuation">[</span>film_details_df<span class="token punctuation">[</span><span class="token string">'Level'</span><span class="token punctuation">]</span> <span class="token operator">==</span> level<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'ro'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/da/nkHsvpJp_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="25__236"></a>2.5 饼图</h3> 
<p>通过电影所属类别可以判断出该演员属于什么类型的演员，例如动作演员、喜剧演员等等。这里采用饼图来可视化。饼图是一种用于展示分类数据占比关系的图表，它通过将数据分成几个扇形区域，每个扇形区域的大小表示对应类别在总体中的占比。</p> 
<p><code>plt.subplots()</code> 函数来创建一个具有特定大小和等宽等高比的子图，参数<code>figsize</code>设置图片大小，参数<code>subplot_kw</code>是传递给子图的关键字参数。<br> <code>pli.pie()</code>绘制饼图，输入数据需要是一维数据。<br> <code>ax.legend()</code>为子图添加图例，输入数据同样为一维数据。</p> 
<p>通过对饼图的可视化可知，该演员参演的大部分电影类型为喜剧，其次分别是剧情和爱情。基于获取的数据可以将该演员定义为喜剧演员。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> re

genre_dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
total_num <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> film_details_df<span class="token punctuation">.</span>Genre<span class="token punctuation">:</span>
    genre <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    genre <span class="token operator">=</span> <span class="token punctuation">[</span>k<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> genre<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> g <span class="token keyword">in</span> genre<span class="token punctuation">:</span>
        genre_dic<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">=</span> genre_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        total_num <span class="token operator">+=</span> <span class="token number">1</span>

fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> subplot_kw<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>aspect<span class="token operator">=</span><span class="token string">'equal'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

wages<span class="token punctuation">,</span> text<span class="token operator">=</span>plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>genre_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Genre'</span><span class="token punctuation">,</span> <span class="token string">'Count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Count <span class="token operator">/</span> total_num<span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        labels<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>genre_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Genre'</span><span class="token punctuation">,</span> <span class="token string">'Count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Genre<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>wages<span class="token punctuation">,</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>genre_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Genre'</span><span class="token punctuation">,</span> <span class="token string">'Count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Genre<span class="token punctuation">,</span> loc<span class="token operator">=</span><span class="token string">'center left'</span><span class="token punctuation">,</span> bbox_to_anchor<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/85/6b/xp2ZRRgn_o.png" alt="在这里插入图片描述"><br> 同时，本文还给出了绘制升级版饼图的代码，简称为饼图plus（大饼）。可以自己尝试去解读一下代码~，遇到不会的可以<code>print()</code>看看到底是什么妖魔鬼怪。<a href="https://matplotlib.org/stable/gallery/pie_and_polar_charts/pie_and_donut_labels.html#sphx-glr-gallery-pie-and-polar-charts-pie-and-donut-labels-py" rel="nofollow">饼图plus参考连接</a>。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> subplot_kw<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>aspect<span class="token operator">=</span><span class="token string">"equal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

wedges<span class="token punctuation">,</span> texts <span class="token operator">=</span> ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>genre_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Genre'</span><span class="token punctuation">,</span> <span class="token string">'Count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Count<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                       wedgeprops<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> startangle<span class="token operator">=</span><span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">)</span>

bbox_props <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>boxstyle<span class="token operator">=</span><span class="token string">'square, pad=0.3'</span><span class="token punctuation">,</span> fc<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> ec<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> lw<span class="token operator">=</span><span class="token number">0.72</span><span class="token punctuation">)</span>

kw <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>arrowprops<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>arrowstyle<span class="token operator">=</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          bbox<span class="token operator">=</span>bbox_props<span class="token punctuation">,</span>
          zorder<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
          va<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i<span class="token punctuation">,</span> p <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>wedges<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ang <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>theta2 <span class="token operator">-</span> p<span class="token punctuation">.</span>theta1<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> p<span class="token punctuation">.</span>theta1
    y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>np<span class="token punctuation">.</span>deg2rad<span class="token punctuation">(</span>ang<span class="token punctuation">)</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>np<span class="token punctuation">.</span>deg2rad<span class="token punctuation">(</span>ang<span class="token punctuation">)</span><span class="token punctuation">)</span>

    horizontalaligment <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">'right'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token string">'left'</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    connectionstyle <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"angle, angleA=0, angleB=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>ang<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    kw<span class="token punctuation">[</span><span class="token string">'arrowprops'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'connectionstyle'</span><span class="token punctuation">:</span>connectionstyle<span class="token punctuation">}</span><span class="token punctuation">)</span>

    ax<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>genre_dic<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Genre'</span><span class="token punctuation">,</span> <span class="token string">'Count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Genre<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                xy<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
                xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.35</span><span class="token operator">*</span>np<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.4</span><span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>
                horizontalalignment<span class="token operator">=</span>horizontalaligment<span class="token punctuation">,</span>
                <span class="token operator">**</span>kw<span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/16/d4/odgx7Ic4_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="3_Na_304"></a>3. Na值处理及相关性分析</h2> 
<h3><a id="31__305"></a>3.1 相关性分析</h3> 
<p>在数据获取阶段，部分数据存在缺失的情况。如何处理缺失数据是数据处理一直一来面临的问题，最简单同时也是最容易的操作方法是将缺失值填充为平均数、中位数之类的数据。但是这种方式并没有考虑不同变量之间的相关性，例如一部电影评分为9.0分，这部电影的评论人数为10万，另一部电影的评分为6.0分，评论人数为5万，但缺失评论人数的电影评分为5.3分，其评论人数填充为平均值7.5万，显然是不合理的操作。</p> 
<p>因此，可以考虑<strong>使用模型预测</strong>缺失值。这里首先将数据转换为浮点数，便于后续模型的拟合与预测。同时将数据划分为不含缺失值部分、含缺失值部分。使用<code>seaborn</code>库中的<code>pairplot()</code>函数绘制不含缺失值部分数据两两变量之间的相关性。在本文中缺失的数据为<code>Interesting_count</code>、<code>Watched_count</code>。</p> 
<p>从绘制的图中可以看出<code>Interesting_count</code>与<code>Rating_count</code>、<code>Rating_value</code>之间相关性较好；而<code>Watched_count</code>与<code>Rating_count</code>、<code>Rating_value</code>之间相关性较差。因此可以考虑使用线性模型拟合<code>Interesting_count</code>，用非线性模型拟合<code>Watched_count</code>。</p> 
<pre><code class="prism language-python"><span class="token comment"># data pre-procession</span>
fit_data <span class="token operator">=</span> film_details_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">,</span> <span class="token string">'Interesting_count'</span><span class="token punctuation">,</span> <span class="token string">'Watched_count'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># transform data format from str to float</span>
fit_data<span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> fit_data<span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fit_data<span class="token punctuation">[</span><span class="token string">'Interesting_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> fit_data<span class="token punctuation">[</span><span class="token string">'Interesting_count'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fit_data<span class="token punctuation">[</span><span class="token string">'Watched_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> fit_data<span class="token punctuation">[</span><span class="token string">'Watched_count'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># split data by Na</span>
known_data <span class="token operator">=</span> fit_data<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Interesting_count'</span><span class="token punctuation">,</span> <span class="token string">'Watched_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
unknown_data <span class="token operator">=</span> fit_data<span class="token punctuation">[</span>fit_data<span class="token punctuation">.</span>isna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">any</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># visualization</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token comment"># correlation analysis</span>
sns<span class="token punctuation">.</span>pairplot<span class="token punctuation">(</span>known_data<span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">"reg"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/54/71/7pOLFOM1_o.png" alt="在这里插入图片描述"><br> 如果你对于上诉相关性的分析不是很了解，可以从下图中更好了解两两变量之间的相关性。如<code>Rating_value</code>与<code>Interesting_count</code>之间的相关性是0.68，<code>Rating_value</code>与<code>Watched_count</code>之间的相关性仅为0.33。与上诉相关性描述一致。<br> 这里首先使用<code>pandas</code>中的<code>corr()</code>计算变量之间的相关性，而后使用<code>seaborn</code>的<code>heatmap()</code>绘制热图。同时热图是一种很好展示相关性的可视化方法~</p> 
<pre><code class="prism language-python">sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>known_data<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">'.2f'</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>sns<span class="token punctuation">.</span>cubehelix_palette<span class="token punctuation">(</span>as_cmap<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> center<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/0e/GPnMXeZt_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="32_Na_337"></a>3.2 Na值处理</h3> 
<p>如3.1所述，本文使用线性模型拟合<code>Interesting_count</code>，用非线性模型拟合<code>Watched_count</code>。这里采用多元线性模型以及支持向量机模型分别拟合两个变量。所采用的包为<code>sklearn</code>，一个强大机器学习包，只需要简单的使用<code>fit()</code>、<code>predict()</code>就可以完成数据的拟合与预测。这里就不多做介绍，感兴趣的小伙伴可以关注或订阅我的专栏<a href="https://blog.csdn.net/ouyangk1026/category_12047787.html">机器学习</a>（持续更新中~）。</p> 
<pre><code class="prism language-python"><span class="token comment">#################### linear model ####################</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> linear_model

<span class="token comment"># interesting count model</span>
reg_interesting <span class="token operator">=</span> linear_model<span class="token punctuation">.</span>LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>
reg_interesting<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>known_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> known_data<span class="token punctuation">[</span><span class="token string">'Interesting_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># slope</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>reg_interesting<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>
<span class="token comment"># intercept</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>reg_interesting<span class="token punctuation">.</span>intercept_<span class="token punctuation">)</span>
<span class="token comment"># fill na</span>
unknown_data<span class="token punctuation">[</span><span class="token string">'Interesting_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>reg_interesting<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>unknown_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#################### svm model ####################</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVR
<span class="token comment"># from sklearn.metrics import mean_squared_error</span>

x_train <span class="token operator">=</span> known_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">,</span> <span class="token string">'Interesting_count'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
y_train <span class="token operator">=</span> known_data<span class="token punctuation">[</span><span class="token string">'Watched_count'</span><span class="token punctuation">]</span>

svr_model <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token comment"># fill na</span>
unknown_data<span class="token punctuation">[</span><span class="token string">'Watched_count'</span><span class="token punctuation">]</span> <span class="token operator">=</span> svr_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>unknown_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">,</span> <span class="token string">'Interesting_count'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>非线性模型不可以可视化，由于数据不多，不太好反映预测数据的准确性，当然这里这是将它作为一个示例来介绍使用模型预测缺失值的方法。但是线性模型可以可视化，将真实数据画为点，预测数据绘制为线条，可视化透明区带作为0.95的置信区间。从图中可知仅仅只有两个点在0.95置信区间之外，说明线性模型拟合的非常好~</p> 
<pre><code class="prism language-python"><span class="token comment">#################### linear model visualization ####################</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">as</span> stats

coef <span class="token operator">=</span> reg_interesting<span class="token punctuation">.</span>coef_
intercept <span class="token operator">=</span> reg_interesting<span class="token punctuation">.</span>intercept_

x_test <span class="token operator">=</span> known_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
y_pred <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> coef<span class="token punctuation">)</span> <span class="token operator">+</span> intercept
y_test <span class="token operator">=</span> known_data<span class="token punctuation">[</span><span class="token string">'Interesting_count'</span><span class="token punctuation">]</span>

<span class="token comment"># confidence area</span>
confidence <span class="token operator">=</span> <span class="token number">0.95</span>
alpha <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> confidence

residuals <span class="token operator">=</span> y_test <span class="token operator">-</span> y_pred
std_err <span class="token operator">=</span> np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>residuals<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

margin_of_error <span class="token operator">=</span> std_err <span class="token operator">*</span>  stats<span class="token punctuation">.</span>t<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> alpha <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

confidence_lower <span class="token operator">=</span> y_pred <span class="token operator">-</span> margin_of_error
confidence_upper <span class="token operator">=</span> y_pred <span class="token operator">+</span> margin_of_error

sorted_indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span>
y_pred_sorted <span class="token operator">=</span> y_pred<span class="token punctuation">[</span>sorted_indices<span class="token punctuation">]</span>
confidence_lower_sorted <span class="token operator">=</span> confidence_lower<span class="token punctuation">[</span>sorted_indices<span class="token punctuation">]</span>
confidence_upper_sorted <span class="token operator">=</span> confidence_upper<span class="token punctuation">[</span>sorted_indices<span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>y_pred_sorted<span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>y_test<span class="token punctuation">)</span><span class="token punctuation">[</span>sorted_indices<span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Actual'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">(</span>y_pred_sorted<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>y_pred_sorted<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">(</span>y_test<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>y_test<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Predicted'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span>y_pred_sorted<span class="token punctuation">,</span> confidence_lower_sorted<span class="token punctuation">,</span> confidence_upper_sorted<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'95% Confidence Interval'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predicted'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Actual'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ce/d2/CvFDRmXX_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="4_graph_408"></a>4. 图（graph）可视化分析</h2> 
<p>图是指以图（或网络）的形式来表示和组织的数据，并不是我们平常所理解的图片。在图数据中，数据元素被表示为节点（vertices）和边（edges），它们之间的关系用边来连接。 图数据能够自然地表示实体之间的复杂关系，如社交网络中的朋友关系、物流网络中的运输路径等。</p> 
<p>在本文中，使用<code>Fruchterman-Reingold</code>算法来展示<code>演员-(联系)-演员</code>关系（软件：<code>Gephi</code>），使用<code>Neo4j</code>可视化<code>导演-(导演)&gt;电影-(包括)&gt;演员</code>，<code>Fruchterman-Reingold</code>（简称FR）是一种用于图布局的算法，用于在平面上绘制一个图的节点和边，以便节点之间的连接关系能够以一种视觉上易于理解的方式呈现出来。</p> 
<p>下面是数据处理的部分，处理方式比较单一，相当于为数据添加了一个唯一编号，这个编号就代表的这个数据。不详细介绍~，如有问题可以留言或私信交流。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
film_details_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/ouyangkang/Desktop/films_info.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>

<span class="token keyword">import</span> re
<span class="token keyword">import</span> random

<span class="token comment"># set seed to reproduce result</span>
random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1026</span><span class="token punctuation">)</span>

<span class="token comment">#################### actor procession ####################</span>
actor_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># remove blank and single quotes</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> film_details_df<span class="token punctuation">.</span>Actors<span class="token punctuation">:</span>
    actors <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
    actor_list <span class="token operator">+=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> actors<span class="token punctuation">]</span>

<span class="token comment"># remove duplication</span>
actor_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>actor_list<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># create unicode</span>
ac_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
uni_code <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> actor <span class="token keyword">in</span> actor_list<span class="token punctuation">:</span>
    ac_dict<span class="token punctuation">[</span>actor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'AC'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>uni_code<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># checking whether unicodes are unique</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>ac_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>actor_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># save</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>ac_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Actor'</span><span class="token punctuation">,</span> <span class="token string">'Unicode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/ouyangkang/Desktop/actor_unicode.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>

<span class="token comment">#################### director processiong ####################</span>
dire_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>film_details_df<span class="token punctuation">.</span>Director<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1026</span><span class="token punctuation">)</span>
dire_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token comment"># create unicode</span>
<span class="token keyword">for</span> director <span class="token keyword">in</span> dire_list<span class="token punctuation">:</span>
    dire_dict<span class="token punctuation">[</span>director<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'DI'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>uni_code<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># checking whether unicodes are unique</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>dire_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dire_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># save</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dire_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Director'</span><span class="token punctuation">,</span> <span class="token string">'Unicode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/ouyangkang/Desktop/director_unicode.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>

<span class="token comment">#################### film processiong ####################</span>
film_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> film <span class="token keyword">in</span> film_details_df<span class="token punctuation">.</span>Film_name<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    film_dict<span class="token punctuation">[</span>film<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Film'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>uni_code<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>film_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>film_details_df<span class="token punctuation">.</span>Film_name<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>film_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Film'</span><span class="token punctuation">,</span> <span class="token string">'Unicode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/ouyangkang/Desktop/film_unicode.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>

<span class="token comment">#################### connection between film, director and actor ####################</span>
f_d_a_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">for</span> film <span class="token keyword">in</span> film_details_df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    actors <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> film<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Actors<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
    actors <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> actors<span class="token punctuation">]</span>
    f_d_a_dict<span class="token punctuation">[</span>film<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Film_name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>film<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Director<span class="token punctuation">:</span> actors<span class="token punctuation">}</span>

flat_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> film<span class="token punctuation">,</span> term <span class="token keyword">in</span> f_d_a_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> director<span class="token punctuation">,</span> actor_list <span class="token keyword">in</span> term<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> actor <span class="token keyword">in</span> actor_list<span class="token punctuation">:</span>
            flat_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>film<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actor<span class="token punctuation">]</span><span class="token punctuation">)</span>
            
f_d_a_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>flat_data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Film'</span><span class="token punctuation">,</span> <span class="token string">'Director'</span><span class="token punctuation">,</span> <span class="token string">'Actors'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
f_d_a_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/ouyangkang/Desktop/film_dir_ac.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>

<span class="token comment">#################### connection between actors ####################</span>
st_connection <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> film <span class="token keyword">in</span> film_details_df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    actors <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> film<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Actors'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
    actors <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> actors<span class="token punctuation">]</span>
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>actors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>actors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            st_connection<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>actors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> actors<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>st_connection<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Actor_1'</span><span class="token punctuation">,</span> <span class="token string">'Actor_2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'/mnt/c/Users/ouyangkang/Desktop/connection.csv'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'gbk'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre> 
<p>在<code>Neo4j Desktop</code>中使用下述<code>Cypher</code>语言构建<code>导演-(导演)&gt;电影-(包括)&gt;演员</code>关系图谱。因为对<code>Cypher</code>语言还不够熟练，并没有分析出具有意义的结果，见谅~</p> 
<pre><code class="prism language-python"><span class="token comment"># NEO4J COMMAND</span>

CREATE CONSTRAINT actor_unicode FOR <span class="token punctuation">(</span>a<span class="token punctuation">:</span>actor<span class="token punctuation">)</span> REQUIRE a<span class="token punctuation">.</span><span class="token builtin">unicode</span> IS UNIQUE
CREATE CONSTRAINT director_unicode FOR <span class="token punctuation">(</span>d<span class="token punctuation">:</span>director<span class="token punctuation">)</span> REQUIRE d<span class="token punctuation">.</span><span class="token builtin">unicode</span> IS UNIQUE
CREATE CONSTRAINT film_unicode FOR <span class="token punctuation">(</span>f<span class="token punctuation">:</span>film<span class="token punctuation">)</span> REQUIRE f<span class="token punctuation">.</span><span class="token builtin">unicode</span> IS UNIQUE

LOAD CSV WITH HEADERS FROM <span class="token string">'file:///actor_unicode.csv'</span> AS row MERGE <span class="token punctuation">(</span>a<span class="token punctuation">:</span>actor <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Actor<span class="token punctuation">,</span> <span class="token builtin">unicode</span><span class="token punctuation">:</span>row<span class="token punctuation">.</span>Unicode<span class="token punctuation">}</span><span class="token punctuation">)</span>
LOAD CSV WITH HEADERS FROM <span class="token string">'file:///director_unicode.csv'</span> AS row MERGE <span class="token punctuation">(</span>d<span class="token punctuation">:</span>director <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Director<span class="token punctuation">,</span> <span class="token builtin">unicode</span><span class="token punctuation">:</span>row<span class="token punctuation">.</span>Unicode<span class="token punctuation">}</span><span class="token punctuation">)</span>
LOAD CSV WITH HEADERS FROM <span class="token string">'file:///film_unicode.csv'</span> AS row MERGE <span class="token punctuation">(</span>f<span class="token punctuation">:</span>film <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Film<span class="token punctuation">,</span><span class="token builtin">unicode</span><span class="token punctuation">:</span>row<span class="token punctuation">.</span>Unicode<span class="token punctuation">}</span><span class="token punctuation">)</span>

LOAD CSV WITH HEADERS FROM <span class="token string">'file:///film_dir_ac.csv'</span> AS row MERGE <span class="token punctuation">(</span>d<span class="token punctuation">:</span>director <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Director<span class="token punctuation">}</span><span class="token punctuation">)</span> MERGE <span class="token punctuation">(</span>f<span class="token punctuation">:</span>film <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Film<span class="token punctuation">}</span><span class="token punctuation">)</span> MERGE <span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token punctuation">:</span>Directs<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>
LOAD CSV WITH HEADERS FROM <span class="token string">'file:///film_dir_ac.csv'</span> AS row MERGE <span class="token punctuation">(</span>f<span class="token punctuation">:</span>film <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Film<span class="token punctuation">}</span><span class="token punctuation">)</span> MERGE <span class="token punctuation">(</span>a<span class="token punctuation">:</span>actor <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Actors<span class="token punctuation">}</span><span class="token punctuation">)</span> MERGE <span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token punctuation">:</span>Including<span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
LOAD CSV WITH HEADERS FROM <span class="token string">'file:///connection.csv'</span> AS row MERGE <span class="token punctuation">(</span>a<span class="token punctuation">:</span>actor <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Actor_1<span class="token punctuation">}</span><span class="token punctuation">)</span> MERGE <span class="token punctuation">(</span>b<span class="token punctuation">:</span>actor <span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span>row<span class="token punctuation">.</span>Actor_2<span class="token punctuation">}</span><span class="token punctuation">)</span> MERGE <span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token punctuation">:</span>cooperation<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/41/86/4Lp5j1dk_o.png" alt="在这里插入图片描述"><br> 同时，使用<code>Gephi</code>对演员关系使用<code>Fruchterman-Reingold</code>算法可视化，发现参演不同电影的演员被分成了一个有一个聚类群，而共同参演多部电影的演员在图中间形成复杂的网络结构，而主角沈腾则位于最中心，成为最红的点，连接每一个演员。较粗的线条表示沈腾与该演员在多部电影中合作过，例如马丽。<br> <img src="https://images2.imgbox.com/01/61/yDzU3IEf_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="_515"></a>总结</h2> 
<p>本文对获取的电影数据做了相关的可视化分析，包括柱状图、折线图、箱线图、饼图以及相关性热图；使用模型预测Na值，包括线性模型、支持向量机模型；以及图可视化工具分析导演-电影-演员，演员-演员之间的复杂网络关系。希望看完本文你能够学会如何对数据进行合理的可视化、使用模型预测Na值以及图可视化复杂的网络关系。</p> 
<p>最后感谢大家的观看，<strong>点点关注不迷路~</strong>。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bbc32c01e41de6be7c6ce9cef5fe4e27/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Flink中的时间和窗口（时间语义，水位线，窗口，迟到数据的处理）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1f5b3a4df71907f3ff602fa43bddba1a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【JavaEE &amp; Spring】MyBatis 操作数据库(基础操作)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>