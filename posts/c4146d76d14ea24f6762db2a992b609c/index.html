<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java操作Redis数据库的redis工具,RedisUtil,jedis工具JedisUtil,JedisPoolUtil - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java操作Redis数据库的redis工具,RedisUtil,jedis工具JedisUtil,JedisPoolUtil" />
<meta property="og:description" content="该工具包含是封装了jedis,包含redis.properties和jedisPool,序列化使用的是protostuff,map类型操作使用的是fastjson
自己抽空写的,基本只要理解什么是get,什么是set就可以使用redis数据库了
下载地址:点击打开链接
JedisPoolUtil的源码:
package com.bsy.common; import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.io.InputStream; import java.net.URL; import java.util.Properties; import org.apache.commons.pool2.impl.GenericObjectPoolConfig; import redis.clients.jedis.Jedis; import redis.clients.jedis.JedisPool; import redis.clients.jedis.JedisPoolConfig; public class JedisPoolUtil { private static final String PROPERTIES_PATH = &#34;redis.properties&#34;; private static JedisPool jedisPool; static { if (jedisPool == null) { try { init(); } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } } } /** * 初始化Jedis连接池 * * @throws IOException */ private static void init() throws IOException { URL resource = JedisPoolUtil." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c4146d76d14ea24f6762db2a992b609c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-07-27T20:38:56+08:00" />
<meta property="article:modified_time" content="2017-07-27T20:38:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java操作Redis数据库的redis工具,RedisUtil,jedis工具JedisUtil,JedisPoolUtil</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-size:24px">该工具包含是封装了jedis,包含redis.properties和jedisPool,序列化使用的是protostuff,map类型操作使用的是fastjson</span></p> 
<p><span style="font-size:24px">自己抽空写的,基本只要理解什么是get,什么是set就可以使用redis数据库了</span></p> 
<p><span style="font-size:24px">下载地址:<a target="_blank" href="http://download.csdn.net/detail/miniduhua/9913147" rel="noopener noreferrer">点击打开链接</a><br> </span></p> 
<p><span style="font-size:24px">JedisPoolUtil的源码:</span><br> </p> 
<p></p> 
<pre><code class="language-java">package com.bsy.common;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.util.Properties;

import org.apache.commons.pool2.impl.GenericObjectPoolConfig;

import redis.clients.jedis.Jedis;
import redis.clients.jedis.JedisPool;
import redis.clients.jedis.JedisPoolConfig;

public class JedisPoolUtil {

	private static final String PROPERTIES_PATH = "redis.properties";
	private static JedisPool jedisPool;

	
	static {
		if (jedisPool == null) {
			try {
				init();
			} catch (FileNotFoundException e) {
				e.printStackTrace();
			} catch (IOException e) {
				e.printStackTrace();
			}
		}
	}

	/**
	 * 初始化Jedis连接池
	 * 
	 * @throws IOException
	 */
	private static void init() throws IOException {
		URL resource = JedisPoolUtil.class.getClassLoader().getResource(PROPERTIES_PATH);
		if (resource == null) {
			throw new FileNotFoundException("没有找到指定redis的配置文件:" + PROPERTIES_PATH);
		}
		//加载配置文件
		InputStream input = new FileInputStream(resource.getFile());
		Properties p = new Properties();
		p.load(input);
		//开始配置JedisPool
		String host = p.getProperty("redis.host") == null ? "localhost" : p.getProperty("redis.host");
		int port = p.getProperty("redis.port") == null ? 6379 : Integer.parseInt(p.getProperty("redis.port"));
		String auth = p.getProperty("redis.auth");
		int poolTimeOut = p.getProperty("connectionTimeOut") == null ? 2000
				: Integer.parseInt(p.getProperty("connectionTimeOut"));
		//判断使用默认的配置方式还是采用自定义配置方式,
		boolean isSetDefault = p.getProperty("defaultSetting") == null ? true
				: Boolean.parseBoolean(p.getProperty("defaultSetting"));
		if (isSetDefault) {
			jedisPool = new JedisPool(new GenericObjectPoolConfig(), host, port, poolTimeOut, auth);
		} else {
			JedisPoolConfig config = new JedisPoolConfig();
			String blockWhenExhausted = p.getProperty("redis.blockWhenExhausted");
			if (blockWhenExhausted != null) {
				config.setBlockWhenExhausted(Boolean.parseBoolean(blockWhenExhausted));
			}
			String evictionPolicyClassName = p.getProperty("redis.evictionPolicyClassName");
			if (evictionPolicyClassName != null) {
				config.setEvictionPolicyClassName(evictionPolicyClassName);
			}
			String jmxEnabled = p.getProperty("redis.jmxEnabled");
			if (jmxEnabled != null) {
				config.setJmxEnabled(Boolean.parseBoolean(jmxEnabled));
			}
			String lifo = p.getProperty("redis.lifo");
			if (lifo != null) {
				config.setLifo(Boolean.parseBoolean(lifo));
			}
			String maxIdle = p.getProperty("redis.maxIdle");
			if (maxIdle != null) {
				config.setMaxIdle(Integer.parseInt(maxIdle));
			}
			String maxTotal = p.getProperty("redis.maxTotal");
			if (maxTotal != null) {
				config.setMaxTotal(Integer.parseInt(maxTotal));
			}
			String maxWaitMillis = p.getProperty("redis.maxWaitMillis");
			if (maxWaitMillis != null) {
				config.setMaxWaitMillis(Long.parseLong(maxWaitMillis));
			}
			String minEvictableIdleTimeMillis = p.getProperty("redis.minEvictableIdleTimeMillis");
			if (minEvictableIdleTimeMillis != null) {
				config.setMinEvictableIdleTimeMillis(Long.parseLong(minEvictableIdleTimeMillis));
			}
			String minIdle = p.getProperty("redis.minIdle");
			if (minIdle != null) {
				config.setMinIdle(Integer.parseInt(minIdle));
			}
			String numTestsPerEvictionRun = p.getProperty("redis.numTestsPerEvictionRun");
			if (numTestsPerEvictionRun != null) {
				config.setNumTestsPerEvictionRun(Integer.parseInt(numTestsPerEvictionRun));
			}
			String softMinEvictableIdleTimeMillis = p.getProperty("redis.softMinEvictableIdleTimeMillis");
			if (softMinEvictableIdleTimeMillis != null) {
				config.setSoftMinEvictableIdleTimeMillis(Long.parseLong(softMinEvictableIdleTimeMillis));
			}
			String testOnBorrow = p.getProperty("redis.testOnBorrow");
			if (testOnBorrow != null) {
				config.setTestOnBorrow(Boolean.parseBoolean(testOnBorrow));
			}
			String testWhileIdle = p.getProperty("redis.testWhileIdle");
			if (testWhileIdle != null) {
				config.setTestWhileIdle(Boolean.parseBoolean(testWhileIdle));
			}
			String timeBetweenEvictionRunsMillis = p.getProperty("redus.timeBetweenEvictionRunsMillis");
			if (timeBetweenEvictionRunsMillis != null) {
				config.setTimeBetweenEvictionRunsMillis(Long.parseLong(timeBetweenEvictionRunsMillis));
			}
			jedisPool = new JedisPool(config, host, port, poolTimeOut, auth);
		}

	}

	public static Jedis getJedis() {
		return jedisPool.getResource();
	}

	public static void closeJedis(Jedis jedis) {
		if (jedis != null) {
			jedis.close();
		}
	}

}
</code></pre> 
<br> 
<span style="font-size:24px">redis.properties源码:</span> 
<p></p> 
<p><span style="font-size:24px"></span></p> 
<pre><code class="language-plain">#redis地址
redis.host=localhost
#redis端口号
redis.port=6379
#redis的密码
#redis.auth=

#是否使用JedisPool默认的配置,确定true,默认true
#defaultSetting=false;
#jedisPool的timeout时间,默认2000
#connectionTimeOut=
#连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true
#redis.blockWhenExhausted=true
#设置的逐出策略类名, 默认DefaultEvictionPolicy(当连接超过最大空闲时间,或连接数超过最大空闲连接数)
#redis.evictionPolicyClassName=org.apache.commons.pool2.impl.DefaultEvictionPolicy
#是否启用pool的jmx管理功能, 默认true
#redis.jmxEnabled=true
#是否启用后进先出, 默认true
#redis.lifo=true
#最大空闲连接数, 默认8个
#redis.maxIdle=8	
#最大连接数, 默认8个
#redis.maxTotal=8
#获取连接时的最大等待毫秒数(如果设置为阻塞时BlockWhenExhausted),如果超时就抛异常, 小于零:阻塞不确定的时间,  默认-1
#redis.maxWaitMillis=-1
#逐出连接的最小空闲时间 默认1800000毫秒(30分钟)
#redis.minEvictableIdleTimeMillis=1800000
#最小空闲连接数, 默认0
#redis.minIdle=0
#每次逐出检查时 逐出的最大数目 如果为负数就是 : 1/abs(n), 默认3
#redis.numTestsPerEvictionRun=3
#对象空闲多久后逐出, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲数 时直接逐出,不再根据MinEvictableIdleTimeMillis判断  (默认逐出策略)   
#redis.softMinEvictableIdleTimeMillis=1800000
#在获取连接的时候检查有效性, 默认false
#redis.testOnBorrow=false
#在空闲时检查有效性, 默认false
#redis.testWhileIdle=false
#逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1
#redus.timeBetweenEvictionRunsMillis=-1
</code></pre> 
<br> 
<br> 
<p></p> 
<p><span style="font-size:24px"><br> </span></p> 
<p><span style="font-size:24px">JedisUtil源码:</span></p> 
<p><span style="font-size:24px"></span></p> 
<pre><code class="language-java">package com.bsy.common;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

import com.alibaba.fastjson.JSON;
import com.dyuproject.protostuff.LinkedBuffer;
import com.dyuproject.protostuff.ProtostuffIOUtil;
import com.dyuproject.protostuff.runtime.RuntimeSchema;

import redis.clients.jedis.Jedis;
import redis.clients.jedis.exceptions.JedisDataException;

/**
 * jedis的帮助工具 本类map依赖fastjson,对象与集合使用protostuff序列化框架 jedis版本2.9.0
 * protostuff相关版本1.0.8 fastjson版本1.2.32 使用maven自动添加依赖
 * 
 * @author Mirren
 *
 */
public class JedisUtil {
	private static final int DEFAULT_SETEX_TIMEOUT = 60 * 60;// setex的默认时间

	/**
	 * 添加一个字符串值,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int set(String key, String value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			if (jedis.set(key, value).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}

	}

	/**
	 * 缓存一个字符串值,成功返回1,失败返回0,默认缓存时间为1小时,以本类的常量DEFAULT_SETEX_TIMEOUT为准
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setEx(String key, String value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			if (jedis.setex(key, DEFAULT_SETEX_TIMEOUT, value).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个字符串值,成功返回1,失败返回0,缓存时间以timeout为准,单位秒
	 * 
	 * @param key
	 * @param value
	 * @param timeout
	 * @return
	 */
	public static int setEx(String key, String value, int timeout) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			if (jedis.setex(key, timeout, value).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个指定类型的对象,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static &lt;T&gt; int set(String key, T value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = enSeri(value);
			if (jedis.set(key.getBytes(), data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个指定类型的对象,成功返回1,失败返回0,默认缓存时间为1小时,以本类的常量DEFAULT_SETEX_TIMEOUT为准
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static &lt;T&gt; int setEx(String key, T value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = enSeri(value);
			if (jedis.setex(key.getBytes(), DEFAULT_SETEX_TIMEOUT, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个指定类型的对象,成功返回1,失败返回0,缓存时间以timeout为准,单位秒
	 * 
	 * @param key
	 * @param value
	 * @param timeout
	 * @return
	 */
	public static &lt;T&gt; int setEx(String key, T value, int timeout) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = enSeri(value);
			if (jedis.setex(key.getBytes(), timeout, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 将一个数值+1,成功返回+后的结果,失败返回null
	 * 
	 * @param key
	 * @return
	 * @throws JedisDataException
	 */
	public static Long incr(String key) throws JedisDataException {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			return jedis.incr(key);
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 将一个数值-1,成功返回-后的结果,失败返回null
	 * 
	 * @param key
	 * @return
	 * @throws JedisDataException
	 */
	public static Long decr(String key) throws JedisDataException {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			return jedis.decr(key);
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个字符串值到list中,,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setList(String key, String... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Long result = jedis.rpush(key, value);
			if (result != null &amp;&amp; result != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个字符串值到list中,全部list的key默认缓存时间为1小时,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setExList(String key, String... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Long result = jedis.rpush(key, value);
			jedis.expire(key, DEFAULT_SETEX_TIMEOUT);
			if (result != null &amp;&amp; result != 0) {
				return 1;
			} else {
				return 0;
			}

		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个字符串值到list中,全部list的key缓存时间为timeOut,单位为秒,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setExList(String key, int timeOut, String... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Long result = jedis.rpush(key, value);
			jedis.expire(key, timeOut);
			if (result != null &amp;&amp; result != 0) {
				return 1;
			} else {
				return 0;
			}

		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个&lt;T&gt;类型对象值到list中,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	@SafeVarargs
	public static &lt;T&gt; int setList(String key, T... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			int res = 0;
			for (T t : value) {
				byte[] data = enSeri(t);
				Long result = jedis.rpush(key.getBytes(), data);
				if (result != null &amp;&amp; result != 0) {
					res++;
				}
			}
			if (res != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个&lt;T&gt;类型对象值到list中,全部list的key默认缓存时间为1小时,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	@SafeVarargs
	public static &lt;T&gt; int setExList(String key, T... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			int res = 0;
			for (T t : value) {
				byte[] data = enSeri(t);
				Long result = jedis.rpush(key.getBytes(), data);
				if (result != null &amp;&amp; result != 0) {
					res++;
				}
			}
			jedis.expire(key, DEFAULT_SETEX_TIMEOUT);
			if (res != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个&lt;T&gt;类型对象值到list中,全部list的key缓存时间为timeOut,单位秒,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	@SafeVarargs
	public static &lt;T&gt; int setExList(String key, int timeOut, T... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			int res = 0;
			for (T t : value) {
				byte[] data = enSeri(t);
				Long result = jedis.rpush(key.getBytes(), data);
				if (result != null &amp;&amp; result != 0) {
					res++;
				}
			}
			jedis.expire(key, timeOut);
			if (res != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个List集合成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 * @throws IOException
	 * @throws RuntimeException
	 */
	public static &lt;T&gt; int setList(String key, List&lt;T&gt; value) throws RuntimeException, IOException {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = enSeriList(value);
			if (jedis.set(key.getBytes(), data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个List&lt;T&gt;集合,成功返回1,失败返回0,默认缓存时间为1小时,以本类的常量DEFAULT_SETEX_TIMEOUT为准
	 * 
	 * @param key
	 * @param value
	 * @return
	 * @throws IOException
	 * @throws RuntimeException
	 */

	public static &lt;T&gt; int setExList(String key, List&lt;T&gt; value) throws RuntimeException, IOException {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = enSeriList(value);
			if (jedis.setex(key.getBytes(), DEFAULT_SETEX_TIMEOUT, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个List&lt;T&gt;集合,成功返回1,失败返回0,缓存时间以timeout为准,单位秒
	 * 
	 * @param key
	 * @param value
	 * @param timeout
	 * @return
	 * @throws IOException
	 * @throws RuntimeException
	 */
	public static &lt;T&gt; int setExList(String key, List&lt;T&gt; value, int timeout) throws RuntimeException, IOException {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = enSeriList(value);
			if (jedis.setex(key.getBytes(), timeout, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个字符串到set,如果key存在就在就最追加,如果key不存在就创建,成功返回1,失败或者没有受影响返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setSet(String key, String... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Long result = jedis.sadd(key, value);
			if (result != null &amp;&amp; result != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个字符串set,如果key存在就在就最追加,整个set的key默认一小时后过期,如果key存在就在可以种继续添加,如果key不存在就创建,成功返回1,失败或者没有受影响返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setExSet(String key, String... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Long result = jedis.sadd(key, value);
			jedis.expire(key, DEFAULT_SETEX_TIMEOUT);
			if (result != null &amp;&amp; result != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个字符串set,如果key存在就在就最追加,整个set的key有效时间为timeOut时间,单位秒,如果key存在就在可以种继续添加,如果key不存在就创建,,成功返回1,失败或者没有受影响返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static int setExSet(String key, int timeOut, String... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Long result = jedis.sadd(key, value);
			jedis.expire(key, timeOut);
			if (result != null &amp;&amp; result != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个&lt;T&gt;类型到set集合,如果key存在就在就最追加,成功返回1,失败或者没有受影响返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	@SafeVarargs
	public static &lt;T&gt; int setSet(String key, T... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			int res = 0;
			for (T t : value) {
				byte[] data = enSeri(t);
				Long result = jedis.sadd(key.getBytes(), data);
				if (result != null &amp;&amp; result != 0) {
					res++;
				}
			}
			if (res != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个&lt;T&gt;类型到set集合,如果key存在就在就最追加,整个set的key默认有效时间为1小时,成功返回1,失败或者没有受影响返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	@SafeVarargs
	public static &lt;T&gt; int setExSet(String key, T... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			int res = 0;
			for (T t : value) {
				byte[] data = enSeri(t);
				Long result = jedis.sadd(key.getBytes(), data);
				if (result != null &amp;&amp; result != 0) {
					res++;
				}
			}
			jedis.expire(key, DEFAULT_SETEX_TIMEOUT);
			if (res != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个&lt;T&gt;类型到set集合,如果key存在就在就最追加,整个set的key有效时间为timeOut,单位秒,成功返回1,失败或者没有受影响返回0
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	@SafeVarargs
	public static &lt;T&gt; int setExSet(String key, int timeOut, T... value) {
		if (isValueNull(key, value)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			int res = 0;
			for (T t : value) {
				byte[] data = enSeri(t);
				Long result = jedis.sadd(key.getBytes(), data);
				if (result != null &amp;&amp; result != 0) {
					res++;
				}
			}
			jedis.expire(key, timeOut);
			if (res != 0) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 添加一个Map&lt;K, V&gt;集合,成功返回1,失败返回0
	 * 
	 * @param key
	 * @param value
	 * @param timeout
	 * @return
	 */
	public static &lt;K, V&gt; int setMap(String key, Map&lt;K, V&gt; value) {
		if (value == null || key == null || "".equals(key)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			String data = JSON.toJSONString(value);
			if (jedis.set(key, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个Map&lt;K, V&gt;集合,成功返回1,失败返回0,默认缓存时间为1小时,以本类的常量DEFAULT_SETEX_TIMEOUT为准
	 * 
	 * @param key
	 * @param value
	 * @param timeout
	 * @return
	 */
	public static &lt;K, V&gt; int setExMap(String key, Map&lt;K, V&gt; value) {
		if (value == null || key == null || "".equals(key)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			String data = JSON.toJSONString(value);
			if (jedis.setex(key, DEFAULT_SETEX_TIMEOUT, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 缓存一个Map&lt;K, V&gt;集合,成功返回1,失败返回0,缓存时间以timeout为准,单位秒
	 * 
	 * @param key
	 * @param value
	 * @param timeout
	 * @return
	 */
	public static &lt;K, V&gt; int setExMap(String key, Map&lt;K, V&gt; value, int timeout) {
		if (value == null || key == null || "".equals(key)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			String data = JSON.toJSONString(value);
			if (jedis.setex(key, timeout, data).equalsIgnoreCase("ok")) {
				return 1;
			} else {
				return 0;
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获取一个字符串值
	 * 
	 * @param key
	 * @return
	 */
	public static String get(String key) {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			return jedis.get(key);
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个指定类型的对象
	 * 
	 * @param key
	 * @param value
	 * @return
	 */
	public static &lt;T&gt; T get(String key, Class&lt;T&gt; clazz) {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();

			byte[] data = jedis.get(key.getBytes());
			T result = deSeri(data, clazz);
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个字符串集合,区间以偏移量 START 和 END 指定。 其中 0 表示列表的第一个元素， 1
	 * 表示列表的第二个元素，以此类推。 你也可以使用负数下标，以 -1 表示列表的最后一个元素， -2 表示列表的倒数第二个元素，以此类推。
	 * 
	 * @param key
	 * @param start
	 * @param end
	 * @return
	 */
	public static List&lt;String&gt; getList(String key, long start, long end) {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			List&lt;String&gt; result = jedis.lrange(key, start, end);
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个&lt;T&gt;类型的对象集合,区间以偏移量 START 和 END 指定。 其中 0 表示列表的第一个元素， 1 表示列表的第二个元素，以此类推。
	 * 你也可以使用负数下标，以 -1 表示列表的最后一个元素， -2 表示列表的倒数第二个元素，以此类推。
	 * 
	 * @param key
	 * @param start
	 * @param end
	 * @return
	 */
	public static &lt;T&gt; List&lt;T&gt; getList(String key, long start, long end, Class&lt;T&gt; clazz) {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			List&lt;byte[]&gt; lrange = jedis.lrange(key.getBytes(), start, end);
			List&lt;T&gt; result = null;
			if (lrange != null) {
				for (byte[] data : lrange) {
					if (result == null) {
						result = new ArrayList&lt;&gt;();
					}
					result.add(deSeri(data, clazz));
				}
			}
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得list中存了多少个值
	 * 
	 * @return
	 */
	public static long getListCount(String key) {
		if (isValueNull(key)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			return jedis.llen(key);
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个List&lt;T&gt;的集合,
	 * 
	 * @param key
	 *            键
	 * @param clazz
	 *            返回集合的类型
	 * @return
	 * @throws IOException
	 */
	public static &lt;T&gt; List&lt;T&gt; getList(String key, Class&lt;T&gt; clazz) throws IOException {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			byte[] data = jedis.get(key.getBytes());
			List&lt;T&gt; result = deSeriList(data, clazz);
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个字符串set集合
	 * 
	 * @param key
	 * @return
	 */
	public static Set&lt;String&gt; getSet(String key) {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Set&lt;String&gt; result = jedis.smembers(key);
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个字符串set集合
	 * 
	 * @param key
	 * @return
	 */
	public static &lt;T&gt; Set&lt;T&gt; getSet(String key, Class&lt;T&gt; clazz) {
		if (isValueNull(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			Set&lt;byte[]&gt; smembers = jedis.smembers(key.getBytes());
			Set&lt;T&gt; result = null;
			if (smembers != null) {
				for (byte[] data : smembers) {
					if (result == null) {
						result = new HashSet&lt;&gt;();
					}
					result.add(deSeri(data, clazz));
				}
			}
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得集合中存在多少个值
	 * 
	 * @param key
	 * @return
	 */
	public static long getSetCount(String key) {
		if (isValueNull(key)) {
			return 0;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			return jedis.scard(key);
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 获得一个Map&lt;v,k&gt;的集合
	 * 
	 * @param key
	 * @param v
	 * @param k
	 * @return
	 */
	public static &lt;K, V&gt; Map&lt;K, V&gt; getMap(String key, Class&lt;K&gt; k, Class&lt;V&gt; v) {
		if (key == null || "".equals(key)) {
			return null;
		}
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			String data = jedis.get(key);
			@SuppressWarnings("unchecked")
			Map&lt;K, V&gt; result = (Map&lt;K, V&gt;) JSON.parseObject(data);
			return result;
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	/**
	 * 删除一个值
	 * 
	 * @param key
	 */
	public static void del(String... key) {
		Jedis jedis = null;
		try {
			jedis = JedisPoolUtil.getJedis();
			for (int i = 0; i &lt; key.length; i++) {
				jedis.del(key);
			}
		} finally {
			JedisPoolUtil.closeJedis(jedis);
		}
	}

	// --------------------------公用方法区------------------------------------
	/**
	 * 检查值是否为null,如果为null返回true,不为null返回false
	 * 
	 * @param obj
	 * @return
	 */
	private static boolean isValueNull(Object... obj) {
		for (int i = 0; i &lt; obj.length; i++) {
			if (obj[i] == null || "".equals(obj[i])) {
				return true;
			}
		}
		return false;
	}

	/**
	 * 序列化一个对象
	 * 
	 * @param value
	 * @return
	 */
	private static &lt;T&gt; byte[] enSeri(T value) {
		@SuppressWarnings("unchecked")
		RuntimeSchema&lt;T&gt; schema = (RuntimeSchema&lt;T&gt;) RuntimeSchema.createFrom(value.getClass());
		byte[] data = ProtostuffIOUtil.toByteArray(value, schema,
				LinkedBuffer.allocate(LinkedBuffer.DEFAULT_BUFFER_SIZE));
		return data;
	}

	/**
	 * 反序列化一个对象
	 * 
	 * @param t
	 * @return
	 */
	private static &lt;T&gt; T deSeri(byte[] data, Class&lt;T&gt; clazz) {
		if (data == null || data.length == 0) {
			return null;
		}
		RuntimeSchema&lt;T&gt; schema = RuntimeSchema.createFrom(clazz);
		T result = schema.newMessage();
		ProtostuffIOUtil.mergeFrom(data, result, schema);
		return result;
	}

	/**
	 * 序列化List集合
	 * 
	 * @param list
	 * @return
	 * @throws IOException
	 */
	private static &lt;T&gt; byte[] enSeriList(List&lt;T&gt; list) throws RuntimeException, IOException {
		if (list == null || list.size() == 0) {
			throw new RuntimeException("集合不能为空!");
		}
		@SuppressWarnings("unchecked")
		RuntimeSchema&lt;T&gt; schema = (RuntimeSchema&lt;T&gt;) RuntimeSchema.getSchema(list.get(0).getClass());
		ByteArrayOutputStream out = new ByteArrayOutputStream();
		ProtostuffIOUtil.writeListTo(out, list, schema, LinkedBuffer.allocate(LinkedBuffer.DEFAULT_BUFFER_SIZE));
		byte[] byteArray = out.toByteArray();
		return byteArray;
	}

	/**
	 * 反序列化List集合
	 * 
	 * @param data
	 * @param clazz
	 * @return
	 * @throws IOException
	 */
	private static &lt;T&gt; List&lt;T&gt; deSeriList(byte[] data, Class&lt;T&gt; clazz) throws IOException {
		if (data == null || data.length == 0) {
			return null;
		}
		RuntimeSchema&lt;T&gt; schema = RuntimeSchema.createFrom(clazz);
		List&lt;T&gt; result = ProtostuffIOUtil.parseListFrom(new ByteArrayInputStream(data), schema);
		return result;
	}

}
</code></pre> 
<br> 
<br> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0225cedcb0a1865fb97e39a421c6db2f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unity在编辑器中通过代码更改Tag</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8708b5469de9ab2eea65d2a211213b08/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Maven项目构建命令compile、test、package</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>