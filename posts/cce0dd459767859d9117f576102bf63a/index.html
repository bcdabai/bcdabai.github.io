<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【数据库8.0备份还原】之Percona XtraBackup - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【数据库8.0备份还原】之Percona XtraBackup" />
<meta property="og:description" content="目录 Percona XtraBackup备份数据库1、Percona XtraBackup的介绍2、Percona XtraBackup安装3、Percona XtraBackup8.0的使用1.全库备份和还原2.增量备份和还原3.差异备份和还原4.差异备份和增量备份的区别5.压缩备份和还原 Percona XtraBackup备份数据库 yum源安装：网站： https://repo.percona.com/yum/
Percona XtraBackup 下载网站：https://repo.percona.com/yum/
https://www.percona.com/downloads
官方下载太慢
1、Percona XtraBackup的介绍 无论是 24x7 高负载服务器还是低事务量服务器 环境中，Percona XtraBackup 旨在实现无缝备份 过程，而不会中断生产中服务器的性能 环境。Percona XtraBackup （PXB） 是一个 100% 开源备份解决方案，为希望从 MySQL 的全面、响应迅速且经济灵活的数据库支持中受益的组织提供商业支持。
Percona XtraBackup 是世界上唯一的开源免费 MySQL 热备份 为 InnoDB 和 XtraDB 执行非阻塞备份的软件 数据库。使用 Percona XtraBackup，您可以获得以下优势：
快速可靠地完成备份 备份期间不间断的事务处理 节省磁盘空间和网络带宽 自动备份验证 由于恢复时间更快，正常运行时间更长 xtrabakackup有3个工具，分别是
xtrabakup、
innobakupex、
xbstream 通过流数据功能，可将备份内容打包并传给管道后的压缩工具进行压缩
xtrabackup 支持InnoDB，XtraDB
innobakupex 支持Myisam,InnoDB、XtraaDB
xbstream：以专有格式压缩 xtrabackup 输出的信息
支持的存储引擎：
Percona XtraBackup 可以备份 MySQL 8.0 服务器以及 Percona Server for MySQL with XtraDB、Percona Server for MySQL 8." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cce0dd459767859d9117f576102bf63a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-16T18:09:56+08:00" />
<meta property="article:modified_time" content="2024-01-16T18:09:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【数据库8.0备份还原】之Percona XtraBackup</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#Percona_XtraBackup_2" rel="nofollow">Percona XtraBackup备份数据库</a></li><li><ul><li><a href="#1Percona_XtraBackup_8" rel="nofollow">1、Percona XtraBackup的介绍</a></li><li><a href="#2Percona_XtraBackup_41" rel="nofollow">2、Percona XtraBackup安装</a></li><li><a href="#3Percona_XtraBackup80_98" rel="nofollow">3、Percona XtraBackup8.0的使用</a></li><li><ul><li><a href="#1_118" rel="nofollow">1.全库备份和还原</a></li><li><a href="#2_161" rel="nofollow">2.增量备份和还原</a></li><li><a href="#3_214" rel="nofollow">3.差异备份和还原</a></li><li><a href="#4_241" rel="nofollow">4.差异备份和增量备份的区别</a></li><li><a href="#5_244" rel="nofollow">5.压缩备份和还原</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="Percona_XtraBackup_2"></a>Percona XtraBackup备份数据库</h3> 
<p>yum源安装：网站： https://repo.percona.com/yum/</p> 
<p>Percona XtraBackup 下载网站：<a href="https://repo.percona.com/yum/" rel="nofollow">https://repo.percona.com/yum/</a><br> <a href="https://www.percona.com/downloads" rel="nofollow"><strong>https://www.percona.com/downloads</strong></a><br> <mark>官方下载太慢</mark></p> 
<h4><a id="1Percona_XtraBackup_8"></a>1、Percona XtraBackup的介绍</h4> 
<p>无论是 24x7 高负载服务器还是低事务量服务器 环境中，Percona XtraBackup 旨在实现无缝备份 过程，而不会中断生产中服务器的性能 环境。Percona XtraBackup （PXB） 是一个 100% 开源备份解决方案，为希望从 MySQL 的全面、响应迅速且经济灵活的数据库支持中受益的组织提供商业支持。</p> 
<p>Percona XtraBackup 是世界上唯一的开源免费 MySQL 热备份 为 InnoDB 和 XtraDB 执行非阻塞备份的软件 数据库。使用 Percona XtraBackup，您可以获得以下优势：</p> 
<pre><code class="prism language-bash">快速可靠地完成备份
备份期间不间断的事务处理
节省磁盘空间和网络带宽
自动备份验证
由于恢复时间更快，正常运行时间更长
</code></pre> 
<blockquote> 
 <p>xtrabakackup有3个工具，分别是<br> xtrabakup、<br> innobakupex、</p> 
</blockquote> 
<blockquote> 
 <p>xbstream 通过流数据功能，可将备份内容打包并传给管道后的压缩工具进行压缩<br> xtrabackup 支持InnoDB，XtraDB<br> innobakupex 支持Myisam,InnoDB、XtraaDB<br> xbstream：以专有格式压缩 xtrabackup 输出的信息</p> 
</blockquote> 
<p><strong>支持的存储引擎：</strong><br> Percona XtraBackup 可以备份 MySQL 8.0 服务器以及 Percona Server for MySQL with XtraDB、Percona Server for MySQL 8.0 和 Percona XtraDB Cluster 8.0 上的 InnoDB、XtraDB、MyISAM 和 MyRocks 表中的数据。<br> <strong>局限性：</strong></p> 
<pre><code class="prism language-bash"><span class="token number">1</span>、Percona XtraBackup <span class="token number">8.0</span> 目前不可能同时支持 <span class="token number">8.0</span> 之前的版本
<span class="token number">2</span>、Percona XtraBackup <span class="token number">2.4</span> 支持 MySQL 和 Percona Server <span class="token keyword">for</span> MySQL <span class="token number">5.6</span> 和 <span class="token number">5.7</span> 数据库
<span class="token number">3</span>、Percona XtraBackup <span class="token number">8.1</span> 不支持对数据库进行备份 在 MySQL <span class="token number">8.1</span> 之前的版本中创建，Percona Server <span class="token keyword">for</span> MySQL 或 Percona XtraDB 集群。
</code></pre> 
<h4><a id="2Percona_XtraBackup_41"></a>2、Percona XtraBackup安装</h4> 
<p>用阿里或者清华大学percona源yum安装Percona XtraBackup==<br> <mark>事例：我用的redhat9安装这个软件</mark><br> <strong>写源仓库：</strong><br> cat &lt;&gt;/etc/yum.repos.d/percona.repo<br> [percona]<br> name = Percona<br> baseurl = https://mirrors.tuna.tsinghua.edu.cn/percona/release/$releasever/RPMS/$basearch<br> enabled = 1<br> gpgcheck = 0</p> 
<p>[epel]<br> name=epelrepo<br> baseurl=https://mirrors.aliyun.com/epel/$releasever/$basearch<br> gpgcheck=0<br> enable=1<br> eof</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@manged ~<span class="token punctuation">]</span><span class="token comment"># yum list all| grep xtraback -i    查看xtraback有哪些软件包</span>
报错
Errors during downloading metadata <span class="token keyword">for</span> repository <span class="token string">'epel'</span><span class="token builtin class-name">:</span>
  - Status code: <span class="token number">404</span> <span class="token keyword">for</span> https://mirrors.aliyun.com/epel/9/x86_64/repodata/repomd.xml <span class="token punctuation">(</span>IP: <span class="token number">118.112</span>.22.214<span class="token punctuation">)</span>
错误：为仓库 <span class="token string">'epel'</span> 下载元数据失败 <span class="token builtin class-name">:</span> Cannot download repomd.xml: Cannot download repodata/repomd.xml: All mirrors were tried
</code></pre> 
<p>去epel官网：<a href="https://docs.fedoraproject.org/en-US/epel/" rel="nofollow">https://docs.fedoraproject.org/en-US/epel/</a> 下载额外的软件包。</p> 
<blockquote> 
 <p>dnf install<br> https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm</p> 
</blockquote> 
<p>如果安装失败，就下载下来rpm安装：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@manged ~<span class="token punctuation">]</span><span class="token comment"># wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm</span>
<span class="token punctuation">[</span>root@manged ~<span class="token punctuation">]</span><span class="token comment"># rpm -ivh epel-release-latest-9.noarch.rpm </span>
可以<span class="token punctuation">[</span>root@manged ~<span class="token punctuation">]</span><span class="token comment"># yum repolist   查看</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@manged ~<span class="token punctuation">]</span><span class="token comment"># yum list all| grep xtraback -i   好了耶</span>
Repository epel is listed <span class="token function">more</span> than once <span class="token keyword">in</span> the configuration
holland-xtrabackup.noarch                                                                <span class="token number">1.2</span>.10-1.el9                                   epel               
percona-xtrabackup-24.x86_64                                                             <span class="token number">2.4</span>.28-1.el9                                   percona            
percona-xtrabackup-24-debuginfo.x86_64                                                   <span class="token number">2.4</span>.28-1.el9                                   percona            
percona-xtrabackup-24-debugsource.x86_64                                                 <span class="token number">2.4</span>.28-1.el9                                   percona            
percona-xtrabackup-80.x86_64                                                             <span class="token number">8.0</span>.35-30.1.el9                                percona            
percona-xtrabackup-80-debuginfo.x86_64                                                   <span class="token number">8.0</span>.35-30.1.el9                                percona            
percona-xtrabackup-80-debugsource.x86_64                                                 <span class="token number">8.0</span>.35-30.1.el9                                percona            
percona-xtrabackup-81.x86_64                                                             <span class="token number">8.1</span>.0-1.1.el9                                  percona            
percona-xtrabackup-81-debuginfo.x86_64                                                   <span class="token number">8.1</span>.0-1.1.el9
</code></pre> 
<blockquote> 
 <p>[root@manged ~]# yum install percona-xtrabackup-80<br> 安装对应数据库版本的，速度快多了。</p> 
</blockquote> 
<h4><a id="3Percona_XtraBackup80_98"></a>3、Percona XtraBackup8.0的使用</h4> 
<pre><code class="prism language-bash">常用选项:  
   <span class="token parameter variable">--host</span>     指定主机
   <span class="token parameter variable">--user</span>     指定用户名
   <span class="token parameter variable">--password</span>    指定密码
   <span class="token parameter variable">--port</span>     指定端口
   <span class="token parameter variable">--databases</span>     指定数据库
   <span class="token parameter variable">--incremental</span>    创建增量备份
   --incremental-basedir   指定包含完全备份的目录
   --incremental-dir      指定包含增量备份的目录   
   --apply-log        对备份进行预处理操作 
   --defaults-file	  指定默认配置文件，默认是读取/etc/my.cf
</code></pre> 
<p>一般情况下，在备份完成后，数据尚且不能用于恢复操作，因为备份的数据中可能会包含尚未提交的事务或已经提交但尚未同步至数据文件中的事务。因此，此时数据文件仍处理不一致状态。“准备”的主要作用正是通过回滚未提交的事务及同步已经提交的事务至数据文件也使得数据文件处于一致性状态。<br> –redo-only 不回滚未提交事务<br> –copy-back 恢复备份目录</p> 
<h5><a id="1_118"></a>1.全库备份和还原</h5> 
<p><strong>一、全库备份</strong><br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/backup -uroot -predhat -H localhost -P 3306</p> 
<blockquote> 
 <p>-p 后面是mysql的密码 -H 后面是主机，支持远程备份，-P是端口</p> 
</blockquote> 
<pre><code class="prism language-bash">   如果出现如下问题是在没有创建/data/backup/目录
<span class="token number">2023</span>-12-13T18:05:19.164770+08:00 <span class="token number">0</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> <span class="token punctuation">[</span>MY-011825<span class="token punctuation">]</span> <span class="token punctuation">[</span>Xtrabackup<span class="token punctuation">]</span> Redo Log Archiving is not <span class="token builtin class-name">set</span> up.
<span class="token number">2023</span>-12-13T18:05:19.257242+08:00 <span class="token number">0</span> <span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token punctuation">[</span>MY-011825<span class="token punctuation">]</span> <span class="token punctuation">[</span>Xtrabackup<span class="token punctuation">]</span> cannot mkdir: <span class="token number">2</span> /data/backup/
</code></pre> 
<p>出现的这个没有权限问题：</p> 
<pre><code class="prism language-bash"><span class="token number">2023</span>-12-13T11:40:23.815725-05:00 <span class="token number">0</span> <span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token punctuation">[</span>MY-011825<span class="token punctuation">]</span> <span class="token punctuation">[</span>Xtrabackup<span class="token punctuation">]</span> failed to execute query <span class="token string">'LOCK INSTANCE FOR BACKUP'</span> <span class="token builtin class-name">:</span> <span class="token number">1227</span> <span class="token punctuation">(</span><span class="token number">42000</span><span class="token punctuation">)</span> 
Access denied<span class="token punctuation">;</span> you need <span class="token punctuation">(</span>at least one of<span class="token punctuation">)</span> the BACKUP_ADMIN privilege<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> this operation
</code></pre> 
<p>解决方法：</p> 
<pre><code class="prism language-bash">GRANT BACKUP_ADMIN ON *.* TO <span class="token string">'root'</span>@<span class="token string">'localhost'</span><span class="token punctuation">;</span>  
FLUSH PRIVILEGES<span class="token punctuation">;</span>
</code></pre> 
<p><strong>二、数据库恢复</strong><br> 删掉数据库：</p> 
<pre><code class="prism language-bash">先停掉数据库systemctl stop mysqld
<span class="token function">rm</span> <span class="token parameter variable">-rf</span>  /var/lib/mysql/*         mysql这个目录的所有者，所属组都是mysql   
这个目录删除之后，重启数据库就是一个全新的数据库
</code></pre> 
<p>启动数据库，这时是一个全新的数据库。</p> 
<p>备份之前要<mark>删除/var/lib/mysql/* <mark>的文件，并且</mark>先停掉数据库</mark><strong>，还原的时候数据库dead状态</strong><br> 先备份备份集：<br> 备份后的数据并不处于一致性状态，为了可以用来恢复，需要使用-prepare准备备份集<br> [root@redhat ~]# xtrabackup --prepare --target-dir=/data/backup 准备数据备份集<br> [root@redhat ~]# xtrabackup --copy-back --target-dir=/data/backup 备份<br> 然后<strong>chown mysql:mysql /var/lib/mysql/ -R</strong><br> 再重启数据库就完成了。非常完美！</p> 
<p><strong>注意：好像数据库版本不一样，还原的时候会出错</strong></p> 
<h5><a id="2_161"></a>2.增量备份和还原</h5> 
<p>先进行全备：<br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/backup -uroot -predhat -H localhost -P 3306<br> 增备份1：<br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/inc1 --incremental-basedir=/data/backup -uroot -predhat -H localhost -P 3306</p> 
<pre><code class="prism language-bash">解释：target-dir<span class="token operator">=</span>/data/inc1中的inc1目录不用自己创建，--incremental-basedir<span class="token operator">=</span>/data/backup增备份是在全备的基础上做得，这个参数是填全备的路径，全备和增备的目录要分开，不能放在一起。
</code></pre> 
<p>增备份2：<br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/inc2 --incremental-basedir=/data/inc1 -uroot -predhat -H localhost -P 3306</p> 
<pre><code class="prism language-bash">第二天也做了增量备份 ，incremental-basedir<span class="token operator">=</span>/data/inc1，这里的参数是参照增备1里备份的，所以这个参数是填增备1的路径。
</code></pre> 
<p><mark>备份好后会在/data出现3个目录，一个是全备的数据，还有个增备1的数据，还有个增备2的数据。</mark></p> 
<p><strong>恢复数据：</strong><br> <strong>准备还原命令：</strong><br> xtrabackup --defaults-file=/etc/my.cnf --prepare --apply-log-only --target-dir=/data/backup/</p> 
<p>xtrabackup --defaults-file=/etc/my.cnf --prepare --apply-log-only --target-dir=/data/backup --incremental-dir=/data/inc1/</p> 
<p>xtrabackup --defaults-file=/etc/my.cnf --prepare --target-dir=/data/backup --incremental-dir=/data/inc2/</p> 
<pre><code class="prism language-bash">以上命令就是把增量备份合并到完全备份的日志里，到时候直接还原完全备份的目录数据就行
</code></pre> 
<p><mark>注意：最好一次把增量备份恢复到全部不要加 --apply-log-only，不然会出现问题，说你没有准备好。</mark></p> 
<p><strong>恢复数据到目录：</strong><br> 停止数据库并清空数据库目录<br> xtrabackup --defaults-file=/etc/my.cnf --copy-back --target-dir=/data/backup 恢复<br> chown mysql:mysql /var/lib/mysql/ -R 把文件的所有文件属组改成mysql</p> 
<p>重启数据库，所有的数据都在，实验完成！<em>👌</em><br> <mark>遇到问题：</mark><br> 当最后一次增备加了 --apply-log-only，还原的时候会报这个错误：</p> 
<pre><code class="prism language-bash"><span class="token number">2023</span>-12-15T08:03:29.481391-05:00 <span class="token number">0</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> <span class="token punctuation">[</span>MY-011825<span class="token punctuation">]</span> <span class="token punctuation">[</span>Xtrabackup<span class="token punctuation">]</span> <span class="token builtin class-name">cd</span> to /datas/backup/
<span class="token number">2023</span>-12-15T08:03:29.481464-05:00 <span class="token number">0</span> <span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token punctuation">[</span>MY-011825<span class="token punctuation">]</span> <span class="token punctuation">[</span>Xtrabackup<span class="token punctuation">]</span> The target is not fully prepared. Please prepare it without option --apply-log-only
</code></pre> 
<pre><code class="prism language-bash">解决方法：
xtrabackup --defaults-file<span class="token operator">=</span>/etc/my.cnf <span class="token parameter variable">--prepare</span> --target-dir<span class="token operator">=</span>/datas/backup/
xtrabackup --defaults-file<span class="token operator">=</span>/etc/my.cnf --copy-back --target-dir<span class="token operator">=</span>/datas/backup
解释：也就是在做一次全备份，并且全备的时候删除--apply-log-only，再进行还原，这时候就成功了。
</code></pre> 
<h5><a id="3_214"></a>3.差异备份和还原</h5> 
<p>先进行全备：<br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/backup -uroot -predhat -H localhost -P 3306<br> 增备份1：<br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/inc1 --incremental-basedir=/data/backup -uroot -predhat -H localhost -P 3306<br> 增备份2：<br> xtrabackup --defaults-file=/etc/my.cnf --backup --target-dir=/data/inc2 --incremental-basedir=/data/backup -uroot -predhat -H localhost -P 3306</p> 
<pre><code class="prism language-bash">解释：差异备份跟增量备份其实差不多，只不过增量备份每次的参照物是前一个，而差异备份的参照物就是全备
</code></pre> 
<p><strong>恢复数据：</strong><br> <strong>准备还原命令：</strong><br> xtrabackup --defaults-file=/etc/my.cnf --prepare --apply-log-only --target-dir=/data/backup/</p> 
<p>xtrabackup --defaults-file=/etc/my.cnf --prepare --target-dir=/data/backup --incremental-dir=/data/inc2/</p> 
<pre><code class="prism language-bash">解释：准备还原只需要第一次备份和最后一次备份就行
</code></pre> 
<p><strong>恢复数据到目录：</strong><br> 停止数据库并清空数据库目录<br> xtrabackup --defaults-file=/etc/my.cnf --copy-back --target-dir=/data/backup 恢复<br> chown mysql:mysql /var/lib/mysql/ -R 把文件的所有文件属组改成mysql<br> 重启数据库，所有的数据都在，差异备份实验完成！<em>👌</em></p> 
<h5><a id="4_241"></a>4.差异备份和增量备份的区别</h5> 
<p><img src="https://images2.imgbox.com/42/6a/ZCWPGhkt_o.png" alt="在这里插入图片描述"><br> 总结一下，感觉差异备份更好用。差异备份都是基于全备备份的，而且还原的 时候只需要准备全备和最后一次增量备份就行。</p> 
<h5><a id="5_244"></a>5.压缩备份和还原</h5> 
<p>xtrabackup --defaults-file=/etc/my.cnf --backup --compress --target-dir=/data/backup/compressed/ -uroot -predhat -H localhost -P3306<br> 解释：compress就是压缩的命令，因为数据库的备份的数据比较大，占用的空间也比较多，而压缩就能减少文件大小。</p> 
<pre><code class="prism language-bash">xtrabackup --defaults-file<span class="token operator">=</span>/etc/my.cnf <span class="token parameter variable">--backup</span> --compress-threads<span class="token operator">=</span><span class="token number">4</span> --target-dir<span class="token operator">=</span>/data/backup/compress/ <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-predhat</span> <span class="token parameter variable">-H</span> localhost <span class="token parameter variable">-P3306</span>
如果要加速压缩，可以使用--compress-threads<span class="token operator">=</span><span class="token number">4</span> ，使用四个线程同时进行压缩
</code></pre> 
<p><strong>解压缩和还原：</strong><br> xtrabackup --defaults-file=/etc/my.cnf --decompress --target-dir=/data/backup/compressed/<br> 解释:解压命令 --decompress，使用这个压缩的备份集在准备备份之前需要解压，解压工具是qpress（报错就安装这个），解压的原来的文件不会被删除，可以使用 --remove-original选项清除。</p> 
<p>xtrabackup --prepare --target-dir=/data/backup/compressed/ 准备数据集<br> xtrabackup --copy-back --target-dir=/data/backup/compressed 还原</p> 
<p>解释：跟全备一样的还原<br> chown mysql:mysql /var/lib/mysql/ -R 把文件的所有文件属组改成mysql<br> 重启数据库，所有的数据都在，压缩备份实验完成！<em>👌</em></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1c8fa48059850eddc722a8b86363b43c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">STM32 IAP远程程序升级（基于HTTP）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0ccb7d9698b45776566691bc8efedcb6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">安全狗连续3年获得中国网络空间安全协会感谢</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>