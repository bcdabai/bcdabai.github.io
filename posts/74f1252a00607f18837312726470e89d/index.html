<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深度学习：无监督深度测距：《Unsupervised Monocular Depth Estimation With Left-Right Consistency》论文笔记，视频笔记monodepth - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深度学习：无监督深度测距：《Unsupervised Monocular Depth Estimation With Left-Right Consistency》论文笔记，视频笔记monodepth" />
<meta property="og:description" content="总揽：论文干了啥： 备注，这部分参考了： 读论文1 一句话：采用Left-Right Consitency来优化。
也就是以左视图为输入，以右视图为training中的监督真值（gruond truth)，生成右侧对应的视图；然后又以左视图为监督真值，根据右视图生成左视图。最小化这两个过程的联合loss则可以一个很好的左右视图对应关系。
最终网络得到一个四个scale大小的输出(disp1-disp4)
论文的代码 github在线看代码
如何做的，提出了什么新的想法 利用极坐标几何约束，我们可以用图像重建损失训练我们的神经网络，从而生成视差图。
我们还发现, 如果只用图像重建求深度图，会导致其质量较差。（之前的一些 DCNN方式 就是 用了 只用图像 的方式，直接求深度 图的方式，这种方式，在本文看来就是垃圾。）
为了解决这一问题，本文提出了一种新的损失函数，它加强了 左右视差图的一致性，与现有的方法相比，它提高了性能和鲁棒性。
1）你知道视差 和 深度 是有关系的 视差 和 深度 是有关系的；可以互相推算 disparity ~ depth
为什么 他们 可以互相推算： 一个 图解 假设 我们拍摄了两张图片， L, R
也就是 下面 图 里面 的 左右 两个 绿色框
现在 ，在 L 上 有 橙色 的一点，这个点， 可以来自于 其 射线 上 的：
紫色绿色蓝色
三个 可能 的位置； 当然实际上 有 无数可能性，而不仅仅是 这三个点； 我只是 用这三个 进行举例" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/74f1252a00607f18837312726470e89d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-01T17:54:22+08:00" />
<meta property="article:modified_time" content="2021-09-01T17:54:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深度学习：无监督深度测距：《Unsupervised Monocular Depth Estimation With Left-Right Consistency》论文笔记，视频笔记monodepth</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_3"></a>总揽：论文干了啥：</h2> 
<ul><li>备注，这部分参考了： <a href="https://blog.csdn.net/weixin_37598106/article/details/87919984?utm_medium=distribute.pc_relevant.none-task-blog-2~default~OPENSEARCH~default-1.essearch_pc_relevant&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~OPENSEARCH~default-1.essearch_pc_relevant">读论文1</a></li></ul> 
<p>一句话：采用Left-Right Consitency来优化。</p> 
<p>也就是以左视图为输入，以右视图为training中的监督真值（gruond truth)，生成右侧对应的视图；然后又以左视图为监督真值，根据右视图生成左视图。最小化这两个过程的联合loss则可以一个很好的左右视图对应关系。<br> 最终网络得到一个四个scale大小的输出(disp1-disp4)</p> 
<h3><a id="_12"></a>论文的代码</h3> 
<p><a href="https://github1s.com/mrharicot/monodepth" rel="nofollow">github在线看代码</a></p> 
<h2><a id="_16"></a>如何做的，提出了什么新的想法</h2> 
<p>利用<strong>极坐标几何约束</strong>，我们可以用<em>图像重建损失</em>训练我们的神经网络，从而生成视差图。</p> 
<p>我们还发现, <em>如果只用图像重建求深度图，会导致其质量较差</em>。（之前的一些 DCNN方式 就是 用了 只用图像 的方式，直接求深度 图的方式，这种方式，在本文看来就是垃圾。）</p> 
<p>为了解决这一问题，本文提出了一种新的损失函数，它加强了 <em>左右视差图的一致性</em>，与现有的方法相比，它提高了性能和鲁棒性。</p> 
<h3><a id="1____25"></a>1）你知道视差 和 深度 是有关系的</h3> 
<h4><a id="____27"></a>视差 和 深度 是有关系的；可以互相推算</h4> 
<p>disparity ~ depth</p> 
<h5><a id="_____31"></a>为什么 他们 可以互相推算： 一个 图解</h5> 
<p>假设 我们拍摄了两张图片， L, R</p> 
<p>也就是 下面 图 里面 的 左右 两个 绿色框</p> 
<p>现在 ，在 L 上 有 橙色 的一点，这个点， 可以来自于 其 射线 上 的：</p> 
<ul><li>紫色</li><li>绿色</li><li>蓝色<br> 三个 可能 的位置；</li></ul> 
<p>当然实际上 有 无数可能性，而不仅仅是 这三个点； 我只是 用这三个 进行举例</p> 
<p>假定 绿色 是真实 的位置</p> 
<p>而 紫色 是 离镜头近 的一个 可能性 位置<br> 蓝色 是 远一点的 可能性位置。</p> 
<p>我们的模型，应该有能力 从 紫色 ，蓝色， 绿色 的可能性中，准确地知道，真实 的值 应该是 绿色 那个</p> 
<p>如果 我们的模型 能知道 是绿色 那个，也就是说，我们的模型 具有 深度/距离 预测的功能了。</p> 
<p><img src="https://images2.imgbox.com/d9/ce/WVOJUkuK_o.png" alt="在这里插入图片描述"><br> 好的，如何 让模型 知道 是 绿色 呢？</p> 
<p>我们从右图 出发，放大观察 一下 右图 的特点</p> 
<p><img src="https://images2.imgbox.com/6f/c7/siGUx1ud_o.png" alt="在这里插入图片描述"></p> 
<p><em>（备注： 在上述两个图示中，我们有这样一个预设： 就是，左右两个相机是水平的，也就是说，它们拍摄得到的图像，在垂直的上下方向上没有什么错位，而仅仅在水平的， 左右的方向上存在错位，也就是，只在左右的 方向上，存在视差，而垂直的方向上，没有什么 视差）</em></p> 
<p>退一步说，如果我们的模型 能 预测 绿色点 往左 多少 能 生成 一个 「紫色点 在 右图 的位置」， 能 预测 绿色点 能 往右多少，生成 的 是 「蓝色点 在 右图 的位置」。</p> 
<p>这里的往左，往右，就是 一个 标量，用于和 左图 的 绿点 坐标进行 「某种计算」，从而产生位移，让位移的 绿点 变成 紫色点，or 蓝色点。</p> 
<p>对于左图 的每个 像素（每个绿点）<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         G 
        
       
         r 
        
       
         e 
        
       
         e 
        
       
         n 
        
       
         P 
        
       
         o 
        
       
         i 
        
       
         n 
        
        
        
          t 
         
         
         
           I 
          
         
           m 
          
         
           a 
          
         
           g 
          
          
          
            e 
           
          
            L 
           
          
         
        
       
      
        GreenPoint_{Image_L} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">I</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">g</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，都有一个 对应的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d_r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 与之匹配，能够 发生 这么一件事：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          G 
         
        
          r 
         
        
          e 
         
        
          e 
         
        
          n 
         
        
          P 
         
        
          o 
         
        
          i 
         
        
          n 
         
         
         
           t 
          
          
          
            I 
           
          
            m 
           
          
            a 
           
          
            g 
           
           
           
             e 
            
           
             R 
            
           
          
         
        
          = 
         
        
          G 
         
        
          r 
         
        
          e 
         
        
          e 
         
        
          n 
         
        
          P 
         
        
          o 
         
        
          i 
         
        
          n 
         
         
         
           t 
          
          
          
            I 
           
          
            m 
           
          
            a 
           
          
            g 
           
           
           
             e 
            
           
             L 
            
           
          
         
        
          ∗ 
         
         
         
           d 
          
         
           r 
          
         
        
       
         GreenPoint_{Image_R} = GreenPoint_{Image_L} * d_r 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">I</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">g</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord mathdefault">G</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right: 0.13889em;">P</span><span class="mord mathdefault">o</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.07847em;">I</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">g</span><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.35671em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143293em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span> // 这个公式的意思是： 右图上的绿点 来自 左图上的绿点 与 右向视差图 运算所得。</p> 
<p>(<em>想一想，这里真的是简单的乘法运算吗？还是带有加法的复杂矩阵运算呢？</em>）</p> 
<p>那么 这个预测右图每一个绿点的能力，就是完成了这件事： 变向地预测了 绿点 离镜头 的距离</p> 
<p>也就是说， 只要模型能预测 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d_r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ，就能 预测 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         d 
        
       
         e 
        
       
         p 
        
       
         t 
        
       
         h 
        
       
      
        depth 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">p</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span></span></span></span></span></p> 
<p>记住这句话：</p> 
<blockquote> 
 <p>视差是按比例缩小的逆深度，disparity=fb/depth</p> 
</blockquote> 
<p>其中 的 fb 是 <s>我们 规定/从经验 ，或者 计算 中得到的。</s></p> 
<p>fb 分别是：</p> 
<ul><li>f： 相机焦距（我们俩眼睛 的 晶状体 的 厚度导致的光线折射？？）</li><li>b： baseline distance（我们俩眼睛的距离？？）</li></ul> 
<p><img src="https://images2.imgbox.com/3e/53/xTGeegJ0_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_96"></a>2）你知道我们如何用深度网络估计【视差/距离】</h3> 
<p>论文给了三个 架构，用来强调第三个（论文提出的这个）是最牛逼的， 分别是</p> 
<ul><li>naive</li><li>NoLR</li><li>Ours (with LR)</li></ul> 
<p><img src="https://images2.imgbox.com/75/52/x00Vkg8X_o.png" alt="在这里插入图片描述"><br> 从左到右，进行 解释：</p> 
<h5><a id="naive_109"></a>naive的网络：</h5> 
<p>直接从Left image 生成 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d_r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> , 然后 对 Left image 进行 采样 ，与 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d_r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 进行运算，得到 输出 ：</p> 
<p>估计的： <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           I 
          
         
           ~ 
          
         
        
          r 
         
        
       
      
        \widetilde{I}^r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.94333em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span></span></span><span class="svg-align" style="width: calc(100% - 0.22222em); margin-left: 0.22222em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.26em;"> 
            <svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"> 
             <path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z"></path> 
            </svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>然后 跟真实 的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          r 
         
        
       
      
        I^r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span> 进行比对</p> 
<p><em>结果不好</em></p> 
<h5><a id="NoLR__118"></a>NoLR 的网络：</h5> 
<p>应该是没有 加上 left right consistency 的意思</p> 
<p>这里的思路是：</p> 
<p>直接从Left image 生成 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          l 
         
        
       
      
        d_l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> , 然后 对 Right image 进行 采样 ，与 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          l 
         
        
       
      
        d_l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 进行运算， 得到 输出：</p> 
<p>估计的： <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           I 
          
         
           ~ 
          
         
        
          l 
         
        
       
      
        \widetilde{I}^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.94333em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span></span></span><span class="svg-align" style="width: calc(100% - 0.22222em); margin-left: 0.22222em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.26em;"> 
            <svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"> 
             <path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z"></path> 
            </svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>然后 跟真实 的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          l 
         
        
       
      
        I^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span> 进行比对</p> 
<p>结果是： 存在 很多 ‘贴图复制’ 的人工痕迹，并且深度不连续</p> 
<p>见图片：</p> 
<p><img src="https://images2.imgbox.com/4d/f9/xvQqWfU8_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_left_right_consistency_137"></a>我们的方法：带有 left right consistency</h5> 
<p><img src="https://images2.imgbox.com/15/52/rwRh0os3_o.png" alt="在这里插入图片描述"></p> 
<p>仍然是从 图片 生成 disparity map， 但是这次，是从 left image 生成 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d_r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <strong>以及</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          l 
         
        
       
      
        d_l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
<p>然后 用相反 的 图片 进行采样</p> 
<p>说清楚一点，就是， 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d_r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 做运算的 ，其采样来自 left image 也就是 左侧的蓝线（连接了 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          l 
         
        
       
      
        I^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          r 
         
        
       
      
        d^r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span> 后的sampler）<br> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          l 
         
        
       
      
        d_l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 做运算的，其 采样来自 right image 也就是 右侧的蓝线 （连接了 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          r 
         
        
       
      
        I^r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          d 
         
        
          l 
         
        
       
      
        d^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span> 后的 sampler）</p> 
<p>然后生成 对应的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           I 
          
         
           ~ 
          
         
        
          r 
         
        
       
      
        \widetilde{I}^r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.94333em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span></span></span><span class="svg-align" style="width: calc(100% - 0.22222em); margin-left: 0.22222em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.26em;"> 
            <svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"> 
             <path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z"></path> 
            </svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span> ,<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           I 
          
         
           ~ 
          
         
        
          l 
         
        
       
      
        \widetilde{I}^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.94333em; vertical-align: 0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.94333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span></span></span><span class="svg-align" style="width: calc(100% - 0.22222em); margin-left: 0.22222em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.26em;"> 
            <svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"> 
             <path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z"></path> 
            </svg></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span> , 跟真实 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          r 
         
        
       
      
        I^r 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          I 
         
        
          l 
         
        
       
      
        I^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07847em;">I</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span></span></span></span></span></span></span></span> 对比</p> 
<h4><a id="_4__scale__152"></a>作者说的 4 个 scale 到底是什么意思？</h4> 
<p>下面 这个 图 就是在 讲 他们的 模型架构，写了每次层的参数，每一层的输入 是谁，</p> 
<p>也就知道了 网络 的前后关系，各个层组件是什么了；</p> 
<p>只不过，通过表格的方式，没有 通过 一个 流程图的方式 更好，所以希望 后期 我可以 把 一个 流程图 添加在这里（todo 2021-09-08 15:01:27）<br> <img src="https://images2.imgbox.com/55/0a/wk5MVQcT_o.png" alt="在这里插入图片描述"></p> 
<p>注意 图中 的解释：</p> 
<p>k： 就是 kernel size ，一般 就是 设定 为 3</p> 
<p>s： 就是 stride 就是步长，一帮就是 1 或者 2</p> 
<h4><a id="__168"></a>需要进一步 理解的东西：</h4> 
<h5><a id="channels_170"></a>channels</h5> 
<p>本身图片 就只有三个 通道，分别 是 rgb ，我们人类认识物体的颜色，就是这 三个 通道；<br> 但是神经网络 可以 认识一些 更多 通道的信息，通道 的增加来自于 卷积 ，（aka 来自于 filter，来自于 kernel）</p> 
<h5><a id="downscale_factor_175"></a>downscale factor</h5> 
<p>猜一下： 向下缩放的 因数，</p> 
<p>单不知道是在缩放啥 todo 2021-09-08 14:44:50</p> 
<h5><a id="upsampling_181"></a>upsampling</h5> 
<p>上采样，我猜测 就是 卷积 这个动作</p> 
<p>根据维基百科 的解释: <a href="https://en.wikipedia.org/wiki/Upsampling" rel="nofollow">Upsampling</a></p> 
<p>这是从低 波特率 的 序列中，进行 <em>扩张，插值</em>；以至于 最后得到的输出，很像 一个 从更高频率 下 采样得到的序列；</p> 
<h5><a id="downsampling_189"></a>downsampling(就是卷积）</h5> 
<p>根据维基百科 的解释: <a href="https://en.wikipedia.org/wiki/Downsampling_%28signal_processing%29" rel="nofollow">Downsampling(signal_processing)</a></p> 
<p>向下采样，类似于 音频里面 的 降低 波特率，压缩， 得到一个 品质稍微又些次的复制品，近似品。</p> 
<p>它的同义词 叫做 decimation : 大规模歼杀；</p> 
<h4><a id="_loss_function_196"></a>我不是很理解的 loss function</h4> 
<p><img src="https://images2.imgbox.com/d0/b9/3XJnifIf_o.png" alt="在这里插入图片描述"></p> 
<p>我们拆开看：</p> 
<h5><a id="_appearance_matching_loss__C_apl_204"></a>第一个： appearance matching loss: <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          C 
         
         
         
           a 
          
         
           p 
          
         
        
          l 
         
        
       
      
        C_{ap}^l 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.23222em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.453em; margin-left: -0.07153em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">p</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></h5> 
<p><img src="https://images2.imgbox.com/1a/16/ZXk6bRYc_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="___SSIM__L1__208"></a>这里 涉及 到了： SSIM , L1 正则化</h5> 
<h6><a id="L1__210"></a>L1 正则化</h6> 
<p>是为了 避免 模型 过于 复杂，避免 过 拟合</p> 
<h6><a id="SSIM_214"></a>SSIM</h6> 
<p>来自一篇 2004 论文： Image quality assessment: from error visibility to structural similarity.</p> 
<p>看 论文 的名字，大概 可以 知道 SSIM 是一种 评估 图像质量 的 指标，从 error 的可见性，到 结构 上 的相似度。</p> 
<h5><a id="_disparity_smoothness_loss_220"></a>第二个： disparity smoothness loss</h5> 
<p><img src="https://images2.imgbox.com/f8/4a/WLVym00p_o.png" alt="在这里插入图片描述"></p> 
<p>留待之后解释 todo</p> 
<h5><a id="_left_right_consistency_loss_227"></a>第三个： left right consistency loss</h5> 
<p><img src="https://images2.imgbox.com/bf/f9/Hosa1B6s_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_231"></a>这篇论文的代码：</h4> 
<p>模型的代码：<a href="https://github1s.com/mrharicot/monodepth/blob/HEAD/monodepth_model.py" rel="nofollow">链接</a></p> 
<p><img src="https://images2.imgbox.com/53/7c/UuxuLUzc_o.png" alt="在这里插入图片描述"></p> 
<p>有关 <a href="https://github1s.com/mrharicot/monodepth/blob/HEAD/monodepth_model.py#L334" rel="nofollow">loss 的代码</a></p> 
<p><img src="https://images2.imgbox.com/35/11/1T8x7K6Q_o.png" alt="在这里插入图片描述"><br> 这里参考了 <a href="https://blog.csdn.net/lvhao92/article/details/76586101">这个博客</a></p> 
<pre><code class="prism language-xml">Training Loss
成本有如下三个部分ap，ds，lr，Cap是根据训练输入与它的重建图像相近的程度，
Cds限制了视差预测的平滑性，
Clr倾向于左右视差一致性。
只有左图经过卷积神经网络的洗礼
虽然每个主要的步骤当中都包含着左右两图。

1. Appearance Matching Loss

图像是通过空间转化网络（STN）与视差图从对应的立体匹配图片中
获取相应的像素值。
STN利用双线性采样，
这样输出像素是四个输入像素的加权之和。

2. Disparity Smooth Loss
这个项就是使得预测出来的视差变得非常的平滑，
所以就在视差梯度上面加了一个惩罚，
这个成本的权重是与图像梯度有关，就是边缘项

3. Left-right disparity consistency loss
没什么好讲的，直接上代码

</code></pre> 
<p>至此，写完了 loss ，论文 就开始 实验，这个 上述 博客 也 结尾了。</p> 
<p>所以，对 loss 的理解 还是 非常重要的。</p> 
<p>你要理解下面 这几个 名词： todo： 2021-09-08 15:25:54</p> 
<ul><li>空间转化网络（STN）</li><li>双线性采样</li><li>四个输入像素的加权之和</li><li>视差梯度上面加了一个惩罚</li><li>成本的权重是与图像梯度有关</li></ul> 
<h3><a id="______281"></a>一些 可以 继续探索 的文章 和 博客：</h3> 
<ul><li>被本文 参考 的： mayer: DispNet： 很像之前的： end-to-end deep optical flow network</li></ul> 
<p><a href="https://blog.csdn.net/weixin_40224537/article/details/103405391?utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-4.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-4.no_search_link">研读3</a></p> 
<p><a href="https://blog.csdn.net/weixin_37598106/article/details/87919984?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.no_search_link">研读4</a></p> 
<p><a href="https://blog.csdn.net/qq_26129959/article/details/90050047?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-7.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-7.no_search_link">研读5；推荐</a></p> 
<h2><a id="2017___CVPR___296"></a>2017 年的 CVPR 视频 观看笔记；趣味向</h2> 
<p>2017 年的 CVPR</p> 
<p>from <a href="https://www.youtube.com/watch?v=go3H2gU-Zck" rel="nofollow">youtubeLink</a><br> <img src="https://images2.imgbox.com/89/9d/9yAFo2k4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_303"></a>是啥东西</h3> 
<p><img src="https://images2.imgbox.com/17/09/625sd4uK_o.png" alt="这是个 输入 图像"><br> 然后</p> 
<p>我们的工作能： 给出 一个 深度 图</p> 
<p>like this：</p> 
<p><img src="https://images2.imgbox.com/4f/40/kmtUQSDc_o.png" alt=""></p> 
<h3><a id="_depth__314"></a>为啥 depth 有用</h3> 
<p>导航，机器人拿东西，虚拟现实，桌子有多远，多大</p> 
<h3><a id="_monocular_318"></a>为啥用 monocular：单目相机？</h3> 
<p>贫穷和普适</p> 
<h3><a id="monocular__322"></a>monocular 能行吗？</h3> 
<p><img src="https://images2.imgbox.com/e7/b6/0WlYxj4W_o.png" alt="在这里插入图片描述"></p> 
<p>既然 探测器 和 海盗头子 都能 ，我们也能</p> 
<hr> 
<h3><a id="_331"></a>以前的方法</h3> 
<p><img src="https://images2.imgbox.com/4f/9e/CviUez7B_o.png" alt="在这里插入图片描述"></p> 
<ul><li>ground truth 值很难获得</li></ul> 
<p><img src="https://images2.imgbox.com/ef/58/OTHFsqjH_o.png" alt="数据集很难搞"></p> 
<h5><a id="kitti____338"></a>kitti 数据集 本身 也有误差</h5> 
<p>或者说 遗漏： 见图片：</p> 
<p><img src="https://images2.imgbox.com/ee/1c/iszkJciV_o.png" alt="img"></p> 
<h4><a id="______347"></a>那咱么 可以用 双目 立体 几何 的手段</h4> 
<p>去训练</p> 
<p>数学原理是：</p> 
<p><img src="https://images2.imgbox.com/91/72/DYRFfM3O_o.png" alt="在这里插入图片描述"></p> 
<p>原理就是上面这个原理，意思就是： L 和 R 之间的 差异 就是 跟 depth / 距离有关</p> 
<hr> 
<p>现在 有很多 双目 设备：</p> 
<p><img src="https://images2.imgbox.com/b4/db/lB2rfQBR_o.png" alt="在这里插入图片描述"></p> 
<p>我们不是第一个 用 双目 去做测距的：</p> 
<p><img src="https://images2.imgbox.com/de/7c/vG7sqQcS_o.png" alt="在这里插入图片描述"></p> 
<p>多说一句：</p> 
<p><img src="https://images2.imgbox.com/ef/a6/F4aEPFKj_o.png" alt="在这里插入图片描述"></p> 
<p>这个文章 可能 就是 比较 早期 的 使用 双目 的 无监督 的 方法；</p> 
<p>再补充一下：</p> 
<p><img src="https://images2.imgbox.com/9f/d5/56PnEfpk_o.png" alt="在这里插入图片描述"><br> 这个文章 则是 使用 了 监督 的；</p> 
<h3><a id="__383"></a>后记；视频里面的一些 细节</h3> 
<p><img src="https://images2.imgbox.com/a8/1a/i06zd57k_o.png" alt="在这里插入图片描述"></p> 
<p>似乎上面 是在 讲 一个 baseline 的 模型，</p> 
<p>下面 才是 我们的 的模型</p> 
<p><img src="https://images2.imgbox.com/92/30/X8nIATzY_o.png" alt="在这里插入图片描述"><br> 我们 的 模型，似乎 是 可以 通过 生成 左右 两个 图片 进行 balalba。。。</p> 
<hr> 
<h5><a id="____396"></a>一个 重要 组件</h5> 
<p>differentiable image smapler</p> 
<p>他可以 把 left input image 转成 targe 的 input right image</p> 
<p>看看这个图：</p> 
<p><img src="https://images2.imgbox.com/c8/62/E1MormME_o.png" alt="在这里插入图片描述"></p> 
<p>注意 线 1 和 线 2 ，这些 线 把 原始i 的 input 数据 ，打入 内部 走线 的输出</p> 
<p>内部 走线 的输出 ，就是 一个 disparity 图片？？</p> 
<p>我的 理解 是 ：</p> 
<ul><li>上面 的 R disparity 图像 ，是 left image 通过 线 1 ， 进行 变化，从而 达到 逼近 right image 的 一个 转换器/convert</li><li>下面 的 L disparity 图像，虽然 也是 left image 输入 而 产生的，但是 是 用做 给 right image 用的，right iamge 通过 线 2 经历 了 L disparity 所代表的 convert 过程，就能 把 right image 自己 给 convert 成 一个 逼近 的 left image</li></ul> 
<hr> 
<h5><a id="___419"></a>有关于 架构</h5> 
<p>你可以 使用 任何 的 encoder： VGG ，ResNet</p> 
<p><img src="https://images2.imgbox.com/2a/cf/3iXSQiDU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="__424"></a>有关 结果</h3> 
<p><img src="https://images2.imgbox.com/a8/15/ACL9KmG5_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="RTFSC_Read_the_fcking_source_code__427"></a>RTFSC (Read the f*cking source code )</h2> 
<p>读论文是RTM，Read the manual；接下来就是 RTFSC</p> 
<p>但是 RTFSC 的过程中 也离不开 「STFW （Search The F*cking Web）」</p> 
<p>所以，这一部分 记录 一下 这两个 步骤的 内容；</p> 
<h3><a id="tf_434"></a>为了看懂代码：在网络上搜索到的tf相关知识</h3> 
<h4><a id="monodepth_modelpy__436"></a>在monodepth_model.py 这个文件里</h4> 
<p>有这么一个类<br> <img src="https://images2.imgbox.com/28/77/31RFT6AX_o.png" alt="在这里插入图片描述"></p> 
<p>有个 build_model() 函数：</p> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">build_model</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token comment"># 使用 arg_scope 函数 （见 tt3 ） 为 conv2d, conv2d_transpose 都设定 同一个 elu 激励函数 </span>
    <span class="token keyword">with</span> slim<span class="token punctuation">.</span>arg_scope<span class="token punctuation">(</span><span class="token punctuation">[</span>slim<span class="token punctuation">.</span>conv2d<span class="token punctuation">,</span> slim<span class="token punctuation">.</span>conv2d_transpose<span class="token punctuation">]</span><span class="token punctuation">,</span> activation_fn<span class="token operator">=</span>tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>elu<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'model'</span><span class="token punctuation">,</span> reuse<span class="token operator">=</span>self<span class="token punctuation">.</span>reuse_variables<span class="token punctuation">)</span><span class="token punctuation">:</span>

            self<span class="token punctuation">.</span>left_pyramid  <span class="token operator">=</span> self<span class="token punctuation">.</span>scale_pyramid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>left<span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">)</span>
            <span class="token comment"># 如果 是训练  阶段，那么 就 需要 右边的 缩放图 来帮忙</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'train'</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>right_pyramid <span class="token operator">=</span> self<span class="token punctuation">.</span>scale_pyramid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>right<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
            <span class="token comment"># 如果 开启了 立体的选项，那么 就把模型的input 制作为 左右图的 一起连接</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>params<span class="token punctuation">.</span>do_stereo<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>model_input <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>left<span class="token punctuation">,</span> self<span class="token punctuation">.</span>right<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果没有开启 立体 选项，那么 就是  仅仅 用 左图；</span>
                self<span class="token punctuation">.</span>model_input <span class="token operator">=</span> self<span class="token punctuation">.</span>left

            <span class="token comment">#build model</span>
            <span class="token comment"># 如果 使用 vgg 的编码器</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>params<span class="token punctuation">.</span>encoder <span class="token operator">==</span> <span class="token string">'vgg'</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>build_vgg<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 如果使用 resnet 的编码器</span>
            <span class="token keyword">elif</span> self<span class="token punctuation">.</span>params<span class="token punctuation">.</span>encoder <span class="token operator">==</span> <span class="token string">'resnet50'</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>build_resnet50<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">None</span>

</code></pre> 
<p>里面用到的 scale_pyramid 函数 ，是如下定义：</p> 
<p><img src="https://images2.imgbox.com/c9/61/M0eGOuPo_o.png" alt="在这里插入图片描述"><br> 这个函数 整体 的流程 ，就是 确定输入；不过是加上了 scale_pyramid 这种方式 来重制了 输入；</p> 
<p>好了，如果我们有了输入，剩下的，就是把输入打到模型里，</p> 
<p>它给了两种 model 的可选</p> 
<ul><li>一个是 vgg</li><li>一个是 resnet50</li></ul> 
<p>我们看一看 vgg 这种模型；</p> 
<h4><a id="build_vgg_486"></a>build_vgg()</h4> 
<p>todo 2021-09-09 12:03:06 variable_scope https://blog.csdn.net/UESTC_C2_403/article/details/72328815</p> 
<p>函数如下，有点长，但是有重复部分，不虚；</p> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">build_vgg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#set convenience functions</span>
    <span class="token comment"># 这里 使用 了 卷积；见 tt1</span>
    conv <span class="token operator">=</span> self<span class="token punctuation">.</span>conv
    <span class="token comment"># 这里 分为 deconv 和 upconv ;见 tt2 </span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>params<span class="token punctuation">.</span>use_deconv<span class="token punctuation">:</span>
        upconv <span class="token operator">=</span> self<span class="token punctuation">.</span>deconv
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        upconv <span class="token operator">=</span> self<span class="token punctuation">.</span>upconv

    <span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'encoder'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        conv1 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>self<span class="token punctuation">.</span>model_input<span class="token punctuation">,</span>  <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment"># H/2</span>
        conv2 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>conv1<span class="token punctuation">,</span>             <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># H/4</span>
        conv3 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>conv2<span class="token punctuation">,</span>            <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># H/8</span>
        conv4 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>conv3<span class="token punctuation">,</span>            <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># H/16</span>
        conv5 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>conv4<span class="token punctuation">,</span>            <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># H/32</span>
        conv6 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>conv5<span class="token punctuation">,</span>            <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># H/64</span>
        conv7 <span class="token operator">=</span> self<span class="token punctuation">.</span>conv_block<span class="token punctuation">(</span>conv6<span class="token punctuation">,</span>            <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment"># H/128</span>

    <span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'skips'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        skip1 <span class="token operator">=</span> conv1
        skip2 <span class="token operator">=</span> conv2
        skip3 <span class="token operator">=</span> conv3
        skip4 <span class="token operator">=</span> conv4
        skip5 <span class="token operator">=</span> conv5
        skip6 <span class="token operator">=</span> conv6
    
    <span class="token keyword">with</span> tf<span class="token punctuation">.</span>variable_scope<span class="token punctuation">(</span><span class="token string">'decoder'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        upconv7 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>conv7<span class="token punctuation">,</span>  <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H/64</span>
        concat7 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv7<span class="token punctuation">,</span> skip6<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv7  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat7<span class="token punctuation">,</span>  <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

        upconv6 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>iconv7<span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H/32</span>
        concat6 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv6<span class="token punctuation">,</span> skip5<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv6  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat6<span class="token punctuation">,</span>  <span class="token number">512</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

        upconv5 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>iconv6<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H/16</span>
        concat5 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv5<span class="token punctuation">,</span> skip4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv5  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat5<span class="token punctuation">,</span>  <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

        upconv4 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>iconv5<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H/8</span>
        concat4 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv4<span class="token punctuation">,</span> skip3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv4  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat4<span class="token punctuation">,</span>  <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>disp4 <span class="token operator">=</span> self<span class="token punctuation">.</span>get_disp<span class="token punctuation">(</span>iconv4<span class="token punctuation">)</span>
        udisp4  <span class="token operator">=</span> self<span class="token punctuation">.</span>upsample_nn<span class="token punctuation">(</span>self<span class="token punctuation">.</span>disp4<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

        upconv3 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>iconv4<span class="token punctuation">,</span>  <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H/4</span>
        concat3 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv3<span class="token punctuation">,</span> skip2<span class="token punctuation">,</span> udisp4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv3  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat3<span class="token punctuation">,</span>   <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>disp3 <span class="token operator">=</span> self<span class="token punctuation">.</span>get_disp<span class="token punctuation">(</span>iconv3<span class="token punctuation">)</span>
        udisp3  <span class="token operator">=</span> self<span class="token punctuation">.</span>upsample_nn<span class="token punctuation">(</span>self<span class="token punctuation">.</span>disp3<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

        upconv2 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>iconv3<span class="token punctuation">,</span>  <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H/2</span>
        concat2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv2<span class="token punctuation">,</span> skip1<span class="token punctuation">,</span> udisp3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv2  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat2<span class="token punctuation">,</span>   <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>disp2 <span class="token operator">=</span> self<span class="token punctuation">.</span>get_disp<span class="token punctuation">(</span>iconv2<span class="token punctuation">)</span>
        udisp2  <span class="token operator">=</span> self<span class="token punctuation">.</span>upsample_nn<span class="token punctuation">(</span>self<span class="token punctuation">.</span>disp2<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

        upconv1 <span class="token operator">=</span> upconv<span class="token punctuation">(</span>iconv2<span class="token punctuation">,</span>  <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#H</span>
        concat1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>upconv1<span class="token punctuation">,</span> udisp2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        iconv1  <span class="token operator">=</span> conv<span class="token punctuation">(</span>concat1<span class="token punctuation">,</span>   <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>disp1 <span class="token operator">=</span> self<span class="token punctuation">.</span>get_disp<span class="token punctuation">(</span>iconv1<span class="token punctuation">)</span>
</code></pre> 
<p>tt1:<br> <img src="https://images2.imgbox.com/27/ec/fzRCVZxO_o.png" alt="在这里插入图片描述"></p> 
<p>tt2: 参考 ： <a href="https://blog.csdn.net/jsk_learner/article/details/102630078">理解deconvolution（反卷积、转置卷积）概念原理和计算公式、up-sampling（上采样）的几种方式、dilated convolution（空洞卷积）的原理理解和公式计算</a></p> 
<p>deconv和up-sampling是FCN图像分割网络中用到的，两个扩大feature map尺寸的重要操作。</p> 
<p>这里的扩大，就是我们通信工程里面的，上采样，把原来低频的信号，插值了， 变成更加高频的信号。</p> 
<p>有的人 将deconv反卷积称作转置卷积，我们暂且先认为它俩的概念一致</p> 
<p>deconv 的动画解释：</p> 
<p><img src="https://images2.imgbox.com/bd/ca/YORa7TeA_o.gif" alt="请添加图片描述"></p> 
<p><em>（deconv: 把不丰富的图像，变得丰富，把小尺寸的 图片，变为 大尺寸的）</em></p> 
<p>conv 就是 deconv 的反向：是把大尺寸的 图片，变为 小尺寸的； 是在做特征提取；</p> 
<p>tt3:</p> 
<p><a href="https://blog.csdn.net/u013921430/article/details/80915696">arg_scope 函数的使用</a></p> 
<h4><a id="tensorflowcontribslim_582"></a>tensorflow.contrib.slim</h4> 
<p>其主要目的是来做所谓的“代码瘦身”。</p> 
<p><img src="https://images2.imgbox.com/a7/ee/aBacWx1A_o.png" alt="在这里插入图片描述"></p> 
<ul><li>消除原生tensorflow里面很多重复的模板性的代码，</li><li>让代码更紧凑，更具备可读性。</li><li>提供了很多计算机视觉方面的著名模型（VGG, AlexNet等）</li><li>我们不仅可以直接使用，甚至能以各种方式进行扩展</li></ul> 
<p><a href="https://blog.csdn.net/mao_xiao_feng/article/details/73409975">参考这里</a></p> 
<p>tensorflow.contrib这个库：此目录中的任何代码未经官方支持，可能会随时更改或删除。每个目录下都有指定的所有者。它旨在包含额外功能和贡献，最终会合并到核心TensorFlow中，但其接口可能仍然会发生变化，或者需要进行一些测试，看是否可以获得更广泛的接受。所以slim依然不属于原生tensorflow。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1101e928ab94a4395d1bb4ab82600cd5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">将手机号码的中间四位数替换为*</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a37def4ac16d8ebd57428a4cb7cc1378/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VScode插件PlatformIO中添加修改ESP32的分区表解决编译内存问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>