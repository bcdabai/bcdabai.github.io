<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sharedPreferences的使用之按钮状态切换的保存 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sharedPreferences的使用之按钮状态切换的保存" />
<meta property="og:description" content="什么是sharedPreferences？有什么用
SharedPreference是Android开发中一个轻量级的数据存储的方式，除了它还有SQLite数据库。它可以将数据以键值对的形式存放到文件中，在需要的时候再取出来使用。相比于去操作数据库，对于一些简单的数据使用SharedPreference更加方便，高效。
项目中使用：
（1）编写工具类
import android.content.Context; import android.content.SharedPreferences; import androidx.annotation.Nullable; /** * @function sharedPreference 工具类 */ public final class SharedPreferenceUtil { private static final String FILE_NAME = &#34;config&#34;; //文件名 private static SharedPreferenceUtil mInstance; private SharedPreferenceUtil() { } public static SharedPreferenceUtil getInstance() { if (mInstance == null) { synchronized (SharedPreferenceUtil.class) { if (mInstance == null) { mInstance = new SharedPreferenceUtil(); } } } return mInstance; } /** * 存入键值对 * * @param context * @param key * @param value */ public void put(Context context, String key, Object value) { //判断类型 String type = value." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/49ab0ec44cb45173068458b4a201aa7b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-12T10:59:09+08:00" />
<meta property="article:modified_time" content="2023-08-12T10:59:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sharedPreferences的使用之按钮状态切换的保存</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>什么是sharedPreferences？有什么用</strong></p> 
<p><span style="background-color:#ffd900;">SharedPreference是Android开发中一个轻量级的数据存储的方式，除了它还有SQLite数据库。它可以将数据以键值对的形式存放到文件中，在需要的时候再取出来使用。相比于去操作数据库，对于一些简单的数据使用SharedPreference更加方便，高效。</span></p> 
<p>项目中使用：</p> 
<p>（1）编写工具类</p> 
<pre><code class="language-java">
import android.content.Context;
import android.content.SharedPreferences;

import androidx.annotation.Nullable;

/**
 * @function sharedPreference 工具类
 */
public final class SharedPreferenceUtil {

    private static final String FILE_NAME = "config"; //文件名
    private static SharedPreferenceUtil mInstance;

    private SharedPreferenceUtil() {
    }

    public static SharedPreferenceUtil getInstance() {
        if (mInstance == null) {
            synchronized (SharedPreferenceUtil.class) {
                if (mInstance == null) {
                    mInstance = new SharedPreferenceUtil();
                }
            }
        }
        return mInstance;
    }

    /**
     * 存入键值对
     *
     * @param context
     * @param key
     * @param value
     */

    public void put(Context context, String key, Object value) {
        //判断类型
        String type = value.getClass().getSimpleName();
        SharedPreferences sharedPreferences = context.getSharedPreferences(FILE_NAME, Context.MODE_PRIVATE);
        SharedPreferences.Editor editor = sharedPreferences.edit();
        if ("Integer".equals(type)) {
            editor.putInt(key, (Integer) value);
        } else if ("Boolean".equals(type)) {
            editor.putBoolean(key, (Boolean) value);
        } else if ("Float".equals(type)) {
            editor.putFloat(key, (Float) value);
        } else if ("Long".equals(type)) {
            editor.putLong(key, (Long) value);
        } else if ("String".equals(type)) {
            editor.putString(key, (String) value);
        }
        editor.apply();
    }

    /**
     * 读取键的值，若无则返回默认值
     *
     * @param context
     * @param key
     * @param defValue 默认值
     * @return
     */
    @Nullable
    public Object get(Context context, String key, Object defValue) {
        SharedPreferences sharedPreferences = context.getSharedPreferences(FILE_NAME, Context.MODE_PRIVATE);
        String type = defValue.getClass().getSimpleName();
        if ("Integer".equals(type)) {
            return sharedPreferences.getInt(key, (Integer) defValue);
        } else if ("Boolean".equals(type)) {
            return sharedPreferences.getBoolean(key, (Boolean) defValue);
        } else if ("Float".equals(type)) {
            return sharedPreferences.getFloat(key, (Float) defValue);
        } else if ("Long".equals(type)) {
            return sharedPreferences.getLong(key, (Long) defValue);
        } else if ("String".equals(type)) {
            return sharedPreferences.getString(key, (String) defValue);
        }
        return null;
    }

    /**
     * 检查key对应的数据是否存在
     */
    public boolean contains(Context context, String key) {
        SharedPreferences sp = context.getSharedPreferences(FILE_NAME, Context.MODE_PRIVATE);
        return sp.contains(key);
    }
}

</code></pre> 
<pre>（2）xml中按钮
</pre> 
<p><img alt="" height="232" src="https://images2.imgbox.com/27/33/r7MvTKWm_o.png" width="678"></p> 
<p> </p> 
<p> （3）Activity中使用</p> 
<p>首先我们定义一个方法来设置按钮的状态。我的方法实现大体思路是：先去查询有没有创建这个键值，如果返回的是true则没有，那我们先去创建这个键值，以及设置它的一个默认状态为开启。如果是false，说明有值，那我们不必创建了，直接判断true还是false，设置状态。这个方法是一个初始化方法，在应用刚下载时调用。当然对于这个方法的调用应该放在<strong>onCreate</strong>中</p> 
<p><img alt="" height="369" src="https://images2.imgbox.com/1c/a4/aZ4lxTtz_o.png" width="1078"></p> 
<p> 除了初始化的判断，我们应该还要对按钮后续的点击操作进行保存和切换状态。</p> 
<p><img alt="" height="308" src="https://images2.imgbox.com/09/78/ISvaeq4y_o.png" width="1082"></p> 
<p> 主要是对这个按钮的点击事件的监听，具体的思路参考上个方法。</p> 
<p>效果：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/52/da/TGLRUFzc_o.gif"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5c4bc288c79a7dd9e96c7af1a3eafa59/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JVM完整笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c701db37f132267c84129704c57a1fbf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序实现图片多点裁剪</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>