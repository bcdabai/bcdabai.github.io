<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Labview操作串口-----------通过VISA驱动 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Labview操作串口-----------通过VISA驱动" />
<meta property="og:description" content="本篇文章将会详细介绍如何通过labview的VISA驱动模块来操作PC的串口。（基于LABVIEW2012、VISA530full.exe）
1、首先需要安装LABVIEW，接下里安装VISA530驱动模块（否则编译本代码时会出现缺少VISA驱动模块的提示）。
2、新建一个VI项目，保存为mycomm.vi
3、在VI前面板内添加如下图所示的控件：
【接收区域】为【系统】控件内的“系统字符串”，右键属性内修改为自动换行、显示垂直滚动条；然后右键将其修改为“转换为显示控件”。这个控件用户可以自行修改为其它设置的控件。
【发送区域】为【系统】控件内的“系统字符串”，同理右键修改为自动换行、显示垂直滚动条；然后切记要右键属性内勾选“键入时刷新”，否则发送是会出现重复发送上次内容的情况，如下图：
【端口号】控件为【系统】空间内的“系统下拉列表”，右键增加属性值（添加COM1、COM2、COM3等等）。
【串口状态指示灯】为布尔控件内的圆形指示灯，用户自行修改其开关颜色。
【退出程序】、【发送】按钮为系统布尔按钮，修改机械操作位“保持转换直到释放”，如下图：
【打开】按钮修改为多字符串显示“打开”和“关闭”字符，机械操作修改为“释放时转换”
4、编写“程序框图”
创建两个while循环，一个循环处理用户事件（比如：按钮事件、程序运行初始化、退出等），一个循环用来处理接收数据的任务。
首先第一个循环：初始化
其中的带小房间的局部变量可以在前面板的控件上右击“创建局部变量”来放置；while循环创建移位寄存器，用来处理不同状态的任务（Init，Event，Exit三种）；下面看Event任务，如下图：
打开串口按钮事件，使用端口号控件的值配合VISA资源名称控件（在前面板----&gt;新式----&gt;IO----&gt;VISA资源名称，右键选择VISA类----&gt;IO session----&gt;Serial Instr，然后在程序框图内右键选择”转换为常量“，则VISA资源名称控件变为如下图）
然后在空间内添加资源名称如上上图。
后面几个事件就不介绍了，包含了发送，关闭等操作稍后送上源码。
第二个循环，接收：
当串口打开标识为真时才执行读取的操作，使用VISA属性节点（在仪器IO----&gt;VISA----&gt;高级VISA----&gt;VISA属性节点），右键选择类----&gt;VISA----&gt;IO session----&gt;Serial Instr，然后单击属性，选择如下图蓝色部分所示：Number of Bytes at Serial Port
到此即可进行串口通信了，将PC的2、3两线相连测试测试代码。
源码下载地址CSDN：
http://download.csdn.net/detail/cumtwys/7592575 0分资源。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0ffce9c14d263f7eac4013e780b6b63b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-07-04T15:13:18+08:00" />
<meta property="article:modified_time" content="2014-07-04T15:13:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Labview操作串口-----------通过VISA驱动</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="white-space:pre"></span>本篇文章将会详细介绍如何通过labview的VISA驱动模块来操作PC的串口。（基于LABVIEW2012、VISA530full.exe）</p> 
<p><span style="white-space:pre"></span>1、首先需要安装LABVIEW，接下里安装VISA530驱动模块（否则编译本代码时会出现缺少VISA驱动模块的提示）。</p> 
<p><span style="white-space:pre"></span>2、新建一个VI项目，保存为mycomm.vi</p> 
<p><span style="white-space:pre"></span>3、在VI前面板内添加如下图所示的控件：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/da/52/qwFaCBWO_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>【</span>接收区域】为【系统】控件内的“系统字符串”，右键属性内修改为自动换行、显示垂直滚动条；然后右键将其修改为“转换为显示控件”。这个控件用户可以自行修改为其它设置的控件。</p> 
<p><span style="white-space:pre"></span>【发送区域】为【系统】控件内的“系统字符串”，同理右键修改为自动换行、显示垂直滚动条；然后切记要右键属性内勾选“键入时刷新”，否则发送是会出现重复发送上次内容的情况，如下图：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/11/c9/juDDw0cV_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>【</span>端口号】控件为【系统】空间内的“系统下拉列表”，右键增加属性值（添加COM1、COM2、COM3等等）。</p> 
<p><span style="white-space:pre"></span>【串口状态指示灯】为布尔控件内的圆形指示灯，用户自行修改其开关颜色。</p> 
<p><span style="white-space:pre"></span>【退出程序】、【发送】按钮为系统布尔按钮，修改机械操作位“保持转换直到释放”，如下图：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/11/3a/TjCbK6mH_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>【</span>打开】按钮修改为多字符串显示“打开”和“关闭”字符，机械操作修改为“释放时转换”</p> 
<p><span style="white-space:pre"></span>4、编写“程序框图”</p> 
<p><span style="white-space:pre"></span>创建两个while循环，一个循环处理用户事件（比如：按钮事件、程序运行初始化、退出等），一个循环用来处理接收数据的任务。</p> 
<p><span style="white-space:pre"></span>首先第一个循环：初始化</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/7f/33/Mtqbrp3l_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>其中</span>的带小房间的局部变量可以在前面板的控件上右击“创建局部变量”来放置；while循环创建移位寄存器，用来处理不同状态的任务（Init，Event，Exit三种）；下面看Event任务，如下图：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/cc/50/gfNmbShO_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>打开</span>串口按钮事件，使用端口号控件的值配合VISA资源名称控件（在前面板----&gt;新式----&gt;IO----&gt;VISA资源名称，右键选择VISA类----&gt;IO session----&gt;Serial Instr，然后在程序框图内右键选择”转换为常量“，则VISA资源名称控件变为如下图）</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/61/b0/eM103yIY_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>然后</span>在空间内添加资源名称如上上图。</p> 
<p><span style="white-space:pre"></span>后面几个事件就不介绍了，包含了发送，关闭等操作稍后送上源码。</p> 
<p><span style="white-space:pre"></span>第二个循环，接收：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/99/cd/4a82t6Wm_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"><span style="white-space:pre">当</span>串口打开标识为真时才执行读取的操作，使用VISA属性节点（在仪器IO</span>-</span>---&gt;VISA<span style="white-space:pre">-</span>---&gt;高级VISA<span style="white-space:pre">-</span>---&gt;VISA属性节点），右键选择类----&gt;VISA----&gt;IO session----&gt;Serial Instr，然后单击属性，选择如下图蓝色部分所示：Number of Bytes at Serial Port</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/5c/0c/SbfaieRa_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>到此</span>即可进行串口通信了，将PC的2、3两线相连测试测试代码。</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/5b/31/DQbu4nUQ_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>源码</span>下载地址CSDN：</p> 
<p><a target="_blank" href="http://download.csdn.net/detail/cumtwys/7592575" rel="noopener noreferrer">http://download.csdn.net/detail/cumtwys/7592575</a>  0分资源。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7870cc8be02e2b46f1a97a780032b440/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android 项目开发建议标准规范</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c24cfcef2faa0130af8ba445f2c98255/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">unity3d中获得物体的size</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>