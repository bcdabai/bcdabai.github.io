<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Costmap_2d里面插入Prohibition_layer(禁止区域层) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在Costmap_2d里面插入Prohibition_layer(禁止区域层)" />
<meta property="og:description" content="在Costmap_2d里面插入Prohibition_layer(禁止区域层)
简介
costmap_2d在navigaition里面是一个很重要的板块，通常默认的是三层地图（静态/障碍/膨胀层）叠加在一起，构成整个完整的代价地图，但是我们也可以插入一些自定义的图层，然后实现自己定制化的功能，基础的教程大家可以参考costmap_2d中插入自定义层。本文的主要目的是来告诉大家如何在代价地图中插入Prohibition_layer（禁止层），然后在已经建好的地图中设立禁止通行区域，关于prohibition_layer具体的作用大家可以参照roswiki上的解释。
具体实现步骤
1　代码下载与编译
之前我们学习插入simple_layer的时候是在自己的工作空间（catkin_ws）中建立一个pakage，然后再去自己创建.cpp文件和.h头文件，再去改cmakelist，添加.xml文件，在这个教程中我们不需要这么麻烦，我们可以直接在github上把prohibition_layer的包下载下来(源码下载地址戳这里).，解压后放在自己的工作空间中的　src　文件夹里面，然后在终端输入：
$ cd catkin_ws(&#34;catkin_ws&#34;替换成你的工作空间名称)
$ catkin_make
编译完成以后在终端中输入：
rospack plugins --attrib=plugin costmap_2d
当你发现终端中输出：
这就表明prohibition_layer已经是一个可供使用的地图插件了． ２　在代价地图中插入prohibition_layer
完成步骤１后说明prohibition_layer已经可以供costmap使用了，现在我们要做的就是把prohibition_layer插入到costmap中去．
我们在自己的代价地图参数配置文件夹中找到　global_costmap_params.yaml　和　local_costmap_params.yaml　，打开这两个文档，分别在两个文档的末尾做修改，修改后应该是下面的内容：
plugins:
- {name: static_map, type: &#34;costmap_2d::StaticLayer&#34;}
- {name: obstacles, type: &#34;costmap_2d::VoxelLayer&#34;}
- {name: costmap_prohibition_layer, type: &#34;costmap_prohibition_layer_namespace::CostmapProhibitionLayer&#34;} - {name: inflation_layer, type: &#34;costmap_2d::InflationLayer&#34;}
３　修改launch文件
完成插入地图后我们还需要修改自己的launch文件，我是在自己的move_base.launch 中插入的，这个大家根据自己的需求，你用的carlike就修改carlike的launch文件．打开自己的launch文件中插入如下内容:
&lt;rosparam file=&#34;$(find turtlebot3_navigation)/param/prohibition_areas.yaml&#34; command=&#34;load&#34; ns=&#34;global_costmap/costmap_prohibition_layer&#34; /&gt;
&lt;rosparam file=&#34;$(find turtlebot3_navigation)/param/prohibition_areas.yaml&#34; command=&#34;load&#34; ns=&#34;local_costmap/costmap_prohibition_layer&#34; /&gt;
1
2
其中的＂turtlebot3_navigation＂需要根据自己的情况修改，你打开自己的launch文件对照上下文就知道怎么更改了．" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4a8a88d1d9eadd1f9233e6aa20c83f97/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-20T14:58:27+08:00" />
<meta property="article:modified_time" content="2021-07-20T14:58:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Costmap_2d里面插入Prohibition_layer(禁止区域层)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在Costmap_2d里面插入Prohibition_layer(禁止区域层)<br> 简介<br> costmap_2d在navigaition里面是一个很重要的板块，通常默认的是三层地图（静态/障碍/膨胀层）叠加在一起，构成整个完整的代价地图，但是我们也可以插入一些自定义的图层，然后实现自己定制化的功能，基础的教程大家可以参考costmap_2d中插入自定义层。本文的主要目的是来告诉大家如何在代价地图中插入Prohibition_layer（禁止层），然后在已经建好的地图中设立禁止通行区域，关于prohibition_layer具体的作用大家可以参照roswiki上的解释。</p> 
<p>具体实现步骤<br> 1　代码下载与编译<br> 　　之前我们学习插入simple_layer的时候是在自己的工作空间（catkin_ws）中建立一个pakage，然后再去自己创建.cpp文件和.h头文件，再去改cmakelist，添加.xml文件，在这个教程中我们不需要这么麻烦，我们可以直接在github上把prohibition_layer的包下载下来(源码下载地址戳这里).，解压后放在自己的工作空间中的　src　文件夹里面，然后在终端输入：</p> 
<p>$ cd catkin_ws("catkin_ws"替换成你的工作空间名称)<br> $ catkin_make<br><br> 编译完成以后在终端中输入：</p> 
<p>rospack plugins --attrib=plugin costmap_2d<br><br> 当你发现终端中输出：</p> 
<p><img alt="" src="https://images2.imgbox.com/d1/3c/LLC6B4nZ_o.png"><br> 这就表明prohibition_layer已经是一个可供使用的地图插件了． </p> 
<p>２　在代价地图中插入prohibition_layer<br> 　　完成步骤１后说明prohibition_layer已经可以供costmap使用了，现在我们要做的就是把prohibition_layer插入到costmap中去．<br> 　　我们在自己的代价地图参数配置文件夹中找到　global_costmap_params.yaml　和　local_costmap_params.yaml　，打开这两个文档，分别在两个文档的末尾做修改，修改后应该是下面的内容：</p> 
<p> plugins:<br>       - {name: static_map,       type: "costmap_2d::StaticLayer"}<br>       - {name: obstacles,        type: "costmap_2d::VoxelLayer"}<br>       - {name: costmap_prohibition_layer,        type: "costmap_prohibition_layer_namespace::CostmapProhibitionLayer"}     <br>       - {name: inflation_layer,        type: "costmap_2d::InflationLayer"}</p> 
<p><br> ３　修改launch文件<br> 　　完成插入地图后我们还需要修改自己的launch文件，我是在自己的move_base.launch 中插入的，这个大家根据自己的需求，你用的carlike就修改carlike的launch文件．打开自己的launch文件中插入如下内容:</p> 
<p>&lt;rosparam file="$(find turtlebot3_navigation)/param/prohibition_areas.yaml" command="load" ns="global_costmap/costmap_prohibition_layer" /&gt;<br> &lt;rosparam file="$(find turtlebot3_navigation)/param/prohibition_areas.yaml" command="load" ns="local_costmap/costmap_prohibition_layer" /&gt;<br> 1<br> 2<br> 其中的＂turtlebot3_navigation＂需要根据自己的情况修改，你打开自己的launch文件对照上下文就知道怎么更改了．</p> 
<p>４　设置禁止区域坐标参数<br> 　　完成以上步骤所有的配置工作就剩下最后一步了，设置禁止区域坐标参数．<br> 　　首先需要在参数配置文件夹（就是和　global_costmap_params.yaml　以及　local_costmap_params.yaml　相同位置的文件夹）中创建新的文档，命名为　＂prohibition_areas.yaml＂．<br> 　　然后在prohibition_areas.yaml文档中输入:</p> 
<p>prohibition_areas:<br> #定义一个禁止点<br>  - [17.09, -6.388]<br> # 定义一个禁止通行的线<br>  - [[8.33, 2.11],<br>     [8.26, 5.11]]<br> # 定义一个禁止通行的区域<br>  - [[-11.15, -15.614],<br>     [-12.35, -13.89],<br>     [-10.05, -12.218]]<br>  <br> 注意事项：<br> １　一定要严格按照上述格式来设置坐标，我之前遇到的格式错误导致不能识别禁止区域坐标情形有<br> 　　（１）：坐标前的短横线没对齐<br> 　　（２）：定义禁止区域或者禁止线，两坐标之间缺少了逗号<br> ２　你可以同时定义多个禁止点／多个禁止线／多个禁止区域，或者混合定义多个点／线／区域．<br> ３　禁止区域的坐标如何设置就需要你根据自己建的图来测量，这里就不赘述了．</p> 
<p>５　结语<br> 完成以上所有内容，你再次打开自己的导航就能够在rviz中看到自己的设置的禁止区域了，这里贴出我之前做的结果：</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/d9/8a/YjtE4lYK_o.jpg"><br> 这是我在实验室里面建立的地图，图中的红色三角形是我设立的禁止区域，矩形框是我画的四条禁止线，小车现在在矩形框内，当我把导航目标设置在矩形框外的时候，结果显示的是无法规划路线的．</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3d0a380534e516266a313d3311fbfdbe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">请简述计算机添加本地打印机操作步骤,在word中如何添加本地打印机</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38f8e451a9adc448cfafbd5c74550215/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GB28181平台介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>