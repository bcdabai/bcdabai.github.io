<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>js逆向-某天下房地产验证码 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="js逆向-某天下房地产验证码" />
<meta property="og:description" content="声明 本文仅供学习参考，如有侵权可私信本人删除，请勿用于其他途径，违者后果自负！
如果觉得文章对你有所帮助，可以给博主点击关注和收藏哦！
前言 目标网站：aHR0cHM6Ly9wYXNzcG9ydC5mYW5nLmNvbS8=``
接口：短信验证码登录接口
在此特别感谢k哥的文章及本人的指导。
【验证码逆向专栏】房某下登录滑块逆向分析
流程分析 目标很明确，滑块验证码的识别，使用算法还原。
打开网站，输入手机号后点击【获取短信验证码】后就会弹验证码。
流程如下：
滑块划到缺口校验成功后就会发送验证码。
打开F12查看这两部分内容发包情况。
第一个包会返回chanllenge和gt，这两个参数十分关键，是整个流程的重中之重。
接下来就是将滑块的图片返回回来。
将url进行一下拼接进行请求就可以得到背景图和滑块图。需要注意的是在做距离识别时需要查看图片大小，然后进行图片的缩放或者轨迹的缩放。
实际大小和渲染大小比例大概是1:0.9375
接下来就是滑动提交滑块的接口，分别对应三个状态。
状态码含义100成功并且发送敦信101参数错误102滑动距离错误 参数分析 请求加密的地方只有后端校验滑块的接口。
其中c、a为固定参数，可以写死。start是滑块滑动的开始时间，end则对应的是结束时间，i是浏览器环境的加密，t是轨迹的加密。
gt和challenge在之前就已经获取了。
直接搜索i: 就可以定位到加密点。
可以清楚的看到加密函数是x.compress，参数是一个自执行函数，里面有大量的环境。环境的话尽量还是补全，防止后面出现问题。
跟进函数可以将整个对象都拿下来，因为在加密中都会使用到，直接一步到位
然后就是直接调用函数，将剩下需要的一些参数和所缺函数扣下来即可调用。
至此，参数i就已经拿下了。
继续看参数t
t和i相邻，直接就能看到。
老规矩将函数整体复制下来，然后自己改改就可以了。
函数的开头和结尾打上断点，关注一下入参和结果即可。
参数e是一个转换后的轨迹数组，传入之后返回了加密轨迹。
加密的函数逻辑
function (e) { for (var t = &#34;&#34;, n = e.length / 6, r = 0; r &lt; n; r &#43;= 1) t &#43;= E.charAt(f.parseInt(e.slice(6 * r, 6 * (r &#43; 1)), 2)); return t }(l) 逻辑并不复杂，k哥的文章也有讲到。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6b806684ef772ee87bdfb9a81764939a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-21T16:52:22+08:00" />
<meta property="article:modified_time" content="2023-12-21T16:52:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">js逆向-某天下房地产验证码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>声明</h4> 
<p><code>本文仅供学习参考，如有侵权可私信本人删除，请勿用于其他途径，违者后果自负！</code></p> 
<p><code>如果觉得文章对你有所帮助，可以给博主点击关注和收藏哦！</code></p> 
<h4><a id="_6"></a>前言</h4> 
<p>目标网站：aHR0cHM6Ly9wYXNzcG9ydC5mYW5nLmNvbS8=``</p> 
<p>接口：<code>短信验证码登录接口</code></p> 
<p>在此特别感谢k哥的文章及本人的指导。<br> <a href="https://blog.csdn.net/kdl_csdn/article/details/132755045">【验证码逆向专栏】房某下登录滑块逆向分析</a></p> 
<p><img src="https://images2.imgbox.com/cd/28/e5mwSJ76_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_16"></a>流程分析</h4> 
<p>目标很明确，滑块验证码的识别，使用算法还原。<br> 打开网站，输入手机号后点击【获取短信验证码】后就会弹验证码。<br> 流程如下：<br> <img src="https://images2.imgbox.com/77/56/e94iV4Pl_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/32/9b/A1yjwGcP_o.png" alt="在这里插入图片描述"></p> 
<p>滑块划到缺口校验成功后就会发送验证码。</p> 
<p>打开F12查看这两部分内容发包情况。</p> 
<p><img src="https://images2.imgbox.com/47/b9/enPH8TZt_o.png" alt="在这里插入图片描述"><br> 第一个包会返回<code>chanllenge</code>和<code>gt</code>，这两个参数十分关键，是整个流程的重中之重。</p> 
<p>接下来就是将滑块的图片返回回来。<br> <img src="https://images2.imgbox.com/e0/26/LtKOXWmP_o.png" alt="在这里插入图片描述"></p> 
<p>将url进行一下拼接进行请求就可以得到背景图和滑块图。需要注意的是在做距离识别时需要查看图片大小，然后进行图片的缩放或者轨迹的缩放。<br> <img src="https://images2.imgbox.com/2d/69/WlxZ9sIL_o.png" alt="在这里插入图片描述"><br> 实际大小和渲染大小比例大概是<code>1:0.9375</code></p> 
<p>接下来就是滑动提交滑块的接口，分别对应三个状态。</p> 
<table><thead><tr><th>状态码</th><th>含义</th></tr></thead><tbody><tr><td>100</td><td>成功并且发送敦信</td></tr><tr><td>101</td><td>参数错误</td></tr><tr><td>102</td><td>滑动距离错误</td></tr></tbody></table> 
<h4><a id="_46"></a>参数分析</h4> 
<p>请求加密的地方只有后端校验滑块的接口。<br> <img src="https://images2.imgbox.com/f7/8a/sZn3rOBp_o.png" alt="在这里插入图片描述"></p> 
<p>其中<code>c</code>、<code>a</code>为固定参数，可以写死。<code>start</code>是滑块滑动的开始时间，<code>end</code>则对应的是结束时间，<code>i</code>是浏览器环境的加密，<code>t</code>是轨迹的加密。<br> <code>gt</code>和<code>challenge</code>在之前就已经获取了。</p> 
<p>直接搜索<code>i: </code>就可以定位到加密点。<br> <img src="https://images2.imgbox.com/0a/b7/b0lW5SlX_o.png" alt="在这里插入图片描述"><br> 可以清楚的看到加密函数是<code>x.compress</code>，参数是一个自执行函数，里面有大量的环境。环境的话尽量还是补全，防止后面出现问题。</p> 
<p>跟进函数可以将整个对象都拿下来，因为在加密中都会使用到，直接一步到位<br> <img src="https://images2.imgbox.com/df/1e/UbWVBQKc_o.png" alt="在这里插入图片描述"></p> 
<p>然后就是直接调用函数，将剩下需要的一些参数和所缺函数扣下来即可调用。<br> 至此，参数<code>i</code>就已经拿下了。<br> <img src="https://images2.imgbox.com/fd/e0/m8yEXk9x_o.png" alt="在这里插入图片描述"></p> 
<p>继续看参数<code>t</code></p> 
<p><code>t</code>和<code>i</code>相邻，直接就能看到。<br> <img src="https://images2.imgbox.com/33/52/YNdYoHL9_o.png" alt="在这里插入图片描述"><br> 老规矩将函数整体复制下来，然后自己改改就可以了。</p> 
<p>函数的开头和结尾打上断点，关注一下入参和结果即可。</p> 
<p><img src="https://images2.imgbox.com/9d/59/iMQVKFJD_o.png" alt="在这里插入图片描述"><br> 参数<code>e</code>是一个转换后的轨迹数组，传入之后返回了加密轨迹。<br> <img src="https://images2.imgbox.com/92/29/KK0yKpS1_o.png" alt="在这里插入图片描述"><br> 加密的函数逻辑</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> n <span class="token operator">=</span> e<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> r <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span>
        t <span class="token operator">+=</span> <span class="token constant">E</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">*</span> r<span class="token punctuation">,</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> t
<span class="token punctuation">}</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span>
</code></pre> 
<p>逻辑并不复杂，k哥的文章也有讲到。</p> 
<p>接下来就是寻找轨迹转换的地方了（这个地方还是看了大佬的文章才找到的，只能说还是太菜了，哈哈）<br> <img src="https://images2.imgbox.com/cc/6d/XKez2pSq_o.png" alt="在这里插入图片描述"><br> 后知后觉才发现在哪里。<br> <img src="https://images2.imgbox.com/2b/e7/z78uY4ue_o.png" alt="在这里插入图片描述"><br> 参数e就是轨迹函数。</p> 
<p>该站点对于轨迹校验不算太严格，本地调用成功率大概在<code>75%</code>还需要继续优化。</p> 
<p><img src="https://images2.imgbox.com/c6/34/EpFB3ZHY_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_98"></a>最后</h4> 
<p>很多小伙伴关心的轨迹生成，我这里找的是github上开源的，可以参考使用。<br> 链接:<a href="https://github.com/mcolella14/python_ghost_cursor">python_ghost_cursor</a><br> 如果有能力手写的小伙伴也可以分享私信博主，万分感谢~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/420d483661879f66142428708bc3aa18/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracle转pg日志</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3f291eb16f82f52c5850816238f137ec/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">声音.wav文件的读取与保存</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>