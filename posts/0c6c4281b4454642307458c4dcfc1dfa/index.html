<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Shell 脚本之 MySQL 一键安装及基本配置（几分钟搞定） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Shell 脚本之 MySQL 一键安装及基本配置（几分钟搞定）" />
<meta property="og:description" content="准备工作 MySQL 该版本下载地址：
https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz
mysql_install-v1.0.sh脚本如下：
#!/bin/bash # MySQL 安装日志信息 log=/var/log/mysql_install.log # MySQL压缩包路径 MySQLPath=/root/mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz # sql 文件 sqlfile=/root/test.sql # 卸载系统⾃带的MARIADB rpm -qa|grep mariadb |xargs yum remove -y &gt; /dev/null # 解压MYSQL安装包 echo &#39;====================================&#39; echo &#39;Unzip....&#39; tar -zxf $MySQLPath -C /usr/local/ mv /usr/local/mysql-5.7.30-linux-glibc2.12-x86_64 /usr/local/mysql if [ $? -ne 0 ];then echo &#39;MySQL unzip failed!!!&#39; exit else echo &#39;====================================&#39; echo &#39;Unpack the success!&#39; fi # 创建MYSQL⽤户和⽤户组 groupadd mysql useradd -g mysql mysql mkdir /usr/local/mysql/data chown -R mysql:mysql /usr/local/mysql echo &#39;====================================&#39; echo &#39;User created successfully!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0c6c4281b4454642307458c4dcfc1dfa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-16T11:31:00+08:00" />
<meta property="article:modified_time" content="2021-07-16T11:31:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Shell 脚本之 MySQL 一键安装及基本配置（几分钟搞定）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown" style="font-size: 16px;"> 
 <h2 id="准备工作">准备工作</h2> 
 <p>MySQL 该版本下载地址：</p> 
 <p><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz" rel="nofollow noopener noreferrer" target="_blank">https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz</a></p> 
 <p></p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/71/11/9QxU2D7H_o.png" alt="image-20210716111126345" style="outline: none;"> 
 </div> 
 <p><code>mysql_install-v1.0.sh</code>脚本如下：</p> 
 <pre class="has"><code class="language-shell">#!/bin/bash

# MySQL 安装日志信息
log=/var/log/mysql_install.log
# MySQL压缩包路径
MySQLPath=/root/mysql-5.7.30-linux-glibc2.12-x86_64.tar.gz
# sql 文件
sqlfile=/root/test.sql

# 卸载系统⾃带的MARIADB
rpm -qa|grep mariadb |xargs yum remove -y &gt; /dev/null

# 解压MYSQL安装包
echo '===================================='
echo 'Unzip....'
tar -zxf $MySQLPath -C /usr/local/
mv /usr/local/mysql-5.7.30-linux-glibc2.12-x86_64 /usr/local/mysql
if [ $? -ne 0 ];then
echo 'MySQL unzip failed!!!'
exit
else
echo '===================================='
echo 'Unpack the success!'
fi

# 创建MYSQL⽤户和⽤户组
groupadd mysql
useradd -g mysql mysql
mkdir /usr/local/mysql/data
chown -R mysql:mysql /usr/local/mysql
echo '===================================='
echo 'User created successfully!'

# MYSQL的配置⽂件
cat &gt; /etc/my.cnf &lt;&lt; EOF
[mysql]
default-character-set=utf8
socket=/var/lib/mysql/mysql.sock
[mysqld]
skip-name-resolve
port = 3306
socket=/var/lib/mysql/mysql.sock
basedir=/usr/local/mysql
datadir=/usr/local/mysql/data
max_connections=200
character-set-server=utf8
default-storage-engine=INNODB
lower_case_table_names=1
max_allowed_packet=16M
EOF
if [ $? -ne 0 ];then
echo 'Failed to write the my.cnf configuration file!!!'
exit
else
echo '===================================='
echo 'my.cnf configuration success!'
echo '===================================='
fi

# 创建 /var/lib/mysql ⽬录，并修改权限
mkdir /var/lib/mysql
chmod 777 /var/lib/mysql

# 开始安装 MYSQL
cd /usr/local/mysql
./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data 2&gt;&amp;1 | tee $log

# 获取 root 初始密码
InitialPassword=`tail -1 $log |awk '{print $NF}'`

# 复制启动脚本到资源⽬录，并修改 basedir 和 datadir 为对应⽬录
cp ./support-files/mysql.server /etc/init.d/mysqld
sed -i '46s/basedir=/basedir=\/usr\/local\/mysql/g' /etc/init.d/mysqld
sed -i '47s/datadir=/datadir=\/usr\/local\/mysql\/data/g' /etc/init.d/mysqld
if [ $? -ne 0 ];then
echo 'Failed to replace /etc/init.d/mysqld!!!'
exit
else
echo '===================================='
echo '/etc/init.d/mysqld successfully modified!'
echo '===================================='
fi

# 设置MYSQL系统服务并开启⾃启
chmod +x /etc/init.d/mysqld
chkconfig --add mysqld

# 启动MYSQLD
service mysqld restart

# 检查 MySQL 服务是否启动成功
netstat -ntlp | grep 3306
if [ $? -ne 0 ];then
echo 'MySQL Boot failure!!!'
exit
else
echo '===================================='
echo 'start MySQL successfully!'
fi

# 将 MYSQL 的 BIN ⽬录加⼊ PATH 环境变量
echo "export PATH=\$PATH:/usr/local/mysql/bin" &gt;&gt; ~/.bash_profile
source ~/.bash_profile

if [ $? -ne 0 ];then
echo 'Variable write failed!!!'
exit
else
echo '===================================='
echo 'Variable write successful!'
echo '===================================='
fi

# 登陆MYSQL，并执行 SQL 语句
mysql -uroot -p"$InitialPassword" --connect-expired-password &lt; $sqlfile 2&gt; /dev/null

if [ $? -ne 0 ];then
echo 'fail to perform MySQL operation!!!'
exit
else
echo '===================================='
echo 'All operations were successful and can be connected through Navicat!!!'
echo '===================================='
fi</code></pre> 
 <p><code>test.sql</code>文件内容如下：</p> 
 <pre class="has"><code class="language-sql">alter user user() identified by "123456";
use mysql;
update user set user.Host='%' where user.User='root';
flush privileges;</code></pre> 
 <p>第一、修改 root 密码；</p> 
 <p>第二、设置远程主机登录，可以通过<code>Navicat</code>来登录。</p> 
 <h2 id="执行脚本">执行脚本</h2> 
 <p>这里需要注意的是不要使用<code> ./mysql_install-v1.0.sh</code>方式来执行，否则系统环境变量执行完脚本之后不生效；</p> 
 <p>需要使用<code>source mysql_install-v1.0.sh</code>来执行脚本才可以。</p> 
 <p></p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/5a/d4/utrLXm0l_o.png" alt="image-20210716112006040" style="outline: none;"> 
 </div> 
 <p>使用修改后的密码登录测试</p> 
 <p></p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/8b/62/l02zCWWQ_o.png" alt="image-20210716112105269" style="outline: none;"> 
 </div> 
 <p>Navicat 连接测试</p> 
 <p></p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/34/d2/nQZ45S4w_o.png" alt="Snipaste_2021-07-16_11-07-26" style="outline: none;"> 
 </div> 
 <p>后续还会继续更新其他应用一键安装脚本，欢迎关注我哦！！！</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26b25491da79af53937a892fb0a8b898/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracledb-exporter部署手册</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0b41c5a50e910157260cce31ed4f1f0e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git——修改远程分支名称</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>