<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AcWing 1084. 数字游戏 II（数位dp） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AcWing 1084. 数字游戏 II（数位dp）" />
<meta property="og:description" content="题意： 定义一种取模数，这种数字必须满足 各位数字之和 mod N 为 0。
指定一个整数闭区间 [a, b]，问这个 区间内有多少个取模数。
思路： 一般来说，数位Dp这类题目难点在于 如何预处理左分支方案数
对于本题，假设我们当前枚举到的第 i 位，且第 i 位上的数字是 x，那么对于答案中的第 i 位数字 j 来说，可以填两类数：
1.0 ~ x - 1
用 j 表示第 i 位数字（最高位），用 last 表示当前数严格前面数位上的数字之和，用sum表示后 i &#43; 1 位（包括第 i 位）数字之和，
则sum 与 last 的 关系式 为 (last &#43; sum) % N == 0（保证各个数位总和模 N 得 0），
将上式稍作变形，即得 sum % N 的结果 等价于 (- last) % N，答案 res 累加：res &#43;= f[i &#43; 1][j][((- last) % N)]。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8ce1f358cf9b140c41c34e5a464efd90/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-14T21:24:15+08:00" />
<meta property="article:modified_time" content="2022-04-14T21:24:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AcWing 1084. 数字游戏 II（数位dp）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/dc/80/4PQJU6VW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b6/3c/AhFVSaEl_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_2"></a>题意：</h4> 
<p>定义一种取模数，这种数字必须满足 <strong>各位数字之和 <code>mod N</code> 为 <code>0</code></strong>。</p> 
<p>指定一个整数闭区间 <code>[a, b]</code>，问这个 <strong>区间内有多少个取模数</strong>。</p> 
<h4><a id="_7"></a>思路：</h4> 
<p>一般来说，数位Dp这类题目难点在于 <strong>如何预处理左分支方案数</strong></p> 
<p>对于本题，假设我们当前枚举到的第 <code>i</code> 位，且第 <code>i</code> 位上的数字是 <code>x</code>，那么对于答案中的第 <code>i</code> 位数字 <code>j</code> 来说，可以填两类数：</p> 
<ul><li> <p>1.<code>0 ~ x - 1</code><br> 用 <code>j</code> 表示<strong>第 <code>i</code> 位数字（最高位）</strong>，用 <code>last</code> 表示当前数<strong>严格前面数位上的数字之和</strong>，用<code>sum</code>表示<strong>后 <code>i + 1</code> 位（包括第 <code>i</code> 位）数字之和</strong>，<br> 则<code>sum</code> 与 <code>last</code> 的 <strong>关系式</strong> 为 <code>(last + sum) % N == 0</code>（<strong>保证各个数位总和模 <code>N</code> 得 <code>0</code></strong>），<br> 将上式稍作变形，即得 <code>sum % N</code> 的结果 <strong>等价于</strong> <code>(- last) % N</code>，答案 <code>res</code> <strong>累加</strong>：<code>res += f[i + 1][j][((- last) % N)]</code>。</p> </li><li> <p>2.<code>x</code><br> 如果 <code>j</code> 填 <code>x</code>，<code>last += x</code>，之后 <strong>枚举下一位</strong>。</p> </li></ul> 
<p>接下来讨论 <strong>如何预处理 <code>f</code> 数组</strong>：</p> 
<h5><a id="fijk__22"></a>f[i][j][k] 状态表示：</h5> 
<p><code>f[i][j][k]</code> 表示 <strong>一共有 <code>i</code> 位，且最高位数字是 <code>j</code>，且所有位数字和模 <code>N</code> 结果为 <code>k</code> 的数的个数</strong></p> 
<p><strong>状态转移</strong>： 因为 <strong>第 <code>i</code> 位是 <code>j</code></strong>，且 <strong>所有数字之和模 <code>N</code> 为 <code>k</code></strong>，所以我们考虑 <strong>第 <code>i - 1</code> 位</strong>，假设 <strong>第 <code>i - 1</code> 位数字是 <code>x</code></strong>，由于 <code>j</code> 已经固定，<br> 那么 <strong>剩下的 <code>i - 1</code> 位数字之和模 <code>N</code> 的结果</strong> 即为：<code>(k - j) % N</code>，</p> 
<p>推出 <strong>状态转移方程</strong>：<br> <img src="https://images2.imgbox.com/08/02/AG7T7YrT_o.png" alt="在这里插入图片描述">（<code>mod</code> 函数能起到<strong>防止模结果为负</strong>的情况，代码中有具体体现）</p> 
<pre><code>#include&lt;bits/stdc++.h&gt;

using namespace std;
const int N = 15, M = 110;
int mod;
int n;
int f[N][N][M];//f[i][j][k] 代表共 i 位，最高位 i 为 j，各数位总和取余为 k 的数的方案数
typedef vector&lt;int&gt; vi;
#define pb push_back
#define pp pop_back

void init()
{
        memset(f, 0, sizeof f);
        for(int i=0; i&lt;=9; ++i)
        {
            int t = i % mod;
            f[1][i][t] = 1;
        }
        for(int i=2; i&lt;N; ++i)
        {
                for(int j=0; j&lt;=9; ++j)
                {
                        for(int k=0; k&lt;=9; ++k)
                        {
                                for(int m=0; m&lt;mod; ++m)
                                {
                                        f[i][j][m] += f[i-1][k][((m-j)%mod+mod)%mod];
                                }
                        }
                }
        }
}

int dp(int n)
{
        if(!n) return 1;//注意 当 n 得 0 的时候也是一个合法的方案，0 模 任何数 都得 0，为 1 种方案
        vi num; while(n) num.pb(n%10), n /= 10;
        int res = 0, last = 0;
        for(int i=num.size()-1; i&gt;=0; --i)
        {
                int x = num[i];
                for(int j=0; j&lt;x; ++j)//左分支
                {
                        res += f[i+1][j][((-last)%mod+mod)%mod];
                }

                last += x;//累加当前数，此为右分支
                if(!i &amp;&amp; !(last%mod)) ++res;//添加最后的答案
        }

        return res;
}

int main()
{
        int l, r;
        while(cin&gt;&gt;l&gt;&gt;r&gt;&gt;mod)
        {
                init();
                cout&lt;&lt;dp(r) - dp(l-1)&lt;&lt;'\n';
        }

        return 0;
}


</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a95fb244239e4208794742a4329e3c07/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二分查找详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8ed7177da8738a523992cd969889534b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java八股学习——设计模式的分类和介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>