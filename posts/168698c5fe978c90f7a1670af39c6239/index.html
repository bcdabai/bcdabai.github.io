<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dockerfile基础命令 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Dockerfile基础命令" />
<meta property="og:description" content="Dockerfile基本命令 FROM - 基于基准镜像 FROM centos # 基于centos:latestFROM scratch # 不依赖任何基准镜像base imageFROM tomcat:9.0.22-jdk8-openjdk LABEL &amp; MAINTAINER - 说明信息 MAINTAINER xxxx.com 机构&amp;个人ID LABEL version=“1.0”LABEL description=“这是描述信息” WORKDIR - 设置工作目录 WORKDIR /usr/localWORKDIR /usr/local/newdir # 自动创建尽量使用绝对路径 ADD &amp; COPY - 复制文件 ADD hello / # 复制到根目录ADD test.tar.gz / # 添加到根目录并解压ADD除了复制，还具备添加远程文件功能 ENV - 设置环境常量 ENV JAVA_HOME /usr/local/openjdk8RUN ${JAVA_HOME}/bin/java -jar test.jar尽量使用环境常量，可提高程序维护性 Dockerfile执行指令 RUN &amp; CMD &amp; ENTRYPOINT RUN：在Build构建时执行命令
RUN yum install -y vim # Shell 命令格式 会生成一个子shell进程 RUN [“yum”, “install”, “-y”, “vim”] # Exec命令格式 会用Exec进程替换当前进程，并且保持PID不变执行完毕，直接退出，并不会退回到之前的进程环境推荐使用Exec命令格式执行命令 ENTRYPOINT：容器启动时执行的命令" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/168698c5fe978c90f7a1670af39c6239/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-22T11:16:41+08:00" />
<meta property="article:modified_time" content="2021-03-22T11:16:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Dockerfile基础命令</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Dockerfile_0"></a>Dockerfile基本命令</h2> 
<h3><a id="FROM___2"></a>FROM - 基于基准镜像</h3> 
<ul><li>FROM centos # 基于centos:latest</li><li>FROM scratch # 不依赖任何基准镜像base image</li><li>FROM tomcat:9.0.22-jdk8-openjdk</li></ul> 
<h3><a id="LABEL__MAINTAINER___7"></a>LABEL &amp; MAINTAINER - 说明信息</h3> 
<ul><li>MAINTAINER xxxx.com 
  <ul><li>机构&amp;个人ID</li></ul> </li><li>LABEL version=“1.0”</li><li>LABEL description=“这是描述信息”</li></ul> 
<h3><a id="WORKDIR___13"></a>WORKDIR - 设置工作目录</h3> 
<ul><li>WORKDIR /usr/local</li><li>WORKDIR /usr/local/newdir # 自动创建</li><li>尽量使用绝对路径</li></ul> 
<h3><a id="ADD__COPY___18"></a>ADD &amp; COPY - 复制文件</h3> 
<ul><li>ADD hello / # 复制到根目录</li><li>ADD test.tar.gz / # 添加到根目录并解压</li><li>ADD除了复制，还具备添加远程文件功能</li></ul> 
<h3><a id="ENV___23"></a>ENV - 设置环境常量</h3> 
<ul><li>ENV JAVA_HOME /usr/local/openjdk8</li><li>RUN ${JAVA_HOME}/bin/java -jar test.jar</li><li>尽量使用环境常量，可提高程序维护性</li></ul> 
<h2><a id="Dockerfile_28"></a>Dockerfile执行指令</h2> 
<h3><a id="RUN__CMD__ENTRYPOINT_30"></a>RUN &amp; CMD &amp; ENTRYPOINT</h3> 
<ul><li> <p>RUN：在Build构建时执行命令</p> 
  <ul><li>RUN yum install -y vim # Shell 命令格式 
    <ul><li>会生成一个子shell进程</li></ul> </li><li>RUN [“yum”, “install”, “-y”, “vim”] # Exec命令格式 
    <ul><li>会用Exec进程替换当前进程，并且保持PID不变</li><li>执行完毕，直接退出，并不会退回到之前的进程环境</li><li>推荐使用Exec命令格式执行命令</li></ul> </li></ul> </li><li> <p>ENTRYPOINT：容器启动时执行的命令</p> 
  <ul><li>Dockerfile中只有最后一个ENTRYPOINT会被执行</li><li>ENTRYPOINT[“ps”] # 推荐使用Exec格式</li></ul> </li><li> <p>CMD：容器启动后执行默认的命令或参数</p> 
  <ul><li>CMD用于设置默认执行的命令</li><li>如果Dockerfile中出现多个CMD，则只有最后一个被执行</li><li>如容器启动时附加指令，则CMD被忽略</li><li>CMD [“ps”, “-ef”] # 推荐使用Exec格式</li></ul> </li><li> <p>举例</p> </li></ul> 
<pre><code class="prism language-bash">FROM centos
RUN <span class="token punctuation">[</span><span class="token string">"echo"</span>, <span class="token string">"image building!!!"</span><span class="token punctuation">]</span>
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">"ps"</span><span class="token punctuation">]</span>
CMD <span class="token punctuation">[</span><span class="token string">"-ef"</span><span class="token punctuation">]</span>
</code></pre> 
<h2><a id="DockerfileRedis_55"></a>Dockerfile实战-构建Redis镜像</h2> 
<pre><code class="prism language-bash">FROM centos
RUN <span class="token punctuation">[</span><span class="token string">"yum"</span>, <span class="token string">"install"</span>, <span class="token string">"-y"</span>, <span class="token string">"gcc"</span>, <span class="token string">"gcc-c++"</span>, <span class="token string">"net-tools"</span>, <span class="token string">"make"</span><span class="token punctuation">]</span>
WORKDIR /usr/local
ADD redis-4.0.14.tar.gz <span class="token keyword">.</span>
WORKDIR /usr/local/redis-4.0.14/src
RUN <span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
WORKDIR /usr/local/redis-4.0.14
ADD redis-7000.conf <span class="token keyword">.</span>
EXPOSE 7000
CMD <span class="token punctuation">[</span><span class="token string">"redis-server"</span>, <span class="token string">"redis-7000.conf"</span><span class="token punctuation">]</span>
</code></pre> 
<ul><li>构建镜像 
  <ul><li>docker build -t python_id.com/docker-redis .</li></ul> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/531b56e4139f5fc19003739ca1003a8d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">容器间的通信&amp;容器间数据共享</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c64887ae969dd41e96a3450e77bbe82f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">php使用情况,双冒号 ::在PHP中的使用情况，冒号php使用情况_PHP教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>