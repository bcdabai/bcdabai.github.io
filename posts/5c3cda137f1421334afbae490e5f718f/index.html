<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>推荐系统论文阅读——Neural Collaborative Filtering - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="推荐系统论文阅读——Neural Collaborative Filtering" />
<meta property="og:description" content="论文题目：Neural Collaborative Filtering 参考资料：https://www.cnblogs.com/HolyShine/p/6728999.html
尽管最近的一些工作已经把深度学习运用到了推荐的任务当中，但只是用深度学习给一些辅助的信息建模，例如项目的文字描述或音乐的声学特征等等。在表示用户与项目之间的交互是仍然使用矩阵分解等用内积来建模。这篇文章的工作主要是用多层神经网络给用户和数据之间的交互建模，我们数据主要基于隐式反馈，例如浏览记录、购买记录等等。在本文中，我们探讨了如何利用DNN来模拟噪声隐式反馈信号的中心问题。
显示反馈（explicit feedback）：用户直接反映其对产品的喜好信息，如评分等等。 隐式反馈（implicit feedback）：间接反映出用户对于产品的喜好，如：购买历史、浏览记录、搜索记录等
论文贡献 1、我们提出了一种神经网络结构来模拟用户和项目的潜在特征，并设计了基于神经网络的协同过滤的通用框架NCF。 2、我们表明MF可以被解释为NCF的特例，并利用多层感知器来赋予NCF高水平的非线性建模能力。 3、我们对两个真实数据集进行广泛的实验，以证明我们的NCF方法的有效性和对使用深度学习进行协作过滤的承诺。
准备工作 符号说明 M M 和 NN 分别为项目和用户的数目。 Y∈RM×N Y ∈ R M × N 表示从用户的隐性反馈得到的用户-项目交互矩阵，定义如下：
这里， yui y u i 值为 1 1 仅表示用户 uu 与项目 i i 之间有交互信息，并不意味 uu 喜欢 i i ；同样的yuiyui 值为 0 0 也并不表示uu 讨厌 i i 。这其中缺少负反馈信息。这也是隐性反馈的一个挑战，因为它给用户偏好信息带来了干扰。
隐式反馈的推荐任务可以表示为预测矩阵 YY 中未观察到交互的entry的分数 y^ui=f(u,i|Θ) y ^ u i = f ( u , i | Θ ) ，这个分数最终用来给项目排名。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5c3cda137f1421334afbae490e5f718f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-03-04T11:26:46+08:00" />
<meta property="article:modified_time" content="2018-03-04T11:26:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">推荐系统论文阅读——Neural Collaborative Filtering</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>论文题目：Neural Collaborative Filtering <br> 参考资料：<a href="https://www.cnblogs.com/HolyShine/p/6728999.html" rel="nofollow">https://www.cnblogs.com/HolyShine/p/6728999.html</a></p> 
<hr> 
<p>尽管最近的一些工作已经把深度学习运用到了推荐的任务当中，但只是用深度学习给一些辅助的信息建模，例如项目的文字描述或音乐的声学特征等等。在表示用户与项目之间的交互是仍然使用矩阵分解等用内积来建模。这篇文章的工作主要是用多层神经网络给用户和数据之间的交互建模，我们数据主要基于隐式反馈，例如浏览记录、购买记录等等。在本文中，我们探讨了如何利用DNN来模拟噪声隐式反馈信号的中心问题。</p> 
<blockquote> 
 <p><strong>显示反馈</strong>（explicit feedback）：用户直接反映其对产品的喜好信息，如评分等等。 <br> <strong>隐式反馈</strong>（implicit feedback）：间接反映出用户对于产品的喜好，如：购买历史、浏览记录、搜索记录等</p> 
</blockquote> 
<hr> 
<h2 id="论文贡献">论文贡献</h2> 
<p>1、我们提出了一种神经网络结构来模拟用户和项目的潜在特征，并设计了基于神经网络的协同过滤的通用框架NCF。 <br> 2、我们表明MF可以被解释为NCF的特例，并利用多层感知器来赋予NCF高水平的非线性建模能力。 <br> 3、我们对两个真实数据集进行广泛的实验，以证明我们的NCF方法的有效性和对使用深度学习进行协作过滤的承诺。</p> 
<hr> 
<h2 id="准备工作">准备工作</h2> 
<h3 id="符号说明">符号说明</h3> 
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-1" style="width: 1.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.103em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.1em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      M 
     
   </span></span><script type="math/tex" id="MathJax-Element-1">M</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.9em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">N</script> 分别为项目和用户的数目。<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-7" style="width: 5.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.702em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.252em, 1004.7em, 2.502em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.202em;"></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.302em;">∈</span><span class="msubsup" id="MathJax-Span-11" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 2.702em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.7em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-12"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.703em;"><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      Y 
     
    
      ∈ 
     
     
      
      
        R 
       
      
      
      
        M 
       
      
        × 
       
      
        N 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-3">Y\in \mathbb{R}^{M\times N}</script> 表示从用户的隐性反馈得到的用户-项目交互矩阵，定义如下：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/ad/e1/vT5wHkCe_o.png" width="500"> 
</div> 
<p>这里，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-20" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.2em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="msubsup" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.503em;"><span class="texatom" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       y 
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-4">y_{ui}</script> 值为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-28" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.45em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mn" id="MathJax-Span-30" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      1 
     
   </span></span><script type="math/tex" id="MathJax-Element-5">1</script> 仅表示用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">u</script> 与项目 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-34" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      i 
     
   </span></span><script type="math/tex" id="MathJax-Element-7">i</script> 之间有交互信息，并不意味 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">u</script> 喜欢 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-40" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      i 
     
   </span></span><script type="math/tex" id="MathJax-Element-9">i</script>；同样的<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.2em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="msubsup" id="MathJax-Span-45"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.503em;"><span class="texatom" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">y_{ui}</script> 值为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-51" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.45em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mn" id="MathJax-Span-53" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      0 
     
   </span></span><script type="math/tex" id="MathJax-Element-11">0</script> 也并不表示<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-54" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">u</script> 讨厌 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-57" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      i 
     
   </span></span><script type="math/tex" id="MathJax-Element-13">i</script>。这其中缺少负反馈信息。这也是隐性反馈的一个挑战，因为它给用户偏好信息带来了干扰。</p>

<p>隐式反馈的推荐任务可以表示为预测矩阵 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-60" style="width: 1.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.802em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.8em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-61"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.202em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">Y</script> 中未观察到交互的entry的分数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-63" style="width: 7.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.303em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em, 1006.2em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="msubsup" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(3.103em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="munderover" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0.003em;"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.4em, 3.603em, -999.998em); top: -4.048em; left: 0.102em;"><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.603em;"><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">i</span><span class="texatom" id="MathJax-Span-81"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Main;">Θ</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
       
       
         y 
        
       
         ^ 
        
       
      
      
      
        u 
       
      
        i 
       
      
     
    
      = 
     
    
      f 
     
    
      ( 
     
    
      u 
     
    
      , 
     
    
      i 
     
     
     
       | 
      
     
    
      Θ 
     
    
      ) 
     
   </span></span><script type="math/tex" id="MathJax-Element-15"> \hat{y}_{ui}=f(u,i|\Theta )</script>，这个分数最终用来给项目排名。</p> 
<h3 id="损失的计算">损失的计算</h3> 
<p>为了学习模型的参数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-86" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.753em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.7em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Main;">Θ</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      Θ 
     
   </span></span><script type="math/tex" id="MathJax-Element-16">\Theta</script>，有两种loss可供选择，point-wise loss和pair-wise loss。</p> 
<blockquote> 
 <p>逐点损失（point-wise loss）：最小化 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-89" style="width: 1.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.374em, 1001.32em, 2.689em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-90"><span class="msubsup" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="munderover" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0.003em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.146em, 1000.4em, 3.66em, -999.997em); top: -4.054em; left: 0.06em;"><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.574em;"><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
      
       
        
        
          y 
         
        
          ^ 
         
        
       
       
       
         u 
        
       
         i 
        
       
      
    </span></span><script type="math/tex" id="MathJax-Element-17"> \hat{y}_{ui}</script> 与<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-101" style="width: 1.546em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.66em, 1001.2em, 2.689em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.517em;"><span class="texatom" id="MathJax-Span-105"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
      
      
        y 
       
       
       
         u 
        
       
         i 
        
       
      
    </span></span><script type="math/tex" id="MathJax-Element-18">y_{ui}</script> 之间的差距。 <br> 成对损失（pair-wise loss）：最大化观察到信息的entry<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-109" style="width: 1.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.374em, 1001.32em, 2.689em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="munderover" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0.003em;"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.146em, 1000.4em, 3.66em, -999.997em); top: -4.054em; left: 0.06em;"><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.574em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
      
       
        
        
          y 
         
        
          ^ 
         
        
       
       
       
         u 
        
       
         i 
        
       
      
    </span></span><script type="math/tex" id="MathJax-Element-19"> \hat{y}_{ui}</script>与未观察到信息的entry<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-121" style="width: 1.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.374em, 1001.32em, 2.689em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="msubsup" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 1.317em; height: 0px;"><span style="position: absolute; clip: rect(3.089em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0em;"><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="munderover" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.52em, 4.403em, -999.997em); top: -3.997em; left: 0.003em;"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.146em, 1000.4em, 3.66em, -999.997em); top: -4.054em; left: 0.06em;"><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.769em; left: 0.574em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mi" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
      
       
        
        
          y 
         
        
          ^ 
         
        
       
       
       
         u 
        
       
         i 
        
       
      
    </span></span><script type="math/tex" id="MathJax-Element-20"> \hat{y}_{ui}</script>之间的差距。</p> 
</blockquote> 
<p>对于这两种loss，NCF都支持。在文中，使用的是point-wise loss。关于pair-wise loss可以参考<a href="http://blog.csdn.net/stalbo/article/details/78295712">BPR论文</a>。</p> 
<h3 id="矩阵分解matrix-factorization">矩阵分解（Matrix Factorization）</h3> 
<p>令<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-133" style="width: 1.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.05em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="msubsup" id="MathJax-Span-135"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Main;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.552em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        p 
       
      
      
      
        u 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-21">\mathrm{p}_{u}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-142" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.85em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="msubsup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Main;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.552em;"><span class="texatom" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        q 
       
      
      
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-22">\mathrm{q}_{i}</script> 分别表示用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-151" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      u 
     
   </span></span><script type="math/tex" id="MathJax-Element-23">u</script> 和项目 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">i</script> 的潜在向量，MF用<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-157" style="width: 1.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.05em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-160"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Main;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.552em;"><span class="texatom" id="MathJax-Span-163"><span class="mrow" id="MathJax-Span-164"><span class="mi" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        p 
       
      
      
      
        u 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-25">\mathrm{p}_{u}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-166" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.85em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-167"><span class="msubsup" id="MathJax-Span-168"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Main;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.552em;"><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        q 
       
      
      
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-26">\mathrm{q}_{i}</script> 的内积来评估它们之间的交互<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-175" style="width: 1.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em, 1001.3em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(3.103em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="munderover" id="MathJax-Span-180"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0.003em;"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.4em, 3.603em, -999.998em); top: -4.048em; left: 0.102em;"><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.603em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
       
       
         y 
        
       
         ^ 
        
       
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-27"> \hat{y}_{ui}</script>：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/dc/a2/orYe7OTz_o.png" width="450"> 
</div> 
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-187" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.9em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      K 
     
   </span></span><script type="math/tex" id="MathJax-Element-28">K</script> 是潜在空间（latent space）的维度，MF模型是用户和项目的潜在因素的双向互动，它假设潜在空间的每一维都是相互独立的并且用相同的权重将它们线性结合。因此，MF可视为潜在因素（latent factor）的线性模型。</p>

<p>下图Figure1 中的例子就展示了MF在低维潜在空间表示用户-项目复杂的交互的局限性。解决方法之一是扩大潜在空间的维度 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-190" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.9em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-191"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">K</script>。但这可能有损模型的泛化能力。本文我们通过使用DNNs从数据中学习交互函数突破这一限制。</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/73/84/Mpk9WsKD_o.png" width="400"> 
</div> 
<blockquote> 
 <p><strong>注释</strong>：（1）由于MF将用户和项目映射到同一潜在空间中，两个用户之间的相似性也可以用内积，或者潜在向量之间的角度的余弦值来衡量。（2）我们使用Jaccard系数作为MF需要恢复的两个用户的真实状况之间的相似度。 <br> 令 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-193" style="width: 1.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.26em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.431em, 1001.26em, 2.631em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-194"><span class="msubsup" id="MathJax-Span-195"><span style="display: inline-block; position: relative; width: 1.26em; height: 0px;"><span style="position: absolute; clip: rect(3.146em, 1000.75em, 4.174em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.746em;"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
      
      
        R 
       
      
        u 
       
      
    </span></span><script type="math/tex" id="MathJax-Element-30">R_u</script> 表示与用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-198" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.66em, 1000.57em, 2.46em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
     
       u 
      
    </span></span><script type="math/tex" id="MathJax-Element-31">u</script> 交互的项目集，那么用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" style="width: 0.746em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.574em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.66em, 1000.57em, 2.46em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">u</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;"> 
    
    <span class="math" id="MathJax-Span-204" style="width: 0.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.431em, 1000.4em, 2.689em, -999.997em); top: -2.283em; left: 0em;"><span class="mrow" id="MathJax-Span-205"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.289em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span> 
   <span class="MJX_Assistive_MathML"> 
     
     
       j 
      
    </span></span><script type="math/tex" id="MathJax-Element-33">j</script> 之间的Jaccard相似系数就被定义为： <br>
  </p><div align="center"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mstyle displaystyle="true" scriptlevel="0"&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 8.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.149em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.696em, 1007.15em, 3.523em, -999.997em); top: -2.344em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="mstyle" id="MathJax-Span-209"><span class="mrow" id="MathJax-Span-210"><span class="msubsup" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.163em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.483em;"><span class="texatom" id="MathJax-Span-213"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.269em;">=</span><span class="mfrac" id="MathJax-Span-218" style="padding-left: 0.269em;"><span style="display: inline-block; position: relative; width: 4.536em; height: 0px; margin-right: 0.109em; margin-left: 0.109em;"><span style="position: absolute; clip: rect(3.096em, 1004.32em, 4.483em, -999.997em); top: -4.744em; left: 50%; margin-left: -2.184em;"><span class="mrow" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-222"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.75em, 4.163em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.749em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.216em;">∩</span><span class="mrow" id="MathJax-Span-229" style="padding-left: 0.216em;"><span class="mo" id="MathJax-Span-230" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 1.123em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.75em, 4.163em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.749em;"><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-234" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.096em, 1004.32em, 4.483em, -999.997em); top: -3.251em; left: 50%; margin-left: -2.184em;"><span class="mrow" id="MathJax-Span-235"><span class="mrow" id="MathJax-Span-236"><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 1.069em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.75em, 4.163em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.749em;"><span class="mi" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">|</span></span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main; padding-left: 0.216em;">∪</span><span class="mrow" id="MathJax-Span-243" style="padding-left: 0.216em;"><span class="mo" id="MathJax-Span-244" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="msubsup" id="MathJax-Span-245"><span style="display: inline-block; position: relative; width: 1.123em; height: 0px;"><span style="position: absolute; clip: rect(3.149em, 1000.75em, 4.163em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.837em; left: 0.749em;"><span class="mi" id="MathJax-Span-247" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-248" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(0.856em, 1004.54em, 1.229em, -999.997em); top: -1.277em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.536em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.069em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.349em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.33em; border-left: 0px solid; width: 0px; height: 3.337em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mrow><mo>|</mo><msub><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>|</mo></mrow><mo>∩</mo><mrow><mo>|</mo><msub><mi>R</mi><mi>j</mi></msub><mo>|</mo></mrow></mrow><mrow><mrow><mo>|</mo><msub><mi>R</mi><mi>i</mi></msub><mo>|</mo></mrow><mo>∪</mo><mrow><mo>|</mo><msub><mi>R</mi><mi>j</mi></msub><mo>|</mo></mrow></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-34">\displaystyle s_{ij}=\frac{\left | R_{i} \right |\cap \left | R_j \right |}{\left | R_i \right |\cup \left | R_j \right |}</script> 
 <p></p> 
 
<hr> 
<h2 id="ncfneural-collaborative-filtering框架">NCF（Neural Collaborative Filtering）框架</h2> 
<h3 id="通用框架">通用框架</h3> 
<p>下图Figure2展示的是NCF的通用框架。我们用多层感知机来模拟用户和项目之间的交互 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-249" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.2em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-250"><span class="msubsup" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.503em;"><span class="texatom" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       y 
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-35">y_{ui}</script>。最底部的输入层是两个特征向量 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-257" style="width: 1.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.502em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1001.5em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-258"><span class="msubsup" id="MathJax-Span-259"><span style="display: inline-block; position: relative; width: 1.502em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.75em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.202em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.6em, 4.152em, -999.998em); top: -4.348em; left: 0.853em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.552em, 1000.5em, 4.152em, -999.998em); top: -3.848em; left: 0.603em;"><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       V 
      
      
      
        u 
       
      
      
      
        U 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-36">V_{u}^{U}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-267" style="width: 1.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1001.3em, 2.752em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-268"><span class="msubsup" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.75em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.202em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.45em, 4.152em, -999.998em); top: -4.348em; left: 0.853em;"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.402em, 1000.3em, 4.152em, -999.998em); top: -3.698em; left: 0.603em;"><span class="texatom" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       V 
      
      
      
        i 
       
      
      
      
        I 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-37">V_{i}^{I}</script>，分别用来描述用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-277" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      u 
     
   </span></span><script type="math/tex" id="MathJax-Element-38">u</script> 和项目 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-280" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">i</script>。它们可以自行设计，支持广泛的用户和项目的模型，例如上下文感知（context-aware），基于内容（content-based），和基于邻居（neighbor-based）等构建方式。本文中，我们仅使用一个用户和一个项目作为输入特征，用one-hot编码将它们转化为二值稀疏向量。我们对输入使用这样的通用特征表示，可以很容易地使用的内容特征来表示用户和项目，以调整解决冷启动问题。</p> 
<blockquote> 
 <p><strong>冷启动问题</strong>：如何在没有大量用户数据的情况下设计个性化推荐系统并让用户对推荐结果满意从而愿意使用推荐系统，就是冷启动问题。 <br> <strong>分类</strong>： <br> （1）用户冷启动：如何给新用户做个性化推荐 <br> （2）物品冷启动：如何将新物品推荐给可能对其感兴趣的用户。在新闻网站等时效性很强的网站中非常重要。 <br> （2）系统冷启动：如何在一个新开发的网站上设计个性化推荐，从而在网站刚发布时就让用户体验到个性化推荐服务。没有用户，只有一些物品信息。</p> 
</blockquote> 
<div align="center"> 
 <img src="https://images2.imgbox.com/c2/ec/aUdzg0et_o.png" width="500"> 
</div> 
<p>输入层（Input Layer）上面是嵌入层（Embedding Layer）;它是一个全连接层，用来将输入层的稀疏表示映射为一个密集向量（dense vector）。这些嵌入后的向量其实就可以看做是用户（项目）的潜在向量。然后我们将这些嵌入向量送入多层网络结构，最后得到预测的分数。NCF层的每一层可以被定制，用以发现用户-项目交互的某些潜在结构。最后一个隐层 X 的维度尺寸决定了模型的能力。最终输出层是预测分数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-283" style="width: 1.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em, 1001.3em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-284"><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(3.103em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="munderover" id="MathJax-Span-288"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0.003em;"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.4em, 3.603em, -999.998em); top: -4.048em; left: 0.102em;"><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.603em;"><span class="texatom" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
       
       
         y 
        
       
         ^ 
        
       
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-40"> \hat{y}_{ui}</script>，文中，训练目标是最小化 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-295" style="width: 1.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em, 1001.3em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-296"><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(3.103em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="munderover" id="MathJax-Span-300"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0.003em;"><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.4em, 3.603em, -999.998em); top: -4.048em; left: 0.102em;"><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.603em;"><span class="texatom" id="MathJax-Span-303"><span class="mrow" id="MathJax-Span-304"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
       
       
         y 
        
       
         ^ 
        
       
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-41"> \hat{y}_{ui}</script>和其目标值<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-307" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.2em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-308"><span class="msubsup" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.503em;"><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        y 
       
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-42">{y}_{ui}</script>之间逐点损失（point-wise loss）。</p> 
<p>我们将NCF的预测模型表示为：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/80/d4/XpVbck9w_o.png" width="400"> 
</div> 
<p>其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-317" style="width: 5.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.252em, 1004.6em, 2.502em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-318"><span class="texatom" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Main;">P</span></span></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main; padding-left: 0.302em;">∈</span><span class="msubsup" id="MathJax-Span-323" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 2.702em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.7em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.703em;"><span class="texatom" id="MathJax-Span-327"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       P 
      
     
    
      ∈ 
     
     
      
      
        R 
       
      
      
      
        M 
       
      
        × 
       
      
        K 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-43">\mathrm{P}\in \mathbb{R}^{M\times K}</script>， <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-332" style="width: 5.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.252em, 1004.6em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-333"><span class="texatom" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Main;">Q</span></span></span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main; padding-left: 0.302em;">∈</span><span class="msubsup" id="MathJax-Span-338" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 2.603em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.7em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.703em;"><span class="texatom" id="MathJax-Span-342"><span class="mrow" id="MathJax-Span-343"><span class="mi" id="MathJax-Span-344" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       Q 
      
     
    
      ∈ 
     
     
      
      
        R 
       
      
      
      
        N 
       
      
        × 
       
      
        K 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-44">\mathrm{Q}\in \mathbb{R}^{N\times K}</script>，分别表示用户和项目的潜在因素矩阵；<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-347" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.153em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.15em, 2.752em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-348"><span class="msubsup" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 1.153em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.7em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Main;">Θ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.802em;"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       Θ 
      
     
       j 
      
     
   </span></span><script type="math/tex" id="MathJax-Element-45">\Theta _j</script> 表示交互函数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-352" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.55em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      f 
     
   </span></span><script type="math/tex" id="MathJax-Element-46">f </script> 的模型参数。由于函数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-355" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.55em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      f 
     
   </span></span><script type="math/tex" id="MathJax-Element-47">f</script> 被定义为多层神经网络，上面的式子也可以表示为：</p>

<div align="center"><img src="https://images2.imgbox.com/0c/fe/bIiodTzH_o.png" width="500"></div>

<p>其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.65em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="msubsup" id="MathJax-Span-360"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.6em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.603em;"><span class="texatom" id="MathJax-Span-362"><span class="mrow" id="MathJax-Span-363"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ϕ</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">\phi _{out}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-367" style="width: 1.403em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.103em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.1em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-368"><span class="msubsup" id="MathJax-Span-369"><span style="display: inline-block; position: relative; width: 1.103em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.6em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.603em;"><span class="texatom" id="MathJax-Span-371"><span class="mrow" id="MathJax-Span-372"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       ϕ 
      
      
      
        x 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-49">\phi _{x}</script> 分别表示为输出层和第 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-374" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      x 
     
   </span></span><script type="math/tex" id="MathJax-Element-50">x</script> 个neural CF层映射函数，总共有 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-377" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.85em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">X</script> 个neural CF层。</p> 
<h4 id="ncf的目标函数">NCF的目标函数</h4> 
<p>常用的逐点学习方法主要是均方误差（squared loss）,但它并不适合处理隐性数据，文中提出了一种逐点学习NCF的概率学方法，特别注重隐性数据的二进制属性。</p> 
<p>我们可以将 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-380" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.2em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-381"><span class="msubsup" id="MathJax-Span-382"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.503em;"><span class="texatom" id="MathJax-Span-384"><span class="mrow" id="MathJax-Span-385"><span class="mi" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       y 
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-52">y_{ui}</script> 的值作为一个标签——1表示项目 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-388" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      i 
     
   </span></span><script type="math/tex" id="MathJax-Element-53">i</script> 和用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">u</script> 相关，否则为0。这样，预测分数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-394" style="width: 1.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em, 1001.3em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-395"><span class="msubsup" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px;"><span style="position: absolute; clip: rect(3.103em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-397"><span class="mrow" id="MathJax-Span-398"><span class="munderover" id="MathJax-Span-399"><span style="display: inline-block; position: relative; width: 0.603em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0.003em;"><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.152em, 1000.4em, 3.603em, -999.998em); top: -4.048em; left: 0.102em;"><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.603em;"><span class="texatom" id="MathJax-Span-402"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
       
       
         y 
        
       
         ^ 
        
       
      
      
      
        u 
       
      
        i 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-55"> \hat{y}_{ui}</script> 就代表了项目 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-406" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-407"><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      i 
     
   </span></span><script type="math/tex" id="MathJax-Element-56">i</script> 和用户 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-409" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">u</script> 相关的可能性大小。因此，我们需要将网络输出限制到[0，1]的范围内。这可以通过在输出层 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-412" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.65em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-413"><span class="msubsup" id="MathJax-Span-414"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.6em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">ϕ</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.603em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       ϕ 
      
      
      
        o 
       
      
        u 
       
      
        t 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-58">\phi _{out}</script>使用概率函数（e.g. 逻辑函数sigmoid或者probit函数）作为激活函数实现。经过以上设置后，我们这样定义似然函数：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/e5/c0/MUnSSuSF_o.png" width="450"> 
</div> 
<p>对似然函数取负对数，我们得到（负对数可以用来表示Loss函数，而且还能消除小数乘法的下溢出问题）:</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/aa/1d/7htBXjoY_o.png" width="450"> 
</div> 
<p>（注：上面灰色的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-421" style="width: 0.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.4em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-422"><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      j 
     
   </span></span><script type="math/tex" id="MathJax-Element-59">j</script>完全可以用 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-424" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.352em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.3em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">i</script> 替代）其中， <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-427" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">ν<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      ν 
     
   </span></span><script type="math/tex" id="MathJax-Element-61">\nu</script> 表示交互矩阵 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-430" style="width: 1.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.802em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.8em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.202em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      Y 
     
   </span></span><script type="math/tex" id="MathJax-Element-62">Y </script>中观察到的entry（如对电影有明确的评分，评级）， <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-433" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.353em, 1001.2em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;">ν<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.603em;"><span class="mo" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       ν 
      
     
       − 
      
     
   </span></span><script type="math/tex" id="MathJax-Element-63">\nu ^-</script> 表示消极实例（negative instances，可以将未观察的样本全体视为消极实例，或者采取抽样的方式标记为消极实例）</p> 
<p>这是NCF方法需要去最小化的目标函数，并且可以通过使用随机梯度下降（SGD）来进行训练优化。细心的读者可能发现了，这个函数和二类交叉熵损失函数（binary cross-entropy loss，又被成为log loss）是一样的。通过在NCF上使用这样一个概率处理（probabilistic treatment），我们把隐性反馈的推荐问题当做一个二分类问题来解决。</p> 
<p>对于消极实例 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-438" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.353em, 1001.2em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-439"><span class="msubsup" id="MathJax-Span-440"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">ν<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.603em;"><span class="mo" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       ν 
      
     
       − 
      
     
   </span></span><script type="math/tex" id="MathJax-Element-64">\nu ^-</script> ，我们在每次迭代均匀地从未观察到的相互作用中采样（作为消极实例）并且对照可观察到交互的数量，控制采样比率。</p> 
<h3 id="gmfgeneralized-matrix-factorization">GMF（Generalized Matrix Factorization ）</h3> 
<p>下面我们展示如何将MF如何被解释为NCF框架的一个特例：</p> 
<p>由于嵌入后的向量可以看做是潜在向量，我们用 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-443" style="width: 3.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.252em, 1002.6em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-444"><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 1.252em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.6em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-446"><span class="mrow" id="MathJax-Span-447"><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Main;">P</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.397em; left: 0.703em;"><span class="mi" id="MathJax-Span-449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-450"><span style="display: inline-block; position: relative; width: 1.353em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.75em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-451"><span class="mrow" id="MathJax-Span-452"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Main;">V</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.6em, 4.152em, -999.998em); top: -4.397em; left: 0.753em;"><span class="texatom" id="MathJax-Span-454"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.552em, 1000.5em, 4.152em, -999.998em); top: -3.748em; left: 0.753em;"><span class="texatom" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="mi" id="MathJax-Span-459" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        P 
       
      
     
       T 
      
     
     
      
      
        V 
       
      
      
      
        u 
       
      
      
      
        U 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-65">\mathrm{P}^T\mathrm{V}_{u}^{U}</script> 表示用户的潜在向量 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-460" style="width: 1.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.05em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-461"><span class="msubsup" id="MathJax-Span-462"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Main;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.552em;"><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        p 
       
      
     
       u 
      
     
   </span></span><script type="math/tex" id="MathJax-Element-66">\mathrm{p}_u</script> ，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-467" style="width: 3.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.252em, 1002.55em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-468"><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 1.353em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.75em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Main;">Q</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.447em; left: 0.802em;"><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.102em;"></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-474"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.75em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-475"><span class="mrow" id="MathJax-Span-476"><span class="mi" id="MathJax-Span-477" style="font-family: MathJax_Main;">V</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.45em, 4.152em, -999.998em); top: -4.397em; left: 0.753em;"><span class="texatom" id="MathJax-Span-478"><span class="mrow" id="MathJax-Span-479"><span class="mi" id="MathJax-Span-480" style="font-size: 70.7%; font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.402em, 1000.3em, 4.152em, -999.998em); top: -3.748em; left: 0.753em;"><span class="texatom" id="MathJax-Span-481"><span class="mrow" id="MathJax-Span-482"><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        Q 
       
      
     
       T 
      
     
     
      
      
        V 
       
      
      
      
        i 
       
      
      
      
        I 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-67">\mathrm{Q}^T\mathrm{V}_{i}^{I}</script> 表示项目的潜在向量 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-484" style="width: 1.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.85em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-485"><span class="msubsup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Main;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.748em; left: 0.552em;"><span class="mi" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        q 
       
      
     
       i 
      
     
   </span></span><script type="math/tex" id="MathJax-Element-68">\mathrm{q}_i</script> ,我们定义第一层神经CF层的映射函数为：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/81/bd/q85qNety_o.png" width="400"> 
</div> 
<p>其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-491" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.753em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.552em, 1000.7em, 2.552em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-492"><span class="mo" id="MathJax-Span-493" style="font-family: MathJax_Main;">⊙</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      ⊙ 
     
   </span></span><script type="math/tex" id="MathJax-Element-69">\odot </script> 表示向量的逐元素乘积（element-wise product）。然后，我们将向量映射到输出层：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/31/3b/zuh8vm9L_o.png" width="400"> 
</div> 
<p>其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-494" style="width: 2.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.602em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.6em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-495"><span class="msubsup" id="MathJax-Span-496"><span style="display: inline-block; position: relative; width: 1.602em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       a 
      
      
      
        o 
       
      
        u 
       
      
        t 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-70">a_{out }</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-503" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      h 
     
   </span></span><script type="math/tex" id="MathJax-Element-71">h</script> 分别表示输出层的激活函数和连接权重。如果我们将  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-506" style="width: 2.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.602em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.6em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-507"><span class="msubsup" id="MathJax-Span-508"><span style="display: inline-block; position: relative; width: 1.602em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-510"><span class="mrow" id="MathJax-Span-511"><span class="mi" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-72">a_{out }</script> 看做一个恒等函数， <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-515" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-516"><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      h 
     
   </span></span><script type="math/tex" id="MathJax-Element-73">h</script> 权重全为 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-518" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.503em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.502em, 1000.45em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-519"><span class="mn" id="MathJax-Span-520" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-74">1</script>，显然这就是我们的MF模型。</p> 
<p>在NCF的框架下，MF可以很容易地被泛化和推广。例如，如果我们允许从没有一致性约束（uniform constraint）的数据中学习<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-521" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      h 
     
   </span></span><script type="math/tex" id="MathJax-Element-75">h</script> ，则会形成MF的变体，它允许潜在维度的不同重要性。如果我们用一个非线性函数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-524" style="width: 2.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.602em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001.6em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-525"><span class="msubsup" id="MathJax-Span-526"><span style="display: inline-block; position: relative; width: 1.602em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-528"><span class="mrow" id="MathJax-Span-529"><span class="mi" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-531" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-76">a_{out }</script> ，将进一步推广MF到非线性集合，使得模型比线性MF模型更具有表现力。在本文的工作中，我们在NCF下实现一个更一般化的MF，它使用Sigmoid函数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-533" style="width: 10.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.353em, 1008.1em, 2.702em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-534"><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">σ</span></span></span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mn" id="MathJax-Span-542" style="font-family: MathJax_Main; padding-left: 0.302em;">1</span><span class="texatom" id="MathJax-Span-543"><span class="mrow" id="MathJax-Span-544"><span class="mo" id="MathJax-Span-545" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-547" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="msubsup" id="MathJax-Span-549" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.502em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.45em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.453em;"><span class="texatom" id="MathJax-Span-551"><span class="mrow" id="MathJax-Span-552"><span class="mo" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       σ 
      
     
    
      ( 
     
    
      x 
     
    
      ) 
     
    
      = 
     
    
      1 
     
     
     
       / 
      
     
    
      ( 
     
    
      1 
     
    
      + 
     
     
     
       e 
      
      
      
        − 
       
      
        x 
       
      
     
    
      ) 
     
   </span></span><script type="math/tex" id="MathJax-Element-77">σ(x)=1/(1+e^{−x})</script> 作为激活函数，通过log loss(第3.1.1节)学习 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-556" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1000.55em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-557"><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      h 
     
   </span></span><script type="math/tex" id="MathJax-Element-78">h</script> 。我们称之为<strong>GMF</strong>（Generalized Matrix Factorization，广义矩阵分解）。</p>



<h2 id="mlp-multi-layer-perceptron">MLP (Multi-Layer Perceptron)</h2>

<p>我们用MLP（多层感知机）来学习用户和项目潜在特征之间的相互作用。NCF框架下，MLP模型定义为：</p>

<div align="center"><img src="https://images2.imgbox.com/5b/a0/mXGRiWzZ_o.png" width="400"></div>

<p>其中，这里的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;msub&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi mathvariant="normal"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-559" style="width: 1.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.502em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.5em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-560"><span class="msubsup" id="MathJax-Span-561"><span style="display: inline-block; position: relative; width: 1.502em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1001em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-562"><span class="mrow" id="MathJax-Span-563"><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Main;">W</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 1.052em;"><span class="texatom" id="MathJax-Span-565"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">W</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>x</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-79">\mathrm{W}_{x}</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-568" style="width: 1.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.453em, 1001.05em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-569"><span class="msubsup" id="MathJax-Span-570"><span style="display: inline-block; position: relative; width: 1.052em; height: 0px;"><span style="position: absolute; clip: rect(3.152em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-571"><span class="mrow" id="MathJax-Span-572"><span class="mi" id="MathJax-Span-573" style="font-family: MathJax_Main;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        b 
       
      
      
      
        x 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-80">\mathrm{b}_{x}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-577" style="width: 1.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1001em, 2.603em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-578"><span class="msubsup" id="MathJax-Span-579"><span style="display: inline-block; position: relative; width: 1.002em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.152em, -999.998em); top: -3.998em; left: 0em;"><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-581"><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
     
       a 
      
      
      
        x 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-81">a_{x}</script> 分别表示第 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-584" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.552em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.702em, 1000.5em, 2.452em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
    
      x 
     
   </span></span><script type="math/tex" id="MathJax-Element-82">x</script> 层的感知机中的的权重矩阵，偏置向量（神经网络的神经元阈值）和激活函数。激活函数可以选择sigmoid，tanh和ReLU等等。经过分析我们选择ReLu函数（激活函数的总结和比较可以参考<a href="http://blog.csdn.net/stalbo/article/details/79415243">这里</a>），实验结果也证明ReLU的表现略好于tanh和sigmoid。</p>

<p>在我们的结构中，每一层，相比于之前一层，神经元数量减少一半。</p>



<h2 id="gmf与mlp结合">GMF与MLP结合</h2>

<p>到目前为止，我们已经开发了NCF的两个实例：GMF，它应用了一个线性内核来模拟潜在的特征交互；MLP，使用非线性内核从数据中学习交互函数。接下来的问题是：我们如何能够在NCF框架下融合GMF和MLP，使他们能够相互强化，以更好地对复杂的用户-项目交互建模？</p>

<p>一个直接的解决方法是让GMF和MLP共享相同的嵌入层（Embedding Layer），然后再结合它们分别对相互作用的函数输出。具体地说，对于结合GMF和单层MLP的模型可以公式化为：</p>

<div align="center"><img src="https://images2.imgbox.com/19/61/XiYxdnc0_o.png" width="400"></div>

<p>然而，共享GMF和MLP的嵌入层可能会限制融合模型的性能。例如，它意味着，GMF和MLP必须使用的大小相同的嵌入，对于数据集，两个模型的最佳嵌入尺寸差异很大，使得这种解决方案可能无法获得最佳的组合。</p>

<div align="center"><img src="https://images2.imgbox.com/66/fa/QHRoCdLq_o.png" width="600"></div>

<p>为了使得融合模型具有更大的灵活性，我们允许GMF和MLP学习独立的嵌入，并结合两种模型通过连接他们最后的隐层输出。上图（Figure 3）展示了我们的方案，公式如下：</p>

<div align="center"><img src="https://images2.imgbox.com/64/cc/UGPquFQV_o.png" width="450"></div>

<p>这里的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml='&lt;math xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;msubsup&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi mathvariant="normal"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class="MJX-TeXAtom-ORD"&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;' role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-587" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1001.2em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-588"><span class="msubsup" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Main;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.65em, 4.152em, -999.998em); top: -4.348em; left: 0.552em;"><span class="texatom" id="MathJax-Span-593"><span class="mrow" id="MathJax-Span-594"><span class="mi" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">G</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.552em, 1000.5em, 4.152em, -999.998em); top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-596"><span class="mrow" id="MathJax-Span-597"><span class="mi" id="MathJax-Span-598" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">p</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>u</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>G</mi></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-83">\mathrm{p}_{u}^{G}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-599" style="width: 1.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.353em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1001.35em, 2.652em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-600"><span class="msubsup" id="MathJax-Span-601"><span style="display: inline-block; position: relative; width: 1.353em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.5em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-602"><span class="mrow" id="MathJax-Span-603"><span class="mi" id="MathJax-Span-604" style="font-family: MathJax_Main;">p</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.8em, 4.152em, -999.998em); top: -4.348em; left: 0.552em;"><span class="texatom" id="MathJax-Span-605"><span class="mrow" id="MathJax-Span-606"><span class="mi" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.552em, 1000.5em, 4.152em, -999.998em); top: -3.848em; left: 0.552em;"><span class="texatom" id="MathJax-Span-608"><span class="mrow" id="MathJax-Span-609"><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        p 
       
      
      
      
        u 
       
      
      
      
        M 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-84">\mathrm{p}_{u}^{M}</script> 分别表示 GMF 部分和 MLP 部分的用户嵌入（user embedding）；同样的，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-611" style="width: 1.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1001.2em, 2.752em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-612"><span class="msubsup" id="MathJax-Span-613"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-614"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Main;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.65em, 4.152em, -999.998em); top: -4.348em; left: 0.603em;"><span class="texatom" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-size: 70.7%; font-family: MathJax_Math-italic;">G</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.402em, 1000.3em, 4.152em, -999.998em); top: -3.698em; left: 0.552em;"><span class="texatom" id="MathJax-Span-620"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        q 
       
      
      
      
        i 
       
      
      
      
        G 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-85">\mathrm{q}_{i}^{G}</script> 和 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;"> 
   
   <span class="math" id="MathJax-Span-623" style="width: 1.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em, 1001.4em, 2.752em, -999.998em); top: -2.298em; left: 0em;"><span class="mrow" id="MathJax-Span-624"><span class="msubsup" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 1.403em; height: 0px;"><span style="position: absolute; clip: rect(3.402em, 1000.55em, 4.353em, -999.998em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-626"><span class="mrow" id="MathJax-Span-627"><span class="mi" id="MathJax-Span-628" style="font-family: MathJax_Main;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.8em, 4.152em, -999.998em); top: -4.348em; left: 0.603em;"><span class="texatom" id="MathJax-Span-629"><span class="mrow" id="MathJax-Span-630"><span class="mi" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.402em, 1000.3em, 4.152em, -999.998em); top: -3.698em; left: 0.552em;"><span class="texatom" id="MathJax-Span-632"><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span> 
  <span class="MJX_Assistive_MathML"> 
    
     
      
      
        q 
       
      
      
      
        i 
       
      
      
      
        M 
       
      
     
   </span></span><script type="math/tex" id="MathJax-Element-86">\mathrm{q}_{i}^{M}</script> 分别表示项目的嵌入。如之前所讨论的，我们使用ReLU作为 MLP层的激活功能。该模型结合MF的线性度和DNNs的非线性度，用以建模用户-项目之间的潜在结构。我们将这一模式称为“NeuMF”，简称神经矩阵分解（Neural Matrix Factorization）。该模型的每个模型参数都能使用标准反向传播（back-propagation）计算。</p> 
<h4 id="预训练">预训练</h4> 
<p>由于NeuMF的目标函数的非凸性，基于梯度的优化方法只能找到局部最优解。初始化（initialization）在深度学习模型的收敛性和性能的方面起到了重要的作用。由于 NeuMF 是 GMF 和 MLP 的组合，我们建议使用 GMF 和 MLP 的预训练模型来初始化NeuMF。</p> 
<p>我们首先训练随机初始化的 GMF 和 MLP 直到模型收敛。然后，我们用它们的模型参数初始化 NeuMF 相应部分的参数。唯一的调整是在输出层，在那里我们将两者用权重连接起来：</p> 
<div align="center"> 
 <img src="https://images2.imgbox.com/e0/d9/MF2j6nuE_o.png" width="400"> 
</div> 
<p>对于从头开始训练的 <strong>GMF 和 MLP</strong> ，我们采用自适应矩估计（<strong>Adam</strong>，Adaptive Moment Estimation）[20]，它通过对不频繁的参数进行频繁和更大幅度的更新来适应每个参数的学习速率。Adam方法在两种模型上的收敛速度都比普通SGD快，并缓解了调整学习率的痛苦。在将预先训练的参数输入<strong>NeuMF</strong>之后，我们用普通<strong>SGD</strong>而不是Adam进行优化。 这是因为Adam需要保存更新参数的动量信息（momentum information）。因为我们用预先训练的模型参数初始化NeuMF，并且放弃保存动量信息，不适合用基于动量的方法进一步优化NeuMF。</p> 
<hr> 
<h2 id="实验">实验</h2> 
<p>在本节中，我们指导实验的进行，用以回答以下研究问题：</p> 
<ul><li><p>RQ1 我们提出的NCF方法是否胜过 state-of-the-art 的隐性协同过滤方法？</p></li><li><p>RQ2 我们提出的优化框架（消极样本抽样的log loss）怎样为推荐任务服务？</p></li><li><p>RQ3 更深的隐藏单元是不是有助于对用户项目交互数据的学习？</p></li></ul> 
<p>接下来，我们首先介绍实验设置，其次是回答上述三个问题。</p> 
<p>详见论文</p>
                </div>
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-f23dff6052.css" rel="stylesheet">
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-c216769e99.css" rel="stylesheet">
        </blockquote></div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2cccf6f39b773f830a2d03a21ce5fe49/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">git代理（配合xshell）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d27ee8962fda73520e8469402e99ac8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ORACLE导入遇到ORACLE错误959解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>