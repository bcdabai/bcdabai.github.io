<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2024年美赛数学建模思路 - 案例：异常检测 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2024年美赛数学建模思路 - 案例：异常检测" />
<meta property="og:description" content="文章目录 赛题思路一、简介 -- 关于异常检测异常检测监督学习 二、异常检测算法2. 箱线图分析3. 基于距离/密度4. 基于划分思想 建模资料 赛题思路 （赛题出来以后第一时间在CSDN分享）
https://blog.csdn.net/dc_sinor?type=blog
一、简介 – 关于异常检测 异常检测（outlier detection）在以下场景：
数据预处理病毒木马检测工业制造产品检测网络流量检测 等等，有着重要的作用。由于在以上场景中，异常的数据量都是很少的一部分，因此诸如：SVM、逻辑回归等分类算法，都不适用，因为：
监督学习算法适用于有大量的正向样本，也有大量的负向样本，有足够的样本让算法去学习其特征，且未来新出现的样本与训练样本分布一致。
以下是异常检测和监督学习相关算法的适用范围：
异常检测 信用卡诈骗制造业产品异常检数据中心机器异常检入侵检测 监督学习 垃圾邮件识别新闻分类 二、异常检测算法 import tushare from matplotlib import pyplot as plt df = tushare.get_hist_data(&#34;600680&#34;) v = df[-90: ].volume v.plot(&#34;kde&#34;) plt.show() 近三个月，成交量大于200000就可以认为发生了异常（天量，嗯，要注意风险了……）
2. 箱线图分析 import tushare from matplotlib import pyplot as plt df = tushare.get_hist_data(&#34;600680&#34;) v = df[-90: ].volume v.plot(&#34;kde&#34;) plt.show() 大体可以知道，该股票在成交量少于20000，或者成交量大于80000，就应该提高警惕啦！
3. 基于距离/密度 典型的算法是：“局部异常因子算法-Local Outlier Factor”，该算法通过引入“k-distance，第k距离”、“k-distance neighborhood，第k距离邻域”、“reach-distance，可达距离”、以及“local reachability density，局部可达密度 ”和“local outlier factor，局部离群因子”，来发现异常点。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ceb4ea87ea0a482efc899ce210de8a6f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-18T16:01:08+08:00" />
<meta property="article:modified_time" content="2024-01-18T16:01:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2024年美赛数学建模思路 - 案例：异常检测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_3" rel="nofollow">赛题思路</a></li><li><ul><li><a href="#___10" rel="nofollow">一、简介 -- 关于异常检测</a></li><li><ul><li><a href="#_24" rel="nofollow">异常检测</a></li><li><a href="#_30" rel="nofollow">监督学习</a></li></ul> 
    </li><li><a href="#_35" rel="nofollow">二、异常检测算法</a></li><li><ul><li><a href="#2__53" rel="nofollow">2. 箱线图分析</a></li><li><a href="#3__67" rel="nofollow">3. 基于距离/密度</a></li><li><a href="#4__75" rel="nofollow">4. 基于划分思想</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_130" rel="nofollow">建模资料</a></li></ul> 
</div> 
<p></p> 
<h3><a id="_3"></a>赛题思路</h3> 
<p>（赛题出来以后第一时间在CSDN分享）</p> 
<p><a href="https://blog.csdn.net/dc_sinor?type=blog">https://blog.csdn.net/dc_sinor?type=blog</a></p> 
<h4><a id="___10"></a>一、简介 – 关于异常检测</h4> 
<p>异常检测（outlier detection）在以下场景：</p> 
<ul><li>数据预处理</li><li>病毒木马检测</li><li>工业制造产品检测</li><li>网络流量检测</li></ul> 
<p>等等，有着重要的作用。由于在以上场景中，异常的数据量都是很少的一部分，因此诸如：SVM、逻辑回归等分类算法，都不适用，因为：</p> 
<p>监督学习算法适用于有大量的正向样本，也有大量的负向样本，有足够的样本让算法去学习其特征，且未来新出现的样本与训练样本分布一致。</p> 
<p>以下是异常检测和监督学习相关算法的适用范围：</p> 
<h5><a id="_24"></a>异常检测</h5> 
<ul><li>信用卡诈骗</li><li>制造业产品异常检</li><li>数据中心机器异常检</li><li>入侵检测</li></ul> 
<h5><a id="_30"></a>监督学习</h5> 
<ul><li>垃圾邮件识别</li><li>新闻分类</li></ul> 
<h4><a id="_35"></a>二、异常检测算法</h4> 
<p><img src="https://images2.imgbox.com/e9/40/F4viyzuF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c2/af/0kdDTDgs_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">tushare</span>
from matplotlib <span class="token keyword">import</span> <span class="token namespace">pyplot</span> as plt
 
df <span class="token operator">=</span> tushare<span class="token punctuation">.</span><span class="token function">get_hist_data</span><span class="token punctuation">(</span><span class="token string">"600680"</span><span class="token punctuation">)</span>
v <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">90</span><span class="token operator">:</span> <span class="token punctuation">]</span><span class="token punctuation">.</span>volume
v<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span><span class="token string">"kde"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>近三个月，成交量大于200000就可以认为发生了异常（天量，嗯，要注意风险了……）</p> 
<p><img src="https://images2.imgbox.com/96/25/2uzgpi5z_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4c/d5/GADzohiG_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2__53"></a>2. 箱线图分析</h5> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">tushare</span>
from matplotlib <span class="token keyword">import</span> <span class="token namespace">pyplot</span> as plt
 
df <span class="token operator">=</span> tushare<span class="token punctuation">.</span><span class="token function">get_hist_data</span><span class="token punctuation">(</span><span class="token string">"600680"</span><span class="token punctuation">)</span>
v <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">90</span><span class="token operator">:</span> <span class="token punctuation">]</span><span class="token punctuation">.</span>volume
v<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span><span class="token string">"kde"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/af/ab/JPJu3LJW_o.png" alt="在这里插入图片描述"><br> 大体可以知道，该股票在成交量少于20000，或者成交量大于80000，就应该提高警惕啦！</p> 
<h5><a id="3__67"></a>3. 基于距离/密度</h5> 
<p>典型的算法是：“局部异常因子算法-Local Outlier Factor”，该算法通过引入“k-distance，第k距离”、“k-distance neighborhood，第k距离邻域”、“reach-distance，可达距离”、以及“local reachability density，局部可达密度 ”和“local outlier factor，局部离群因子”，来发现异常点。</p> 
<p>用视觉直观的感受一下，如图2，对于C1集合的点，整体间距，密度，分散情况较为均匀一致，可以认为是同一簇；对于C2集合的点，同样可认为是一簇。o1、o2点相对孤立，可以认为是异常点或离散点。现在的问题是，如何实现算法的通用性，可以满足C1和C2这种密度分散情况迥异的集合的异常点识别。LOF可以实现我们的目标。</p> 
<p><img src="https://images2.imgbox.com/bc/61/CTdHk1MW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b4/97/r0mBuoU8_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="4__75"></a>4. 基于划分思想</h5> 
<p>典型的算法是 “孤立森林，Isolation Forest”，其思想是：</p> 
<p>假设我们用一个随机超平面来切割（split）数据空间（data space）, 切一次可以生成两个子空间（想象拿刀切蛋糕一分为二）。之后我们再继续用一个随机超平面来切割每个子空间，循环下去，直到每子空间里面只有一个数据点为止。直观上来讲，我们可以发现那些密度很高的簇是可以被切很多次才会停止切割，但是那些密度很低的点很容易很早的就停到一个子空间了。</p> 
<p>这个的算法流程即是使用超平面分割子空间，然后建立类似的二叉树的过程：</p> 
<p><img src="https://images2.imgbox.com/45/a3/ilrA2PHi_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">numpy</span> as np
<span class="token keyword">import</span> <span class="token namespace">matplotlib<span class="token punctuation">.</span>pyplot</span> as plt
from sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> <span class="token class-name">IsolationForest</span>

rng <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span></span>RandomState</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>

# <span class="token class-name">Generate</span> train data
<span class="token class-name">X</span> <span class="token operator">=</span> <span class="token number">0.3</span> <span class="token operator">*</span> rng<span class="token punctuation">.</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token class-name">X_train</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>r_<span class="token punctuation">[</span><span class="token class-name">X</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">X</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">X</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">X</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span>
# <span class="token class-name">Generate</span> some regular novel observations
<span class="token class-name">X</span> <span class="token operator">=</span> <span class="token number">0.3</span> <span class="token operator">*</span> rng<span class="token punctuation">.</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token class-name">X_test</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>r_<span class="token punctuation">[</span><span class="token class-name">X</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">X</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">X</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">X</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span>
# <span class="token class-name">Generate</span> some abnormal novel observations
<span class="token class-name">X_outliers</span> <span class="token operator">=</span> rng<span class="token punctuation">.</span><span class="token function">uniform</span><span class="token punctuation">(</span>low<span class="token operator">=</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> high<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

# fit the model
clf <span class="token operator">=</span> <span class="token class-name">IsolationForest</span><span class="token punctuation">(</span>max_samples<span class="token operator">=</span><span class="token number">100</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span>rng<span class="token punctuation">)</span>
clf<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span><span class="token class-name">X_train</span><span class="token punctuation">)</span>
y_pred_train <span class="token operator">=</span> clf<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span><span class="token class-name">X_train</span><span class="token punctuation">)</span>
y_pred_test <span class="token operator">=</span> clf<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span><span class="token class-name">X_test</span><span class="token punctuation">)</span>
y_pred_outliers <span class="token operator">=</span> clf<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span><span class="token class-name">X_outliers</span><span class="token punctuation">)</span>

# plot the line<span class="token punctuation">,</span> the samples<span class="token punctuation">,</span> and the nearest vectors <span class="token keyword">to</span> <span class="token namespace">the</span> plane
xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">meshgrid</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token class-name">Z</span> <span class="token operator">=</span> clf<span class="token punctuation">.</span><span class="token function">decision_function</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span><span class="token function">ravel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span><span class="token function">ravel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token class-name">Z</span> <span class="token operator">=</span> <span class="token class-name">Z</span><span class="token punctuation">.</span><span class="token function">reshape</span><span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"IsolationForest"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">contourf</span><span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> <span class="token class-name">Z</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token class-name"><span class="token namespace">plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span></span>Blues_r</span><span class="token punctuation">)</span>

b1 <span class="token operator">=</span> plt<span class="token punctuation">.</span><span class="token function">scatter</span><span class="token punctuation">(</span><span class="token class-name">X_train</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">X_train</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token char">'white'</span><span class="token punctuation">)</span>
b2 <span class="token operator">=</span> plt<span class="token punctuation">.</span><span class="token function">scatter</span><span class="token punctuation">(</span><span class="token class-name">X_test</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">X_test</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token char">'green'</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> plt<span class="token punctuation">.</span><span class="token function">scatter</span><span class="token punctuation">(</span><span class="token class-name">X_outliers</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">X_outliers</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token char">'red'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">axis</span><span class="token punctuation">(</span><span class="token char">'tight'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">xlim</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">ylim</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token punctuation">[</span>b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token punctuation">[</span><span class="token string">"training observations"</span><span class="token punctuation">,</span>
            <span class="token string">"new regular observations"</span><span class="token punctuation">,</span> <span class="token string">"new abnormal observations"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           loc<span class="token operator">=</span><span class="token string">"upper left"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/9f/ceaTBVqn_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_130"></a>建模资料</h2> 
<p><strong>资料分享: 最强建模资料</strong><br> <img src="https://images2.imgbox.com/22/fa/ZyQeoBZ7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/12/76/dAD1oRtB_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e4fc53743a6d1d433962f86c6633f51f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mac中安装JDK1.8和JDK11双版本并任意切换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9ccc18b658c3ee750c28453b8ad54cff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Redis--Geo指令的语法和使用场景举例（附近的人功能）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>