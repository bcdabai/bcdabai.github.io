<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NLP(V)：实战分析推特及若干网站文本 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NLP(V)：实战分析推特及若干网站文本" />
<meta property="og:description" content="NLP(V)：实战分析推特及若干新闻网站文本 wiki词条分析 获得数据 这里我们使用beautifulsoup爬取wiki网页。首先安装requests。
pip install requests 然后爬取网页。
以下是一些将使用的小函数。
import requests from bs4 import BeautifulSoup import time # for setting up a delay on getting htmls from wiki server. from tqdm import tqdm # First, get the page info from wiki server given an URL. def getPageFromWiki(url): # return a soup object with the specified URL req = requests.get(url) soup = BeautifulSoup(req.content, &#39;html.parser&#39;) return soup # Second, get the title of the wiki page def getHeading(soup): heading = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/576c64d6272746115727d6f69ab70d4c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-14T17:36:40+08:00" />
<meta property="article:modified_time" content="2023-03-14T17:36:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NLP(V)：实战分析推特及若干网站文本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="NLPV_0"></a>NLP(V)：实战分析推特及若干新闻网站文本</h2> 
<h4><a id="wiki_1"></a>wiki词条分析</h4> 
<h5><a id="_2"></a>获得数据</h5> 
<p>这里我们使用beautifulsoup爬取wiki网页。首先安装requests。</p> 
<pre><code class="prism language-py">pip install requests
</code></pre> 
<p>然后爬取网页。<br> 以下是一些将使用的小函数。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">import</span> time <span class="token comment"># for setting up a delay on getting htmls from wiki server.</span>
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm

<span class="token comment"># First, get the page info from wiki server given an URL.</span>
<span class="token keyword">def</span> <span class="token function">getPageFromWiki</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
  
  <span class="token comment"># return a soup object with the specified URL</span>
  req <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>req<span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> soup

<span class="token comment"># Second, get the title of the wiki page</span>
<span class="token keyword">def</span> <span class="token function">getHeading</span><span class="token punctuation">(</span>soup<span class="token punctuation">)</span><span class="token punctuation">:</span>

  heading <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token comment"># return the title of the wiki page with the soup object initiated from getPageFromWiki</span>

  heading <span class="token operator">=</span> soup<span class="token punctuation">.</span>title<span class="token punctuation">.</span>string

  <span class="token keyword">return</span> heading

<span class="token comment"># Third, get the article part of the wiki page </span>
<span class="token keyword">def</span> <span class="token function">getContent</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>
  
  content <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token comment"># return the article part of the wiki page with the soup object initiated from getPageFromWiki</span>
  <span class="token comment"># since there are multiple paragraphs, merge them together into one long string.</span>
  paras <span class="token operator">=</span> page<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> para <span class="token keyword">in</span> paras<span class="token punctuation">:</span>
    <span class="token keyword">for</span> string <span class="token keyword">in</span> para<span class="token punctuation">.</span>stripped_strings<span class="token punctuation">:</span>
      content <span class="token operator">=</span> content <span class="token operator">+</span> string

  <span class="token keyword">return</span> content

<span class="token comment"># Fourth, get the links that the article part mentioned and specifically, linking to other wiki pages.</span>
<span class="token keyword">def</span> <span class="token function">getLinks</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span>

  linksDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token comment"># return the links mentioned in article part of the wiki page with the soup object initiated from getPageFromWiki</span>
  <span class="token comment"># return a dictionary, with keys are the titles of the linked pages, and the values are the links.</span>
  paras <span class="token operator">=</span> page<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> para <span class="token keyword">in</span> paras<span class="token punctuation">:</span>
    <span class="token keyword">for</span> link <span class="token keyword">in</span> para<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> href<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        link_value <span class="token operator">=</span> link<span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> link_value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">:</span>
          linksDict<span class="token punctuation">[</span>link<span class="token punctuation">.</span>string<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'https://en.wikipedia.org'</span> <span class="token operator">+</span> link_value


  <span class="token keyword">return</span> linksDict
</code></pre> 
<p>现在我们可以爬取某一条目的wiki了：</p> 
<pre><code class="prism language-py">pageDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

page <span class="token operator">=</span> getPageFromWiki<span class="token punctuation">(</span><span class="token string">'https://en.wikipedia.org/wiki/Pok%C3%A9mon'</span><span class="token punctuation">)</span> <span class="token comment"># scrap the main page we want. </span>
header <span class="token operator">=</span> getHeading<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
content <span class="token operator">=</span> getContent<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
pageDict<span class="token punctuation">[</span>header<span class="token punctuation">]</span> <span class="token operator">=</span> content
<span class="token keyword">print</span><span class="token punctuation">(</span>pageDict<span class="token punctuation">)</span>

linksDict <span class="token operator">=</span> getLinks<span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token comment"># get the links contained in the article part of the page.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a set of {} links are found."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>linksDict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> title <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>linksDict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># set up a loop to , set a delay at each iteration</span>
  url <span class="token operator">=</span> linksDict<span class="token punctuation">[</span>title<span class="token punctuation">]</span>
  page <span class="token operator">=</span> getPageFromWiki<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  header <span class="token operator">=</span> getHeading<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
  content <span class="token operator">=</span> getContent<span class="token punctuation">(</span>page<span class="token punctuation">)</span>
  pageDict<span class="token punctuation">[</span>header<span class="token punctuation">]</span> <span class="token operator">=</span> content
  time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># Remember to set a delay &gt;=1 second so you won't break the server.</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a size of {} content dictionary is built."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>pageDict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出如下：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">{<!-- --></span><span class="token string">'Pokémon - Wikipedia'</span><span class="token builtin class-name">:</span> <span class="token string">'Pokémon[a][1][2][3](an abbreviation forPocket Monsters[b]inJapan) is a Japanesemedia franchisemanaged byThe Pokémon Company, a company founded byNintendo,Game Freak, andCreatures. The franchise was created bySatoshi Tajiriin 1996,[4]and is centered on fictional creatures called"Pokémon". InPokémon, humans, known as Pokémon Trainers, catch and train Pokémon to battle other Pokémon for sport. All media works within the franchise are set in thePokémon universe. The Englishsloganfor the franchise is "Gotta Catch ‘Em All!".[5][6]There are currently 920Pokémon species.[7]The franchise began asPocket Monsters: RedandGreen(later released outside of Japan asPokémon RedandBlue), a pair of video games for the originalGame Boyhandheld system that were developed by Game Freak and published by Nintendo in February 1996. It soon became amedia mixfranchise adapted into various different media.[8]Pokémonis estimated to be thehighest-grossing media franchiseof all time. ThePokémon video game seriesis the thirdbest-selling video game franchiseof all time with more than440 millioncopies sold[9]and onebillionmobile downloads.[10]The Pokémon video game series spawned ananime television seriesthat has become the most successfulvideo game adaptationof all time[11]withover 20 seasons and 1,000 episodesin 192 countries.[9]ThePokémon Trading Card Gameis the highest-sellingtrading card gameof all time[12]with over 43.2billion cards sold. In addition, thePokémonfranchise includes the world\'</span>s top-selling toy brand,<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span>ananime film series, a live-action film <span class="token punctuation">(</span>Detective Pikachu<span class="token punctuation">)</span>,books,manga comics,music, merchandise, and atemporary theme park. The franchise is also represented <span class="token keyword">in</span> other Nintendo media, such as theSuper Smash Bros.series, where variousPokémoncharacters are playable.In <span class="token number">1998</span>, Nintendo spent <span class="token variable">$25</span> million promoting Pokémon <span class="token keyword">in</span> the United States <span class="token keyword">in</span> partnership withHasbro,KFC, and others.<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span>Nintendo initially feared that Pokémon was too Japanese <span class="token keyword">for</span> Western tastes butAlfred Kahn, <span class="token keyword">then</span> CEO of 4Kids Entertainment convinced the company otherwise.<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span>The one <span class="token function">who</span> spotted Pokémon<span class="token punctuation">\</span>'s potential <span class="token keyword">in</span> the United States was Kahn<span class="token punctuation">\</span>'s colleague Thomas Kenney.<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span>In November <span class="token number">2005</span>,4Kids Entertainment, <span class="token function">which</span> had managed the non-game related licensing ofPokémon, announced that it had agreed not to renew thePokémonrepresentation agreement. The Pokémon Company International oversees allPokémonlicensing outside Asia.<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span>In <span class="token number">2006</span>, the franchise celebrated its tenth anniversary.<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span>In <span class="token number">2016</span>, the Pokémon Company celebratedPokémon<span class="token punctuation">\</span>'s 20th anniversary by airing an ad duringSuper Bowl 50in January and re-releasing the firstPokémonvideo games <span class="token number">1996</span> Game Boy gamesPokémon Red, Green<span class="token punctuation">(</span>only <span class="token keyword">in</span> Japan<span class="token punctuation">)</span>, andBlue,and the <span class="token number">1998</span> Game Boy Color gamePokémon Yellowfor theNintendo 3DSon February <span class="token number">26</span>, <span class="token number">2016</span>.<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span>The mobileaugmented realitygamePokémon Gowas released <span class="token keyword">in</span> July <span class="token number">2016</span>.<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span>The first live-action film <span class="token keyword">in</span> the franchise,Pokémon Detective Pikachu, based on the <span class="token number">2018</span> Nintendo 3DS spin-off gameDetective Pikachu, was released <span class="token keyword">in</span> <span class="token number">2019</span>.<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span>The eighth generation of core series games began withPokémon Sword and Shield, released worldwide on theNintendo Switchon November <span class="token number">15</span>, <span class="token number">2019</span>.To celebrate its25th anniversary, the company released two additional titles <span class="token keyword">for</span> the Nintendo Switch:Pokémon Brilliant DiamondandShining Pearl, remakes of theNintendo DSPokémon DiamondandPearlgames, on November <span class="token number">19</span>, <span class="token number">2021</span>, and its <span class="token string">"premake"</span>Pokémon Legends: Arceus, <span class="token function">which</span> was subsequently released on January <span class="token number">28</span>, <span class="token number">2022</span>.<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span>The <span class="token function">most</span> recent games <span class="token keyword">in</span> the main series,Pokémon ScarletandVioletbegan the ninth and latest generation and will be released worldwide <span class="token keyword">for</span> the Nintendo Switch <span class="token keyword">in</span> late <span class="token number">2022</span>.The namePokémonis asyllabic abbreviationof the Japanese brandPocket Monsters.<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span>The term <span class="token string">"Pokémon"</span>, <span class="token keyword">in</span> addition to referring to thePokémonfranchise itself, also collectively refers to themany fictional speciesthat have made appearances inPokémonmedia as of the release of the eighth generation titlesPokémon Sword and Shield. <span class="token string">"Pokémon"</span> isidentical <span class="token keyword">in</span> the singular and plural, as is each individual species name<span class="token punctuation">;</span> it is and would be grammatically correct to say <span class="token string">"one Pokémon"</span> and <span class="token string">"many Pokémon"</span>, as well as <span class="token string">"onePikachu"</span> and <span class="token string">"many Pikachu"</span>.<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span>Pokémonexecutive directorSatoshi Tajirifirst thought ofPokémon, albeit with a different concept and name, around <span class="token number">1989</span>, when theGame Boywas released. The concept of thePokémon universe, <span class="token keyword">in</span> both the video games and the general fictional world ofPokémon, stems from the hobby ofinsect collecting, a popular pastime <span class="token function">which</span> Tajiri enjoyed as a child.<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span>Players are designated asPokémon Trainersand have three general goals: to complete the regionalPokédexby collecting all of the available Pokémon species found <span class="token keyword">in</span> the fictional region where a game takes place, to complete the national Pokédex by transferring Pokémon from other regions, and to train a team of powerful Pokémon from those they have caught to compete against teams owned by other Trainers so they may eventually win the Pokémon League and become the regional Champion. These themes of collecting, training, and battling are present <span class="token keyword">in</span> almost every version of the Pokémon franchise, including thevideo games, theanimeand manga series, and thePokémon Trading Card Game<span class="token punctuation">(</span>also known asTCG<span class="token punctuation">)</span>.In <span class="token function">most</span> incarnations of thePokémonuniverse, a Trainer <span class="token function">who</span> encounters a wild Pokémon has the ability to capture that Pokémon by throwing a specially designed, mass-producible spherical tool called aPoké Ballat it. If the Pokémon is unable to escape the confines of the Poké Ball, it is considered to be under the ownership of that Trainer. Afterwards, it will obey whatever commands it receives from its new Trainer, unless the Trainer demonstrates such a lack of experience that the Pokémon would rather act on its own accord. Trainers can send out any of their Pokémon to wage non-lethal battles against other Pokémon<span class="token punctuation">;</span> <span class="token keyword">if</span> the opposing Pokémon is wild, the Trainer can capture that Pokémon with a Poké Ball, increasing their collection of creatures. InPokémon Go, and inPokémon: Let<span class="token punctuation">\</span>'s Go, Pikachu<span class="token operator">!</span>andLet<span class="token punctuation">\</span>'s Go, Eevee<span class="token operator">!</span>, wild Pokémon encountered by players can be caught <span class="token keyword">in</span> Poké Balls, but <span class="token function">most</span> cannot be battled. Pokémon already owned by other Trainers cannot be captured, except under special circumstances <span class="token keyword">in</span> certain side games. If a Pokémon fully defeats an opponent <span class="token keyword">in</span> battle so that the opponent is knocked out <span class="token punctuation">(</span><span class="token string">"faints"</span><span class="token punctuation">)</span>, the winning Pokémon gainsexperience pointsand maylevel up. Beginning withPokémon XandY, experience points are also gained from catching Pokémon <span class="token keyword">in</span> Poké Balls. When leveling up, the Pokémon<span class="token punctuation">\</span>'s battling <span class="token function">aptitude</span> statistics <span class="token punctuation">(</span><span class="token string">"stats"</span>, such as <span class="token string">"Attack"</span> and <span class="token string">"Speed"</span><span class="token punctuation">)</span> increase. At certain levels, the Pokémon may also learn newmoves, <span class="token function">which</span> are techniques used <span class="token keyword">in</span> battle. In addition, many species of Pokémon can undergo a form ofmetamorphosisand transform into a similar but stronger species of Pokémon, a process calledevolution<span class="token punctuation">;</span> this process occurs spontaneously under differing circumstances, and is itself a central theme of the series. Some species of Pokémon may undergo a maximum of two evolutionary transformations, <span class="token keyword">while</span> others may undergo only one, and others may not evolve at all. For example, the Pokémon Pichu may evolve into Pikachu, <span class="token function">which</span> <span class="token keyword">in</span> turn may evolve into Raichu, following <span class="token function">which</span> no further evolutions may occur.Pokémon XandYintroduced the concept of <span class="token string">"Mega Evolution,"</span> by <span class="token function">which</span> certain fully evolved Pokémon may temporarily undergo an additional evolution into a stronger form <span class="token keyword">for</span> the purpose of battling<span class="token punctuation">;</span> this evolution is considered a special case, and unlike other evolutionary stages, is reversible.In the main series, each game<span class="token punctuation">\</span>'s single-player mode requires the Trainer to raise a team of Pokémon to defeat manynon-player character<span class="token punctuation">(</span>NPC<span class="token punctuation">)</span> Trainers and their Pokémon. Each game lays out a somewhat linear path through a specific region of thePokémonworld <span class="token keyword">for</span> the Trainer to journey through, completing events and battling opponents along the way <span class="token punctuation">(</span>including foiling the plans of anevilteam of Pokémon Trainers <span class="token function">who</span> serve as antagonists to the player<span class="token punctuation">)</span>. ExcludingPokémon SunandMoonandPokémon Ultra SunandUltra Moon, the games feature eight powerful Trainers, referred to asGym Leaders, that the Trainer must defeat <span class="token keyword">in</span> order to progress. As a reward, the Trainer receives a Gym Badge, and once all eight badges are collected, the Trainer is eligible to challenge the region<span class="token punctuation">\</span>'s Pokémon League, where four talented trainers <span class="token punctuation">(</span>referred to collectively as the <span class="token string">"Elite Four"</span><span class="token punctuation">)</span> challenge the Trainer to four Pokémon battles <span class="token keyword">in</span> succession. If the trainer can overcome this gauntlet, they must challenge the Regional Champion, the master Trainer <span class="token function">who</span> had previously defeated the Elite Four. Any Trainer <span class="token function">who</span> wins this last battle becomes the new champion.Pokémonis <span class="token builtin class-name">set</span> <span class="token keyword">in</span> the fictionalPokémonuniverse. There are numerous regions that have appeared <span class="token keyword">in</span> the various media of thePokémonfranchise. There are <span class="token number">8</span> main series regions <span class="token builtin class-name">set</span> <span class="token keyword">in</span> the main series games: Kanto, Johto, Hoenn, Sinnoh/Hisui, Unova, Kalos, Alola, and Galar. Each of the eight generations of the main series releases focuses on a new region. Every region consists of several cities and towns that the player must explore <span class="token keyword">in</span> order to overcome many waiting challenges, such asGyms,Contestsandvillainous teams. At different locations within each region, the player can <span class="token function">find</span> different types of Pokémon, as well as helpful items and characters. Different regions are not accessible from one another at all within a single game, only with the exception of Kanto and Johto being linked together inPokémon Gold,Silver,Crystal,HeartGoldandSoulSilverversions. There are also regions <span class="token builtin class-name">set</span> inspinoffgames and two islands <span class="token keyword">in</span> thePokémonanime<span class="token punctuation">(</span>Orange Islands and Decolore Islands<span class="token punctuation">)</span>, all still <span class="token builtin class-name">set</span> within the samefictional universe.Each main series region <span class="token keyword">in</span> thePokémonuniverse is based on a real world location. The first four regions introduced are based off of locations inJapan, beingKantō,Kansai,Kyushu, andHokkaidō, with later regions being based on parts onNew York City,France,Hawaii, theUnited Kingdom, and theIberian Peninsula.<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span>All of the licensedPokémonproperties overseen bythe Pokémon Company Internationalare divided roughly by generation. These generations are roughlychronologicaldivisions by release<span class="token punctuation">;</span> every several years, when a sequel to the 1996role-playing video gamesPokémon RedandGreenis released that features new Pokémon, characters, and gameplay concepts, that sequel is considered the start of a new generation of the franchise. ThemainPokémonvideo gamesand their spin-offs, the anime, manga, and trading card game are all updated with the new Pokémon properties each <span class="token function">time</span> a new generation begins.<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span>Some Pokémon from the newer games appear <span class="token keyword">in</span> anime episodes or films months, or even years, before the game they were programmed <span class="token keyword">for</span> came out. The first generation began <span class="token keyword">in</span> Japan withPokémon RedandGreenon the Game Boy. As of <span class="token number">2022</span>, there are nine generations of main series video games. The <span class="token function">most</span> recent games <span class="token keyword">in</span> the main series,Pokémon ScarletandVioletbegan the ninth and latest generation and will be released worldwide <span class="token keyword">for</span> the Nintendo Switch on November <span class="token number">18</span>, <span class="token number">2022</span>.<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span>Kanto regionJohto regionKanto regionHoenn regionKanto regionSinnoh regionJohto regionKanto regionUnova regionKalos regionHoenn regionAlola regionKanto regionGalar regionSinnoh/Hisui regionPaldea regionPokémon, also known asPokémon the Seriesto Western audiences since the year <span class="token number">2013</span>, is an anime television series based on thePokémonvideo game series. It was originally broadcast onTV Tokyoin <span class="token number">1997</span>. More than <span class="token number">1,000</span> episodes of the anime has been produced and aired,<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span>divided into <span class="token number">7</span> series <span class="token keyword">in</span> Japan and <span class="token number">22</span> seasons internationally. It is one of the longest currently running anime series.<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span>The anime follows the quest of the main character,Ash Ketchum<span class="token punctuation">(</span>known as Satoshi <span class="token keyword">in</span> Japan<span class="token punctuation">)</span>, a Pokémon Master <span class="token keyword">in</span> training, as he and a small group of friends travel around the world of Pokémon along with their Pokémon partners.<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span>Various children<span class="token punctuation">\</span>'s books, collectively known asPokémon Junior, are also based on the anime.<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span>An eight part anime series calledPokémon: Twilight Wingsaired on YouTube <span class="token keyword">in</span> <span class="token number">2020</span>.<span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span>The series was animated byStudio Colorido.<span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span>In July <span class="token number">2021</span>, it was announced that a live action Pokémon series is <span class="token keyword">in</span> early development at Netflix withJoe Hendersonattached to <span class="token function">write</span> and executive produce.<span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span>An eight part anime series <span class="token keyword">in</span> celebration of the Pokémon 25th anniversary calledPokémon Evolutionsaired onYouTubein <span class="token number">2021</span>.<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span>There have been <span class="token number">23</span> animated theatricalPokémonfilms<span class="token punctuation">(</span>latest film to be released on December <span class="token number">25</span>, <span class="token number">2020</span><span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">)</span>, <span class="token function">which</span> have been directed byKunihiko Yuyamaand Tetsuo Yajima, and distributed <span class="token keyword">in</span> Japan byTohosince <span class="token number">1998</span>. The pair of films,Pokémon the Movie: Black—Victini and ReshiramandWhite—Victini and Zekromare considered together as one film. Collectibles, such as promotional trading cards, have been available with some of the films. Since the20th film, the films have been <span class="token builtin class-name">set</span> <span class="token keyword">in</span> an alternate continuity separate from the anime series.PokémonCDs have been released <span class="token keyword">in</span> North America, some of them <span class="token keyword">in</span> conjunction with the theatrical releases of the first three and the 20thPokémonfilms. These releases were commonplace <span class="token keyword">until</span> late <span class="token number">2001</span>. On March <span class="token number">27</span>, <span class="token number">2007</span>, a tenth anniversary CD was released containing <span class="token number">18</span> tracks from the English dub<span class="token punctuation">;</span> this was the first English-language release <span class="token keyword">in</span> over five years. Soundtracks of thePokémonfeature films have been released <span class="token keyword">in</span> Japan each year <span class="token keyword">in</span> conjunction with the theatrical releases. In <span class="token number">2017</span>, a soundtrack album featuring music from the North American versions of the 17th through 20th movies was released<span class="token punctuation">..</span>mw-parser-output .citation<span class="token punctuation">{<!-- --></span>word-wrap:break-word<span class="token punctuation">}</span>.mw-parser-output .citation:target<span class="token punctuation">{<!-- --></span>background-color:rgba<span class="token punctuation">(</span><span class="token number">0,127</span>,255,0.133<span class="token punctuation">)</span><span class="token punctuation">}</span>^The exact <span class="token function">date</span> of release is unknown.^Featuring music fromPokémon the Movie: Diancie and the Cocoon of Destruction,Pokémon the Movie: Hoopa and the Clash of Ages,Pokémon the Movie: Volcanion and the Mechanical Marvel, andPokémon the Movie: I Choose You<span class="token operator">!</span>The Pokémon Trading Card Game <span class="token punctuation">(</span>TCG<span class="token punctuation">)</span> is acollectible card gamewith a goal similar to a Pokémon battle <span class="token keyword">in</span> the video game series. Players use Pokémon cards, with individual strengths and weaknesses, <span class="token keyword">in</span> an attempt to defeat their opponent by <span class="token string">"knocking out"</span> their Pokémon cards.<span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span>The game was published <span class="token keyword">in</span> North America byWizards of the Coastin <span class="token number">1999</span>.<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span>With the release of theGame Boy Advancevideo gamesPokémon RubyandSapphire, the Pokémon Company took back the card game from Wizards of the Coast and started publishing the cards themselves.<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span>The Expedition expansion introduced thePokémon-e Trading Card Game, where the cards <span class="token punctuation">(</span>for the <span class="token function">most</span> part<span class="token punctuation">)</span> were compatible with theNintendo e-Reader. Nintendo discontinued its production of e-Reader compatible cards with the release ofFireRedandLeafGreen. In <span class="token number">1998</span>, Nintendo released a Game Boy Color version of the trading card game <span class="token keyword">in</span> Japan<span class="token punctuation">;</span>Pokémon Trading Card Gamewas subsequently released to the US and Europe <span class="token keyword">in</span> <span class="token number">2000</span>. The game included digital versions of cards from the original <span class="token builtin class-name">set</span> of cards and the first two expansions <span class="token punctuation">(</span>Jungle and Fossil<span class="token punctuation">)</span>, as well as several cards exclusive to the game. A sequel was released <span class="token keyword">in</span> Japan <span class="token keyword">in</span> <span class="token number">2001</span>.<span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span>There are various Pokémonmangaseries, four of <span class="token function">which</span> were released <span class="token keyword">in</span> English byViz Media, and seven of them released <span class="token keyword">in</span> English byChuang Yi. The manga series vary from game-based series to being based on the anime and the Trading Card Game. Original stories have also been published. As there are several series created by different authors, mostPokémonmanga series differ greatly from each other and other media, such as the anime.<span class="token punctuation">[</span>example  needed<span class="token punctuation">]</span>Pokémon Pocket MonstersandPokémon Adventuresare the two manga <span class="token keyword">in</span> production since the first generation.APokémon-styledMonopolyboard gamewas released <span class="token keyword">in</span> August <span class="token number">2014</span>.<span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span>In July <span class="token number">2021</span>, it was announced that a live-actionPokémonseries is reportedly <span class="token keyword">in</span> development atNetflix. Joe Henderson, showrunner ofLucifer, is signed on as writer and executive producer.<span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span>Pokémonhas been criticized by somefundamentalist Christiansover perceivedoccultandviolentthemes and the concept of <span class="token string">"Pokémon evolution"</span>, <span class="token function">which</span> they feel goes against the Biblical creation account <span class="token keyword">in</span> Genesis.<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span>Sat2000, a satellite television station based inVatican City, has countered that the Pokémon Trading Card Game and video games are <span class="token string">"full of inventive imagination"</span> and have no <span class="token string">"harmful moral side effects"</span>.<span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span>In the United Kingdom, the <span class="token string">"Christian Power Cards"</span> game was introduced <span class="token keyword">in</span> <span class="token number">1999</span> by David Tate <span class="token function">who</span> stated, <span class="token string">"Some people aren\'t happy with Pokémon and want an alternative, others just want Christian games."</span> The game was similar to the Pokémon Trading Card Game but used Biblical figures.<span class="token punctuation">[</span><span class="token number">65</span><span class="token punctuation">]</span>In <span class="token number">1999</span>, Nintendo stopped manufacturing the Japanese version of the <span class="token string">"Koga\'s Ninja Trick"</span> trading card because it depicted amanji, a traditionallyBuddhistsymbol with no negative connotations. TheJewishcivil rights groupAnti-Defamation Leaguecomplained because the symbol is the reverse of aswastika, aNazisymbol. The cards were intended <span class="token keyword">for</span> <span class="token for-or-select variable">sale</span> <span class="token keyword">in</span> Japan only, but the popularity ofPokémonled to <span class="token function">import</span> into the United States with approval from Nintendo. The Anti-Defamation League understood that the portrayed symbol was not intended to offend and acknowledged the sensitivity that Nintendo showed by removing the product.<span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">67</span><span class="token punctuation">]</span>In <span class="token number">1999</span>, two nine-year-old boys fromMerrick, New York, sued Nintendo because they claimed the Pokémon Trading Card Game caused theirproblematic gambling.<span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span>In <span class="token number">2001</span>,Saudi ArabiabannedPokémongames and the trading cards, alleging that the franchise promotedZionismby displaying theStar of Davidin the trading cards <span class="token punctuation">(</span>theColorless energyfrom thePokémon Trading Card Gameresembles a six-pointed star<span class="token punctuation">)</span> as well as other religious symbols such ascrossesthey associated with Christianity and triangles they associated withFreemasonry<span class="token punctuation">;</span> the games also involved gambling, <span class="token function">which</span> is <span class="token keyword">in</span> violation ofMuslimdoctrine.<span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span>Pokémonhas also been accused of promotingmaterialism.<span class="token punctuation">[</span><span class="token number">71</span><span class="token punctuation">]</span>In <span class="token number">2012</span>,PETAcriticized the concept ofPokémonas supportingcruelty to animals. PETA compared the game<span class="token punctuation">\</span>'s concept, of capturing animals and forcing them to fight, tocockfights,dog fightingrings and circuses, events frequently criticized <span class="token keyword">for</span> cruelty to animals. PETA released a game spoofingPokémonwhere the Pokémon battle their trainers to win their freedom.<span class="token punctuation">[</span><span class="token number">72</span><span class="token punctuation">]</span>PETA reaffirmed their objections <span class="token keyword">in</span> <span class="token number">2016</span> with the release ofPokémon Go, promoting the hashtag <span class="token comment">#GottaFreeThemAll.[73]On December 16, 1997, more than 635 Japanese children were admitted to hospitals with epilepticseizures.[74]It was determined the seizures were caused by watching an episode of Pokémon "Dennō Senshi Porygon", (most commonly translated "Electric Soldier Porygon", season 1, episode 38); as a result, this episode has not been aired since. In this particular episode, there were bright explosions with rapidly alternating blue and red color patterns.[75]It was determined in subsequent research that these strobing light effects cause some individuals to have epileptic seizures, even if the person had no previous history ofepilepsy.[76]This incident is a common focus of Pokémon-related parodies in other media, and was lampooned byThe Simpsonsepisode "Thirty Minutes over Tokyo" in a shortcameo[77]and theSouth Parkepisode "Chinpokomon",[78]among others.In March 2000, Morrison Entertainment Group, a toy developer based atManhattan Beach, California, sued Nintendo over claims thatPokémoninfringed on its ownMonster in My Pocketcharacters. A judge ruled there was no infringement and Morrison appealed the ruling. On February 4, 2003, the U.S. Court of Appeals for the Ninth Circuit affirmed the decision by the District Court to dismiss the suit.[79]Within its first two days of release,Pokémon Goraised safety concerns among players. Multiple people also suffered minor injuries from falling while playing the game due to being distracted.[80]Multiple police departments in various countries have issued warnings, sometongue-in-cheek, regarding inattentive driving, trespassing, and being targeted by criminals due to being unaware of one\'s surroundings.[81][82]People have suffered various injuries from accidents related to the game,[83][84][85][86]and Bosnian players have been warned to stay out of minefields left over from the 1990sBosnian War.[87]On July 20, 2016, it was reported that an 18-year-old boy inChiquimula,Guatemala, was shot and killed while playing the game in the late evening hours. This was the first reported death in connection with the app. The boy\'s 17-year-old cousin, who was accompanying the victim, was shot in the foot. Police speculated that the shooters used the game\'s GPS capability to find the two.[88]Pokémon, being a globally popular franchise, has left a significant mark on today\'spopular culture. Thevarious species ofPokémonhave become pop culture icons; examples include two different Pikachu balloons in theMacy\'s Thanksgiving Day Parade,Pokémon-themed airplanes operated by All Nippon Airways, merchandise items, and atraveling theme parkthat was inNagoya, Japanin 2005 and inTaipeiin 2006.Pokémonalso appeared on the cover of the U.S. magazineTimein 1999.[89]The Comedy Central showDrawn Togetherhas a character namedLing-Lingwho is a parody of Pikachu.[90]Several other shows such asThe Simpsons,[91]South Park[92]andRobot Chicken[93]have made references and spoofs ofPokémon, among other series.Pokémonwas featured onVH1\'sI Love the \'90s: Part Deux. A live action show based on the anime calledPokémon Live!toured the United States in late 2000.[94]Jim ButchercitesPokémonas one of the inspirations for theCodex Aleraseries of novels.[95]Pokémon has even made its mark in the realm of science. This includes animals named after Pokémon, such asStentorceps weedlei(named after the Pokémon Weedle for its resemblance) andChilicola charizard(named after the PokémonCharizard) as well asBinburrum articuno,Binburrum zapdos, andBinburrum moltres(named after the Pokémon Articuno, Zapdos, and Moltres, respectively).[96][97]There is also a protein named after Pikachu, calledPikachurin.In November 2001, Nintendo opened a store called the Pokémon Center in New York, inRockefeller Center,[98]modeled after the two other Pokémon Center stores in Tokyo andOsakaand named after a staple of the video game series. Pokémon Centers are fictional buildings where Trainers take their injured Pokémon to be healed after combat.[99]The store sold Pokémon merchandise on a total of two floors, with items ranging from collectible shirts to stuffed Pokémonplushies.[100]The store also featured a Pokémon Distributing Machine in which players would place their game to receive an egg of a Pokémon that was being given out at that time. The store also had tables that were open for players of the Pokémon Trading Card Game to duel each other or an employee. The store was closed and replaced by theNintendo World Storeon May 14, 2005.[101]Four Pokémon Center kiosks were put in malls in the Seattle area.[102]The Pokémon Center online store was relaunched on August 6, 2014.[103]Professor of educationJoseph Tobintheorizes that the success of the franchise was due to the long list of names that could be learned by children and repeated in their peer groups. Its rich fictional universe provides opportunities for discussion and demonstration of knowledge in front of their peers. The names of the creatures were linked to its characteristics, which converged with the children\'s belief that names have symbolic power. Children can pick their favourite Pokémon and affirm their individuality while at the same time affirming their conformance to the values of the group, and they can distinguish themselves from others by asserting what they liked and what they did not like from every chapter.Pokémongained popularity because it provides a sense of identity to a wide variety of children, and lost it quickly when many of those children found that the identity groups were too big and searched for identities that would distinguish them into smaller groups.[104][page\xa0needed]Pokémon\'s history has been marked at times by rivalry with theDigimonmedia franchise that debuted at a similar time. Described as "the other \'mon\'" byIGN\'s Juan Castro,Digimonhas not enjoyedPokémon\'s level of international popularity or success, but has maintained a dedicated fanbase.[105]IGN\'s Lucas M. Thomas stated thatPokémonisDigimon\'s "constant competition and comparison", attributing the former\'s relative success to the simplicity of its evolution mechanic as opposed toDigivolution.[106]The two have been noted for conceptual and stylistic similarities by sources such as GameZone.[107]A debate among fans exists over which of the two franchises came first.[108]In actuality, the firstPokémonmedia,Pokémon RedandGreen, were released initially on February 27, 1996;[109]whereas theDigimonvirtual petwas released on June 26, 1997.WhilePokémon\'s target demographic is children, early purchasers ofPokémon Omega RubyandAlpha Sapphirewere in their 20s.[110]Many fans are adults who originally played the games as children and had later returned to the series.[110]Numerousfan sitesexist for the Pokémon franchise, including.mw-parser-output .vanchor&gt;:target~.vanchor-text{background-color:#b1d2ff}Bulbagarden, a site hosting thewiki-based encyclopedia Bulbapedia,[111][112][113]and Serebii,[114]a news and reference website.[115]Large fan communities exist on other platforms, such as thesubredditr/pokemon, which has over 4 million subscribers.[116]Asignificant community around thePokémonvideo games\' metagamehas existed for a long time, analyzing the best ways to use each Pokémon to their full potential in competitive battles. The most prolific competitive community is Smogon University, which has created a widely accepted tier-based battle system.[117]Smogon is affiliated with an onlinePokémongame calledPokémon Showdown, in which players create a team and battle against other players around the world using the competitive tiers created by Smogon.[118]In early 2014, an anonymous video streamer onTwitchlaunchedTwitch PlaysPokémon, a small experiment trying tocrowdsourceplaying subsequentPokémongames, that started with the gamePokémon Redand has since included subsequent games in the series.[119][120]A study at Stanford Neurosciences published inNatureperformed magnetic resonance imaging scans of 11 Pokémon experts and 11 controls, finding that seeing Pokémon stimulated activity in the visual cortex, in a different place than is triggered by recognizing faces, places, or words, demonstrating the brain\'s ability to create such specialized areas.[121][122]A challenge called the Nuzlocke Challenge allows players to only capture the first Pokémon encountered in each area. Using rules from a webcomic originally named "Pokémon Hard-Mode", if they do not succeed in capturing that Pokémon, there are no second chances. When a Pokémon faints, it is considered "dead" and must be released or stored in the PC permanently.[123][124]If the player faints, the game is considered over, and the player must restart.[125]The original idea consisted of 2 to 3 rules that the community has built upon. There are manyfan madePokémongames that contain agame modesimilar to the Nuzlocke Challenge, such asPokémon Uranium.'}</span>
a <span class="token builtin class-name">set</span> of <span class="token number">184</span> links are found.
<span class="token number">100</span>%<span class="token operator">|</span>██████████<span class="token operator">|</span> <span class="token number">184</span>/184 <span class="token punctuation">[</span>04:0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>00:00,  <span class="token number">1</span>.32s/it<span class="token punctuation">]</span>a size of <span class="token number">160</span> content dictionary is built.
</code></pre> 
<p>使用如下代码将数据保存在csv文件中：</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> csv

driveFolderDirectory <span class="token operator">=</span> <span class="token string">'./'</span> <span class="token comment"># if your are not using Google Colab, edit the value directly here.</span>
savedFileName <span class="token operator">=</span> <span class="token string">'wikiContents.csv'</span>
pathToSave <span class="token operator">=</span> driveFolderDirectory <span class="token operator">+</span> savedFileName

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>pathToSave<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
  fieldnames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'idx'</span><span class="token punctuation">,</span><span class="token string">'wikiTitle'</span><span class="token punctuation">,</span> <span class="token string">'wikiContents'</span><span class="token punctuation">]</span>
  writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictWriter<span class="token punctuation">(</span>csvfile<span class="token punctuation">,</span> fieldnames<span class="token operator">=</span>fieldnames<span class="token punctuation">)</span>
  writer<span class="token punctuation">.</span>writeheader<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> i<span class="token punctuation">,</span>wikiContentKey <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>pageDict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'idx'</span><span class="token punctuation">:</span> i<span class="token punctuation">,</span> <span class="token string">'wikiTitle'</span><span class="token punctuation">:</span> wikiContentKey<span class="token punctuation">,</span><span class="token string">'wikiContents'</span><span class="token punctuation">:</span> pageDict<span class="token punctuation">[</span>wikiContentKey<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_107"></a>加载数据</h5> 
<p>我们爬取的数据被存储在csv文件中，下面我们将数据读入到内存。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> sys
<span class="token keyword">import</span> csv
csv<span class="token punctuation">.</span>field_size_limit<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>maxsize<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">loadWikiTexts</span><span class="token punctuation">(</span>csvPath<span class="token punctuation">)</span><span class="token punctuation">:</span>
  wikiRawTextDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csvPath<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictReader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
      wikiRawTextDict<span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token string">'wikiTitle'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'wikiContents'</span><span class="token punctuation">]</span>
  <span class="token keyword">return</span> wikiRawTextDict

<span class="token comment"># Load wiki text data here</span>
wikiRawTextDict <span class="token operator">=</span> loadWikiTexts<span class="token punctuation">(</span><span class="token string">'wikiContents.csv'</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="re_spacy_125"></a>使用re, spacy进行数据预处理</h5> 
<p>安装spacy</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> -U pip setuptools wheel
pip <span class="token function">install</span> -U spacy
python -m spacy download en_core_web_sm
</code></pre> 
<p>使用re去除文本中的参考部分（即被中括号‘【】’括起来的部分），使用spacy进行tokenize和lemmatize，随后将所有字母小写。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> re
<span class="token keyword">import</span> spacy

<span class="token keyword">def</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>wikiTextDict<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Input: a wiki text dictionary with keys are titles and values are the corresponding texts.</span>
  <span class="token comment"># Output: a wiki text dictionary with keys are the titles and the values are the preprocessed texts </span>
  <span class="token comment"># (sentences - tokens).</span>

  <span class="token comment"># sub-task 1: remove all the references texts "[...]"</span>
  <span class="token comment"># sub-task 2: segment all the sentences in the wiki texts.</span>
  <span class="token comment"># sub-task 3: tokenize the sentences from sub-task 2.</span>
  <span class="token comment"># sub-task 4: lemmatize the tokens from sub-task 3.</span>
  <span class="token comment"># sub-task 5: lower-case the tokens from sub-task 3/4.</span>

  <span class="token comment"># You don't need to follow the order of the sub-tasks.</span>
  wikiTextDictPure <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  nlp <span class="token operator">=</span> spacy<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">"en_core_web_sm"</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> wiki_title<span class="token punctuation">,</span> wiki_content_raw <span class="token keyword">in</span> wikiTextDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    pure_tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    wiki_content <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'\[[0-9]+\]'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span>wiki_content_raw<span class="token punctuation">)</span>
    
    doc <span class="token operator">=</span> nlp<span class="token punctuation">(</span>wiki_content<span class="token punctuation">)</span>
    <span class="token keyword">for</span> sent <span class="token keyword">in</span> doc<span class="token punctuation">.</span>sents<span class="token punctuation">:</span>
      sent_tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      sent_doc <span class="token operator">=</span> nlp<span class="token punctuation">(</span>sent<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
      <span class="token keyword">for</span> token <span class="token keyword">in</span> sent_doc<span class="token punctuation">:</span>
        sent_tokens<span class="token punctuation">.</span>append<span class="token punctuation">(</span>token<span class="token punctuation">.</span>text<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      pure_tokens<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sent_tokens<span class="token punctuation">)</span>
    wikiTextDictPure<span class="token punctuation">[</span>wiki_title<span class="token punctuation">]</span> <span class="token operator">=</span> pure_tokens
    

  <span class="token keyword">return</span> wikiTextDictPure

wikiPureTextDict <span class="token operator">=</span> preprocess<span class="token punctuation">(</span>wikiRawTextDict<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_169"></a>建立词典</h5> 
<p>根据之前获得的经过预处理的wiki文本数据，建立一个词典，单词是key，出现频数是value。</p> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">computeFreq</span><span class="token punctuation">(</span>wikiTextDict<span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token comment"># Input: a wiki text dictionary with keys are titles and values are the preprocessed corresponding texts.</span>
  <span class="token comment"># Output: a dictionary with keys are the word types, and the values are the appearance counts of the word types</span>

  freqDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token keyword">for</span> _<span class="token punctuation">,</span> sents <span class="token keyword">in</span> wikiTextDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> sent <span class="token keyword">in</span> sents<span class="token punctuation">:</span>
      <span class="token keyword">for</span> token <span class="token keyword">in</span> sent<span class="token punctuation">:</span>
        <span class="token keyword">if</span> token <span class="token keyword">in</span> freqDict<span class="token punctuation">:</span>
          freqDict<span class="token punctuation">[</span>token<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
          freqDict<span class="token punctuation">[</span>token<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">return</span> freqDict

  <span class="token comment"># Compute the frequency dictionary here.</span>
freqDictWiki <span class="token operator">=</span> computeFreq<span class="token punctuation">(</span>wikiPureTextDict<span class="token punctuation">)</span>

</code></pre> 
<p>这样我们可以知道高频词了：</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> nltk
nltk<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token string">'stopwords'</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> nltk<span class="token punctuation">.</span>corpus <span class="token keyword">import</span> stopwords
<span class="token keyword">def</span> <span class="token function">computeTop20Words</span><span class="token punctuation">(</span>freqDict<span class="token punctuation">)</span><span class="token punctuation">:</span>
  
  <span class="token comment"># Input: a dictionary with keys are the word types, and the values are the appearance counts of the word types</span>
  <span class="token comment"># Output: a list of 20 words that appear most frequently in all the preprocessed scraped texts.</span>

  
  word_freq_list_sorted <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>freqDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  idx <span class="token operator">=</span> <span class="token number">0</span>
  top20 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">,</span><span class="token string">'j'</span><span class="token punctuation">,</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'l'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'n'</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'p'</span><span class="token punctuation">,</span><span class="token string">'q'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span><span class="token string">'s'</span><span class="token punctuation">,</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'u'</span><span class="token punctuation">,</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">,</span><span class="token string">'z'</span><span class="token punctuation">]</span>
  <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>top20<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">20</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>word_freq_list_sorted<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> stopwords<span class="token punctuation">.</span>words<span class="token punctuation">(</span><span class="token string">'english'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> word_freq_list_sorted<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">in</span> chars<span class="token punctuation">:</span>
      top20<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word_freq_list_sorted<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    idx <span class="token operator">+=</span> <span class="token number">1</span>
  <span class="token keyword">return</span> top20
<span class="token comment"># Print your top 20 words here.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>computeTop20Words<span class="token punctuation">(</span>freqDictWiki<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出如下：</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span><span class="token string">'game'</span>, <span class="token string">'nintendo'</span>, <span class="token string">'pokémon'</span>, <span class="token string">'games'</span>, <span class="token string">'also'</span>, <span class="token string">'switch'</span>, <span class="token string">'released'</span>, <span class="token string">'japan'</span>, <span class="token string">'new'</span>, <span class="token string">'first'</span>, <span class="token string">'one'</span>, <span class="token string">'used'</span>, <span class="token string">'company'</span>, <span class="token string">'million'</span>, <span class="token string">'player'</span>, <span class="token string">'players'</span>, <span class="token string">'system'</span>, <span class="token string">'video'</span>, <span class="token string">'would'</span>, <span class="token string">'time'</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>nltk_data<span class="token punctuation">]</span> Downloading package stopwords to /root/nltk_data<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>nltk_data<span class="token punctuation">]</span>   Package stopwords is already up-to-date<span class="token operator">!</span>
</code></pre> 
<h5><a id="_220"></a>生成词云</h5> 
<p>为了更直观地检查词汇分布，我们可以生成词云。<br> 首先安装wordcloud包：</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> wordcloud
</code></pre> 
<p>之后如下操作：</p> 
<pre><code class="prism language-py"><span class="token keyword">from</span> wordcloud <span class="token keyword">import</span> WordCloud<span class="token punctuation">,</span> STOPWORDS
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">def</span> <span class="token function">plotWordCloud</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Input: word cloud image</span>
  <span class="token comment"># Output: (display the cloud image in the output)</span>
  plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>image<span class="token punctuation">)</span> 
  plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  

<span class="token keyword">def</span> <span class="token function">generateWordCloud</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Input: all texts in the scraped wiki data.</span>
  <span class="token comment"># Output: word cloud image.</span>

  wordcloud <span class="token operator">=</span> WordCloud<span class="token punctuation">(</span>width <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> background_color<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> colormap<span class="token operator">=</span><span class="token string">'Set2'</span><span class="token punctuation">,</span> collocations<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> stopwords <span class="token operator">=</span> STOPWORDS<span class="token punctuation">)</span><span class="token punctuation">.</span>generate<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
  <span class="token keyword">return</span> wordcloud


<span class="token comment"># Draw word cloud here</span>
rawText <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> wikiText <span class="token keyword">in</span> wikiRawTextDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  rawText <span class="token operator">+=</span> wikiText

plotWordCloud<span class="token punctuation">(</span>generateWordCloud<span class="token punctuation">(</span>rawText<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出如下：<br> <img src="https://images2.imgbox.com/71/1b/rRaVF4rr_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_256"></a>推特数据分析</h4> 
<h5><a id="_257"></a>预处理</h5> 
<p>这里我们使用与处理wiki相同的方法处理推文数据。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> csv

<span class="token keyword">def</span> <span class="token function">loadTweetTextFromCSV</span><span class="token punctuation">(</span>csvPath<span class="token punctuation">)</span><span class="token punctuation">:</span>
  tweetDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csvPath<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictReader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
      tweetDict<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'idx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'tweetText'</span><span class="token punctuation">]</span>
  <span class="token keyword">return</span> tweetDict

tweetDict <span class="token operator">=</span> loadTweetTextFromCSV<span class="token punctuation">(</span><span class="token string">'./tweetsFishing.csv'</span><span class="token punctuation">)</span>
processedTweetData <span class="token operator">=</span> preprocess<span class="token punctuation">(</span>tweetDict<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="OOVrate_274"></a>计算OOV-rate</h5> 
<p>首先我们计算在推文数据中出现的单词(word type)有多少不在wiki数据中出现：</p> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">computeOOVWordTypes</span><span class="token punctuation">(</span>tweetVocabDict<span class="token punctuation">,</span> wikiVocabDict<span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token comment"># Input: a dictionary of tweet data vocabulary, a dictionary of wiki data vocabulary.</span>
  <span class="token comment"># Output: the ratio of word types in tweets that are out-of-vocabulary w.r.t. wiki vocabulary</span>
  <span class="token comment"># v.s. total number of word types in tweet data.</span>

  <span class="token comment"># The ratio should be in percentage.</span>

  cnt <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">for</span> word<span class="token punctuation">,</span>_ <span class="token keyword">in</span> tweetVocabDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> word <span class="token keyword">not</span> <span class="token keyword">in</span> wikiVocabDict<span class="token punctuation">:</span>
      cnt <span class="token operator">+=</span> <span class="token number">1</span>
  <span class="token keyword">return</span> cnt<span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>tweetVocabDict<span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>computeOOVWordTypes<span class="token punctuation">(</span>computeFreq<span class="token punctuation">(</span>processedTweetData<span class="token punctuation">)</span><span class="token punctuation">,</span> freqDictWiki<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token number">66.0857223956855</span>%
</code></pre> 
<p>请注意，以上代码计算的<strong>不是</strong>正确的OOV rate，正确的计算方法是计算<strong>token</strong>的比率，如下：</p> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">computeOOVWordTokens</span><span class="token punctuation">(</span>tweetVocabDict<span class="token punctuation">,</span> wikiVocabDict<span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token comment"># Input: a dictionary of tweet data vocabulary, a dictionary of wiki data vocabulary. (E.g. computed from task 3)</span>
  <span class="token comment"># Output: the ratio of word tokens in tweets that are out-of-vocabulary w.r.t. wiki vocabulary</span>
  <span class="token comment"># v.s. total number of word tokens in tweet data.</span>
  
  cnt <span class="token operator">=</span> <span class="token number">0</span>
  total <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">for</span> word<span class="token punctuation">,</span>value <span class="token keyword">in</span> tweetVocabDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    total <span class="token operator">+=</span> value
    <span class="token keyword">if</span> word <span class="token keyword">not</span> <span class="token keyword">in</span> wikiVocabDict<span class="token punctuation">:</span>
      cnt <span class="token operator">+=</span> tweetVocabDict<span class="token punctuation">[</span>word<span class="token punctuation">]</span>
  <span class="token keyword">return</span> cnt<span class="token operator">/</span>total



<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>computeOOVWordTokens<span class="token punctuation">(</span>computeFreq<span class="token punctuation">(</span>processedTweetData<span class="token punctuation">)</span><span class="token punctuation">,</span> freqDictWiki<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token number">15.167456297990526</span>%
</code></pre> 
<h4><a id="_320"></a>新闻网站文本分析</h4> 
<h5><a id="_321"></a>爬取数据</h5> 
<p>这里我们爬取ABC news和Fox news的网页，思路与爬取wiki页面一样，代码如下：</p> 
<ol><li>获得网站地图：</li></ol> 
<pre><code class="prism language-py"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

<span class="token comment"># def getPageFromWiki(url): use the getPageFromWiki implemented from the wikipedia section</span>

abcNewsSitemap <span class="token operator">=</span> getPageFromWiki<span class="token punctuation">(</span><span class="token string">'https://abcnews.go.com/xmlLatestVideos'</span><span class="token punctuation">)</span>

<span class="token comment"># A similar one can be found in the Fox news robots.txt, </span>
foxNewsSitemap <span class="token operator">=</span> getPageFromWiki<span class="token punctuation">(</span><span class="token string">'https://www.foxnews.com/sitemap.xml?type=news'</span><span class="token punctuation">)</span> 
</code></pre> 
<ol start="2"><li>获得页面url：</li></ol> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">getUrlList</span><span class="token punctuation">(</span>sitemap<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># This function should return a list of URLs of news contained in the sitemap page.</span>
  url_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  url_raw_list <span class="token operator">=</span> sitemap<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'loc'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> raw_url <span class="token keyword">in</span> url_raw_list<span class="token punctuation">:</span>
    url_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>raw_url<span class="token punctuation">.</span>string<span class="token punctuation">)</span>

  <span class="token keyword">return</span> url_list

foxUrlList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
abcUrlList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

foxUrlList <span class="token operator">=</span> getUrlList<span class="token punctuation">(</span>foxNewsSitemap<span class="token punctuation">)</span>
abcUrlList <span class="token operator">=</span> getUrlList<span class="token punctuation">(</span>abcNewsSitemap<span class="token punctuation">)</span>

<span class="token comment"># Test here if the list contains the URLs you want.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"foxUrlList"</span><span class="token punctuation">,</span>foxUrlList<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"abcUrlList"</span><span class="token punctuation">,</span>abcUrlList<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>foxUrlList<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>abcUrlList<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="3"><li>使用newspaper3k解析页面：<br> 安装newspaper3k：</li></ol> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> newspaper3k
</code></pre> 
<p>解析：</p> 
<pre><code class="prism language-py"><span class="token keyword">from</span> newspaper <span class="token keyword">import</span> Article
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm

<span class="token keyword">def</span> <span class="token function">getNewsDict</span><span class="token punctuation">(</span>url_list<span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token comment"># key should be the news title and value should be the article text of the news.</span>
  newsDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  
  <span class="token keyword">for</span> news_url <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>url_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    article <span class="token operator">=</span> Article<span class="token punctuation">(</span>news_url<span class="token punctuation">)</span>
    article<span class="token punctuation">.</span>download<span class="token punctuation">(</span><span class="token punctuation">)</span>
    article<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token punctuation">)</span>
    newsDict<span class="token punctuation">[</span>article<span class="token punctuation">.</span>title<span class="token punctuation">]</span> <span class="token operator">=</span> article<span class="token punctuation">.</span>text
  
  <span class="token keyword">return</span> newsDict


abcNews <span class="token operator">=</span> getNewsDict<span class="token punctuation">(</span>abcUrlList<span class="token punctuation">)</span>
foxNews <span class="token operator">=</span> getNewsDict<span class="token punctuation">(</span>foxUrlList<span class="token punctuation">)</span>
</code></pre> 
<ol start="4"><li>将数据保存在csv文件中：</li></ol> 
<pre><code class="prism language-py"><span class="token keyword">import</span> csv
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>abcNews<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>foxNews<span class="token punctuation">)</span><span class="token punctuation">)</span>

driveFolderDirectory <span class="token operator">=</span> <span class="token string">'./'</span> <span class="token comment"># if your are not using Google Colab, edit the value directly here.</span>
savedFileName <span class="token operator">=</span> <span class="token string">'newsContents.csv'</span>
pathToSave <span class="token operator">=</span> driveFolderDirectory <span class="token operator">+</span> savedFileName

<span class="token comment"># size check</span>
<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>abcNews<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">100</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>foxNews<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"the size of both news dictionary should be no less than 100. got {} for abc news and {} for fox news instead."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>abcNews<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>foxNews<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>pathToSave<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
  fieldnames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'idx'</span><span class="token punctuation">,</span><span class="token string">'newsSource'</span><span class="token punctuation">,</span><span class="token string">'newsTitle'</span><span class="token punctuation">,</span><span class="token string">'newsContents'</span><span class="token punctuation">]</span>
  writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictWriter<span class="token punctuation">(</span>csvfile<span class="token punctuation">,</span> fieldnames<span class="token operator">=</span>fieldnames<span class="token punctuation">)</span>
  writer<span class="token punctuation">.</span>writeheader<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> i<span class="token punctuation">,</span>newsDictKey <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>abcNews<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'idx'</span><span class="token punctuation">:</span> i<span class="token punctuation">,</span><span class="token string">'newsSource'</span><span class="token punctuation">:</span><span class="token string">'ABCNews'</span><span class="token punctuation">,</span> <span class="token string">'newsTitle'</span><span class="token punctuation">:</span> newsDictKey<span class="token punctuation">,</span><span class="token string">'newsContents'</span><span class="token punctuation">:</span> abcNews<span class="token punctuation">[</span>newsDictKey<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> i<span class="token punctuation">,</span>newsDictKey <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>foxNews<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'idx'</span><span class="token punctuation">:</span> i<span class="token punctuation">,</span><span class="token string">'newsSource'</span><span class="token punctuation">:</span><span class="token string">'FoxNews'</span><span class="token punctuation">,</span> <span class="token string">'newsTitle'</span><span class="token punctuation">:</span> newsDictKey<span class="token punctuation">,</span><span class="token string">'newsContents'</span><span class="token punctuation">:</span> foxNews<span class="token punctuation">[</span>newsDictKey<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_407"></a>读入数据</h5> 
<pre><code class="prism language-py"><span class="token keyword">def</span> <span class="token function">loadNewsTexts</span><span class="token punctuation">(</span>csvPath<span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token comment"># the function returns two dictionaries, one for ABC news text data and one for Fox news text data</span>

  abcNewsRawTextDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  foxNewsRawTextDict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csvPath<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> csvfile<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictReader<span class="token punctuation">(</span>csvfile<span class="token punctuation">)</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">'newsSource'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"ABCNews"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        abcNewsRawTextDict<span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token string">'newsTitle'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'newsContents'</span><span class="token punctuation">]</span>
      <span class="token keyword">else</span><span class="token punctuation">:</span>
        foxNewsRawTextDict<span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token string">'newsTitle'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'newsContents'</span><span class="token punctuation">]</span>

  <span class="token keyword">return</span> abcNewsRawTextDict<span class="token punctuation">,</span>foxNewsRawTextDict

abcNewsDict<span class="token punctuation">,</span>foxNewsDict <span class="token operator">=</span> loadNewsTexts<span class="token punctuation">(</span><span class="token string">'./newsContents.csv'</span><span class="token punctuation">)</span>

</code></pre> 
<h5><a id="_428"></a>数据预处理</h5> 
<p>这里我们在预处理后顺便画一个条形图来看看词汇的分布情况。</p> 
<pre><code class="prism language-py"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">def</span> <span class="token function">plotHistogram</span><span class="token punctuation">(</span>wordType<span class="token punctuation">,</span>wordTokens<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># Input: a list of word types, a list of word token counts to the corresponding word types</span>
  <span class="token comment"># Output: (display the histogram of word count from a news source)</span>

  <span class="token comment"># X-axis should be (indexes) of the word type, and Y-axis should be the word counts of the word type.</span>
  plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>wordType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wordTokens<span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>wordType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wordType<span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">270</span><span class="token punctuation">)</span>
  plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
  

<span class="token comment"># Preprocess the news data.</span>
preprocessedAbcDict <span class="token operator">=</span> preprocess<span class="token punctuation">(</span>abcNewsDict<span class="token punctuation">)</span>
preprocessedFoxDict <span class="token operator">=</span> preprocess<span class="token punctuation">(</span>foxNewsDict<span class="token punctuation">)</span>

<span class="token comment"># Compute word type list and the word token list.</span>
abcFreqDict <span class="token operator">=</span> computeFreq<span class="token punctuation">(</span>preprocessedAbcDict<span class="token punctuation">)</span>
foxFreqDict <span class="token operator">=</span> computeFreq<span class="token punctuation">(</span>preprocessedFoxDict<span class="token punctuation">)</span>

sortedAbc <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>abcFreqDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
abcWords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
abcFreqs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> p <span class="token keyword">in</span> sortedAbc<span class="token punctuation">:</span>
  abcWords<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  abcFreqs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

sortedFox <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>foxFreqDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
foxWords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
foxFreqs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> p <span class="token keyword">in</span> sortedFox<span class="token punctuation">:</span>
  foxWords<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  foxFreqs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Plot the histogram here.</span>

plotHistogram<span class="token punctuation">(</span>abcWords<span class="token punctuation">,</span> abcFreqs<span class="token punctuation">)</span>
plotHistogram<span class="token punctuation">(</span>foxWords<span class="token punctuation">,</span> foxFreqs<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c2/8a/wfpExK2e_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ba/6a/OOCVrvAm_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_472"></a>绘制词云</h5> 
<p>利用之前的函数，绘制词云：</p> 
<pre><code class="prism language-py">rawText <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> newsText <span class="token keyword">in</span> abcNewsDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  rawText <span class="token operator">+=</span> newsText

plotWordCloud<span class="token punctuation">(</span>generateWordCloud<span class="token punctuation">(</span>rawText<span class="token punctuation">)</span><span class="token punctuation">)</span>

rawText <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> _<span class="token punctuation">,</span> newsText <span class="token keyword">in</span> foxNewsDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  rawText <span class="token operator">+=</span> newsText

plotWordCloud<span class="token punctuation">(</span>generateWordCloud<span class="token punctuation">(</span>rawText<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bb/3c/t54VVsqk_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/cc/f5/M0XtQ9cP_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/16e06d627987acef32912036d75f2225/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">centos7安装docker</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/adf5ad1b21bf2b313c5d823a0df80098/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">web_文字有关的CSS属性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>