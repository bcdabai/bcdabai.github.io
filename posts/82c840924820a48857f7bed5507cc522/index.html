<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux下 安装Docker - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux下 安装Docker" />
<meta property="og:description" content="使用官方安装脚本自动安装 安装命令如下：
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun 也可以使用国内 daocloud 一键安装命令：
curl -sSL https://get.daocloud.io/docker | sh Docker离线安装 一、Docker安装 1. 安装包官方地址：https://download.docker.com/linux/static/stable/x86_64/ 可以先下载到本地，然后通过ftp工具上传到服务器上，或者在服务器上使用命令下载
wget https://download.docker.com/linux/static/stable/x86_64/docker-18.06.3-ce.tgz 2. 解压 tar -zxvf docker-18.06.3-ce.tgz 3. 将解压出来的docker文件复制到 /usr/bin/ 目录下 cp docker/* /usr/bin/ 4. 创建docker.service文件 进入 /etc/systemd/system/ 目录,并创建 docker.service 文件，内容如下，这样可以将docker注册为service服务
[Unit] Description=Docker Application Container Engine Documentation=https://docs.docker.com After=network-online.target firewalld.service Wants=network-online.target [Service] Type=notify # the default is not to use systemd for cgroups because the delegate issues still # exists and systemd currently does not support the cgroup feature set required # for containers run by docker ExecStart=/usr/bin/dockerd --selinux-enabled=false --insecure-registry=127." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/82c840924820a48857f7bed5507cc522/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-09T11:40:57+08:00" />
<meta property="article:modified_time" content="2023-06-09T11:40:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux下 安装Docker</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>使用官方安装脚本自动安装</h2> 
<p>安装命令如下：</p> 
<pre><code class="prism language-shell"><span class="token function">curl</span> -fsSL https://get.docker.com <span class="token operator">|</span> <span class="token function">bash</span> -s <span class="token function">docker</span> --mirror Aliyun
</code></pre> 
<p>也可以使用国内 daocloud 一键安装命令：</p> 
<pre><code class="prism language-shell"><span class="token function">curl</span> -sSL https://get.daocloud.io/docker <span class="token operator">|</span> <span class="token function">sh</span>
</code></pre> 
<hr> 
<h2><a id="Docker_11"></a>Docker离线安装</h2> 
<h3><a id="Docker_12"></a>一、Docker安装</h3> 
<h4><a id="1_httpsdownloaddockercomlinuxstaticstablex86_64_13"></a>1. 安装包官方地址：https://download.docker.com/linux/static/stable/x86_64/</h4> 
<p>可以先下载到本地，然后通过ftp工具上传到服务器上，或者在服务器上使用命令下载</p> 
<pre><code class="prism language-shell"><span class="token function">wget</span> https://download.docker.com/linux/static/stable/x86_64/docker-18.06.3-ce.tgz
</code></pre> 
<h4><a id="2__18"></a>2. 解压</h4> 
<pre><code class="prism language-shell"><span class="token function">tar</span> -zxvf docker-18.06.3-ce.tgz
</code></pre> 
<h4><a id="3_docker_usrbin__22"></a>3. 将解压出来的docker文件复制到 /usr/bin/ 目录下</h4> 
<pre><code class="prism language-shell"><span class="token function">cp</span> docker/* /usr/bin/
</code></pre> 
<h4><a id="4_dockerservice_26"></a>4. 创建docker.service文件</h4> 
<p>进入 <code>/etc/systemd/system/</code> 目录,并创建 <code>docker.service</code> 文件，内容如下，这样可以将docker注册为service服务</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Docker Application Container Engine
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>https://docs.docker.com
<span class="token assign-left variable">After</span><span class="token operator">=</span>network-online.target firewalld.service
<span class="token assign-left variable">Wants</span><span class="token operator">=</span>network-online.target
  
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>notify
<span class="token comment"># the default is not to use systemd for cgroups because the delegate issues still</span>
<span class="token comment"># exists and systemd currently does not support the cgroup feature set required</span>
<span class="token comment"># for containers run by docker</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/dockerd --selinux-enabled<span class="token operator">=</span>false --insecure-registry<span class="token operator">=</span><span class="token number">127.0</span>.0.1
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill -s HUP <span class="token variable">$MAINPID</span>
<span class="token comment"># Having non-zero Limit*s causes performance problems due to accounting overhead</span>
<span class="token comment"># in the kernel. We recommend using cgroups to do container-local accounting.</span>
<span class="token assign-left variable">LimitNOFILE</span><span class="token operator">=</span>infinity
<span class="token assign-left variable">LimitNPROC</span><span class="token operator">=</span>infinity
<span class="token assign-left variable">LimitCORE</span><span class="token operator">=</span>infinity
<span class="token comment"># Uncomment TasksMax if your systemd version supports it.</span>
<span class="token comment"># Only systemd 226 and above support this version.</span>
<span class="token comment">#TasksMax=infinity</span>
<span class="token assign-left variable">TimeoutStartSec</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token comment"># set delegate yes so that systemd does not reset the cgroups of docker containers</span>
<span class="token assign-left variable">Delegate</span><span class="token operator">=</span>yes
<span class="token comment"># kill only the docker process, not all processes in the cgroup</span>
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token comment"># restart the docker process if it exits prematurely</span>
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">StartLimitBurst</span><span class="token operator">=</span><span class="token number">3</span>
<span class="token assign-left variable">StartLimitInterval</span><span class="token operator">=</span>60s
  
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target

<span class="token comment"># 此处的–insecure-registry=127.0.0.1（此处改成你私服ip）设置是针对有搭建了自己私服Harbor时允许docker进行不安全的访问，否则访问将会被拒绝。</span>
</code></pre> 
<h4><a id="5_docker_65"></a>5. 启动docker</h4> 
<pre><code class="prism language-shell"><span class="token comment"># 给docker.service文件添加执行权限</span>
<span class="token function">chmod</span> +x /etc/systemd/system/docker.service
<span class="token comment"># 重新加载配置文件（每次有修改docker.service文件时都要重新加载下）</span>
systemctl daemon-reload
<span class="token comment"># 启动</span>
systemctl start <span class="token function">docker</span>
<span class="token comment"># 设置开机启动</span>
systemctl <span class="token builtin class-name">enable</span> docker.service
<span class="token comment"># 查看docker服务状态</span>
<span class="token punctuation">[</span>root@localhost system<span class="token punctuation">]</span><span class="token comment"># systemctl status docker</span>
● docker.service - Docker Application Container Engine
Loaded: loaded <span class="token punctuation">(</span>/etc/systemd/system/docker.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Tue <span class="token number">2022</span>-06-28 00:54:47 PDT<span class="token punctuation">;</span> 10s ago
Docs: https://docs.docker.com
Main PID: <span class="token number">45475</span> <span class="token punctuation">(</span>dockerd<span class="token punctuation">)</span>
CGroup: /system.slice/docker.service
├─45475 /usr/bin/dockerd --selinux-enabled<span class="token operator">=</span>false --insecure-registry<span class="token operator">=</span><span class="token number">10.1</span>.20.150
└─45487 containerd --config /var/run/docker/containerd/containerd.toml --log-level info
Jun <span class="token number">28</span> 00:54:46 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:46.158519178-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"ccResolverWrapper: sending update to cc: {[{unix:///var/run/docker/containerd..."</span> <span class="token assign-left variable">module</span><span class="token operator">=</span>grpc
Jun <span class="token number">28</span> 00:54:46 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:46.158525449-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"ClientConn switching balancer to "</span>pick_first<span class="token string">""</span> <span class="token assign-left variable">module</span><span class="token operator">=</span>grpc
Jun <span class="token number">28</span> 00:54:46 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:46.202943588-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"Loading containers: start."</span>
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:47.021854086-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"Default bridge (docker0) is assigned with an IP address 172.17.0.0/16. Daemon...d IP address"</span>
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:47.126281901-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"Firewalld: interface docker0 already part of docker zone, returning"</span>
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:47.244251569-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"Loading containers: done."</span>
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:47.264592112-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"Docker daemon"</span> <span class="token assign-left variable">commit</span><span class="token operator">=</span>a89b842 graphdriver<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">=</span>overlay2 <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">20.10</span>.17
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:47.265027319-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"Daemon has completed initialization"</span>
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Started Docker Application Container Engine.
Jun <span class="token number">28</span> 00:54:47 localhost.localdomain dockerd<span class="token punctuation">[</span><span class="token number">45475</span><span class="token punctuation">]</span>: <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token string">"2022-06-28T00:54:47.300116789-07:00"</span> <span class="token assign-left variable">level</span><span class="token operator">=</span>info <span class="token assign-left variable">msg</span><span class="token operator">=</span><span class="token string">"API listen on /var/run/docker.sock"</span>
Hint: Some lines were ellipsized, use -l to show <span class="token keyword">in</span> full.
<span class="token comment"># 如上表示docker已安装成功</span>
</code></pre> 
<h4><a id="6_docker_98"></a>6. docker环境检查</h4> 
<pre><code class="prism language-shell"><span class="token function">docker</span> info
<span class="token punctuation">[</span>root@localhost system<span class="token punctuation">]</span><span class="token comment"># docker info</span>
Running: <span class="token number">0</span>
Paused: <span class="token number">0</span>
Stopped: <span class="token number">0</span>
Images: <span class="token number">0</span>
Server Version: <span class="token number">20.10</span>.17
Storage Driver: overlay2
Backing Filesystem: xfs
Supports d_type: <span class="token boolean">true</span>
Native Overlay Diff: <span class="token boolean">true</span>
userxattr: <span class="token boolean">false</span>
Logging Driver: json-file
Cgroup Driver: cgroupfs
Cgroup Version: <span class="token number">1</span>
Plugins:
Volume: <span class="token builtin class-name">local</span>
Network: bridge <span class="token function">host</span> ipvlan macvlan null overlay
Log: awslogs fluentd gcplogs gelf journald json-file <span class="token builtin class-name">local</span> logentries splunk syslog
Swarm: inactive
Runtimes: io.containerd.runc.v2 io.containerd.runtime.v1.linux runc
Default Runtime: runc
Init Binary: docker-init
containerd version: 10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1
runc version: v1.1.2-0-ga916309f
init version: de40ad0
Security Options:
seccomp
Profile: default
Kernel Version: <span class="token number">3.10</span>.0-693.el7.x86_64
Operating System: CentOS Linux <span class="token number">7</span> <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
OSType: linux
Architecture: x86_64
CPUs: <span class="token number">4</span>
Total Memory: <span class="token number">7</span>.624GiB
Name: localhost.localdomain
ID: ZHES:U53P:FOPX:QKRO:4PQE:BIKC:OEQJ:7VUS:NBUQ:U47D:R3QO:JKKX
Docker Root Dir: /var/lib/docker
Debug Mode: <span class="token boolean">false</span>
Registry: https://index.docker.io/v1/
Labels:
Experimental: <span class="token boolean">false</span>
Insecure Registries:
<span class="token number">10.1</span>.20.150
<span class="token number">127.0</span>.0.0/8
Live Restore Enabled: <span class="token boolean">false</span>
Product License: Community Engine
<span class="token function">docker</span> version
<span class="token punctuation">[</span>root@localhost system<span class="token punctuation">]</span><span class="token comment"># docker version</span>
Client:
Version:           <span class="token number">20.10</span>.17
API version:       <span class="token number">1.41</span>
Go version:        go1.17.11
Git commit:        100c701
Built:             Mon Jun  <span class="token number">6</span> <span class="token number">22</span>:56:42 <span class="token number">2022</span>
OS/Arch:           linux/amd64
Context:           default
Experimental:      <span class="token boolean">true</span>
Server: Docker Engine - Community
Engine:
Version:          <span class="token number">20.10</span>.17
API version:      <span class="token number">1.41</span> <span class="token punctuation">(</span>minimum version <span class="token number">1.12</span><span class="token punctuation">)</span>
Go version:       go1.17.11
Git commit:       a89b842
Built:            Mon Jun  <span class="token number">6</span> <span class="token number">23</span>:01:45 <span class="token number">2022</span>
OS/Arch:          linux/amd64
Experimental:     <span class="token boolean">false</span>
containerd:
Version:          v1.6.6
GitCommit:        10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1
runc:
Version:          <span class="token number">1.1</span>.2
GitCommit:        v1.1.2-0-ga916309f
docker-init:
Version:          <span class="token number">0.19</span>.0
GitCommit:        de40ad0
</code></pre> 
<h3><a id="dockercompose_178"></a>二、docker-compose安装</h3> 
<pre><code class="prism language-shell"><span class="token comment"># docker-compose下载并放到/usr/local/bin/下面：</span>
<span class="token function">curl</span> -L <span class="token string">"https://github.com/docker/compose/releases/download/v2.18.1/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -s<span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -m<span class="token variable">)</span></span>"</span> -o /usr/local/bin/docker-compose
<span class="token comment"># 下载好docker-compose的前提下，拷贝到指定位置</span>
<span class="token function">sudo</span> <span class="token function">cp</span> <span class="token function">docker-compose</span> /usr/local/bin/docker-compose
<span class="token function">sudo</span> <span class="token function">ln</span> -s /usr/local/bin/docker-compose /usr/bin/docker-compose
<span class="token function">sudo</span> <span class="token function">chmod</span> +x /usr/local/bin/docker-compose
<span class="token function">sudo</span> <span class="token function">chmod</span> +x /usr/bin/docker-compose
<span class="token function">docker-compose</span> -v
<span class="token comment"># 最后使用 docker-compose -v 命令测试是否安装成功（如果提示“没有那个文件或目录”可以重启下服务器再试试）</span>
</code></pre> 
<hr> 
<h2><a id="_193"></a>问题</h2> 
<h3><a id="centOS7docker_Errno_14_curl35__TCP_connection_reset_by_peer_194"></a>一、centOS7安装docker遇到 [Errno 14] curl#35 - "TCP connection reset by peer问题解决：</h3> 
<p>安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</p> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> -y yum-utils device-mapper-persistent-data lvm2
</code></pre> 
<h4><a id="1_199"></a>1、更换为阿里源</h4> 
<p>首先这个问题是因为国内访问不到docker官方镜像的缘故，所以我们要使用 国内的源来访问，之前我也试过163的源，但是一直解决不了，但是后来换了阿里源就成功解决了这个问题，不扯淡了直接出语句：</p> 
<pre><code class="prism language-shell">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo  
</code></pre> 
<p>成功的话会有如下提示：</p> 
<blockquote> 
 <p>repo saved to /etc/yum.repos.d/docker-ce.repo</p> 
</blockquote> 
<h4><a id="2docker_______dockerdocker_207"></a>2、查看docker仓库中的所有版本 输入指令可以看到docker的版本信息，如下：（如果内核版本低，docker版本高会安装出错）</h4> 
<pre><code class="prism language-shell">yum list docker-ce --showduplicates <span class="token operator">|</span> <span class="token function">sort</span> -r 
</code></pre> 
<p><img src="https://images2.imgbox.com/76/08/z3bmCkZ3_o.png" alt="在这里插入图片描述"></p> 
<p>我们可以安装指定版本，使用 <code>sudo yum install &lt;docker的版本&gt;</code>，这里我使用 <code>sudo yum install docker-ce</code> 默认安装最高的版本。例如</p> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce.x86_64 <span class="token number">3</span>:24.0.2-1.el7
</code></pre> 
<h4><a id="3_217"></a>3、启动并加入开机启动</h4> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> systemctl start <span class="token function">docker</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre> 
<h4><a id="4dockerdockerClientServer_222"></a>4、检测是否安装docker成功，查看版本信息。出现如下图，恭喜docker安装成功！可以看到Client与Server的信息。</h4> 
<pre><code class="prism language-shell"><span class="token function">docker</span> version
<span class="token function">sudo</span> <span class="token function">docker</span> run hello-world
</code></pre> 
<p><img src="https://images2.imgbox.com/d7/dc/msXhOq3U_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="docker_230"></a>二、因为之前已经安装过旧版本的docker，在安装的时候报错如下：</h3> 
<pre><code class="prism language-shell">Transaction check error:
  <span class="token function">file</span> /usr/bin/docker from <span class="token function">install</span> of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with <span class="token function">file</span> from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64
  <span class="token function">file</span> /usr/bin/docker-containerd from <span class="token function">install</span> of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with <span class="token function">file</span> from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64
  <span class="token function">file</span> /usr/bin/docker-containerd-shim from <span class="token function">install</span> of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with <span class="token function">file</span> from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64
  <span class="token function">file</span> /usr/bin/dockerd from <span class="token function">install</span> of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with <span class="token function">file</span> from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64
</code></pre> 
<p>卸载旧版本的包</p> 
<pre><code class="prism language-shell">$ <span class="token function">sudo</span> yum erase docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64
</code></pre> 
<p>再次安装docker</p> 
<pre><code class="prism language-shell">$ <span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce
</code></pre> 
<h3><a id="No_Presto_metadata_available_for_dockercestable_247"></a>三、No Presto metadata available for docker-ce-stable</h3> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> docker-ce -y
</code></pre> 
<h3><a id="Delta_RPMs_disabled_because_usrbinapplydeltarpm_not_installed_252"></a>四、Delta RPMs disabled because /usr/bin/applydeltarpm not installed.</h3> 
<pre><code class="prism language-shell">yum provides <span class="token string">'*/applydeltarpm'</span>  
yum <span class="token function">install</span> deltarpm -y
</code></pre> 
<hr> 
<h2><a id="DOCKER_COMPOSE_259"></a>DOCKER COMPOSE</h2> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">curl</span> -L <span class="token string">"https://github.com/docker/compose/releases/download/1.28.0-rc1/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -s<span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -m<span class="token variable">)</span></span>"</span> -o /usr/local/bin/docker-compose
<span class="token function">sudo</span> <span class="token function">chmod</span> +x /usr/local/bin/docker-compose
<span class="token function">sudo</span> <span class="token function">ln</span> -s /usr/local/bin/docker-compose /usr/bin/docker-compose
<span class="token function">docker-compose</span> --version

<span class="token function">docker-compose</span> up / <span class="token function">docker-compose</span> up -d 起服务（要有docker-compose.yml）
<span class="token function">docker</span> start nginx
<span class="token function">docker-compose</span> stop
</code></pre> 
<h2><a id="_271"></a>问题：</h2> 
<h3><a id="dlopen_lib64libcso6_version_GLIBC_228_not_found_272"></a>dlopen: /lib64/libc.so.6: version `GLIBC_2.28’ not found</h3> 
<p>错误提示意思是没有GLIBC_2.28版本，升级版本：</p> 
<h4><a id="1_glibc228targz__274"></a>1、下载 glibc-2./28.tar.gz (随意一个目录)</h4> 
<pre><code class="prism language-shell"><span class="token function">wget</span> https://ftp.gnu.org/gnu/glibc/glibc-2.28.tar.gz
</code></pre> 
<h4><a id="2_root__278"></a>2.解压编译等操作（用 root 全权操作，最后两步用时比较久）</h4> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@hadoop101 opt<span class="token punctuation">]</span><span class="token comment"># tar -zxvf glibc-2.28.tar.gz</span>
<span class="token punctuation">[</span>root@hadoop101 opt<span class="token punctuation">]</span><span class="token comment"># cd glibc-2.28</span>
<span class="token punctuation">[</span>root@hadoop101 glibc-2.28<span class="token punctuation">]</span><span class="token comment"># mkdir build</span>
<span class="token punctuation">[</span>root@hadoop101 glibc-2.28<span class="token punctuation">]</span><span class="token comment"># cd build</span>
<span class="token punctuation">[</span>root@hadoop101 build<span class="token punctuation">]</span><span class="token comment"># ../configure --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin</span>
<span class="token punctuation">[</span>root@hadoop101 build<span class="token punctuation">]</span><span class="token comment"># make -j 8</span>
<span class="token punctuation">[</span>root@hadoop101 build<span class="token punctuation">]</span><span class="token comment"># make  install</span>
</code></pre> 
<p>如果报错：</p> 
<blockquote> 
 <p>These critical programs are missing or too old: make bison compiler</p> 
</blockquote> 
<p>查看bison版本：</p> 
<pre><code class="prism language-shell">bison -V
</code></pre> 
<p>使用 yum 安装bison</p> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> -y bison
</code></pre> 
<p>之后再升级make：<br> 先在 <code>~/.bash_profile</code> 里加上 <code>PATH=$HOME/local/bin:$PATH</code></p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">source</span> ~/.bash_profile
<span class="token function">ln</span> -s <span class="token environment constant">$HOME</span>/local/bin/make <span class="token environment constant">$HOME</span>/local/bin/gmake
</code></pre> 
<p>先下载：</p> 
<pre><code>wget https://ftp.gnu.org/gnu/make/make-4.3.tar.gz
tar -zvxf make-4.3.tar.gz
cd make-4.3
./configure --prefix=$HOME/local
make &amp;&amp; make install 
</code></pre> 
<h4><a id="3_314"></a>3.查看安装结果</h4> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@hadoop101 build<span class="token punctuation">]</span>$ strings /lib64/libc.so.6 <span class="token operator">|</span> <span class="token function">grep</span> GLIBC  <span class="token punctuation">(</span>或用这个命令也可以直接查看当前版本：ldd --version<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e50e2aec52869d0e17ab0bcae23268d6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python modbus RTU</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d7fbb4b6e65857eb95b91d96a633a64b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Kibana配置删除过期数据（Index Lifecycle Policies）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>