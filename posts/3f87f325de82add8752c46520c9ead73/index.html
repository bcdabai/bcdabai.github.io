<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>(01)ORB-SLAM2源码无死角解析-(22) 特征点三角化、深度计算、三维点筛选 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="(01)ORB-SLAM2源码无死角解析-(22) 特征点三角化、深度计算、三维点筛选" />
<meta property="og:description" content="讲解关于slam一系列文章汇总链接:史上最全slam从零开始，针对于本栏目讲解的(01)ORB-SLAM2源码无死角解析链接如下(本文内容来自计算机视觉life ORB-SLAM2 课程课件):
(01)ORB-SLAM2源码无死角解析-(00)目录_最新无死角讲解：https://blog.csdn.net/weixin_43013761/article/details/123092196
文末正下方中心提供了本人 联系方式， 点击本人照片即可显示 W X → 官方认证 {\color{blue}{文末正下方中心}提供了本人 \color{red} 联系方式，\color{blue}点击本人照片即可显示WX→官方认证} 文末正下方中心提供了本人联系方式，点击本人照片即可显示WX→官方认证
一、前言 通过前面的博客，我们已经知道如何从 单应性矩阵Homography，或者 基本矩阵Fundamental 中恢复 R t \mathbf R\mathbf t Rt,但是这里存在一个比较尴尬的问题，其结果都存在多组解，也就是多组 R t \mathbf R\mathbf t Rt，比如从 Homography 中恢复 R t \mathbf R\mathbf t Rt 存在8组解，从 Fundamental 中恢复 存在4组解。那么我们如何去判断那组解是最优的呢?
在 Initializer.cc 文件中，之前介绍的两个函数: ReconstructH() 与 ReconstructF(), 都调用了一个比较重要的函数→CheckRT()，该函数主要是对 R t \mathbf R\mathbf t Rt 进行评估，得出其可靠性与稳定性。该代码中主要涉及的东西包含:特征点三角化、重投影误差。
三角化在不同位置观测同一个三维点 X = ( X , Y , Z ) \mathbf X=(X,Y,Z) X=(X,Y,Z),其在二维的投影是不一样的，设两个位置的二维投影(归一化后特征点坐标)为 x 1 \mathbf x_1 x1​， x 2 \mathbf x_2 x2​，视角关系如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3f87f325de82add8752c46520c9ead73/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-31T17:09:25+08:00" />
<meta property="article:modified_time" content="2022-10-31T17:09:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">(01)ORB-SLAM2源码无死角解析-(22) 特征点三角化、深度计算、三维点筛选</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>讲解关于slam一系列文章汇总链接:<a href="https://blog.csdn.net/weixin_43013761/article/details/123092806">史上最全slam从零开始</a>，针对于本栏目讲解的(01)ORB-SLAM2源码无死角解析链接如下(本文内容来自计算机视觉life ORB-SLAM2 课程课件):<br> <a href="https://blog.csdn.net/weixin_43013761/article/details/123092196">(01)ORB-SLAM2源码无死角解析-(00)目录_最新无死角讲解：https://blog.csdn.net/weixin_43013761/article/details/123092196</a><br>  <br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          文末正下方中心提供了本人 
         
         
         
           联系方式， 
          
          
          
            点击本人照片即可显示 
           
          
            W 
           
          
            X 
           
          
            → 
           
          
            官方认证 
           
          
         
        
       
      
        {\color{blue}{文末正下方中心}提供了本人 \color{red} 联系方式，\color{blue}点击本人照片即可显示WX→官方认证} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord"><span class="mord" style="color: blue;"><span class="mord cjk_fallback" style="color: blue;">文末正下方中心</span></span><span class="mord cjk_fallback" style="color: blue;">提供了本人</span><span class="mord cjk_fallback" style="color: red;">联系方式，</span><span class="mord cjk_fallback" style="color: blue;">点击本人照片即可显示</span><span class="mord mathnormal" style="margin-right: 0.1389em; color: blue;">W</span><span class="mord mathnormal" style="margin-right: 0.0785em; color: blue;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">→</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord cjk_fallback" style="color: blue;">官方认证</span></span></span></span></span></span><br>  </p> 
<h3><a id="_5"></a>一、前言</h3> 
<p>通过前面的博客，我们已经知道如何从 单应性矩阵Homography，或者 基本矩阵Fundamental 中恢复 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span>,但是这里存在一个比较尴尬的问题，其结果都存在多组解，也就是多组 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span>，比如从 Homography 中恢复 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 存在8组解，从 Fundamental 中恢复 存在4组解。那么我们如何去判断那组解是最优的呢?</p> 
<p>在 Initializer.cc 文件中，之前介绍的两个函数: ReconstructH() 与 ReconstructF(), 都调用了一个比较重要的函数→CheckRT()，该函数主要是对 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 进行评估，得出其可靠性与稳定性。该代码中主要涉及的东西包含:特征点三角化、重投影误差。</p> 
<p>三角化在不同位置观测同一个三维点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         = 
        
       
         ( 
        
       
         X 
        
       
         , 
        
       
         Y 
        
       
         , 
        
       
         Z 
        
       
         ) 
        
       
      
        \mathbf X=(X,Y,Z) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mclose">)</span></span></span></span></span>,其在二维的投影是不一样的，设两个位置的二维投影(归一化后特征点坐标)为 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          1 
         
        
       
      
        \mathbf x_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5944em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          2 
         
        
       
      
        \mathbf x_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5944em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，视角关系如下：<br> <img src="https://images2.imgbox.com/10/4e/4zLVGKRF_o.png" alt="请添加图片描述"></p> 
<p>红线与蓝线因为噪音的影响，是没有办法相交的。主要的目的，就是利用上图的三角信息，恢复出三维点的深度信息<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
      
        Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span></span></span>。</p> 
<p> </p> 
<h3><a id="_19"></a>二、基础理论</h3> 
<p>假设三维点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         = 
        
       
         ( 
        
       
         X 
        
       
         , 
        
       
         Y 
        
       
         , 
        
       
         Z 
        
        
        
          ) 
         
        
          T 
         
        
       
      
        \mathbf X=(X,Y,Z)^T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0913em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span>, 投影之后归一化特征点坐标 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
        
          2 
         
        
       
      
        \mathbf x_1,\mathbf x_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6389em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，分别对应投影矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          P 
         
        
          1 
         
        
       
      
        P_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          P 
         
        
          2 
         
        
       
      
        P_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，那么他们之间的转换关系如下, 如果已知 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 满足如下关系：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              s 
             
            
              1 
             
            
            
            
              x 
             
            
              1 
             
            
           
             = 
            
            
            
              s 
             
            
              2 
             
            
           
             R 
            
            
            
              x 
             
            
              2 
             
            
           
             + 
            
           
             t 
            
           
          
          
          
          
            (01) 
           
          
         
        
       
         \tag{01} \color{blue} s_1 \mathbf x_1=s_2 \mathbf R \mathbf x_2+\mathbf t 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5944em; vertical-align: -0.15em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8361em; vertical-align: -0.15em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">R</span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6349em;"></span><span class="mord mathbf" style="color: blue;">t</span></span><span class="tag"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">01</span></span><span class="mord">)</span></span></span></span></span></span></span>现在需要求解两个特征点的深度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          1 
         
        
       
         , 
        
        
        
          s 
         
        
          2 
         
        
       
      
        s_1,s_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, 当然这两个深度是可以分开求的,比如说 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          2 
         
        
       
      
        s_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，如果我们要算 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          2 
         
        
       
      
        s_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，式子两侧都左乘一个 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          1 
         
        
          ∧ 
         
        
       
      
        \mathbf x_1^{\wedge} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.2481em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span class="" style="top: -2.4519em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∧</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2481em;"><span class=""></span></span></span></span></span></span></span></span></span></span>(列向量的反对称矩阵，如果不是很理解得朋友可以百度一下向量叉乘)。</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              s 
             
            
              1 
             
            
            
            
              x 
             
            
              1 
             
            
              ∧ 
             
            
            
            
              x 
             
            
              1 
             
            
           
             = 
            
           
             0 
            
           
             = 
            
            
            
              s 
             
            
              2 
             
            
            
            
              x 
             
            
              1 
             
            
              ∧ 
             
            
           
             R 
            
            
            
              x 
             
            
              2 
             
            
           
             + 
            
            
            
              x 
             
            
              1 
             
            
              ∧ 
             
            
           
             t 
            
           
          
          
          
          
            (02) 
           
          
         
        
       
         \tag{02} \color{blue} s_{1} \mathbf {x}_{1}^{\wedge} \mathbf {x}_{1}=0=s_{2} \mathbf {x}_{1}^{\wedge} \mathbf {R} \mathbf {x}_{2}+\mathbf{x}_{1}^{\wedge} \mathbf t 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0489em; vertical-align: -0.247em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord" style="color: blue;">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0489em; vertical-align: -0.247em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">R</span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0489em; vertical-align: -0.247em;"></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">t</span></span><span class="tag"><span class="strut" style="height: 1.0519em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">02</span></span><span class="mord">)</span></span></span></span></span></span></span>该式左侧为0，右侧可看成 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          2 
         
        
       
      
        s_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的一个方程。可以直接求解 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          2 
         
        
       
      
        s_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>， 有了 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          2 
         
        
       
      
        s_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          s 
         
        
          1 
         
        
       
      
        s_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 也非常容易求出，这样就能获得两帧下点的帧深度。也就确定了它们的空间坐标，当然，由于噪声的存在，我们估得 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span>，不一定精确使得(01)式有解，所以常见得做法是最小二乘，而不是零解。</p> 
<p>另外还存在一个问题，从式(02)我们可以看出，当 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        \mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6349em;"></span><span class="mord mathbf">t</span></span></span></span></span> 为0时，也就是图一中的红线与蓝线重合，无法产生三角形，处于红线(蓝线)上的任意一点，都满足其投影 ，故存在无穷多解。也就是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        \mathbf X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">X</span></span></span></span></span> 不唯一。同时如果平移距离比较小，则改变的一个很小的角度会导致深度大幅变化，如下图:<br> <img src="https://images2.imgbox.com/6c/33/umBPSwoN_o.png" alt="在这里插入图片描述"><br> 上图是相机 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          O 
         
        
          2 
         
        
       
      
        O_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 向左旋转，那么我们现象一种极端情况，就是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        \mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6349em;"></span><span class="mord mathbf">t</span></span></span></span></span> 无穷小，那么 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          O 
         
        
          2 
         
        
       
      
        O_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 向右旋转一点点，他们的交点到了无穷远处，也就是深度无穷大。总的来说, 就是 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        \mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6349em;"></span><span class="mord mathbf">t</span></span></span></span></span> 比较小的时候，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
      
        \mathbf R 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">R</span></span></span></span></span> 的一点点误差，会导致深度 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
      
        Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span></span></span> 会偏差很大。 但是呢，平移过大则会导致特征匹配失败，这就是三角化的矛盾。</p> 
<p>因此，为了增加三角化的精度，可以提高特征点的提取精度，也就是提高图像分辨率，但是会加大计算量；或者增大平移量，但是容易导致图像变化过大，进而导致匹配难度的增加，导致匹配失败。下面再来看看根据一对特征点求解 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
         = 
        
       
         ( 
        
       
         X 
        
       
         , 
        
       
         Y 
        
       
         , 
        
       
         Z 
        
        
        
          ) 
         
        
          T 
         
        
       
      
        \mathbf X=(X,Y,Z)^T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0913em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span> 的矩阵推导。</p> 
<p> </p> 
<h3><a id="_35"></a>三、公式推导</h3> 
<p><img src="https://images2.imgbox.com/ad/2b/754OgPEo_o.png" alt="请添加图片描述"><br> 如上图所示，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        \mathbf X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">X</span></span></span></span></span> 为三维空间点在世界坐标系下的齐次坐标，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         T 
        
       
      
        \mathbf T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">T</span></span></span></span></span> 为世界坐标到相机坐标的变换矩阵，以及 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        \mathbf x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span> 为归一化平面坐标，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         λ 
        
       
      
        \lambda 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> 为深度值，如下所示：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
           
             X 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                
                  X 
                 
                
               
              
              
               
                
                
                  Y 
                 
                
               
              
              
               
                
                
                  Z 
                 
                
               
              
              
               
                
                
                  1 
                 
                
               
              
             
            
              ] 
             
            
           
                    
            
           
             T 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                 
                 
                   r 
                  
                 
                   1 
                  
                 
                
               
              
              
               
                
                 
                 
                   r 
                  
                 
                   2 
                  
                 
                
               
              
              
               
                
                 
                 
                   r 
                  
                 
                   3 
                  
                 
                
               
              
             
            
              ] 
             
            
           
             = 
            
           
             [ 
            
           
             R 
            
           
             ∣ 
            
           
             t 
            
           
             ] 
            
           
                    
            
           
             x 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                
                  u 
                 
                
               
              
              
               
                
                
                  v 
                 
                
               
              
              
               
                
                
                  1 
                 
                
               
              
             
            
              ] 
             
            
           
          
          
          
          
            (03) 
           
          
         
        
       
         \tag{03} \color{blue} \mathbf X=\left[\begin{array}{l} X \\ Y \\ Z \\ 1 \end{array}\right]~~~~~~\mathbf T=\left[\begin{array}{l} r_1 \\ r_2 \\ r_3 \\ \end{array}\right]=[\mathbf R|\mathbf t]~~~~~~\mathbf{x}=\left[\begin{array}{l} u \\ v \\ 1 \end{array}\right] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf" style="color: blue;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 4.8001em; vertical-align: -2.15em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -1.711em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.858em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="color: blue; height: 1.216em; width: 0.6667em;"> 
              <svg width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.7111em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0785em; color: blue;">X</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.2222em; color: blue;">Y</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0715em; color: blue;">Z</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -1.711em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.858em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="color: blue; height: 1.216em; width: 0.6667em;"> 
              <svg width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.7111em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathbf" style="color: blue;">T</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen" style="color: blue;">[</span><span class="mord mathbf" style="color: blue;">R</span><span class="mord" style="color: blue;">∣</span><span class="mord mathbf" style="color: blue;">t</span><span class="mclose" style="color: blue;">]</span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mord mathbf" style="color: blue;">x</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">u</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height: 4.8001em; vertical-align: -2.15em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">03</span></span><span class="mord">)</span></span></span></span></span></span></span><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          这里需要注意一个点 
         
        
       
      
        \color{red}{这里需要注意一个点} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord" style="color: red;"><span class="mord cjk_fallback" style="color: red;">这里需要注意一个点</span></span></span></span></span></span> ，对于其上 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        \mathbf{x} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4444em;"></span><span class="mord mathbf">x</span></span></span></span></span> 的坐标1，是有特殊含义的，这里默认相机圆心到成像平面的距离(焦距)为1,也就是进行单位化，如果后续需要计算真实3D坐标，需要乘以焦距。根据相机成像原理，则存在：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
             
              
               
                
                
                  λ 
                 
                
                  x 
                 
                
                  = 
                 
                
                  T 
                 
                
                  X 
                 
                
               
              
             
             
              
               
                
                
                  λ 
                 
                
                  x 
                 
                
                  × 
                 
                
                  T 
                 
                
                  X 
                 
                
                  = 
                 
                
                  0 
                 
                
               
              
             
             
              
               
                
                 
                 
                   x 
                  
                 
                   ∧ 
                  
                 
                
                  T 
                 
                
                  X 
                 
                
                  = 
                 
                
                  0 
                 
                
               
              
             
            
           
          
          
          
          
            (04) 
           
          
         
        
       
         \tag{04} \color{blue} \begin{array}{c} \lambda \mathbf{x}=\mathbf T \mathbf X \\ \lambda \mathbf{x} \times \mathbf T \mathbf X=\mathbf 0 \\ \mathbf x^{\wedge} \mathbf T \mathbf X=\mathbf 0 \end{array} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">λ</span><span class="mord mathbf" style="color: blue;">x</span><span class="mspace" style="color: blue; margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="color: blue; margin-right: 0.2778em;"></span><span class="mord mathbf" style="color: blue;">TX</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">λ</span><span class="mord mathbf" style="color: blue;">x</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">×</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathbf" style="color: blue;">TX</span><span class="mspace" style="color: blue; margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="color: blue; margin-right: 0.2778em;"></span><span class="mord mathbf" style="color: blue;">0</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7519em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">TX</span><span class="mspace" style="color: blue; margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="color: blue; margin-right: 0.2778em;"></span><span class="mord mathbf" style="color: blue;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span><span class="tag"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">04</span></span><span class="mord">)</span></span></span></span></span></span></span>然后我们向量叉乘的公式进行展开：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              x 
             
            
              ∧ 
             
            
           
             T 
            
           
             X 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                
                  0 
                 
                
               
               
                
                 
                 
                   − 
                  
                 
                   1 
                  
                 
                
               
               
                
                
                  v 
                 
                
               
              
              
               
                
                
                  1 
                 
                
               
               
                
                
                  0 
                 
                
               
               
                
                 
                 
                   − 
                  
                 
                   u 
                  
                 
                
               
              
              
               
                
                 
                 
                   − 
                  
                 
                   v 
                  
                 
                
               
               
                
                
                  u 
                 
                
               
               
                
                
                  0 
                 
                
               
              
             
            
              ] 
             
            
            
            
              [ 
             
             
              
               
                
                 
                 
                   r 
                  
                 
                   1 
                  
                 
                
               
              
              
               
                
                 
                 
                   r 
                  
                 
                   2 
                  
                 
                
               
              
              
               
                
                 
                 
                   r 
                  
                 
                   3 
                  
                 
                
               
              
             
            
              ] 
             
            
           
             X 
            
           
             = 
            
           
             0 
            
           
          
          
          
          
            (05) 
           
          
         
        
       
         \tag{05} \color{blue} \mathbf{x}^{\wedge} \mathbf T \mathbf X=\left[\begin{array}{ccc} 0 &amp; -1 &amp; v \\ 1 &amp; 0 &amp; -u \\ -v &amp; u &amp; 0 \end{array}\right]\left[\begin{array}{l} {r}_{1} \\ {r}_{2} \\ {r}_{3} \end{array}\right] \mathbf X=\mathbf 0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8019em;"></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">TX</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">0</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">1</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord" style="color: blue;">1</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">0</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord mathnormal" style="color: blue;">u</span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathbf" style="color: blue;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord mathbf" style="color: blue;">0</span></span><span class="tag"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">05</span></span><span class="mord">)</span></span></span></span></span></span></span>进一步进行简化<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              x 
             
            
              ∧ 
             
            
           
             T 
            
           
             X 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                 
                 
                   − 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                   + 
                  
                 
                   v 
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
              
               
                
                 
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   − 
                  
                 
                   u 
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
              
               
                
                 
                 
                   − 
                  
                 
                   v 
                  
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   + 
                  
                 
                   u 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                
               
              
             
            
              ] 
             
            
           
             X 
            
           
             = 
            
           
             0 
            
           
                      
            
           
             A 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                 
                 
                   − 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                   + 
                  
                 
                   v 
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
              
               
                
                 
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   − 
                  
                 
                   u 
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
              
               
                
                 
                 
                   − 
                  
                 
                   v 
                  
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   + 
                  
                 
                   u 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                
               
              
             
            
              ] 
             
            
           
          
          
          
          
            (06) 
           
          
         
        
       
         \tag{06} \color{blue} \mathbf{x}^{\wedge} \mathbf T \mathbf X =\left[\begin{array}{c} -{r}_{2}+v {r}_{3} \\ {r}_{1}-u {r}_{3} \\ -v {r}_{1}+u {r}_{2} \end{array}\right] \mathbf X=\mathbf 0~~~~~~~~\mathbf A= \left[\begin{array}{c} -{r}_{2}+v {r}_{3} \\ {r}_{1}-u {r}_{3} \\ -v {r}_{1}+u {r}_{2} \end{array}\right] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8019em;"></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">TX</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">+</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="color: blue;">u</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">+</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="color: blue;">u</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathbf" style="color: blue;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf" style="color: blue;">0</span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mspace nobreak" style="color: blue;"><span style="color: blue;"> </span></span><span class="mord mathbf" style="color: blue;">A</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">+</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="color: blue;">u</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">−</span><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">+</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="color: blue;">u</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="tag"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">06</span></span><span class="mord">)</span></span></span></span></span></span></span>这个时候我认真观察一下，可以发现矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         A 
        
       
      
        \mathbf A 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> 的第一行乘以 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         − 
        
       
         u 
        
       
      
        -u 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal">u</span></span></span></span></span>，第二行乘以 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         − 
        
       
         v 
        
       
      
        -v 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span></span></span></span></span>, 再相加，即可得到第三行，因此其是线性相关，保留前两行即可，那么可以的推理出：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              x 
             
            
              ∧ 
             
            
           
             T 
            
           
             X 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                 
                 
                   v 
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                   − 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                
               
              
              
               
                
                 
                
               
              
              
               
                
                 
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   − 
                  
                 
                   u 
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
             
            
              ] 
             
            
           
             X 
            
           
             = 
            
           
             0 
            
           
          
          
          
          
            (07) 
           
          
         
        
       
         \tag{07} \color{blue} \mathbf{x}^{\wedge} \mathbf T \mathbf X =\left[\begin{array}{c} v {r}_{3} -{r}_{2}\\ \\ {r}_{1}-u {r}_{3} \\ \end{array}\right] \mathbf X=\mathbf 0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8019em;"></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">TX</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.01em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"></span></span><span class="" style="top: -1.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord mathnormal" style="color: blue;">u</span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -3.397em;"><span class="pstrut" style="height: 3.155em;"></span><span class="" style="color: blue; height: 0.016em; width: 0.6667em;"> 
              <svg width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.155em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathbf" style="color: blue;">X</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord mathbf" style="color: blue;">0</span></span><span class="tag"><span class="strut" style="height: 3.6em; vertical-align: -1.55em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">07</span></span><span class="mord">)</span></span></span></span></span></span></span>上面的推导是针对于一个特征点，如果是一对特征点(不同成像平面)，可以写成如下公式(同一相机)<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
           
            
            
              x 
             
            
              ∧ 
             
            
           
             T 
            
           
             X 
            
           
             = 
            
            
            
              [ 
             
             
              
               
                
                 
                  
                  
                    v 
                   
                  
                    1 
                   
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                   − 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                
               
              
              
               
                
                 
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   − 
                  
                  
                  
                    u 
                   
                  
                    1 
                   
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
              
               
                
                 
                  
                  
                    v 
                   
                  
                    2 
                   
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                   − 
                  
                  
                  
                    r 
                   
                  
                    2 
                   
                  
                 
                
               
              
              
               
                
                 
                  
                  
                    r 
                   
                  
                    1 
                   
                  
                 
                   − 
                  
                  
                  
                    u 
                   
                  
                    2 
                   
                  
                  
                  
                    r 
                   
                  
                    3 
                   
                  
                 
                
               
              
             
            
              ] 
             
            
            
            
              [ 
             
             
              
               
                
                
                  X 
                 
                
               
              
              
               
                
                
                  Y 
                 
                
               
              
              
               
                
                
                  Z 
                 
                
               
              
              
               
                
                
                  1 
                 
                
               
              
             
            
              ] 
             
            
           
             = 
            
           
             A 
            
           
             X 
            
           
             = 
            
           
             0 
            
           
          
          
          
          
            (08) 
           
          
         
        
       
         \tag{08} \color{blue} \mathbf{x}^{\wedge} \mathbf T \mathbf X =\left[\begin{array}{c} v_1 {r}_{3} -{r}_{2}\\ {r}_{1}-u_1 {r}_{3} \\ v_2 {r}_{3} -{r}_{2}\\ {r}_{1}-u_2 {r}_{3} \\ \end{array}\right] \left[\begin{array}{l} X \\ Y \\ Z \\ 1 \end{array}\right]= \mathbf A \mathbf X=\mathbf 0 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8019em;"></span><span class="mord" style="color: blue;"><span class="mord mathbf" style="color: blue;">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8019em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">∧</span></span></span></span></span></span></span></span></span><span class="mord mathbf" style="color: blue;">TX</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 4.8001em; vertical-align: -2.15em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -1.711em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.858em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="color: blue; height: 1.216em; width: 0.6667em;"> 
              <svg width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.7111em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0359em; color: blue;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mbin" style="color: blue;">−</span><span class="mspace" style="color: blue; margin-right: 0.2222em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="color: blue;">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0278em; color: blue;">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color: blue;"><span class="mord mtight" style="color: blue;"><span class="mord mtight" style="color: blue;">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -1.711em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.858em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="color: blue; height: 1.216em; width: 0.6667em;"> 
              <svg width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.7111em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner" style="color: blue;"><span class="mopen" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -1.711em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎣</span></span></span><span class="" style="top: -2.858em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="color: blue; height: 1.216em; width: 0.6667em;"> 
              <svg width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"> 
               <path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"></path> 
              </svg></span></span><span class="" style="top: -4.7111em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span><span class="mord" style="color: blue;"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -4.81em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0785em; color: blue;">X</span></span></span><span class="" style="top: -3.61em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.2222em; color: blue;">Y</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord mathnormal" style="margin-right: 0.0715em; color: blue;">Z</span></span></span><span class="" style="top: -1.21em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="color: blue;"><span class="mord" style="color: blue;">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose" style="color: blue;"><span class="delimsizing mult" style="color: blue;"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.65em;"><span class="" style="top: -1.711em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎦</span></span></span><span class="" style="top: -2.858em;"><span class="pstrut" style="height: 3.216em;"></span><span class="" style="color: blue; height: 1.216em; width: 0.6667em;"> 
              <svg width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"> 
               <path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"></path> 
              </svg></span></span><span class="" style="top: -4.7111em;"><span class="pstrut" style="height: 3.216em;"></span><span class="delimsizinginner delim-size4"><span class="">⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf" style="color: blue;">AX</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel" style="color: blue;">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord mathbf" style="color: blue;">0</span></span><span class="tag"><span class="strut" style="height: 4.8001em; vertical-align: -2.15em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">08</span></span><span class="mord">)</span></span></span></span></span></span></span><br> 直接对<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         A 
        
       
      
        \mathbf A 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">A</span></span></span></span></span> 进行 SVD 奇异值分解，然后根据最小二乘法的推导，即可得到其最优解。最优解为，分解之后最小奇异值对应于右奇异矩阵的特征向量。也就矩阵 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         V 
        
       
      
        \mathbf V 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf" style="margin-right: 0.016em;">V</span></span></span></span></span> 的最后一列。即 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          V 
         
        
          T 
         
        
       
      
        \mathbf V^T 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8413em;"></span><span class="mord"><span class="mord mathbf" style="margin-right: 0.016em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8413em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.1389em;">T</span></span></span></span></span></span></span></span></span></span></span></span> 最后一行。</p> 
<p> </p> 
<h3><a id="_92"></a>四、三维点筛选</h3> 
<p>根据上述的公式，已经知道如何根据特征点对进行三角化，那么三角化之后的结果是否正确?这个时候我们需要对三角化的结果进行验证。验证主要分为以下几个步骤：</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          步骤一 
         
        
       
      
        \color{blue}步骤一 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: blue;">步骤一</span></span></span></span></span>: 根据前面的介绍，如果 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
      
        \mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6349em;"></span><span class="mord mathbf">t</span></span></span></span></span> 较小，则求解出来的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        \mathbf X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">X</span></span></span></span></span> 坐标，可能存在无穷大的数值，则认为三角化失败。</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          步骤二 
         
        
       
      
        \color{blue}步骤二 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: blue;">步骤二</span></span></span></span></span>: 判断视差，可以理解为图一红线与蓝线的夹角。如果视差太小，则认为认为三角化失败。</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          步骤三 
         
        
       
      
        \color{blue}步骤三 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: blue;">步骤三</span></span></span></span></span>: 计算重投影误差，如果误差太大，则任务三角化失败(并且视察不能为负数，也就是三维点需要在相机前方)。</p> 
<p>其上的步骤一与步骤二都比较好理解，这里我们重点讲解以下步骤三,其细化流程如下：<br> 1.把第一个相机坐标系下的三维点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
        
          1 
         
        
       
      
        \mathbf X_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8361em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，通过 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 矩阵转换成第二个相机坐标系下的三维点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
        
          2 
         
        
       
      
        \mathbf X_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8361em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>。<br> 2.再根据计算出来的深度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         Z 
        
       
      
        Z 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">Z</span></span></span></span></span>,求解出该三维点第二个相机下的新图像坐标。<br> 3.使用新图像坐标与特征点2作差，然后再作平方差计算，该结果，即认为是重投影误差。</p> 
<p> </p> 
<h3><a id="_108"></a>五、代码注释</h3> 
<p>代码主调函数位于 Initializer.cc 文件中的 Initializer::CheckRT() 函数，其主要包含的部分为三角化函数Triangulate()，实现如下：</p> 
<pre><code class="prism language-cpp"><span class="token comment">/** 给定投影矩阵P1,P2和图像上的匹配特征点点kp1,kp2，从而计算三维点坐标
 * @brief 
 * 
 * @param[in] kp1               特征点, in reference frame
 * @param[in] kp2               特征点, in current frame
 * @param[in] P1                投影矩阵P1
 * @param[in] P2                投影矩阵P2
 * @param[in &amp; out] x3D         计算的三维点
 */</span>
<span class="token keyword">void</span> <span class="token class-name">Initializer</span><span class="token double-colon punctuation">::</span><span class="token function">Triangulate</span><span class="token punctuation">(</span>
    <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>KeyPoint <span class="token operator">&amp;</span>kp1<span class="token punctuation">,</span>    <span class="token comment">//特征点, in reference frame</span>
    <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>KeyPoint <span class="token operator">&amp;</span>kp2<span class="token punctuation">,</span>    <span class="token comment">//特征点, in current frame</span>
    <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>P1<span class="token punctuation">,</span>          <span class="token comment">//投影矩阵P1</span>
    <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>P2<span class="token punctuation">,</span>          <span class="token comment">//投影矩阵P2</span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>x3D<span class="token punctuation">)</span>               <span class="token comment">//三维点</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 原理</span>
    <span class="token comment">// Trianularization: 已知匹配特征点对{x x'} 和 各自相机矩阵{P P'}, 估计三维点 X</span>
    <span class="token comment">// x' = P'X  x = PX</span>
    <span class="token comment">// 它们都属于 x = aPX模型</span>
    <span class="token comment">//                         |X|</span>
    <span class="token comment">// |x|     |p1 p2  p3  p4 ||Y|     |x|    |--p0--||.|</span>
    <span class="token comment">// |y| = a |p5 p6  p7  p8 ||Z| ===&gt;|y| = a|--p1--||X|</span>
    <span class="token comment">// |z|     |p9 p10 p11 p12||1|     |z|    |--p2--||.|</span>
    <span class="token comment">// 采用DLT的方法：x叉乘PX = 0</span>
    <span class="token comment">// |yp2 -  p1|     |0|</span>
    <span class="token comment">// |p0 -  xp2| X = |0|</span>
    <span class="token comment">// |xp1 - yp0|     |0|</span>
    <span class="token comment">// 两个点:</span>
    <span class="token comment">// |yp2   -  p1  |     |0|</span>
    <span class="token comment">// |p0    -  xp2 | X = |0| ===&gt; AX = 0</span>
    <span class="token comment">// |y'p2' -  p1' |     |0|</span>
    <span class="token comment">// |p0'   - x'p2'|     |0|</span>
    <span class="token comment">// 变成程序中的形式：</span>
    <span class="token comment">// |xp2  - p0 |     |0|</span>
    <span class="token comment">// |yp2  - p1 | X = |0| ===&gt; AX = 0</span>
    <span class="token comment">// |x'p2'- p0'|     |0|</span>
    <span class="token comment">// |y'p2'- p1'|     |0|</span>
    <span class="token comment">// 然后就组成了一个四元一次正定方程组，SVD求解，右奇异矩阵的最后一行就是最终的解.</span>

	<span class="token comment">//这个就是上面注释中的矩阵A</span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">A</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//构造参数矩阵A</span>
    A<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">=</span> kp1<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>x<span class="token operator">*</span>P1<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>P1<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    A<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> kp1<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>y<span class="token operator">*</span>P1<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>P1<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    A<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> kp2<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>x<span class="token operator">*</span>P2<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>P2<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    A<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> kp2<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>y<span class="token operator">*</span>P2<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>P2<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//奇异值分解的结果</span>
    cv<span class="token double-colon punctuation">::</span>Mat u<span class="token punctuation">,</span>w<span class="token punctuation">,</span>vt<span class="token punctuation">;</span>
	<span class="token comment">//对系数矩阵A进行奇异值分解</span>
    cv<span class="token double-colon punctuation">::</span><span class="token class-name">SVD</span><span class="token double-colon punctuation">::</span><span class="token function">compute</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>w<span class="token punctuation">,</span>u<span class="token punctuation">,</span>vt<span class="token punctuation">,</span>cv<span class="token double-colon punctuation">::</span>SVD<span class="token double-colon punctuation">::</span>MODIFY_A<span class="token operator">|</span> cv<span class="token double-colon punctuation">::</span>SVD<span class="token double-colon punctuation">::</span>FULL_UV<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//根据前面的结论，奇异值分解右矩阵的最后一行其实就是解，原理类似于前面的求最小二乘解，四个未知数四个方程正好正定</span>
	<span class="token comment">//别忘了我们更习惯用列向量来表示一个点的空间坐标</span>
    x3D <span class="token operator">=</span> vt<span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//为了符合其次坐标的形式，使最后一维为1</span>
    x3D <span class="token operator">=</span> x3D<span class="token punctuation">.</span><span class="token function">rowRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span>x3D<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
 * @brief 用位姿来对特征匹配点三角化，从中筛选中合格的三维点
 * 
 * @param[in] R                                     旋转矩阵R
 * @param[in] t                                     平移矩阵t
 * @param[in] vKeys1                                参考帧特征点  
 * @param[in] vKeys2                                当前帧特征点
 * @param[in] vMatches12                            两帧特征点的匹配关系
 * @param[in] vbMatchesInliers                      特征点对内点标记
 * @param[in] K                                     相机内参矩阵
 * @param[in &amp; out] vP3D                            三角化测量之后的特征点的空间坐标
 * @param[in] th2                                   重投影误差的阈值
 * @param[in &amp; out] vbGood                          标记成功三角化点？
 * @param[in &amp; out] parallax                        计算出来的比较大的视差角（注意不是最大，具体看后面代码）
 * @return int 
 */</span>
<span class="token keyword">int</span> <span class="token class-name">Initializer</span><span class="token double-colon punctuation">::</span><span class="token function">CheckRT</span><span class="token punctuation">(</span><span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>R<span class="token punctuation">,</span> <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>t<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>KeyPoint<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vKeys1<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>KeyPoint<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vKeys2<span class="token punctuation">,</span>
                       <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>Match<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vMatches12<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vbMatchesInliers<span class="token punctuation">,</span>
                       <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>K<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point3f<span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vP3D<span class="token punctuation">,</span> <span class="token keyword">float</span> th2<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>vbGood<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">&amp;</span>parallax<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>   
    <span class="token comment">// 对给出的特征点对及其R t , 通过三角化检查解的有效性，也称为 cheirality check</span>

    <span class="token comment">// Calibration parameters</span>
	<span class="token comment">//从相机内参数矩阵获取相机的校正参数</span>
    <span class="token keyword">const</span> <span class="token keyword">float</span> fx <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">float</span> fy <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">float</span> cx <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">float</span> cy <span class="token operator">=</span> K<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//特征点是否是good点的标记，这里的特征点指的是参考帧中的特征点</span>
    vbGood <span class="token operator">=</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>vKeys1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//重设存储空间坐标的点的大小</span>
    vP3D<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>vKeys1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//存储计算出来的每对特征点的视差</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> vCosParallax<span class="token punctuation">;</span>
    vCosParallax<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>vKeys1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Camera 1 Projection Matrix K[I|0]</span>
    <span class="token comment">// Step 1：计算相机的投影矩阵  </span>
    <span class="token comment">// 投影矩阵P是一个 3x4 的矩阵，可以将空间中的一个点投影到平面上，获得其平面坐标，这里均指的是齐次坐标。</span>
    <span class="token comment">// 对于第一个相机是 P1=K*[I|0]</span>
 
    <span class="token comment">// 以第一个相机的光心作为世界坐标系, 定义相机的投影矩阵</span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">P1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>				<span class="token comment">//矩阵的大小是3x4</span>
			   CV_32F<span class="token punctuation">,</span>			<span class="token comment">//数据类型是浮点数</span>
			   cv<span class="token double-colon punctuation">::</span><span class="token function">Scalar</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//初始的数值是0</span>
	<span class="token comment">//将整个K矩阵拷贝到P1矩阵的左侧3x3矩阵，因为 K*I = K</span>
    K<span class="token punctuation">.</span><span class="token function">copyTo</span><span class="token punctuation">(</span>P1<span class="token punctuation">.</span><span class="token function">rowRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">colRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 第一个相机的光心设置为世界坐标系下的原点</span>
    cv<span class="token double-colon punctuation">::</span>Mat O1 <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token class-name">Mat</span><span class="token double-colon punctuation">::</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Camera 2 Projection Matrix K[R|t]</span>
    <span class="token comment">// 计算第二个相机的投影矩阵 P2=K*[R|t]</span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">P2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span>
    R<span class="token punctuation">.</span><span class="token function">copyTo</span><span class="token punctuation">(</span>P2<span class="token punctuation">.</span><span class="token function">rowRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">colRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">copyTo</span><span class="token punctuation">(</span>P2<span class="token punctuation">.</span><span class="token function">rowRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//最终结果是K*[R|t]</span>
    P2 <span class="token operator">=</span> K<span class="token operator">*</span>P2<span class="token punctuation">;</span>
    <span class="token comment">// 第二个相机的光心在世界坐标系下的坐标</span>
    cv<span class="token double-colon punctuation">::</span>Mat O2 <span class="token operator">=</span> <span class="token operator">-</span>R<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>t<span class="token punctuation">;</span>

	<span class="token comment">//在遍历开始前，先将good点计数设置为0</span>
    <span class="token keyword">int</span> nGood<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">// 开始遍历所有的特征点对</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>size_t i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> iend<span class="token operator">=</span>vMatches12<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>iend<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>

		<span class="token comment">// 跳过outliers</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vbMatchesInliers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>

        <span class="token comment">// Step 2 获取特征点对，调用Triangulate() 函数进行三角化，得到三角化测量之后的3D点坐标</span>
        <span class="token comment">// kp1和kp2是匹配好的有效特征点</span>
        <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>KeyPoint <span class="token operator">&amp;</span>kp1 <span class="token operator">=</span> vKeys1<span class="token punctuation">[</span>vMatches12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> cv<span class="token double-colon punctuation">::</span>KeyPoint <span class="token operator">&amp;</span>kp2 <span class="token operator">=</span> vKeys2<span class="token punctuation">[</span>vMatches12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token comment">//存储三维点的的坐标</span>
        cv<span class="token double-colon punctuation">::</span>Mat p3dC1<span class="token punctuation">;</span>

        <span class="token comment">// 利用三角法恢复三维点p3dC1</span>
        <span class="token function">Triangulate</span><span class="token punctuation">(</span>kp1<span class="token punctuation">,</span>kp2<span class="token punctuation">,</span>	<span class="token comment">//特征点</span>
					P1<span class="token punctuation">,</span>P2<span class="token punctuation">,</span>		<span class="token comment">//投影矩阵</span>
					p3dC1<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//输出，三角化测量之后特征点的空间坐标		</span>

		<span class="token comment">// Step 3 第一关：检查三角化的三维点坐标是否合法（非无穷值）</span>
        <span class="token comment">// 只要三角测量的结果中有一个是无穷大的就说明三角化失败，跳过对当前点的处理，进行下一对特征点的遍历 </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isfinite</span><span class="token punctuation">(</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isfinite</span><span class="token punctuation">(</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isfinite</span><span class="token punctuation">(</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//其实这里就算是不这样写也没问题，因为默认的匹配点对就不是good点</span>
            vbGood<span class="token punctuation">[</span>vMatches12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token comment">//继续对下一对匹配点的处理</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Check parallax</span>
        <span class="token comment">// Step 4 第二关：通过三维点深度值正负、两相机光心视差角大小来检查是否合法 </span>

        <span class="token comment">//得到向量PO1</span>
        cv<span class="token double-colon punctuation">::</span>Mat normal1 <span class="token operator">=</span> p3dC1 <span class="token operator">-</span> O1<span class="token punctuation">;</span>
		<span class="token comment">//求取模长，其实就是距离</span>
        <span class="token keyword">float</span> dist1 <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">norm</span><span class="token punctuation">(</span>normal1<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//同理构造向量PO2</span>
        cv<span class="token double-colon punctuation">::</span>Mat normal2 <span class="token operator">=</span> p3dC1 <span class="token operator">-</span> O2<span class="token punctuation">;</span>
		<span class="token comment">//求模长</span>
        <span class="token keyword">float</span> dist2 <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">norm</span><span class="token punctuation">(</span>normal2<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//根据公式：a.*b=|a||b|cos_theta 可以推导出来下面的式子</span>
        <span class="token keyword">float</span> cosParallax <span class="token operator">=</span> normal1<span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>normal2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>dist1<span class="token operator">*</span>dist2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Check depth in front of first camera (only if enough parallax, as "infinite" points can easily go to negative depth)</span>
        <span class="token comment">// 如果深度值为负值，为非法三维点跳过该匹配点对</span>
        <span class="token comment">// ?视差比较小时，重投影误差比较大。这里0.99998 对应的角度为0.36°,这里不应该是 cosParallax&gt;0.99998 吗？</span>
        <span class="token comment">// ?因为后面判断vbGood 点时的条件也是 cosParallax&lt;0.99998 </span>
        <span class="token comment">// !可能导致初始化不稳定</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> cosParallax<span class="token operator">&lt;</span><span class="token number">0.99998</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>

        <span class="token comment">// Check depth in front of second camera (only if enough parallax, as "infinite" points can easily go to negative depth)</span>
        <span class="token comment">// 讲空间点p3dC1变换到第2个相机坐标系下变为p3dC2</span>
        cv<span class="token double-colon punctuation">::</span>Mat p3dC2 <span class="token operator">=</span> R<span class="token operator">*</span>p3dC1<span class="token operator">+</span>t<span class="token punctuation">;</span>	
		<span class="token comment">//判断过程和上面的相同</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>p3dC2<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> cosParallax<span class="token operator">&lt;</span><span class="token number">0.99998</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>

        <span class="token comment">// Step 5 第三关：计算空间点在参考帧和当前帧上的重投影误差，如果大于阈值则舍弃</span>
        <span class="token comment">// Check reprojection error in first image</span>
        <span class="token comment">// 计算3D点在第一个图像上的投影误差</span>
		<span class="token comment">//投影到参考帧图像上的点的坐标x,y</span>
        <span class="token keyword">float</span> im1x<span class="token punctuation">,</span> im1y<span class="token punctuation">;</span>
		<span class="token comment">//这个使能空间点的z坐标的倒数</span>
        <span class="token keyword">float</span> invZ1 <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">/</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//投影到参考帧图像上。因为参考帧下的相机坐标系和世界坐标系重合，因此这里就直接进行投影就可以了</span>
        im1x <span class="token operator">=</span> fx<span class="token operator">*</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span>invZ1<span class="token operator">+</span>cx<span class="token punctuation">;</span>
        im1y <span class="token operator">=</span> fy<span class="token operator">*</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>invZ1<span class="token operator">+</span>cy<span class="token punctuation">;</span>

		<span class="token comment">//参考帧上的重投影误差，这个的确就是按照定义来的</span>
        <span class="token keyword">float</span> squareError1 <span class="token operator">=</span> <span class="token punctuation">(</span>im1x<span class="token operator">-</span>kp1<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>im1x<span class="token operator">-</span>kp1<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>im1y<span class="token operator">-</span>kp1<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>im1y<span class="token operator">-</span>kp1<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 重投影误差太大，跳过淘汰</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>squareError1<span class="token operator">&gt;</span>th2<span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>

        <span class="token comment">// Check reprojection error in second image</span>
        <span class="token comment">// 计算3D点在第二个图像上的投影误差，计算过程和第一个图像类似</span>
        <span class="token keyword">float</span> im2x<span class="token punctuation">,</span> im2y<span class="token punctuation">;</span>
        <span class="token comment">// 注意这里的p3dC2已经是第二个相机坐标系下的三维点了</span>
        <span class="token keyword">float</span> invZ2 <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">/</span>p3dC2<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        im2x <span class="token operator">=</span> fx<span class="token operator">*</span>p3dC2<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">*</span>invZ2<span class="token operator">+</span>cx<span class="token punctuation">;</span>
        im2y <span class="token operator">=</span> fy<span class="token operator">*</span>p3dC2<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>invZ2<span class="token operator">+</span>cy<span class="token punctuation">;</span>

		<span class="token comment">// 计算重投影误差</span>
        <span class="token keyword">float</span> squareError2 <span class="token operator">=</span> <span class="token punctuation">(</span>im2x<span class="token operator">-</span>kp2<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>im2x<span class="token operator">-</span>kp2<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>im2y<span class="token operator">-</span>kp2<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>im2y<span class="token operator">-</span>kp2<span class="token punctuation">.</span>pt<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 重投影误差太大，跳过淘汰</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>squareError2<span class="token operator">&gt;</span>th2<span class="token punctuation">)</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>

        <span class="token comment">// Step 6 统计经过检验的3D点个数，记录3D点视差角 </span>
        <span class="token comment">// 如果运行到这里就说明当前遍历的这个特征点对靠谱，经过了重重检验，说明是一个合格的点，称之为good点 </span>
        vCosParallax<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cosParallax<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//存储这个三角化测量后的3D点在世界坐标系下的坐标</span>
        vP3D<span class="token punctuation">[</span>vMatches12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">]</span> <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Point3f</span><span class="token punctuation">(</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>p3dC1<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//good点计数++</span>
        nGood<span class="token operator">++</span><span class="token punctuation">;</span>

		<span class="token comment">//判断视差角，只有视差角稍稍大一丢丢的才会给打good点标记</span>
		<span class="token comment">//? bug 我觉得这个写的位置不太对。你的good点计数都++了然后才判断，不是会让good点标志和good点计数不一样吗</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>cosParallax<span class="token operator">&lt;</span><span class="token number">0.99998</span><span class="token punctuation">)</span>
            vbGood<span class="token punctuation">[</span>vMatches12<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Step 7 得到3D点中较大的视差角，并且转换成为角度制表示</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nGood<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 从小到大排序，注意vCosParallax值越大，视差越小</span>
        <span class="token function">sort</span><span class="token punctuation">(</span>vCosParallax<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>vCosParallax<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// !排序后并没有取最小的视差角，而是取一个较小的视差角</span>
		<span class="token comment">// 作者的做法：如果经过检验过后的有效3D点小于50个，那么就取最后那个最小的视差角(cos值最大)</span>
		<span class="token comment">// 如果大于50个，就取排名第50个的较小的视差角即可，为了避免3D点太多时出现太小的视差角 </span>
        size_t idx <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">(</span>vCosParallax<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//将这个选中的角弧度制转换为角度制</span>
        parallax <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>vCosParallax<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">180</span><span class="token operator">/</span>CV_PI<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
		<span class="token comment">//如果没有good点那么这个就直接设置为0了</span>
        parallax<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">//返回good点计数</span>
    <span class="token keyword">return</span> nGood<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p> </p> 
<h3><a id="_369"></a>六、结语</h3> 
<p>通过该篇博客的介绍，我们已经知道如何对特征点进行三角化。并且验证其三维点是否合格。如果合格我们则认为该三维点是一个正确的三维点。再结合前面的博客与代码。我们知道求解出多组 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 时，使用每组 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 对所有的特征点对进行三角化，然后选择正确三角化数量最多的一组 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         R 
        
       
         t 
        
       
      
        \mathbf R\mathbf t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6861em;"></span><span class="mord mathbf">Rt</span></span></span></span></span> 为最终解。</p> 
<p> <br>  <br> 本文内容来自计算机视觉life ORB-SLAM2 课程课件</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/20a4a6a5abff8bbcfdcb3e5117b8e1c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PT_中心极限定理CLT:棣莫佛－拉普拉斯定理de Moivre - Laplace CLT&#43;林德伯格－列维(Lindeberg-Levy)定理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9d12c3d3a5d17f779a9ff61baf8ca0bb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">es---elasticsearch-篇二：idea操作es，常用查询DSL</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>