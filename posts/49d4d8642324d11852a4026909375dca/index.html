<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Oracle-常用调优方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Oracle-常用调优方法" />
<meta property="og:description" content="oracle 常用调优方法 Oracle数据库应用系统的调优主要包括十个方面：
(1)、优化数据库内存；
(2)、在Oracle共享池中固定应用程序代码；
(3)、优化数据存储；
(4)、优化数据排序的技术；
(5)、优化SQL语句；
(6)、优化回退段；
(7)、优化索引；
(8)、优化磁盘I/O；
(9)、定期生成数据库对象的状态统计信息；
(10)、优化操作系统环境。
其实质就是降低CPU负载、改善I/O性能。
1、化磁盘I/O
数据库的作用就是实现对数据的管理和查询，所以必然存在对数据的大量读写操作，其I/O问题也往往是导致Oracle数据库性能问题的重要原因。
1.1、Oracle中I/O的产生
1.2、优化OS存储
一、在UNIT环境下，采用裸设备（Raw Device）作为Oracle数据文件的存储设备比采文件系统（File System）存储Oracle数据文件具有较高的读写效率。
二、采用异步IO（Asynchronous IO）方式。在异步IO模式下，进程发出IO请求后无需等待IO完成，可以去处理其它事情；IO请求被放入一个队列中，一旦IO完成，系统会发出信号通知进程。异步IO可以使需要大量写的Oracle进程（如DBWn进程）将IO请求队列化，以充分利用硬件的IO带宽，从而使它们能最大程度实现并行处理。确认操作系统已经设置支持AIO后，还需要设置Oracle初始化参数“DISK_ASYNCH_IO”为“true”以支持异步IO。
三、磁盘负载均衡及条带化（Striping）。条带化技术就是将数据分成很多小部分并把他们分别存储到不同磁盘上的不同区域中去。这就能使多个进程同时访问数据的多个不同部分而不会造成磁盘冲突。很多操作系统、磁盘设备供应商、各种第三方软件都能做到条带化。通过条带化，DBA可以很轻松的做到IO负载均衡而无需去手工配置。
1.3、优化IO配置
一、利用LVM（Logical Volume Manager逻辑卷管理器）软件合理的配置条带的宽度和深度。
二、采用分离文件策略，避免磁盘热点。尽管我们在硬件和操作系统层面通过磁盘条带化实现了磁盘负载均衡，但我们依然不能避免某些数据文件成为“热点文件”。
分离表、索引和临时表空间的存储，即为应用系统建立单独的数据表空间、索引表空间、临时表空间。
分离重做日志(Redo Log)文件。如果Redo Log文件的IO吞吐率高，则应将Redo Log存储在单独磁盘上，在有充裕磁盘的的情况下，应将Redo Log文件条带化分布到多个磁盘上去；
分离归档日志文件(Archive Log)。当ORACLE数据库运行在归档模式下时，归档进程(ARCn )必然会产生大量的磁盘读写。所以应将归档日志文件条带化分布到多个磁盘上单独存储。
1.4、优化ORACLE I/O相关的参数设置
db_file_multiblock_read_count：用于控制一个完全连续扫描中一次 I/O 操作所读取的数据块的最大值。默认值8
db_writer_processes：数据库“写进程”的初始数量。
disk_asynch_io：用于控制数据文件、 控制文件和日志文件的 I/O 是否异步 。只有在平台支持磁盘异步 I/O的情况下才能更改该参数。
log_archive_max_processes：指定归档模式下ARCH 进程的数量。
2.优化数据存储
2.1、表空间优化
SYSTEM表空间用于存放ORACLE系统的有关信息，一般的用户建立的对象（object）不应放在SYSTEM表空间中，另外还需要注意增加SYSTEM表空间合适的大小，保证有100M左右的空闲空间。
对于ORACLE的数据库应用系统，都应该为应用系统建立独立的ORACLE用户(scheme)、数据表空间、索引表空间、临时表空间。应将表空间及数据文件一次性设置成合适的大小，避免数据文件自动增长，造成数据段块/段的不连续，影响系统性能。
定期检查数据库表空间的使用情况，防止表空间碎块过多，影响系统性能。通过查询视图dba_extents可获取表空间详细的使用情况。
整理表空间碎片，回收数据表段的可用空间。
合并表空间碎片
alter tablespace tablespacename coalesce;
回收数据表段的空闲空间
alter table tablename deallocate unused;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/49d4d8642324d11852a4026909375dca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-03T14:34:34+08:00" />
<meta property="article:modified_time" content="2018-09-03T14:34:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Oracle-常用调优方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0cm;"><a href="http://www.cnblogs.com/lostyue/archive/2012/03/30/2424478.html" rel="nofollow"><strong><span style="color:#444444;">oracle </span></strong><strong><span style="color:#444444;">常用调优方法</span></strong></a><strong> </strong></p> 
<p style="margin-left:0cm;"><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">Oracle</span></strong></a><span style="color:#000000;">数据库应用系统的调优主要包括十个方面：</span><br><span style="color:#000000;">(1)</span><span style="color:#000000;">、优化</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">数据库</span></strong></a><span style="color:#000000;">内存；</span><br><span style="color:#000000;">(2)</span><span style="color:#000000;">、在</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">共享池中固定应用程序代码；</span><br><span style="color:#000000;">(3)</span><span style="color:#000000;">、优化数据存储；</span><br><span style="color:#000000;">(4)</span><span style="color:#000000;">、优化数据排序的技术；</span><br><span style="color:#000000;">(5)</span><span style="color:#000000;">、优化</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">SQL</span></strong></a><span style="color:#000000;">语句；</span><br><span style="color:#000000;">(6)</span><span style="color:#000000;">、优化回退段；</span><br><span style="color:#000000;">(7)</span><span style="color:#000000;">、优化索引；</span><br><span style="color:#000000;">(8)</span><span style="color:#000000;">、优化磁盘</span><span style="color:#000000;">I/O</span><span style="color:#000000;">；</span><br><span style="color:#000000;">(9)</span><span style="color:#000000;">、定期生成数据库对象的状态统计信息；</span><br><span style="color:#000000;">(10)</span><span style="color:#000000;">、优化操作系统环境。</span><br><span style="color:#000000;">其实质就是降低</span><span style="color:#000000;">CPU</span><span style="color:#000000;">负载、改善</span><span style="color:#000000;">I/O</span><span style="color:#000000;">性能。</span></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#000000;">1</span><span style="color:#000000;">、化磁盘</span><span style="color:#000000;">I/O</span><br><span style="color:#000000;">数据库的作用就是实现对数据的</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">管理</span></strong></a><span style="color:#000000;">和查询，所以必然存在对数据的大量读写操作，其</span><span style="color:#000000;">I/O</span><span style="color:#000000;">问题也往往是导致</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">数据库性能问题的重要原因。</span><br><span style="color:#000000;">1.1</span><span style="color:#000000;">、</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">中</span><span style="color:#000000;">I/O</span><span style="color:#000000;">的产生</span><br><span style="color:#000000;">1.2</span><span style="color:#000000;">、优化</span><span style="color:#000000;">OS</span><span style="color:#000000;">存储</span><br><span style="color:#000000;">一、在</span><span style="color:#000000;">UNIT</span><span style="color:#000000;">环境下，采用裸设备（</span><span style="color:#000000;">Raw Device</span><span style="color:#000000;">）作为</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">数据文件的存储设备比采文件系统（</span><span style="color:#000000;">File System</span><span style="color:#000000;">）存储</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">数据文件具有较高的读写效率。</span><br><span style="color:#000000;">二、采用异步</span><span style="color:#000000;">IO</span><span style="color:#000000;">（</span><span style="color:#000000;">Asynchronous IO</span><span style="color:#000000;">）方式。在异步</span><span style="color:#000000;">IO</span><span style="color:#000000;">模式下，进程发出</span><span style="color:#000000;">IO</span><span style="color:#000000;">请求后无需等待</span><span style="color:#000000;">IO</span><span style="color:#000000;">完成，可以去处理其它事情；</span><span style="color:#000000;">IO</span><span style="color:#000000;">请求被放入一个队列中，一旦</span><span style="color:#000000;">IO</span><span style="color:#000000;">完成，系统会发出信号通知进程。异步</span><span style="color:#000000;">IO</span><span style="color:#000000;">可以使需要大量写的</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">进程（如</span><span style="color:#000000;">DBWn</span><span style="color:#000000;">进程）将</span><span style="color:#000000;">IO</span><span style="color:#000000;">请求队列化，以充分利用硬件的</span><span style="color:#000000;">IO</span><span style="color:#000000;">带宽，从而使它们能最大程度实现并行处理。确认操作系统已经设置支持</span><span style="color:#000000;">AIO</span><span style="color:#000000;">后，还需要设置</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">初始化参数</span><span style="color:#000000;">“DISK_ASYNCH_IO”</span><span style="color:#000000;">为</span><span style="color:#000000;">“true”</span><span style="color:#000000;">以支持异步</span><span style="color:#000000;">IO</span><span style="color:#000000;">。</span><br><span style="color:#000000;">三、磁盘负载均衡及条带化（</span><span style="color:#000000;">Striping</span><span style="color:#000000;">）。条带化技术就是将数据分成很多小部分并把他们分别存储到不同磁盘上的不同区域中去。这就能使多个进程同时访问数据的多个不同部分而不会造成磁盘冲突。很多操作系统、磁盘设备供应商、各种第三方</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">软件</span></strong></a><span style="color:#000000;">都能做到条带化。通过条带化，</span><span style="color:#000000;">DBA</span><span style="color:#000000;">可以很轻松的做到</span><span style="color:#000000;">IO</span><span style="color:#000000;">负载均衡而无需去手工配置。</span><br><span style="color:#000000;">1.3</span><span style="color:#000000;">、优化</span><span style="color:#000000;">IO</span><span style="color:#000000;">配置</span><br><span style="color:#000000;">一、利用</span><span style="color:#000000;">LVM</span><span style="color:#000000;">（</span><span style="color:#000000;">Logical Volume Manager</span><span style="color:#000000;">逻辑卷管理器）软件合理的配置条带的宽度和深度。</span><br><span style="color:#000000;">二、采用分离文件策略，避免磁盘热点。尽管我们在硬件和操作系统层面通过磁盘条带化实现了磁盘负载均衡，但我们依然不能避免某些数据文件成为</span><span style="color:#000000;">“</span><span style="color:#000000;">热点文件</span><span style="color:#000000;">”</span><span style="color:#000000;">。</span><br><span style="color:#000000;">分离表、索引和临时表空间的存储，即为应用系统建立单独的数据表空间、索引表空间、临时表空间。</span><br><span style="color:#000000;">分离重做日志</span><span style="color:#000000;">(Redo Log)</span><span style="color:#000000;">文件。如果</span><span style="color:#000000;">Redo Log</span><span style="color:#000000;">文件的</span><span style="color:#000000;">IO</span><span style="color:#000000;">吞吐率高，则应将</span><span style="color:#000000;">Redo Log</span><span style="color:#000000;">存储在单独磁盘上，在有充裕磁盘的的情况下，应将</span><span style="color:#000000;">Redo Log</span><span style="color:#000000;">文件条带化分布到多个磁盘上去；</span><br><span style="color:#000000;">分离归档日志文件</span><span style="color:#000000;">(Archive Log)</span><span style="color:#000000;">。当</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">数据库运行在归档模式下时，归档进程</span><span style="color:#000000;">(ARCn )</span><span style="color:#000000;">必然会产生大量的磁盘读写。所以应将归档日志文件条带化分布到多个磁盘上单独存储。</span><br><span style="color:#000000;">1.4</span><span style="color:#000000;">、优化</span><span style="color:#000000;">ORACLE I/O</span><span style="color:#000000;">相关的参数设置</span><br><span style="color:#000000;">db_file_multiblock_read_count</span><span style="color:#000000;">：用于控制一个完全连续扫描中一次</span><span style="color:#000000;"> I/O </span><span style="color:#000000;">操作所读取的数据块的最大值。默认值</span><span style="color:#000000;">8<br> db_writer_processes</span><span style="color:#000000;">：数据库</span><span style="color:#000000;">“</span><span style="color:#000000;">写进程</span><span style="color:#000000;">”</span><span style="color:#000000;">的初始数量。</span><br><span style="color:#000000;">disk_asynch_io</span><span style="color:#000000;">：用于控制数据文件、</span> <span style="color:#000000;">控制文件和日志文件的</span><span style="color:#000000;"> I/O </span><span style="color:#000000;">是否异步</span> <span style="color:#000000;">。只有在平台支持磁盘异步</span><span style="color:#000000;"> I/O</span><span style="color:#000000;">的情况下才能更改该参数。</span><br><span style="color:#000000;">log_archive_max_processes</span><span style="color:#000000;">：指定归档模式下</span><span style="color:#000000;">ARCH </span><span style="color:#000000;">进程的数量。</span></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#000000;">2.</span><span style="color:#000000;">优化数据存储</span><br><br><span style="color:#000000;">2.1</span><span style="color:#000000;">、表空间优化</span><br><span style="color:#000000;">SYSTEM</span><span style="color:#000000;">表空间用于存放</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">系统的有关信息，一般的用户建立的对象（</span><span style="color:#000000;">object</span><span style="color:#000000;">）不应放在</span><span style="color:#000000;">SYSTEM</span><span style="color:#000000;">表空间中，另外还需要注意增加</span><span style="color:#000000;">SYSTEM</span><span style="color:#000000;">表空间合适的大小，保证有</span><span style="color:#000000;">100M</span><span style="color:#000000;">左右的空闲空间。</span><br><span style="color:#000000;">对于</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">的数据库应用系统，都应该为应用系统建立独立的</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">用户</span><span style="color:#000000;">(scheme)</span><span style="color:#000000;">、数据表空间、索引表空间、临时表空间。应将表空间及数据文件一次性设置成合适的大小，避免数据文件自动增长，造成数据段块</span><span style="color:#000000;">/</span><span style="color:#000000;">段的不连续，影响系统性能。</span><br><span style="color:#000000;">定期检查数据库表空间的使用情况，防止表空间碎块过多，影响系统性能。通过查询视图</span><span style="color:#000000;">dba_extents</span><span style="color:#000000;">可获取表空间详细的使用情况。</span><br><span style="color:#000000;">整理表空间碎片，回收数据表段的可用空间。</span><br><span style="color:#000000;">合并表空间碎片</span><br><span style="color:#000000;">alter tablespace tablespacename coalesce;</span><br><span style="color:#000000;">回收数据表段的空闲空间</span><br><span style="color:#000000;">alter table tablename deallocate unused;<br><br> 2.2</span><span style="color:#000000;">、合理配置回滚段大小</span><br><span style="color:#000000;">在</span><span style="color:#000000;">Oracle 9i</span><span style="color:#000000;">以后，系统采用了透明的本地化的管理方式。默认情况下，回滚段表空间是比较小的，往往不能满足实际应用中处理大型的事务的需要，就需要为专门的大型应用或事务建立大的回滚段。</span><br><br><span style="color:#000000;">2.3</span><span style="color:#000000;">、临时表空间设计规划</span><br><span style="color:#000000;">临时表空间主要用于查询操作中的</span><span style="color:#000000;">distinct </span><span style="color:#000000;">、</span><span style="color:#000000;">union </span><span style="color:#000000;">、</span><span style="color:#000000;">order by</span><span style="color:#000000;">以及</span><span style="color:#000000;">create index</span><span style="color:#000000;">操作及存储临时表数据等。</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">缺省表空间为</span><span style="color:#000000;">Temp</span><span style="color:#000000;">，其大小为</span><span style="color:#000000;">1MB</span><span style="color:#000000;">，对于一个真正的中、大型应用系统是远远不够的，因此需做如下工作：</span><br><span style="color:#000000;">增加</span><span style="color:#000000;">Temp</span><span style="color:#000000;">表空间到合适的大小，一般为</span><span style="color:#000000;">300M-500M</span><span style="color:#000000;">左右。</span><br><span style="color:#000000;">创建用户时应为其选择专用的临时表空间。</span><br><span style="color:#000000;">应该为大的应用系统建立专门的大的临时表空间，用于进行系统的月报、季报、年报统计存储临时表数据等。</span><br><br><span style="color:#000000;">2.4</span><span style="color:#000000;">、将数据文件和日志文件存储于不同磁盘上</span><br><span style="color:#000000;">数据文件的写入是通过</span><span style="color:#000000;">DBWR</span><span style="color:#000000;">后台进程实现，日志文件的写入是通过</span><span style="color:#000000;">LGWR</span><span style="color:#000000;">后台进程实现，由于日志文件是连续的写入，因此无并发处理现象。而数据文件的写入相对是随机的，为避免在同一时间内</span><span style="color:#000000;">DBWR</span><span style="color:#000000;">和</span><span style="color:#000000;">LGWR</span><span style="color:#000000;">的冲突，应将日志文件和数据文件放在不同的硬盘上。</span><br><span style="color:#000000;">另外，在</span><span style="color:#000000;">ARCHIVELOG</span><span style="color:#000000;">模式时，也可能产生日志文件写磁盘与日志归档间的冲突，这种冲突的避免只能通过将日志文件分配到多个磁盘才能解决。</span></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#000000;">3</span><span style="color:#000000;">、优化操作系统环境</span><br><br><span style="color:#000000;">3.1</span><span style="color:#000000;">、配置操作系统合适的信号量</span><br><span style="color:#000000;">Oracle</span><span style="color:#000000;">在某些</span><span style="color:#000000;">Unix</span><span style="color:#000000;">操作系统环境下运行需要合适的操作系统信号量。应该根据</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">版本发行的要求进行设置，譬如在</span><span style="color:#000000;">SOLARIS</span><span style="color:#000000;">环境下，需要以</span><span style="color:#000000;">root </span><span style="color:#000000;">登录并根据</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">安装手册的参数要求修改</span><span style="color:#000000;">/etc</span><span style="color:#000000;">目录的</span><span style="color:#000000;">system</span><span style="color:#000000;">文件。</span><br><br><span style="color:#000000;">3.2</span><span style="color:#000000;">、配置合适大小的交换区</span><br><span style="color:#000000;">在</span><span style="color:#000000;">UNIX</span><span style="color:#000000;">操作系统环境下，交换区是</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">的一项基本的要求。可以根据</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">的发行要求来确定。建议交换区的大小是该</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">服务器</span></strong></a><span style="color:#000000;">内存的</span><span style="color:#000000;">2</span><span style="color:#000000;">倍以上。</span><br><br><span style="color:#000000;">3.3</span><span style="color:#000000;">、配置操作系统启用异步</span><span style="color:#000000;">I/O</span><br><span style="color:#000000;">目前大多数操作系统都支持异步</span><span style="color:#000000;">I/O</span><span style="color:#000000;">，但如果让</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">运行在异步</span><span style="color:#000000;">I/O</span><span style="color:#000000;">模式下，就必须做相应的配置。譬如在</span><span style="color:#000000;">HP</span><span style="color:#000000;">－</span><span style="color:#000000;">UNIX</span><span style="color:#000000;">下，需要把</span><span style="color:#000000;">“/dev /async”</span><span style="color:#000000;">授权给操作系统的</span><span style="color:#000000;">oracle</span><span style="color:#000000;">用户</span><span style="color:#000000;">,</span><span style="color:#000000;">并且要修改</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">参数</span><span style="color:#000000;">disk_asynch_io</span><span style="color:#000000;">＝</span><span style="color:#000000;">true</span><span style="color:#000000;">。</span><br><br><span style="color:#000000;">3.4</span><span style="color:#000000;">、将</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">的</span><span style="color:#000000;">SGA</span><span style="color:#000000;">锁定在物理内存中。</span><br><span style="color:#000000;">几乎所有的操作系统都支持虚拟内存，所以即使我们使用的内存小于物理内存，也不能避免操作系统将</span><span style="color:#000000;">SGA</span><span style="color:#000000;">交换到虚拟内存（</span><span style="color:#000000;">SWAP</span><span style="color:#000000;">），通过相应配置将</span><span style="color:#000000;">Oracle SGA</span><span style="color:#000000;">锁定在物理内存避免被交换到虚拟内存中，可以减少页面的换入和换出，从而提高性能。</span><br><span style="color:#000000;">HP-UNIX</span><span style="color:#000000;">下的配置方法：</span><br><span style="color:#000000;">#/etc/setprivgrp dba MLOCK</span><br><span style="color:#000000;">调整</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">参数：</span><span style="color:#000000;">lock_sga</span><span style="color:#000000;">＝</span><span style="color:#000000;">TRUE</span><br><span style="color:#000000;">重启数据库</span><br><span style="color:#000000;">AIX 5L</span><span style="color:#000000;">（</span><span style="color:#000000;">AIX 4.3.3</span><span style="color:#000000;">）下的配置方法：</span><br><span style="color:#000000;">$/usr/sbin/vmo -r -o v_pinshm=1</span><span style="color:#000000;">（或</span><span style="color:#000000;">vmtune -s 1</span><span style="color:#000000;">）</span><br><span style="color:#000000;">调整</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">参数：</span><span style="color:#000000;">lock_sga</span><span style="color:#000000;">＝</span><span style="color:#000000;">TRUE</span><br><span style="color:#000000;">重启数据库</span><br><br><span style="color:#000000;">3.5</span><span style="color:#000000;">、控制内存交换操作</span><span style="color:#000000;">(Paging)</span><br><span style="color:#000000;">大量的内存交换操作会极大地影响系统的性能，尤其是在当数据库文件创建在文件系统上时影响更大。在这种情况下经常访问的数据，即在</span><span style="color:#000000;">SGA</span><span style="color:#000000;">中存在也同样在文件的缓存中存在。这种相同的数据在内存中缓存两次的情况，会降低内存的使用效率，从而使内存频繁进行交换操作，造成系统的</span><span style="color:#000000;">I/O</span><span style="color:#000000;">瓶颈，降低整个系统的性能。</span> <span style="color:#000000;">通过将</span><span style="color:#000000;">ORACLE</span><span style="color:#000000;">数据文件建在裸设备上和调整系统文件缓存，可以有效降低内存交换操作。</span><br><span style="color:#000000;">在</span><span style="color:#000000;">AIX</span><span style="color:#000000;">上，可以通过</span><span style="color:#000000;">vmtune</span><span style="color:#000000;">命令中的</span><span style="color:#000000;">MINPERM</span><span style="color:#000000;">（缺省值</span><span style="color:#000000;">20</span><span style="color:#000000;">）和</span><span style="color:#000000;">MAXPERM</span><span style="color:#000000;">（缺省值</span><span style="color:#000000;">80</span><span style="color:#000000;">）参数来调整系统文件缓存，用以控制内存交换操作。一般将</span><span style="color:#000000;">MINPERM</span><span style="color:#000000;">和</span><span style="color:#000000;">MAXPERM</span><span style="color:#000000;">分别设为</span><span style="color:#000000;">5%</span><span style="color:#000000;">和</span><span style="color:#000000;">20%</span><span style="color:#000000;">甚至更小，可使内存更多地被用于</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">的</span><span style="color:#000000;">SGA</span><span style="color:#000000;">而不是系统的文件缓存。</span><br><span style="color:#000000;">＃</span><span style="color:#000000;">vmtune -p 5 -P 20</span><br><span style="color:#000000;">在</span><span style="color:#000000;">HP-UINX 10.X</span><span style="color:#000000;">以前的版本中，分配过大的文件系统缓存，也会导致</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">的</span><span style="color:#000000;">SGA</span><span style="color:#000000;">被交换到虚拟内存中去。在</span><span style="color:#000000;">10.X</span><span style="color:#000000;">以后的版本中文件系统缓存动态分配。不合理的设置</span><span style="color:#000000;">dbc_min_pct</span><span style="color:#000000;">和</span><span style="color:#000000;">dbc_max_pct</span><span style="color:#000000;">也会导致无法解释的偶然或间歇性停顿出现。</span></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><span style="color:#000000;">4.</span><span style="color:#000000;">优化数据库内存</span><br><br><span style="color:#000000;">4.1</span><span style="color:#000000;">、</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">内存结构</span><br><br><span style="color:#000000;">4.2</span><span style="color:#000000;">、优化</span><span style="color:#000000;">SGA(System Global Area )</span><br><span style="color:#000000;">对于</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">内存的调整设置，要根据实际情况酌情考虑，基本的原则是：</span><br><span style="color:#000000;">数据缓冲区</span><span style="color:#000000;">(</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">data</span></strong></a><span style="color:#000000;"> buffer)</span><span style="color:#000000;">：用于存放从数据文件读入的数据块，可以尽可能的大；</span><br><span style="color:#000000;">共享池</span><span style="color:#000000;">(shared_pool_size)</span><span style="color:#000000;">：用于保存数据字典及当前执行的</span><span style="color:#000000;">SQL</span><span style="color:#000000;">语句和存储过程，要适度；</span><br><span style="color:#000000;">日志缓冲区</span><span style="color:#000000;">(log_buffer)</span><span style="color:#000000;">：用于缓存用户更新的数据，不需太大。</span><br><span style="color:#000000;">shared_pool_size</span><span style="color:#000000;">：要大小要适度，通常设为</span><span style="color:#000000;">500M</span><span style="color:#000000;">左右，不应超过</span><span style="color:#000000;">700M</span><span style="color:#000000;">。</span><br><span style="color:#000000;">log_buffer </span><span style="color:#000000;">：通常设为</span><span style="color:#000000;">512K</span><span style="color:#000000;">到</span><span style="color:#000000;">1M</span><span style="color:#000000;">。</span><br><span style="color:#000000;">large_pool_size </span><span style="color:#000000;">：如果不设置</span><span style="color:#000000;">MTS</span><span style="color:#000000;">（</span><span style="color:#000000;">Multi-Threaded </span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">Server</span></strong></a><span style="color:#000000;">），该部分内存只会在</span><span style="color:#000000;"> RMAN</span><span style="color:#000000;">（恢复管理）</span> <span style="color:#000000;">、</span><span style="color:#000000;">OPQ</span><span style="color:#000000;">（并行查询）</span> <span style="color:#000000;">中使用到，通常设置为是</span><span style="color:#000000;">16M-64M </span><span style="color:#000000;">。</span><br><span style="color:#000000;">java_pool_size : </span><span style="color:#000000;">如果在数据库里不使用</span><a href="http://space.itpub.net/777981/viewspace-660805" rel="nofollow"><strong><span style="color:#0069d6;">java</span></strong></a><span style="color:#000000;">，通常设置为</span><span style="color:#000000;">16M</span><span style="color:#000000;">。</span><br><span style="color:#000000;">data buffer </span><span style="color:#000000;">：在做了上面的设置后，凡可以提供给</span><span style="color:#000000;">Oracle</span><span style="color:#000000;">的内存，都应该给</span><span style="color:#000000;">data buffer = (db_block_size * db_block_buffers) </span><span style="color:#000000;">。</span><br><span style="color:#000000;">SGA=data buffer+shared_pool_size+log_buffer+java_pool_size+large_pool_size<br><br> 4.3</span><span style="color:#000000;">、优化</span><span style="color:#000000;">PGA (Program Global Area )<br> sort_area_size</span><span style="color:#000000;">：默认</span><span style="color:#000000;">64K,</span><span style="color:#000000;">通常设置为</span><span style="color:#000000;">128K</span><span style="color:#000000;">到</span><span style="color:#000000;">512K<br> hash_area_size:</span><span style="color:#000000;">不做配置，是根据</span><span style="color:#000000;">2*sort_area_size</span><span style="color:#000000;">计算得到</span><br><span style="color:#000000;">这两个参数在非</span><span style="color:#000000;">MTS</span><span style="color:#000000;">下都是属于</span><span style="color:#000000;">PGA(Program Global Area)</span><span style="color:#000000;">，不属于</span><span style="color:#000000;">SGA</span><span style="color:#000000;">。它是为每个</span><span style="color:#000000;">session</span><span style="color:#000000;">单独分配的，所以服务器上内存开销情况通常要求：</span><span style="color:#000000;">OS</span><span style="color:#000000;">内存</span><span style="color:#000000;">+SGA+session* (sort_area_size+hash_area_size+2M)&lt;</span><span style="color:#000000;">总物理</span><span style="color:#000000;">RAM</span><span style="color:#000000;">。</span></p> 
<p style="margin-left:0cm;"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2f3d1194c3f34e7b892e0cc8e792d183/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle-体系结构图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9c9d53e642b78e160be5980506eb0319/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">字符串的最大子串问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>