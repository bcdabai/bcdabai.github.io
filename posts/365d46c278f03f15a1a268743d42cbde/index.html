<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>红黑树------插入结点 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="红黑树------插入结点" />
<meta property="og:description" content="红黑树的优势 首先红黑树是不符合AVL树的平衡条件的，即每个节点的左子树和右子树的高度最多差1的二叉查找树。但是提出了为节点增加颜色，红黑树是用非严格的平衡来换取增删节点时候旋转次数的降低，任何不平衡都会在三次旋转之内解决，而AVL是严格平衡树，因此在增加或者删除节点的时候，根据不同情况，旋转的次数比红黑树要多，所以红黑树的插入效率更高。
红黑树能够以O(log2 (n)) 的时间复杂度进行搜索、插入、删除操作
简单来说红黑树就是为了解决二叉查找树的缺陷，因为二叉查找树在某些情况下会退化成一个线性结构。
为什么会有红黑树的存在 在二叉树中，如果是顺序插入，会变成一个链表，查找效率直线下降。
红黑树的性质 每个结点是红的或者黑的。根结点是黑的。每个叶子结点是黑的。如果一个结点是红的，则它的两个儿子都是黑的。对每个结点，从该结点到其子孙结点的所有路径上的包含相同数目的黑结点。 红黑树的旋转 左旋：
void rbtree_left_rotate(rbtree *T, rbtree_node *x) { rbtree_node *y = x-&gt;right; // 1.变换x的右子树上的指针和要指它的指针 x-&gt;right = y-&gt;left; //1 if (y-&gt;left != T-&gt;nil) { //2 y-&gt;left-&gt;parent = x; } // 2.变换y父结点的指针和要指它的指针 y-&gt;parent = x-&gt;parent; //3 if (x-&gt;parent == T-&gt;nil) { //4 T-&gt;root = y; // 树根 } else if (x == x-&gt;parent-&gt;left) { // 判断x所处位置 x-&gt;parent-&gt;left = y; } else { x-&gt;parent-&gt;right = y; } // 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/365d46c278f03f15a1a268743d42cbde/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-08T21:28:25+08:00" />
<meta property="article:modified_time" content="2020-07-08T21:28:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">红黑树------插入结点</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>红黑树的优势</h3> 
<ol><li> <p>首先红黑树是不符合AVL树的平衡条件的，即每个节点的左子树和右子树的高度最多差1的二叉查找树。但是提出了为节点增加颜色，红黑树是用非严格的平衡来换取增删节点时候旋转次数的降低，任何不平衡都会在三次旋转之内解决，而AVL是严格平衡树，因此在增加或者删除节点的时候，根据不同情况，旋转的次数比红黑树要多，所以红黑树的插入效率更高。</p> </li><li> <p>红黑树能够以O(log2 (n)) 的时间复杂度进行搜索、插入、删除操作</p> </li><li> <p>简单来说红黑树就是为了解决二叉查找树的缺陷，因为二叉查找树在某些情况下会退化成一个线性结构。</p> </li></ol> 
<h3><a id="_8"></a>为什么会有红黑树的存在</h3> 
<p>在二叉树中，如果是顺序插入，会变成一个链表，查找效率直线下降。</p> 
<h3><a id="_12"></a>红黑树的性质</h3> 
<ol><li>每个结点是红的或者黑的。</li><li>根结点是黑的。</li><li>每个叶子结点是黑的。</li><li>如果一个结点是红的，则它的两个儿子都是黑的。</li><li>对每个结点，从该结点到其子孙结点的所有路径上的包含相同数目的黑结点。</li></ol> 
<h3><a id="_20"></a>红黑树的旋转</h3> 
<p><img src="https://images2.imgbox.com/78/4d/pWIao90p_o.png" alt="旋转"><br> 左旋：<br> <img src="https://images2.imgbox.com/26/13/LdQqQ6Ux_o.gif" alt="leftRotate"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">rbtree_left_rotate</span><span class="token punctuation">(</span>rbtree <span class="token operator">*</span>T<span class="token punctuation">,</span> rbtree_node <span class="token operator">*</span>x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	rbtree_node <span class="token operator">*</span>y <span class="token operator">=</span> x<span class="token operator">-&gt;</span>right<span class="token punctuation">;</span>  
	
	<span class="token comment">// 1.变换x的右子树上的指针和要指它的指针</span>
	x<span class="token operator">-&gt;</span>right <span class="token operator">=</span> y<span class="token operator">-&gt;</span>left<span class="token punctuation">;</span> <span class="token comment">//1</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>y<span class="token operator">-&gt;</span>left <span class="token operator">!=</span> T<span class="token operator">-&gt;</span>nil<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//2</span>
		y<span class="token operator">-&gt;</span>left<span class="token operator">-&gt;</span>parent <span class="token operator">=</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 2.变换y父结点的指针和要指它的指针</span>
	y<span class="token operator">-&gt;</span>parent <span class="token operator">=</span> x<span class="token operator">-&gt;</span>parent<span class="token punctuation">;</span> <span class="token comment">//3</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>parent <span class="token operator">==</span> T<span class="token operator">-&gt;</span>nil<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//4</span>
		T<span class="token operator">-&gt;</span>root <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// 树根</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> x<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 判断x所处位置</span>
		x<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>left <span class="token operator">=</span> y<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		x<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>right <span class="token operator">=</span> y<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">// 3.变换y的左子树上的指针和要指它的指针</span>
	y<span class="token operator">-&gt;</span>left <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">//5</span>
	x<span class="token operator">-&gt;</span>parent <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">//6</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>右旋：<br> <img src="https://images2.imgbox.com/2f/62/d5P4f3Eg_o.gif" alt="rightRotate"></p> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">rbtree_right_rotate</span><span class="token punctuation">(</span>rbtree <span class="token operator">*</span>T<span class="token punctuation">,</span> rbtree_node <span class="token operator">*</span>y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	rbtree_node <span class="token operator">*</span>x <span class="token operator">=</span> y<span class="token operator">-&gt;</span>left<span class="token punctuation">;</span>

	y<span class="token operator">-&gt;</span>left <span class="token operator">=</span> x<span class="token operator">-&gt;</span>right<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token operator">-&gt;</span>right <span class="token operator">!=</span> T<span class="token operator">-&gt;</span>nil<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		x<span class="token operator">-&gt;</span>right<span class="token operator">-&gt;</span>parent <span class="token operator">=</span> y<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	x<span class="token operator">-&gt;</span>parent <span class="token operator">=</span> y<span class="token operator">-&gt;</span>parent<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>y<span class="token operator">-&gt;</span>parent <span class="token operator">==</span> T<span class="token operator">-&gt;</span>nil<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		T<span class="token operator">-&gt;</span>root <span class="token operator">=</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>y <span class="token operator">==</span> y<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>right<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		y<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>right <span class="token operator">=</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		y<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>left <span class="token operator">=</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	x<span class="token operator">-&gt;</span>right <span class="token operator">=</span> y<span class="token punctuation">;</span>
	y<span class="token operator">-&gt;</span>parent <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_79"></a>红黑树的插入</h3> 
<p>(如果父亲是在祖父的左子树，那么叔叔方向就是右子树，父亲方向就是左子树)</p> 
<ol><li> <p>如果父亲是红色，叔叔是红色。<br> <img src="https://images2.imgbox.com/41/f5/vReXOzz5_o.png" alt="情况1"><br> <code>变换方法</code>：<br> (1)把父节点设为黑色。<br> (2)把叔叔也设为黑色。<br> (3)把祖父设置为红色。<br> (4)把祖父设为当前结点(用以检测上面的结点)。<br> (5)判断是情况几，继续调整。<br> <code>变色原因</code>：因为父亲和叔叔同时变黑，祖父变红，相当于黑色下沉，但每条路线的黑高不会变化。但是祖父变红可能和上层继续不匹配，所以要将当前结点指针指向祖父位置，然后继续调整。</p> </li><li> <p>如果父亲是红色，叔叔是黑色，且当前结点在父亲兄弟(叔叔)方向子树。<br> <img src="https://images2.imgbox.com/2b/29/gLdAiz6Q_o.png" alt="情况2"><br> <code>变换方法</code>：<br> (1)将当前结点指针指向父亲。<br> (2)然后绕当前结点旋转(旋转方向根据父结点所处的子树方向,例子中是左)。</p> </li><li> <p>如果父亲是红色，叔叔是黑色，且当前结点在父亲的父亲方向子树。(有点绕口哈)<br> <img src="https://images2.imgbox.com/dd/9c/0td1FqfU_o.png" alt="情况3"><br> <code>变换方法</code>：<br> (1)把父节点设为黑色。<br> (2)把祖父结点设为红色。<br> (3)然后绕祖父结点旋转(旋转方向根据叔叔结点所处的子树方向，例子中是右)。<br> <code>变色原因</code>：之前的推论已经知道叔叔为黑色，父亲的旋转方向子树也为黑色(此树要给祖父)，因为当前结点红色和祖父旋转下来的结点黑色会在同一层(祖父那边黑高会多了一层)，所以祖父结点要变红(此情况不用担心双红，因为叔叔和转过去的结点都是黑色)，因为父亲结点因为要替换祖父位置，所以要变黑(保持原先的平衡)。</p> </li><li> <p>如果父亲是黑色，直接完成插入，无需调整。</p> </li></ol> 
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">rbtree_insert_fixup</span><span class="token punctuation">(</span>rbtree <span class="token operator">*</span>T<span class="token punctuation">,</span> rbtree_node <span class="token operator">*</span>z<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">==</span> RED<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//z ---&gt; RED</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>z<span class="token operator">-&gt;</span>parent <span class="token operator">==</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">// 获取叔叔结点</span>
			rbtree_node <span class="token operator">*</span>y <span class="token operator">=</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>right<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>y<span class="token operator">-&gt;</span>color <span class="token operator">==</span> RED<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token comment">// 情况1</span>
				<span class="token comment">// 父亲与叔叔都变黑，祖父变红(黑色分叉,但黑高不变)</span>
				<span class="token comment">// 由之前的父亲为红，可以推断出祖父一定是黑</span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
				y<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
				<span class="token comment">// 祖父下面都已经平衡，查看由于祖父的变动是否产生双红</span>
				z <span class="token operator">=</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token punctuation">;</span> <span class="token comment">//z --&gt; RED</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 叔叔颜色是黑色</span>
				<span class="token comment">// 情况2</span>
				<span class="token comment">// 判断当前结点与父亲的关系(是否和父亲同一方向)</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>z <span class="token operator">==</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>right<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token comment">// 因为旋转后当前结点要指向之前的父亲(转后变孩子)</span>
					z <span class="token operator">=</span> z<span class="token operator">-&gt;</span>parent<span class="token punctuation">;</span>
					<span class="token comment">// 此时父亲在左边，所以要向左旋转</span>
					<span class="token function">rbtree_left_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token comment">// 情况3</span>
				<span class="token comment">// 之前的推论已经知道叔叔为黑色</span>
				<span class="token comment">// 父亲的旋转方向子树也为黑色(此树要给祖父)</span>
				<span class="token comment">// 为当前结点红色和祖父旋转下来的结点黑色会在同一层(祖父那边黑高会多了一层)</span>
				<span class="token comment">// 所以祖父结点要变红</span>
				<span class="token comment">// 因为父亲结点因为要替换祖父位置，所以变黑(保持原先的平衡)</span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
				<span class="token function">rbtree_right_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
			rbtree_node <span class="token operator">*</span>y <span class="token operator">=</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>left<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>y<span class="token operator">-&gt;</span>color <span class="token operator">==</span> RED<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
				y<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>

				z <span class="token operator">=</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token punctuation">;</span> <span class="token comment">//z --&gt; RED</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>z <span class="token operator">==</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					z <span class="token operator">=</span> z<span class="token operator">-&gt;</span>parent<span class="token punctuation">;</span>
					<span class="token function">rbtree_right_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
				z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>color <span class="token operator">=</span> RED<span class="token punctuation">;</span>
				<span class="token function">rbtree_left_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> z<span class="token operator">-&gt;</span>parent<span class="token operator">-&gt;</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>

	T<span class="token operator">-&gt;</span>root<span class="token operator">-&gt;</span>color <span class="token operator">=</span> BLACK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1fadca9707e56eb0eb6fc94718c0059e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VS C&#43;&#43;实现openssl访问https网页教程及实例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ecfe02d82d637c47fe1e5265dd0b966c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">numpy弧度制和角度制转换deg2rad, rad2deg</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>