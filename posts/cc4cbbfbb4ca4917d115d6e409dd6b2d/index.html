<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>fmincon函数求解非线性超越方程的学习记录 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="fmincon函数求解非线性超越方程的学习记录" />
<meta property="og:description" content="最近的算法中用到了fmincon函数，寻找多变量非线性方程最小值的函数；因此学习一下；
fmincon函数的基础语法如下所示：
fmincon函数是为了求解下列方程的最小值；
b 和 beq 是向量，A 和 Aeq 是矩阵，c(x) 和 ceq(x) 是返回向量的函数，f(x) 是返回标量的函数。f(x)、c(x) 和 ceq(x) 可以是非线性函数。x、lb 和 ub 可以作为向量或矩阵传递；
1 应用一：求解线性不等式约束方程 x= fmincon(fun,x0,A,b),从 x0 开始，尝试在满足线性不等式 A*x&lt;b 的情况下寻找 fun 中所述的函数的最小值点 x。x0 可以是标量、向量或矩阵。
代码实例：
fun = @(x)100*(x(2)-x(1)^2)^2 &#43; (1-x(1))^2; x0 = [-1,2]; A = [1,2]; b = 1; x = fmincon(fun,x0,A,b) 代码功能：
函数： f [x(1),x(2)] = 100*(x(2)-x(1)^2)^2 &#43; (1-x(1))^2;
从点[-1，2]开始求最小值，约束方程为： x(1)&#43;2x(2) &lt;= 1 。 这个方程的系数矩阵为 [1,2]，最大值为1，因此设置 A = [1,2] , b = 1 ，最终函数以 A*x &lt; b 形式表达此约束。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cc4cbbfbb4ca4917d115d6e409dd6b2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T02:15:35+08:00" />
<meta property="article:modified_time" content="2024-01-06T02:15:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">fmincon函数求解非线性超越方程的学习记录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>最近的算法中用到了fmincon函数，寻找多变量非线性方程最小值的函数；因此学习一下；</p> 
<p>fmincon函数的基础语法如下所示：</p> 
<p class="img-center"><img alt="" height="197" src="https://images2.imgbox.com/9c/44/iEUrRtxp_o.png" width="518"></p> 
<p>fmincon函数是为了求解下列方程的最小值；</p> 
<p class="img-center"><img alt="" height="107" src="https://images2.imgbox.com/dc/75/g4DQ9Azu_o.png" width="528"></p> 
<p>b 和 beq 是向量，A 和 Aeq 是矩阵，c(x) 和 ceq(x) 是返回向量的函数，f(x) 是返回标量的函数。f(x)、c(x) 和 ceq(x) 可以是非线性函数。x、lb 和 ub 可以作为向量或矩阵传递；</p> 
<h4>1 应用一：求解线性不等式约束方程</h4> 
<p><strong><code>x= fmincon(fun,x0,A,b),</code></strong>从 <strong><code>x0</code> </strong>开始，尝试在满足线性不等式 <strong>A*x&lt;b </strong>的情况下寻找 <strong>fun </strong>中所述的函数的最小值点 <code>x</code>。<code>x0</code> 可以是标量、向量或矩阵。</p> 
<p><strong>代码实例：</strong></p> 
<pre><code>fun = @(x)100*(x(2)-x(1)^2)^2 + (1-x(1))^2;

x0 = [-1,2];
A = [1,2];
b = 1;
x = fmincon(fun,x0,A,b)</code></pre> 
<p><strong>代码功能：</strong></p> 
<p>函数：  f [x(1),x(2)] = 100*(x(2)-x(1)^2)^2 + (1-x(1))^2;</p> 
<p>从点[-1，2]开始求最小值，约束方程为： x(1)+2x(2) &lt;= 1 。 这个方程的系数矩阵为 [1,2]，最大值为1，因此设置 A = [1,2] , b = 1 ，最终函数以 A*x &lt; b 形式表达此约束。</p> 
<p><strong>代码运行结果：</strong></p> 
<p class="img-center"><img alt="" height="71" src="https://images2.imgbox.com/dd/a3/x0DKXlhw_o.png" width="413"></p> 
<p>这个应用是较为简单的，总之就是通过fun设置函数；通过A和b的值设置约束方程；通过x0设值参数 x(1)和 x(2)的最小值；函数输出的结果x就是函数在满足约束条件达到最小值时的x(1)和 x(2)的大小；</p> 
<h4>2 应用二：线性不等式和等式共同约束的极值求解</h4> 
<p>在既有线性不等式约束又有线性等式约束的情况下求 Rosenbrock 函数的最小值。</p> 
<p>将目标函数 <code>fun</code> 设置为 Rosenbrock 函数。</p> 
<p><strong>x = fmincon(fun,x0,A,b,Aeq,beq) : </strong>在满足线性等式 Aeq * x = beq 以及不等式  <strong>A*x&lt;b </strong>  的情况下最小化 <strong><code>fun</code></strong>。如果不存在不等式，则设置 <code>A = []</code> 和 <code>b = []</code>。</p> 
<p><strong>代码实例：</strong><br>  </p> 
<pre><code>fun = @(x)100*(x(2)-x(1)^2)^2 + (1-x(1))^2;

x0 = [0.5,0];
A = [1,2];
b = 1;
Aeq = [2,1];
beq = 1;
x = fmincon(fun,x0,A,b,Aeq,beq)</code></pre> 
<p><strong>代码功能：</strong></p> 
<p>函数：  fun = 100*(x(2)-x(1)^2)^2 + (1-x(1))^2;</p> 
<p>从点 <code>[0.5,0]</code> 开始求最小值，约束为 x(1)+2x(2)≤1 和 2x(1)+x(2)=1。</p> 
<ul><li> <p>以 <code>A = [1,2]</code> 和 <code>b = 1</code> 为条件，以 <code>A*x &lt;= b</code> 形式表达线性不等式约束。这个方程的系数矩阵为 [1,2]，最大值为1，因此设置 A = [1,2] , b = 1 ，最终函数以 A*x &lt; b 形式表达此约束。</p> </li><li> <p>以 <code>Aeq = [2,1]</code> 和 <code>beq = 1</code> 为条件，以 <code>Aeq*x = beq</code> 形式表达线性等式约束。这个方程的系数矩阵为 [2,1]，方程值 =1 ，因此设置 Aeq = [2,1] , beq = 1 ，最终函数以 Aeq*x  = beq 形式表达此约束。</p> </li></ul> 
<p><strong>代码运行结果：</strong></p> 
<p class="img-center"><img alt="" height="74" src="https://images2.imgbox.com/dc/36/WK97HOD4_o.png" width="540"></p> 
<h4>3 应用三：具有边界约束的极值求解</h4> 
<p>在存在边界约束的情况下，求目标函数的最小值。目标函数是具有两个变量的简单代数函数。</p> 
<p><strong>x = fmincon(fun,x0,A,b,Aeq,beq,lb,ub) ：</strong>对 <code>x</code> 中的设计变量定义一组下界和上界，使解始终在 <strong><code>lb </code>≤<code> x </code>≤<code> ub</code></strong> 范围内。如果不存在等式，请设置 <code>Aeq = []</code> 和 <code>beq = []</code>。如果 <code>x(i)</code> 无下界，请设置 <code>lb(i) = -Inf</code>，如果 <code>x(i)</code> 无上界，请设置 <code>ub(i) = Inf</code>。</p> 
<p><strong>代码实例：</strong></p> 
<pre><code>fun = @(x)1+x(1)/(1+x(2)) - 3*x(1)*x(2) + x(2)*(1+x(1));
% x 为正值且满足 x(1) ≤ 1 和 x(2) ≤ 2 的区域。
lb = [0,0];
ub = [1,2];
% 无任何线性约束
A = [];
b = [];
Aeq = [];
beq = [];
%尝试使用一个位于区域中部的初始点
x0 = (lb + ub)/2;
%输出结果
x = fmincon(fun,x0,A,b,Aeq,beq,lb,ub)</code></pre> 
<p><strong>代码功能：</strong></p> 
<p>函数：  fun = 1+x(1)/(1+x(2)) - 3*x(1)*x(2) + x(2)*(1+x(1));</p> 
<p>无任何约束，但是 x的值存在边界条件:  x 为正值且满足 x(1) ≤ 1 和 x(2) ≤ 2 , 即 x(1)的下界为0，上界为1，x(2)的下界为0，上界为2；因此设置下界与上界的矩阵 lb = [0,0]; ub = [1,2]; 表达此边界条件，最终输出结果；</p> 
<p>值得注意的是初始点的选取；目前是尝试使用一个位于区域中部的初始点，即x0 = (lb + ub)/2;这个值不同将会影响系统的输出结果，因为求解函数的单个方向收敛的，这个初值的设置需要参考不同函数进行独立的设计。</p> 
<p><strong>代码运行结果：</strong></p> 
<p class="img-center"><img alt="" height="78" src="https://images2.imgbox.com/5e/96/ADQ9CEep_o.png" width="505"></p> 
<p></p> 
<h4>3 应用四：具有非线性约束的极值求解</h4> 
<p>在非线性约束下求函数的最小值，这个非线性约束是指那些 既不是边界、也不是线性等式、也不是不等式的情况，比如某个函数在某个区域内的极小值，这个区域是一个圆或者是一个正方型区域，这个限制条件就是非线性的约束条件；</p> 
<p>x = fmincon(fun,x0,A,b,Aeq,beq,lb,ub,nonlcon) ： 求解非线性约束 nonlcon 函数下函数极值；满足 nonlcon 所定义的非线性不等式 c(x) 或等式 ceq(x)。fmincon 进行优化，以满足 c(x) ≤ 0 和 ceq(x) = 0。如果不存在边界，请设置 lb = [] 和/或 ub = []。</p> 
<p><strong>代码实例：</strong>在边界约束下求 Rosenbrock 函数在圆内最小的点，理想输出结果是x1 = 0.5，x2 = 0.25</p> 
<pre><code>fun = @(x)100*(x(2)-x(1)^2)^2 + (1-x(1))^2;
%  x1 = [0 0.5] , x2 = [0.2 0.8] 区域内寻找
lb = [0,0.2];
ub = [0.5,0.8];

%没有线性约束，因此将这些参数设置为 []。
A = [];
b = [];
Aeq = [];
beq = [];

%选择一个满足所有约束的初始点。
x0 = [1/4,1/4];

%求解输出（尾部定义非线性约束）
nonlcon = @circlecon;
x = fmincon(fun,x0,A,b,Aeq,beq,lb,ub,nonlcon)

%同时在以 [1/3,1/3] 为圆心、半径为 1/3 的圆内寻找。将以下代码复制到您的 MATLAB® 路径上名为 circlecon.m 的文件中。

function [c,ceq] = circlecon(x)
c = (x(1)-1/3)^2 + (x(2)-1/3)^2 - (1/3)^2;
ceq = [];
end
</code></pre> 
<p><strong>代码功能：</strong>在边界约束下求 Rosenbrock 函数在圆内最小的点</p> 
<p>无任何线性约束，仅存在一个约束条件：极值必须在以 [1/3,1/3] 为圆心、半径为 1/3 的圆内寻找。</p> 
<p>非常值得注意的是这个 nonlcon函数的撰写；</p> 
<p>c = (x(1)-1/3)^2 + (x(2)-1/3)^2 - (1/3)^2;   这是所需圆的表达式；<span style="color:#fe2c24;"><strong>由于该函数规定必须是满足 c(x) ≤ 0 。因此要表示在圆内， 将原本圆的表达式是 ： (x(1)-1/3)^2 + (x(2)-1/3)^2 =(1/3)^2，转换为c = (x(1)-1/3)^2 + (x(2)-1/3)^2 - (1/3)^2;   </strong></span></p> 
<p><span style="color:#4da8ee;"><strong>假如需要增加参数之间的关系： 增加类似  c =  x(1) - x(2)，表示 x(2)&gt;= x(1)</strong></span></p> 
<p>ceq = []，此时不存在等式，这里选择为空即可；</p> 
<p>这些都是单个约束条件 ，如果有多个约束条件就是 c(1) = .....  c(2) = ....即可</p> 
<p><strong>代码运行结果：</strong></p> 
<p class="img-center"><img alt="" height="97" src="https://images2.imgbox.com/2f/cb/LHl1QF91_o.png" width="608"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/869087e7f5f122904adcb9919d3f34b7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java--连接池</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d42d24e79b1326a9d9b690d3c4fc0432/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在openEuler环境下快速编译GreatSQL RPM包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>