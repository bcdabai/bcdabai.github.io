<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sonarqube安装 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sonarqube安装" />
<meta property="og:description" content="一 . SonarQube代码质量检查工具简介 Sonar (SonarQube)是一个开源平台，用于管理源代码的质量
Sonar 不只是一个质量数据报告工具，更是代码质量管理平台
支持Java, C#, C/C&#43;&#43;, PL/SQL, Cobol, JavaScrip, Groovy 等等二十几种编程语言的代码质量管理与检测。
Sonar可以从以下七个维度检测代码质量，而作为开发人员至少需要处理前5种代码质量问题。
不遵循代码标准
sonar可以通过PMD,CheckStyle,Findbugs等等代码规则检测工具规范代码编写。
潜在的缺陷
sonar可以通过PMD,CheckStyle,Findbugs等等代码规则检测工具检 测出潜在的缺陷。
糟糕的复杂度分布
文件、类、方法等，如果复杂度过高将难以改变，这会使得开发人员 难以理解它们, 且如果没有自动化的单元测试，对于程
序中的任何组件的改变都将可能导致需要全面的回归测试。
重复
显然程序中包含大量复制粘贴的代码是质量低下的，sonar可以展示 源码中重复严重的地方。
注释不足或者过多
没有注释将使代码可读性变差，特别是当不可避免地出现人员变动 时，程序的可读性将大幅下降 而过多的注释又会使得开发人员将精力过多地花费在阅读注释上，亦违背初衷。
缺乏单元测试
sonar可以很方便地统计并展示单元测试覆盖率。
糟糕的设计
通过sonar可以找出循环，展示包与包、类与类之间的相互依赖关系，可以检测自定义的架构规则 通过sonar可以管理第三方
的jar包，可以利用LCOM4检测单个任务规则的应用情况， 检测藕合。
为什么要选择sonarQube?
个人使用之后认为 : sonarQube的优势如下(相比于阿里编码规约这种市面上常见类似软件):
更加优秀的图形化界面
基本上通过界面就可以对自己项目的代码状况一目了然
可以查询出其它软件难以定位到的问题
比如 :
可能导致空指针异常的问题 (对象在进行使用前没有加空的判断)
可能导致内存泄漏的问题, 在try catch 块里面,直接使用e.printStackTrace()将堆栈信息打印到内存的
可能导致的漏洞 : 成员变量使用public定义的
还有诸如 : 流等未关闭或者是非正常关闭都能够检测出来!
功能非常强大!!
二. 安装： 2.1 安装SonarQube web server
首先确保安装了jdk1.8 &#43;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c8aff8b3e1190138e8a031b97b7fe484/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-17T07:15:30+08:00" />
<meta property="article:modified_time" content="2021-05-17T07:15:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sonarqube安装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 id="一-.-sonarqube代码质量检查工具简介">一 . SonarQube代码质量检查工具简介</h4> 
<blockquote> 
 <p>Sonar (SonarQube)是一个开源平台，用于管理源代码的质量</p> 
 <p>Sonar 不只是一个质量数据报告工具，更是代码质量管理平台</p> 
</blockquote> 
<p>支持Java, C#, C/C++, PL/SQL, Cobol, JavaScrip, Groovy 等等二十几种编程语言的代码质量管理与检测。</p> 
<p>Sonar可以从以下七个维度检测代码质量，而作为开发人员至少需要处理前5种代码质量问题。</p> 
<ol><li> <p>不遵循代码标准</p> </li><li> <p>sonar可以通过PMD,CheckStyle,Findbugs等等代码规则检测工具规范代码编写。</p> </li><li> <p>潜在的缺陷</p> <p>sonar可以通过PMD,CheckStyle,Findbugs等等代码规则检测工具检 测出潜在的缺陷。</p> </li><li> <p>糟糕的复杂度分布</p> <p>文件、类、方法等，如果复杂度过高将难以改变，这会使得开发人员 难以理解它们, 且如果没有自动化的单元测试，对于程</p> <p>序中的任何组件的改变都将可能导致需要全面的回归测试。</p> </li><li> <p>重复</p> <p>显然程序中包含大量复制粘贴的代码是质量低下的，sonar可以展示 源码中重复严重的地方。</p> </li><li> <p>注释不足或者过多</p> <p>没有注释将使代码可读性变差，特别是当不可避免地出现人员变动 时，程序的可读性将大幅下降 而过多的注释又会使得开发人员将精力过多地花费在阅读注释上，亦违背初衷。</p> </li><li> <p>缺乏单元测试</p> <p>sonar可以很方便地统计并展示单元测试覆盖率。</p> </li><li> <p>糟糕的设计</p> <p>通过sonar可以找出循环，展示包与包、类与类之间的相互依赖关系，可以检测自定义的架构规则 通过sonar可以管理第三方</p> <p>的jar包，可以利用LCOM4检测单个任务规则的应用情况， 检测藕合。</p> <p>为什么要选择sonarQube?</p> </li></ol> 
<p>个人使用之后认为 : sonarQube的优势如下(相比于阿里编码规约这种市面上常见类似软件):</p> 
<ol><li> <p>更加优秀的图形化界面</p> <p>基本上通过界面就可以对自己项目的代码状况一目了然</p> </li><li> <p>可以查询出其它软件难以定位到的问题</p> <p>比如 :</p> <p>可能导致空指针异常的问题 (对象在进行使用前没有加空的判断)</p> <p>可能导致内存泄漏的问题, 在try catch 块里面,直接使用e.printStackTrace()将堆栈信息打印到内存的</p> <p>可能导致的漏洞 : 成员变量使用public定义的</p> <p>还有诸如 : 流等未关闭或者是非正常关闭都能够检测出来!</p> <p>功能非常强大!!</p> </li></ol> 
<h4 id="二.-安装"><a name="t1"></a>二. 安装：</h4> 
<p>2.1 安装SonarQube web server</p> 
<ol><li> <p>首先确保安装了jdk1.8 +</p> </li><li> <p>到此链接 https://www.sonarqube.org/downloads/</p> </li></ol> 
<p>下载sonalqube(下载社区版,是开源的),</p> 
<p>我下载的是sonarqube-7.2.1，因为最新版<strong>7.9.1</strong>需要<strong>jdk11</strong>支持</p> 
<p>并解压,解压完之后的目录如下 :</p> 
<p><img alt="5d36fc50c7a2434782.png" src="https://images2.imgbox.com/80/5f/CUCTfJe0_o.png"></p> 
<p> </p> 
<ol><li>到解压目录的bin\macosx-universal-64(对应系统)目录下:</li></ol> 
<p>linux、Mac <code>sh sonar.sh start</code>启动</p> 
<p>windows 双击<code>StartSonar.bat</code> 启动</p> 
<ol><li> <p>到浏览器界面,输入 : http://localhost:9000</p> <p>如果能访问表明安装成功</p> </li></ol> 
<p>2.2 安装数据库</p> 
<ol><li> <p>版本要求:</p> <p>在conf目录下的sonar.properties文件下:</p> <p>有这样一行配置 :</p> <pre><code>#----- MySQL &gt;=5.6 &amp;&amp; &lt; 8.0</code></pre> </li><li> <p>为sonarqube 创建一个数据库</p> </li></ol> 
<pre><code class="language-Lua">create database sonar;

-- 创建数据库</code></pre> 
<ol><li>创建sonarqube用户并进行授权</li></ol> 
<pre><code class="language-Lua">CREATE USER 'username'@'host' IDENTIFIED BY 'password'; 
-- 创建用户并设置密码
-- username 为创建的用户名
-- host 为对应的主机地址,本地就是localhost
-- password 为设置的密码
GRANT ALL ON *.* TO 'username'@'localhost';
-- 对用户进行授权操作</code></pre> 
<ol><li>修改SonarQube配置文件,添加Mysql相关配置</li></ol> 
<pre><code class="language-Lua">sonar.jdbc.url=jdbc:mysql://localhost:3306/sonar?useUnicode=true&amp;characterEncoding=utf8&amp;rewriteBatchedStatements=true&amp;useConfigs=maxPerformance&amp;useSSL=false
# 刚刚创建的sonarQube用户
sonar.jdbc.username=sonar
# 创建用户对应的密码
sonar.jdbc.password=sonar
# 设置编码格式为UTF-8
sonar.sorceEncoding=UTF-8
# sonar登陆用户名
sonar.login=admin
# sonar登陆密码
sonar.password=admin</code></pre> 
<p> </p> 
<p>2.3 重新启动服务端</p> 
<ol><li>退出 SonarQube 服务端</li></ol> 
<p>在之前弹出的cmd窗口执行ctrl + c,</p> 
<p>弹出来的提示选择Y,退出SonarQube服务</p> 
<ol><li>双击StartSonar.bat文件, 重新启动SonarQube</li></ol> 
<p>这次因为要进行数据库的初始化操作,所以需要的时间可能稍微久一点</p> 
<ol><li> <p>启动成功后,浏览器输入 : http://localhost:9000 进入界面</p> </li><li> <p>登录</p> <p>点击界面右上角的登录按钮, 进行登录 :</p> <p>初始的账户名 : admin</p> <p>初始的密码 : admin</p> <p>附 : 一些关键配置的修改,如 主机地址,context,端口号等:</p> <p>通常情况下使用默认的配置即可!</p> <p>文件 /conf/sonar.properties</p> 
  <ol><li> <p><code>#sonar.web.host=0.0.0.0 </code></p> </li><li> <p><code>#sonar.web.context=</code></p> </li><li> <p><code>#sonar.web.port=9000</code></p> </li></ol></li></ol> 
<h4 id="三.-使用"><a name="t2"></a>三. 使用</h4> 
<p>3.1. 安装必要的插件 (汉化包举例)</p> 
<p>点击 导航栏的 Administration, 选择Marketplace</p> 
<p>搜索 Chinese pack, 点击install进行安装</p> 
<p>安装成功后, 重启 SonarQube !</p> 
<p> </p> 
<p><img alt="pack" src="https://images2.imgbox.com/69/78/zJ2v1dnW_o.png"></p> 
<p>3.2. 开始分析项目代码源代码</p> 
<p>使用maven的方式进行分析</p> 
<p>3.2.1 编辑maven 的settings.xml文件</p> 
<pre><code class="language-XML">&lt;settings&gt;
    &lt;pluginGroups&gt;
        &lt;pluginGroup&gt;org.sonarsource.scanner.maven&lt;/pluginGroup&gt;
    &lt;/pluginGroups&gt;
    &lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;sonar&lt;/id&gt;
            &lt;activation&gt;
                &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
            &lt;/activation&gt;
            &lt;properties&gt;
                &lt;sonar.host.url&gt;http://loaclhost:9000&lt;/sonar.host.url&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;
     &lt;/profiles&gt;
&lt;/settings&gt;</code></pre> 
<p> </p> 
<p>其中sonar.host.url 值就是 上文启动的sonar 服务器地址。</p> 
<p>3.2.2 对maven项目进行分析</p> 
<p>到项目所在的文件路径下:</p> 
<p>使用命令提示符或者是power shell执行 如下命令:</p> 
<pre><code>mvn org.sonarsource.scanner.maven:sonar-maven-plugin:3.6.0.1398:sonar</code></pre> 
<p>出现: BUILD SUCCESS 标识之后</p> 
<p> </p> 
<p><img alt="BUILD SUCCESS" src="https://images2.imgbox.com/e7/1d/lx3Gl7xS_o.png"></p> 
<p> </p> 
<p>刷新界面查看 :</p> 
<p> </p> 
<p> </p> 
<p><img alt="5d3702b53d88f89420.png" src="https://images2.imgbox.com/03/23/jPkxXiyB_o.png"></p> 
<p><img alt="5d370392516ff39969.png" src="https://images2.imgbox.com/bb/8b/OJAHifSJ_o.png"></p> 
<p> </p> 
<p>3.3 配置分析参数</p> 
<p>强制参数：</p> 
<ol><li>Server<br> sonar.host.url http://localhost:9000</li><li>Project Configuration<br> sonar.projectKey Maven :<br> sonar.sources Maven 默认的源码路径</li></ol> 
<p>可以配置的参数：</p> 
<ol><li> <p>Project identity<br> sonar.projectName 项目名称<br> sonar.projectversion 项目版本</p> </li><li> <p>Authentication<br> sonar.login 分析该项目的用户名称<br> sonar.password 分析该项目的用户密码</p> <p>3.4. 程序员用户使用说明</p> </li></ol> 
<p>SonarQube Web管理者通过配置和设置以下参数值对项目源代码进行：</p> 
<p>复杂度、覆盖率、文档、重复、问题、可维护性、可靠性、安全性、大小等约束和规范。</p> 
<p>sonar中的质量阈管理以下内容。</p> 
<pre><code>复杂度

复杂度

复杂度/类

复杂度/文件

复杂度/方法

覆盖率

分支覆盖

集成测试的新分支覆盖

新代码的分支覆盖率

覆盖率

新集成测试覆盖

新覆盖率

集成测试分支覆盖

集成测试覆盖

集成测试覆盖行

集成测试未覆盖分支

集成测试未覆盖行

代码覆盖率

集成测试的新行覆盖

新代码覆盖率

代码行

集成测试的新行覆盖

覆盖的新代码

总体分支覆盖率

总体新分支覆盖率

总体覆盖率

总体新覆盖率

总体代码覆盖率

总体新代码覆盖率

总体覆盖的新行数

总体未覆盖分支

总体未覆盖的新分支

总体未覆盖代码

总体未覆盖新行数

单元测试忽略数

未覆盖分支

集成测试未覆盖的新分支

未覆盖新分支

未覆盖的代码

集成测试未覆盖的行

未覆盖的新代码

单元测试持续时间

单元测试错误数

单元测试失败数

单元测试成功 (%)

单元测试数

文档

注释行

注释 (%)

公共API

公共注释的API (%)

公共未注释的API

重复

重复块

重复文件

重复行

重复行(%)

问题

阻断违规

确认问题

严重违规

误判问题

提示违规

违规

主要违规

次要违规

新阻断违规

新严重违规

新提示违规

新违规

新主要违规

新次要违规

开启问题

重开问题

不修复的问题

可维护性

新代码的技术债务

坏味道

达到可维护性A级所需的工作

新增坏味道

技术债务

技术债务比率

新代码技术债务比率

Management

Burned budget

Business value

Team size

可靠性

Bugs

新增Bugs

可靠性修复工作

新代码的可靠性修复工作

安全性

新增漏洞

安全修复工作

新代码的安全修复工作

漏洞

大小

类

目录

文件

方法

生成的行数

生成的代码行数

行数

代码行数

项目

语句</code></pre> 
<p> </p> 
<p> </p> 
<p style="margin-left:0pt;"><span style="color:#000000;">需要注意：当时挑选</span><span style="color:#000000;">6</span><span style="color:#000000;">是因为</span><span style="color:#000000;">7</span><span style="color:#000000;">开始在</span><span style="color:#000000;">docker</span><span style="color:#000000;">里面不能使用</span><span style="color:#000000;">root</span><span style="color:#000000;">进行启动，需要创建一个普通用户来启动才行。</span></p> 
<p style="margin-left:0pt;"> </p> 
<p style="margin-left:0pt;"> </p> 
<h2 style="margin-left:0pt;"><span style="color:#000000;">sonarqube和jenkins的连接</span></h2> 
<p style="margin-left:0pt;"> </p> 
<p style="margin-left:0pt;"><span style="color:#000000;">安装Jenkins插件</span></p> 
<p style="margin-left:0pt;"><img alt="" height="283" src="https://images2.imgbox.com/ee/6b/ScdzhDYz_o.png" width="554"></p> 
<p style="margin-left:0pt;"> </p> 
<p style="margin-left:0pt;"><span style="color:#000000;">配置sonarqube服务器</span></p> 
<p style="margin-left:0pt;"> </p> 
<p><img alt="" height="291" src="https://images2.imgbox.com/ef/14/610QdqkQ_o.png" width="554"></p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/67482d99b30528b811d99dc67f4329b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">c语言去字符串重复元素,[蓝桥杯][算法提高VIP]删除重复元素 （C语言代码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/473002110591335303b5287fc67de514/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">查看docker 容器的端口</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>