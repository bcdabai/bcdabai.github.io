<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot实现发送邮件功能 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBoot实现发送邮件功能" />
<meta property="og:description" content="平时注册或者登录一个网站时，可能收到过邮件用来发送验证码等，邮件在项目中经常会被用到，比如邮件发送通知，比如通过邮件注册，认证，找回密码，系统报警通知，报表信息等。
发送邮件用到了Spring Email的技术，我们这里使用的是SMTP。
1.邮箱打开SMTP服务 找一个邮箱用来给其他邮箱发送文件，要用SMTP服务发送邮件，所以邮箱要提前开启这个功能。
以163邮箱为例：（其他邮箱也是相同的操作）
开启SMTP服务后，会出现弹框，将授权密码记录下来，注意：只出现一次
还可以看到服务器地址 2.SpringBoot集成Email 将下面的maven配置拷贝下来，集成到SpringBoot中。 &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-mail --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt; &lt;version&gt;2.1.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; 3.邮箱参数配置 首先进行配置文件，配置文件的目的是告诉Spring需要用哪个邮箱来发送邮件
写到SpringBoot的yaml配置文件里面
（登录授权密码不是你邮箱的密码，是你邮箱开启SMTP服务后显示的那个授权密码）
spring: mail: #邮箱域名、端口、邮箱账号、登录授权密码、启用smtps安全协议、采用ssl安全链接 host: smtp.163.com port: 465 username: ************@163.com password: ************ protocol: smtps properties: mail.smtp.ssl.enable: true 4.发送邮件工具类 package com.kyw.util; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.beans.factory.annotation.Value; import org.springframework.mail.javamail.JavaMailSender; import org.springframework.mail.javamail.MimeMessageHelper; import org.springframework.stereotype.Component; import javax.mail.MessagingException; import javax.mail.internet.MimeMessage; @Component public class MailClient { private static final Logger logger = LoggerFactory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/756545023d10aa386d08ba92c2a4864b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-05T15:39:07+08:00" />
<meta property="article:modified_time" content="2023-09-05T15:39:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot实现发送邮件功能</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>        平时注册或者登录一个网站时，可能收到过邮件用来发送验证码等，邮件在项目中经常会被用到，比如邮件发送通知，比如通过邮件注册，认证，找回密码，系统报警通知，报表信息等。</p> 
<p>发送邮件用到了Spring Email的技术，我们这里使用的是SMTP。</p> 
<h2>1.邮箱打开SMTP服务</h2> 
<p>找一个邮箱用来给其他邮箱发送文件，要用SMTP服务发送邮件，所以邮箱要提前开启这个功能。</p> 
<p>以163邮箱为例：（其他邮箱也是相同的操作）</p> 
<p>开启SMTP服务后，会出现弹框，将授权密码记录下来，注意：只出现一次</p> 
<p><img alt="" height="729" src="https://images2.imgbox.com/e2/81/I1sK8ala_o.png" width="1200"></p> 
<p>还可以看到服务器地址 </p> 
<p><img alt="" height="879" src="https://images2.imgbox.com/01/a2/pwBBjOb5_o.png" width="1029"></p> 
<p></p> 
<h2>2.SpringBoot集成Email</h2> 
<p>将下面的maven配置拷贝下来，集成到SpringBoot中。 </p> 
<pre><code class="language-XML">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-mail --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;
    &lt;version&gt;2.1.5.RELEASE&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<h2>3.邮箱参数配置</h2> 
<p>首先进行配置文件，配置文件的目的是告诉Spring需要用哪个邮箱来发送邮件</p> 
<p>写到SpringBoot的yaml配置文件里面</p> 
<p>（登录授权密码不是你邮箱的密码，是你邮箱开启SMTP服务后显示的那个授权密码）</p> 
<pre><code class="language-XML">spring:
  mail:
    #邮箱域名、端口、邮箱账号、登录授权密码、启用smtps安全协议、采用ssl安全链接
    host: smtp.163.com
    port: 465
    username: ************@163.com
    password: ************
    protocol: smtps
    properties:
      mail.smtp.ssl.enable: true</code></pre> 
<h2>4.发送邮件工具类</h2> 
<pre><code class="language-java">package com.kyw.util;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.stereotype.Component;

import javax.mail.MessagingException;
import javax.mail.internet.MimeMessage;


@Component
public class MailClient {
    private static final Logger logger = LoggerFactory.getLogger(MailClient.class);

    @Autowired
    private JavaMailSender mailSender;

    //读取到配置类中的 “发送者”邮箱
    @Value("${spring.mail.username}")
    private String from;

    /**
     * 发送邮件
     * @param to        “接收者”邮箱
     * @param subject   邮件的主题
     * @param content   邮件的内容
     */
    public void sendMail(String to, String subject, String content) {
        try {
            MimeMessage mimeMessage = mailSender.createMimeMessage();
            MimeMessageHelper helper = new MimeMessageHelper(mimeMessage);
            helper.setFrom(from);
            helper.setTo(to);
            helper.setText(content,true);//表示可以发送HTML文件
            helper.setSubject(subject);
            mailSender.send(helper.getMimeMessage());
        } catch (MessagingException e) {
            logger.error("发送邮件失败：" + e.getMessage());
        }

    }
}</code></pre> 
<h2>发送文本邮件测试</h2> 
<p>写一个测试类来测试，给我的qq邮箱发送一个邮件</p> 
<pre><code class="language-java">package com.kyw;

import com.kyw.util.MailClient;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest
@ContextConfiguration(classes  = SpringBootDemoApplication.class)
public class MailTests {
    @Autowired
    private MailClient mailClient;

    @Test
    public void testTextMail() {
        mailClient.sendMail("2370553834@qq.com","TEST","测试，你好");
    }
}
</code></pre> 
<p>收到啦</p> 
<p><img alt="" height="316" src="https://images2.imgbox.com/a9/51/j1zcwQsg_o.png" width="856"></p> 
<h2>发送HTML邮件</h2> 
<p>也是用Thymeleaf实现的，没有配置Thymeleaf先去集成一下，搜索SpringBoot集成Thymeleaf即可。</p> 
<p>先写一个邮件模板页面，里面的username是动态的值，等待后端调用的时候填充</p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en" xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;示例邮件&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="#f2f2f2"&gt;
  &lt;tr&gt;
    &lt;td align="center" style="padding: 20px 0;"&gt;
      &lt;table cellpadding="0" cellspacing="0" border="0" width="600" bgcolor="#ffffff"&gt;
        &lt;tr&gt;
          &lt;td align="center" style="padding: 20px 0;"&gt;
            &lt;img src="https://pic.izihun.com/pic/art_font/2019/01/16/10/png_temp_1570533438378_9814.jpg?imageMogr2/auto-orient/thumbnail/820x/format/jpeg" alt="公司标志"width="150" height="150"&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td style="padding: 20px;"&gt;
            &lt;h1&gt;欢迎来到我们的邮件示例&lt;/h1&gt;
            &lt;p&gt;亲爱的收件人，&lt;span th:text="${username}" &gt;&lt;/span&gt; &lt;/p&gt;
            &lt;p&gt;这是一个示例邮件的内容。您可以在这里添加任何您想要的信息。&lt;/p&gt;
            &lt;p&gt;感谢您的阅读。&lt;/p&gt;
            &lt;p&gt;祝您一切顺利！&lt;/p&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td align="center" style="background-color: #f2f2f2; padding: 20px;"&gt;
            &lt;a href="https://www.baidu.com" style="text-decoration: none; background-color: #007BFF; color: #ffffff; padding: 10px 20px; border-radius: 5px; font-weight: bold;"&gt;访问我们的网站&lt;/a&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/table&gt;
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p>后端测试类</p> 
<pre><code class="language-java">package com.kyw;

import com.kyw.util.MailClient;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringRunner;
import org.thymeleaf.TemplateEngine;
import org.thymeleaf.context.Context;

@RunWith(SpringRunner.class)
@SpringBootTest
@ContextConfiguration(classes  = SpringBootDemoApplication.class)
public class MailTests {
    @Autowired
    private MailClient mailClient;

    /**
     *发送文本文件
     */
    @Test
    public void testTextMail() {
        mailClient.sendMail("2370553834@qq.com","TEST","测试，你好");
    }

    @Autowired
    private TemplateEngine templateEngine;

    /**
     *使用Thymeleaf 发送HTML邮件
     */
    @Test
    public void testHtmlMail() {
        Context context = new Context();
        context.setVariable("username","张三");

        String content =  templateEngine.process("/mail/maildemo",context);
        System.out.println(content);
        mailClient.sendMail("2370553834@qq.com","TEST",content);
    }
}
</code></pre> 
<p>注意路径要按照Thymeleaf的规范来</p> 
<p><img alt="" height="566" src="https://images2.imgbox.com/90/7b/WQymUFXi_o.png" width="1200"></p> 
<p><img alt="" height="853" src="https://images2.imgbox.com/c3/b3/7IuzrCrn_o.png" width="1189"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/21499e211f412d18d5ca1b88ce0bd10f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Github】git本地仓库建立与远程连接</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b87b211c1342c98e2102352ad5e1d873/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">井盖异动传感器-井盖在线监测设备-旭华智能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>