<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Lucene - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Lucene" />
<meta property="og:description" content="Luence 了解搜索技术 搜索引擎 一个搜索引擎由搜索器 、索引器 、检索器 和用户接口 四个部分组成。搜索器的功能是在互联网 中漫游，发现和搜集信息。索引器的功能是理解搜索器所搜索的信息，从中抽取出索引项，用于表示文档 以及生成文档库的索引表。检索器的功能是根据用户的查询在索引库中快速检出文档，进行文档与查询的相关度评价，对将要输出的结果进行排序，并实现某种用户相关性反馈机制。用户接口的作用是输入用户查询、显示查询结果、提供用户相关性反馈机制。
搜索引擎发展史 Google：1998年10月之前，Google只是美国斯坦福大学的一个小项目。1995年博士生Larry Page开始学习搜索引擎设计，于1997年9月15日注册了google.com 的域名。
百度：2000年1月，两位北大校友，李彦宏与好友徐勇在北京中关村创立了百度公司。
雅虎：1994年4月，斯坦福（Stanford）大学的两名博士生，美籍华人杨致远和美国人David Filo共同创办了超级目录索引（Yahoo），并成功地使搜索引擎的概念深入人心。从此搜索引擎进入了高速发展时期。
新浪：1998年12月1日，四通利方信息技术有限公司和华渊资讯公司宣布合并，成立新浪网公司并推出同名的中文网站。其搜索引擎技术的合作对象是百度公司。
搜狐：1998年2月，爱特信公司创办了“搜狐”大型中文网络系统。搜狐站点的内容大量采用了人工选择和分类，并提供“分类查询”和“关键词”两种方式检索。其搜索引擎技术的合作对象是百度公司。
搜索引擎的原理 爬行 搜索引擎是通过一种特定规律的软件跟踪网页的链接，从一个链接爬到另外一个链接，像蜘蛛在蜘蛛网上爬行一样，所以被称为“蜘蛛”也被称为“机器人”。搜索引擎蜘蛛的爬行是被输入了一定的规则的，它需要遵从一些命令或文件的内容。
抓取存储 搜索引擎是通过蜘蛛跟踪链接爬行到网页，并将爬行的数据存入原始页面数据库。其中的页面数据与用户浏览器得到的HTML是完全一样的。搜索引擎蜘蛛在抓取页面时，也做一定的重复内容检测，一旦遇到权重很低的网站上有大量抄袭、采集或者复制的内容，很可能就不再爬行。
预处理 搜索引擎将蜘蛛抓取回来的页面，进行各种步骤的预处理，包括：提取文字，中文分词，去停止词，消除噪音（搜索引擎需要识别并消除这些噪声，比如版权声明文字、导航条、广告等……），正向索引，倒排索引，链接关系计算，特殊文件处理。
除了HTML 文件外，搜索引擎通常还能抓取和索引以文字为基础的多种文件类型，如 PDF、Word、WPS、XLS、PPT、TXT 文件等。我们在搜索结果中也经常会看到这些文件类型。 但搜索引擎还不能处理图片、视频、Flash 这类非文字内容，也不能执行脚本和程序。
排名 用户在搜索框输入关键词后，排名程序调用索引库数据，计算排名显示给用户，排名过程与用户直接互动的。但是，由于搜索引擎的数据量庞大，虽然能达到每日都有小的更新，但是一般情况搜索引擎的排名规则都是根据日、周、月阶段性不同幅度的更新。
搜索技术的应用场景 搜索引擎广泛应用在大型综合搜索网站，如百度，谷歌等，也应用于系统的站内搜索。
实现搜索技术的方式 实现搜索技术可以从数据库本身出发，使用数据库的搜索命令来进行搜索，但是这种搜索的方式往往面临在数据量很大的情况下，模糊搜索不一定走索引，因此效率就会很低。
初次之外就是使用Lucene搜索技术，解决在海量数据的情况下，利用倒排索引技术，实现快速的搜索、打分、排序等功能。
Lucene概述 2.1 什么是Lucene 作为一个开放源代码项目，Lucene从问世之后，引发了开放源代码社群的巨大反响，程序员们不仅使用它构建具体的全文检索应用，而且将之集成到各种系统软件中去，以及构建Web应用，甚至某些商业软件也采用了Lucene作为其内部全文检索子系统的核心。apache软件基金会的网站使用了Lucene作为全文检索的引擎，IBM的开源软件eclipse的2.1版本中也采用了Lucene作为帮助子系统的全文索引引擎，相应的IBM的商业软件Web Sphere中也采用了Lucene。Lucene以其开放源代码的特性、优异的索引结构、良好的系统架构获得了越来越多的应用。
Lucene是一个高性能、可伸缩的信息搜索(IR)库。它可以为你的应用程序添加索引和搜索能力。Lucene是用java实现的、成熟的开源项目，是著名的Apache Jakarta大家庭的一员，并且基于Apache软件许可 [ASF, License]。同样，Lucene是当前非常流行的、免费的Java信息搜索(IR)库。
2.2 全文检索和倒排索引 计算机程序一个文档一个文档的扫描，对于每一个文档，从头看到尾，对每一词建立一个索引，指明该词在文章中出现的次数和位置，当用户查找数据时，索引程序就根据事先建立的索引进行查找，并将查找结果反馈给用户的检索方式。
2.3 Lucene与Solr的关系 Lucene是一套实现了全文检索的底层API，提供对于全文检索的基础支持，而Solr是全文检索引擎的一个实现产品，是一个企业级搜索应用服务器。
2.4 Lucene的下载 Lucene是Apache旗下的顶级项目，我们可以直接访问其官网进行下载和使用。
 目前最新的版本是7.x系列，但是大多数企业中依旧使用4.x版本，比较稳定。本次课程我们使用4.10.2版本。
Lucene的基本使用 使用Lucene的API来实现对索引的增（创建索引）、删（删除索引）、改（修改索引）、查（搜索数据）。
3.1 创建索引 3.1.1 创建索引的流程 3.1.2 添加依赖 使用Lucene需要添加Lucene的依赖。
lucene核心库 lucene-core" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/44138f63dc165fe379ce9a27fd08653e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-01-17T15:31:09+08:00" />
<meta property="article:modified_time" content="2019-01-17T15:31:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Lucene</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:0cm;"><strong>Luence</strong></h2> 
<ol><li><strong>了解搜索技术</strong> 
  <ol><li><strong>搜索引擎</strong></li></ol></li></ol> 
<p style="margin-left:0cm;">一个搜索引擎由搜索器 、索引器 、检索器 和用户接口 四个部分组成。搜索器的功能是在互联网 中漫游，发现和搜集信息。索引器的功能是理解搜索器所搜索的信息，从中抽取出索引项，用于表示文档 以及生成文档库的索引表。检索器的功能是根据用户的查询在索引库中快速检出文档，进行文档与查询的相关度评价，对将要输出的结果进行排序，并实现某种用户相关性反馈机制。用户接口的作用是输入用户查询、显示查询结果、提供用户相关性反馈机制。</p> 
<ol><li> 
  <ol><li><strong>搜索引擎发展史</strong></li></ol></li></ol> 
<p style="margin-left:0cm;">Google：1998年10月之前，Google只是美国斯坦福大学的一个小项目。1995年博士生Larry Page开始学习搜索引擎设计，于1997年9月15日注册了google.com 的域名。</p> 
<p style="margin-left:0cm;">百度：2000年1月，两位北大校友，李彦宏与好友徐勇在北京中关村创立了百度公司。</p> 
<p style="margin-left:0cm;">雅虎：1994年4月，斯坦福（Stanford）大学的两名博士生，美籍华人杨致远和美国人David Filo共同创办了超级目录索引（Yahoo），并成功地使搜索引擎的概念深入人心。从此搜索引擎进入了高速发展时期。</p> 
<p style="margin-left:0cm;">新浪：1998年12月1日，四通利方信息技术有限公司和华渊资讯公司宣布合并，成立新浪网公司并推出同名的中文网站。其搜索引擎技术的合作对象是百度公司。</p> 
<p style="margin-left:0cm;">搜狐：1998年2月，爱特信公司创办了“搜狐”大型中文网络系统。搜狐站点的内容大量采用了人工选择和分类，并提供“分类查询”和“关键词”两种方式检索。其搜索引擎技术的合作对象是百度公司。</p> 
<ol><li> 
  <ol><li><strong>搜索引擎的原理</strong></li></ol></li></ol> 
<p><img alt="" class="has" height="432" src="https://images2.imgbox.com/4f/4b/Or5M3ve6_o.png" width="486"></p> 
<ol><li> 
  <ol><li> 
    <ol><li><strong>爬行</strong></li></ol></li></ol></li></ol> 
<p style="margin-left:0cm;">搜索引擎是通过一种特定规律的软件跟踪网页的链接，从一个链接爬到另外一个链接，像蜘蛛在蜘蛛网上爬行一样，所以被称为“蜘蛛”也被称为“机器人”。搜索引擎蜘蛛的爬行是被输入了一定的规则的，它需要遵从一些命令或文件的内容。</p> 
<ol><li> 
  <ol><li> 
    <ol><li><strong>抓取存储</strong></li></ol></li></ol></li></ol> 
<p style="margin-left:0cm;">搜索引擎是通过蜘蛛跟踪链接爬行到网页，并将爬行的数据存入原始页面数据库。其中的页面数据与用户浏览器得到的HTML是完全一样的。搜索引擎蜘蛛在抓取页面时，也做一定的重复内容检测，一旦遇到权重很低的网站上有大量抄袭、采集或者复制的内容，很可能就不再爬行。</p> 
<ol><li> 
  <ol><li> 
    <ol><li><strong>预处理</strong></li></ol></li></ol></li></ol> 
<p style="margin-left:0cm;">搜索引擎将蜘蛛抓取回来的页面，进行各种步骤的预处理，包括：提取文字，中文分词，去停止词，消除噪音（搜索引擎需要识别并消除这些噪声，比如版权声明文字、导航条、广告等……），正向索引，倒排索引，链接关系计算，特殊文件处理。</p> 
<p style="margin-left:0cm;">除了HTML 文件外，搜索引擎通常还能抓取和索引以文字为基础的多种文件类型，如 PDF、Word、WPS、XLS、PPT、TXT 文件等。我们在搜索结果中也经常会看到这些文件类型。 但搜索引擎还不能处理图片、视频、Flash 这类非文字内容，也不能执行脚本和程序。</p> 
<ol><li> 
  <ol><li> 
    <ol><li><strong>排名</strong></li></ol></li></ol></li></ol> 
<p style="margin-left:0cm;">用户在搜索框输入关键词后，排名程序调用索引库数据，计算排名显示给用户，排名过程与用户直接互动的。但是，由于搜索引擎的数据量庞大，虽然能达到每日都有小的更新，但是一般情况搜索引擎的排名规则都是根据日、周、月阶段性不同幅度的更新。</p> 
<ol><li> 
  <ol><li><strong>搜索技术的应用场景</strong></li></ol></li></ol> 
<p style="margin-left:0cm;">搜索引擎广泛应用在大型综合搜索网站，如百度，谷歌等，也应用于系统的站内搜索。</p> 
<ol><li> 
  <ol><li><strong>实现搜索技术的方式</strong></li></ol></li></ol> 
<p style="margin-left:0cm;">实现搜索技术可以从数据库本身出发，使用数据库的搜索命令来进行搜索，但是这种搜索的方式往往面临在数据量很大的情况下，模糊搜索不一定走索引，因此效率就会很低。</p> 
<p style="margin-left:0cm;">初次之外就是使用Lucene搜索技术，解决在海量数据的情况下，利用倒排索引技术，实现快速的搜索、打分、排序等功能。</p> 
<ol><li><strong>Lucene概述</strong></li></ol> 
<h3 style="margin-left:28.8pt;"><strong>2.1 什么是Lucene</strong></h3> 
<p style="margin-left:0cm;">作为一个开放源代码项目，Lucene从问世之后，引发了开放源代码社群的巨大反响，程序员们不仅使用它构建具体的全文检索应用，而且将之集成到各种系统软件中去，以及构建Web应用，甚至某些商业软件也采用了Lucene作为其内部全文检索子系统的核心。apache软件基金会的网站使用了Lucene作为全文检索的引擎，IBM的开源软件eclipse的2.1版本中也采用了Lucene作为帮助子系统的全文索引引擎，相应的IBM的商业软件Web Sphere中也采用了Lucene。Lucene以其开放源代码的特性、优异的索引结构、良好的系统架构获得了越来越多的应用。</p> 
<p style="margin-left:0cm;">Lucene是一个高性能、可伸缩的信息搜索(IR)库。它可以为你的应用程序添加索引和搜索能力。Lucene是用java实现的、成熟的开源项目，是著名的Apache Jakarta大家庭的一员，并且基于Apache软件许可 [ASF, License]。同样，Lucene是当前非常流行的、免费的Java信息搜索(IR)库。</p> 
<h3 style="margin-left:28.8pt;"><strong>2.2  全文检索和倒排索引</strong></h3> 
<p style="margin-left:0cm;">         计算机程序一个文档一个文档的扫描，对于每一个文档，从头看到尾，对每一词建立一个索引，指明该词在文章中出现的次数和位置，当用户查找数据时，索引程序就根据事先建立的索引进行查找，并将查找结果反馈给用户的检索方式。</p> 
<h3 style="margin-left:28.8pt;"><strong>2.3  Lucene与Solr的关系</strong></h3> 
<p style="margin-left:0cm;">         Lucene是一套实现了全文检索的底层API，提供对于全文检索的基础支持，而Solr是全文检索引擎的一个实现产品，是一个企业级搜索应用服务器。</p> 
<h3 style="margin-left:28.8pt;"><strong>2.4  Lucene的下载</strong></h3> 
<p style="margin-left:0cm;">         Lucene是Apache旗下的顶级项目，我们可以直接访问其官网进行下载和使用。</p> 
<p style="margin-left:0cm;">    目前最新的版本是7.x系列，但是大多数企业中依旧使用4.x版本，比较稳定。本次课程我们使用4.10.2版本。</p> 
<ol><li><strong>Lucene的基本使用</strong></li></ol> 
<p style="margin-left:0cm;">使用Lucene的API来实现对索引的增（创建索引）、删（删除索引）、改（修改索引）、查（搜索数据）。</p> 
<h3 style="margin-left:28.8pt;"><strong>3.1 创建索引</strong></h3> 
<h4 style="margin-left:36pt;"><strong>3.1.1  创建索引的流程</strong></h4> 
<h4 style="margin-left:36pt;"><strong>3.1.2  添加依赖</strong></h4> 
<p style="margin-left:0cm;">         使用Lucene需要添加Lucene的依赖。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="vertical-align:top;width:426.1pt;"> <p style="margin-left:0cm;">lucene核心库    lucene-core</p> <p style="margin-left:0cm;">查询解析器       lucene-queryparser</p> <p style="margin-left:0cm;">默认分词器      lucene-analyzers-common</p> <p style="margin-left:0cm;">IK分词器        ikanalyzer</p> <p style="margin-left:0cm;">高亮显示        lucene-highlighter</p> </td></tr></tbody></table> 
<p style="margin-left:0cm;">       Maven工程中的依赖添加如下：</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">project</span> <span style="color:#7f007f;">xmlns</span><span style="color:#000000;">=</span><em><span style="color:#2a00ff;">"http://maven.apache.org/POM/4.0.0"</span></em> <span style="color:#7f007f;">xmlns:xsi</span><span style="color:#000000;">=</span><em><span style="color:#2a00ff;">"http://www.w3.org/2001/XMLSchema-instance"</span></em></p> <p style="margin-left:0cm;">   <span style="color:#7f007f;">xsi:schemaLocation</span><span style="color:#000000;">=</span><em><span style="color:#2a00ff;">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></em><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">   <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">modelVersion</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">4.0.0</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">modelVersion</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">   <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">com.igeek.lucene</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">   <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">lucene</span></u><span style="color:#000000;">-01</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">   <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">0.0.1-SNAPSHOT</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">   <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependencies</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f5fbf;">&lt;!-- <u>Junit</u></span><span style="color:#3f5fbf;">单元测试</span><span style="color:#3f5fbf;"> --&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">junit</span></u><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">junit</span></u><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">4.12</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f5fbf;">&lt;!-- <u>lucene</u></span><span style="color:#3f5fbf;">核心库</span><span style="color:#3f5fbf;"> --&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">org.apache.lucene</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">lucene</span></u><span style="color:#000000;">-core</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">4.10.2</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f5fbf;">&lt;!-- <u>Lucene</u></span><span style="color:#3f5fbf;">的查询解析器</span><span style="color:#3f5fbf;"> --&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">org.apache.lucene</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">lucene</span></u><span style="color:#000000;">-<u>queryparser</u></span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">4.10.2</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f5fbf;">&lt;!-- <u>lucene</u></span><span style="color:#3f5fbf;">的默认分词器库</span><span style="color:#3f5fbf;"> --&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">org.apache.lucene</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">lucene</span></u><span style="color:#000000;">-analyzers-common</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">4.10.2</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f5fbf;">&lt;!-- <u>lucene</u></span><span style="color:#3f5fbf;">的高亮显示</span><span style="color:#3f5fbf;"> --&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">org.apache.lucene</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">lucene</span></u><span style="color:#000000;">-<u>highlighter</u></span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">4.10.2</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f5fbf;">&lt;!-- IK</span><span style="color:#3f5fbf;">分词器</span><span style="color:#3f5fbf;"> --&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">com.janeluo</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">groupId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span><u><span style="color:#000000;">ikanalyzer</span></u><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">artifactId</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">         <span style="color:#008080;">&lt;</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span><span style="color:#000000;">2012_u6</span><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">version</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">      <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependency</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;">   <span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">dependencies</span><span style="color:#008080;">&gt;</span></p> <p style="margin-left:0cm;"><span style="color:#008080;">&lt;/</span><span style="color:#3f7f7f;">project</span><span style="color:#008080;">&gt;</span></p> </td></tr></tbody></table> 
<h4 style="margin-left:36pt;"><strong>3.1.3  代码实现</strong></h4> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.analysis.Analyzer;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.analysis.standard.StandardAnalyzer;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Field.Store;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.StringField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.TextField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriterConfig;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.util.Version;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexCreate {<!-- --></span></p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> <u>main</u>(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Document </span><span style="color:#6a3e3e;">document</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Document();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建并添加字段信息</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">document</span><span style="color:#000000;">.add(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> StringField(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"1"</span><span style="color:#000000;">, Store.</span><strong><em><span style="color:#0000c0;">YES</span></em></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">添加字段</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">document</span><span style="color:#000000;">.add(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> TextField(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">中国工博会上演</span><span style="color:#2a00ff;">“</span><span style="color:#2a00ff;">人工智能总动员</span><span style="color:#2a00ff;">”"</span><span style="color:#000000;">, Store.</span><strong><em><span style="color:#0000c0;">YES</span></em></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建分词器对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Analyzer </span><span style="color:#6a3e3e;">analyzer</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> StandardAnalyzer();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建配置对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriterConfig </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriterConfig(Version.</span><strong><em><span style="color:#0000c0;">LATEST</span></em></strong><span style="color:#000000;">, </span><span style="color:#6a3e3e;">analyzer</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建索引的写出工具类</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriter </span><span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriter(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">添加文档</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;">.addDocument(</span><span style="color:#6a3e3e;">document</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">提交</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;">.commit();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">关闭</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;">.close();</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<p style="margin-left:0cm;">       程序执行后在工程中生产索引文件，如下图。</p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="378" src="https://images2.imgbox.com/71/4b/DvbL0cCd_o.png" width="304"></p> 
<p style="margin-left:0cm;">       所以创建成功之后，可以使用工具来查看已经创建的索引。</p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="395" src="https://images2.imgbox.com/b4/97/tvRBMAYj_o.png" width="497"></p> 
<table><tbody><tr><td> <p style="margin-left:0cm;"><span style="color:#000000;">生成的索引的位置</span></p> </td></tr></tbody></table> 
<p></p> 
<p> </p> 
<p style="margin-left:0cm;">       点击OK之后看到了索引中的内容。</p> 
<p style="margin-left:0cm;"><img alt="" class="has" height="440" src="https://images2.imgbox.com/4d/8a/ds5oBqmg_o.png" width="554"><img alt="" class="has" height="411" src="https://images2.imgbox.com/f8/b0/lc2zYJ30_o.png" width="518"></p> 
<table><tbody><tr><td> <p style="margin-left:0cm;"><span style="color:#000000;">分词的信息</span></p> </td></tr></tbody></table> 
<table><tbody><tr><td> <p style="margin-left:0cm;"><span style="color:#000000;">字段的信息</span></p> </td></tr></tbody></table> 
<p></p> 
<p> </p> 
<p style="margin-left:0cm;"> </p> 
<table><tbody><tr><td> <p style="margin-left:0cm;"><span style="color:#000000;">存储文档的信息</span></p> </td></tr></tbody></table> 
<p></p> 
<p> </p> 
<p style="margin-left:0cm;">       从以上可以看出，使用标准分词器，对于中文的分词处理存在问题，因此，我们可以使用IK分词器。</p> 
<p style="margin-left:0cm;"></p> 
<p style="margin-left:0cm;">       使用IK分词器后，对于中文的分词支持是不错的。</p> 
<p style="margin-left:0cm;"></p> 
<h3 style="margin-left:28.8pt;"><strong>3.2 查询索引</strong></h3> 
<h4 style="margin-left:36pt;"><strong>3.2.1 基本查询</strong></h4> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.queryparser.classic.QueryParser;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSearch {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询解析器</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      QueryParser </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> QueryParser(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer());</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;">.parse(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">人工智能</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取总条数</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共找到</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取得分文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">取出文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据编号去找文档</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));    }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h4 style="margin-left:36pt;"><strong>3.2.2 Term查询</strong></h4> 
<p style="margin-left:0cm;">Term(词条)是搜索的最小单位，不可再分词，值必须是字符串。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.Term;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> <u>org.apache.lucene.queryparser.classic.QueryParser</u>;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TermQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> <u>org.wltea.analyzer.lucene.IKAnalyzer</u>;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSearch {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> TermQuery(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Term(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">人工</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取总条数</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共找到</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取得分文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">取出文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据编号去找文档</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h4 style="margin-left:36pt;"><strong>3.2.3通配符查询</strong></h4> 
<p style="margin-left:0cm;">WildcardQuery可以进行测试通配符查询，?可以代表任意一个字符，*可以任意多个任意字符。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.Term;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> <u>org.apache.lucene.queryparser.classic.QueryParser</u>;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> <u>org.apache.lucene.search.TermQuery</u>;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.WildcardQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> <u>org.wltea.analyzer.lucene.IKAnalyzer</u>;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSearch {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> WildcardQuery (</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Term(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"*</span><span style="color:#2a00ff;">智能</span><span style="color:#2a00ff;">*"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取总条数</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共找到</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取得分文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">取出文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据编号去找文档</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h4 style="margin-left:36pt;"><strong>3.2.4模糊查询</strong></h4> 
<p style="margin-left:0cm;">FuzzyQuery可以进行模糊查询，创建模糊查询对象:允许用户输错。但是要求错误的最大编辑距离不能超过2。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.Term;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.FuzzyQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSearch {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> FuzzyQuery(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Term(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">,</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">智商</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">),1);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取总条数</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共找到</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取得分文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">取出文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据编号去找文档</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h4 style="margin-left:36pt;"><strong>3.2.5数值范围查询</strong></h4> 
<p style="margin-left:0cm;">       数值范围查询使用NumericRangeQuery，可以用来对非String类型的ID进行精确的查找。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.NumericRangeQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSearch {<!-- --></span></p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = NumericRangeQuery.<em>newIntRange</em>(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, 1, 2, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取总条数</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共找到</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取得分文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">取出文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据编号去找文档</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h4 style="margin-left:36pt;"><strong>3.2.6组合查询</strong></h4> 
<p style="margin-left:0cm;">布尔查询本身没有查询条件，可以把其它查询通过逻辑运算进行组合，Occur.MUST表示交集，Occur.SHOULD表示并集，Occur.MUST_NOT表示非。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.BooleanClause.Occur;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.BooleanQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.NumericRangeQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSearch {<!-- --></span></p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">索引搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建查询对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query1</span><span style="color:#000000;"> = NumericRangeQuery.<em>newIntRange</em>(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, 1, 3, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query2</span><span style="color:#000000;"> = NumericRangeQuery.<em>newIntRange</em>(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, 2, 4, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建布尔查询的对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      BooleanQuery </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> BooleanQuery();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">组合其它查询</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">query</span><span style="color:#000000;">.add(</span><span style="color:#6a3e3e;">query1</span><span style="color:#000000;">, Occur.</span><strong><em><span style="color:#0000c0;">MUST_NOT</span></em></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">query</span><span style="color:#000000;">.add(</span><span style="color:#6a3e3e;">query2</span><span style="color:#000000;">, Occur.</span><strong><em><span style="color:#0000c0;">SHOULD</span></em></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取总条数</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共找到</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取得分文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">取出文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据编号去找文档</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h3 style="margin-left:28.8pt;"><strong>3.3 修改索引</strong></h3> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Field.Store;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.StringField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.TextField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriterConfig;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.Term;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.util.Version;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexUpdate {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory <u>directory</u> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建配置对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriterConfig </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriterConfig(Version.</span><strong><em><span style="color:#0000c0;">LATEST</span></em></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer());</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建索引写出工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriter </span><span style="color:#6a3e3e;">writer</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriter(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建新的文档数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Document();</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.add(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> StringField(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"1"</span><span style="color:#000000;">, Store.</span><strong><em><span style="color:#0000c0;">YES</span></em></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.add(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> TextField(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">美媒称中国科技创新拥有秘密武器：战略性和创新性思维</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">, Store.</span><strong><em><span style="color:#0000c0;">YES</span></em></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">修改索引</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.updateDocument(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Term(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"1"</span><span style="color:#000000;">), </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">提交</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.commit();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">关闭</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.close();</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h3 style="margin-left:28.8pt;"><strong>3.4 删除索引</strong></h3> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriterConfig;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.Term;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.NumericRangeQuery;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.util.Version;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexDelete {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建配置对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriterConfig </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriterConfig(Version.</span><strong><em><span style="color:#0000c0;">LATEST</span></em></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer());</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建索引写出工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriter </span><span style="color:#6a3e3e;">writer</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriter(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据词条进行删除</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.deleteDocuments(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Term(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"1"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">根据</span><span style="color:#3f7f5f;">query</span><span style="color:#3f7f5f;">对象删除</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">       Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = NumericRangeQuery.<em>newIntRange</em>(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, 2, 2, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">       <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.deleteDocuments(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">删除所有</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.deleteAll();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">提交</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.commit();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">关闭</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">writer</span><span style="color:#000000;">.close();</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<ol><li><strong>Lucene的高级使用</strong></li></ol> 
<h3 style="margin-left:28.8pt;"><strong>4.1高亮显示</strong></h3> 
<p style="margin-left:0cm;">       高亮显示的主要实现原理在于，为所有的关键字添加一个HTML标签，通过该标签来设置高亮。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.queryparser.classic.QueryParser;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.highlight.Formatter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.highlight.Highlighter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.highlight.QueryScorer;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.highlight.Scorer;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.highlight.SimpleHTMLFormatter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexHighlighter {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">      QueryParser </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> QueryParser(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer());</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;">.parse(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">人工智能</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">格式化器</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Formatter </span><span style="color:#6a3e3e;">formatter</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> SimpleHTMLFormatter(</span><span style="color:#2a00ff;">"&lt;em&gt;"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"&lt;/em&gt;"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Scorer </span><span style="color:#6a3e3e;">scorer</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> QueryScorer(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">准备高亮工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Highlighter </span><span style="color:#6a3e3e;">highlighter</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Highlighter(</span><span style="color:#6a3e3e;">formatter</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">scorer</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">         String </span><span style="color:#6a3e3e;">title</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">处理查询结果</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         String </span><span style="color:#6a3e3e;">hTitle</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">highlighter</span><span style="color:#000000;">.getBestFragment(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer(), </span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">title</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">hTitle</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h3 style="margin-left:28.8pt;"><strong>4.2排序</strong></h3> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.queryparser.classic.QueryParser;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Sort;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.SortField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.SortField.Type;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexSort {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">      QueryParser </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> QueryParser(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer());</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;">.parse(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">人工智能</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建排序对象，</span><span style="color:#3f7f5f;">false</span><span style="color:#3f7f5f;">升序，</span><span style="color:#3f7f5f;">true</span><span style="color:#3f7f5f;">降序</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Sort </span><span style="color:#6a3e3e;">sort</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Sort(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> SortField(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, Type.</span><strong><em><span style="color:#0000c0;">INT</span></em></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">true</span></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, 10, </span><span style="color:#6a3e3e;">sort</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> : </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">) {<!-- --></span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h3 style="margin-left:28.8pt;"><strong>4.3分页</strong></h3> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.DirectoryReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexReader;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.queryparser.classic.QueryParser;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.IndexSearcher;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Query;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.ScoreDoc;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.Sort;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.SortField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.SortField.Type;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.search.TopDocs;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexPageQuery {<!-- --></span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">每页条数</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">pageSize</span><span style="color:#000000;"> = 1;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">当前页码</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">pageNum</span><span style="color:#000000;"> = 2;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">当前页的起始条数</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">start</span><span style="color:#000000;"> = (</span><span style="color:#6a3e3e;">pageNum</span><span style="color:#000000;"> - 1) * </span><span style="color:#6a3e3e;">pageSize</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">当前页的结束条数</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">end</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">start</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">pageSize</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">     </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建读取工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexReader </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;"> = DirectoryReader.<em>open</em>(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建搜索工具</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexSearcher </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexSearcher(</span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">     </p> <p style="margin-left:0cm;"><span style="color:#000000;">      QueryParser </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> QueryParser(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer());</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Query </span><span style="color:#6a3e3e;">query</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">parser</span><span style="color:#000000;">.parse(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">人工智能</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">     </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">创建排序对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Sort </span><span style="color:#6a3e3e;">sort</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Sort(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> SortField(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, Type.</span><strong><em><span style="color:#0000c0;">INT</span></em></strong><span style="color:#000000;">, </span><strong><span style="color:#7f0055;">false</span></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">搜索数据</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TopDocs </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">searcher</span><span style="color:#000000;">.search(</span><span style="color:#6a3e3e;">query</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">end</span><span style="color:#000000;">,</span><span style="color:#6a3e3e;">sort</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">本次搜索共</span><span style="color:#2a00ff;">"</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">totalHits</span><span style="color:#000000;"> + </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">条数据</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">     </p> <p style="margin-left:0cm;"><span style="color:#000000;">      ScoreDoc[] </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">topDocs</span><span style="color:#000000;">.</span><span style="color:#0000c0;">scoreDocs</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;">      <strong><span style="color:#7f0055;">for</span></strong><span style="color:#000000;"> (</span><strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">i</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">start</span><span style="color:#000000;">; </span><span style="color:#6a3e3e;">i</span><span style="color:#000000;"> &lt; </span><span style="color:#6a3e3e;">end</span><span style="color:#000000;">; </span><span style="color:#6a3e3e;">i</span><span style="color:#000000;">++) {<!-- --></span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         ScoreDoc </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDocs</span><span style="color:#000000;">[</span><span style="color:#6a3e3e;">i</span><span style="color:#000000;">];</span></p> <p style="margin-left:0cm;">         <span style="color:#3f7f5f;">// </span><span style="color:#3f7f5f;">获取文档编号</span></p> <p style="margin-left:0cm;">         <strong><span style="color:#7f0055;">int</span></strong> <span style="color:#6a3e3e;">docID</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">scoreDoc</span><span style="color:#000000;">.</span><span style="color:#0000c0;">doc</span><span style="color:#000000;">;</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         Document </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;"> = </span><span style="color:#6a3e3e;">reader</span><span style="color:#000000;">.document(</span><span style="color:#6a3e3e;">docID</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"id: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">         System.</span><strong><em><span style="color:#0000c0;">out</span></em></strong><span style="color:#000000;">.println(</span><span style="color:#2a00ff;">"title: "</span><span style="color:#000000;"> + </span><span style="color:#6a3e3e;">doc</span><span style="color:#000000;">.get(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<h3 style="margin-left:28.8pt;"><strong>4.4加权算法</strong></h3> 
<p style="margin-left:0cm;">    Lucene会对搜索结果打分，用来表示文档数据与词条关联性的强弱，得分越高，表示查询的匹配度就越高，排名就越靠前。</p> 
<table border="1" cellspacing="0"><tbody><tr><td style="width:426.1pt;"> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">package</span></strong><span style="color:#000000;"> com.igeekhome.lucene;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> java.io.File;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.analysis.Analyzer;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Document;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.Field.Store;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.IntField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.document.TextField;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriter;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.index.IndexWriterConfig;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.Directory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.store.FSDirectory;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.apache.lucene.util.Version;</span></p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">import</span></strong><span style="color:#000000;"> org.wltea.analyzer.lucene.IKAnalyzer;</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;"><strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">class</span></strong><span style="color:#000000;"> IndexCreate {<!-- --></span></p> <p style="margin-left:0cm;">   <strong><span style="color:#7f0055;">public</span></strong> <strong><span style="color:#7f0055;">static</span></strong> <strong><span style="color:#7f0055;">void</span></strong><span style="color:#000000;"> main(String[] </span><span style="color:#6a3e3e;">args</span><span style="color:#000000;">) </span><strong><span style="color:#7f0055;">throws</span></strong><span style="color:#000000;"> Exception {<!-- --></span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建文档对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Document </span><span style="color:#6a3e3e;">document</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> Document();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建并添加字段信息</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">document</span><span style="color:#000000;">.add(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IntField(</span><span style="color:#2a00ff;">"id"</span><span style="color:#000000;">, 3, Store.</span><strong><em><span style="color:#0000c0;">YES</span></em></strong><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">     </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建字段</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      TextField </span><span style="color:#6a3e3e;">textField</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> TextField(</span><span style="color:#2a00ff;">"title"</span><span style="color:#000000;">, </span><span style="color:#2a00ff;">"</span><span style="color:#2a00ff;">韩资企业在渝达</span><span style="color:#2a00ff;">222</span><span style="color:#2a00ff;">家</span> <span style="color:#2a00ff;">深耕汽车研发制造、人工智能等领域</span><span style="color:#2a00ff;">"</span><span style="color:#000000;">, Store.</span><strong><em><span style="color:#0000c0;">YES</span></em></strong><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">设置加权</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">textField</span><span style="color:#000000;">.setBoost(2.0f);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">添加字段</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">document</span><span style="color:#000000;">.add(</span><span style="color:#6a3e3e;">textField</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建索引目录对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Directory </span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;"> = FSDirectory.<em>open</em>(</span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> File(</span><span style="color:#2a00ff;">"indexDir"</span><span style="color:#000000;">));</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建分词器对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      Analyzer </span><span style="color:#6a3e3e;">analyzer</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IKAnalyzer();</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建配置对象</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriterConfig </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriterConfig(Version.</span><strong><em><span style="color:#0000c0;">LATEST</span></em></strong><span style="color:#000000;">, </span><span style="color:#6a3e3e;">analyzer</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">创建索引的写出工具类</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">      IndexWriter </span><span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;"> = </span><strong><span style="color:#7f0055;">new</span></strong><span style="color:#000000;"> IndexWriter(</span><span style="color:#6a3e3e;">directory</span><span style="color:#000000;">, </span><span style="color:#6a3e3e;">conf</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;"> </p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">添加文档</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;">.addDocument(</span><span style="color:#6a3e3e;">document</span><span style="color:#000000;">);</span></p> <p style="margin-left:0cm;">      <span style="color:#3f7f5f;">//</span><span style="color:#3f7f5f;">提交</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;">.commit();</span></p> <p style="margin-left:0cm;">      <span style="color:#6a3e3e;">indexWriter</span><span style="color:#000000;">.close();</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">   }</span></p> <p style="margin-left:0cm;"><span style="color:#000000;">}</span></p> </td></tr></tbody></table> 
<p style="margin-left:0cm;"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/92731a1d9e5e3d4dc64bb7439bda32e0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">oracle SDO_ORDINATE_ARRAY直接展示</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/21b942eba14c05ce909f5bf7b13fcf83/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">laravel 基础知识</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>