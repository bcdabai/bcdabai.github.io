<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ä¸€æ–‡è®©ä½ å½»åº•ææ‡‚Mybatisä¹‹ç¼“å­˜æœºåˆ¶ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ä¸€æ–‡è®©ä½ å½»åº•ææ‡‚Mybatisä¹‹ç¼“å­˜æœºåˆ¶" />
<meta property="og:description" content="ç¼–è¯‘è½¯ä»¶ï¼šIntelliJ IDEA 2019.2.4 x64
æ“ä½œç³»ç»Ÿï¼šwin10 x64 ä½ å®¶åº­ç‰ˆ
Mavenç‰ˆæœ¬ï¼šapache-maven-3.6.3
Mybatisç‰ˆæœ¬ï¼š3.5.6
æ–‡ç« ç›®å½• ä¸€. ç¼“å­˜æ˜¯ä»€ä¹ˆï¼ŸäºŒ. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å­˜ï¼Ÿä¸‰. Mybatisä¸­çš„ç¼“å­˜åˆ†å“ªå‡ ç§ï¼Ÿ3.1 Mybatisç¼“å­˜æœºåˆ¶ä¹‹ä¸€çº§ç¼“å­˜3.2 Mybatisç¼“å­˜æœºåˆ¶ä¹‹äºŒçº§ç¼“å­˜3.3 Mybatisä¸­ç¼“å­˜æœºåˆ¶ä¹‹ç¬¬ä¸‰æ–¹ç¼“å­˜ã€ä»¥EhCacheä¸ºä¾‹ã€‘ ä¸€. ç¼“å­˜æ˜¯ä»€ä¹ˆï¼Ÿ ä¸€è¯´åˆ°ç¼“å­˜ï¼Œæˆ‘ä»¬å¯èƒ½éƒ½ä¼šæƒ³åˆ°Casheï¼Œè¿™é‡Œæ‘˜è‡ªç™¾åº¦ç™¾ç§‘å¯¹å®ƒçš„è§£é‡Šï¼šå®ƒåŸæœ¬æ˜¯æŒ‡è®¿é—®é€Ÿåº¦æ¯”ä¸€èˆ¬éšæœºå­˜å–å­˜å‚¨å™¨ï¼ˆRAMï¼‰å¿«çš„ä¸€ç§é«˜é€Ÿå­˜å‚¨å™¨ï¼Œé€šå¸¸å®ƒä¸åƒç³»ç»Ÿä¸»å­˜é‚£æ ·ä½¿ç”¨DRAMæŠ€æœ¯ï¼Œè€Œä½¿ç”¨æ˜‚è´µä½†è¾ƒå¿«é€Ÿçš„SRAMæŠ€æœ¯ã€‚ç¼“å­˜çš„è®¾ç½®æ˜¯æ‰€æœ‰ç°ä»£è®¡ç®—æœºç³»ç»Ÿå‘æŒ¥é«˜æ€§èƒ½çš„é‡è¦å› ç´ ä¹‹ä¸€ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯å½“CPUè¦è¯»å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œé¦–å…ˆä»CPUç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°å°±ç«‹å³è¯»å–å¹¶é€ç»™CPUå¤„ç†ï¼›æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä»é€Ÿç‡ç›¸å¯¹è¾ƒæ…¢çš„å†…å­˜ä¸­è¯»å–å¹¶é€ç»™CPUå¤„ç†ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªæ•°æ®æ‰€åœ¨çš„æ•°æ®å—è°ƒå…¥ç¼“å­˜ä¸­ï¼Œå¯ä»¥ä½¿å¾—ä»¥åå¯¹æ•´å—æ•°æ®çš„è¯»å–éƒ½ä»ç¼“å­˜ä¸­è¿›è¡Œï¼Œä¸å¿…å†è°ƒç”¨å†…å­˜ã€‚
ä»¥ä¸Šéƒ¨åˆ†å†…å®¹å¯èƒ½çœ‹ä¸æ‡‚ï¼Œæ²¡å…³ç³»ï¼Œä½ åªéœ€è¦çŸ¥é“æ­£æ˜¯ç”±äºè¿™æ ·çš„è¯»å–æœºåˆ¶ï¼Œä½¿å¾—CPUè¯»å–ç¼“å­˜çš„å‘½ä¸­ç‡éå¸¸é«˜ï¼ˆå¤§å¤šæ•°CPUå¯è¾¾90%å·¦å³ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´CPUä¸‹ä¸€æ¬¡è¦è¯»å–çš„æ•°æ®90%éƒ½åœ¨CPUç¼“å­˜ä¸­ï¼Œåªæœ‰å¤§çº¦10%éœ€è¦ä»å†…å­˜è¯»å–ã€‚è¿™æ ·å¤§å¤§èŠ‚çœäº†CPUç›´æ¥è¯»å–å†…å­˜çš„æ—¶é—´ï¼Œéå¸¸å¿«æ·ï¼ï¼ï¼
ç®€è€Œè¨€ä¹‹ï¼Œä»¥cpuä¸­çš„ç¼“å­˜ä¸¾ä¾‹ï¼Œç¼“å­˜å…¶å®å°±æ˜¯æ•°æ®äº¤æ¢çš„ç¼“å†²åŒºã€åˆç§°Casheã€‘ï¼Œæ˜¯å­˜è´®æ•°æ®ï¼ˆä½¿ç”¨é¢‘ç¹çš„æ•°æ®ï¼‰çš„ä¸´æ—¶åœ°æ–¹ã€‚å½“ç”¨æˆ·æŸ¥è¯¢æ•°æ®ï¼Œé¦–å…ˆåœ¨ç¼“å­˜ä¸­å¯»æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™ç›´æ¥æ‰§è¡Œã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™å»æ•°æ®åº“ä¸­æŸ¥æ‰¾ã€‚
äºŒ. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å­˜ï¼Ÿ ä¸¾ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼Œå½“æˆ‘ä»¬åœ¨çº¿è§‚çœ‹è§†é¢‘æ—¶ï¼Œä»¥å“”å“©å“”å“©ç½‘ç«™ä¸ºä¾‹ï¼Œä½ ä¼šå‘ç°ï¼Œåº•ä¸‹çš„è¿›åº¦æ¡ä¼šå®æ—¶æ˜¾ç¤ºè“è‰²ï¼Œç™½è‰²ç­‰ä¸¤ç§é¢œè‰²ã€‚ä¸éš¾å‘ç°ï¼Œè“è‰²ä»£è¡¨çš„æ˜¯è§†é¢‘å®é™…æ’­æ”¾çš„è¿›åº¦ï¼Œè€Œç™½è‰²ä»£è¡¨çš„æ˜¯è§†é¢‘å®æ—¶é¢„å…ˆç¼“å­˜çš„è¿›åº¦ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚
è¿™ç§è®©ç”¨æˆ·ä¸€è¾¹ä¸‹è½½ä¸€è¾¹è§‚çœ‹ã€æ”¶å¬ï¼Œè€Œä¸è¦ç­‰æ•´ä¸ªæ–‡ä»¶ä¸‹è½½åˆ°è‡ªå·±çš„è®¡ç®—æœºä¸Šæ‰å¯ä»¥è§‚çœ‹çš„ç½‘ç»œä¼ è¾“æŠ€æœ¯ï¼Œå°±æ˜¯é¼é¼å¤§åçš„æµåª’ä½“æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯çš„åŸç†æ˜¯å…ˆåœ¨ä½¿ç”¨è€…ç«¯çš„è®¡ç®—æœºä¸Šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œåœ¨æ’­æ”¾å‰é¢„å…ˆä¸‹ä¸€æ®µæ•°æ®ä½œä¸ºç¼“å†²ï¼Œåœ¨ç½‘è·¯å®é™…è¿çº¿é€Ÿåº¦å°äºæ’­æ”¾æ‰€è€—çš„é€Ÿåº¦æ—¶ï¼Œæ’­æ”¾ç¨‹åºå°±ä¼šå–ç”¨ä¸€å°æ®µç¼“å†²åŒºå†…çš„æ•°æ®ï¼Œè¿™æ ·å¯ä»¥é¿å…æ’­æ”¾çš„ä¸­æ–­ï¼Œä¹Ÿä½¿å¾—æ’­æ”¾å“è´¨å¾—ä»¥ä¿è¯ã€‚è¯¥æŠ€æœ¯åœ¨å¾ˆå¤šéŸ³é¢‘å½±è§†ç½‘ç«™ä¸Šè¢«å¤§é‡ä½¿ç”¨ï¼Œæ—¨åœ¨ä¸°å¯Œç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒå¹¶æé«˜éŸ³é¢‘çš„æ’­æ”¾æ€§èƒ½ã€‚
è€Œç¨‹åºä¸­çš„ç¼“å­˜ã€Mybatisç¼“å­˜ã€‘ï¼Œäº¦æ˜¯å¦‚æ­¤ï¼ŒMybatisä½¿ç”¨ç¼“å­˜ä¼˜åŠ¿å¯ä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå¹¶é™ä½æœåŠ¡å™¨çš„å‹åŠ›ã€‚å®ƒçš„æœ¬è´¨å°±æ˜¯ç”¨åˆ©ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œç‰ºç‰²æ•°æ®çš„å®æ—¶æ€§ï¼Œä»¥æœåŠ¡å™¨å†…å­˜ä¸­çš„æ•°æ®æš‚æ—¶ä»£æ›¿ä»æ•°æ®åº“è¯»å–æœ€æ–°çš„æ•°æ®ï¼Œå‡å°‘æ•°æ®åº“IOï¼Œå‡è½»æœåŠ¡å™¨å‹åŠ›ï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿï¼ŒåŠ å¿«é¡µé¢æ‰“å¼€é€Ÿåº¦ã€‚
ä¸‰. Mybatisä¸­çš„ç¼“å­˜åˆ†å“ªå‡ ç§ï¼Ÿ ğŸ‘‰åˆ†ç±»
ä¸€çº§ç¼“å­˜äºŒçº§ç¼“å­˜ç¬¬ä¸‰æ–¹ç¼“å­˜ 3.1 Mybatisç¼“å­˜æœºåˆ¶ä¹‹ä¸€çº§ç¼“å­˜ ğŸ‘‰æ¦‚è¿°
ä¸€çº§ç¼“å­˜ã€æœ¬åœ°ç¼“å­˜(Local Cache)æˆ–SqlSessionaçº§åˆ«ç¼“å­˜ã€‘
ğŸ¤”ä»€ä¹ˆæ˜¯SqlSessionaï¼Ÿ
SqlSessionæ˜¯ä¸€ä¸ªä¼šè¯ï¼Œç›¸å½“äºJDBCä¸­çš„ä¸€ä¸ªConnectionå¯¹è±¡ï¼Œæ˜¯æ•´ä¸ªMybatisè¿è¡Œçš„æ ¸å¿ƒï¼Œå®ƒæ˜¯MyBatisçš„å…³é”®å¯¹è±¡ï¼Œæ˜¯æ‰§è¡ŒæŒä¹…åŒ–æ“ä½œçš„ç‹¬äº«ï¼Œç±»ä¼¼äºJDBCä¸­çš„Connectionã€‚å®ƒæ˜¯åº”ç”¨ç¨‹åºä¸æŒä¹…å±‚ä¹‹é—´æ‰§è¡Œäº¤äº’æ“ä½œçš„ä¸€ä¸ªå•çº¿ç¨‹å¯¹è±¡ï¼Œä¹Ÿæ˜¯MyBatisçš„æ ¸å¿ƒæ¥å£ä¹‹ä¸€
ğŸ‘‰ç‰¹ç‚¹
ä¸€çº§ç¼“å­˜é»˜è®¤å¼€å¯ä¸èƒ½å…³é—­å¯ä»¥æ¸…ç©º ğŸ’¡ ï¼šæœ‰ç‚¹ç±»ä¼¼äºä½¿ç”¨è…¾è®¯è§†é¢‘ç½‘ç«™å»çœ‹ç”µå½±ï¼Œç”µå½±è§‚çœ‹è¿›åº¦æ¡å‰çš„é‚£ä¸€å°æ®µç°è‰²çš„è¿›åº¦æ¡
ğŸ‘‰ç¼“å­˜åŸç†
ç¬¬ä¸€æ¬¡è·å–æ•°æ®æ—¶ï¼Œå…ˆä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ï¼Œå°†æ•°æ®ç¼“å­˜è‡³Mybatisä¸€çº§ç¼“å­˜ä¸­ã€ç¼“å­˜åº•å±‚å®ç°åŸç†Map,key:hashCode&#43;æŸ¥è¯¢çš„Sqlld&#43;ç¼–å†™çš„salæŸ¥è¯¢è¯­å¥&#43;å‚æ•°ã€‘ä»¥åå†æ¬¡è·å–æ•°æ®æ—¶ï¼Œå…ˆä»ä¸€çº§ç¼“å­˜ä¸­è·å–ï¼Œå¦‚æœªè·å–åˆ°æ•°æ®ï¼Œå†ä»æ•°æ®åº“ä¸­è·å–æ•°æ® ä¸ä¿¡ï¼Ÿè¯·çœ‹å¦‚ä¸‹æµ‹è¯•ä»£ç çš„ä½“ç°
ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š
@Test public void test04(){ try { String resource = &#34;mybatis-config.xml&#34;; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); //é€šè¿‡SqlSessionFactoryå¯¹è±¡è°ƒç”¨openSession(); SqlSession sqlSession = sqlSessionFactory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c5d22e3a42c9eaf45b7c50d858f4806b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-28T18:44:03+08:00" />
<meta property="article:modified_time" content="2023-07-28T18:44:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ä¸€æ–‡è®©ä½ å½»åº•ææ‡‚Mybatisä¹‹ç¼“å­˜æœºåˆ¶</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>ç¼–è¯‘è½¯ä»¶ï¼šIntelliJ IDEA 2019.2.4 x64<br> æ“ä½œç³»ç»Ÿï¼šwin10 x64 ä½ å®¶åº­ç‰ˆ<br> Mavenç‰ˆæœ¬ï¼šapache-maven-3.6.3<br> Mybatisç‰ˆæœ¬ï¼š3.5.6</p> 
</blockquote> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#__12" rel="nofollow">ä¸€. ç¼“å­˜æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href="#___26" rel="nofollow">äºŒ. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å­˜ï¼Ÿ</a></li><li><a href="#__Mybatis_38" rel="nofollow">ä¸‰. Mybatisä¸­çš„ç¼“å­˜åˆ†å“ªå‡ ç§ï¼Ÿ</a></li><li><ul><li><a href="#31_Mybatis_52" rel="nofollow">3.1 Mybatisç¼“å­˜æœºåˆ¶ä¹‹ä¸€çº§ç¼“å­˜</a></li><li><a href="#32_Mybatis_134" rel="nofollow">3.2 Mybatisç¼“å­˜æœºåˆ¶ä¹‹äºŒçº§ç¼“å­˜</a></li><li><a href="#33_MybatisEhCache_330" rel="nofollow">3.3 Mybatisä¸­ç¼“å­˜æœºåˆ¶ä¹‹ç¬¬ä¸‰æ–¹ç¼“å­˜ã€ä»¥EhCacheä¸ºä¾‹ã€‘</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="__12"></a>ä¸€. ç¼“å­˜æ˜¯ä»€ä¹ˆï¼Ÿ</h2> 
<p>ä¸€è¯´åˆ°ç¼“å­˜ï¼Œæˆ‘ä»¬å¯èƒ½éƒ½ä¼šæƒ³åˆ°<strong>Cashe</strong>ï¼Œè¿™é‡Œæ‘˜è‡ªç™¾åº¦ç™¾ç§‘å¯¹å®ƒçš„è§£é‡Šï¼šå®ƒåŸæœ¬æ˜¯æŒ‡è®¿é—®é€Ÿåº¦æ¯”ä¸€èˆ¬éšæœºå­˜å–å­˜å‚¨å™¨ï¼ˆRAMï¼‰å¿«çš„ä¸€ç§é«˜é€Ÿå­˜å‚¨å™¨ï¼Œé€šå¸¸å®ƒä¸åƒç³»ç»Ÿä¸»å­˜é‚£æ ·ä½¿ç”¨DRAMæŠ€æœ¯ï¼Œè€Œä½¿ç”¨æ˜‚è´µä½†è¾ƒå¿«é€Ÿçš„SRAMæŠ€æœ¯ã€‚ç¼“å­˜çš„è®¾ç½®æ˜¯æ‰€æœ‰ç°ä»£è®¡ç®—æœºç³»ç»Ÿå‘æŒ¥é«˜æ€§èƒ½çš„é‡è¦å› ç´ ä¹‹ä¸€ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯<strong>å½“CPUè¦è¯»å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œé¦–å…ˆä»CPUç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°å°±ç«‹å³è¯»å–å¹¶é€ç»™CPUå¤„ç†ï¼›æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä»é€Ÿç‡ç›¸å¯¹è¾ƒæ…¢çš„å†…å­˜ä¸­è¯»å–å¹¶é€ç»™CPUå¤„ç†ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªæ•°æ®æ‰€åœ¨çš„æ•°æ®å—è°ƒå…¥ç¼“å­˜ä¸­ï¼Œå¯ä»¥ä½¿å¾—ä»¥åå¯¹æ•´å—æ•°æ®çš„è¯»å–éƒ½ä»ç¼“å­˜ä¸­è¿›è¡Œï¼Œä¸å¿…å†è°ƒç”¨å†…å­˜ã€‚</strong></p> 
<p><img src="https://images2.imgbox.com/f6/f4/rccOlWks_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä»¥ä¸Šéƒ¨åˆ†å†…å®¹å¯èƒ½çœ‹ä¸æ‡‚ï¼Œæ²¡å…³ç³»ï¼Œä½ åªéœ€è¦çŸ¥é“æ­£æ˜¯ç”±äºè¿™æ ·çš„è¯»å–æœºåˆ¶ï¼Œä½¿å¾—CPUè¯»å–ç¼“å­˜çš„å‘½ä¸­ç‡éå¸¸é«˜ï¼ˆå¤§å¤šæ•°CPUå¯è¾¾90%å·¦å³ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´CPUä¸‹ä¸€æ¬¡è¦è¯»å–çš„æ•°æ®90%éƒ½åœ¨CPUç¼“å­˜ä¸­ï¼Œåªæœ‰å¤§çº¦10%éœ€è¦ä»å†…å­˜è¯»å–ã€‚<strong>è¿™æ ·å¤§å¤§èŠ‚çœäº†CPUç›´æ¥è¯»å–å†…å­˜çš„æ—¶é—´</strong>ï¼Œéå¸¸å¿«æ·ï¼ï¼ï¼</p> 
<p><img src="https://images2.imgbox.com/e4/fd/G9F8BI2N_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ç®€è€Œè¨€ä¹‹ï¼Œä»¥cpuä¸­çš„ç¼“å­˜ä¸¾ä¾‹ï¼Œ<strong>ç¼“å­˜å…¶å®å°±æ˜¯æ•°æ®äº¤æ¢çš„ç¼“å†²åŒºã€åˆç§°Casheã€‘ï¼Œæ˜¯å­˜è´®æ•°æ®ï¼ˆä½¿ç”¨é¢‘ç¹çš„æ•°æ®ï¼‰çš„ä¸´æ—¶åœ°æ–¹ã€‚å½“ç”¨æˆ·æŸ¥è¯¢æ•°æ®ï¼Œé¦–å…ˆåœ¨ç¼“å­˜ä¸­å¯»æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™ç›´æ¥æ‰§è¡Œã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™å»æ•°æ®åº“ä¸­æŸ¥æ‰¾</strong>ã€‚</p> 
<hr> 
<h2><a id="___26"></a>äºŒ. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å­˜ï¼Ÿ</h2> 
<p>ä¸¾ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼Œå½“æˆ‘ä»¬åœ¨çº¿è§‚çœ‹è§†é¢‘æ—¶ï¼Œä»¥å“”å“©å“”å“©ç½‘ç«™ä¸ºä¾‹ï¼Œä½ ä¼šå‘ç°ï¼Œåº•ä¸‹çš„è¿›åº¦æ¡ä¼šå®æ—¶æ˜¾ç¤ºè“è‰²ï¼Œç™½è‰²ç­‰ä¸¤ç§é¢œè‰²ã€‚ä¸éš¾å‘ç°ï¼Œè“è‰²ä»£è¡¨çš„æ˜¯è§†é¢‘å®é™…æ’­æ”¾çš„è¿›åº¦ï¼Œè€Œç™½è‰²ä»£è¡¨çš„æ˜¯è§†é¢‘å®æ—¶é¢„å…ˆç¼“å­˜çš„è¿›åº¦ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚</p> 
<p><img src="https://images2.imgbox.com/3c/8a/W1ryrJk9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿™ç§<strong>è®©ç”¨æˆ·ä¸€è¾¹ä¸‹è½½ä¸€è¾¹è§‚çœ‹ã€æ”¶å¬ï¼Œè€Œä¸è¦ç­‰æ•´ä¸ªæ–‡ä»¶ä¸‹è½½åˆ°è‡ªå·±çš„è®¡ç®—æœºä¸Šæ‰å¯ä»¥è§‚çœ‹çš„ç½‘ç»œä¼ è¾“æŠ€æœ¯</strong>ï¼Œå°±æ˜¯é¼é¼å¤§åçš„<strong>æµåª’ä½“æŠ€æœ¯</strong>ã€‚è¯¥æŠ€æœ¯çš„åŸç†æ˜¯å…ˆåœ¨ä½¿ç”¨è€…ç«¯çš„è®¡ç®—æœºä¸Šåˆ›å»ºä¸€ä¸ª<strong>ç¼“å†²åŒº</strong>ï¼Œåœ¨æ’­æ”¾å‰é¢„å…ˆä¸‹ä¸€æ®µæ•°æ®ä½œä¸º<strong>ç¼“å†²</strong>ï¼Œåœ¨ç½‘è·¯å®é™…è¿çº¿é€Ÿåº¦å°äºæ’­æ”¾æ‰€è€—çš„é€Ÿåº¦æ—¶ï¼Œæ’­æ”¾ç¨‹åºå°±ä¼šå–ç”¨ä¸€å°æ®µç¼“å†²åŒºå†…çš„æ•°æ®ï¼Œè¿™æ ·å¯ä»¥<strong>é¿å…æ’­æ”¾çš„ä¸­æ–­ï¼Œä¹Ÿä½¿å¾—æ’­æ”¾å“è´¨å¾—ä»¥ä¿è¯</strong>ã€‚è¯¥æŠ€æœ¯åœ¨å¾ˆå¤šéŸ³é¢‘å½±è§†ç½‘ç«™ä¸Šè¢«å¤§é‡ä½¿ç”¨ï¼Œæ—¨åœ¨ä¸°å¯Œç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒå¹¶æé«˜éŸ³é¢‘çš„æ’­æ”¾æ€§èƒ½ã€‚<br> <img src="https://images2.imgbox.com/54/b1/A4dyasQe_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è€Œç¨‹åºä¸­çš„ç¼“å­˜ã€Mybatisç¼“å­˜ã€‘ï¼Œäº¦æ˜¯å¦‚æ­¤ï¼ŒMybatisä½¿ç”¨ç¼“å­˜ä¼˜åŠ¿å¯ä»¥<strong>æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå¹¶é™ä½æœåŠ¡å™¨çš„å‹åŠ›ã€‚<strong>å®ƒçš„æœ¬è´¨å°±æ˜¯ç”¨</strong>åˆ©ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œç‰ºç‰²æ•°æ®çš„å®æ—¶æ€§ï¼Œä»¥æœåŠ¡å™¨å†…å­˜ä¸­çš„æ•°æ®æš‚æ—¶ä»£æ›¿ä»æ•°æ®åº“è¯»å–æœ€æ–°çš„æ•°æ®ï¼Œå‡å°‘æ•°æ®åº“IOï¼Œå‡è½»æœåŠ¡å™¨å‹åŠ›ï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿï¼ŒåŠ å¿«é¡µé¢æ‰“å¼€é€Ÿåº¦ã€‚</strong></p> 
<hr> 
<h2><a id="__Mybatis_38"></a>ä¸‰. Mybatisä¸­çš„ç¼“å­˜åˆ†å“ªå‡ ç§ï¼Ÿ</h2> 
<p>ğŸ‘‰åˆ†ç±»</p> 
<ol><li><strong>ä¸€çº§ç¼“å­˜</strong></li><li><strong>äºŒçº§ç¼“å­˜</strong></li><li><strong>ç¬¬ä¸‰æ–¹ç¼“å­˜</strong></li></ol> 
<p><img src="https://images2.imgbox.com/51/1b/wsBIIK9A_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="31_Mybatis_52"></a>3.1 Mybatisç¼“å­˜æœºåˆ¶ä¹‹ä¸€çº§ç¼“å­˜</h3> 
<p>ğŸ‘‰æ¦‚è¿°</p> 
<blockquote> 
 <p>ä¸€çº§ç¼“å­˜ã€æœ¬åœ°ç¼“å­˜(Local Cache)æˆ–SqlSessionaçº§åˆ«ç¼“å­˜ã€‘</p> 
</blockquote> 
<p>ğŸ¤”ä»€ä¹ˆæ˜¯SqlSessionaï¼Ÿ</p> 
<blockquote> 
 <p>SqlSessionæ˜¯ä¸€ä¸ª<strong>ä¼šè¯</strong>ï¼Œç›¸å½“äºJDBCä¸­çš„ä¸€ä¸ªConnectionå¯¹è±¡ï¼Œæ˜¯æ•´ä¸ªMybatisè¿è¡Œçš„æ ¸å¿ƒï¼Œå®ƒæ˜¯MyBatisçš„å…³é”®å¯¹è±¡ï¼Œæ˜¯æ‰§è¡ŒæŒä¹…åŒ–æ“ä½œçš„ç‹¬äº«ï¼Œç±»ä¼¼äºJDBCä¸­çš„Connectionã€‚å®ƒæ˜¯åº”ç”¨ç¨‹åºä¸æŒä¹…å±‚ä¹‹é—´æ‰§è¡Œäº¤äº’æ“ä½œçš„ä¸€ä¸ªå•çº¿ç¨‹å¯¹è±¡ï¼Œä¹Ÿæ˜¯MyBatisçš„æ ¸å¿ƒæ¥å£ä¹‹ä¸€</p> 
</blockquote> 
<p>ğŸ‘‰ç‰¹ç‚¹</p> 
<ul><li><strong>ä¸€çº§ç¼“å­˜é»˜è®¤å¼€å¯</strong></li><li><strong>ä¸èƒ½å…³é—­</strong></li><li><strong>å¯ä»¥æ¸…ç©º</strong></li></ul> 
<blockquote> 
 <p>ğŸ’¡ ï¼šæœ‰ç‚¹ç±»ä¼¼äºä½¿ç”¨è…¾è®¯è§†é¢‘ç½‘ç«™å»çœ‹ç”µå½±ï¼Œç”µå½±è§‚çœ‹è¿›åº¦æ¡å‰çš„é‚£ä¸€å°æ®µç°è‰²çš„è¿›åº¦æ¡</p> 
</blockquote> 
<p>ğŸ‘‰ç¼“å­˜åŸç†</p> 
<ol><li><strong><code>ç¬¬ä¸€æ¬¡è·å–æ•°æ®æ—¶ï¼Œå…ˆä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ï¼Œå°†æ•°æ®ç¼“å­˜è‡³Mybatisä¸€çº§ç¼“å­˜ä¸­ã€ç¼“å­˜åº•å±‚å®ç°åŸç†Map,key:hashCode+æŸ¥è¯¢çš„Sqlld+ç¼–å†™çš„salæŸ¥è¯¢è¯­å¥+å‚æ•°ã€‘</code></strong></li><li><strong><code>ä»¥åå†æ¬¡è·å–æ•°æ®æ—¶ï¼Œå…ˆä»ä¸€çº§ç¼“å­˜ä¸­è·å–ï¼Œå¦‚æœªè·å–åˆ°æ•°æ®ï¼Œå†ä»æ•°æ®åº“ä¸­è·å–æ•°æ®</code></strong></li></ol> 
<p>ä¸ä¿¡ï¼Ÿè¯·çœ‹å¦‚ä¸‹æµ‹è¯•ä»£ç çš„ä½“ç°</p> 
<p>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"mybatis-config.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡SqlSessionFactoryå¯¹è±¡è°ƒç”¨openSession();</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è·å–EmployeeMapperçš„ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">EmployeeMapper</span> employeeMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ç¬¬äºŒæ¬¡è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees1 <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees1<span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/00/0f/rfgf3OOQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ğŸ‘‰<strong>ä¸€çº§ç¼“å­˜çš„äº”ç§å¤±æ•ˆæƒ…å†µ</strong></p> 
<ol><li> <p><code>ä¸åŒçš„SqlSessionå¯¹åº”ä¸åŒçš„ä¸€çº§ç¼“å­˜</code></p> </li><li> <p><code>åŒä¸€ä¸ªSqlSessionä½†æ˜¯æŸ¥é—´æ¡ä»¶ä¸åŒ</code></p> </li><li> <p><code>åŒä¸€ä¸ªSqlSessionä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰§è¡Œäº†ä»»ä½•ä¸€æ¬¡å¢åˆ æ”¹æ“ä½œ</code></p> <p><strong>æ‰§è¡Œä»»ä½•ä¸€æ¬¡çš„å¢åˆ æ”¹æ“ä½œä¼šé»˜è®¤æ¸…ç©ºä¸€çº§ç¼“å­˜</strong></p> </li><li> <p><code>åŒä¸€ä¸ªSqlSessionä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰‹åŠ¨æ¸…ç©ºäº†ç¼“å­˜</code></p> <p>å¦‚ä½•æ‰‹åŠ¨æ¸…ç©ºä¸€çº§ç¼“å­˜ï¼Ÿ</p> <pre><code class="prism language-java">sqlSession<span class="token punctuation">.</span><span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><code>åŒä¸€ä¸ªSqlSessioniä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æäº¤äº†äº‹åŠ¡</code></p> <pre><code class="prism language-java">sqlSession<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<h3><a id="32_Mybatis_134"></a>3.2 Mybatisç¼“å­˜æœºåˆ¶ä¹‹äºŒçº§ç¼“å­˜</h3> 
<p>ğŸ‘‰æ¦‚è¿°</p> 
<blockquote> 
 <p>äºŒçº§ç¼“å­˜ã€å…¨å±€ä½œç”¨åŸŸç¼“å­˜ã€‘æ˜¯SqlSessionFactoryçº§åˆ«çš„ç¼“å­˜</p> 
</blockquote> 
<p>ğŸ‘‰ç‰¹ç‚¹</p> 
<ul><li> <p><strong>äºŒçº§ç¼“å­˜é»˜è®¤å…³é—­ï¼Œéœ€è¦å¼€å¯æ‰èƒ½ä½¿ç”¨</strong></p> </li><li> <p><strong>äºŒçº§ç¼“å­˜éœ€è¦æäº¤sqlSessionæˆ–å…³é—­sqlSessionlæ—¶ï¼Œæ‰ä¼šç¼“å­˜ã€‚</strong></p> </li></ul> 
<p>ğŸ‘‰äºŒçº§ç¼“å­˜ä½¿ç”¨çš„æ­¥éª¤</p> 
<p>â‘ å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¼€å¯äºŒçº§ç¼“å­˜â€œ&lt;setting name="cacheEnab1ed"value=â€œtrueâ€/&gt;â€</p> 
<p>â‘¡éœ€è¦ä½¿ç”¨äºŒçº§ç¼“å­˜çš„<strong>æ˜ å°„æ–‡ä»¶å¤„</strong>ä½¿ç”¨cacheé…ç½®ç¼“å­˜</p> 
<p>â‘¢æ³¨æ„ï¼šPOJOï¼ˆJava Beanã€javaçš„å®ä½“ç±»ã€‘ï¼‰éœ€è¦å®ç°Serializableæ¥å£</p> 
<p>â‘£å…³é—­sqlSessionæˆ–æäº¤sqlSessionlæ—¶ï¼Œå°†æ•°æ®ç¼“å­˜åˆ°äºŒçº§ç¼“å­˜</p> 
<p>ğŸ‘‰ç”¨æ³•æ¡ˆä¾‹</p> 
<blockquote> 
 <p>æ¼”ç¤ºäºŒçº§ç¼“å­˜çš„æ•ˆæœ</p> 
</blockquote> 
<p>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> 
<p>â‘ å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¼€å¯äºŒçº§ç¼“å­˜</p> 
<p><img src="https://images2.imgbox.com/fd/d6/kkvy432c_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>â‘¡è¿™é‡Œå‡è®¾æ˜ å°„æ–‡ä»¶EmployeeMapper.xmlä½¿ç”¨cacheé…ç½®ç¼“å­˜</p> 
<p><img src="https://images2.imgbox.com/ec/70/rsgU6AM4_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>â‘¢åœ¨æ˜ å°„æ–‡ä»¶EmployeeMapper.xmlå¯¹åº”çš„pojoç±»å®ç°Serializableæ¥å£</p> 
<p><img src="https://images2.imgbox.com/80/1b/EHR7ZZtN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>â‘£æµ‹è¯•</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"mybatis-config.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡SqlSessionFactoryå¯¹è±¡è°ƒç”¨openSession()è·å–sqlSessionå¯¹è±¡;</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡sqlSessionå¯¹è±¡è°ƒç”¨getMapper(EmployeeMapper.class)ä»¥è·å–EmployeeMapperçš„ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">EmployeeMapper</span> employeeMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//å…³é—­sqlsessionï¼Œç›®çš„æ˜¯ä¸ºäº†å°†æ•°æ®åŠ è½½åˆ°äºŒçº§ç¼“å­˜ä¸­</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡æ–°è·å–sqlsessionå¯¹è±¡</span>
        <span class="token class-name">SqlSession</span> sqlSession1 <span class="token operator">=</span>sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä½¿ç”¨sqlsessionå¯¹è±¡è°ƒç”¨etMapper(EmployeeMapper.class)è·å–EmployeeMapperæ¥å£çš„ä»£ç†å¯¹è±¡mapper</span>
        <span class="token class-name">EmployeeMapper</span> mapper <span class="token operator">=</span> sqlSession1<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees1 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees1<span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8d/65/pDMq99xQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>ğŸ‘‰åº•å±‚åŸç†</p> 
<ol><li><strong><code>ç¬¬ä¸€æ¬¡è·å–æ•°æ®æ—¶ï¼Œå…ˆä»æ•°æ®åº“ä¸­è·å–æ•°æ®ï¼Œå°†æ•°æ®ç¼“å­˜è‡³ä¸€çº§ç¼“å­˜ï¼›å½“æäº¤æˆ–å…³é—­SqlSessionlæ—¶ï¼Œå°†æ•°æ®ç¼“å­˜è‡³äºŒçº§ç¼“å­˜</code></strong></li><li><strong><code>ä»¥åå†æ¬¡è·å–æ•°æ®æ—¶ï¼Œå…ˆä»ä¸€çº§ç¼“å­˜ä¸­è·å–æ•°æ®ï¼Œå¦‚æœä¸€çº§ç¼“å­˜æ²¡æœ‰æŒ‡å®šæ•°æ®ï¼Œå†å»äºŒçº§ç¼“å­˜ä¸­è·å–æ•°æ®ã€‚å¦‚æœäºŒçº§ç¼“å­˜ä¹Ÿæ²¡æœ‰æŒ‡å®šæ•°æ®æ—¶ï¼Œéœ€è¦å»æ•°æ®åº“ä¸­è·å–æ•°æ®</code></strong></li></ol> 
<p>ğŸ‘‰äºŒçº§ç¼“å­˜ç›¸å…³å±æ€§ï¼ˆåœ¨è®¾ç½®äº†cashçš„æ˜ å°„æ–‡ä»¶ä¸­è®¾ç½®ä»¥ä¸‹å±æ€§ï¼‰</p> 
<ul><li> <p><code>eviction=â€œFIFO"</code>ï¼š<strong>ç¼“å­˜æ¸…é™¤ã€å›æ”¶ã€‘ç­–ç•¥</strong></p> 
  <ul><li><code>LU-æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„</code>ï¼š<strong>ç§»é™¤æœ€é•¿æ—¶é—´ä¸è¢«ä½¿ç”¨çš„å¯¹è±¡</strong></li><li><code>FFO-å…ˆè¿›å…ˆå‡º</code>ï¼š<strong>æŒ‰å¯¹è±¡è¿›å…¥ç¼“å­˜çš„é¡ºåºæ¥ç§»é™¤å®ƒä»¬</strong></li></ul> </li><li> <p><code>flushlnterval</code>ï¼š<strong>åˆ·æ–°é—´éš”ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤æƒ…å†µæ˜¯ä¸è®¾ç½®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åˆ·æ–°é—´éš”ï¼Œç¼“å­˜ä»…ä»…è°ƒç”¨è¯­å¥æ—¶åˆ·æ–°</strong></p> </li><li> <p><code>size</code>ï¼š<strong>å¼•ç”¨æ•°ç›®ï¼Œæ­£æ•´æ•°ï¼Œä»£è¡¨ç¼“å­˜æœ€å¤šå¯ä»¥å­˜å‚¨å¤šå°‘ä¸ªå¯¹è±¡ï¼Œå¤ªå¤§å®¹æ˜“å¯¼è‡´å†…å­˜ç›Šå‡º</strong></p> </li><li> <p><code>readOnly</code>ï¼š<strong>åªè¯»ï¼Œtrue/false</strong></p> 
  <ul><li><code>true</code>ï¼š<strong>åªè¯»ç¼“å­˜ï¼›ä¼šç»™æ‰€æœ‰è°ƒç”¨è€…è¿”å›ç¼“å­˜å¯¹è±¡çš„ç›¸åŒå®ä¾‹ã€‚å› æ­¤è¿™äº›å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ã€‚è¿™æä¾›äº†å¾ˆé‡è¦çš„æ€§èƒ½ä¼˜åŠ¿</strong></li><li><code>false</code>ï¼š<strong>è¯»å†™ç¼“å­˜ï¼›ä¼šè¿”å›ç¼“å­˜å¯¹è±¡çš„æ‹·è´(é€šè¿‡åºåˆ—åŒ–)ã€‚è¿™ä¼šæ…¢ä¸€äº›ï¼Œä½†æ˜¯å®‰å…¨ï¼Œå› æ­¤é»˜è®¤æ˜¯false</strong></li></ul> </li></ul> 
<p>ğŸ‘‰äºŒçº§ç¼“å­˜çš„å¤±æ•ˆæƒ…å†µ</p> 
<p><strong>â‘ <code>åœ¨ä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´ï¼Œæ‰§è¡Œå¢åˆ æ”¹æ“ä½œï¼Œä¼šåŒæ—¶æ¸…ç©ºä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜</code></strong></p> 
<p><strong>â‘¡<code>sqlSession.clearCache()åªæ˜¯ç”¨æ¥æ¸…é™¤ä¸€çº§ç¼“å­˜</code></strong></p> 
<p>ğŸ¤”æ€è€ƒ</p> 
<blockquote> 
 <p>æ‰§è¡Œä¸¤æ¬¡æŸ¥è¯¢æ“ä½œï¼ˆæŸ¥è¯¢æ¡ä»¶ç›¸åŒä¸”æŸ¥è¯¢è¯­å¥ç›¸åŒï¼‰ï¼Œä¸­é—´ä½¿ç”¨sqlsession.clearCache()ï¼Œç„¶åå…³é—­ç¬¬ä¸€ä¸ªsqlsessionå¯¹è±¡ï¼Œåˆæ–°å»ºä¸€ä¸ªsqlsessionå¯¹è±¡ï¼Œæ‰§è¡Œç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œæ˜¯å¦ä¼šå¯¼è‡´äºŒçº§ç¼“å­˜å¤±æ•ˆï¼Ÿ</p> 
</blockquote> 
<p>æˆ‘çš„æ¨æµ‹ï¼š <strong>ä¼šå¤±æ•ˆ</strong></p> 
<p>æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test05</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"mybatis-config.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡SqlSessionFactoryå¯¹è±¡è°ƒç”¨openSession()è·å–sqlSessionå¯¹è±¡;</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡sqlSessionå¯¹è±¡è°ƒç”¨getMapper(EmployeeMapper.class)ä»¥è·å–EmployeeMapperçš„ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">EmployeeMapper</span> employeeMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//æ¸…ç©ºä¸€çº§ç¼“å­˜</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//éœ€è¦å…ˆå…³é—­sqlsessionå¯¹è±¡ï¼Œä»¥ç¼“å­˜æ•°æ®åˆ°äºŒçº§ç¼“å­˜</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é‡æ–°è·å–sqlsessionå¯¹è±¡</span>
        <span class="token class-name">SqlSession</span> sqlSession1 <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä½¿ç”¨sqlsessionå¯¹è±¡è°ƒç”¨etMapper(EmployeeMapper.class)è·å–EmployeeMapperæ¥å£çš„ä»£ç†å¯¹è±¡mapper</span>
        <span class="token class-name">EmployeeMapper</span> mapper <span class="token operator">=</span> sqlSession1<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">/* //åœ¨ä¸¤ä¸ªæŸ¥è¯¢ä¹‹é—´æ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œç›®çš„æ˜¯ä¸ºäº†æ¸…ç©ºäºŒçº§ç¼“å­˜
        Employee e = new Employee();
        e.setId(1);
        e.setSalary(25000.0);
        mapper.updateEmp(e);*/</span>

        <span class="token comment">//è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees1 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees1<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f7/b0/afzEQ0Ff_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>æ¨æµ‹é”™äº†ï¼ŒäºŒçº§ç¼“å­˜ä»ç„¶å¯ä»¥å‘½ä¸­è¯¥æŸ¥è¯¢ç»“æœ</strong></p> 
<p>â­åŸå› åˆ†æ</p> 
<p>å½“ç¬¬ä¸€æ¬¡æ‰§è¡ŒæŸä¸ª SQL è¯­å¥æ—¶ï¼Œè¯¥ SQL è¯­å¥çš„ç¼“å­˜æ¡ç›®ä¼šè¢«æ·»åŠ åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼›è€Œåœ¨æ¸…ç©ºå½“å‰ SqlSession å¯¹è±¡çš„ä¸€çº§ç¼“å­˜æ—¶ï¼Œå¹¶æ²¡æœ‰æ¸…ç©ºå¯¹åº”çš„ SQL è¯­å¥åœ¨äºŒçº§ç¼“å­˜ä¸­çš„ç¼“å­˜æ¡ç›®ï¼Œå› æ­¤è¯¥ SQL è¯­å¥çš„ç¼“å­˜æ¡ç›®ä»ç„¶å­˜åœ¨äºäºŒçº§ç¼“å­˜ä¸­ï¼Œå³ä½¿è¿™ä¸ªäºŒçº§ç¼“å­˜è¿˜æ²¡æœ‰å’Œæ•°æ®åº“åŒæ­¥ã€‚</p> 
<p>å½“æ–°å»ºå¦ä¸€ä¸ª SqlSession å¯¹è±¡ï¼Œæ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ“ä½œä¸”æŸ¥è¯¢æ¡ä»¶å’Œå‰ä¸€æ¬¡æŸ¥è¯¢æ“ä½œç›¸åŒæ—¶ï¼ŒMyBatis å°†ä¼šå…ˆä»ä¸€çº§ç¼“å­˜ä¸­å°è¯•è·å–æ•°æ®ã€‚ç”±äºå·²ç»æ‰§è¡Œäº† <code>sqlsession.clearCache()</code> æ¸…ç©ºäº†å½“å‰ SqlSession çš„ä¸€çº§ç¼“å­˜ï¼Œå› æ­¤ä¸€çº§ç¼“å­˜ä¼šå‘½ä¸­å¤±è´¥ï¼Œä½†æ˜¯ MyBatis å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–åˆ°ä¹‹å‰æŸ¥è¯¢è¿‡çš„ç»“æœé›†ï¼Œè¿”å›ç»™æˆ‘å½“å‰çš„æŸ¥è¯¢æ“ä½œç»“æœã€‚</p> 
<h3><a id="33_MybatisEhCache_330"></a>3.3 Mybatisä¸­ç¼“å­˜æœºåˆ¶ä¹‹ç¬¬ä¸‰æ–¹ç¼“å­˜ã€ä»¥EhCacheä¸ºä¾‹ã€‘</h3> 
<p>ğŸ‘‰æ¦‚è¿°</p> 
<blockquote> 
 <p>EhCacheã€ç¬¬ä¸‰æ–¹ç¼“å­˜ã€‘æ˜¯ä¸€ä¸ªçº¯avaçš„è¿›ç¨‹å†…ç¼“å­˜æ¡†æ¶</p> 
</blockquote> 
<p>ğŸ‘‰ä½¿ç”¨æ­¥éª¤</p> 
<blockquote> 
 <p>â‘ å¯¼å…¥jaråŒ…</p> 
</blockquote> 
<p>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- å¯¼å…¥ehcacheçš„jaråŒ… --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.caches<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-ehcache<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --&gt;</span>
<span class="token comment">&lt;!-- å¯¼å…¥ä¸€ä¸ªæ—¥å¿—çš„jaråŒ… --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.6.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>â‘¡ç¼–å†™ehcacheçš„é…ç½®æ–‡ä»¶ï¼ˆresourcesç›®å½•ä¸‹ï¼‰ã€ehcache.xmlã€‘</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/15/fa/V1gEZ88M_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ehcache</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>noNamespaceSchemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>../config/ehcache.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- ç£ç›˜ä¿å­˜è·¯å¾„ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>diskStore</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>E:\mybatis\ehcache<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defaultCache</span>
            <span class="token attr-name">maxElementsInMemory</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>512<span class="token punctuation">"</span></span>
            <span class="token attr-name">maxElementsOnDisk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10000000<span class="token punctuation">"</span></span>
            <span class="token attr-name">eternal</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
            <span class="token attr-name">overflowToDisk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
            <span class="token attr-name">timeToIdleSeconds</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span>
            <span class="token attr-name">timeToLiveSeconds</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span>
            <span class="token attr-name">diskExpiryThreadIntervalSeconds</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span>
            <span class="token attr-name">memoryStoreEvictionPolicy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>LRU<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defaultCache</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ehcache</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>â‘¢åŠ è½½ç¬¬ä¸‰æ–¹ç¼“å­˜ã€æ˜ å°„æ–‡ä»¶ã€‘</p> 
</blockquote> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!--  æ­¤å¤„åŠ è½½ç¬¬ä¸‰æ–¹ç¼“å­˜ehcache  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cache</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.mybatis.caches.ehcache.EhcacheCache<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cache</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>â‘£å¼€å§‹ä½¿ç”¨</p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"mybatis-config.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡SqlSessionFactoryå¯¹è±¡è°ƒç”¨openSession()è·å–sqlSessionå¯¹è±¡;</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡sqlSessionå¯¹è±¡è°ƒç”¨getMapper(EmployeeMapper.class)ä»¥è·å–EmployeeMapperçš„ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">EmployeeMapper</span> employeeMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//å…³é—­sqlsessionï¼Œç›®çš„æ˜¯ä¸ºäº†å°†æ•°æ®åŠ è½½åˆ°äºŒçº§ç¼“å­˜ä¸­</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡æ–°è·å–sqlsessionå¯¹è±¡</span>
        <span class="token class-name">SqlSession</span> sqlSession1 <span class="token operator">=</span>sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä½¿ç”¨sqlsessionå¯¹è±¡è°ƒç”¨etMapper(EmployeeMapper.class)è·å–EmployeeMapperæ¥å£çš„ä»£ç†å¯¹è±¡mapper</span>
        <span class="token class-name">EmployeeMapper</span> mapper <span class="token operator">=</span> sqlSession1<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees1 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees1<span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1c/ba/vGKvonfX_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/24/9f/TMMVFLC3_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>â—æ³¨æ„</p> 
<p>â‘ ç¬¬ä¸‰æ–¹ç¼“å­˜ï¼Œ<strong>éœ€è¦å»ºç«‹åœ¨äºŒçº§ç¼“å­˜åŸºç¡€ä¸Š</strong>ã€éœ€è¦å¼€å¯äºŒçº§ç¼“å­˜ï¼Œç¬¬ä¸‰æ–¹ç¼“å­˜æ‰èƒ½ç”Ÿæ•ˆã€‘</p> 
<p>â‘¡å¦‚ä½•è®©ç¬¬ä¸‰æ–¹ç¼“å­˜å¤±æ•ˆï¼Ÿ</p> 
<p><strong>å°†äºŒçº§ç¼“å­˜è®¾ç½®å¤±æ•ˆå³å¯</strong>ã€åœ¨ä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´ï¼Œè¿›è¡Œä¸€æ¬¡å¢åˆ æ”¹æ“ä½œä»¥æ¸…é™¤äºŒçº§ç¼“å­˜ã€‘</p> 
<p>ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> resource <span class="token operator">=</span> <span class="token string">"mybatis-config.xml"</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlSessionFactory</span> sqlSessionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡SqlSessionFactoryå¯¹è±¡è°ƒç”¨openSession()è·å–sqlSessionå¯¹è±¡;</span>
        <span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é€šè¿‡sqlSessionå¯¹è±¡è°ƒç”¨getMapper(EmployeeMapper.class)ä»¥è·å–EmployeeMapperçš„ä»£ç†å¯¹è±¡</span>
        <span class="token class-name">EmployeeMapper</span> employeeMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//å…³é—­sqlsessionï¼Œç›®çš„æ˜¯ä¸ºäº†å°†æ•°æ®åŠ è½½åˆ°äºŒçº§ç¼“å­˜ä¸­</span>
        sqlSession<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"---------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é‡æ–°è·å–sqlsessionå¯¹è±¡</span>
        <span class="token class-name">SqlSession</span> sqlSession1 <span class="token operator">=</span>sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ä½¿ç”¨sqlsessionå¯¹è±¡è°ƒç”¨etMapper(EmployeeMapper.class)è·å–EmployeeMapperæ¥å£çš„ä»£ç†å¯¹è±¡mapper</span>
        <span class="token class-name">EmployeeMapper</span> mapper <span class="token operator">=</span> sqlSession1<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">EmployeeMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//åœ¨ä¸¤ä¸ªæŸ¥è¯¢æ“ä½œä¹‹é—´æ‰§è¡Œä¸€æ¬¡æ›´æ–°æ“ä½œï¼Œç›®çš„æ˜¯ä¸ºäº†æ¸…ç©ºäºŒçº§ç¼“å­˜</span>
        <span class="token class-name">Employee</span> e<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token punctuation">.</span><span class="token function">setSalary</span><span class="token punctuation">(</span><span class="token number">25000.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mapper<span class="token punctuation">.</span><span class="token function">updateEmp</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è°ƒç”¨selectEmpByOneOpr(1);</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> employees1 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectEmpByOneOpr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employees1<span class="token punctuation">)</span><span class="token punctuation">;</span>



    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/0c/7a/CrRfMCCs_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a951fd63cf40c54db444583f83a6b443/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ã€JVMã€‘è¯¦ç»†è§£æjavaåˆ›å»ºå¯¹è±¡çš„å…·ä½“æµç¨‹</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cd639538e4b41d9beaa5f18d3e7fbe13/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">è§£å†³wandb: Network error (ReadTimeout), entering retry loop.</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>