<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>R语言学习9-读取表格数据 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="R语言学习9-读取表格数据" />
<meta property="og:description" content="本次课程，我们学习R中用于读取表格数据的reader包的一些基本功能。
有关readr的详细介绍，可以参考*《Mastering Software Development in R》*的1.3节。
读取 在本课程中，我们将使用美国邮政编码上的一个小型数据集。 该表包含有关美国人口普查局发布的城市邮政编码的百分比的信息。
首先，我们使用library()函数载入readr包。
&gt; library(readr) 我们将读入R的文件为urban.csv.gz。 这是用gzip压缩的，逗号分隔值(csv)文本文件。
urban.csv.gz数据文件所在的目录保存在一个名为datapath的R对象中。
让我们使用file.path()函数构造urban.csv.gz文件的完整路径，并将其存储在名为datafile的对象中。然后使用read_csv()函数读取文件，将结果保存到urban变量。
&gt; datafile &lt;- file.path(datapath, &#39;urban.csv.gz&#39;) &gt; urban &lt;- read_csv(datafile) Parsed with column specification: cols( state = col_character(), zcta5 = col_double(), County = col_character(), PctUrban = col_double(), FIPS = col_character() ) 现在我们可以用head()函数看urban数据的前几列。
&gt; head(urban) # A tibble: 6 x 5 state zcta5 County PctUrban FIPS &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; 1 01 35004 St. Clair AL 64 01115 2 01 35005 Jefferson AL 79." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1946fd3069d3ef658b10fca2f88ffc2e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-28T14:38:54+08:00" />
<meta property="article:modified_time" content="2020-05-28T14:38:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R语言学习9-读取表格数据</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="markdown mb-8" style="font-size: 16px;"> 
 <p>本次课程，我们学习<code>R</code>中用于读取表格数据的<code>reader</code>包的一些基本功能。</p> 
  
 <p>有关<code>readr</code>的详细介绍，可以参考*《Mastering Software Development in R》*的<code>1.3</code>节。</p> 
 <h3 id="读取">读取</h3> 
 <p>在本课程中，我们将使用美国邮政编码上的一个小型数据集。 该表包含有关美国人口普查局发布的城市邮政编码的百分比的信息。</p> 
 <p>首先，我们使用<code>library()</code>函数载入<code>readr</code>包。</p> 
 <pre class="has"><code class="language-r">&gt; library(readr)</code></pre> 
 <p>我们将读入<code>R</code>的文件为<code>urban.csv.gz</code>。 这是用<code>gzip</code>压缩的，逗号分隔值(<code>csv</code>)文本文件。</p> 
 <p><code>urban.csv.gz</code>数据文件所在的目录保存在一个名为<code>datapath</code>的<code>R</code>对象中。<br> 让我们使用<code>file.path()</code>函数构造<code>urban.csv.gz</code>文件的完整路径，并将其存储在名为<code>datafile</code>的对象中。然后使用<code>read_csv()</code>函数读取文件，将结果保存到<code>urban</code>变量。</p> 
 <pre class="has"><code class="language-r">&gt; datafile &lt;- file.path(datapath, 'urban.csv.gz')
&gt; urban &lt;- read_csv(datafile)
Parsed with column specification:
cols(
  state = col_character(),
  zcta5 = col_double(),
  County = col_character(),
  PctUrban = col_double(),
  FIPS = col_character()
)</code></pre> 
 <p>现在我们可以用<code>head()</code>函数看<code>urban</code>数据的前几列。</p> 
 <pre class="has"><code class="language-r">&gt; head(urban)
# A tibble: 6 x 5
  state zcta5 County        PctUrban FIPS 
  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;
1 01    35004 St. Clair AL      64   01115
2 01    35005 Jefferson AL      79.8 01073
3 01    35006 Jefferson AL       0   01073
4 01    35007 Shelby AL         90.5 01117
5 01    35010 Tallapoosa AL     45.2 01123
6 01    35013 Blount AL        100   01009</code></pre> 
 <p>可以看到结果有<code>5</code>列--<code>state, zcta5, country, PctUrban, FIPS</code>，并在每列列名的下方标识了数据类型。<code>state, Country, FIPS</code>是<code>chr</code>类型型，而<code>zcta5， PctUrban</code>是<code>dbl</code>类型。</p> 
 <p>对于第二列<code>zcta5</code>，现在是数字类型。如果我们想要将其变成字符型<code>chr</code>，应该怎么做呢？<br> 其实可以在读取的时候，就指定各列的数据类型。实现这个功能，用到的是<code>read_csv()</code>函数的<code>col_types</code>参数。具体可以查看<code>read_csv()</code>的帮助文档，关于<code>col_types</code>的解释是这样的</p> 
 <blockquote> 
  <p>One of NULL, a cols() specification, or a string. See vignette("readr") for more details.</p> 
 </blockquote> 
 <blockquote> 
  <p>If NULL, all column types will be imputed from the first 1000 rows on the input. This is convenient (and fast), but not robust. If the imputation fails, you'll need to supply the correct types yourself.</p> 
 </blockquote> 
 <blockquote> 
  <p>If a column specification created by cols(), it must contain one column specification for each column. If you only want to read a subset of the columns, use cols_only().</p> 
 </blockquote> 
 <blockquote> 
  <p>Alternatively, you can use a compact string representation where each character represents one column: c = character, i = integer, n = number, d = double, l = logical, f = factor, D = date, T = date time, t = time, ? = guess, or _/- to skip the column.</p> 
 </blockquote> 
 <p>简单来说，就是我们可以通过一串各种数据类型的简写字母组成的字符串，指定数据中各列的数据类型，甚至还可以跳过不读取某些列。</p> 
 <p>所以修改第二列的数据类型，可以这样写：</p> 
 <pre class="has"><code class="language-r">&gt; urban &lt;- read_csv(datafile, col_types = 'cccdc')</code></pre> 
 <p>如果不想读取最后一列：</p> 
 <pre class="has"><code class="language-r">&gt; urban &lt;- read_csv(datafile, col_types = 'cccd-')
&gt; head(urban)
# A tibble: 6 x 4
  state zcta5 County        PctUrban
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;
1 01    35004 St. Clair AL      64  
2 01    35005 Jefferson AL      79.8
3 01    35006 Jefferson AL       0  
4 01    35007 Shelby AL         90.5
5 01    35010 Tallapoosa AL     45.2
6 01    35013 Blount AL        100</code></pre> 
 <p>有时候我们不想读取全部的数据，比如只想读取前<code>100</code>行数据，应该怎么做？<br> 还是通过<code>read_csv()</code>函数的帮助文档，里面有一个<code>n_max</code>参数，可以指定读取前面多少列。</p> 
 <blockquote> 
  <p>n_max Maximum number of records to read.</p> 
 </blockquote> 
 <p>所以，代码如下：</p> 
 <pre class="has"><code class="language-r">&gt; urban &lt;- read_csv(datafile, col_types = 'cccd-', n_max = 100)</code></pre> 
 <h3 id="小结">小结</h3> 
 <h3 id="小结-2">小结</h3> 
 <p>展示了<code>read_csv()</code>的<code>2</code>个参数：</p> 
 <ul><li>col_types：指定各列的数据类型，也可以用来不读取指定列</li><li>n_max：读取指定行数</li></ul> 
 <hr> 
 <p><strong>本文首发于公众号：柠檬培养师（ID: yantinger90），欢迎关注！</strong></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c949e93526bbc4addc6279cda1f67490/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于AUC一些笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c8249e68de6e9c8c32ad6fc3168978d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Delaunay三角剖分算法初探</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>