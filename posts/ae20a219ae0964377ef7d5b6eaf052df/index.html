<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【嵌入式——QT】QT静态编译 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【嵌入式——QT】QT静态编译" />
<meta property="og:description" content="【嵌入式——QT】QT静态编译 QT下载查看文档下载Visual Studio打开命令行模式编译添加QT到Qt Creator编译示例 QT下载 下载地址
进入目录，我这里选择的qt-everywhere-src-5.14.1.zip。
查看文档 解压压缩包打开源码，查看README文件，里面有windows的要求。
我们要选择一个编译环境 MinGW 和 MSVC，这两个环境是不兼容的，要看一下你当前支持的编译器是什么。
下载Visual Studio 我们下载自己所需要的Visual Studio来作为编译器，我这里选择的版本是2019版本，同时也是QT所支持的版本。
Visual Studio下载地址
按照步骤安装即可，选择社区版。
打开命令行模式 打开安装Visual Studio自带的 x86 Native Tools Command Prompt for VS 2019 或者 x64 Native Tools Command Prompt for VS 2019 看个人需求。我这里选择的是x86的。如果不知道怎么查找的话，可以直接按win按键，搜索native就会给你提示出来两个版本的工具。
编译 进入刚刚解压好的QT源码目录，D:\Qt\qt-everywhere-src-5.14.1\qtbase\mkspecs\common
打开msvc-desktop.conf文件，修改==-MD为-MT==。
修改前
QMAKE_CFLAGS_RELEASE = $$QMAKE_CFLAGS_OPTIMIZE -MD QMAKE_CFLAGS_RELEASE_WITH_DEBUGINFO &#43;= $$QMAKE_CFLAGS_OPTIMIZE -Zi -MD QMAKE_CFLAGS_DEBUG = -Zi -MDd 修改后
QMAKE_CFLAGS_RELEASE = $$QMAKE_CFLAGS_OPTIMIZE -MT QMAKE_CFLAGS_RELEASE_WITH_DEBUGINFO &#43;= $$QMAKE_CFLAGS_OPTIMIZE -Zi -MT QMAKE_CFLAGS_DEBUG = -Zi -MTd 提示：D的意思是动态编译(dynamic link)，T的意思是静态编译（static link）；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ae20a219ae0964377ef7d5b6eaf052df/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-13T10:58:00+08:00" />
<meta property="article:modified_time" content="2024-01-13T10:58:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【嵌入式——QT】QT静态编译</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>【嵌入式——QT】QT静态编译</h4> 
 <ul><li><a href="#QT_1" rel="nofollow">QT下载</a></li><li><a href="#_6" rel="nofollow">查看文档</a></li><li><a href="#Visual_Studio_10" rel="nofollow">下载Visual Studio</a></li><li><a href="#_14" rel="nofollow">打开命令行模式</a></li><li><a href="#_17" rel="nofollow">编译</a></li><li><a href="#QTQt_Creator_74" rel="nofollow">添加QT到Qt Creator</a></li><li><a href="#_83" rel="nofollow">编译示例</a></li></ul> 
</div> 
<p></p> 
<h2><a id="QT_1"></a>QT下载</h2> 
<p><a href="https://download.qt.io/archive/" rel="nofollow">下载地址</a><br> <img src="https://images2.imgbox.com/7a/1a/8HyWJGeS_o.png" alt="在这里插入图片描述"><br> 进入目录，我这里选择的qt-everywhere-src-5.14.1.zip。<br> <img src="https://images2.imgbox.com/02/55/hLM1X2h9_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_6"></a>查看文档</h2> 
<p>解压压缩包打开源码，查看README文件，里面有windows的要求。<br> <img src="https://images2.imgbox.com/62/ac/fqJatpPY_o.png" alt="在这里插入图片描述"><br> 我们要选择一个编译环境 MinGW 和 MSVC，这两个环境是不兼容的，要看一下你当前支持的编译器是什么。</p> 
<h2><a id="Visual_Studio_10"></a>下载Visual Studio</h2> 
<p>我们下载自己所需要的Visual Studio来作为编译器，我这里选择的版本是2019版本，同时也是QT所支持的版本。<br> <a href="https://visualstudio.microsoft.com/zh-hans/vs/older-downloads/" rel="nofollow">Visual Studio下载地址</a><br> 按照步骤安装即可，选择社区版。</p> 
<h2><a id="_14"></a>打开命令行模式</h2> 
<p>打开安装Visual Studio自带的 x86 Native Tools Command Prompt for VS 2019 或者 x64 Native Tools Command Prompt for VS 2019 看个人需求。我这里选择的是x86的。如果不知道怎么查找的话，可以直接按win按键，搜索native就会给你提示出来两个版本的工具。<br> <img src="https://images2.imgbox.com/5b/54/uKoL94wg_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_17"></a>编译</h2> 
<p>进入刚刚解压好的QT源码目录，D:\Qt\qt-everywhere-src-5.14.1\qtbase\mkspecs\common<br> 打开msvc-desktop.conf文件，修改==-MD<mark>为</mark>-MT==。<br> <strong>修改前</strong></p> 
<pre><code class="prism language-cpp">QMAKE_CFLAGS_RELEASE    <span class="token operator">=</span> $$QMAKE_CFLAGS_OPTIMIZE <span class="token operator">-</span>MD
QMAKE_CFLAGS_RELEASE_WITH_DEBUGINFO <span class="token operator">+=</span> $$QMAKE_CFLAGS_OPTIMIZE <span class="token operator">-</span>Zi <span class="token operator">-</span>MD
QMAKE_CFLAGS_DEBUG      <span class="token operator">=</span> <span class="token operator">-</span>Zi <span class="token operator">-</span>MDd
</code></pre> 
<p><strong>修改后</strong></p> 
<pre><code class="prism language-cpp">QMAKE_CFLAGS_RELEASE    <span class="token operator">=</span> $$QMAKE_CFLAGS_OPTIMIZE <span class="token operator">-</span>MT
QMAKE_CFLAGS_RELEASE_WITH_DEBUGINFO <span class="token operator">+=</span> $$QMAKE_CFLAGS_OPTIMIZE <span class="token operator">-</span>Zi <span class="token operator">-</span>MT
QMAKE_CFLAGS_DEBUG      <span class="token operator">=</span> <span class="token operator">-</span>Zi <span class="token operator">-</span>MTd
</code></pre> 
<p>提示：D的意思是动态编译(dynamic link)，T的意思是静态编译（static link）；</p> 
<p><strong>配置configure命令</strong></p> 
<pre><code class="prism language-cpp">configure<span class="token punctuation">.</span>bat <span class="token operator">-</span><span class="token keyword">static</span> <span class="token operator">-</span>prefix <span class="token string">"D:\Qt\test"</span> <span class="token operator">-</span>confirm<span class="token operator">-</span>license <span class="token operator">-</span>opensource  <span class="token operator">-</span>debug<span class="token operator">-</span><span class="token operator">and</span><span class="token operator">-</span>release <span class="token operator">-</span>platform win32<span class="token operator">-</span>msvc  <span class="token operator">-</span>nomake examples <span class="token operator">-</span>nomake tests  <span class="token operator">-</span>plugin<span class="token operator">-</span>sql<span class="token operator">-</span>sqlite <span class="token operator">-</span>plugin<span class="token operator">-</span>sql<span class="token operator">-</span>odbc <span class="token operator">-</span>qt<span class="token operator">-</span>zlib <span class="token operator">-</span>qt<span class="token operator">-</span>libpng <span class="token operator">-</span>qt<span class="token operator">-</span>libjpeg <span class="token operator">-</span>opengl desktop <span class="token operator">-</span>mp
</code></pre> 
<p>具体参数含义：</p> 
<ol><li>-prefix “D:\Qt\test” #指明安装的目录</li><li>-confirm-license -opensource #指明是开源版本的qt</li><li>-debug-and-release #指明需要debug版和release版，可以单独选择release版</li><li>-platform win32-msvc #指明使用msvc编译，这里的win32并不指32位</li><li>-nomake examples -nomake tests #不编译样例</li><li>-plugin-sql-sqlite -plugin-sql-odbc -qt-zlib -qt-libpng -qt-libjpeg #可选插件</li><li>-opengl desktop #用系统自带的opengl</li><li>-mp #多核编译</li></ol> 
<p>在我们上面打开的x86 Native Tools Command Prompt for VS 2019窗口中进入到QT解压后所在的目录，执行configure命令。</p> 
<p><img src="https://images2.imgbox.com/9f/09/kOePvLnU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dd/78/SIfvHLZ7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4b/4a/9d2lnIO3_o.png" alt="在这里插入图片描述"><br> 我们这里使用的环境是MSVC，所以使用nmake命令进行编译即可,上图中也提示你了，Just run nmake。</p> 
<p><img src="https://images2.imgbox.com/8d/e0/gjZTIUCx_o.png" alt="在这里插入图片描述"><br> 我的电脑配置一般，执行了大概4个小时。特别占用CPU，建议在电脑闲时来操作。<br> 执行完之后，我们再来执行最后一条命令 nmake install。</p> 
<p><img src="https://images2.imgbox.com/9c/1f/SoBZeTFC_o.png" alt="在这里插入图片描述"><br> 这个QT文件夹大概3.4G。</p> 
<p>打开安装完成的qt目录，进入bin修改qt.conf文件<br> D:\Qt\Qt5.14.1\msvc2019_32\bin<br> <img src="https://images2.imgbox.com/4d/29/QnVU2Zng_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp">QMAKE_MSC_VER <span class="token operator">=</span> <span class="token number">1900</span>
<span class="token punctuation">[</span>Paths<span class="token punctuation">]</span>
Prefix<span class="token operator">=</span>D<span class="token operator">:</span><span class="token operator">/</span>Qt<span class="token operator">/</span>Qt5<span class="token punctuation">.</span><span class="token number">14.1</span><span class="token operator">/</span>msvc2019_32 
</code></pre> 
<h2><a id="QTQt_Creator_74"></a>添加QT到Qt Creator</h2> 
<p><a href="https://download.qt.io/archive/online_installers/3.2/" rel="nofollow">QT Creator下载地址</a><br> 打开Qt Creator -》项目-》管理构建套件-》Qt版本 ，如果 Visual Studio安装正确，Qt Creator安装的时候需要选择支持MSVC2019，这个QT版本里会自动检测到MSVC2019版本的。<br> <img src="https://images2.imgbox.com/c9/59/omulBtlH_o.png" alt="在这里插入图片描述"><br> 然后我们选择构建套件页签，添加一个构建套件<br> <img src="https://images2.imgbox.com/2f/c7/OJ0BE1Vo_o.png" alt="在这里插入图片描述"><br> Qt版本选择上面你的qt版本。这个qt版本是你 Creator需要支持的才可以。<br> <img src="https://images2.imgbox.com/b8/2b/OxeZZohD_o.png" alt="在这里插入图片描述"><br> 综上所述就可以开始写qt程序的，然后使用这个编译器来进行静态的编译吧。</p> 
<h2><a id="_83"></a>编译示例</h2> 
<p>QT Creator编辑栏中的左下角可以看到以下按钮，选择你想要编译的模式，Debug、Profile、Release。第一个绿色按钮是直接运行，第二个绿色的按钮是debug模式运行。<br> <img src="https://images2.imgbox.com/3d/e2/A2EAJHx7_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1bf93af846937e45cfe96cd143d5920c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RSIC-V“一芯”学习笔记（二）——Linux入门教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/786f78299792189bbdefbe865b1cb03a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C#执行数据加密的DES.Create 方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>