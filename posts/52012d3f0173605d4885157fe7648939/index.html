<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>（二）QT5.14.2连接MySQL并使用QtableView显示数据表内容 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="（二）QT5.14.2连接MySQL并使用QtableView显示数据表内容" />
<meta property="og:description" content="系列文章目录 第一章：（一）QT5.14.2&#43;MSVC2017(32位/64位)&#43;MySQL连接
第二章：（二）QT5.14.2连接MySQL并使用QtableView显示数据表内容
文章目录 系列文章目录前言一、使用QSqlDatabase连接MySQL/基本命令二、QTableView显示数据表内容三、示例完整代码展示总结 前言 本文主要讲述了Qt下MySQL数据库的连接及对MySQL数据库进行操作的基本命令，并使用QTableView控件结合QSqlTableModel显示相应数据表的内容，这里写了一个比较简单的示例进行讲解，以便大家学习，如有错误之处，欢迎大家批评指正。
项目效果
提示：以下是本篇文章正文内容，下面案例可供参考
一、使用QSqlDatabase连接MySQL/基本命令 1.定义一个QSqlDatabase对象，设置好连接需要的各个属性（使用命令：mysql -P3307 -h127.0.0.1 -uroot -p123456;）
QSqlDatabase myDb; myDb = QSqlDatabase::addDatabase(&#34;QMYSQL&#34;); myDb.setHostName(&#34;localhost&#34;); //本地127.0.0.1 myDb.setPort(3307); //默认为3306，不需要这一句,我是指定连接 myDb.setDatabaseName(&#34;mytestdb&#34;); //设置数据库名，需要一个已经存在的数据库 myDb.setUserName(&#34;root&#34;); myDb.setPassword(&#34;123456&#34;); if(!myDb.open()) { QMessageBox::warning(this,&#34;Warning&#34;,QString(&#34;Unable to open database!&#34;)); return; } else { qDebug()&lt;&lt;&#34;Connecting to the database successfully!&#34;; ui-&gt;te_output-&gt;appendPlainText(&#34;Connecting to the database successfully!&#34;); } 2.使用QSqlQuery对象来执行SQL语句，显示所有数据库（使用命令：show databases;）
QSqlQuery query(myDb); query.exec(&#34;show databases;&#34;); 3.显示当前数据库（使用命令：select database();）
QSqlQuery query(myDb); query.exec(&#34;select database();&#34;); 4.打开数据库（使用命令：use mytestdb;）
QSqlQuery query(myDb); query.exec(&#34;use mytestdb;&#34;); 5.显示当前数据库中的数据表（使用命令：show tables;）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/52012d3f0173605d4885157fe7648939/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-12T10:19:49+08:00" />
<meta property="article:modified_time" content="2023-03-12T10:19:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">（二）QT5.14.2连接MySQL并使用QtableView显示数据表内容</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>系列文章目录</h2> 
<p>第一章：<a href="https://blog.csdn.net/XCJandLL/article/details/125299470">（一）QT5.14.2+MSVC2017(32位/64位)+MySQL连接</a><br> 第二章：<a href="https://blog.csdn.net/XCJandLL/article/details/125575405">（二）QT5.14.2连接MySQL并使用QtableView显示数据表内容</a></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">系列文章目录</a></li><li><a href="#_10" rel="nofollow">前言</a></li><li><a href="#QSqlDatabaseMySQL_20" rel="nofollow">一、使用QSqlDatabase连接MySQL/基本命令</a></li><li><a href="#QTableView_70" rel="nofollow">二、QTableView显示数据表内容</a></li><li><a href="#_83" rel="nofollow">三、示例完整代码展示</a></li><li><a href="#_378" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_10"></a>前言</h2> 
<p>本文主要讲述了Qt下MySQL数据库的连接及对MySQL数据库进行操作的基本命令，并使用QTableView控件结合QSqlTableModel显示相应数据表的内容，这里写了一个比较简单的示例进行讲解，以便大家学习，如有错误之处，欢迎大家批评指正。</p> 
<p><strong>项目效果</strong></p> 
<p><img src="https://images2.imgbox.com/8a/d1/eDcEHHFz_o.gif" alt="请添加图片描述"></p> 
<hr> 
<p><code>提示：以下是本篇文章正文内容，下面案例可供参考</code></p> 
<h2><a id="QSqlDatabaseMySQL_20"></a>一、使用QSqlDatabase连接MySQL/基本命令</h2> 
<p>1.定义一个QSqlDatabase对象，设置好连接需要的各个属性（使用命令：mysql -P3307 -h127.0.0.1 -uroot -p123456;）</p> 
<pre><code class="prism language-c">QSqlDatabase myDb<span class="token punctuation">;</span>
myDb <span class="token operator">=</span> QSqlDatabase<span class="token operator">::</span><span class="token function">addDatabase</span><span class="token punctuation">(</span><span class="token string">"QMYSQL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myDb<span class="token punctuation">.</span><span class="token function">setHostName</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//本地127.0.0.1</span>
myDb<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">3307</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//默认为3306，不需要这一句,我是指定连接</span>
myDb<span class="token punctuation">.</span><span class="token function">setDatabaseName</span><span class="token punctuation">(</span><span class="token string">"mytestdb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//设置数据库名，需要一个已经存在的数据库</span>
myDb<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myDb<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>myDb<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QMessageBox<span class="token operator">::</span><span class="token function">warning</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span><span class="token string">"Warning"</span><span class="token punctuation">,</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"Unable to open database!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Connecting to the database successfully!"</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"Connecting to the database successfully!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>2.使用QSqlQuery对象来执行SQL语句，显示所有数据库（使用命令：show databases;）</p> 
<pre><code class="prism language-c">QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"show databases;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>3.显示当前数据库（使用命令：select database();）</p> 
<pre><code class="prism language-c">QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select database();"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>4.打开数据库（使用命令：use mytestdb;）</p> 
<pre><code class="prism language-c">QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"use mytestdb;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>5.显示当前数据库中的数据表（使用命令：show tables;）</p> 
<pre><code class="prism language-c">QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"show tables;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>6.显示数据表内容（使用命令：select *from mytable;）</p> 
<p>7.条件查询mytable表中id为1-3的内容（使用命令：select *from mytable where id&gt;=1 and id&lt;=3;）</p> 
<h2><a id="QTableView_70"></a>二、QTableView显示数据表内容</h2> 
<p>定义一个QSqlTableModel模型绑定数据表，并使用setModel将这个模型绑定到指定的QTableView控件，下列代码会直接在tableView中显示数据表的全部内容</p> 
<pre><code class="prism language-c">QSqlTableModel <span class="token operator">*</span>myModel<span class="token punctuation">;</span>
myModel <span class="token operator">=</span> new <span class="token function">QSqlTableModel</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
myModel<span class="token operator">-&gt;</span><span class="token function">setTable</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myModel<span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myModel<span class="token operator">-&gt;</span><span class="token function">setEditStrategy</span><span class="token punctuation">(</span>QSqlTableModel<span class="token operator">::</span>OnManualSubmit<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//设置编辑策略为手动提交</span>
ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setModel</span><span class="token punctuation">(</span>myModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setModel</span><span class="token punctuation">(</span>myModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token operator">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//自动列宽</span>
</code></pre> 
<h2><a id="_83"></a>三、示例完整代码展示</h2> 
<p>1.main.cpp</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"widget.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QApplication&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QStyleFactory&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QApplication <span class="token function">a</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    a<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>QStyleFactory<span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"fusion"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//影响界面表格样式</span>
    Widget w<span class="token punctuation">;</span>
    w<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>2.widget.h</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">WIDGET_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WIDGET_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QWidget&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMessageBox&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlDatabase&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlTableModel&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlError&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlQuery&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QToolTip&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDebug&gt;</span></span>

QT_BEGIN_NAMESPACE
namespace Ui <span class="token punctuation">{<!-- --></span> class Widget<span class="token punctuation">;</span> <span class="token punctuation">}</span>
QT_END_NAMESPACE

class Widget <span class="token operator">:</span> public QWidget
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT

public<span class="token operator">:</span>
    <span class="token function">Widget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> nullptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Widget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">InitWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">setPlainText</span><span class="token punctuation">(</span>QString text<span class="token punctuation">)</span><span class="token punctuation">;</span>

private slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">doMouseTrackTip</span><span class="token punctuation">(</span>QModelIndex index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_connect_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_showAllDb_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_showCurDb_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_openDb_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_showTable_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_setTable_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_showTableData_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_commit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_repeal_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_record_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_remove_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_inquire_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_display_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

private<span class="token operator">:</span>
    Ui<span class="token operator">::</span>Widget <span class="token operator">*</span>ui<span class="token punctuation">;</span>

    QSqlDatabase myDb<span class="token punctuation">;</span>
    QSqlTableModel <span class="token operator">*</span>myModel<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// WIDGET_H</span></span>
</code></pre> 
<p>3.widget.cpp</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"widget.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_widget.h"</span></span>

Widget<span class="token operator">::</span><span class="token function">Widget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span>new Ui<span class="token operator">::</span>Widget<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">InitWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Widget<span class="token operator">::</span><span class="token operator">~</span><span class="token function">Widget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    delete ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">InitWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//查看数据库驱动</span>
    <span class="token comment">//QStringList drivers = QSqlDatabase::drivers();</span>
    <span class="token comment">//qDebug()&lt;&lt;drivers;</span>

    myDb <span class="token operator">=</span> QSqlDatabase<span class="token operator">::</span><span class="token function">addDatabase</span><span class="token punctuation">(</span><span class="token string">"QMYSQL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel <span class="token operator">=</span> new <span class="token function">QSqlTableModel</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">setPlainText</span><span class="token punctuation">(</span>QString text<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>te_input<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>te_input<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">doMouseTrackTip</span><span class="token punctuation">(</span>QModelIndex index<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QToolTip<span class="token operator">::</span><span class="token function">showText</span><span class="token punctuation">(</span>QCursor<span class="token operator">::</span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_connect_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString str <span class="token operator">=</span> <span class="token string">"mysql -P3307 -h127.0.0.1 -uroot -p123456;"</span><span class="token punctuation">;</span>
    <span class="token function">setPlainText</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    myDb<span class="token punctuation">.</span><span class="token function">setHostName</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//本地127.0.0.1</span>
    myDb<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">3307</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//默认为3306，不需要这一句,我是指定连接</span>
    myDb<span class="token punctuation">.</span><span class="token function">setDatabaseName</span><span class="token punctuation">(</span><span class="token string">"mytestdb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//设置数据库名，需要一个已经存在的数据库</span>
    myDb<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myDb<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>myDb<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QMessageBox<span class="token operator">::</span><span class="token function">warning</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span><span class="token string">"Warning"</span><span class="token punctuation">,</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"Unable to open database!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"Connecting to the database successfully!"</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span><span class="token string">"Connecting to the database successfully!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//QSqlQuery query(myDb);</span>
    <span class="token comment">//query.exec("create database if not exists database_name;");   //创建数据库</span>
    <span class="token comment">//query.exec("drop database if exists database_name;");         //删除数据库</span>
    <span class="token comment">//query.exec("drop table if exists table_name");                //删除数据表</span>
    <span class="token comment">//创建数据表</span>
    <span class="token comment">//query.exec("create table if not exists mytable (id int primary key,name varchar(20),teacher varchar(20))");</span>
    <span class="token comment">//query.exec("insert into mytable values(1,'数学','王老师');");   //插入数据</span>
    <span class="token comment">//query.exec("insert into mytable values(2,'语文','徐老师');");</span>
    <span class="token comment">//query.exec("insert into mytable values(3,'英语','刘老师');");</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_showAllDb_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">setPlainText</span><span class="token punctuation">(</span><span class="token string">"show databases;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"show databases;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>cb_db<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"database name:"</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>cb_db<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_showCurDb_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">setPlainText</span><span class="token punctuation">(</span><span class="token string">"select database();"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select database();"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"database():"</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>lb_curDb<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_openDb_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString useStr <span class="token operator">=</span> <span class="token string">"use "</span> <span class="token operator">+</span> ui<span class="token operator">-&gt;</span>cb_db<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">;</span>
    <span class="token function">setPlainText</span><span class="token punctuation">(</span>useStr <span class="token operator">+</span> <span class="token string">"\nselect database();"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>useStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select database();"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"database2():"</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>lb_curDb<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_showTable_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">setPlainText</span><span class="token punctuation">(</span><span class="token string">"show tables;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>myDb<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"show tables;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>cb_table<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"table name:"</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>te_output<span class="token operator">-&gt;</span><span class="token function">appendPlainText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ui<span class="token operator">-&gt;</span>cb_table<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_setTable_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>cb_table<span class="token operator">-&gt;</span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_showTableData_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QMessageBox<span class="token operator">::</span><span class="token function">warning</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span><span class="token string">"错误"</span><span class="token punctuation">,</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"当前数据表不能为空,请进行选择!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    QString selectStr <span class="token operator">=</span> <span class="token string">"select *from "</span> <span class="token operator">+</span> ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">;</span>
    <span class="token function">setPlainText</span><span class="token punctuation">(</span>selectStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">setTable</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">setEditStrategy</span><span class="token punctuation">(</span>QSqlTableModel<span class="token operator">::</span>OnManualSubmit<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//设置编辑策略为手动提交</span>
    ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setModel</span><span class="token punctuation">(</span>myModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token operator">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//自动列宽</span>
    ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">setMouseTracking</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置鼠标追踪,用来显示表格上标签值</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>tableView<span class="token punctuation">,</span> <span class="token operator">&amp;</span>QTableView<span class="token operator">::</span>entered<span class="token punctuation">,</span> this<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Widget<span class="token operator">::</span>doMouseTrackTip<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_commit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//开始事务操作</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>myModel<span class="token operator">-&gt;</span><span class="token function">submitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        myModel<span class="token operator">-&gt;</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//提交</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        myModel<span class="token operator">-&gt;</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//回滚</span>
        QMessageBox<span class="token operator">::</span><span class="token function">warning</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span><span class="token string">"tableModel"</span><span class="token punctuation">,</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"数据库错误:%1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>myModel<span class="token operator">-&gt;</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_repeal_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    myModel<span class="token operator">-&gt;</span><span class="token function">revertAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_record_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> rowNum <span class="token operator">=</span> myModel<span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">insertRow</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">setData</span><span class="token punctuation">(</span>myModel<span class="token operator">-&gt;</span><span class="token function">index</span><span class="token punctuation">(</span>rowNum<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rowNum<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_remove_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> curRow <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>tableView<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">row</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">removeRow</span><span class="token punctuation">(</span>curRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ok <span class="token operator">=</span> QMessageBox<span class="token operator">::</span><span class="token function">warning</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span><span class="token string">"删除当前行！"</span><span class="token punctuation">,</span><span class="token string">"你确定删除当前行吗？"</span><span class="token punctuation">,</span>
                                  QMessageBox<span class="token operator">::</span>Yes<span class="token punctuation">,</span>QMessageBox<span class="token operator">::</span>No<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ok <span class="token operator">==</span> QMessageBox<span class="token operator">::</span>No<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        myModel<span class="token operator">-&gt;</span><span class="token function">revertAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        myModel<span class="token operator">-&gt;</span><span class="token function">submitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_inquire_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString idStart <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_idStart<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString idEnd <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_idEnd<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QString whereStr <span class="token operator">=</span> <span class="token string">"id&gt;="</span> <span class="token operator">+</span> idStart <span class="token operator">+</span> <span class="token string">" and id&lt;="</span> <span class="token operator">+</span> idEnd <span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>idStart<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> idEnd<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">setPlainText</span><span class="token punctuation">(</span><span class="token string">"select *from "</span> <span class="token operator">+</span> ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" where "</span> <span class="token operator">+</span> whereStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        myModel<span class="token operator">-&gt;</span><span class="token function">setFilter</span><span class="token punctuation">(</span>whereStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        myModel<span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        QMessageBox<span class="token operator">::</span><span class="token function">warning</span><span class="token punctuation">(</span>this<span class="token punctuation">,</span><span class="token string">"Warning"</span><span class="token punctuation">,</span><span class="token string">"id范围不能为空!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">on_pb_display_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    myModel<span class="token operator">-&gt;</span><span class="token function">setTable</span><span class="token punctuation">(</span>ui<span class="token operator">-&gt;</span>lb_curTable<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myModel<span class="token operator">-&gt;</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4.widget.ui<br> <img src="https://images2.imgbox.com/69/92/poBt5l5x_o.png" alt="请添加图片描述"></p> 
<hr> 
<h2><a id="_378"></a>总结</h2> 
<p>本文讲述了在Qt中连接MySQL数据库以及SQL的一些基本操作命令，并使用了QSqlTableModel模型来绑定数据表数据源，并用QTableView控件来绑定这个模型并将内容显示出来。这里也只是很基础的介绍了这些命令及用法，需要我们学习的还有更多。</p> 
<p>上文中该句代码(QStringList drivers = QSqlDatabase::drivers();)可以查看当前Qt存在哪些数据库驱动，我的输出是(“QSQLITE”, “QMYSQL”, “QMYSQL3”, “QODBC”, “QODBC3”, “QPSQL”, “QPSQL7”)，其中包含QMYSQL才可以进行MySQL数据库的连接，如果你当前的Qt没有QMySQL驱动，可以查看上一篇文章来进行驱动的安装：<a href="https://blog.csdn.net/XCJandLL/article/details/125299470">QT5.14.2+MSVC2017(32位/64位)+MySQL连接</a></p> 
<hr> 
<p>hello：<br> 共同学习，共同进步，如果还有相关问题，可在评论区留言进行讨论。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2d14ac1026c7047be0099b8fcb5cab3e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JS学习第10天——ES5中面向对象（原型和原型链、forEach、map、filter、some、every、trim、Object.keys、Object.defineProperty方法的使用）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a5661b544de31a75aa578b6ab91c6abe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android 蓝牙BLE连接、广播、数据传输流程分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>