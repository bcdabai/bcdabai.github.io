<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>深入浅出 VuePress（一）：如何做到在 Markdown 中使用 Vue 语法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="深入浅出 VuePress（一）：如何做到在 Markdown 中使用 Vue 语法" />
<meta property="og:description" content="前言 在 vuepress 刚出时，我就觉得这是个很值得追更的开源项目。果不其然，里面众多的前端编程技巧让我受益良多。
于是在周末这种日子里，人家追剧我追码。
今天，我就和大家分享下 vuepress 是如何做到在 Markdown 中使用 Vue 语法的。
原理 众所周知，Markdown 是一种标记语言，类似于 HTML，它也有对应的语法和词法。而 Vue 说白了也是一种语法，关键在于，Markdown 和 Vue 代码都可以被解释成 HTML。
聪明的读者应该想到了：添加一个中间过程，让 Vue 转成 Markdown 或者让 Markdown 转成 Vue，是不是就可以实现在 Markdown 中使用 Vue 语法了呢？
让我们再考虑一下两个方案的实现难点：
Vue -&gt; Markdown：template 和 style 部分还好，可 js 部分怎么办？Markdown -&gt; Vue：可以将 markdown 代码解释成 html 或者 js 混入到 vue 代码中。 很显然，第二种方案实现起来更靠谱些，所以尤雨溪也是这样选的： 在语法之间的转换工作上，webpack 的 loader 可是很擅长的。所以，vuepress 自定义了一个 markdownLoader 来将 Markdown 转成 Vue，再通过 vue-loader 得到最终的 HTML。
代码实现 markdownLoader 这是一个自定义的 loader，可参考如何编写一个 loader？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c5c3a677d34774fa167225eb86607656/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-15T11:04:42+08:00" />
<meta property="article:modified_time" content="2018-07-15T11:04:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">深入浅出 VuePress（一）：如何做到在 Markdown 中使用 Vue 语法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="article-content"> 
 <h3 class="heading">前言</h3> 
 <p>在 vuepress 刚出时，我就觉得这是个很值得追更的开源项目。果不其然，里面众多的前端编程技巧让我受益良多。</p> 
 <p>于是在周末这种日子里，人家追剧我追码。</p> 
 <p>今天，我就和大家分享下 vuepress 是如何做到<a href="https://link.juejin.im?target=https%3A%2F%2Fvuepress.docschina.org%2Fguide%2Fusing-vue.html" rel="nofollow">在 Markdown 中使用 Vue 语法</a>的。</p> 
 <h4 class="heading">原理</h4> 
 <p>众所周知，Markdown 是一种标记语言，类似于 HTML，它也有对应的语法和词法。而 Vue 说白了也是一种语法，关键在于，Markdown 和 Vue 代码都可以被解释成 HTML。</p> 
 <p>聪明的读者应该想到了：添加一个中间过程，让 Vue 转成 Markdown 或者让 Markdown 转成 Vue，是不是就可以实现在 Markdown 中使用 Vue 语法了呢？</p> 
 <p>让我们再考虑一下两个方案的实现难点：</p> 
 <ol><li>Vue -&gt; Markdown：template 和 style 部分还好，可 js 部分怎么办？</li><li>Markdown -&gt; Vue：可以将 markdown 代码解释成 html 或者 js 混入到 vue 代码中。</li></ol> 
 <p>很显然，第二种方案实现起来更靠谱些，所以尤雨溪也是这样选的： </p> 
 <figure> 
  <figcaption></figcaption> 
 </figure> 
 <p></p> 
 <p>在语法之间的转换工作上，webpack 的 <a href="https://link.juejin.im?target=https%3A%2F%2Fwebpack.docschina.org%2Fconcepts%2Floaders" rel="nofollow">loader</a> 可是很擅长的。所以，vuepress 自定义了一个 markdownLoader 来将 Markdown 转成 Vue，再通过 vue-loader 得到最终的 HTML。</p> 
 <h4 class="heading">代码实现</h4> 
 <h5 class="heading">markdownLoader</h5> 
 <p>这是一个自定义的 loader，可参考<a href="https://link.juejin.im?target=https%3A%2F%2Fwebpack.docschina.org%2Fcontribute%2Fwriting-a-loader%2F" rel="nofollow">如何编写一个 loader？</a></p> 
 <ol><li>这个 loader 接收一个参数，里面包含一个 markdown-it 实例，作者用它来把 markdown 解释成 html。</li><li>得到 html 后将之包裹在 template 标签内，返回。</li></ol> 
 <pre><code class="hljs bash copyable">`&lt;template&gt;\n` +
    `&lt;div class=<span class="hljs-string">"markdown"</span>&gt;<span class="hljs-variable">${html}</span>&lt;/div&gt;\n` +
`&lt;/template&gt;\n`
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>主要过程其实就这两步。当然，vuepress 还在 markdownLoader 里做了很多其他的事情，比如解析 yaml front matter、推断标题、获取 markdown 里提升的 style、script 等标签。</p> 
 <h5 class="heading">自己实现一个 demo</h5> 
 <p>接下来，大家可以跟我一起实现一个基本的 demo。完整代码可见 <a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2FLinFeng1997%2Fvuepress-source-learning%2Ftree%2Fvue-markdown-demo" rel="nofollow">github</a>。</p> 
 <ol><li> <p>新建一个 Vue 项目 我们使用 vue-cli(v2.9.6) 新建一个项目： </p> 
   <figure> 
    <figcaption></figcaption> 
   </figure><p></p> </li><li> <p>编写 markdownLoader</p> </li></ol> 
 <ul><li>2.1 引入 markdown-it<pre><code class="hljs bash copyable">npm install markdown-it --save
<span class="copy-code-btn">复制代码</span></code></pre></li><li>2.2 新建 markdownLoader 文件<pre><code class="hljs bash copyable">const markdown = require(<span class="hljs-string">'markdown-it'</span>)

module.exports = <span class="hljs-keyword">function</span>(src) {
  const html = markdown().render(src)
  <span class="hljs-built_in">return</span> (
    `&lt;template&gt;\n` +
    	`&lt;div class=<span class="hljs-string">"markdown"</span>&gt;<span class="hljs-variable">${html}</span>&lt;/div&gt;\n` +
    `&lt;/template&gt;\n`
  )
}
<span class="copy-code-btn">复制代码</span></code></pre></li><li>2.3 在 webpack 的 module rules 配置中添加 markdownLoader<pre><code class="hljs bash copyable">{
  <span class="hljs-built_in">test</span>: /\.md$/,
  use: [
    { loader: <span class="hljs-string">'vue-loader'</span> },
    {
      loader: require.resolve(<span class="hljs-string">'./markdownLoader'</span>)
    }
  ]
}
<span class="copy-code-btn">复制代码</span></code></pre></li></ul> 
 <ol start="3"><li>在 Vue 文件里使用 markdown 文件</li></ol> 
 <ul><li>3.1 在 src/components 新建一个 markdown.md</li></ul> 
 <pre><code class="hljs bash copyable"><span class="hljs-comment">## 我是一个 markdown </span>
{<!-- -->{1+2}}
<span class="copy-code-btn">复制代码</span></code></pre> 
 <ul><li>3.2 在 src/router/index 中引入 markdown</li></ul> 
 <pre><code class="hljs bash copyable"> const Markdown = () =&gt; import(<span class="hljs-string">'@/components/markdown.md'</span>)
<span class="copy-code-btn">复制代码</span></code></pre> 
 <ul><li>3.3 将这个组件添加进路由里去</li></ul> 
 <pre><code class="hljs bash copyable">{
  path: <span class="hljs-string">'/md'</span>,
  name: <span class="hljs-string">'Markdown'</span>,
  component: Markdown
}
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p></p> 
 <figure> 
  <figcaption></figcaption> 
 </figure> 
 <p></p> 
 <h4 class="heading">在 Markdown 中使用 React(JSX) 语法</h4> 
 <p>既然可以在 markdown 里写 vue，那在 markdonw 里面写 react 理论上也是可以实现的：让 markdownLoader 最后返回一个 React 组件，之后使用 babel-loader 转成 js。</p> 
 <p>这一次我们是将 markdown 转 jsx 再包裹在一个 React 组件(函数或者类)里：</p> 
 <pre><code class="hljs bash copyable"><span class="hljs-built_in">return</span> (
    `import React from <span class="hljs-string">'react'</span>;
    <span class="hljs-variable">${registerComponent}</span>
    <span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">R</span></span>() {
        <span class="hljs-built_in">return</span> (
        &lt;div&gt;
            &lt;div className=<span class="hljs-string">"markdown"</span>&gt;<span class="hljs-variable">${html}</span>&lt;/div&gt;
        &lt;/div&gt;)
    }
    <span class="hljs-built_in">export</span> default R;\n`
)
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>有兴趣的读者可以自行实现完整的 react 版本的 markdownLoader 代码。</p> 
 <h4 class="heading">结语</h4> 
 <p>本文实现的 demo 只对 markdownLoader 的关键步骤做了实现，实际上还有很多问题需要解决，如<a href="https://link.juejin.im?target=https%3A%2F%2Fvuepress.docschina.org%2Fguide%2Fusing-vue.html%23%25E6%25B5%258F%25E8%25A7%2588%25E5%2599%25A8-api-%25E8%25AE%25BF%25E9%2597%25AE%25E9%2599%2590%25E5%2588%25B6" rel="nofollow">浏览器的 API 访问限制</a>、代码块和高亮的处理等需要解决，这篇文章就不涉及了。</p> 
 <p>此系列文章还会给大家介绍 webpack 拓展、markdown-it 拓展、单元测试、插件系统等。如果您喜欢这篇文章的话，别记得点个赞噢~</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ad95fdb87c8be35c256205ac487bcc53/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解决Cannot create JDBC driver of class &#39;&#39; for connect URL &#39;null&#39;问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dc40576e568c5a66702a241820320660/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【IoT】分区表（Partition Tables）：ESP32 FLASH 分区功能简析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>