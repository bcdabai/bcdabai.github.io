<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UNIX下VG迁移（谨慎） - 转 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="UNIX下VG迁移（谨慎） - 转" />
<meta property="og:description" content="转自：http://service.hundsun.com/bbs/space/viewspacepost.aspx?postid=89
谨慎操作 关于卷迁移的整理 作者：高翔 最近在学习HP UNIX，发现HP UNIX中卷的迁移过程和其它的如LINUX，AIX有些不同，所以抽空将三种操作系统的操作步骤做了个整理： ### linux ### 在redhat Linux中LVM信息是同时保存在磁盘上和/etc/lvm.conf里，可以通过vgexport命令来实现vg的迁移。 vgexport只是把/etc/lvm.conf中关于这个VG的信息删除，而不会更改磁盘上的任何数据。磁盘挂到新的机器 上后，只需要修改/etc/lvmconf，这个可以通过vgimport完成。 源端：[@more@] 1,将源端文件系统umount
umount /test
2,将lv和lv inactive
lvchange -an /dev/vg_test/lv_test
vgchange -an vg_test
3,导出vg
vgexport vg_test
目标端：
1,用kudzu检测新的盘
2,导入vg
vgimport vg_test
3,激活vg
vgchange -ay vg_test
4,mount文件系统
###
HP UNIX
###
在HP UNIX上,vgexport只是在/etc/lvmtab里把相关vg的entry删除,重新vgimport就会重新生成,map文件除了能记录
原来lv的名字之外没有任何用处,如果不用map,vgimport后所有lv会使用默认值如:lvol1,lvol2…但不会影响vg中的数据。
源端：
1,将源端文件系统umount
umount /test
2,将vg inactive
vgchange –a n vg_test
3,在源端产生map文件
vgexport -p -s -m /tmp/vg_exp_bak/vg_test.map /dev/vg_test
4,将map文件拷贝到目标端
可以通过在源端export vg 前后通过 strings /etc/lvmtab观察发生的变化." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9c3572031600a8de78a094fedd7524e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2010-10-29T16:42:07+08:00" />
<meta property="article:modified_time" content="2010-10-29T16:42:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">UNIX下VG迁移（谨慎） - 转</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="preview-main"> 
 <p>转自：http://service.hundsun.com/bbs/space/viewspacepost.aspx?postid=89</p> 
 <font color="#FF0000">谨慎操作</font> 
 <br> 
 <a href="http://item.feedsky.com/~feedsky/TaobaoDBA/~6677730/208699655/4541478/1/item.html" rel="nofollow"><font color="#0000ff">关于卷迁移的整理 </font></a>作者：高翔 
 <br> 
 <br>最近在学习HP UNIX，发现HP UNIX中卷的迁移过程和其它的如LINUX，AIX有些不同，所以抽空将三种操作系统的操作步骤做了个整理： 
 <br>### 
 <br>linux 
 <br>### 
 <br>在redhat Linux中LVM信息是同时保存在磁盘上和/etc/lvm.conf里，可以通过vgexport命令来实现vg的迁移。 
 <br>vgexport只是把/etc/lvm.conf中关于这个VG的信息删除，而不会更改磁盘上的任何数据。磁盘挂到新的机器 
 <br>上后，只需要修改/etc/lvmconf，这个可以通过vgimport完成。 
 <br>源端：[@more@] 
 <div class="SpaceArticleContent"> 
  <p><br>1,将源端文件系统umount<br>umount /test<br>2,将lv和lv inactive<br>lvchange -an /dev/vg_test/lv_test<br>vgchange -an vg_test<br>3,导出vg<br>vgexport vg_test<br>目标端：<br>1,用kudzu检测新的盘<br>2,导入vg<br>vgimport vg_test<br>3,激活vg<br>vgchange -ay vg_test<br>4,mount文件系统<br>###<br>HP UNIX<br>###<br>在HP UNIX上,vgexport只是在/etc/lvmtab里把相关vg的entry删除,重新vgimport就会重新生成,map文件除了能记录<br>原来lv的名字之外没有任何用处,如果不用map,vgimport后所有lv会使用默认值如:lvol1,lvol2…但不会影响vg中的数据。<br>源端：<br>1,将源端文件系统umount<br>umount /test<br>2,将vg inactive<br>vgchange –a n vg_test<br>3,在源端产生map文件<br>vgexport -p -s -m /tmp/vg_exp_bak/vg_test.map /dev/vg_test<br>4,将map文件拷贝到目标端<br>可以通过在源端export vg 前后通过 strings /etc/lvmtab观察发生的变化.<br>目标端：<br>1,用ioscan检测新的盘并识别<br>ioscan -fnCdisk<br>insf -e<br>2,建立vg的相关信息<br>mkdir /dev/vg_test<br>mknod /dev/vg_test/group c 64 0×100000<br>3,import vg<br>vgimport -s -m /tmp/vg_exp_bak/vg_test.map /dev/vg_test<br>4,激活vg<br>vgchange -a y /dev/vg_test<br>5,挂载文件系统<br>###<br>AIX<br>###<br>在AIX中,exportvg就是在系统中把这个vg的定义从ODM中删除,在vg上的lv、fs、pv的定义也都从系统中删除<br>了.这些信息都保存这个vg的VGDA中.importvg就是系统从这个vg的VGDA中读取这个vg的信息,把它们加入到系<br>统当中,这样系统就可以正常使用这个vg了.两个命令都不对VG做操作的而是对ODM库的操作.<br>源端:<br>1,将vg inactive<br>varyoff testvg<br>2,导出vg(从ODM中导出vg）<br>exportvg testvg<br>目标端:<br>1,用cfgmgr检测新的盘并识别<br>lspv<br>lsdev –Cc disk<br>cfgmgr<br>2,导入vg<br>importvg testvg<br>3,挂载文件系统<br><font color="#FF0000">最后记住，在确认目标端正常后，将源端将磁盘的信息清除掉。</font></p> 
 </div> 
 <p style="clear:both;"></p> 
 <p class="translate"> 来自 “ ITPUB博客 ” ，链接：http://blog.itpub.net/789833/viewspace-1040591/，如需转载，请注明出处，否则将追究法律责任。 </p> 
</div> 
<p>转载于:http://blog.itpub.net/789833/viewspace-1040591/</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/09e7c292a55a1e35c583d65e3811fa79/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Invalid location of tag (div) 错误</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/57cfa9d7f0a41203bf26e33a44d1f8a0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">驱动开发准备工作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>