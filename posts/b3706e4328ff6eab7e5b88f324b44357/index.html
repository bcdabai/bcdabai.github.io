<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>光谱数据作图 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="光谱数据作图" />
<meta property="og:description" content="发现光谱仪配套的软件在半高宽的计算上好像有些问题，试了试python能不能解决。 目录 1.光谱原图
2.光谱数据标准化
3.光谱标注峰值和半高宽
1.光谱原图 首先，导入光谱数据，做图；
import pandas as pd import matplotlib.pyplot as plt df1 = pd.read_excel(&#39;D:/desktop/data.xlsx&#39;)#读取.xlsx文件 data = df1.values #data为除了第一行以外的数据 print(data.shape) #查看data的size WL = data[:,0] Intensity = data[:,1] font1 = {&#39;family&#39; : &#39;Times New Roman&#39;, &#39;weight&#39; : &#39;normal&#39;, &#39;size&#39; : 16, } plt.figure(figsize=(5,5)) plt.title(&#39;guangputu&#39;,font1) plt.xlabel(&#39;lambda/nm&#39;,font1) plt.plot(WL,Intensity,&#39;-*&#39;) plt.legend([&#39;intensity&#39;]) plt.show() 运行结果：（1044,2） 2.光谱数据标准化 起初，出现了这样的问题
from sklearn.preprocessing import MinMaxScaler scaler = MinMaxScaler(feature_range=(0, 1)) #将数据归一到0到1 Intensity = scaler.fit_transform(Intensity) plt.figure(figsize=(5,5)) plt.title(&#39;biaozhunhua&#39;,font1) plt.xlabel(&#39;lambda/nm&#39;,font1) plt.plot(WL,Intensity,&#39;-*&#39;) plt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b3706e4328ff6eab7e5b88f324b44357/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-30T16:01:13+08:00" />
<meta property="article:modified_time" content="2022-11-30T16:01:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">光谱数据作图</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>发现光谱仪配套的软件在半高宽的计算上好像有些问题，试了试python能不能解决。</h2> 
<h2 id="1.%E6%A0%87%E5%87%86%E5%8C%96"><strong>目录</strong></h2> 
<p style="margin-left:0px;"><a href="#1.%E6%A0%87%E5%87%86%E5%8C%96" rel="nofollow">1.</a>光谱原图</p> 
<p style="margin-left:0px;"><a href="#2." rel="nofollow">2.</a>光谱数据标准化</p> 
<p style="margin-left:0px;">3.光谱标注峰值和半高宽</p> 
<h2 style="margin-left:0px;">1.光谱原图</h2> 
<p>首先，导入光谱数据，做图；</p> 
<pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt


df1 = pd.read_excel('D:/desktop/data.xlsx')#读取.xlsx文件
data = df1.values #data为除了第一行以外的数据
print(data.shape) #查看data的size

WL = data[:,0]
Intensity = data[:,1]

font1 = {'family' : 'Times New Roman',
'weight' : 'normal',
'size'   : 16,
}
plt.figure(figsize=(5,5))
plt.title('guangputu',font1)
plt.xlabel('lambda/nm',font1)
plt.plot(WL,Intensity,'-*')
plt.legend(['intensity'])
plt.show()</code></pre> 
<p>运行结果：（1044,2） </p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/13/36/U1HNnmHx_o.png"></p> 
<p style="text-align:center;"></p> 
<h2 style="margin-left:0px;">2.光谱数据标准化</h2> 
<p>起初，出现了这样的问题</p> 
<pre><code class="language-python">from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler(feature_range=(0, 1))  #将数据归一到0到1
Intensity = scaler.fit_transform(Intensity)
plt.figure(figsize=(5,5))
plt.title('biaozhunhua',font1)
plt.xlabel('lambda/nm',font1)
plt.plot(WL,Intensity,'-*')
plt.legend(['intensity'])
plt.show()</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/d5/20/rVIvHkgg_o.png"></p> 
<p> 将scaler.fit_transform(Intensity)按报错要求改为scaler.fit_transform(Intensity.reshape(-1,1))，又出现如下错误，</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/9e/97/amV9YGaZ_o.png"></p> 
<p>这里，注意到x,y的维度不对应，这里修改为：</p> 
<pre><code class="language-python">from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler(feature_range=(0, 1))  #将数据归一到0到1
Intensity = (scaler.fit_transform(Intensity.reshape(-1, 1))).reshape(-1)
plt.figure(figsize=(5,5))
plt.title('biaozhunhua',font1)
plt.xlabel('lambda/nm',font1)
plt.plot(WL,Intensity,'-*')
plt.legend(['intensity'])
plt.show()</code></pre> 
<p>运行结果为</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/20/7c/1qd7qu0Y_o.png"></p> 
<h2> 3.光谱标注峰值和半高宽</h2> 
<p>先观察光谱有几个峰和位置，有两个峰，位置分别为400-500 500-700  ,第二个峰不确定是否有半高宽，但是我们可以根据计算结果判断。</p> 
<p>这里现将WL和Intensity类型转化为列表，因为这里光谱数据的波长分辨率不均匀，所以这里穷举一下，估个大致位置就可以了：</p> 
<pre><code class="language-python">WL = list(WL)
Intensity = list(Intensity)
print(WL[190]) #496.949
print(WL[450]) #696.031</code></pre> 
<p>计算半高宽：</p> 
<pre><code class="language-python">max1 = max(Intensity[0:190])
# print(max1,data.index(max1))
# print(data[289:349])
WL_range1 = [x for x in range(0,190)if Intensity[x]&gt;max1/2]
print(WL_range1)
print(min(WL_range1),max(WL_range1))#111 151
HW1 = WL[max(WL_range1)]-WL[min(WL_range1)]#半高宽
center1 = Intensity.index(max1)#最大值的横坐标索引
print(HW1,center1,max1)#31.194000000000017 128 1.0

max2 = max(Intensity[170:450])
WL_range2 = [x for x in range(170,450)if Intensity[x]&gt;max2/2]
print(WL_range2)
print(min(WL_range2),max(WL_range2))#174 365
HW2 = WL[max(WL_range2)]-WL[min(WL_range2)]
center2 = Intensity.index(max2)
print(HW2,center2,max2)#146.97600000000006 264 0.7260080266137009
print(Intensity[174])#0.36640428957929755</code></pre> 
<p>可以看到第二个峰的半高宽最小索引为174，大于第一个峰的峰值索引128,  因此可以认为第二个峰是符合的。</p> 
<p>接下来画图：</p> 
<pre><code class="language-python">plt.figure(figsize=(10,10))
plt.title('guiyihua_FWHM ',font1)
plt.xlabel('lambda/nm',font1)
plt.plot(WL,Intensity,marker='*',color='blue')
plt.text(WL[128],Intensity[128],(WL[128],Intensity[128],HW1),fontsize=20,color='red',verticalalignment='center',horizontalalignment='right')
plt.plot(WL[128],Intensity[128],marker='*',color='r')
plt.text(WL[264],Intensity[264],(WL[264],Intensity[264],HW1),fontsize=20,color='red',verticalalignment='center',horizontalalignment='right')
plt.plot(WL[264],Intensity[264],marker='*',color='r')
plt.legend()
plt.show()</code></pre> 
<p>运行结果为：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/10/e0/oFBsL43R_o.png"></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dbca3049ff69cdc8a9e44e5bbbe34c6d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序自带git工具，操作后丢失代码的恢复操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2500d3b1dce043ee241af86036f07511/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AndroidStudio的安装和插件配置大全</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>