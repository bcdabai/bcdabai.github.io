<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows安装WSL2精简版教程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows安装WSL2精简版教程" />
<meta property="og:description" content="文章目录 一、安装WSL二、更改WSL的存放路径/备份WSL三、安装WSL Terminall四、WSL界面：xlaunch五、WSL1升级WSL2六、WSL2与VMware兼容问题七、更改手动导入的wsl的默认登录用户参考 一、安装WSL 步骤1 - 启用适用于 Linux 的 Windows 子系统：
需要先启用“适用于 Linux 的 Windows 子系统”可选功能，然后才能在 Windows 上安装 Linux 分发。以管理员身份打开 PowerShell 并运行： dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart 步骤2 - 启用虚拟机功能：
安装 WSL 2 之前，必须启用“虚拟机平台”可选功能。 计算机需要虚拟化功能才能使用此功能。
以管理员身份打开 PowerShell 并运行： dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart 步骤3 - 将 WSL 2 设置为默认版本：
打开 PowerShell，然后在安装新的 Linux 发行版时运行以下命令，将 WSL 2 设置为默认版本： wsl --set-default-version 2 步骤4 - 安装所选的 Linux 分发版：
打开 Microsoft Store，并选择你偏好的 Linux 分发版。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/edf9fd8549156e7c56cd659cde876a79/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-18T14:48:21+08:00" />
<meta property="article:modified_time" content="2024-01-18T14:48:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows安装WSL2精简版教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#WSL_2" rel="nofollow">一、安装WSL</a></li><li><a href="#WSLWSL_54" rel="nofollow">二、更改WSL的存放路径/备份WSL</a></li><li><a href="#WSL_Terminall_88" rel="nofollow">三、安装WSL Terminall</a></li><li><a href="#WSLxlaunch_193" rel="nofollow">四、WSL界面：xlaunch</a></li><li><a href="#WSL1WSL2_205" rel="nofollow">五、WSL1升级WSL2</a></li><li><a href="#WSL2VMware_245" rel="nofollow">六、WSL2与VMware兼容问题</a></li><li><a href="#wsl_276" rel="nofollow">七、更改手动导入的wsl的默认登录用户</a></li><li><a href="#_290" rel="nofollow">参考</a></li></ul> 
</div> 
<p></p> 
<h2><a id="WSL_2"></a>一、安装WSL</h2> 
<p>步骤1 - 启用适用于 Linux 的 Windows 子系统：</p> 
<ul><li>需要先启用“适用于 Linux 的 Windows 子系统”可选功能，然后才能在 Windows 上安装 Linux 分发。</li><li>以管理员身份打开 PowerShell 并运行：</li></ul> 
<pre><code class="prism language-bash">dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
</code></pre> 
<p>步骤2 - 启用虚拟机功能：</p> 
<ul><li>安装 WSL 2 之前，必须启用“虚拟机平台”可选功能。 计算机需要虚拟化功能才能使用此功能。<br> 以管理员身份打开 PowerShell 并运行：</li></ul> 
<pre><code class="prism language-bash">dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
</code></pre> 
<p>步骤3 - 将 WSL 2 设置为默认版本：</p> 
<ul><li>打开 PowerShell，然后在安装新的 Linux 发行版时运行以下命令，将 WSL 2 设置为默认版本：</li></ul> 
<pre><code class="prism language-bash">wsl --set-default-version <span class="token number">2</span>
</code></pre> 
<p>步骤4 - 安装所选的 Linux 分发版：</p> 
<ul><li>打开 Microsoft Store，并选择你偏好的 Linux 分发版。<br> <img src="https://images2.imgbox.com/62/78/CUjDLqpg_o.png" alt="在这里插入图片描述"><br> 存在的Linux 分发版如下：<br> Ubuntu 16.04 LTS<br> Ubuntu 18.04 LTS<br> Ubuntu 20.04 LTS<br> openSUSE Leap 15.1<br> SUSE Linux Enterprise Server 12 SP5<br> SUSE Linux Enterprise Server 15 SP1<br> Kali Linux<br> Debian GNU/Linux<br> Fedora Remix for WSL<br> Pengwin<br> Pengwin Enterprise<br> Alpine WSL</li></ul> 
<p><img src="https://images2.imgbox.com/e1/ac/wZcjbkj0_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="WSLWSL_54"></a>二、更改WSL的存放路径/备份WSL</h2> 
<p>wsl默认存放路径为C盘，可根据需求将其导出到其他空间较大的盘符。</p> 
<p>查看已安装的WSL的名称和版本，在Powershell中输入以下命令：</p> 
<pre><code class="prism language-bash">wsl <span class="token parameter variable">-l</span> <span class="token parameter variable">--all</span> <span class="token parameter variable">-v</span>
</code></pre> 
<p>导出系统到指定位置，wsl --export &lt;系统名&gt; &lt;导出目录&gt;</p> 
<pre><code class="prism language-bash">wsl <span class="token parameter variable">--export</span> Ubuntu-20.04 D:<span class="token punctuation">\</span>wsl-ubuntu-20.04.tar
</code></pre> 
<p>删除当前C盘中的wsl系统</p> 
<pre><code class="prism language-bash">wsl <span class="token parameter variable">--unregister</span> Ubuntu-20.04
</code></pre> 
<p>导入系统到指定位置，wsl --import &lt;系统名&gt; &lt;安装位置&gt; &lt;tar文件目录&gt; WSL版本号</p> 
<pre><code class="prism language-bash">wsl <span class="token parameter variable">--import</span> Ubuntu-20.04 D:<span class="token punctuation">\</span>WSL2_Ubuntu D:<span class="token punctuation">\</span>wsl-ubuntu-20.04.tar <span class="token parameter variable">--version</span> <span class="token number">2</span>
</code></pre> 
<p>配置之前的默认登录用户，ubuntu2004.exe config --default-user &lt;用户名&gt;</p> 
<pre><code class="prism language-bash">ubuntu2004.exe config --default-user wanyel
</code></pre> 
<h2><a id="WSL_Terminall_88"></a>三、安装WSL Terminall</h2> 
<p>１、安装VcXsrv软件，直接下载安装即可，看不懂英文直接默认下一步。</p> 
<pre><code class="prism language-bash">https://sourceforge.net/projects/vcxsrv/
</code></pre> 
<p>2、安装xfce4图形界面</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> upgrade <span class="token parameter variable">-y</span>
</code></pre> 
<p>3、安装XFCE桌面环境</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> xfce4 <span class="token parameter variable">-y</span>
</code></pre> 
<p>4、将其他软件安装到XFCE桌面</p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> xfce4-goodies <span class="token parameter variable">-y</span>
</code></pre> 
<p>5、配置X-Launch</p> 
<ul><li> <p>打开X-Launch软件，选择One large window, Display number选择0<br> <img src="https://images2.imgbox.com/70/c8/vZlbQtoa_o.png" alt="在这里插入图片描述"></p> </li><li> <p>然后就是疯狂的下一步，直到出现黑色窗口<br> <img src="https://images2.imgbox.com/6e/97/5oKdTqLD_o.png" alt="在这里插入图片描述"></p> </li><li> <p>为ubuntu添加环境变量</p> </li></ul> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span>localhost:0
</code></pre> 
<ul><li>添加环境变量之后需要更新才可使用</li></ul> 
<pre><code class="prism language-bash"><span class="token builtin class-name">source</span> /etc/profile
</code></pre> 
<ul><li>打开xfce4,以后每次使用时需要输入此命令</li></ul> 
<pre><code class="prism language-bash">startxfce4
</code></pre> 
<p><img src="https://images2.imgbox.com/6b/5c/S198Dja8_o.png" alt="在这里插入图片描述"></p> 
<ul><li>成功打开之后之前的黑色屏幕上就会变成xfce4桌面环境。如下图所示<br> <img src="https://images2.imgbox.com/9e/1f/6x8uJARj_o.png" alt="在这里插入图片描述"></li></ul> 
<p>example：<br> <img src="https://images2.imgbox.com/20/8b/Rub1Ti3I_o.png" alt="在这里插入图片描述"></p> 
<p>WSL2的话：</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span>localhost:0
或者
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">DISPLAY</span></span><span class="token operator">=</span><span class="token number">192.168</span>.70.221:0

<span class="token number">192.168</span>.70.221是本地IP<span class="token punctuation">(</span>不是WSL的IP<span class="token punctuation">)</span>
</code></pre> 
<p>WSL2配置完毕后，一定要重启那个大黑屏</p> 
<ul><li>windows的cmd进入到VcXsrv的安装目录去执行</li></ul> 
<pre><code class="prism language-bash">D:<span class="token punctuation">\</span>softwares<span class="token punctuation">\</span>VcXsrv<span class="token operator">&gt;</span>.<span class="token punctuation">\</span>vcxsrv.exe <span class="token parameter variable">-ac</span> <span class="token parameter variable">-terminate</span> <span class="token parameter variable">-lesspointer</span> <span class="token parameter variable">-multiwindow</span> <span class="token parameter variable">-clipboard</span> <span class="token parameter variable">-wgl</span>

这个就是那个黑屏
D:<span class="token punctuation">\</span>softwares<span class="token punctuation">\</span>VcXsrv<span class="token operator">&gt;</span>vcxsrv <span class="token parameter variable">-ac</span>
</code></pre> 
<p>如果WSL2没有反应：建议参考</p> 
<ul><li><a href="https://blog.csdn.net/qq_42471423/article/details/115877146">WSL Error: Can‘t open display</a></li></ul> 
<p>可能出现的问题：<br> <img src="https://images2.imgbox.com/51/51/wO9FWQIy_o.png" alt="在这里插入图片描述"><br> 则需要在windows后台将该进程kill<br> <img src="https://images2.imgbox.com/9d/68/KP4IIrob_o.png" alt="在这里插入图片描述"><br> 或者在下面这里kill</p> 
<p><img src="https://images2.imgbox.com/37/f0/TKkhQHDL_o.png" alt="在这里插入图片描述"></p> 
<p>参考</p> 
<ul><li><a href="https://zhuanlan.zhihu.com/p/146146238" rel="nofollow">WSL安装图形界面并通过xrdp/X-Launch访问</a></li><li><a href="https://www.bilibili.com/video/BV1dJ41187G2/?vd_source=32de30d5fa72b146ca37e82aa5fc5934" rel="nofollow">如何提高WIN10商城的下载速度？不再卡读条！</a></li></ul> 
<h2><a id="WSLxlaunch_193"></a>四、WSL界面：xlaunch</h2> 
<ul><li><a href="https://www.bilibili.com/video/BV1u44y1N78v/?spm_id_from=333.999.0.0&amp;vd_source=32de30d5fa72b146ca37e82aa5fc5934" rel="nofollow">WSL没有图形界面？快速搭建Python和C++开发环境</a></li></ul> 
<h2><a id="WSL1WSL2_205"></a>五、WSL1升级WSL2</h2> 
<p>WSL2需要使用虚拟机，因此需要在系统中启动虚拟机功能。</p> 
<p>打开PowerShell，执行命令 ：</p> 
<pre><code class="prism language-bash">dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
</code></pre> 
<p>打开 控制面版，查看方式可选择大图标，在点击程序与功能—&gt;启用或关闭Windows功能，检查下图中红框圈出内容是否均以打对勾；若没有，则需要打对勾并点击确定。</p> 
<p>如果没有Hyper-V（windows 家庭版没有这一项）这一项，也没事。<br> <img src="https://images2.imgbox.com/62/f0/uDMV6XjT_o.png" alt="在这里插入图片描述"></p> 
<p>重新启动系统。</p> 
<p>启动系统后，最好在检查一下虚拟机是否以启动。通过以下方式进行检查，</p> 
<p>检查一下任务管理器中-性能-CPU中的虚拟化是否已开启：<br> <img src="https://images2.imgbox.com/ec/7f/0GZIVIWR_o.png" alt="在这里插入图片描述"></p> 
<p>设置分发版版本<br> 打开PowerShell，执行命令 ：</p> 
<pre><code class="prism language-bash">wsl --set-version 分发版名称 版本号
例如，将Ubuntu18.04 设置为WSL2的命令为 wsl --set-version Ubuntu-18.04 <span class="token number">2</span>

或者
wsl <span class="token parameter variable">--update</span>
</code></pre> 
<h2><a id="WSL2VMware_245"></a>六、WSL2与VMware兼容问题</h2> 
<p>WSL2需要开启hypervisor-v，然而VMware不需要；</p> 
<blockquote> 
 <p>网上说windows某个版本或者VMware某个版本就可以了，当前暂未测试</p> 
</blockquote> 
<p>WSL和virtual，vm虚拟机存在冲突，所以开启WSL开关如下：</p> 
<ul><li>windows11/10家庭版能通过命令行的方式开启hyper-v(其实开启的是windows功能中的启用或关闭Windows功能的虚拟机平台功能)</li><li>windows11/10专业版，才可以在windows功能中的启用或关闭Windows功能中看到开启Hyper-V功能（我猜测Hyper-V-Manager也仅在专业版上默认安装）</li></ul> 
<pre><code class="prism language-bash">bcdedit /set hypervisorlaunchtype off
</code></pre> 
<p>关闭虚拟机支持：<a href="https://blog.csdn.net/jop_qq/article/details/104043422">参考</a></p> 
<p>打开：</p> 
<pre><code class="prism language-bash">bcdedit /set hypervisorlaunchtype auto
</code></pre> 
<p>参考</p> 
<p><a href="https://blog.csdn.net/zerostruggle/article/details/117608185">WSL2 请启用虚拟机平台 Windows 功能并确保在 BIOS 中启用虚拟化</a></p> 
<h2><a id="wsl_276"></a>七、更改手动导入的wsl的默认登录用户</h2> 
<p>试过在pwoershell 输入：</p> 
<pre><code class="prism language-bash">ubuntu2204 config --default-user your_user_name 
</code></pre> 
<p>参考：</p> 
<ul><li><a href="https://blog.csdn.net/razor_et/article/details/130265553?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-130265553-blog-120931194.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-130265553-blog-120931194.235%5Ev40%5Epc_relevant_3m_sort_dl_base1&amp;utm_relevant_index=1">WSL2迁移后默认root登录问题解决</a></li></ul> 
<h2><a id="_290"></a>参考</h2> 
<ul><li> <p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/basic-commands" rel="nofollow">WSL 的基本命令</a></p> </li><li> <p><a href="https://blog.csdn.net/yao_zhuang/article/details/127312455">windows wsl中保留linux文件的权限</a></p> </li><li> <p><a href="https://blog.csdn.net/bornfree5511/article/details/108632513">WSL1和WSL2安装界面显示</a></p> </li><li> <p><a href="https://zhuanlan.zhihu.com/p/356397851" rel="nofollow">WSL1升级为WSL2</a></p> </li><li> <p><a href="https://www.cnblogs.com/yhome/p/14409090.html" rel="nofollow">WSL2 安装教程</a></p> </li><li> <p><a href="https://zhuanlan.zhihu.com/p/49227132" rel="nofollow">玩转 WSL 并配置Linux下的开发调试环境(Linux初学者福音)</a></p> </li><li> <p><a href="https://blog.csdn.net/CSDN_Huang1/article/details/124092336">更改WSL2的存放路径</a></p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/298ccf85533d7c0554e8ff5978bbd6c2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python文件移动的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e93aa8b50572ab97af48459ae344ec7f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">查找国外文献的技巧</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>