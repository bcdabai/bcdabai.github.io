<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端流程图插件jsPlumb教程附一个简单demo - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="前端流程图插件jsPlumb教程附一个简单demo" />
<meta property="og:description" content="目录 1，前言2，API介绍2.1，基本概念2.2，连接两个节点2.3，可拖动节点2.4，给连接加上箭头2.5，增加一个端点2.6，拖动端点连线2.7，限制节点拖动区域2.8，给链接添加点击事件：点击删除连线2.9，指定端点连接2.10，一个端点拖拽出多条连线3，实现代码3.1，先初始化3.2，设置连线和端点的样式**3.3，左侧初始元素开启拖动3.4，在右侧界面放置节点3.5，鼠标进入和移出新节点时显示删除和设置按钮3.6点击删除按钮删除节点3.7，双击删除连线3.8，点击保存按钮3.9，点击删除按钮3.10，页面加载时识别缓存的json节点信息并还原 1，前言 我司要做一个工作流的应用，参考轻流BPM的工作流交互逻辑，看了一下太难了，所以退而求其次，先做成visio这样的拖拽式流程设计。第一次接触jsplumb，文档都是在网上搜的，所以自己就整理一下，结合自己的一些应用，做了一个demo，留待以后有需要。
demo用到的插件有：JsRender.js模板引擎、jquery、jquery-ui、Bootstrap的icon、以及jsplumb.js。
2，API介绍 先简单介绍下jsplumb的一些用法，稍微详细的请移步jsplumb 中文基础教程。
2.1，基本概念 源节点：Souce 目标节点：Target 锚点：Anchor 端点：Endpoint 连接：Connector 2.2，连接两个节点 jsPlumb.ready方法和jquery的ready方法差不多的功能，jsPlumb.connect用于建立连线
&lt;div id=&#34;diagramContainer&#34;&gt; &lt;div id=&#34;item_left&#34; class=&#34;item&#34;&gt;&lt;/div&gt; &lt;div id=&#34;item_right&#34; class=&#34;item&#34; style=&#34;margin-left:50px;&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;script src=&#34;https://cdn.bootcss.com/jsPlumb/2.6.8/js/jsplumb.min.js&#34;&gt;&lt;/script&gt; &lt;script&gt; jsPlumb.ready(function () { jsPlumb.connect({ source: &#39;item_left&#39;, target: &#39;item_right&#39;, endpoint: &#39;Dot&#39; }) }) &lt;/script&gt; 2.3，可拖动节点 &lt;div id=&#34;diagramContainer&#34;&gt; &lt;div id=&#34;item_left&#34; class=&#34;item&#34;&gt;&lt;/div&gt; &lt;div id=&#34;item_right&#34; class=&#34;item&#34; style=&#34;left:150px;&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;script src=&#34;https://cdn.bootcss.com/jsPlumb/2.6.8/js/jsplumb.min.js&#34;&gt;&lt;/script&gt; &lt;script&gt; jsPlumb.ready(function () { jsPlumb.connect({ source: &#39;item_left&#39;, target: &#39;item_right&#39;, endpoint: &#39;Rectangle&#39; }) jsPlumb.draggable(&#39;item_left&#39;) jsPlumb.draggable(&#39;item_right&#39;) }) &lt;/script&gt; 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a906b685ef999d9c12a66011a2450940/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-29T16:23:21+08:00" />
<meta property="article:modified_time" content="2022-12-29T16:23:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端流程图插件jsPlumb教程附一个简单demo</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#1_1" rel="nofollow">1，前言</a></li><li><a href="#2API_6" rel="nofollow">2，API介绍</a></li><li><ul><li><a href="#21_9" rel="nofollow">2.1，基本概念</a></li><li><a href="#22_16" rel="nofollow">2.2，连接两个节点</a></li><li><a href="#23_36" rel="nofollow">2.3，可拖动节点</a></li><li><a href="#24_57" rel="nofollow">2.4，给连接加上箭头</a></li><li><a href="#25_73" rel="nofollow">2.5，增加一个端点</a></li><li><a href="#26_82" rel="nofollow">2.6，拖动端点连线</a></li><li><a href="#27_115" rel="nofollow">2.7，限制节点拖动区域</a></li><li><a href="#28_121" rel="nofollow">2.8，给链接添加点击事件：点击删除连线</a></li><li><a href="#29_147" rel="nofollow">2.9，指定端点连接</a></li><li><a href="#210_166" rel="nofollow">2.10，一个端点拖拽出多条连线</a></li><li><a href="#3_185" rel="nofollow">3，实现代码</a></li><li><a href="#31_188" rel="nofollow">3.1，先初始化</a></li><li><a href="#32_193" rel="nofollow">3.2，设置连线和端点的样式**</a></li><li><a href="#33_232" rel="nofollow">3.3，左侧初始元素开启拖动</a></li><li><a href="#34_251" rel="nofollow">3.4，在右侧界面放置节点</a></li><li><a href="#35_316" rel="nofollow">3.5，鼠标进入和移出新节点时显示删除和设置按钮</a></li><li><a href="#36_330" rel="nofollow">3.6点击删除按钮删除节点</a></li><li><a href="#37_342" rel="nofollow">3.7，双击删除连线</a></li><li><a href="#38_351" rel="nofollow">3.8，点击保存按钮</a></li><li><a href="#39_401" rel="nofollow">3.9，点击删除按钮</a></li><li><a href="#310json_411" rel="nofollow">3.10，页面加载时识别缓存的json节点信息并还原</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1_1"></a>1，前言</h3> 
<hr> 
<p>我司要做一个工作流的应用，参考<a href="https://qingflow.com/" rel="nofollow">轻流BPM</a>的工作流交互逻辑，看了一下太难了，所以退而求其次，先做成<code>visio</code>这样的拖拽式流程设计。第一次接触<code>jsplumb</code>，文档都是在网上搜的，所以自己就整理一下，结合自己的一些应用，做了一个demo，留待以后有需要。</p> 
<p>demo用到的插件有：<code>JsRender.js模板引擎</code>、<code>jquery</code>、<code>jquery-ui</code>、<code>Bootstrap</code>的<code>icon</code>、以及<code>jsplumb.js</code>。</p> 
<h3><a id="2API_6"></a>2，API介绍</h3> 
<hr> 
<p>先简单介绍下jsplumb的一些用法，稍微详细的请移步<a href="https://www.cnblogs.com/xcj26/p/9870734.html" rel="nofollow">jsplumb 中文基础教程。</a></p> 
<h4><a id="21_9"></a>2.1，基本概念</h4> 
<p>源节点：<code>Souce </code><br> 目标节点：<code>Target </code><br> 锚点：<code>Anchor </code><br> 端点：<code>Endpoint </code><br> 连接：<code>Connector </code></p> 
<h4><a id="22_16"></a>2.2，连接两个节点</h4> 
<p><code>jsPlumb.ready</code>方法和<code>jquery</code>的<code>ready</code>方法差不多的功能，<code>jsPlumb.connect</code>用于建立连线</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>diagramContainer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item_left<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item_right<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin-left</span><span class="token punctuation">:</span>50px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/jsPlumb/2.6.8/js/jsplumb.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      jsPlumb<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">'item_left'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'item_right'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">endpoint</span><span class="token operator">:</span> <span class="token string">'Dot'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="23_36"></a>2.3，可拖动节点</h4> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>diagramContainer<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item_left<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item_right<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">left</span><span class="token punctuation">:</span>150px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/jsPlumb/2.6.8/js/jsplumb.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      jsPlumb<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">'item_left'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'item_right'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">endpoint</span><span class="token operator">:</span> <span class="token string">'Rectangle'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      jsPlumb<span class="token punctuation">.</span><span class="token function">draggable</span><span class="token punctuation">(</span><span class="token string">'item_left'</span><span class="token punctuation">)</span>
      jsPlumb<span class="token punctuation">.</span><span class="token function">draggable</span><span class="token punctuation">(</span><span class="token string">'item_right'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="24_57"></a>2.4，给连接加上箭头</h4> 
<p>箭头实际上是通过设置<code>overlays</code>或者<code>connectorOverlays</code>去设置的，可以设置箭头的长宽以及箭头的位置，<code>location 0.5</code>表示箭头位于中间，<code>location 1</code>表示箭头设置在连线末端。 一根连线是可以添加多个箭头的。<br> 一个可配置的箭头：<code>Arrow</code><br> 标签，可以在链接上显示文字信息：<code>Label</code><br> 原始类型的箭头：<code>PlainArrow</code><br> 菱形箭头：<code>Diamond</code><br> 自定义类型：<code>Custom</code></p> 
<pre><code class="prism language-javascript">jsPlumb<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">'item_left'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'item_right'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">paintStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token string">'lightgray'</span><span class="token punctuation">,</span> <span class="token literal-property property">strokeWidth</span><span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">endpointStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">'lightgray'</span><span class="token punctuation">,</span> <span class="token literal-property property">outlineStroke</span><span class="token operator">:</span> <span class="token string">'darkgray'</span><span class="token punctuation">,</span> <span class="token literal-property property">outlineWidth</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">overlays</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span><span class="token string">'Arrow'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token number">0.5</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> common<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="25_73"></a>2.5，增加一个端点</h4> 
<p><code>addEndpoint</code>方法可以用来增加端点</p> 
<pre><code class="prism language-javascript">jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_left'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Right'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="26_82"></a>2.6，拖动端点连线</h4> 
<p>如果你将<code>isSource</code>和<code>isTarget</code>设置成<code>true</code>，那么就可以用户在拖动时，自动创建链接。</p> 
<pre><code class="prism language-javascript">jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      jsPlumb<span class="token punctuation">.</span><span class="token function">setContainer</span><span class="token punctuation">(</span><span class="token string">'diagramContainer'</span><span class="token punctuation">)</span>

      <span class="token keyword">var</span> common <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">isSource</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">isTarget</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">connector</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Straight'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>

      jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_left'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Right'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> common<span class="token punctuation">)</span>

      jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_right'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">anchor</span><span class="token operator">:</span> <span class="token string">'Left'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> common<span class="token punctuation">)</span>

      jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_right'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">anchor</span><span class="token operator">:</span> <span class="token string">'Right'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> common<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>一般来说拖动创建的链接，可以再次拖动，让链接断开。如果不想触发这种行为，可以设置</p> 
<pre><code class="prism language-javascript">jsPlumb<span class="token punctuation">.</span><span class="token function">importDefaults</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">ConnectionsDetachable</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="27_115"></a>2.7，限制节点拖动区域</h4> 
<p>默认情况下，节点可以被拖动到区域外边，如果想只能在区域内拖动，需要设置containment，这样节点只能在固定区域内移动。</p> 
<pre><code class="prism language-javascript">jsPlumb<span class="token punctuation">.</span><span class="token function">setContainer</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="28_121"></a>2.8，给链接添加点击事件：点击删除连线</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 请单点击一下连接线, </span>
<span class="token function">jsPlumb</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">conn<span class="token punctuation">,</span> originalEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">'确定删除所点击的链接吗？ 输入1确定'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'1'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   		 jsPlumb<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>jsPlumb支持许多事件，如下：<br> <code>connection</code><br> <code>connectionDetached</code><br> <code>connectionMoved</code><br> <code>click</code><br> <code>dblclick</code><br> <code>endpointClick</code><br> <code>endpointDblClick</code><br> <code>contextmenu</code><br> <code>beforeDrop</code><br> <code>beforeDetach</code><br> <code>zoom</code><br> <code>Connection Events</code><br> <code>Endpoint Events</code><br> <code>Overlay Events</code><br> <code>Unbinding Events</code></p> 
<h4><a id="29_147"></a>2.9，指定端点连接</h4> 
<p>初始化数据后，给节点加上了<code>endPoint</code>, 如果想编码让<code>endPoint</code>连接上。需要在<code>addEndpoint</code>方法时，就给该断点加上一个<code>uuid</code>, 然后通过<code>connect()</code>方法，将两个断点链接上。建议使用<code>node-uuid</code>给每个断点都加上唯一的<code>uuid</code>， 这样以后链接就方便多了。</p> 
<pre><code class="prism language-javascript">jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_left'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Right'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">uuid</span><span class="token operator">:</span> <span class="token string">'fromId'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_right'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Left'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">uuid</span><span class="token operator">:</span> <span class="token string">'toId'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3 秒后建立连线'</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  jsPlumb<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">uuids</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'fromId'</span><span class="token punctuation">,</span> <span class="token string">'toId'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="210_166"></a>2.10，一个端点拖拽出多条连线</h4> 
<p>默认情况下，<code>maxConnections</code>的值是<code>1</code>，也就是一个端点最多只能拉出一条连线。<br> 你也可以设置成其他值，例如<code>5</code>，表示最多可以有<code>5</code>条连线。<br> 如果你想不限制连线的数量，那么可以将该值设置为<code>-1</code>。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> common <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">isSource</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isTarget</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">connector</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Straight'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxConnections</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>

jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span><span class="token string">'item_left'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Right'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> common<span class="token punctuation">)</span>
</code></pre> 
<p>其余的一些配置项可以去官方文档看，下面直接贴我的demo代码了</p> 
<h4><a id="3_185"></a>3，实现代码</h4> 
<hr> 
<p><a href="https://img-blog.csdnimg.cn/20191020201722796.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BkZDExOTk3MTEwMTAz,size_16,color_FFFFFF,t_70" rel="nofollow">demo界面很简单，左侧是初始元素，右侧是拖拽层，点击可查看图片</a></p> 
<h4><a id="31_188"></a>3.1，先初始化</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 初始化jsplumb</span>
<span class="token keyword">var</span> firstInstance <span class="token operator">=</span> jsPlumb<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="32_193"></a>3.2，设置连线和端点的样式**</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> LineStyle <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//是否可以拖动（作为连线起点）</span>
    <span class="token literal-property property">isSource</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">//是否可以放置（连线终点）</span>
    <span class="token literal-property property">isTarget</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">//连线类型=&gt;流程线：Flowchart、直线：Straight、贝塞尔：Bezier、曲线：curviness</span>
    <span class="token literal-property property">connector</span><span class="token operator">:</span> <span class="token string">"Flowchart"</span><span class="token punctuation">,</span>
    <span class="token comment">//端点的颜色样式</span>
    <span class="token literal-property property">paintStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token string">"black"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//设置端点的类型，大小、css类名、浮动上去的css类名</span>
    <span class="token literal-property property">endpoint</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"Dot"</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token literal-property property">cssClass</span><span class="token operator">:</span><span class="token string">"initial_endpoint"</span><span class="token punctuation">,</span><span class="token literal-property property">hoverClass</span><span class="token operator">:</span><span class="token string">"hover_endpoint"</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">//设置连线的颜色、粗细、间隔</span>
    <span class="token literal-property property">connectorStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span> <span class="token literal-property property">strokeWidth</span><span class="token operator">:</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token literal-property property">dashstyle</span><span class="token operator">:</span> <span class="token string">"0"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//设置连线hover颜色</span>
    <span class="token literal-property property">connectorHoverStyle</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token string">"red"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 设置端点最多可以连接几条线</span>
    <span class="token literal-property property">maxConnections</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token comment">// 设置连线中间的自定义节点和箭头</span>
    <span class="token literal-property property">connectorOverlays</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">"Custom"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
          <span class="token function-variable function">create</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">component</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"&lt;div class='event_node'&gt;&lt;span class='glyphicon glyphicon-plus'&gt;&lt;/span&gt;&lt;/div&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment">//节点在线上的位置</span>
          <span class="token literal-property property">location</span><span class="token operator">:</span><span class="token number">0.5</span><span class="token punctuation">,</span>
          <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">"customOverlay"</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'Arrow'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
            <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token number">0.8</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>在连线上面我设置了一个箭头和一个自定义的dom元素。</p> 
<h4><a id="33_232"></a>3.3，左侧初始元素开启拖动</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 左边开启拖动</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".initial_option"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">draggable</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">helper</span><span class="token operator">:</span> <span class="token string">"clone"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pcope</span><span class="token operator">:</span> <span class="token string">"pdd"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">cursor</span><span class="token operator">:</span> <span class="token string">"move"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">cursorAt</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 限制拖拽范围</span>
    <span class="token literal-property property">containment</span><span class="token operator">:</span> <span class="token string">"#flow_box"</span><span class="token punctuation">,</span>
    <span class="token comment">// 元素从左边拖动时</span>
    <span class="token function-variable function">drag</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"不要停"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这里用到了<code>jquery-ui</code>的拖拽</p> 
<h4><a id="34_251"></a>3.4，在右侧界面放置节点</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 右边放置</span>
<span class="token keyword">var</span> ling <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#flow_right"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">droppable</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">pcope</span><span class="token operator">:</span> <span class="token string">"pdd"</span><span class="token punctuation">,</span>
    <span class="token function-variable function">drop</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span>ui</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> <span class="token constant">L</span> <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>ui<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>left <span class="token operator">-</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>ui<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>top <span class="token operator">-</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 控制放置位置</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">L</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token constant">L</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">T</span><span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">T</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> name <span class="token operator">=</span> ui<span class="token punctuation">.</span>draggable<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        <span class="token keyword">var</span> pid；
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token string">'proposer_node'</span><span class="token operator">:</span>
                ling<span class="token operator">++</span><span class="token punctuation">;</span>
                name <span class="token operator">=</span> <span class="token string">'申请人'</span><span class="token punctuation">;</span>
                pid <span class="token operator">=</span> <span class="token string">'proposer_node'</span><span class="token operator">+</span>ling<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'examine_node'</span><span class="token operator">:</span>
                ling<span class="token operator">++</span><span class="token punctuation">;</span>
                name <span class="token operator">=</span> <span class="token string">'审批节点'</span>
                pid <span class="token operator">=</span> <span class="token string">'examine_node'</span><span class="token operator">+</span>ling<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'write_node'</span><span class="token operator">:</span>
                ling<span class="token operator">++</span><span class="token punctuation">;</span>
                name <span class="token operator">=</span> <span class="token string">'填写节点'</span>
                pid <span class="token operator">=</span> <span class="token string">'write_node'</span><span class="token operator">+</span>ling<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'copy_node'</span><span class="token operator">:</span>
                ling<span class="token operator">++</span><span class="token punctuation">;</span>
                name <span class="token operator">=</span> <span class="token string">'抄送节点'</span>
                pid <span class="token operator">=</span> <span class="token string">'copy_node'</span><span class="token operator">+</span>ling<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">'branch_node'</span><span class="token operator">:</span>
                ling<span class="token operator">++</span><span class="token punctuation">;</span>
                name <span class="token operator">=</span> <span class="token string">'分支'</span>
                pid <span class="token operator">=</span> <span class="token string">'branch_node'</span><span class="token operator">+</span>ling<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> pnode <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div class='new_node' id='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>pid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">' style='top: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span><span class="token constant">T</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px;left: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span><span class="token constant">L</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px'&gt;
						&lt;p&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
						&lt;span class='node_delete' data-pid='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>pid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'&gt;X&lt;/span&gt;
						&lt;span class="node_set glyphicon glyphicon-cog" data-pid='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>pid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'&gt;&lt;/span&gt;
					&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token comment">//添加进右侧</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>pnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"TopCenter"</span><span class="token punctuation">,</span> <span class="token literal-property property">uuid</span><span class="token operator">:</span>pid<span class="token operator">+</span><span class="token string">"1"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
            jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"RightMiddle"</span><span class="token punctuation">,</span> <span class="token literal-property property">uuid</span><span class="token operator">:</span>pid<span class="token operator">+</span><span class="token string">"2"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
            jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"BottomCenter"</span><span class="token punctuation">,</span> <span class="token literal-property property">uuid</span><span class="token operator">:</span>pid<span class="token operator">+</span><span class="token string">"3"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
            jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"LeftMiddle"</span><span class="token punctuation">,</span> <span class="token literal-property property">uuid</span><span class="token operator">:</span>pid<span class="token operator">+</span><span class="token string">"4"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">//开启拖拽并限制范围</span>
        jsPlumb<span class="token punctuation">.</span><span class="token function">draggable</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">containment</span><span class="token operator">:</span> <span class="token string">'flow_box'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">stop</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"拖动停止了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="35_316"></a>3.5，鼠标进入和移出新节点时显示删除和设置按钮</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 鼠标进入和移出新节点时显示删除和设置按钮</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#flow_right"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"mouseenter"</span><span class="token punctuation">,</span><span class="token string">".new_node"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> pid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".node_delete[data-pid="</span><span class="token operator">+</span>pid<span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span><span class="token string">"block"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".node_set[data-pid="</span><span class="token operator">+</span>pid<span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span><span class="token string">"block"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"mouseleave"</span><span class="token punctuation">,</span><span class="token string">".new_node"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> pid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".node_delete[data-pid="</span><span class="token operator">+</span>pid<span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span><span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".node_set[data-pid="</span><span class="token operator">+</span>pid<span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"display"</span><span class="token punctuation">,</span><span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="36_330"></a>3.6点击删除按钮删除节点</h4> 
<pre><code class="prism language-javascript"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#flow_right"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span><span class="token string">".node_delete"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ev<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> pid <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">"pid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"确认删除该节点及连线吗？"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token operator">+</span>pid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jsPlumb<span class="token punctuation">.</span><span class="token function">removeAllEndpoints</span><span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="37_342"></a>3.7，双击删除连线</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 双击删除连线</span>
<span class="token function">jsPlumb</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">'dblclick'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">conn<span class="token punctuation">,</span>originalEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'确定删除所点击的连线吗？'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        jsPlumb<span class="token punctuation">.</span><span class="token function">deleteConnection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="38_351"></a>3.8，点击保存按钮</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 点击保存</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".flow_save"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"ling"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'ling'</span><span class="token punctuation">,</span>ling<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"保存成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 右侧连线图存储为JSON的方法</span>
<span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 端点和连线数据</span>
    <span class="token keyword">var</span> connects <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    $<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>jsPlumb<span class="token punctuation">.</span><span class="token function">getAllConnections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">idx<span class="token punctuation">,</span>connection</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        connects<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">ConnectionId</span><span class="token operator">:</span> connection<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
            <span class="token literal-property property">PageSourceId</span><span class="token operator">:</span> connection<span class="token punctuation">.</span>sourceId<span class="token punctuation">,</span>
            <span class="token literal-property property">PageTargetId</span><span class="token operator">:</span> connection<span class="token punctuation">.</span>targetId<span class="token punctuation">,</span>
            <span class="token literal-property property">Uuids</span><span class="token operator">:</span> connection<span class="token punctuation">.</span><span class="token function">getUuids</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// dom节点数据</span>
    <span class="token keyword">var</span> blocks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#flow_right .new_node"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">idx<span class="token punctuation">,</span>elem</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> $elem <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        blocks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">BlockId</span><span class="token operator">:</span> $elem<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// 将 " 换成 '</span>
            <span class="token literal-property property">BlockContent</span><span class="token operator">:</span> $elem<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">"</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">BlockX</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>$elem<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">BlockY</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>$elem<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">"top"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 解决获取html后的换行符空格问题</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>blocks<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		blocks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockContent <span class="token operator">=</span> blocks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockContent<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\t\n]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blocks<span class="token punctuation">)</span>
	<span class="token comment">// 将数据转换格式后存储</span>
    <span class="token keyword">let</span> ligature <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>connects<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将多出来的 \ 去掉</span>
    <span class="token keyword">let</span> node <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>blocks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'ligature'</span><span class="token punctuation">,</span>ligature<span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">,</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ligature："</span><span class="token operator">+</span>ligature<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"node："</span><span class="token operator">+</span>node<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="39_401"></a>3.9，点击删除按钮</h4> 
<pre><code class="prism language-javascript"><span class="token comment">// 点击删除</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".flow_delete"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"ligature"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"node"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">"ling"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"清除成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="310json_411"></a>3.10，页面加载时识别缓存的json节点信息并还原</h4> 
<pre><code class="prism language-javascript"><span class="token comment">//页面加载时识别缓存JSON</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    ling <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'ling'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'ligature'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> ligature <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'ligature'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> node <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 节点的模板渲染</span>
        <span class="token keyword">let</span> html_node <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script type="text/x-jsrender" id="html_node"&gt;
                            &lt;div class='new_node' id='{<!-- -->{:BlockId}}' style='top: {<!-- -->{:BlockY}}px;left: {<!-- -->{:BlockX}}px'&gt;
                                {<!-- -->{:BlockContent}}
                            &lt;/div&gt;
                        &lt;/script&gt;</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#html_node'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>html_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> pnode <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#html_node'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#flow_right"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>pnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将节点的端点还原</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>node<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"TopCenter"</span><span class="token punctuation">,</span><span class="token literal-property property">uuid</span><span class="token operator">:</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token operator">+</span><span class="token string">"1"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"RightMiddle"</span><span class="token punctuation">,</span><span class="token literal-property property">uuid</span><span class="token operator">:</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token operator">+</span><span class="token string">"2"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"BottomCenter"</span><span class="token punctuation">,</span><span class="token literal-property property">uuid</span><span class="token operator">:</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token operator">+</span><span class="token string">"3"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                jsPlumb<span class="token punctuation">.</span><span class="token function">addEndpoint</span><span class="token punctuation">(</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">anchors</span><span class="token operator">:</span> <span class="token string">"LeftMiddle"</span><span class="token punctuation">,</span><span class="token literal-property property">uuid</span><span class="token operator">:</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token operator">+</span><span class="token string">"4"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                jsPlumb<span class="token punctuation">.</span><span class="token function">draggable</span><span class="token punctuation">(</span>node<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlockId<span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">containment</span><span class="token operator">:</span> <span class="token string">'flow_box'</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">stop</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"拖动停止了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 将节点的连线还原</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>ligature<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            jsPlumb<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                jsPlumb<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">uuids</span><span class="token operator">:</span><span class="token punctuation">[</span>ligature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Uuids<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ligature<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Uuids<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>LineStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><a href="https://download.csdn.net/download/pdd11997110103/11889049">附上demo源码</a></p> 
<hr> 
<p><strong>如果看了觉得有帮助的，我是@上进的鹏多多，欢迎 点赞 关注 评论；END</strong></p> 
<p><mark>往期文章</mark></p> 
<ul><li><a href="https://blog.csdn.net/pdd11997110103/article/details/128442695">vue2的指令和自定义指令</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/121667524">Vue2全家桶+Element搭建的PC端在线音乐网站</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/122440666">vue3+element-plus配置cdn</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/121035412">助你上手Vue3全家桶之Vue3教程</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/121036145">助你上手Vue3全家桶之VueX4教程</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/121036684">助你上手Vue3全家桶之Vue-Router4教程</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/113563786">超详细！Vue的九种通信方式</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/118677514">超详细！Vuex手把手教程</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/115981856">使用nvm管理node.js版本以及更换npm淘宝镜像源</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/116002824">vue中利用.env文件存储全局环境变量，以及配置vue启动和打包命令</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/119386246">超详细！Vue-Router手把手教程</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/111034289">微信小程序实现上传多张本地图片到服务器和图片预览</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/108003214">JS实用方法DataUrl转为File、url转base64</a></li><li><a href="https://blog.csdn.net/pdd11997110103/article/details/112706127">微信小程序API交互的自定义封装</a></li></ul> 
<p><mark>个人主页</mark></p> 
<ul><li><a href="https://blog.csdn.net/pdd11997110103?spm=1010.2135.3001.5421">CSDN</a></li><li><a href="https://github.com/wp993080086">GitHub</a></li><li><a href="https://www.jianshu.com/u/b7a8536bff06" rel="nofollow">简书</a></li><li><a href="https://www.cnblogs.com/-pdd/" rel="nofollow">博客园</a></li><li><a href="https://juejin.cn/user/747323639737191" rel="nofollow">掘金</a></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2c00391c1ed4274dda6013e3659648c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">el-table / u-table 大屏自动滚动</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d432f092730e83f60a558b46a4675cfb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Flutter GetX系列教程---国际化配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>