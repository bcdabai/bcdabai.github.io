<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>nsenter教程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="nsenter教程" />
<meta property="og:description" content="原文链接
介绍 nsenter是用来进入容器内部的一个命令，它的优势之处在于可以自己选择加载容器的那些namespaces。 说直白一点就是 排查docker容器可以具备inux宿主命令的的方法。 一典型的用途容器网络命令空间。容器为了轻量级，不包含基础的命令，如说 ip address，ping，telnet，ss，tcpdump 等，给调试容器网络带来很大困扰：只能通过 docker inspect ContainerID 获取容器IP，无法测试和其他网络的连通性。这时使用nsenter命令仅进入该容器的网络命名空间，使用宿主机的命令调试容器网络。nsenter也可以进入 mnt, uts, ipc, pid, user 命令空间，指定根目录和工作目录。 namespace是Linux中一些进程的属性的作用域，使用命名空间，可以隔离不同的进程。 1、nsenter的安装 yum install util-linux -y 2、nsenter的使用 [root@localhost ~]# nsenter --help 用法： nsenter [options] &lt;program&gt; [&lt;argument&gt;...] Run a program with namespaces of other processes. 选项： -t, --target &lt;pid&gt; 要获取名字空间的目标进程 -m, --mount[=&lt;file&gt;] enter mount namespace -u, --uts[=&lt;file&gt;] enter UTS namespace (hostname etc) -i, --ipc[=&lt;file&gt;] enter System V IPC namespace -n, --net[=&lt;file&gt;] enter network namespace -p, --pid[=&lt;file&gt;] enter pid namespace -U, --user[=&lt;file&gt;] enter user namespace -S, --setuid &lt;uid&gt; set uid in entered namespace -G, --setgid &lt;gid&gt; set gid in entered namespace --preserve-credentials do not touch uids or gids -r, --root[=&lt;dir&gt;] set the root directory -w, --wd[=&lt;dir&gt;] set the working directory -F, --no-fork 执行 &lt;程序&gt; 前不 fork -Z, --follow-context set SELinux context according to --target PID -h, --help 显示此帮助并退出 -V, --version 输出版本信息并退出 中文说明 --mount参数是进去到mount namespace中 --uts参数是进入到uts namespace中 --ipc参数是进入到System V IPC namaspace中 --net参数是进入到network namespace中 --pid参数是进入到pid namespace中 --user参数是进入到user namespace中 nsenter命令要获取到docker容器的进程，然后再使用nsenter工具进去到docker容器中 # docker inspect -f {{." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f5d2959bc3db24723f92fb1f1d8ac7d5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-06T14:15:23+08:00" />
<meta property="article:modified_time" content="2023-06-06T14:15:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">nsenter教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><a href="https://www.cnblogs.com/edeny/p/15247306.html" rel="nofollow">原文链接</a></p> 
<h3><a id="_1"></a>介绍</h3> 
<pre><code class="prism language-bash">nsenter是用来进入容器内部的一个命令，它的优势之处在于可以自己选择加载容器的那些namespaces。
说直白一点就是 排查docker容器可以具备inux宿主命令的的方法。

一典型的用途容器网络命令空间。容器为了轻量级，不包含基础的命令，如说 <span class="token function">ip</span> address，ping，telnet，ss，tcpdump 等，给调试容器网络带来很大困扰：只能通过 <span class="token function">docker</span> inspect ContainerID 获取容器IP，无法测试和其他网络的连通性。这时使用nsenter命令仅进入该容器的网络命名空间，使用宿主机的命令调试容器网络。nsenter也可以进入 mnt, uts, ipc, pid, user 命令空间，指定根目录和工作目录。

namespace是Linux中一些进程的属性的作用域，使用命名空间，可以隔离不同的进程。
</code></pre> 
<h4><a id="1nsenter_12"></a>1、nsenter的安装</h4> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> util-linux -y
</code></pre> 
<h4><a id="2nsenter_18"></a>2、nsenter的使用</h4> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># nsenter --help</span>

用法：
 nsenter <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>program<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>argument<span class="token operator">&gt;</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span>

Run a program with namespaces of other processes.

选项：
 -t, --target <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>     要获取名字空间的目标进程
 -m, --mount<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>   enter <span class="token function">mount</span> namespace
 -u, --uts<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>     enter UTS namespace <span class="token punctuation">(</span>hostname etc<span class="token punctuation">)</span>
 -i, --ipc<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>     enter System V IPC namespace
 -n, --net<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>     enter network namespace
 -p, --pid<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>     enter pid namespace
 -U, --user<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span><span class="token punctuation">]</span>    enter user namespace
 -S, --setuid <span class="token operator">&lt;</span>uid<span class="token operator">&gt;</span>     <span class="token builtin class-name">set</span> uid <span class="token keyword">in</span> entered namespace
 -G, --setgid <span class="token operator">&lt;</span>gid<span class="token operator">&gt;</span>     <span class="token builtin class-name">set</span> gid <span class="token keyword">in</span> entered namespace
     --preserve-credentials <span class="token keyword">do</span> not <span class="token function">touch</span> uids or gids
 -r, --root<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>dir<span class="token operator">&gt;</span><span class="token punctuation">]</span>     <span class="token builtin class-name">set</span> the root directory
 -w, --wd<span class="token punctuation">[</span><span class="token operator">=</span><span class="token operator">&lt;</span>dir<span class="token operator">&gt;</span><span class="token punctuation">]</span>       <span class="token builtin class-name">set</span> the working directory
 -F, --no-fork          执行 <span class="token operator">&lt;</span>程序<span class="token operator">&gt;</span> 前不 fork
 -Z, --follow-context   <span class="token builtin class-name">set</span> SELinux context according to --target PID

 -h, --help     显示此帮助并退出
 -V, --version  输出版本信息并退出

中文说明
--mount参数是进去到mount namespace中
 --uts参数是进入到uts namespace中
 --ipc参数是进入到System V IPC namaspace中
 --net参数是进入到network namespace中
 --pid参数是进入到pid namespace中
 --user参数是进入到user namespace中
</code></pre> 
<pre><code class="prism language-bash">nsenter命令要获取到docker容器的进程，然后再使用nsenter工具进去到docker容器中
<span class="token comment"># docker inspect -f {<!-- -->{.State.Pid}} 容器名或者容器id   #查询容器的PID</span>
<span class="token comment"># nsenter -t 容器PID(容器名)  -m -u -i -n -p  #输入该命令进入容器</span>

示例：
<span class="token comment"># 起一个Nginx镜像</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker run -p 80:80 -d --name nginx nginx</span>
<span class="token comment"># 查看pid</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># docker inspect -f {<!-- -->{.State.Pid}} nginx</span>
<span class="token number">4552</span>
</code></pre> 
<h4><a id="3_69"></a>3、说明</h4> 
<p>进入容器，使用宿主机的namespace进行排错，就可以排错linux宿主机一样进行容器排错了。<br> <img src="https://images2.imgbox.com/7c/40/fUZgS6zi_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5880602603f2dbd6018ec9319e476e3a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux 常用命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c185a575a0be2d39fea749738dae029f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">yolov8_seg分割模型训练自己数据集</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>