<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Git分支批量清理利器：自定义命令行插件实战 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Git分支批量清理利器：自定义命令行插件实战" />
<meta property="og:description" content="说在前面 不知道大家平时工作的时候会不会需要经常新建git分支来开发新需求呢？在我这边工作的时候，需求都是以issue的形式来进行开发，每个issue新建一个关联的分支来进行开发，这样可以通过issue看到一个需求完整的开发记录，便于后续需求回顾和需求回退。而我平时本地分支都不怎么清理，这就导致了我这两年来本地分支的数量达到了惊人的361个，所以便开始写了这个可以批量删除分支的命令行工具。
功能设计 我们希望可以通过命令行命令的方式来进行交互，快速获取本地分支列表及各分支的最后提交时间和合并状态，在控制台选择我们想要删除的分支。
功能实现 1、命令行交互获取相关参数 这里我们使用@jyeontu/j-inquirer模块来完成命令行交互功能，@jyeontu/j-inquirer模块除了支持inquirer模块的所有交互类型，还扩展了文件选择器、文件夹选择器及多级选择器交互类型，具体介绍可以查看文档：https://www.npmjs.com/package/@jyeontu/j-inquirer
（1）获取操作分支类型 我们的分支分为本地分支和远程分支，这里我们可以选择我们需要操作的分支类型，选择列表为：&#34;本地分支&#34;、&#34;远程分支&#34;、&#34;本地&#43;远程&#34;。
（2）获取远程仓库名（remote） 我们可以输入自己git的远程仓库名，默认为origin。
（3）获取生产分支名 我们需要判断各分支是否已经合并到生产分支，所以需要输入自己项目的生产分支名，默认为develop。
相关代码 const branchListOptions = [ { type: &#34;list&#34;, message: &#34;请选择要操作的分支来源：&#34;, name: &#34;branchType&#34;, choices: [&#34;本地分支&#34;, &#34;远程分支&#34;, &#34;本地&#43;远程&#34;], }, { type: &#34;input&#34;, message: &#34;请输入远程仓库名（默认为origin）：&#34;, name: &#34;gitRemote&#34;, default: &#34;origin&#34;, }, { type: &#34;input&#34;, message: &#34;请输入生产分支名（默认为develop）：&#34;, name: &#34;devBranch&#34;, default: &#34;develop&#34;, }, ]; const res = await doInquirer(branchListOptions); 2、命令行输出进度条 在分支过多的时候，获取分支信息的时间也会较长，所以我们需要在控制台中打印相关进度，避免用户以为控制台卡死了，如下图：
3、git操作 （1）获取git本地分支列表 想要获取当前仓库的所有的本地分支，我们可以使用git branch命令来获取：
function getLocalBranchList() { const command = &#34;git branch&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/30f4e37ff458467da5d5054e179d638c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-01T01:07:34+08:00" />
<meta property="article:modified_time" content="2023-12-01T01:07:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Git分支批量清理利器：自定义命令行插件实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>说在前面</h3> 
<blockquote> 
 <p>不知道大家平时工作的时候会不会需要经常新建git分支来开发新需求呢？在我这边工作的时候，需求都是以issue的形式来进行开发，每个issue新建一个关联的分支来进行开发，这样可以通过issue看到一个需求完整的开发记录，便于后续需求回顾和需求回退。而我平时本地分支都不怎么清理，这就导致了我这两年来本地分支的数量达到了惊人的361个，所以便开始写了这个可以批量删除分支的命令行工具。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/8f/4f/Psd6kKCo_o.png" alt="1697987090644.jpg"></p> 
<h3><a id="_5"></a>功能设计</h3> 
<p>我们希望可以通过命令行命令的方式来进行交互，快速获取本地分支列表及各分支的最后提交时间和合并状态，在控制台选择我们想要删除的分支。</p> 
<h3><a id="_8"></a>功能实现</h3> 
<h4><a id="1_9"></a>1、命令行交互获取相关参数</h4> 
<p>这里我们使用<code>@jyeontu/j-inquirer</code>模块来完成命令行交互功能，<code>@jyeontu/j-inquirer</code>模块除了支持<code>inquirer</code>模块的所有交互类型，还扩展了<strong>文件选择器</strong>、<strong>文件夹选择器</strong>及<strong>多级选择器</strong>交互类型，具体介绍可以查看文档：<a href="https://www.npmjs.com/package/@jyeontu/j-inquirer" rel="nofollow">https://www.npmjs.com/package/@jyeontu/j-inquirer</a></p> 
<h5><a id="1_12"></a>（1）获取操作分支类型</h5> 
<p>我们的分支分为本地分支和远程分支，这里我们可以选择我们需要操作的分支类型，选择列表为：<code>"本地分支"、"远程分支"、"本地+远程"</code>。</p> 
<h5><a id="2remote_14"></a>（2）获取远程仓库名（remote）</h5> 
<p>我们可以输入自己git的远程仓库名，默认为<code>origin</code>。</p> 
<h5><a id="3_16"></a>（3）获取生产分支名</h5> 
<p>我们需要判断各分支是否已经合并到生产分支，所以需要输入自己项目的生产分支名，默认为<code>develop</code>。</p> 
<h5><a id="_19"></a>相关代码</h5> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> branchListOptions <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"list"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"请选择要操作的分支来源："</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"branchType"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">choices</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"本地分支"</span><span class="token punctuation">,</span> <span class="token string">"远程分支"</span><span class="token punctuation">,</span> <span class="token string">"本地+远程"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"input"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"请输入远程仓库名（默认为origin）："</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"gitRemote"</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">"origin"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"input"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">"请输入生产分支名（默认为develop）："</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"devBranch"</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">"develop"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">doInquirer</span><span class="token punctuation">(</span>branchListOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/54/61/3oCZ6mPJ_o.png" alt="image.png"></p> 
<h4><a id="2_46"></a>2、命令行输出进度条</h4> 
<p>在分支过多的时候，获取分支信息的时间也会较长，所以我们需要在控制台中打印相关进度，避免用户以为控制台卡死了，如下图：</p> 
<p><img src="https://images2.imgbox.com/aa/e6/vq6FfRWL_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/ec/ce/RHaFzem1_o.png" alt="image.png"></p> 
<h4><a id="3git_54"></a>3、git操作</h4> 
<h5><a id="1git_55"></a>（1）获取git本地分支列表</h5> 
<p>想要获取当前仓库的所有的本地分支，我们可以使用<code>git branch</code>命令来获取：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">getLocalBranchList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> command <span class="token operator">=</span> <span class="token string">"git branch"</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> currentBranch <span class="token operator">=</span> <span class="token function">getCurrentBranch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> branch <span class="token operator">=</span> child_process
    <span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>trimReg<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rowReg<span class="token punctuation">,</span> <span class="token string">"、"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  branch <span class="token operator">=</span> branch
    <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"、"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item <span class="token operator">!==</span> <span class="token string">""</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>item<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"-&gt;"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> item <span class="token operator">!==</span> currentBranch
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> branch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="2_74"></a>（2）获取远程仓库分支列表</h5> 
<p>想要获取当前仓库的所有的远程分支，我们可以使用<code>git ls-remote --heads origin</code>命令来获取，<code>git ls-remote --heads origin</code> 命令将显示远程仓库 <code>origin</code> 中所有分支的引用信息。其中，每一行显示一个引用，包括提交哈希值和引用的全名（格式为 <code>refs/heads/&lt;branch_name&gt;</code>）。</p> 
<p>示例输出可能如下所示：</p> 
<pre><code>Copy Code
&lt;commit_hash&gt;        refs/heads/master
&lt;commit_hash&gt;        refs/heads/develop
&lt;commit_hash&gt;        refs/heads/feature/xyz
</code></pre> 
<p>其中，<code>&lt;commit_hash&gt;</code> 是每个分支最新提交的哈希值。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">getRemoteList</span><span class="token punctuation">(</span><span class="token parameter">gitRemote</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> command <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">git ls-remote --heads </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>gitRemote<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> branchList <span class="token operator">=</span> child_process
    <span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>trimReg<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rowReg<span class="token punctuation">,</span> <span class="token string">"、"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  branchList <span class="token operator">=</span> branchList
    <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"、"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"refs/heads/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">branch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> gitRemote <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> branch<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"refs/heads/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> branchList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="3_105"></a>（3）获取各分支详细信息</h5> 
<p>我们想要在每个分支后面显示该分支最后提交时间和是否已经合并到生产分支，这两个信息可以作为我们判断该分支是否要删除的一个参考。</p> 
<ul><li>获取分支最后提交时间<br> <code>git show -s --format=%ci &lt;branchName&gt;</code> 命令用于查看 指定 分支最新提交的提交时间。其中，<code>--format=%ci</code> 用于指定输出格式为提交时间。</li></ul> 
<p>在 Git 中，<code>git show</code> 命令用于显示某次提交的详细信息，包括作者、提交时间、修改内容等。通过使用 <code>-s</code> 参数，我们只显示提交摘要信息，而不显示修改内容。</p> 
<p><code>git show -s --format=%ci develop</code> 命令将显示 <code>develop</code> 分支最新提交的提交时间。输出格式为 ISO 8601 标准的时间戳，例如 <code>2023-10-22 16:41:47 +0800</code>。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">getBranchLastCommitTime</span><span class="token punctuation">(</span><span class="token parameter">branchName</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> command <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">git show -s --format=%ci </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>branchName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> child_process<span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> date <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> date<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> date<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token string">"未获取到时间"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>判断分支是否合并到生产分支<br> <code>git branch --contains &lt;branchName&gt;</code> 命令用于查找包含指定分支（<code>&lt;branchName&gt;</code>）的所有分支。</li></ul> 
<p>在 Git 中，<code>git branch</code> 命令用于管理分支。通过使用 <code>--contains</code> 参数，我们可以查找包含指定提交或分支的所有分支。</p> 
<p><code>git branch --contains &lt;branchName&gt;</code> 命令将列出包含 <code>&lt;branchName&gt;</code> 的所有分支。输出结果将显示每个分支的名称以及指定分支是否为当前分支。</p> 
<p>示例输出可能如下所示：</p> 
<pre><code>Copy Code
  develop
* feature/xyz
  bugfix/123
</code></pre> 
<p>其中，<code>*</code> 标记表示当前所在的分支，我们只需要判断输出的分支中是否存在生产分支即可：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">isMergedCheck</span><span class="token punctuation">(</span><span class="token parameter">branch</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> command <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">git branch --contains </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>branch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> child_process
      <span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>trimReg<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rowReg<span class="token punctuation">,</span> <span class="token string">"、"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> mergedList <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"、"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mergedList<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>gitInfoObj<span class="token punctuation">.</span>devBranch<span class="token punctuation">)</span>
      <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">已合并到</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>gitInfoObj<span class="token punctuation">.</span>devBranch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token string">"未获取到合并状态"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4_162"></a>（4）删除选中分支</h5> 
<p>选完分支后我们就该来删除分支了，删除分支的命令大家应该就比较熟悉了吧</p> 
<ul><li>git branch -D &lt;branchName&gt;</li></ul> 
<p><code>git branch -D &lt;branchName&gt;</code> 命令用于强制删除指定的分支（<code>&lt;branchName&gt;</code>）。该命令会删除本地仓库中的指定分支，无法恢复已删除的分支。</p> 
<ul><li>git push &lt;remote&gt; :&lt;branchName&gt;</li></ul> 
<p><code>git push &lt;remote&gt; :&lt;branchName&gt;</code> 命令用于删除远程仓库<code>&lt;remote&gt;</code>中的指定分支（<code>&lt;branchName&gt;</code>）。这个命令通过推送一个空分支到远程仓库的 <code>&lt;branchName&gt;</code> 分支来实现删除操作。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">doDeleteBranch</span><span class="token punctuation">(</span><span class="token parameter">branchList</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> deleteBranchList <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getDeleteBranch</span><span class="token punctuation">(</span>branchList<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deleteBranchList<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"正在删除分支"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  progressBar<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  deleteBranchList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">branch<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> command <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">git branch -D </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>branch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>branch<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> tmp <span class="token operator">=</span> branch<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      command <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">git push </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> :</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    child_process<span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
    progressBar<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> deleteBranchList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"已删除分支："</span> <span class="token operator">+</span> deleteBranchList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/37/73/i1RMYeLN_o.png" alt="image.png"></p> 
<p><img src="https://images2.imgbox.com/0f/40/IHrbWwDo_o.png" alt="1697995985140.png"></p> 
<p><img src="https://images2.imgbox.com/b3/38/1UsprozG_o.png" alt="1697996057503.jpg"></p> 
<p>可以看到我们的分支瞬间就清爽了很多。</p> 
<h3><a id="_202"></a>使用</h3> 
<p>该工具已经发布到 <a href="https://www.npmjs.com/package/jyeontu" rel="nofollow">npm</a> 上，可以直接通过命令<code>npm i -g jyeontu</code>进行安装，安装完后在控制台中输入<code>jyeontu git</code>即可进行操作。</p> 
<h3><a id="_205"></a>源码</h3> 
<p>该工具的源码也已经开源，有兴趣的同学可以到Gitee上查看：<a href="https://gitee.com/zheng_yongtao/node-scripting-tool/tree/master/src/jyeontu" rel="nofollow">Gitee地址</a></p> 
<h3><a id="_209"></a>公众号</h3> 
<p>关注公众号『<code>前端也能这么有趣</code>』，获取更多新鲜内容。</p> 
<h3><a id="_213"></a>说在后面</h3> 
<blockquote> 
 <p>🎉 这里是 JYeontu，现在是一名前端工程师，有空会刷刷算法题，平时喜欢打羽毛球 🏸 ，平时也喜欢写些东西，既为自己记录 📋，也希望可以对大家有那么一丢丢的帮助，写的不好望多多谅解 🙇，写错的地方望指出，定会认真改进 😊，偶尔也会在自己的公众号『<code>前端也能这么有趣</code>』发一些比较有趣的文章，有兴趣的也可以关注下。在此谢谢大家的支持，我们下文再见 🙌。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e98730cc41cdd4aca8d486de348f5ead/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">finebi 新手入门案例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/df71c59d6886a2f87ef0dd8e45568a08/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CP2102usb与TJC3224T024_011的使用（串口模块与显示屏接线的屏幕调试）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>