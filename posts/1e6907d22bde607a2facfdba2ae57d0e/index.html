<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【mysql】使用sql将一个表的数据复制筛选部分行和列到另一个表去 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【mysql】使用sql将一个表的数据复制筛选部分行和列到另一个表去" />
<meta property="og:description" content=" 目录 事件起因总结的sql写法 过程执行的sql语句 事件起因 给客户的系统导入数据，涉及到一些初始的账户、部门、角色（用户与角色的对应关系表什么的），反正也就每个表几千条的样子吧
但是在写后端接口进行文件导入和写sql进行一些数据关联表的导入时出现了一个问题 怎样把一个表的数据比如说id放到另一个表中去
我们常规的插入语句：
insert into 表名（字段名1，字段名2....） values(字段名1数据，字段名2数据....) values(字段名1数据，字段名2数据.....) .... 要想插入多行只有继续向下写values（）
总结的sql写法 先将找到的一种sql语句写法写在这儿
insert into table1(fld1, fld2) select fld1, 5 from table2 where ... 插入语句后面接select语句 能够他批量插入一个集合的数据，字段名和顺序需要自己进行对应，里面有select语句也可使用where等sql语句进行一定的数据筛选，从而达到数据从一个表到另一个表的作用
这儿就涉及到另一个写法：
将一个表所有的数据内容直接复制到另一个表中去
select * into table1 from table2 该语句与上面的那个语句有一定的区别：
该语句要求table1表不存在，相当于完全创建了一个新的表，然后将table2表中的内容全部查询出来，然后复制了一份在table1表中去
而前面的第一条语句是对两个已经存在的表的操作，使用的insert into语句：
过程 前提（各个表的结构）
user表：
user和role（用户和角色的关系表）
使用 sql 语句将数据表中没有的用户角色关系导入到该表中去（怎样的一个执行过程说明）：
执行的sql语句 下面的语句执行的意思是（将sys_user表中还没有赋予角色的账户赋予一个默认角色id（100000） not in后面的集合就是之前查询出来的账户角色表中已有的用户角色关系的用户id（虽然这儿也可以用sql语句给代替））：
insert into sys_user_role(user_id,role_id) select user_id,100000 role_id from sys_user where user_id not in (1,12822,12823,12824,12825,12952,12953,12954,13030,13031,13032,13121,13122,13123,13304,13305,13306,13331,13332,13333,13334,13335,13336,13781,13782,13788,13794,13806,13807,13808,13809,13837,13868,13912,13915,13916,13922,13930,13932,13937,13939,13949,13968,14031,14102,14168,14206,14324,14328,14329,14332,14345,14346,14347,14351,14355,14358,14383,14388,14389,14453,14461,14462,14463,14476,14478,14479,14488,14559) " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1e6907d22bde607a2facfdba2ae57d0e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-22T16:31:01+08:00" />
<meta property="article:modified_time" content="2022-04-22T16:31:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【mysql】使用sql将一个表的数据复制筛选部分行和列到另一个表去</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">事件起因</a></li><li><ul><li><a href="#sql_16" rel="nofollow">总结的sql写法</a></li></ul> 
   </li><li><a href="#_32" rel="nofollow">过程</a></li><li><a href="#sql_41" rel="nofollow">执行的sql语句</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>事件起因</h3> 
<p>给客户的系统导入数据，涉及到一些初始的账户、部门、角色（用户与角色的对应关系表什么的），反正也就每个表几千条的样子吧</p> 
<p>但是在写后端接口进行文件导入和写sql进行一些数据关联表的导入时出现了一个问题 怎样把一个表的数据比如说id放到另一个表中去</p> 
<p>我们常规的插入语句：</p> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> 表名（字段名<span class="token number">1</span>，字段名<span class="token number">2.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>）
<span class="token keyword">values</span><span class="token punctuation">(</span>字段名<span class="token number">1</span>数据，字段名<span class="token number">2</span>数据<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">values</span><span class="token punctuation">(</span>字段名<span class="token number">1</span>数据，字段名<span class="token number">2</span>数据<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>要想插入多行只有继续向下写values（）</p> 
<h4><a id="sql_16"></a>总结的sql写法</h4> 
<p>先将找到的一种sql语句写法写在这儿</p> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> table1<span class="token punctuation">(</span>fld1<span class="token punctuation">,</span> fld2<span class="token punctuation">)</span> <span class="token keyword">select</span> fld1<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token keyword">from</span> table2 <span class="token keyword">where</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p>插入语句后面接select语句 能够他批量插入一个集合的数据，字段名和顺序需要自己进行对应，里面有select语句也可使用where等sql语句进行一定的数据筛选，从而达到数据从一个表到另一个表的作用</p> 
<p>这儿就涉及到另一个写法：<br> 将一个表所有的数据内容直接复制到另一个表中去</p> 
<pre><code>select * into table1 from table2
</code></pre> 
<p>该语句与上面的那个语句有一定的区别：<br> <font color="red">该语句要求table1表不存在</font>，相当于完全创建了一个新的表，然后将table2表中的内容全部查询出来，然后复制了一份在table1表中去</p> 
<p>而前面的第一条语句是对两个已经存在的表的操作，使用的insert into语句：</p> 
<h3><a id="_32"></a>过程</h3> 
<p>前提（各个表的结构）<br> user表：<br> <img src="https://images2.imgbox.com/1e/42/PiHWo2oa_o.png" alt="在这里插入图片描述"></p> 
<p>user和role（用户和角色的关系表）<br> <img src="https://images2.imgbox.com/1c/c1/vWMmHKQJ_o.png" alt="在这里插入图片描述"><br> 使用 sql 语句将数据表中没有的用户角色关系导入到该表中去（怎样的一个执行过程说明）：<br> <img src="https://images2.imgbox.com/b4/74/7AfTcTHp_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="sql_41"></a>执行的sql语句</h3> 
<p>下面的语句执行的意思是（将sys_user表中还没有赋予角色的账户赋予一个默认角色id（100000） not in后面的集合就是之前查询出来的账户角色表中已有的用户角色关系的用户id（虽然这儿也可以用sql语句给代替））：</p> 
<pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> sys_user_role<span class="token punctuation">(</span>user_id<span class="token punctuation">,</span>role_id<span class="token punctuation">)</span> 
<span class="token keyword">select</span> user_id<span class="token punctuation">,</span><span class="token number">100000</span> role_id
<span class="token keyword">from</span> sys_user 
<span class="token keyword">where</span> user_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12822</span><span class="token punctuation">,</span><span class="token number">12823</span><span class="token punctuation">,</span><span class="token number">12824</span><span class="token punctuation">,</span><span class="token number">12825</span><span class="token punctuation">,</span><span class="token number">12952</span><span class="token punctuation">,</span><span class="token number">12953</span><span class="token punctuation">,</span><span class="token number">12954</span><span class="token punctuation">,</span><span class="token number">13030</span><span class="token punctuation">,</span><span class="token number">13031</span><span class="token punctuation">,</span><span class="token number">13032</span><span class="token punctuation">,</span><span class="token number">13121</span><span class="token punctuation">,</span><span class="token number">13122</span><span class="token punctuation">,</span><span class="token number">13123</span><span class="token punctuation">,</span><span class="token number">13304</span><span class="token punctuation">,</span><span class="token number">13305</span><span class="token punctuation">,</span><span class="token number">13306</span><span class="token punctuation">,</span><span class="token number">13331</span><span class="token punctuation">,</span><span class="token number">13332</span><span class="token punctuation">,</span><span class="token number">13333</span><span class="token punctuation">,</span><span class="token number">13334</span><span class="token punctuation">,</span><span class="token number">13335</span><span class="token punctuation">,</span><span class="token number">13336</span><span class="token punctuation">,</span><span class="token number">13781</span><span class="token punctuation">,</span><span class="token number">13782</span><span class="token punctuation">,</span><span class="token number">13788</span><span class="token punctuation">,</span><span class="token number">13794</span><span class="token punctuation">,</span><span class="token number">13806</span><span class="token punctuation">,</span><span class="token number">13807</span><span class="token punctuation">,</span><span class="token number">13808</span><span class="token punctuation">,</span><span class="token number">13809</span><span class="token punctuation">,</span><span class="token number">13837</span><span class="token punctuation">,</span><span class="token number">13868</span><span class="token punctuation">,</span><span class="token number">13912</span><span class="token punctuation">,</span><span class="token number">13915</span><span class="token punctuation">,</span><span class="token number">13916</span><span class="token punctuation">,</span><span class="token number">13922</span><span class="token punctuation">,</span><span class="token number">13930</span><span class="token punctuation">,</span><span class="token number">13932</span><span class="token punctuation">,</span><span class="token number">13937</span><span class="token punctuation">,</span><span class="token number">13939</span><span class="token punctuation">,</span><span class="token number">13949</span><span class="token punctuation">,</span><span class="token number">13968</span><span class="token punctuation">,</span><span class="token number">14031</span><span class="token punctuation">,</span><span class="token number">14102</span><span class="token punctuation">,</span><span class="token number">14168</span><span class="token punctuation">,</span><span class="token number">14206</span><span class="token punctuation">,</span><span class="token number">14324</span><span class="token punctuation">,</span><span class="token number">14328</span><span class="token punctuation">,</span><span class="token number">14329</span><span class="token punctuation">,</span><span class="token number">14332</span><span class="token punctuation">,</span><span class="token number">14345</span><span class="token punctuation">,</span><span class="token number">14346</span><span class="token punctuation">,</span><span class="token number">14347</span><span class="token punctuation">,</span><span class="token number">14351</span><span class="token punctuation">,</span><span class="token number">14355</span><span class="token punctuation">,</span><span class="token number">14358</span><span class="token punctuation">,</span><span class="token number">14383</span><span class="token punctuation">,</span><span class="token number">14388</span><span class="token punctuation">,</span><span class="token number">14389</span><span class="token punctuation">,</span><span class="token number">14453</span><span class="token punctuation">,</span><span class="token number">14461</span><span class="token punctuation">,</span><span class="token number">14462</span><span class="token punctuation">,</span><span class="token number">14463</span><span class="token punctuation">,</span><span class="token number">14476</span><span class="token punctuation">,</span><span class="token number">14478</span><span class="token punctuation">,</span><span class="token number">14479</span><span class="token punctuation">,</span><span class="token number">14488</span><span class="token punctuation">,</span><span class="token number">14559</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/37/4f/sNei1Ku3_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d823ee6aced986c5f08817c0ae2762e6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Pubsub.js初使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/537afd973a58cde51d88821be240ef2c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">为了甩锅，我写了个牛逼的日志切面</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>