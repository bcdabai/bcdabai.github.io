<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>web前端设计模式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="web前端设计模式" />
<meta property="og:description" content="文章目录 浅谈设计模式1.设计模式是什么2.为什么要学设计模式3.SOLID设计原则4.设计模式的核心思想—封装变化5.23种常见设计模式 创建型一、工厂模式（Factory Pattern）简单工厂1.解决的问题：2.构造器3.使用步骤4.举例 抽象工厂 （Abstract Factory Pattern）举例 二、单例模式（Singleton Pattern）举例Vuex：单例模式的典型应用1. 概念2. 确保Store的唯一性 举例2 三、原型模式（Prototype Pattern）原型范式原型深拷贝 结构型一、装饰器模式（Decorator Pattern）举例 二、适配器模式（Adapter Pattern）三、代理模式（Proxy Pattern）应用1. 事件代理2. 图片预加载3. 缓存代理 举例 行为型一、策略模式（Strategy Pattern）举例 二、状态模式（State Pattern）举例 三、观察者模式（Observer Pattern）举例 四、迭代器模式（Iterator Pattern） 浅谈设计模式 1.设计模式是什么 先看看必应搜索出来的词条：
我个人认为设计模式就是前人在编程中经过不断的试错和踩坑所总结出来的方法和套路
2.为什么要学设计模式 先看看必应搜索出来的词条：
我的理由：
为了写出健壮性代码面试会考，而且常考 一个软件工程师驾驭技术的能力总共分为三个层次：
能用健壮的代码去解决具体的问题能用抽象的思维去应对复杂的系统能用工程化的思想去规划更大规模的业务 第一点是面对所有程序员，后两点更多的是面向团队中的负责架构的人员
3.SOLID设计原则 单一功能原则（Single Responsibility Principle）开放封闭原则（Opened Closed Principle）里式替换原则（Liskov Substitution Principle）接口隔离原则（Interface Segregation Principle）依赖反转原则（Dependency Inversion Principle） 4.设计模式的核心思想—封装变化 如果一个软件不需要进行迭代和版本更替，那我们再开发过程中只需要完成其功能就行，完全不用去考虑其可维护性和可拓展性。
但在通常开发中我们开发了一个软件，随着时间线的拉长，它会变得越来越复杂，体量也会越来越大。而我们所需要做的就是将他的变化造成的影响最小化——将变和不变分离，确保在维持软件原有功能情况下，完成新的功能增加和产品迭代，这个过程就叫封装变化
5.23种常见设计模式 这里我们并不需要把所有的设计模式都学透，从强语言迁移过来的设计模式并不是全部都是用于现在的前端，暂时只需要把几个重点的弄明白就行
创建型 一、工厂模式（Factory Pattern） 工厂模式其实就是将创建对象的过程单独封装
简单工厂 有构造函数的地方，我们就应该想到简单工厂
1.解决的问题： 将实例化的操作和使用对象的操作分开，让使用者不用知道具体的参数就可以实例化出所需要的产品类，避免了在客户端代码中显式指定，实现了解耦（使用者可以直接消费产品而不需要知道其生产细节）
2.构造器 通常创建对象：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/176eb08a09bb2755f880302cc76387ef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-06T23:17:44+08:00" />
<meta property="article:modified_time" content="2023-02-06T23:17:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">web前端设计模式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">浅谈设计模式</a></li><li><ul><li><a href="#1_3" rel="nofollow">1.设计模式是什么</a></li><li><a href="#2_10" rel="nofollow">2.为什么要学设计模式</a></li><li><a href="#3SOLID_25" rel="nofollow">3.SOLID设计原则</a></li><li><a href="#4_32" rel="nofollow">4.设计模式的核心思想—封装变化</a></li><li><a href="#523_38" rel="nofollow">5.23种常见设计模式</a></li></ul> 
  </li><li><a href="#_42" rel="nofollow">创建型</a></li><li><ul><li><a href="#Factory_Pattern_43" rel="nofollow">一、工厂模式（Factory Pattern）</a></li><li><ul><li><a href="#_45" rel="nofollow">简单工厂</a></li><li><ul><li><a href="#1_47" rel="nofollow">1.解决的问题：</a></li><li><a href="#2_49" rel="nofollow">2.构造器</a></li><li><a href="#3_70" rel="nofollow">3.使用步骤</a></li><li><a href="#4_97" rel="nofollow">4.举例</a></li></ul> 
    </li><li><a href="#_Abstract_Factory_Pattern_128" rel="nofollow">抽象工厂 （Abstract Factory Pattern）</a></li><li><ul><li><a href="#_133" rel="nofollow">举例</a></li></ul> 
   </li></ul> 
   </li><li><a href="#Singleton_Pattern_213" rel="nofollow">二、单例模式（Singleton Pattern）</a></li><li><ul><li><a href="#_216" rel="nofollow">举例</a></li><li><a href="#Vuex_258" rel="nofollow">Vuex：单例模式的典型应用</a></li><li><ul><li><a href="#1__259" rel="nofollow">1. 概念</a></li><li><a href="#2_Store_267" rel="nofollow">2. 确保Store的唯一性</a></li></ul> 
    </li><li><a href="#2_291" rel="nofollow">举例2</a></li></ul> 
   </li><li><a href="#Prototype_Pattern_351" rel="nofollow">三、原型模式（Prototype Pattern）</a></li><li><ul><li><a href="#_359" rel="nofollow">原型范式</a></li><li><a href="#_362" rel="nofollow">原型</a></li><li><a href="#_367" rel="nofollow">深拷贝</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_370" rel="nofollow">结构型</a></li><li><ul><li><a href="#Decorator_Pattern_371" rel="nofollow">一、装饰器模式（Decorator Pattern）</a></li><li><ul><li><a href="#_376" rel="nofollow">举例</a></li></ul> 
   </li><li><a href="#Adapter_Pattern_481" rel="nofollow">二、适配器模式（Adapter Pattern）</a></li><li><a href="#Proxy_Pattern_487" rel="nofollow">三、代理模式（Proxy Pattern）</a></li><li><ul><li><a href="#_494" rel="nofollow">应用</a></li><li><ul><li><a href="#1__495" rel="nofollow">1. 事件代理</a></li><li><a href="#2__527" rel="nofollow">2. 图片预加载</a></li><li><a href="#3__567" rel="nofollow">3. 缓存代理</a></li></ul> 
    </li><li><a href="#_600" rel="nofollow">举例</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_653" rel="nofollow">行为型</a></li><li><ul><li><a href="#Strategy_Pattern_654" rel="nofollow">一、策略模式（Strategy Pattern）</a></li><li><ul><li><a href="#_659" rel="nofollow">举例</a></li></ul> 
   </li><li><a href="#State_Pattern_669" rel="nofollow">二、状态模式（State Pattern）</a></li><li><ul><li><a href="#_675" rel="nofollow">举例</a></li></ul> 
   </li><li><a href="#Observer_Pattern_728" rel="nofollow">三、观察者模式（Observer Pattern）</a></li><li><ul><li><a href="#_735" rel="nofollow">举例</a></li></ul> 
   </li><li><a href="#Iterator_Pattern_783" rel="nofollow">四、迭代器模式（Iterator Pattern）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>浅谈设计模式</h2> 
<h3><a id="1_3"></a>1.设计模式是什么</h3> 
<p>先看看必应搜索出来的词条：</p> 
<p><img src="https://images2.imgbox.com/de/c9/XxuiJM3l_o.png" alt="在这里插入图片描述"><br> 我个人认为设计模式就是前人在编程中经过不断的试错和踩坑所总结出来的<code>方法和套路</code></p> 
<h3><a id="2_10"></a>2.为什么要学设计模式</h3> 
<p>先看看必应搜索出来的词条：<br> <img src="https://images2.imgbox.com/42/36/r7Qn3Jox_o.png" alt="在这里插入图片描述"><br> 我的理由：</p> 
<ul><li>为了写出健壮性代码</li><li>面试会考，而且常考</li></ul> 
<p>一个软件工程师驾驭技术的能力总共分为三个层次：</p> 
<ul><li>能用健壮的代码去解决具体的问题</li><li>能用抽象的思维去应对复杂的系统</li><li>能用工程化的思想去规划更大规模的业务</li></ul> 
<p>第一点是面对所有程序员，后两点更多的是面向团队中的负责架构的人员</p> 
<h3><a id="3SOLID_25"></a>3.SOLID设计原则</h3> 
<ul><li><code>单一功能原则（Single Responsibility Principle）</code></li><li><code>开放封闭原则（Opened Closed Principle）</code></li><li>里式替换原则（Liskov Substitution Principle）</li><li>接口隔离原则（Interface Segregation Principle）</li><li>依赖反转原则（Dependency Inversion Principle）</li></ul> 
<h3><a id="4_32"></a>4.设计模式的核心思想—封装变化</h3> 
<p>如果一个软件不需要进行迭代和版本更替，那我们再开发过程中只需要完成其功能就行，完全不用去考虑其可维护性和可拓展性。</p> 
<p>但在通常开发中我们开发了一个软件，随着时间线的拉长，它会变得越来越复杂，体量也会越来越大。而我们所需要做的就是将他的变化造成的影响最小化——<code>将变和不变分离，确保在维持软件原有功能情况下，完成新的功能增加和产品迭代</code>，这个过程就叫封装变化</p> 
<h3><a id="523_38"></a>5.23种常见设计模式</h3> 
<p><img src="https://images2.imgbox.com/fd/27/HAdtsqsD_o.png" alt="请添加图片描述"><br> 这里我们并不需要把所有的设计模式都学透，从强语言迁移过来的设计模式并不是全部都是用于现在的前端，暂时只需要把几个重点的弄明白就行</p> 
<h2><a id="_42"></a>创建型</h2> 
<h3><a id="Factory_Pattern_43"></a>一、工厂模式（Factory Pattern）</h3> 
<p><code>工厂模式其实就是将创建对象的过程单独封装</code></p> 
<h4><a id="_45"></a>简单工厂</h4> 
<p><code>有构造函数的地方，我们就应该想到简单工厂</code></p> 
<h5><a id="1_47"></a>1.解决的问题：</h5> 
<p>将<code>实例化的操作</code>和<code>使用对象的操作</code>分开，让使用者不用知道具体的参数就可以实例化出所需要的<code>产品</code>类，避免了在客户端代码中显式指定，实现了解耦（使用者可以直接消费产品而不需要知道其生产细节）</p> 
<h5><a id="2_49"></a>2.构造器</h5> 
<p>通常创建对象：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'发财'</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">}</span>
</code></pre> 
<p>如果要创建500个对象我们再这么做就显得很笨了<br> 这时候可以通过定义构造函数给其传入某些属性让它帮我们进行创建</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">Constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>

<span class="token keyword">let</span> man <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token string">'发财'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> man2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token string">'旺财'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>man<span class="token punctuation">)</span><span class="token comment">// Constructor{ name: '发财', age: 20 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>man2<span class="token punctuation">)</span><span class="token comment">// Constructor{ name: '旺财', age: 22 }</span>
</code></pre> 
<h5><a id="3_70"></a>3.使用步骤</h5> 
<pre><code class="prism language-javascript"><span class="token comment">/**
 * 1.创建工厂类
 * 2.创建静态方法根据传入参数不同从而创建不同具体产品实例
 * 3.外界通过调用工厂类的静态方法，传入不同参数从而创建不同具体产品类的实例
 */</span>

<span class="token comment">//创建工厂类</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建构造方法</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> props<span class="token punctuation">.</span>name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> props<span class="token punctuation">.</span>age
  <span class="token punctuation">}</span>
<span class="token comment">//创建静态方法</span>
  <span class="token keyword">static</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">name</span><span class="token operator">:</span>name<span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span>age<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> pre <span class="token operator">=</span> User<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token string">'发财'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> pre2 <span class="token operator">=</span> User<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token string">'旺财'</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token comment">// User { name: '发财', age: 20 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pre2<span class="token punctuation">)</span><span class="token comment">// User { name: '旺财', age: 22 }</span>
</code></pre> 
<h5><a id="4_97"></a>4.举例</h5> 
<p>需求：创建一个用户工厂，不同的用户他们的工作随他们的角色而不同</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token keyword">this</span><span class="token punctuation">.</span>career <span class="token operator">=</span> career
  <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> work
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> work
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>career<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token string">'coder'</span><span class="token operator">:</span>
      work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'写代码'</span><span class="token punctuation">,</span> <span class="token string">'写系分'</span><span class="token punctuation">,</span> <span class="token string">'修Bug'</span><span class="token punctuation">]</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token string">'product manager'</span><span class="token operator">:</span>
      work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'订会议室'</span><span class="token punctuation">,</span> <span class="token string">'写PRD'</span><span class="token punctuation">,</span> <span class="token string">'催更'</span><span class="token punctuation">]</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token string">'boss'</span><span class="token operator">:</span>
      work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'喝茶'</span><span class="token punctuation">,</span> <span class="token string">'看报'</span><span class="token punctuation">,</span> <span class="token string">'见客户'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这个简单工厂的例子是有一点问题的：<br> Boss和员工在职能上是有一定差别的，所以我们在床技安不同对象的时候还需要考虑他的角色和相对应的权限。（并不是说谁都可以开除高管哈哈）</p> 
<p>根据上诉问题，我们不能再说再在原来的函数体上做修改了，不然每次加了新的东西又要返回去直接修改函数体这样就会导致整个Factory变得很大直到难以维护——俗称：shi山</p> 
<h4><a id="_Abstract_Factory_Pattern_128"></a>抽象工厂 （Abstract Factory Pattern）</h4> 
<p>抽象工厂模式它围绕一个超级工厂创建其他工厂。该超级工厂又称为其他工厂的工厂。</p> 
<p>在抽象工厂模式中，提供了一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</p> 
<h5><a id="_133"></a>举例</h5> 
<p>需求：建一个生产智能手机的工厂，这一次需要生产FakeStarFactory，用的安卓系统和高通硬件。但也要考虑下一个生产线生产的手机型号</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 定义抽象方法</span>
<span class="token keyword">class</span> <span class="token class-name">MobilePhoneFactory</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 提供操作系统的接口</span>
  <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"抽象工厂方法不允许直接调用，需要重写！"</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 提供硬件的接口</span>
  <span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"抽象工厂方法不允许直接调用，需要重写！"</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 具体工厂继承抽象工厂</span>
<span class="token keyword">class</span> <span class="token class-name">FakeStarFactory</span> <span class="token keyword">extends</span> <span class="token class-name">MobilePhoneFactory</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建安卓系统实例</span>
  <span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AndroidOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 提供高通硬件实例</span>
  <span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">QualcommHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义操作系统这类产品的抽象产品类</span>
<span class="token keyword">class</span> <span class="token class-name">OS</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'抽象产品方法不难直接调用，需要重写'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义具体操作系统类</span>
<span class="token keyword">class</span> <span class="token class-name">AndroidOS</span> <span class="token keyword">extends</span> <span class="token class-name">OS</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我会用安卓的方式去操作硬件'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">AppleOS</span> <span class="token keyword">extends</span> <span class="token class-name">OS</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我会用苹果的方式去操作硬件'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义手机硬件这类产品的抽象产品类</span>
<span class="token keyword">class</span> <span class="token class-name">HardWare</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 手机硬件的共性方法，这里提取了“根据命令运转”这个共性</span>
  <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'抽象产品方法不允许直接调用，你需要将我重写！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义具体硬件的具体产品类</span>
<span class="token keyword">class</span> <span class="token class-name">QualcommHardWare</span> <span class="token keyword">extends</span> <span class="token class-name">HardWare</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我会用高通的方式去运转'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MiWare</span> <span class="token keyword">extends</span> <span class="token class-name">HardWare</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我会用小米的方式去运转'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这是我的手机</span>
<span class="token keyword">const</span> myPhone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FakeStarFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 让它拥有操作系统</span>
<span class="token keyword">const</span> myOS <span class="token operator">=</span> myPhone<span class="token punctuation">.</span><span class="token function">createOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 让它拥有硬件</span>
<span class="token keyword">const</span> myHardWare <span class="token operator">=</span> myPhone<span class="token punctuation">.</span><span class="token function">createHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 启动操作系统(输出‘我会用安卓的方式去操作硬件’)</span>
myOS<span class="token punctuation">.</span><span class="token function">controlHardWare</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 唤醒硬件(输出‘我会用高通的方式去运转’)</span>
myHardWare<span class="token punctuation">.</span><span class="token function">operateByOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>按以上的代码我下一次生产的手机只需要重新继承MobilePhoneFactory()去创建一个新的手机实例就行</p> 
<h3><a id="Singleton_Pattern_213"></a>二、单例模式（Singleton Pattern）</h3> 
<p><code>保证一个类仅有一个实例，并提供一个访问它的全局访问点</code></p> 
<h4><a id="_216"></a>举例</h4> 
<p><strong>静态方法实现：</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">SingleDog</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我是一个单例对象'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 判断是否已经new过1个实例</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>SingleDog<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 若这个唯一的实例不存在，那么先创建它</span>
            SingleDog<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 如果这个唯一的实例已经存在，则直接返回</span>
        <span class="token keyword">return</span> SingleDog<span class="token punctuation">.</span>instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> s1 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> SingleDog<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// true s1,s2都纸箱了getInstance方法</span>
s1 <span class="token operator">===</span> s2
</code></pre> 
<p><strong>闭包实现：</strong></p> 
<pre><code class="prism language-javascript">SingleDog<span class="token punctuation">.</span>getInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 定义自由变量instance，模拟私有变量</span>
    <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 判断自由变量是否为null</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 如果为null则new出唯一实例</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="Vuex_258"></a>Vuex：单例模式的典型应用</h4> 
<h5><a id="1__259"></a>1. 概念</h5> 
<p>在写vue的过程中当组件多了，嵌套关系多起来了的时候，在通过Props和Emit这种传统的方法传值就会使项目变得的难以维护，很复杂。</p> 
<p>Vuex做的就是将共享的数据抽离了出来放在了全局，需要的时候去存取，具体可以参考我之前发布的这篇笔记：<a href="https://blog.csdn.net/qq_45578388/article/details/124264361?spm=1001.2014.3001.5501">深入浅出Vuex</a>。</p> 
<p>需要注意的是：<code>每个Vue实例里面只能对应一个Store</code></p> 
<h5><a id="2_Store_267"></a>2. 确保Store的唯一性</h5> 
<p>通常我们会通过Vue.use()方法去安装Vuex插件。而为了确保Store的唯一性，避免多次调用，重复安装…它内部实现了一个install方法：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> Vue <span class="token comment">// 这个Vue的作用和楼上的instance作用一样</span>
<span class="token operator">...</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">_Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 判断传入的Vue实例对象是否已经被install过Vuex插件（是否有了唯一的state）</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Vue <span class="token operator">&amp;&amp;</span> _Vue <span class="token operator">===</span> Vue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
        <span class="token string">'[vuex] already installed. Vue.use(Vuex) should be called only once.'</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 若没有，则为这个Vue实例对象install一个唯一的Vuex</span>
  Vue <span class="token operator">=</span> _Vue
  <span class="token comment">// 将Vuex的初始化逻辑写进Vue的钩子函数里</span>
  <span class="token function">applyMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="2_291"></a>举例2</h4> 
<p>需求：实现一个全局的Modal弹框</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>单例模式弹框<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
#modal <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
    line<span class="token operator">-</span>height<span class="token operator">:</span> 200px<span class="token punctuation">;</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> fixed<span class="token punctuation">;</span>
    <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token literal-property property">border</span><span class="token operator">:</span> 1px solid black<span class="token punctuation">;</span>
    text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">'open'</span><span class="token operator">&gt;</span>打开弹框<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">'close'</span><span class="token operator">&gt;</span>关闭弹框<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 核心逻辑，这里采用了闭包思路来实现单例模式</span>
<span class="token keyword">const</span> Modal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> modal <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      modal <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
      modal<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'我是一个全局唯一的Modal'</span>
      modal<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">'modal'</span>
      modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> modal
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 点击打开按钮展示模态框</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 未点击则不创建modal实例，避免不必要的内存占用;此处不用 new Modal 的形式调用也可以，和 Storage 同理</span>
  <span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 点击关闭按钮隐藏模态框</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="Prototype_Pattern_351"></a>三、原型模式（Prototype Pattern）</h3> 
<p>原型模式不仅是一种设计模式，它还是一种编程范式（programming paradigm），是 JavaScript 面向对象系统实现的根基。在用于创建重复的对象的同时又能保证性能。</p> 
<p><code>在js中只要你还用prototype来创建对象和继承原型，那就算再应用原型模式</code></p> 
<p>意图：用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p> 
<blockquote> 
 <p>在 Java 等强类型语言中，原型模式的出现是为了实现类型之间的解耦。而 JavaScript 本身类型就比较模糊，不存在类型耦合的问题，所以说咱们平时根本不会刻意地去使用原型模式</p> 
</blockquote> 
<h4><a id="_359"></a>原型范式</h4> 
<p>核心思想：利用实例对象来描述对象，用实例作为定义对象和继承的基础。</p> 
<h4><a id="_362"></a>原型</h4> 
<p>在 JavaScript 中，每个构造函数都拥有一个<code>prototype</code>属性，它指向构造函数的原型对象，这个原型对象中有一个 <code>constructor</code> 属性指回构造函数；</p> 
<p>每个实例都有一个<code>__proto__</code>属性，当我们使用构造函数去创建实例时，实例的<code>__proto__</code>属性就会指向构造函数的原型对象。</p> 
<h4><a id="_367"></a>深拷贝</h4> 
<p>参考：<a href="https://blog.csdn.net/qq_45578388/article/details/127337666">2022前端笔试、面试题</a></p> 
<h2><a id="_370"></a>结构型</h2> 
<h3><a id="Decorator_Pattern_371"></a>一、装饰器模式（Decorator Pattern）</h3> 
<p>装饰器模式：在不改变原对象的基础上，通过对其进行包装拓展，使原有对象可以满足用户的更复杂需求。</p> 
<p>意图：动态地给一个对象添加一些额外的职责。就增加功能来说，装饰器模式相比生成子类更为灵活。</p> 
<h4><a id="_376"></a>举例</h4> 
<p>需求：点击打开按钮弹出弹窗，在弹框被打开后把按钮的文案改为“快去登录”，同时把按钮置灰。点击关闭按钮关闭弹窗。需要考虑后续需求变更</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
#modal <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
    line<span class="token operator">-</span>height<span class="token operator">:</span> 200px<span class="token punctuation">;</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> fixed<span class="token punctuation">;</span>
    <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token literal-property property">border</span><span class="token operator">:</span> 1px solid black<span class="token punctuation">;</span>
    text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">'open'</span><span class="token operator">&gt;</span>点击打开<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">'close'</span><span class="token operator">&gt;</span>关闭弹窗<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 弹窗创建逻辑，这里我们复用了单例模式面试题的例子</span>
<span class="token keyword">const</span> Modal <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> modal <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      modal <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
      modal<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'您还未登录哦~'</span>
      modal<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">'modal'</span>
      modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>modal<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> modal
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 定义打开按钮</span>
<span class="token keyword">class</span> <span class="token class-name">OpenButton</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 点击后展示弹窗（旧逻辑）</span>
  <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> modal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Modal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义按钮对应的装饰器</span>
<span class="token keyword">class</span> <span class="token class-name">Decorator</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 将按钮实例传入</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">open_button</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>open_button <span class="token operator">=</span> open_button
  <span class="token punctuation">}</span>

  <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>open_button<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// “包装”了一层新逻辑</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 改变按钮状态</span>
  <span class="token function">changeButtonStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 按钮不可用方法</span>
  <span class="token function">disableButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"disabled"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>


  <span class="token comment">// 变更内容的方法</span>
  <span class="token function">changeButtonText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span>
    btn<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">'快去登录'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> openButton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OpenButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> decorator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Decorator</span><span class="token punctuation">(</span>openButton<span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// openButton.onClick()</span>
  <span class="token comment">// 此处可以分别尝试两个实例的onClick方法，验证装饰器是否生效</span>
  decorator<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> modal <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'modal'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>modal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    modal<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<p>常用装饰器库：<a href="https://github.com/jayphelps/core-decorators">core-decorators</a></p> 
<h3><a id="Adapter_Pattern_481"></a>二、适配器模式（Adapter Pattern）</h3> 
<p>适配器模式（Adapter Pattern）是作为两个不兼容的接口之间的桥梁，它结合了两个独立接口的功能。这种模式涉及到一个单一的类，该类负责加入独立的或不兼容的接口功能。</p> 
<p>意图：将一个类的接口转换成客户希望的另外一个接口。适配器模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p> 
<h3><a id="Proxy_Pattern_487"></a>三、代理模式（Proxy Pattern）</h3> 
<p>在代理模式中：在某些情况下，出于种种考虑/限制，一个对象不能直接访问另一个对象，需要一个第三者（代理）牵线搭桥从而间接达到访问目的。（梯子/VPN/科学上网）</p> 
<p>意图：其他对象提供一种代理以控制对这个对象的访问。</p> 
<p>应用：事件代理、虚拟代理（懒加载等等）、缓存代理</p> 
<h4><a id="_494"></a>应用</h4> 
<h5><a id="1__495"></a>1. 事件代理</h5> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"a_Box"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span>我是<span class="token constant">A</span>标签<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span>我是<span class="token constant">A</span>标签<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span>我是<span class="token constant">A</span>标签<span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span>我是<span class="token constant">A</span>标签<span class="token number">4</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span>我是<span class="token constant">A</span>标签<span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">&gt;</span>我是<span class="token constant">A</span>标签<span class="token number">6</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token comment">// 获取父元素</span>
<span class="token keyword">const</span> aBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'a_Box'</span><span class="token punctuation">)</span>

aBox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 识别目标是否是A标签</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>tagName <span class="token operator">===</span> <span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">我是</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
<h5><a id="2__527"></a>2. 图片预加载</h5> 
<p>原理：先用给一个占位图片，当真实图片加载完了之后再去取真实的地址替换。可以预防页面白屏、卡顿</p> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">PreLoadImage</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">imgNode</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取真实的DOM节点</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode <span class="token operator">=</span> imgNode
    <span class="token punctuation">}</span>
     
    <span class="token comment">// 操作img节点的src属性</span>
    <span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token parameter">imgUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> imgUrl
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ProxyImage</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 占位图的url地址</span>
    <span class="token keyword">static</span> <span class="token constant">LOADING_URL</span> <span class="token operator">=</span> <span class="token string">'xxxxxx'</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">targetImage</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 目标Image，即PreLoadImage实例</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>targetImage <span class="token operator">=</span> targetImage
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 该方法主要操作虚拟Image，完成加载</span>
    <span class="token function">setSrc</span><span class="token punctuation">(</span><span class="token parameter">targetUrl</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token comment">// 真实img节点初始化时展示的是一个占位图</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>targetImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>ProxyImage<span class="token punctuation">.</span><span class="token constant">LOADING_URL</span><span class="token punctuation">)</span>
        <span class="token comment">// 创建一个帮我们加载图片的虚拟Image实例</span>
        <span class="token keyword">const</span> virtualImage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 监听目标图片加载的情况，完成时再将DOM上的真实img节点的src属性设置为目标图片的url</span>
        virtualImage<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>targetImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>targetUrl<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 设置src属性，虚拟Image实例开始加载图片</span>
        virtualImage<span class="token punctuation">.</span>src <span class="token operator">=</span> targetUrl
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ProxyImage 帮我们调度了预加载相关的工作，我们可以通过 ProxyImage 这个代理，实现对真实 img 节点的间接访问</p> 
<h5><a id="3__567"></a>3. 缓存代理</h5> 
<p>应用于一些计算量较大的场景里，当我们需要用到某个已经计算过的值的时候，不想再耗时进行二次计算，而是希望能从内存里去取出现成的计算结果。这种场景下，就需要一个代理来帮我们在进行计算的同时，进行计算结果的缓存了。</p> 
<pre><code class="prism language-javascript"><span class="token comment">// addAll方法会对你传入的所有参数做求和操作</span>
<span class="token keyword">const</span> <span class="token function-variable function">addAll</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'进行了一次新计算'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        result <span class="token operator">+=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token comment">// 为求和方法创建代理</span>
<span class="token keyword">const</span> proxyAddAll <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 求和结果的缓存池</span>
    <span class="token keyword">const</span> resultCache <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 将入参转化为一个唯一的入参字符串</span>
        <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">)</span>
        
        <span class="token comment">// 检查本次入参是否有对应的计算结果</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args <span class="token keyword">in</span> resultCache<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 如果有，则返回缓存池里现成的结果</span>
            <span class="token keyword">return</span> resultCache<span class="token punctuation">[</span>args<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> resultCache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addAll</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_600"></a>举例</h4> 
<p>需求：模拟游戏礼包——&gt;普通登录过的用户能领普通的礼包，充值超过100的Vip才能领取Vip礼包</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 创建礼包清单</span>
<span class="token keyword">const</span> giftsList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">generalGifts</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'黄色药丸'</span><span class="token punctuation">,</span> <span class="token string">'10金币'</span><span class="token punctuation">,</span> <span class="token string">'红色药丸'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">vipGifts</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'屠龙刀'</span><span class="token punctuation">,</span> <span class="token string">'圣龙宠物'</span><span class="token punctuation">,</span> <span class="token string">'+999强化石'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 充值最小金额</span>
  <span class="token literal-property property">minPayValue</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token literal-property property">payValue</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 允许普通用户访问的信息</span>
<span class="token keyword">const</span> baseInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'generalGifts'</span><span class="token punctuation">]</span>
<span class="token comment">// 允许VIP用户访问的信息</span>
<span class="token keyword">const</span> vipInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'vipGifts'</span><span class="token punctuation">]</span>

<span class="token comment">// 创建玩家对象</span>
<span class="token keyword">const</span> gamer <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 用户是否登录标识别</span>
  <span class="token literal-property property">isValidated</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 本次充值金额</span>
  <span class="token literal-property property">currentPayValue</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isVip</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// proxy(target,handler) target:需要拦截的目标对象  handler:定制拦截行为</span>
<span class="token keyword">const</span> honorGame <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>giftsList<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">giftsList<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>baseInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>gamer<span class="token punctuation">.</span>isValidated<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请先登录，如未注册请先注册哦~'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>gamer<span class="token punctuation">.</span>isVip <span class="token operator">&amp;&amp;</span> vipInfo<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'只有vip才能领取喔~'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">giftsList<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>gamer<span class="token punctuation">.</span>currentPayValue <span class="token operator">&lt;</span>giftsList<span class="token punctuation">.</span>minPayValue<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'单次充值金额不能少于'</span><span class="token operator">+</span>giftsList<span class="token punctuation">.</span>minPayValue<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 如果充值金额满足最小充值金额</span>
    giftsList<span class="token punctuation">.</span>payValue <span class="token operator">+=</span>gamer<span class="token punctuation">.</span>currentPayValue
    <span class="token comment">// 判断充值金额能否满足成为vip</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>giftsList<span class="token punctuation">.</span>payValue <span class="token operator">&gt;=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      gamer<span class="token punctuation">.</span>isVip <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<h2><a id="_653"></a>行为型</h2> 
<h3><a id="Strategy_Pattern_654"></a>一、策略模式（Strategy Pattern）</h3> 
<p>在策略模式中，一个类的行为或其算法可以在运行时更改。</p> 
<p>意图：定义一系列的算法,把它们一个个封装起来, 并且使它们可相互替换。</p> 
<h4><a id="_659"></a>举例</h4> 
<p>需求场景：</p> 
<ul><li>当价格类型为“预售价”时，满 100 - 20，不满 100 打 9 折</li><li>当价格类型为“大促价”时，满 100 - 30，不满 100 打 8 折</li><li>当价格类型为“返场价”时，满 200 - 50，不叠加</li><li>当价格类型为“尝鲜价”时，直接打 5 折</li></ul> 
<p><img src="https://images2.imgbox.com/e9/b0/RBnRUvEu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="State_Pattern_669"></a>二、状态模式（State Pattern）</h3> 
<p>在状态模式中，<code>不同状态触发不同行为函数，用对象映射封装映射关系</code>。<br> 类的行为是基于它的状态改变的。通常在该模式中我们会创建表示各种状态的对象和一个行为随着状态对象改变而改变的 context 对象。</p> 
<p>意图：允许对象在内部状态发生改变时改变它的行为，对象看起来好像修改了它的类。</p> 
<h4><a id="_675"></a>举例</h4> 
<p>需求场景：</p> 
<ul><li>美式咖啡态（american)：只吐黑咖啡</li><li>普通拿铁态(latte)：黑咖啡加点奶</li><li>香草拿铁态（vanillaLatte）：黑咖啡加点奶再加香草糖浆</li><li>摩卡咖啡态(mocha)：黑咖啡加点奶再加点巧克力</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">CoffeeMaker</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
    这里略去咖啡机中与咖啡状态切换无关的一些初始化逻辑
  **/</span>
    <span class="token comment">// 初始化状态，没有切换任何咖啡模式</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'init'</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化牛奶的存储量</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>leftMilk <span class="token operator">=</span> <span class="token string">'500ml'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  stateToProcessor <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">that</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
    <span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 尝试在行为函数里拿到咖啡机实例的信息并输出</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'咖啡机现在的牛奶存储量是:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>that<span class="token punctuation">.</span>leftMilk<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我只吐黑咖啡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">american</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'加点奶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">vanillaLatte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'再加香草糖浆'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mocha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">latte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'再加巧克力'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 关注咖啡机状态切换函数</span>
  <span class="token function">changeState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stateToProcessor<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mk<span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token string">'latte'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="Observer_Pattern_728"></a>三、观察者模式（Observer Pattern）</h3> 
<p>当对象间存在一对多关系时，则使用观察者模式。比如，当一个对象被修改时，则会自动通知依赖它的对象。</p> 
<p>意图：定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。</p> 
<p>也可以参考Vue双向绑定：<a href="https://blog.csdn.net/qq_45578388/article/details/127337666">前端笔试、面试题</a></p> 
<h4><a id="_735"></a>举例</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Publisher</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发布者被创建了'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发布者添加方法被调用了'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token operator">===</span>observer<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'通知订阅者'</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observe</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      observe<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'订阅者创建了'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'订阅者被唤醒'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> fortune <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Publisher</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> tang <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fortune<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tang<span class="token punctuation">)</span>
fortune<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fortune<span class="token punctuation">.</span>observers<span class="token punctuation">)</span>
fortune<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'tang'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="Iterator_Pattern_783"></a>四、迭代器模式（Iterator Pattern）</h3> 
<p>迭代器模式是 Java 和 .Net 编程环境中非常常用的设计模式。这种模式用于顺序访问集合对象的元素，不需要知道集合对象的底层表示。</p> 
<p>意图：提供一种方法顺序访问一个聚合对象中各个元素, 而又无须暴露该对象的内部表示。</p> 
<p>JS中内置的比较简陋的数组迭代器：Array.prototype.forEach</p> 
<p>es6有专门对迭代器进行实现：<a href="https://blog.csdn.net/qq_45578388/article/details/123293324?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167569589016782429782378%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=167569589016782429782378&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-123293324-null-null.article_score_rank_blog&amp;utm_term=%E8%BF%AD%E4%BB%A3%E5%99%A8&amp;spm=1018.2226.3001.4450A8&amp;spm=1018.2226.3001.4450">Js基础_ES6</a></p> 
<p>PS：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols" rel="nofollow">迭代协议</a></p> 
<p>该文章是我在掘金小册中学习修言大佬的《JavaScript 设计模式核⼼原理与应⽤实践》所做的笔记以及心得，侵权即删</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cd611370cd345bef3fff0117207fd419/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux 常用文件操作命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cd79201c84110f34154baae46cf28cb1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Cross ViT</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>