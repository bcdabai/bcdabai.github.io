<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[数据结构与算法]二叉排序树之红黑树 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[数据结构与算法]二叉排序树之红黑树" />
<meta property="og:description" content="文章目录 红黑树1. 红黑树的特性2. 红黑树时间复杂度证明3. 红黑树的基本操作4. 红黑树插入5. 红黑树结点删除6.完整代码7. 示例 整理时长两天半的红黑树，虐死我了，昨晚还失眠了！ 红黑树 红黑树是二叉查找树的一种,每个节点上多了一个表示颜色的存储位.
1. 红黑树的特性 每个结点是黑色或者红色根结点为黑色空结点为黑色(这里把空结点称为叶节点)红色结点的子节点都为黑色从一个结点到其子孙叶子结点所有路径具有相同数目的黑结点 特性5和特性4保证了没有一条路径会比其他路径长出两倍.所以说红黑树是接近平衡的二叉树
2. 红黑树时间复杂度证明 定理
一棵含有n个结点的红黑树的高度至多为 2 l o g ( n &#43; 1 ) 2log(n&#43;1) 2log(n&#43;1)
证明
(1) 转换为逆否命题
其逆否命题为:
一棵高度为h的红黑树结点数至少为 2 h / 2 − 1 2^{h/2}-1 2h/2−1
h ≤ 2 l o g ( n &#43; 1 ) h \leq 2log(n&#43;1) h≤2log(n&#43;1)
l o g ( n &#43; 1 ) ≥ h / 2 log(n&#43;1) \geq h/2 log(n&#43;1)≥h/2" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a8f1e251fe1f4d61d56d8bba56d03ae6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-31T11:49:40+08:00" />
<meta property="article:modified_time" content="2019-05-31T11:49:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[数据结构与算法]二叉排序树之红黑树</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#_2" rel="nofollow">红黑树</a></li><li><ul><li><a href="#1__5" rel="nofollow">1. 红黑树的特性</a></li><li><a href="#2__16" rel="nofollow">2. 红黑树时间复杂度证明</a></li><li><a href="#3__72" rel="nofollow">3. 红黑树的基本操作</a></li><li><a href="#4__158" rel="nofollow">4. 红黑树插入</a></li><li><a href="#5__321" rel="nofollow">5. 红黑树结点删除</a></li><li><a href="#6_504" rel="nofollow">6.完整代码</a></li><li><a href="#7__721" rel="nofollow">7. 示例</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 整理时长两天半的红黑树，虐死我了，昨晚还失眠了！ 
<p></p> 
<h4><a id="_2"></a>红黑树</h4> 
<p>红黑树是二叉查找树的一种,每个节点上多了一个表示颜色的存储位.</p> 
<h5><a id="1__5"></a>1. 红黑树的特性</h5> 
<ol><li>每个结点是黑色或者红色</li><li>根结点为黑色</li><li>空结点为黑色(这里把空结点称为叶节点)</li><li>红色结点的子节点都为黑色</li><li>从一个结点到其子孙叶子结点所有路径具有相同数目的黑结点</li></ol> 
<p>特性5和特性4保证了没有一条路径会比其他路径长出两倍.所以说红黑树是接近平衡的二叉树</p> 
<p><img src="https://images2.imgbox.com/10/7a/L5NElTUW_o.png" alt=""></p> 
<h5><a id="2__16"></a>2. 红黑树时间复杂度证明</h5> 
<p><strong>定理</strong></p> 
<blockquote> 
 <p>一棵含有n个结点的红黑树的高度至多为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          2 
         
        
          l 
         
        
          o 
         
        
          g 
         
        
          ( 
         
        
          n 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
       
         2log(n+1) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p> 
</blockquote> 
<p><strong>证明</strong></p> 
<p>(1) 转换为逆否命题</p> 
<p>其逆否命题为:</p> 
<blockquote> 
 <p>一棵高度为h的红黑树结点数至少为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           2 
          
          
          
            h 
           
          
            / 
           
          
            2 
           
          
         
        
          − 
         
        
          1 
         
        
       
         2^{h/2}-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.97133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">h</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></p> 
</blockquote> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          h 
         
        
          ≤ 
         
        
          2 
         
        
          l 
         
        
          o 
         
        
          g 
         
        
          ( 
         
        
          n 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
       
         h \leq 2log(n+1) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.83041em; vertical-align: -0.13597em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          l 
         
        
          o 
         
        
          g 
         
        
          ( 
         
        
          n 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
          ≥ 
         
        
          h 
         
        
          / 
         
        
          2 
         
        
       
         log(n+1) \geq h/2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mord">/</span><span class="mord">2</span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
          ≥ 
         
         
         
           2 
          
          
          
            h 
           
          
            / 
           
          
            2 
           
          
         
        
          − 
         
        
          1 
         
        
       
         n \geq 2^{h/2}-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77194em; vertical-align: -0.13597em;"></span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.02133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">h</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></span></p> 
<p>(2)结合红黑树特性,进一步转换命题</p> 
<p>假设红黑树的结点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>(不计本身)到其叶子节点(空结点)经历的黑结点个数为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         b 
        
       
         h 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        bh(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>,可以称为黑高度.根据特性5知道左右两条路径的黑高度都为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         b 
        
       
         h 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        bh(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>.根据特性4知道,经历的黑色结点大于等于红色结点的个数.因此从结点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>到叶子节点经历的结点个数不大于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         2 
        
       
         ∗ 
        
       
         b 
        
       
         h 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        2*bh(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></p> 
<p>经历一个结点则高度加1,现在令<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>结点为根节点, 到叶节点经历的节点数为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span>, 因此树的高度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         1 
        
       
         + 
        
       
         n 
        
       
         − 
        
       
         1 
        
       
      
        1 + n - 1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>,第一个1是根节点,最后一个-1是空结点,空结点不计高度.</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          h 
         
        
          = 
         
        
          1 
         
        
          + 
         
        
          n 
         
        
          − 
         
        
          1 
         
        
          = 
         
        
          n 
         
        
       
         h = 1 + n -1 = n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span></span></p> 
<p>由于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
         ≤ 
        
       
         2 
        
       
         ∗ 
        
       
         b 
        
       
         h 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        n\leq 2*bh(x) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77194em; vertical-align: -0.13597em;"></span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span>,所以</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          2 
         
        
          ∗ 
         
        
          b 
         
        
          h 
         
        
          ( 
         
        
          x 
         
        
          ) 
         
        
          ≥ 
         
        
          h 
         
        
       
         2*bh(x) \geq h 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span></span></span></span></span></span></p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          b 
         
        
          h 
         
        
          ( 
         
        
          x 
         
        
          ) 
         
        
          ≥ 
         
        
          h 
         
        
          / 
         
        
          2 
         
        
       
         bh(x) \geq h/2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">h</span><span class="mord">/</span><span class="mord">2</span></span></span></span></span></span></p> 
<p>因此命题变成:</p> 
<blockquote> 
 <p>一棵高度为h的红黑树,它包含的内节点数至少为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
         
        
          − 
         
        
          1 
         
        
       
         2^{bh(x)}-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.97133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>个</p> 
</blockquote> 
<p>(3) 数学归纳法证明命题成立</p> 
<p>i) <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         h 
        
       
         = 
        
       
         0 
        
       
      
        h=0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>时</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         b 
        
       
         h 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
         = 
        
       
         0 
        
       
      
        bh(x)=0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">b</span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          2 
         
         
         
           b 
          
         
           h 
          
         
           ( 
          
         
           x 
          
         
           ) 
          
         
        
       
         − 
        
       
         1 
        
       
         = 
        
       
         0 
        
       
      
        2^{bh(x)}-1=0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.97133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>,原命题成立</p> 
<p>ii) <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         h 
        
       
         &amp;gt; 
        
       
         0 
        
       
      
        h&amp;gt;0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span>时</p> 
<p>假设高度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         h 
        
       
         − 
        
       
         1 
        
       
      
        h-1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>,此时定理成立,结点至少为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          2 
         
         
         
           b 
          
         
           h 
          
         
           ( 
          
         
           x 
          
         
           ) 
          
         
           − 
          
         
           1 
          
         
        
       
         − 
        
       
         1 
        
       
      
        2^{bh(x)-1}-1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.97133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>.</p> 
<p>iii) 考虑一棵高度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         h 
        
       
      
        h 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span></span></span></span></span>的红黑树.</p> 
<ul><li>当子节点为黑色时,该子树仍为红黑树,其高度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          h 
         
        
          − 
         
        
          1 
         
        
       
         h-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>,因此其节点数至少为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            − 
           
          
            1 
           
          
         
        
          − 
         
        
          1 
         
        
       
         2^{bh(x)-1}-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.97133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></li><li>当子节点为红色时,子节点的左右子树都为红黑树(红色结点子结点为黑结点),高度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          h 
         
        
          − 
         
        
          2 
         
        
       
         h-2 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span></span></span></span></span>,因此该子树节点数至少为红色结点加上红色结点左右子树至少节点数:<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          1 
         
        
          + 
         
        
          2 
         
        
          ∗ 
         
        
          ( 
         
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            − 
           
          
            2 
           
          
         
        
          − 
         
        
          1 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            − 
           
          
            1 
           
          
         
        
          − 
         
        
          1 
         
        
       
         1 + 2 * (2^{bh(x)-2}-1) = 2^{bh(x)-1}-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.138em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.97133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.888em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></li></ul> 
<p>因此高度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         h 
        
       
      
        h 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathit">h</span></span></span></span></span>的红黑树结点数至少为<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          1 
         
        
          + 
         
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            − 
           
          
            1 
           
          
         
        
          − 
         
        
          1 
         
        
          + 
         
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
            − 
           
          
            1 
           
          
         
        
          − 
         
        
          1 
         
        
          = 
         
         
         
           2 
          
          
          
            b 
           
          
            h 
           
          
            ( 
           
          
            x 
           
          
            ) 
           
          
         
        
          − 
         
        
          1 
         
        
       
         1 + 2^{bh(x)-1}-1+2^{bh(x)-1}-1=2^{bh(x)}-1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.02133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.02133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.02133em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">b</span><span class="mord mathit mtight">h</span><span class="mopen mtight">(</span><span class="mord mathit mtight">x</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></span></p> 
<p>证毕!</p> 
<h5><a id="3__72"></a>3. 红黑树的基本操作</h5> 
<p>两个旋转操作,左旋和右旋.是在红黑树发生删除或者插入时，维护树仍为红黑树的操作．</p> 
<p><strong>左旋</strong></p> 
<p><img src="https://images2.imgbox.com/26/93/hcYhXwsT_o.png" alt=""></p> 
<p>旋转的基本原则是维持二叉排序树的性质.</p> 
<ul><li>旋转前的中序遍历结果:<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          α 
         
        
          , 
         
        
          X 
         
        
          , 
         
        
          β 
         
        
          , 
         
        
          Y 
         
        
          , 
         
        
          γ 
         
        
       
         \alpha,X,\beta, Y,\gamma 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05556em;">γ</span></span></span></span></span></li><li>旋转后的中序遍历结果:<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          α 
         
        
          , 
         
        
          X 
         
        
          , 
         
        
          β 
         
        
          , 
         
        
          Y 
         
        
          , 
         
        
          γ 
         
        
       
         \alpha,X,\beta, Y,\gamma 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit" style="margin-right: 0.05556em;">γ</span></span></span></span></span></li></ul> 
<p>旋转操作要指定结点,对<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span></span></span></span></span>结点左旋就是将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         X 
        
       
      
        X 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07847em;">X</span></span></span></span></span>结点变成左子节点</p> 
<pre><code class="prism language-python"><span class="token comment">#　先定义红黑树类和红黑树节点类</span>
<span class="token keyword">class</span> <span class="token class-name">RBTree</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 定义一个叶节点，尽管值为空，但还是有各种属性</span>
        self<span class="token punctuation">.</span>nil <span class="token operator">=</span> RBTreeNode<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>root <span class="token operator">=</span> self<span class="token punctuation">.</span>nil

<span class="token keyword">class</span> <span class="token class-name">RBTreeNode</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>key <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>

<span class="token keyword">def</span> <span class="token function">left_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    T是一个红黑树类
    ｘ是要进行旋转的结点
    """</span>
    y <span class="token operator">=</span> x<span class="token punctuation">.</span>right

    <span class="token comment"># 总共有三处连接发生改变，分别是Ｙ和整棵树的父节点，Ｙ和Ｘ，Ｘ和beta</span>
    <span class="token comment"># 每处连接都是双向的，要处理两个指向</span>

    <span class="token comment"># 1. 先处理ｘ和beta</span>
    x<span class="token punctuation">.</span>right <span class="token operator">=</span> y<span class="token punctuation">.</span>left
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>left <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>  <span class="token comment"># y的左结点非空时，将其父节点设置成Ｘ</span>
        y<span class="token punctuation">.</span>left<span class="token punctuation">.</span>parent <span class="token operator">=</span> x

    <span class="token comment"># 2. 再处理Ｙ和父节点</span>
    y<span class="token punctuation">.</span>parent <span class="token operator">=</span> x<span class="token punctuation">.</span>parent <span class="token comment"># y向上连接的线</span>
    <span class="token comment"># y 向下连接的线分三种情况，父节点为空ｙ当根节点，ｙ当左结点，ｙ当右结点</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span>parent <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> y
    <span class="token keyword">elif</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left <span class="token operator">=</span> y
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right <span class="token operator">=</span> y

    <span class="token comment"># 3. 最后处理Ｘ和Ｙ</span>
    y<span class="token punctuation">.</span>left <span class="token operator">=</span> x
    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> y
</code></pre> 
<p><strong>右旋</strong></p> 
<p><img src="https://images2.imgbox.com/53/18/KEQDb42K_o.png" alt=""></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">right_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> x<span class="token punctuation">.</span>left

    x<span class="token punctuation">.</span>left <span class="token operator">=</span> y<span class="token punctuation">.</span>right
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>right <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>right<span class="token punctuation">.</span>parent <span class="token operator">=</span> x

    y<span class="token punctuation">.</span>parent <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
    <span class="token keyword">if</span> x<span class="token punctuation">.</span>parent <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> y
    <span class="token keyword">elif</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left <span class="token operator">=</span> y
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right <span class="token operator">=</span> y

    y<span class="token punctuation">.</span>right <span class="token operator">=</span> x
    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> y
</code></pre> 
<h5><a id="4__158"></a>4. 红黑树插入</h5> 
<p>插入步骤三步走:</p> 
<ol><li>按二叉排序树的方法，将结点插入到正确的位置</li><li>将结点标记为红色</li><li>通过旋转和着色操作，将树调整回红黑树</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">insert</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># step 1</span>
    f <span class="token operator">=</span> T<span class="token punctuation">.</span>nil   <span class="token comment"># 父指针</span>
    s <span class="token operator">=</span> T<span class="token punctuation">.</span>root  <span class="token comment"># 子指针</span>
    <span class="token comment"># 找到插入位置</span>
    <span class="token keyword">while</span> s <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        <span class="token keyword">if</span> x<span class="token punctuation">.</span>key <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
            f <span class="token operator">=</span> s
            s <span class="token operator">=</span> s<span class="token punctuation">.</span>left
        <span class="token keyword">elif</span> x<span class="token punctuation">.</span>key <span class="token operator">&gt;</span> s<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
            f <span class="token operator">=</span> s
            s <span class="token operator">=</span> s<span class="token punctuation">.</span>right
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            s<span class="token punctuation">.</span>key <span class="token operator">=</span> x<span class="token punctuation">.</span>key
            <span class="token keyword">return</span>

    <span class="token comment"># 插入结点</span>
    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> f
    <span class="token keyword">if</span> f <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> x
    <span class="token keyword">elif</span> x<span class="token punctuation">.</span>key <span class="token operator">&lt;</span> f<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>left <span class="token operator">=</span> x
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>right <span class="token operator">=</span> x
    x<span class="token punctuation">.</span>left <span class="token operator">=</span> T<span class="token punctuation">.</span>nil
    x<span class="token punctuation">.</span>right <span class="token operator">=</span> T<span class="token punctuation">.</span>nil

    <span class="token comment"># step 2</span>
    <span class="token comment"># 着色</span>
    x<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>

    <span class="token comment"># step 3</span>
    <span class="token comment"># 插入后维护红黑树</span>
    insert_fixup<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span>
</code></pre> 
<p><strong>插入后的红黑树维护</strong></p> 
<p>插入结点之后，有三种情况：</p> 
<ul><li>插入节点为根节点 
  <ul><li>i.直接把结点涂成黑色</li></ul> </li><li>插入的结点不是根节点 
  <ul><li>ii.被插入结点的父节点是黑色，什么都不用做</li><li>iii.被插入节点的父节点是红色，分三种情况进行调整进行调整<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            ↓ 
           
          
         
           \downarrow 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mrel">↓</span></span></span></span></span> 
    <ul><li>被插入节点的父节点是祖父结点的<strong>左</strong>结点 
      <ul><li>叔叔结点为红色（祖父节点的另一个子节点） 
        <ul><li>将父节点设置为黑色</li><li>将叔叔结点设置为黑色</li><li>将祖父节点设置为红色</li><li>将祖父结点设置为当前结点，继续处理</li></ul> </li><li>叔叔结点为黑色 
        <ul><li>当前结点是父节点的右结点 
          <ul><li>将父节点作为新的当前节点</li><li>以当前结点进行<strong>左</strong>旋</li></ul> </li><li>当前结点是父节点的左结点 
          <ul><li>将父节点设置为黑色</li><li>将祖父节点设置为红色</li><li>以祖父节点进行<strong>右</strong>旋</li></ul> </li></ul> </li></ul> </li><li>被插入节点的父节点是祖父结点的<strong>右</strong>结点 
      <ul><li>叔叔结点为红色（祖父节点的另一个子节点） 
        <ul><li>将父节点设置为黑色</li><li>将叔叔结点设置为黑色</li><li>将祖父节点设置为红色</li><li>将祖父结点设置为当前结点，继续处理</li></ul> </li><li>叔叔结点为黑色 
        <ul><li>当前结点是父节点的<strong>左</strong>结点 
          <ul><li>将父节点作为新的当前节点</li><li>以当前结点进行<strong>右</strong>旋</li></ul> </li><li>当前结点是父节点的<strong>右</strong>结点 
          <ul><li>将父节点设置为黑色</li><li>将祖父节点设置为红色</li><li>以祖父节点进行<strong>左</strong>旋</li></ul> </li></ul> </li></ul> </li></ul> </li></ul> </li></ul> 
<p>总结一下，需要进行操作的主要有三种情况:</p> 
<ul><li>当前结点父节点为红色，叔叔结点为红色</li><li>当前结点父节点为红色，叔叔结点为黑色，当前结点是父节点左结点</li><li>当前结点父节点为红色，叔叔结点为黑色，当前结点是父节点右结点</li></ul> 
<p>以下仔细看下每种情况下的操作：</p> 
<p><strong>当前结点父节点为红色，叔叔结点为红色</strong><br> <img src="https://images2.imgbox.com/09/a2/B2JF550s_o.png" alt=""></p> 
<p>当前结点是４</p> 
<ul><li>根据特性４，红色结点不能有红色子节点，因此将当前结点的父节点改为黑色</li><li>根据特性５，路径上黑色结点数相同，现在路径上多了一个黑色结点，因此将祖父结点改成红色结点，实现相等；</li><li>祖父结点变成红色结点导致叔叔路径黑色结点少一个，因此将叔叔结点变成黑色</li><li>现在整棵树满足特性５，问题可能出在祖父节点变成红色结点之后，破坏原来的特性４，因此将祖父结点变成当前结点</li></ul> 
<p><img src="https://images2.imgbox.com/9d/f3/Z8fEaKcb_o.png" alt=""></p> 
<p><strong>当前结点父节点为红色，叔叔结点为黑色，当前是父节点的内侧结点</strong></p> 
<p><img src="https://images2.imgbox.com/0e/dd/lQeeXJ8U_o.png" alt=""></p> 
<p>当前结点为７</p> 
<p>此时将父节点直接设置成黑色，或旋转都会造成更大的红黑树特性破坏．正确的做法是将当前结点移动到＂外侧＂，父节点是左孩子就左旋，父节点是右孩子就右旋．旋转结点为父节点．旋转完父节点变成了子节点，原来的子节点变成了父节点．解决红黑树特性问题从子结点开始，因此将原来的父节点，如今的子节点设置成当前节点．</p> 
<p><img src="https://images2.imgbox.com/d8/d8/PNqvUsOO_o.png" alt=""></p> 
<p><strong>当前结点父节点为红色，叔叔结点为黑色，当前结点是父节点的外侧结点</strong></p> 
<p><img src="https://images2.imgbox.com/ee/a8/aYFjLfHI_o.png" alt=""></p> 
<p>当前结点是2</p> 
<p>将父节点变红，将祖父结点变黑，此时当前结点所在半侧满足红黑树特性，但另外半侧不满足特性５，考虑到将当前结点向上移动的原则，以祖父节点为支点进行右旋操作，正好能使另外半侧满足特性５．</p> 
<p><img src="https://images2.imgbox.com/33/c5/8HJbrLuA_o.png" alt=""></p> 
<p>此时当前结点的父节点已变成黑色，搞定！</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">insert_fixup</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x<span class="token punctuation">.</span>parent <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
            y <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right
            <span class="token keyword">if</span> y<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                y<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right<span class="token punctuation">:</span>
                    x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
                    left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span>

                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span><span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token string">'red'</span>
                right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            y <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left
            <span class="token keyword">if</span> y<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                y<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent

            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
                    x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
                    right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span>

                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

    T<span class="token punctuation">.</span>root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
</code></pre> 
<h5><a id="5__321"></a>5. 红黑树结点删除</h5> 
<p>红黑树结点删除两大步走！</p> 
<ol><li>将红黑树当做一棵二叉树，将结点删除</li><li>如果删除的结点颜色为黑，通过旋转和着色，维护红黑树特性</li></ol> 
<p><strong>删除结点</strong></p> 
<p>结点的删除分三种情况：</p> 
<ul><li>没有子结点．直接将结点删除</li><li>一个子节点．将子节点顶替它的位置</li><li>两个子节点．找到左子树的最大值结点或右子树的最小值结点，称为后继结点．交换两个结点内容，删除后继结点，若有子节点则将后继结点唯一子节点顶替位置．</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> z<span class="token punctuation">.</span>left <span class="token operator">==</span> T<span class="token punctuation">.</span>nil <span class="token operator">or</span> z<span class="token punctuation">.</span>right <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        y <span class="token operator">=</span> z
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        q <span class="token operator">=</span> z<span class="token punctuation">.</span>left  <span class="token comment"># 寻找后继结点的指针,寻早左子树的最大值结点</span>
        <span class="token keyword">while</span> q<span class="token punctuation">.</span>right <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
            q <span class="token operator">=</span> q<span class="token punctuation">.</span>right
        y <span class="token operator">=</span> q

    <span class="token comment"># 交换值：</span>
    <span class="token keyword">if</span> y <span class="token operator">!=</span> z<span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>key<span class="token punctuation">,</span> z<span class="token punctuation">.</span>key <span class="token operator">=</span> z<span class="token punctuation">.</span>key<span class="token punctuation">,</span> y<span class="token punctuation">.</span>key

    <span class="token comment"># 将y的子节点挂到y的父节点下</span>
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>left <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        child <span class="token operator">=</span> y<span class="token punctuation">.</span>left
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        child <span class="token operator">=</span> y<span class="token punctuation">.</span>right

    <span class="token comment"># 向上连线</span>
    child<span class="token punctuation">.</span>parent <span class="token operator">=</span> y<span class="token punctuation">.</span>parent
    <span class="token comment"># 向下连线</span>
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>parent <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> child
    <span class="token keyword">elif</span> y <span class="token operator">==</span> y<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left <span class="token operator">=</span> child
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right <span class="token operator">=</span> child

    <span class="token keyword">if</span> y<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
        delete_fixup<span class="token punctuation">(</span>T<span class="token punctuation">,</span> child<span class="token punctuation">)</span>
        
</code></pre> 
<p><strong>维护红黑树特性</strong></p> 
<p>结点删除之后，被删除结点的子节点顶替了它的位置．由于删除的结点ｙ是黑色结点，现在我们假设顶替的结点ｘ身上多了一层黑色．这样就能维持特性５不被破坏，但破坏了特性1．另外特性2,4会因为x是红色而可能被破坏．</p> 
<p>依据x的状态，可分为三种情况：</p> 
<ul><li>i) x是红加黑结点 
  <ul><li>直接将ｘ设为黑色结点，直接能维护特性1,2,4,红黑树特性全部恢复．</li></ul> </li><li>ii) x是黑加黑结点，且x是根 
  <ul><li>此时，什么都不做即可</li></ul> </li><li>iii) x是黑加黑结点，且x不是根．有四种子情况 
  <ul><li>x的父节点是左孩子 
    <ul><li>x的兄弟结点是红色 
      <ul><li>父节点设置为红色</li><li>兄弟节点设置为黑色</li><li>以父节点为支点，左旋</li><li>重新设置兄弟节点</li></ul> </li><li>x的兄弟结点是黑色 
      <ul><li>兄弟结点两个孩子都是黑色 
        <ul><li>兄弟节点设为红色</li><li>父节点设置为当前结点</li></ul> </li><li>兄弟结点的左孩子是红色，右孩子是黑色</li><li>兄弟节点的右孩子是红色的</li></ul> </li></ul> </li><li>x的父节点是右孩子 
    <ul><li>x的兄弟结点是红色</li><li>x的兄弟结点是黑色 
      <ul><li>兄弟结点两个孩子都是黑色</li><li>兄弟结点的右孩子是红色，左孩子是黑色</li><li>兄弟节点的左孩子是红色的</li></ul> </li></ul> </li></ul> </li></ul> 
<p>以下仔细说明每种情况，即详细操作步骤和原因</p> 
<p>case1: x是黑加黑，兄弟结点是红色</p> 
<p><img src="https://images2.imgbox.com/f5/07/r4ZWwHm4_o.jpg" alt=""></p> 
<p>兄弟结点是红色的，要先将兄弟结点转换成黑色的，这是这一步的目的．由于兄弟结点的子节点都为黑色，所以通过旋转操作能将兄弟结点的子节点变成当前节点的兄弟节点．旋转结点为父节点，旋转方向为朝着当前结点的方向．旋转之后要保持另外一半子树满足特性5，要将原来的兄弟节点设置为黑，原来的父节点设置为红．（规律！旋转前，交换两个旋转元素的颜色）<br> 操作总结:</p> 
<ul><li>父节点设置为红色</li><li>兄弟节点设置为黑色</li><li>以父节点为支点，左旋</li><li>重新设置兄弟节点</li></ul> 
<p><img src="https://images2.imgbox.com/b8/d3/hzZ48eSW_o.jpg" alt=""></p> 
<p>case2:x是黑加黑，兄弟结点及其子节点都为黑</p> 
<p><img src="https://images2.imgbox.com/b4/f6/XIp08uvA_o.jpg" alt=""></p> 
<p>首先记住处理问题的核心在于解决掉黑加黑的双重颜色，将这层黑色不断向上传递，如果传递到一个红色结点，将红色结点设置成黑色，问题解决！如果传递到黑色结点，且黑色结点是根的话，问题解决！如果不是根的话，继续传递！</p> 
<p>这种情况的处理措施是将兄弟节点设置成红色结点，这样兄弟节点路径上黑色结点就会比当前节点少１；这时再将当前节点设置成父节点，换句话说，就是讲当前节点的另外一层黑传递到父节点，这样就能满足特性５了．</p> 
<p>操作总结：</p> 
<ul><li>兄弟节点设为红色</li><li>父节点设为当前节点</li></ul> 
<p><img src="https://images2.imgbox.com/97/df/qn5PcPHy_o.jpg" alt=""></p> 
<p>case3:ｘ是黑加黑，兄弟节点为黑，兄弟结点靠近ｘ子节点为红，远离ｘ子节点为黑<br> <img src="https://images2.imgbox.com/de/38/jfavVyvP_o.jpg" alt=""></p> 
<p>这是一种过度状态，不好解决，要将远离ｘ的子节点变成红,同时兄弟节点保持不变</p> 
<p>旋转操作＋旋转时的换色正好能实现！　　<br> 旋转支点兄弟结点，旋转方向为远离ｘ的方向．</p> 
<p>操作总结：</p> 
<ul><li>兄弟节点设为红色</li><li>兄弟节点的靠近ｘ的子结点设为黑色</li><li>以兄弟节点为支点向远离x的方向旋转</li><li>重新设置当前结点的兄弟节点</li></ul> 
<p><img src="https://images2.imgbox.com/33/25/JE4t5Iu6_o.jpg" alt=""></p> 
<p>case 4: x 是黑加黑，兄弟节点是黑色，兄弟节点远离x的子结点是红色，另外一个结点颜色任意</p> 
<p><img src="https://images2.imgbox.com/7e/ae/sqHgVYvF_o.jpg" alt=""></p> 
<p>这一步的核心同样在于消除x结点上的双重颜色，因此需要一个结点来分担一个黑色．由于旋转操作会附加一个换色操作，因此使用旋转操作！以父节点为中心，向靠近x方向旋转．旋转前交换颜色，父节点与兄弟结点颜色交换．旋转完检查每条路径的黑结点总和和旋转前情况比较．旋转后：根节点到当前节点1+1，旋转前：1*2;到原兄弟节点靠近x子节点保持不变，仍为１,到远离x子节点从1变为０,有问题！因此需要将原兄弟节点的远离x的子节点变成黑色．至此，成功消除x上的双层颜色．</p> 
<p>操作总结:</p> 
<ul><li>兄弟节点设置为父节点颜色</li><li>父节点设置为黑色</li><li>以父节点为支点，向x旋转</li><li>设置原兄弟结点远离x的子结点为黑色</li></ul> 
<p><img src="https://images2.imgbox.com/eb/32/T502HJn4_o.jpg" alt=""></p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">delete_fixup</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> x <span class="token operator">!=</span> T<span class="token punctuation">.</span>root <span class="token operator">and</span> x<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
            brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right
            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
                brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right

            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span> <span class="token operator">and</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
                brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
                    brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color
                    right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> brother<span class="token punctuation">)</span>
                    brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

                x <span class="token operator">=</span> T<span class="token punctuation">.</span>root
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left
            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
                brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left

            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span> <span class="token operator">and</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
                brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                    brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color
                    left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> brother<span class="token punctuation">)</span>
                brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

                x <span class="token operator">=</span> T<span class="token punctuation">.</span>root
    x<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
</code></pre> 
<h5><a id="6_504"></a>6.完整代码</h5> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">RBTree</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 定义一个叶节点，尽管值为空，但还是有各种属性</span>
        self<span class="token punctuation">.</span>nil <span class="token operator">=</span> RBTreeNode<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>root <span class="token operator">=</span> self<span class="token punctuation">.</span>nil


<span class="token keyword">class</span> <span class="token class-name">RBTreeNode</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>key <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>


<span class="token keyword">def</span> <span class="token function">left_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    T是一个红黑树类
    ｘ是要进行旋转的结点
    """</span>
    y <span class="token operator">=</span> x<span class="token punctuation">.</span>right

    <span class="token comment"># 总共有三处连接发生改变，分别是Ｙ和整棵树的父节点，Ｙ和Ｘ，Ｘ和beta</span>
    <span class="token comment"># 每处连接都是双向的，要处理两个指向</span>

    <span class="token comment"># 1. 先处理ｘ和beta</span>
    x<span class="token punctuation">.</span>right <span class="token operator">=</span> y<span class="token punctuation">.</span>left
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>left <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>  <span class="token comment"># y的左结点非空时，将其父节点设置成Ｘ</span>
        y<span class="token punctuation">.</span>left<span class="token punctuation">.</span>parent <span class="token operator">=</span> x

    <span class="token comment"># 2. 再处理Ｙ和父节点</span>
    y<span class="token punctuation">.</span>parent <span class="token operator">=</span> x<span class="token punctuation">.</span>parent <span class="token comment"># y向上连接的线</span>
    <span class="token comment"># y 向下连接的线分三种情况，父节点为空ｙ当根节点，ｙ当左结点，ｙ当右结点</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span>parent <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> y
    <span class="token keyword">elif</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left <span class="token operator">=</span> y
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right <span class="token operator">=</span> y

    <span class="token comment"># 3. 最后处理Ｘ和Ｙ</span>
    y<span class="token punctuation">.</span>left <span class="token operator">=</span> x
    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> y


<span class="token keyword">def</span> <span class="token function">right_rotate</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> x<span class="token punctuation">.</span>left

    x<span class="token punctuation">.</span>left <span class="token operator">=</span> y<span class="token punctuation">.</span>right
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>right <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>right<span class="token punctuation">.</span>parent <span class="token operator">=</span> x

    y<span class="token punctuation">.</span>parent <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
    <span class="token keyword">if</span> x<span class="token punctuation">.</span>parent <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> y
    <span class="token keyword">elif</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left <span class="token operator">=</span> y
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right <span class="token operator">=</span> y

    y<span class="token punctuation">.</span>right <span class="token operator">=</span> x
    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> y


<span class="token keyword">def</span> <span class="token function">insert</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># step 1</span>
    f <span class="token operator">=</span> T<span class="token punctuation">.</span>nil   <span class="token comment"># 父指针</span>
    s <span class="token operator">=</span> T<span class="token punctuation">.</span>root  <span class="token comment"># 子指针</span>
    <span class="token comment"># 找到插入位置</span>
    <span class="token keyword">while</span> s <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        <span class="token keyword">if</span> x<span class="token punctuation">.</span>key <span class="token operator">&lt;</span> s<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
            f <span class="token operator">=</span> s
            s <span class="token operator">=</span> s<span class="token punctuation">.</span>left
        <span class="token keyword">elif</span> x<span class="token punctuation">.</span>key <span class="token operator">&gt;</span> s<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
            f <span class="token operator">=</span> s
            s <span class="token operator">=</span> s<span class="token punctuation">.</span>right
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            s<span class="token punctuation">.</span>key <span class="token operator">=</span> x<span class="token punctuation">.</span>key
            <span class="token keyword">return</span>

    <span class="token comment"># 插入结点</span>
    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> f
    <span class="token keyword">if</span> f <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> x
    <span class="token keyword">elif</span> x<span class="token punctuation">.</span>key <span class="token operator">&lt;</span> f<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>left <span class="token operator">=</span> x
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>right <span class="token operator">=</span> x
    x<span class="token punctuation">.</span>left <span class="token operator">=</span> T<span class="token punctuation">.</span>nil
    x<span class="token punctuation">.</span>right <span class="token operator">=</span> T<span class="token punctuation">.</span>nil

    <span class="token comment"># step 2</span>
    <span class="token comment"># 着色</span>
    x<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>

    <span class="token comment"># step 3</span>
    <span class="token comment"># 插入后维护红黑树</span>
    insert_fixup<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">insert_fixup</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x<span class="token punctuation">.</span>parent <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
            y <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right
            <span class="token keyword">if</span> y<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                y<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right<span class="token punctuation">:</span>
                    x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
                    left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span>

                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span><span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token operator">=</span><span class="token string">'red'</span>
                right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            y <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left
            <span class="token keyword">if</span> y<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                y<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent

            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
                    x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
                    right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span>

                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

    T<span class="token punctuation">.</span>root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>


<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> z<span class="token punctuation">.</span>left <span class="token operator">==</span> T<span class="token punctuation">.</span>nil <span class="token operator">or</span> z<span class="token punctuation">.</span>right <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        y <span class="token operator">=</span> z
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        q <span class="token operator">=</span> z<span class="token punctuation">.</span>left  <span class="token comment"># 寻找后继结点的指针,寻早左子树的最大值结点</span>
        <span class="token keyword">while</span> q<span class="token punctuation">.</span>right <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
            q <span class="token operator">=</span> q<span class="token punctuation">.</span>right
        y <span class="token operator">=</span> q

    <span class="token comment"># 交换值：</span>
    <span class="token keyword">if</span> y <span class="token operator">!=</span> z<span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>key<span class="token punctuation">,</span> z<span class="token punctuation">.</span>key <span class="token operator">=</span> z<span class="token punctuation">.</span>key<span class="token punctuation">,</span> y<span class="token punctuation">.</span>key

    <span class="token comment"># 将y的子节点挂到y的父节点下</span>
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>left <span class="token operator">!=</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        child <span class="token operator">=</span> y<span class="token punctuation">.</span>left
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        child <span class="token operator">=</span> y<span class="token punctuation">.</span>right

    <span class="token comment"># 向上连线</span>
    child<span class="token punctuation">.</span>parent <span class="token operator">=</span> y<span class="token punctuation">.</span>parent
    <span class="token comment"># 向下连线</span>
    <span class="token keyword">if</span> y<span class="token punctuation">.</span>parent <span class="token operator">==</span> T<span class="token punctuation">.</span>nil<span class="token punctuation">:</span>
        T<span class="token punctuation">.</span>root <span class="token operator">=</span> child
    <span class="token keyword">elif</span> y <span class="token operator">==</span> y<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left <span class="token operator">=</span> child
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        y<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right <span class="token operator">=</span> child

    <span class="token keyword">if</span> y<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
        delete_fixup<span class="token punctuation">(</span>T<span class="token punctuation">,</span> child<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">delete_fixup</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> x <span class="token operator">!=</span> T<span class="token punctuation">.</span>root <span class="token operator">and</span> x<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left<span class="token punctuation">:</span>
            brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right
            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
                brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right

            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span> <span class="token operator">and</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
                brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
                    brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color
                    right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> brother<span class="token punctuation">)</span>
                    brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>right
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

                x <span class="token operator">=</span> T<span class="token punctuation">.</span>root
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left
            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>
                brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left

            <span class="token keyword">if</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span> <span class="token operator">and</span> brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'black'</span><span class="token punctuation">:</span>
                brother<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                x <span class="token operator">=</span> x<span class="token punctuation">.</span>parent
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token string">'red'</span><span class="token punctuation">:</span>
                    brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>right<span class="token punctuation">.</span>color
                    left_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> brother<span class="token punctuation">)</span>
                brother <span class="token operator">=</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>left
                x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color<span class="token punctuation">,</span> brother<span class="token punctuation">.</span>color <span class="token operator">=</span> brother<span class="token punctuation">.</span>color<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color
                brother<span class="token punctuation">.</span>left<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
                right_rotate<span class="token punctuation">(</span>T<span class="token punctuation">,</span> x<span class="token punctuation">.</span>parent<span class="token punctuation">)</span>

                x <span class="token operator">=</span> T<span class="token punctuation">.</span>root
    x<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'black'</span>
</code></pre> 
<h5><a id="7__721"></a>7. 示例</h5> 
<p><strong>插入操作</strong></p> 
<p><img src="https://images2.imgbox.com/12/43/xoX30SAd_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/fa/da/ktMxJD2y_o.png" alt=""></p> 
<p><strong>删除操作</strong><br> <img src="https://images2.imgbox.com/65/1b/fg4k1eis_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/1d/26/q9FSKLGX_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26e3eb6370754e3a2c56ffe752195eb7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">xShell&#43;xFtp 破解版</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/83b7a9469ea22ef775051bbdec6ea0c7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">插入、快排、堆排、归并、计数和桶排序详解以及测试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>