<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>全网最牛，Appium自动化测试框架-关键字驱动&#43;数据驱动实战（一） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="全网最牛，Appium自动化测试框架-关键字驱动&#43;数据驱动实战（一）" />
<meta property="og:description" content="目录：导读 前言一、Python编程入门到精通二、接口自动化项目实战三、Web自动化项目实战四、App自动化项目实战五、一线大厂简历六、测试开发DevOps体系七、常用自动化测试工具八、JMeter性能测试九、总结（尾部小惊喜） 前言 1、关键字驱动框架简介
原理及特点：
①关键字驱动测试是数据驱动测试的一种改进类型，它也被称为表格驱动测试或者基于动作字的测试。
②主要关键字包括三类：被操作对象（Item）、操作行为（Operation）和操作值（Value），用面向对象形式可将其表现为 Item.Operation(Value)。
③将测试逻辑按照这些关键字进行分解，形成数据文件。
④用关键字的形式将测试逻辑封装在数据文件中，测试工具只要能够解释这些关键字即可对其应用自动化。
优势：
①执行人员可以不需要太多的技术：一旦框架建立，手工测试人员和非技术人员都可以很容易的编写自动化测试脚本。
②简单易懂：它存在 Excel 表格中，没有编码，测试脚本容易阅读和理解。关键字和操作行为这样的手工测试用例，使它变得更容易编写和维护。
③早期介入：可以在应用未提交测试之前，就可以建立关键字驱动测试用例对象库，从而减少后期工作。使用需求和其它相关文档进行收集信息，关键字数据表可以建立手工测试程序。
④代码的重用性：用关键字的形式将测试用例及数据进行组装并解释执行，提高代码的可重用性。
2、框架结构说明
框架结构：
整个测试框架分为四层，通过分层的方式，测试代码更容易理解，维护起来较为方便。
第一层是“测试工具层”：
util 包：用于实现测试过程中调用的工具类方法，例如读取配置文件、页面元素的操作方法、操作 Excel 文件、生成测试报告、发送邮件等。
conf 包：配置文件及全局变量。
log 目录：日志输出文件。
exception_pic 目录：失败用例的截图保存目录。
第二层是“服务层”：
相当于对测试对象的一个业务封装。对于接口测试，是对远程方法的一个实现；对于 UI 测试，是对页面元素或操作的一个封装。
action 包：封装具体的页面动作，如点击、输入文本等。
第三层是“测试用例逻辑层”：
该层主要是将服务层封装好的各个业务对象，组织成测试逻辑，进行校验。
bussiness_process 包：基于关键字的形式，实现单条、多条用例的测试脚本逻辑。
test_data 目录：Excel 数据文件，包含用例步骤、被操作对象、操作动作、操作值、测试结果等。
第四层是“测试场景层”：
将测试用例组织成测试场景，实现各种级别 cases 的管理，如冒烟，回归等测试场景。
main.py：本框架工程的运行主入口。
框架特点：
①基于关键字测试框架，即使不懂开发技术的测试人员也可以实施自动化测试，便于在整个测试团队中推广和使用自动化测试技术，降低自动化测试实施的技术门槛。
②使用外部测试数据文件，使用Excel管理测试用例的集合和每个测试用例的所有执行步骤，实现在一个文件中完成测试用例的维护工作。
③通过定义关键字、操作元素的定位方式和定位表达式和操作值，就可以实现每个测试步骤的执行，可以更加灵活地实现自动化测试的需求。
④基于关键字的方式，可以进行任意关键字的扩展，以满足更加复杂的自动化测试需求。
⑤实现定位表达式和测试代码的分离，实现定位表达式直接在数据文件中进行维护。
⑥框架提供日志功能，方便调试和监控自动化测试程序的执行。
3、框架代码实现
action 包
action 包为框架第二层“服务层”，相当于对测试对象的一个业务封装。对于接口测试，是对远程方法的一个实现；对于 UI 测试，是对页面元素或操作的一个封装。
page_action.py
本模块基于关键字格式，封装了页面操作的常用函数，如打开 APP、点击、输入文本等。
import traceback import os import time from appium import webdriver from util." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5ceade3157eb8368c87c39e9437dc6d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-13T19:42:08+08:00" />
<meta property="article:modified_time" content="2023-08-13T19:42:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">全网最牛，Appium自动化测试框架-关键字驱动&#43;数据驱动实战（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录：导读</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#Python_465" rel="nofollow">一、Python编程入门到精通</a></li><li><a href="#_468" rel="nofollow">二、接口自动化项目实战</a></li><li><a href="#Web_471" rel="nofollow">三、Web自动化项目实战</a></li><li><a href="#App_474" rel="nofollow">四、App自动化项目实战</a></li><li><a href="#_477" rel="nofollow">五、一线大厂简历</a></li><li><a href="#DevOps_480" rel="nofollow">六、测试开发DevOps体系</a></li><li><a href="#_483" rel="nofollow">七、常用自动化测试工具</a></li><li><a href="#JMeter_486" rel="nofollow">八、JMeter性能测试</a></li><li><a href="#_489" rel="nofollow">九、总结（尾部小惊喜）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h3><a id="_2"></a>前言</h3> 
<p><strong>1、关键字驱动框架简介</strong></p> 
<p>原理及特点：<br> ①关键字驱动测试是数据驱动测试的一种改进类型，它也被称为表格驱动测试或者基于动作字的测试。<br> ②主要关键字包括三类：被操作对象（Item）、操作行为（Operation）和操作值（Value），用面向对象形式可将其表现为 Item.Operation(Value)。</p> 
<p>③将测试逻辑按照这些关键字进行分解，形成数据文件。</p> 
<p>④用关键字的形式将测试逻辑封装在数据文件中，测试工具只要能够解释这些关键字即可对其应用自动化。</p> 
<p>优势：<br> ①执行人员可以不需要太多的技术：一旦框架建立，手工测试人员和非技术人员都可以很容易的编写自动化测试脚本。</p> 
<p>②简单易懂：它存在 Excel 表格中，没有编码，测试脚本容易阅读和理解。关键字和操作行为这样的手工测试用例，使它变得更容易编写和维护。</p> 
<p>③早期介入：可以在应用未提交测试之前，就可以建立关键字驱动测试用例对象库，从而减少后期工作。使用需求和其它相关文档进行收集信息，关键字数据表可以建立手工测试程序。</p> 
<p>④代码的重用性：用关键字的形式将测试用例及数据进行组装并解释执行，提高代码的可重用性。</p> 
<p><strong>2、框架结构说明</strong></p> 
<p>框架结构：<br> 整个测试框架分为四层，通过分层的方式，测试代码更容易理解，维护起来较为方便。</p> 
<p>第一层是“测试工具层”：<br> util 包：用于实现测试过程中调用的工具类方法，例如读取配置文件、页面元素的操作方法、操作 Excel 文件、生成测试报告、发送邮件等。<br> conf 包：配置文件及全局变量。<br> log 目录：日志输出文件。<br> exception_pic 目录：失败用例的截图保存目录。</p> 
<p>第二层是“服务层”：<br> 相当于对测试对象的一个业务封装。对于接口测试，是对远程方法的一个实现；对于 UI 测试，是对页面元素或操作的一个封装。<br> action 包：封装具体的页面动作，如点击、输入文本等。</p> 
<p>第三层是“测试用例逻辑层”：<br> 该层主要是将服务层封装好的各个业务对象，组织成测试逻辑，进行校验。</p> 
<p>bussiness_process 包：基于关键字的形式，实现单条、多条用例的测试脚本逻辑。<br> test_data 目录：Excel 数据文件，包含用例步骤、被操作对象、操作动作、操作值、测试结果等。</p> 
<p>第四层是“测试场景层”：<br> 将测试用例组织成测试场景，实现各种级别 cases 的管理，如冒烟，回归等测试场景。</p> 
<p>main.py：本框架工程的运行主入口。</p> 
<p><img src="https://images2.imgbox.com/4a/0e/Q4XHKsoi_o.png" alt="31"></p> 
<p><img src="https://images2.imgbox.com/12/43/SSAsU7qB_o.png" alt="32"></p> 
<p><img src="https://images2.imgbox.com/50/39/HV3nC4bZ_o.png" alt="33"></p> 
<p>框架特点：<br> ①基于关键字测试框架，即使不懂开发技术的测试人员也可以实施自动化测试，便于在整个测试团队中推广和使用自动化测试技术，降低自动化测试实施的技术门槛。</p> 
<p>②使用外部测试数据文件，使用Excel管理测试用例的集合和每个测试用例的所有执行步骤，实现在一个文件中完成测试用例的维护工作。</p> 
<p>③通过定义关键字、操作元素的定位方式和定位表达式和操作值，就可以实现每个测试步骤的执行，可以更加灵活地实现自动化测试的需求。<br> ④基于关键字的方式，可以进行任意关键字的扩展，以满足更加复杂的自动化测试需求。</p> 
<p>⑤实现定位表达式和测试代码的分离，实现定位表达式直接在数据文件中进行维护。<br> ⑥框架提供日志功能，方便调试和监控自动化测试程序的执行。</p> 
<p><strong>3、框架代码实现</strong></p> 
<p><strong>action 包</strong></p> 
<p>action 包为框架第二层“服务层”，相当于对测试对象的一个业务封装。对于接口测试，是对远程方法的一个实现；对于 UI 测试，是对页面元素或操作的一个封装。</p> 
<p>page_action.py<br> 本模块基于关键字格式，封装了页面操作的常用函数，如打开 APP、点击、输入文本等。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> traceback
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">from</span> appium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> util<span class="token punctuation">.</span>get_desired_caps <span class="token keyword">import</span> get_desired_caps
<span class="token keyword">from</span> util<span class="token punctuation">.</span>datetime_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>find_element_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>


DRIVER <span class="token operator">=</span> <span class="token string">""</span>


<span class="token comment"># 打开APP，获取webdriver对象</span>
<span class="token keyword">def</span> <span class="token function">open_app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    desired_caps <span class="token operator">=</span> get_desired_caps<span class="token punctuation">(</span><span class="token punctuation">)</span>
    DRIVER <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Remote<span class="token punctuation">(</span>APPIUM_SERVER<span class="token punctuation">,</span> desired_caps<span class="token punctuation">)</span>


<span class="token comment"># 设定开始活动页</span>
<span class="token keyword">def</span> <span class="token function">open_start_activity</span><span class="token punctuation">(</span>app_name<span class="token punctuation">,</span> start_activity_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    DRIVER<span class="token punctuation">.</span>start_activity<span class="token punctuation">(</span>app_name<span class="token punctuation">,</span> start_activity_name<span class="token punctuation">)</span>


<span class="token comment"># 退出APP</span>
<span class="token keyword">def</span> <span class="token function">quit_app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    DRIVER<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 在页面输入框中输入数据</span>
<span class="token keyword">def</span> <span class="token function">input_string</span><span class="token punctuation">(</span>location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">,</span> input_content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    find_element<span class="token punctuation">(</span>DRIVER<span class="token punctuation">,</span> location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>input_content<span class="token punctuation">)</span>


<span class="token comment"># 清除输入框默认内容</span>
<span class="token keyword">def</span> <span class="token function">clear</span><span class="token punctuation">(</span>location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    find_element<span class="token punctuation">(</span>DRIVER<span class="token punctuation">,</span> location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 点击页面元素</span>
<span class="token keyword">def</span> <span class="token function">click</span><span class="token punctuation">(</span>location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    find_element<span class="token punctuation">(</span>DRIVER<span class="token punctuation">,</span> location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 断言界面源码是否存在某关键字或关键字符串</span>
<span class="token keyword">def</span> <span class="token function">assert_string_in_pagesource</span><span class="token punctuation">(</span>assert_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> assert_string <span class="token keyword">in</span> DRIVER<span class="token punctuation">.</span>page_source<span class="token punctuation">,</span> <span class="token string">"%s not found in page source!"</span> <span class="token operator">%</span> assert_string
        info<span class="token punctuation">(</span><span class="token string">"断言成功【关键字：{}】"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>assert_string<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"断言失败【关键字：{}】"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>assert_string<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span>


<span class="token comment"># 强制等待</span>
<span class="token keyword">def</span> <span class="token function">sleep</span><span class="token punctuation">(</span>sleep_seconds<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>sleep_seconds<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># 批量断言</span>
<span class="token keyword">def</span> <span class="token function">assert_app_list</span><span class="token punctuation">(</span>location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">,</span> assert_string<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    assert_string_list <span class="token operator">=</span> assert_string<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
    elements <span class="token operator">=</span> find_element<span class="token punctuation">(</span>DRIVER<span class="token punctuation">,</span> location_type<span class="token punctuation">,</span> locator_expression<span class="token punctuation">)</span>
    <span class="token keyword">for</span> element <span class="token keyword">in</span> elements<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> element<span class="token punctuation">.</span>text <span class="token keyword">in</span> assert_string_list


<span class="token comment"># 截图函数</span>
<span class="token keyword">def</span> <span class="token function">take_screenshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> DRIVER
    <span class="token comment"># 创建当前日期目录</span>
    <span class="token builtin">dir</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>EXCEPION_PIC_PATH<span class="token punctuation">,</span> get_chinese_date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span>
    <span class="token comment"># 以当前时间为文件名</span>
    file_name <span class="token operator">=</span> get_chinese_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">,</span> file_name<span class="token operator">+</span><span class="token string">".png"</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        DRIVER<span class="token punctuation">.</span>get_screenshot_as_file<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        <span class="token comment"># 返回截图文件的绝对路径</span>
        <span class="token keyword">return</span> file_path
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"截图发生异常【{}】"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
        traceback<span class="token punctuation">.</span>print_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> file_path
</code></pre> 
<p><strong>business_process 包</strong></p> 
<p>business_process 包是框架第三层“测试用例逻辑层”，该层主要是将服务层封装好的各个业务对象，组织成测试逻辑，进行校验。</p> 
<p>case_process.py<br> 测试用例文件的一行数据，拼接其中的操作动作、操作对象、操作值等关键字，形成与 page_action.py 中的函数相对应的字符串，并通过 eval() 转成表达式以执行用例。<br> 记录该用例的测试结果，如测试执行结果、测试执行时间等。</p> 
<p>如需数据驱动的用例集，则获取数据驱动的数据源集合，循环将每组数据传递给用例步骤。<br> 如果遇到需要参数化的值 ${变量名}，则根据数据驱动的数据源，根据变量名进行参数化。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> traceback
<span class="token keyword">import</span> re
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>datetime_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>excel_util <span class="token keyword">import</span> Excel
<span class="token keyword">from</span> action<span class="token punctuation">.</span>page_action <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token comment"># 执行单条测试用例（对应excel测试数据文件中的一行测试用例数据）</span>
<span class="token keyword">def</span> <span class="token function">execute_case</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> case_data<span class="token punctuation">,</span> test_data_source<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 用例数据格式校验</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>case_data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">,</span> <span class="token builtin">tuple</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"测试用例数据格式有误！测试数据应为列表或元组类型！【%s】"</span> <span class="token operator">%</span> case_data<span class="token punctuation">)</span>
        case_data<span class="token punctuation">[</span>CASESTEP_EXCEPTION_INFO_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"测试用例数据格式有误！应为列表或元组类型！【%s】"</span> <span class="token operator">%</span> case_data
        case_data<span class="token punctuation">[</span>CASESTEP_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Fail"</span>
    <span class="token comment"># 该用例无需执行</span>
    <span class="token keyword">if</span> case_data<span class="token punctuation">[</span>CASESTEP_IS_EXECUTE_COL_NO<span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"n"</span><span class="token punctuation">:</span>
        info<span class="token punctuation">(</span><span class="token string">"测试用例步骤【%s】无需执行"</span> <span class="token operator">%</span> case_data<span class="token punctuation">[</span>CASESTEP_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># excel对象初始化</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> Excel<span class="token punctuation">)</span><span class="token punctuation">:</span>
        excel <span class="token operator">=</span> excel_file_path
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        excel <span class="token operator">=</span> Excel<span class="token punctuation">(</span>excel_file_path<span class="token punctuation">)</span>
    <span class="token comment"># 获取各关键字</span>
    operation_action <span class="token operator">=</span> case_data<span class="token punctuation">[</span>CASESTEP_ACTION_COL_NO<span class="token punctuation">]</span>  <span class="token comment"># 操作动作（即函数名）</span>
    locate_method <span class="token operator">=</span> case_data<span class="token punctuation">[</span>CASESTEP_LOCATE_METHOD_COL_NO<span class="token punctuation">]</span>  <span class="token comment"># 定位方式</span>
    locate_expression <span class="token operator">=</span> case_data<span class="token punctuation">[</span>CASESTEP_LOCATE_EXPRESSION_COL_NO<span class="token punctuation">]</span>  <span class="token comment"># 定位表达式</span>
    operation_value <span class="token operator">=</span> case_data<span class="token punctuation">[</span>CASESTEP_OPERATION_VALUE_COL_NO<span class="token punctuation">]</span>  <span class="token comment"># 操作值</span>
    <span class="token comment"># 由于数据驱动，需要进行参数化的值</span>
    <span class="token keyword">if</span> test_data_source<span class="token punctuation">:</span>
        <span class="token keyword">if</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r"\$\{\w+\}"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>operation_value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 取出需要参数化的值</span>
            key <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r"\$\{(\w+)\}"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>operation_value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            operation_value <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r"\$\{\w+\}"</span><span class="token punctuation">,</span> test_data_source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>operation_value<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment"># 将参数化后的值回写excel测试结果中，便于回溯</span>
            case_data<span class="token punctuation">[</span>CASESTEP_OPERATION_VALUE_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> operation_value
    <span class="token comment"># 拼接关键字函数</span>
    <span class="token keyword">if</span> locate_method <span class="token keyword">and</span> locate_expression<span class="token punctuation">:</span>
        <span class="token keyword">if</span> operation_value<span class="token punctuation">:</span>
            func <span class="token operator">=</span> <span class="token string">"%s('%s', '%s', '%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>operation_action<span class="token punctuation">,</span> locate_method<span class="token punctuation">,</span> locate_expression<span class="token punctuation">,</span> operation_value<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            func <span class="token operator">=</span> <span class="token string">"%s('%s', '%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>operation_action<span class="token punctuation">,</span> locate_method<span class="token punctuation">,</span> locate_expression<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> operation_value<span class="token punctuation">:</span>
            func <span class="token operator">=</span> <span class="token string">"%s('%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>operation_action<span class="token punctuation">,</span> operation_value<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            func <span class="token operator">=</span> <span class="token string">"%s()"</span> <span class="token operator">%</span> operation_action
    <span class="token comment"># 执行用例</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token builtin">eval</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
        info<span class="token punctuation">(</span><span class="token string">"测试用例步骤执行成功：【{}】 {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>case_data<span class="token punctuation">[</span>CASESTEP_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">)</span>
        case_data<span class="token punctuation">[</span>CASESTEP_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Pass"</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        info<span class="token punctuation">(</span><span class="token string">"测试用例步骤执行失败：【{}】 {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>case_data<span class="token punctuation">[</span>CASESTEP_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">)</span>
        case_data<span class="token punctuation">[</span>CASESTEP_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Fail"</span>
        error<span class="token punctuation">(</span>traceback<span class="token punctuation">.</span>format_exc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 进行截图</span>
        case_data<span class="token punctuation">[</span>CASESTEP_EXCEPTION_PIC_DIR_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> take_screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 异常信息记录</span>
        case_data<span class="token punctuation">[</span>CASESTEP_EXCEPTION_INFO_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> traceback<span class="token punctuation">.</span>format_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 测试时间记录</span>
    case_data<span class="token punctuation">[</span>CASESTEP_TEST_TIME_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> get_english_datetime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> case_data


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    excel <span class="token operator">=</span> Excel<span class="token punctuation">(</span>TEST_DATA_FILE_PATH<span class="token punctuation">)</span>
    excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">"登录"</span><span class="token punctuation">)</span>
    all_data <span class="token operator">=</span> excel<span class="token punctuation">.</span>get_all_row_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> data <span class="token keyword">in</span> all_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        execute_case<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
</code></pre> 
<p>data_source_process.py：<br> 本模块实现了获取数据驱动所需的数据源集合。</p> 
<p>根据数据源 sheet 名，获取该 sheet 所有行数据，每行数据作为一组测试数据。<br> 每行数据作为一个字典，存储在一个列表中。如 [{“登录用户名”: “xxx”, “登录密码”: “xxx”, …}, {…}, …]</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> util<span class="token punctuation">.</span>excel_util <span class="token keyword">import</span> Excel
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token comment"># 数据驱动</span>
<span class="token comment"># 每行数据作为一个字典，存储在一个列表中。如[{"登录用户名": "xxx", "登录密码": "xxx", ...}, {...}, ...]</span>
<span class="token keyword">def</span> <span class="token function">get_test_data</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># excel对象初始化</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> Excel<span class="token punctuation">)</span><span class="token punctuation">:</span>
        excel <span class="token operator">=</span> excel_file_path
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        excel <span class="token operator">=</span> Excel<span class="token punctuation">(</span>excel_file_path<span class="token punctuation">)</span>
    <span class="token comment"># 校验sheet名</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"sheet【】不存在，停止执行！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    result_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    all_row_data <span class="token operator">=</span> excel<span class="token punctuation">.</span>get_all_row_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>all_row_data<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"sheet【】数据不大于1行，停止执行！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># 将参数化的测试数据存入全局字典</span>
    head_line_data <span class="token operator">=</span> all_row_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> data <span class="token keyword">in</span> all_row_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"n"</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        row_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            row_dict<span class="token punctuation">[</span>head_line_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        result_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row_dict<span class="token punctuation">)</span>
    <span class="token keyword">return</span> result_list


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>get_test_data<span class="token punctuation">(</span>TEST_DATA_FILE_PATH<span class="token punctuation">,</span> <span class="token string">"搜索词"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># [{'搜索词': 'python', '断言词': 'python'}, {'搜索词': 'mysql', '断言词': 'mysql5.6'}]</span>
</code></pre> 
<p>main_process.py：<br> 本模块基于 case_process.py 和 data_source_process.py，实现关键字驱动+数据驱动的测试用例集的执行。</p> 
<p>suite_process()：执行具体的测试用例步骤 sheet（如“登录” sheet、“搜索” sheet 等）<br> main_suite_process()：执行“测试用例”主 sheet 的用例集。每行用例集对应一个用例步骤 sheet 和数据源 sheet。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> util<span class="token punctuation">.</span>excel_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>datetime_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> bussiness_process<span class="token punctuation">.</span>case_process <span class="token keyword">import</span> execute_case
<span class="token keyword">from</span> bussiness_process<span class="token punctuation">.</span>data_source_process <span class="token keyword">import</span> get_test_data


<span class="token comment"># 执行具体的测试用例步骤sheet</span>
<span class="token keyword">def</span> <span class="token function">suite_process</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> sheet_name<span class="token punctuation">,</span> test_data_source<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    :param excel_file_path: excel文件绝对路径或excel对象
    :param sheet_name: 测试步骤sheet名
    :param test_data_source: 数据驱动的数据源，默认没有
    :return:
    """</span>
    <span class="token comment"># 记录测试结果统计</span>
    <span class="token keyword">global</span> TOTAL_CASE
    <span class="token keyword">global</span> PASS_CASE
    <span class="token keyword">global</span> FAIL_CASE
    <span class="token comment"># 整个用例sheet的测试结果，默认为全部通过</span>
    suite_test_result <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token comment"># excel对象初始化</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> Excel<span class="token punctuation">)</span><span class="token punctuation">:</span>
        excel <span class="token operator">=</span> excel_file_path
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        excel <span class="token operator">=</span> Excel<span class="token punctuation">(</span>excel_file_path<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"sheet【】不存在，停止执行！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># 获取测试用例sheet的全部行数据</span>
    all_row_data <span class="token operator">=</span> excel<span class="token punctuation">.</span>get_all_row_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>all_row_data<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"sheet【】数据不大于1行，停止执行！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># 标题行数据</span>
    head_line_data <span class="token operator">=</span> all_row_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 切换到测试结果明细sheet，准备写入测试结果</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">"测试结果明细"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"【测试结果明细】sheet不存在，停止执行！"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>head_line_data<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">)</span>
    <span class="token comment"># 执行每行的测试用例</span>
    <span class="token keyword">for</span> row_data <span class="token keyword">in</span> all_row_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        result_data <span class="token operator">=</span> execute_case<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> row_data<span class="token punctuation">,</span> test_data_source<span class="token punctuation">)</span>
        <span class="token comment"># 无需执行的测试步骤，跳过</span>
        <span class="token keyword">if</span> result_data <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        TOTAL_CASE <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> result_data<span class="token punctuation">[</span>CASESTEP_TEST_RESULT_COL_NO<span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"fail"</span><span class="token punctuation">:</span>
            suite_test_result <span class="token operator">=</span> <span class="token boolean">False</span>
            FAIL_CASE <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            PASS_CASE <span class="token operator">+=</span> <span class="token number">1</span>
        excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>result_data<span class="token punctuation">)</span>
    <span class="token comment"># 切换到测试结果统计sheet，写入统计数据</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">"测试结果统计"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"【测试结果统计】sheet不存在，停止执行！"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    excel<span class="token punctuation">.</span>insert_row_data<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>TOTAL_CASE<span class="token punctuation">,</span> PASS_CASE<span class="token punctuation">,</span> FAIL_CASE<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> excel<span class="token punctuation">,</span> suite_test_result


<span class="token comment"># 执行【测试用例】主sheet的用例集</span>
<span class="token keyword">def</span> <span class="token function">main_suite_process</span><span class="token punctuation">(</span>excel_file_path<span class="token punctuation">,</span> sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 初始化excel对象</span>
    excel <span class="token operator">=</span> Excel<span class="token punctuation">(</span>excel_file_path<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> excel<span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"excel数据文件【%s】不存在！"</span> <span class="token operator">%</span> excel_file_path<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"sheet名称【%s】不存在！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># 获取所有行数据</span>
    all_row_datas <span class="token operator">=</span> excel<span class="token punctuation">.</span>get_all_row_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>all_row_datas<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"sheet【%s】数据不大于1行，停止执行！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token comment"># 标题行数据</span>
    head_line_data <span class="token operator">=</span> all_row_datas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> row_data <span class="token keyword">in</span> all_row_datas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token comment"># 跳过不需要执行的测试用例集</span>
        <span class="token keyword">if</span> row_data<span class="token punctuation">[</span>TESTCASE_IS_EXECUTE_COL_NO<span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"n"</span><span class="token punctuation">:</span>
            info<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】无需执行！"</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token comment"># 记录本用例集的测试时间</span>
        row_data<span class="token punctuation">[</span>TESTCASE_TEST_TIME_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> get_english_datetime<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 校验用例步骤sheet名是否存在</span>
        <span class="token keyword">if</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_STEP_SHEET_NAME_COL_NO<span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> excel<span class="token punctuation">.</span>get_all_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            error<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 用例步骤集【%s】不存在！ "</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_STEP_SHEET_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
            row_data<span class="token punctuation">[</span>TESTCASE_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Fail"</span>
            excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>head_line_data<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
            excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>row_data<span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token comment"># 判断本测试用例集是否进行数据驱动</span>
        <span class="token keyword">if</span> row_data<span class="token punctuation">[</span>TESTCASE_DATA_SOURCE_SHEET_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token comment"># 校验测试数据集sheet名是否存在</span>
            <span class="token keyword">if</span> row_data<span class="token punctuation">[</span>TESTCASE_DATA_SOURCE_SHEET_NAME_COL_NO<span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> excel<span class="token punctuation">.</span>get_all_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                error<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试数据集【%s】不存在！ "</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_DATA_SOURCE_SHEET_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
                row_data<span class="token punctuation">[</span>TESTCASE_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Fail"</span>
                excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>head_line_data<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
                excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>row_data<span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            <span class="token comment"># 获取测试数据集</span>
            test_data_source <span class="token operator">=</span> get_test_data<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> row_data<span class="token punctuation">[</span>TESTCASE_DATA_SOURCE_SHEET_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># 每条数据进行一次本用例集的测试</span>
            <span class="token keyword">for</span> data_source <span class="token keyword">in</span> test_data_source<span class="token punctuation">:</span>
                info<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】开始执行！"</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
                excel<span class="token punctuation">,</span> test_result_flag <span class="token operator">=</span> suite_process<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_STEP_SHEET_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">,</span> data_source<span class="token punctuation">)</span>
                <span class="token comment"># 记录本用例集的测试结果</span>
                <span class="token keyword">if</span> test_result_flag<span class="token punctuation">:</span>
                    info<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】执行成功！ "</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
                    row_data<span class="token punctuation">[</span>TESTCASE_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Pass"</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    error<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】执行失败！ "</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
                    row_data<span class="token punctuation">[</span>TESTCASE_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Fail"</span>
                <span class="token comment"># 全部测试步骤结果写入后，最后写入本用例集的标题行和测试结果行数据</span>
                <span class="token comment"># 切换到“测试结果明细”sheet，以写入测试执行结果</span>
                excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">"测试结果明细"</span><span class="token punctuation">)</span>
                excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>head_line_data<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
                excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>row_data<span class="token punctuation">)</span>
        <span class="token comment"># 本用例集无需数据驱动</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            info<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】开始执行！"</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
            excel<span class="token punctuation">,</span> test_result_flag <span class="token operator">=</span> suite_process<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_STEP_SHEET_NAME_COL_NO<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment"># 记录本用例集的测试结果</span>
            <span class="token keyword">if</span> test_result_flag<span class="token punctuation">:</span>
                info<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】执行成功！ "</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
                row_data<span class="token punctuation">[</span>TESTCASE_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Pass"</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                error<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">" 测试用例集【%s】执行失败！ "</span> <span class="token operator">%</span> row_data<span class="token punctuation">[</span>TESTCASE_CASE_NAME_COL_NO<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">*</span> <span class="token number">50</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
                row_data<span class="token punctuation">[</span>TESTCASE_TEST_RESULT_COL_NO<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Fail"</span>
            <span class="token comment"># 全部测试步骤结果写入后，最后写入本用例集的标题行和测试结果行数据</span>
            <span class="token comment"># 切换到“测试结果明细”sheet，以写入测试执行结果</span>
            excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">"测试结果明细"</span><span class="token punctuation">)</span>
            excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>head_line_data<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
            excel<span class="token punctuation">.</span>write_row_data<span class="token punctuation">(</span>row_data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> excel


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> util<span class="token punctuation">.</span>report_util <span class="token keyword">import</span> create_excel_report_and_send_email
    <span class="token comment"># excel, _ = suite_process(TEST_DATA_FILE_PATH, "进入主页")</span>
    <span class="token comment"># excel, _ = suite_process(excel, "登录")</span>
    excel <span class="token operator">=</span> main_suite_process<span class="token punctuation">(</span>TEST_DATA_FILE_PATH<span class="token punctuation">,</span> <span class="token string">"测试用例"</span><span class="token punctuation">)</span>
    create_excel_report_and_send_email<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> <span class="token string">"xxxxxxx@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"app自动化测试"</span><span class="token punctuation">,</span> <span class="token string">"请查收附件：app自动化测试报告"</span><span class="token punctuation">)</span>
</code></pre> 
<table><tbody><tr><td bgcolor="yellow"><font size="4"><b>下面是我整理的2023年最全的软件测试工程师学习知识架构体系图</b></font></td></tr></tbody></table> 
<h3><a id="Python_465"></a>一、Python编程入门到精通</h3> 
<p><img src="https://images2.imgbox.com/3d/d5/bpcQjVKG_o.png" alt="请添加图片描述"></p> 
<h3><a id="_468"></a>二、接口自动化项目实战</h3> 
<p><img src="https://images2.imgbox.com/c3/2b/W4cNYY1I_o.png" alt="请添加图片描述"></p> 
<h3><a id="Web_471"></a>三、Web自动化项目实战</h3> 
<p><img src="https://images2.imgbox.com/48/a5/iUky6nPX_o.png" alt="请添加图片描述"></p> 
<h3><a id="App_474"></a>四、App自动化项目实战</h3> 
<p><img src="https://images2.imgbox.com/bc/a6/7Pmj19gw_o.png" alt="请添加图片描述"></p> 
<h3><a id="_477"></a>五、一线大厂简历</h3> 
<p><img src="https://images2.imgbox.com/d9/6f/vJLmgFqp_o.png" alt="请添加图片描述"></p> 
<h3><a id="DevOps_480"></a>六、测试开发DevOps体系</h3> 
<p><img src="https://images2.imgbox.com/ee/a7/JNd4zTE1_o.png" alt="请添加图片描述"></p> 
<h3><a id="_483"></a>七、常用自动化测试工具</h3> 
<p><img src="https://images2.imgbox.com/d4/ca/4L2kaLkX_o.png" alt="请添加图片描述"></p> 
<h3><a id="JMeter_486"></a>八、JMeter性能测试</h3> 
<p><img src="https://images2.imgbox.com/7a/fe/qMnDk6FK_o.png" alt="请添加图片描述"></p> 
<h3><a id="_489"></a>九、总结（尾部小惊喜）</h3> 
<p>奋斗是燃烧心灵的力量，是追寻梦想的征程。即使困顿，也要坚守初心，勇往直前。每一次努力都是成长的催化剂，每一次奋斗都将绽放出灿烂的人生之花。</p> 
<p>站在人生的起点，勇敢追逐梦想。不畏困难，不惧失败，执着奋斗的脚步踏遍千山万水。坚持信念，拼尽全力，终将在辉煌与成功的殿堂上书写属于自己的传世之作！</p> 
<p>不忘初心，坚守梦想之航。即使身陷逆境，也要勇往直前，努力奋斗。相信自己的能力，拥抱挑战的机会，用汗水浇灌成就。奋斗不止于一时，而是人生的永恒追求！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a212f16aa2d0fe0bde0547244679372e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网络基础(一)桥接网络</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/95fe419f50c845ef2689892edd7b063c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用NSIS打包程序总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>