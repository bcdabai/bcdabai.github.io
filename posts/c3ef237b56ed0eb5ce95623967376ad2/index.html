<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>简单的创建一个小型服务器 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="简单的创建一个小型服务器" />
<meta property="og:description" content="linux网络 linux 网络基础 linux网络一、DHCP服务1.DHCP基础2.DHCP好处3.DHCP分配方式4.配置 二、FTP服务1.FTP服务基础2.匿名访问FTP服务3.本地用户访问FTP服务 总结 一、DHCP服务 1.DHCP基础 DHCP（动态主机配置协议）
一个局域网的网络协议，使用UDP协议：服务器67号端口，客户端68号端口
给内部网络或服务供应商自动分配IP地址
给用户或者内部网络管理员作为对所有计算机中央管理手段
2.DHCP好处 减少管理员的工作量
避免输入错误的可能
避免IP地址冲突
当网络更改IP地址段时，不需要再重新配置每个用户的IP地址
提高了IP地址的利用率
方便客户端的配置
3.DHCP分配方式 分配方式：手动分配、自动分配、动态分配。
DHCP的IP地址自动获取工作原理
第一步:客户端在网络中搜索服务器。
客户端通过广播发送 DHCP Discover报文寻找服务器端
第二步:服务器向客户端响应服务
服务器端通过广播发送DHCP Offer报文向客户端提供I地址等网络信息,从I地址池中挑选一个尚未分配的I地址分配给客户端
第三步:客户端向服务器发出服务请求
如果有多台DHCP服务器向该客户端发来DHCP-offer报文,客户端只接受第一个收到的DHCP- offer报文并提取I地址,然后客户端通过广播发送 DHCP Request报文告知服务器端本地选择使用该IP地址
第四步:服务器向客户端提供服务
服务器通过广播发送 DHCP ACK报文告知客户端I地址是合法可用的,并在选项字段中增加I地址的使用租期信息
(5)重新登录
DHCP客户机每次重新登录网络时,不需要再发送 DHCP Discover信息,而是直接发送包含前一次所分配的IP地址的 DHCP Request请求信息
(6)更新租约
当DHCP服务器向客户机出租的IP地址租期达到50%时,就需要更新租约。客户机直接向提供租约的服务器发送 DHCP Request包,要求更新现有的地址租约
4.配置 ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210426153413360.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLm
NzZG4ubmV0L3dlaXhpbl81NTYwOTkwNQ==,size_16,color_FFFFFF,t_70)
配置DHCP服务器 yum install -y dhcp cd /usr/share/doc/dhcp-4.2.5/ vim /etc/dhcp/dhcpd.conf cp /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example /etc/dhcp/dhcpd.conf vim /etc/dhcp/dhcpd.conf 设置全局配置参数 default-lease-time 600; 默认租约为10分钟，单位为秒 max- lease-time 7200; 最大租约为2小时，单位为秒." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c3ef237b56ed0eb5ce95623967376ad2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-26T20:08:03+08:00" />
<meta property="article:modified_time" content="2021-04-26T20:08:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">简单的创建一个小型服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="linux_0"></a>linux网络</h2> 
<p></p> 
<div class="toc"> 
 <h4>linux 网络基础</h4> 
 <ul><li><a href="#linux_0" rel="nofollow">linux网络</a></li><li><a href="#DHCP_2" rel="nofollow">一、DHCP服务</a></li><li><ul><li><a href="#1DHCP_3" rel="nofollow">1.DHCP基础</a></li><li><a href="#2DHCP_9" rel="nofollow">2.DHCP好处</a></li><li><a href="#3DHCP_17" rel="nofollow">3.DHCP分配方式</a></li><li><a href="#4_42" rel="nofollow">4.配置</a></li></ul> 
  </li><li><a href="#FTP_155" rel="nofollow">二、FTP服务</a></li><li><ul><li><a href="#1FTP_156" rel="nofollow">1.FTP服务基础</a></li><li><a href="#2FTP_165" rel="nofollow">2.匿名访问FTP服务</a></li><li><a href="#3FTP_236" rel="nofollow">3.本地用户访问FTP服务</a></li></ul> 
  </li><li><a href="#_296" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="DHCP_2"></a>一、DHCP服务</h2> 
<h3><a id="1DHCP_3"></a>1.DHCP基础</h3> 
<p><strong>DHCP（动态主机配置协议）</strong><br> 一个局域网的网络协议，使用UDP协议：服务器67号端口，客户端68号端口<br> <font color="red"> 给内部网络或服务供应商自动分配IP地址<br> 给用户或者内部网络管理员作为对所有计算机中央管理手段</font></p> 
<h3><a id="2DHCP_9"></a>2.DHCP好处</h3> 
<p>减少管理员的工作量<br> 避免输入错误的可能<br> 避免IP地址冲突<br> 当网络更改IP地址段时，不需要再重新配置每个用户的IP地址<br> 提高了IP地址的利用率<br> 方便客户端的配置</p> 
<h3><a id="3DHCP_17"></a>3.DHCP分配方式</h3> 
<p>分配方式：<mark>手动分配、自动分配、动态分配</mark>。</p> 
<p><strong>DHCP的IP地址自动获取工作原理</strong></p> 
<p>第一步:客户端在网络中搜索服务器。<br> 客户端通过广播发送 DHCP Discover报文寻找服务器端</p> 
<p>第二步:服务器向客户端响应服务<br> 服务器端通过广播发送DHCP Offer报文向客户端提供I地址等网络信息,从I地址池中挑选一个尚未分配的I地址分配给客户端</p> 
<p>第三步:客户端向服务器发出服务请求<br> 如果有多台DHCP服务器向该客户端发来DHCP-offer报文,客户端只接受第一个收到的DHCP- offer报文并提取I地址,然后客户端通过广播发送 DHCP Request报文告知服务器端本地选择使用该IP地址</p> 
<p>第四步:服务器向客户端提供服务<br> 服务器通过广播发送 DHCP ACK报文告知客户端I地址是合法可用的,并在选项字段中增加I地址的使用租期信息</p> 
<p>(5)重新登录<br> DHCP客户机每次重新登录网络时,不需要再发送 DHCP Discover信息,而是直接发送包含前一次所分配的IP地址的 DHCP Request请求信息</p> 
<p>(6)更新租约<br> 当DHCP服务器向客户机出租的IP地址租期达到50%时,就需要更新租约。客户机直接向提供租约的服务器发送 DHCP Request包,要求更新现有的地址租约</p> 
<p><img src="https://images2.imgbox.com/70/7a/lInl1kM1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_42"></a>4.配置</h3> 
<p><img src="https://images2.imgbox.com/7f/c1/EH4V4gPH_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/64/6f/e3TArQV3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2f/85/cnfhcZuZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e9/f6/JR7yBpT6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/00/82/sW5yJBDo_o.png" alt="在这里插入图片描述"><br> ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210426153413360.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLm<br> NzZG4ubmV0L3dlaXhpbl81NTYwOTkwNQ==,size_16,color_FFFFFF,t_70)<br> <img src="https://images2.imgbox.com/83/4e/LDt7jOFc_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/38/30/dJlJmFxZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9a/90/K4pBYrSm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/37/7f/hllInMyf_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d5/b1/cynPDuXo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/28/53/LmpDULc2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/91/63/Erp0upcc_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-j">配置DHCP服务器
yum install -y dhcp
cd /usr/share/doc/dhcp-4.2.5/ 
vim /etc/dhcp/dhcpd.conf
cp /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example /etc/dhcp/dhcpd.conf

vim /etc/dhcp/dhcpd.conf
设置全局配置参数
default-lease-time 600;       默认租约为10分钟，单位为秒
max- lease-time 7200;         最大租约为2小时，单位为秒.
option domain-name "benet.con" ;        指定默认域名
option domain-name-servers 8.8.8.8;    指定DNS服务器地址
ddns-update-style none;                禁用DNS动态更新

subnet网段声明(作用于整个子网段，部分配置参数优先级高于全局配置参数)
声明要分配的网段地址
subnet 192.168.100.0 netmask 255.255.255.0 {
设置地址池
range 192.168.100.10 192.168.100.200;
指定默认网关地址
option routers 192.168.80.254;
}

host主机声明( 给单机分配固定的IP地址)
指定需要分配固定IP地址的客户机名称
host hostname {
指定该主机的MAC地址
hardware ethernet 00:c0:c3:22: 46:81;
指定保留给该主机的IP地址
fixed-address 192. 168.4.100;
}
</code></pre> 
<pre><code class="prism language-j">systemctl restart dhcpd     启动dhcp服务
ystemctl status dhcpd       查看DHCP服务是否启动
</code></pre> 
<pre><code class="prism language-j">[SW2]dhcp enable 
Info: The operation may take a few seconds. Please wait for a moment.done.
[SW2]int v10
[SW2-Vlanif10]dhcp select relay 
[SW2-Vlanif10]dhcp relay server-ip 192.168.100.20
[SW2-Vlanif10]int v20
[SW2-Vlanif20]dhcp select relay
[SW2-Vlanif20]dhcp relay server-ip 192.168.100.20
</code></pre> 
<pre><code class="prism language-j">option domain-name "benet.con";
option domain-name-servers 8.8.8.8;

default-lease-time 600;
max-lease-time 7200;
ddns-update-style none;

subnet 192.168.100.0 netmask 255.255.255.0 {
  range 192.168.100.10 192.168.100.200;
  option routers 192.168.100.254;
}

subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.10 192.168.1.120;
  option routers 192.168.1.254;
}

subnet 192.168.2.0 netmask 255.255.255.0 {
  range 192.168.2.130 192.168.2.150;
  option routers 192.168.2.254;
  option domain-name-servers 9.9.9.9;
  default-lease-time 21600;
  max-lease-time 47200;
</code></pre> 
<p><img src="https://images2.imgbox.com/09/94/FDXnMGqK_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/71/5c/cx658c9M_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/1b/7e/pb0lp5sv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4c/24/nOFTOiKZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/80/c3/HfSN5kyl_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b6/2b/Qbwm7j3A_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b9/14/pBdLhf8G_o.png" alt="在这里插入图片描述"><br> <strong>Linux客户端使用DHCP动态获取IP</strong><br> 方法一<br> vi /etc/sysconfig/network-scripts/ifcfg-ens33<br> DEVICE=ens33<br> ONBOOT=yes<br> BOOTPROTO=dhcp<br> ifdown ens33 ; ifup ens33</p> 
<p>方法二<br> dhlclient -d ens33</p> 
<p>查看租约文件<br> less /var/l ib/ dhcpd/ dhcpd. lease</p> 
<h2><a id="FTP_155"></a>二、FTP服务</h2> 
<h3><a id="1FTP_156"></a>1.FTP服务基础</h3> 
<p><mark>FTP使用tcp协议的20、21号端口</mark><br> <strong>20端口用于建立数据连接，并传输文件数据<br> 21端口用于建立控制连接，并传输FTP控制命令</strong></p> 
<p>FTP分为主动模式和被动模式<br> 主动模式：服务器主动发起数据连接<br> 被动模式：服务器被动等待数据连接</p> 
<h3><a id="2FTP_165"></a>2.匿名访问FTP服务</h3> 
<pre><code class="prism language-j">yum install -y vsftpd
cd /etc/vsftpd/
cp vsftpd.conf vsftpd.conf.bak

设置匿名用户访问的FTP服务(最大权限)
修改配置文件
vim /etc/vsftpd/vsftpd.conf

开启匿名用户访问。默认已开启
anonymous_enable=YES

开放服务器的写权限(若要上传，必须开启)。默认已开启
write_enable=YES

设置匿名用户所上传数据的权限掩码(反掩码)。
anon_umask=022

允许匿名用户上传文件。默认E注释，需取消注释
anon_upload_enable=YES

允许匿名用户创建(上传)目录。默认已注释，需取消注释
anon_mkdir_write_enable=YES

允许删除、重命名、覆盖等操作。需添加
anon_other_write_enable=YES

为匿名访问ftp的根目录下的pub子目录设置最大权限，以便匿名用户上传数据.
chmod 777 /var/ftp/pub/

开启服务，关闭防火墙和增强型安全功能
systemctl start vsftpd
systemctl stop firewalld
setenforce 0

名访问测试
在windows系统打开开始菜单，输入cmd命令打开命令提示符

建立ftp连接

ftp 192.168.100.20
匿名访问，用户名为ftp，密码为空，直接回车即可完成登录
匿名访问ftp的根目录为Linux系统的/var/ftp/目录
ftp&gt; ftp

查看当前目录
ftp&gt; ls

切换到pub目录
ftp&gt; cd pub 

下载文件到当前windows本地目录
ftp&gt; get文件名

上传文件到ftp目录
ftp&gt; put文件名

退出
ftp&gt; quit 
</code></pre> 
<p><img src="https://images2.imgbox.com/72/55/7MBeZsO7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a8/b1/GocC039u_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fc/61/Wki6dNZC_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/23/e9/mTIB54mi_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/94/64/XMAPONiS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/00/9b/hUkt7vlj_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/02/ba/w0qtIrAZ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3f/ac/4OKppUeC_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/5a/14/dhbovtST_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3FTP_236"></a>3.本地用户访问FTP服务</h3> 
<pre><code class="prism language-j">设置本地用户验证访问ftp，并禁止切换到ftp以外的目录(默认登录的根目录为本地用户的家目录)

修改配置文件
vim /etc/vsftpd/ vsftpd. conf

启用本地用户
local_enable=Yes

关闭匿名用户访问
anonymous_enable=NO

开放服务器的写权限(若要上传，必须开启)
write_enable=YES

可设置仅宿主用户拥有被_上传的文件的权限( 反掩码)
local_umask=077

将访问禁锢在用户的宿主目录中
chroot_local_user=YES

允许被限制的用户主目录具有写权限
allow_writeable_chroot=YES

重启服务
systemctl restart vsftpd

ftp 192.168.100.20
或
ftp://zhangsan@192.168.100.20
</code></pre> 
<pre><code class="prism language-j">修改匿名用户、本地用户登录的默认根目录
anon_root=/var/www/html             anon_root 针对匿名用户
local_root=/var/www/html            local_root 针对系统用户

使用user_list用户列表文件
vim /etc/vsftpd/user_list           末尾添加zhangsan用户
zhangsan

vim /etc/vsftpd/vsftpd.conf
userlist_enable=YES                 启用user_list用户列表文件
userlist_deny=NO                    设置黑名单，仅允许user_list用户列表文件的用户访问。默认为YES，为白名单
</code></pre> 
<p><img src="https://images2.imgbox.com/a5/a9/muDeSr7m_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/be/2d/invLHiLd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b6/f0/sDonNfAA_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b6/8a/spbWnWju_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/d4/40/B9h19qXU_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4e/04/GLZIwETN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/25/0d/Bi9eCoZ2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e6/e2/dlzDH5mg_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_296"></a>总结</h2> 
<p><font color="#999AAA">：</font></p> 
<p>DCHP动态地址解析配置文件在/etc/dhcp/dhcpd.conf文件中配置 注意文件格式结束要；</p> 
<p>启用本地用户登陆ftp时要关闭匿名登陆 （注释无效，系统默认开启）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6ab69fd51dad58c30e15b6c6ebac8a43/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">利用TreeSet实现Comparable、Comparator的两种排序方式（自然排序、定制排序）----使用泛型之后的改进</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ec247809301a7d5f6e93b5b2b55c4644/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2021-Swin Transformer Attention机制的详细推导</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>