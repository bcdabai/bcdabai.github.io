<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jenkins部署CI/CD - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="jenkins部署CI/CD" />
<meta property="og:description" content="目录
一、CI/CD
1、为什么要 用CI / CD 2、理解持续集成、持续交付、持续部署
1、持续集成
2、持续集成目的在产生以下效益
3、持续交付
4 、持续部署
二、Jenkins CI/CD
1、 Jenkins CI/CD 流程图​
2、Jenkins 介绍
1、Jenkins 功能
2、Jenkins 概念
3、Jenkins 目的
4、Jenkins 特性
5、产品发布流程
3、jenkins安装与使用
1、安装java和maven
2、安装jenkins
4、登录jenkins web管理界面
5、Jenkins用户权限管理
1、用户管理背景
2、安装用户管理插件
3、开启插件功能
4、验证用户管理
5、用户权限划分
6、Jenkins 参数化构建
1、参数化构建背景
2、安装插件并使用
3、 数据来源选择文件
三、部署应用Jenkins&#43;Github&#43;Tomcat实战
1、jenkins部署
1、安装插件
2、插件安装过程
3、配置邮箱（可选）
4、配置Jenkins私钥
5、添加后端服务器
6、配置jdk，maven命令，全局配置
7、构建发布任务
2、部署java服务器，做jenkins打包上线
3、回到jenkins页面开始构建任务
四、部署jenkins&#43;gitlab&#43;tomcat实战
1、gitlab本地仓库与远程仓库的配置
2、jenkins服务器的配置
3、web服务器（tomcat）环境清理
4、jenkins项目的创建与配置
5、项目构建
6、排错
五、 Gitlab&#43;jenkins&#43;tomcat&#43;webhook 自动发布
1、jenkins安装插件
2、gitlab配置项目的webhook" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/eb80240b93c0f15b20208f00810a02de/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-17T22:12:31+08:00" />
<meta property="article:modified_time" content="2022-05-17T22:12:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">jenkins部署CI/CD</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81CI%2FCD-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81CI%2FCD" rel="nofollow">一、CI/CD</a></p> 
<p id="1%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%20CI%20%2F%20CD%20%E6%96%B9%E6%B3%95%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%20CI%20%2F%20CD%20%E6%96%B9%E6%B3%95%E7%AE%80%E4%BB%8B" rel="nofollow">1、为什么要 用CI / CD </a></p> 
<p id="2%E3%80%81%E7%90%86%E8%A7%A3%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%E3%80%81%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E7%90%86%E8%A7%A3%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%E3%80%81%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2" rel="nofollow">2、理解持续集成、持续交付、持续部署</a></p> 
<p id="1%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90" rel="nofollow">1、持续集成</a></p> 
<p id="2%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%9B%AE%E7%9A%84%E5%9C%A8%E4%BA%A7%E7%94%9F%E4%BB%A5%E4%B8%8B%E6%95%88%E7%9B%8A-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%9B%AE%E7%9A%84%E5%9C%A8%E4%BA%A7%E7%94%9F%E4%BB%A5%E4%B8%8B%E6%95%88%E7%9B%8A" rel="nofollow">2、持续集成目的在产生以下效益</a></p> 
<p id="3%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98-toc" style="margin-left:80px;"><a href="#3%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98" rel="nofollow">3、持续交付</a></p> 
<p id="4%20%E3%80%81%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2-toc" style="margin-left:80px;"><a href="#4%20%E3%80%81%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2" rel="nofollow">4 、持续部署</a></p> 
<p id="%E4%BA%8C%3AJenkins%20CI%2FCD-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%3AJenkins%20CI%2FCD" rel="nofollow">二、Jenkins CI/CD</a></p> 
<p id="1%E3%80%81%20Jenkins%20CI%2FCD%20%E6%B5%81%E7%A8%8B%E5%9B%BE%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#1%E3%80%81%20Jenkins%20CI%2FCD%20%E6%B5%81%E7%A8%8B%E5%9B%BE%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">1、 Jenkins CI/CD 流程图​</a></p> 
<p id="2%E3%80%81Jenkins%20%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px;"><a href="#2%E3%80%81Jenkins%20%E4%BB%8B%E7%BB%8D" rel="nofollow">2、Jenkins 介绍</a></p> 
<p id="1%E3%80%81Jenkins%20%E5%8A%9F%E8%83%BD-toc" style="margin-left:80px;"><a href="#1%E3%80%81Jenkins%20%E5%8A%9F%E8%83%BD" rel="nofollow">1、Jenkins 功能</a></p> 
<p id="2%E3%80%81Jenkins%20%E6%A6%82%E5%BF%B5-toc" style="margin-left:80px;"><a href="#2%E3%80%81Jenkins%20%E6%A6%82%E5%BF%B5" rel="nofollow">2、Jenkins 概念</a></p> 
<p id="3%E3%80%81Jenkins%20%E7%9B%AE%E7%9A%84-toc" style="margin-left:80px;"><a href="#3%E3%80%81Jenkins%20%E7%9B%AE%E7%9A%84" rel="nofollow">3、Jenkins 目的</a></p> 
<p id="4%E3%80%81Jenkins%20%E7%89%B9%E6%80%A7-toc" style="margin-left:80px;"><a href="#4%E3%80%81Jenkins%20%E7%89%B9%E6%80%A7" rel="nofollow">4、Jenkins 特性</a></p> 
<p id="5%E3%80%81%E4%BA%A7%E5%93%81%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B-toc" style="margin-left:80px;"><a href="#5%E3%80%81%E4%BA%A7%E5%93%81%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B" rel="nofollow">5、产品发布流程</a></p> 
<p id="3%E3%80%81jenkins%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8-toc" style="margin-left:40px;"><a href="#3%E3%80%81jenkins%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8" rel="nofollow">3、jenkins安装与使用</a></p> 
<p id="1%E3%80%81%E5%AE%89%E8%A3%85java%E5%92%8Cmaven-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E5%AE%89%E8%A3%85java%E5%92%8Cmaven" rel="nofollow">1、安装java和maven</a></p> 
<p id="2%E3%80%81%E5%AE%89%E8%A3%85jenkins-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E5%AE%89%E8%A3%85jenkins" rel="nofollow">2、安装jenkins</a></p> 
<p id="4%E3%80%81%E7%99%BB%E5%BD%95jenkins%20web%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E7%99%BB%E5%BD%95jenkins%20web%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2" rel="nofollow">4、登录jenkins web管理界面</a></p> 
<p id="5%E3%80%81Jenkins%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86-toc" style="margin-left:40px;"><a href="#5%E3%80%81Jenkins%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86" rel="nofollow">5、Jenkins用户权限管理</a></p> 
<p id="1%E3%80%81%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E8%83%8C%E6%99%AF-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E8%83%8C%E6%99%AF" rel="nofollow">1、用户管理背景</a></p> 
<p id="2%E3%80%81%E5%AE%89%E8%A3%85%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E6%8F%92%E4%BB%B6-toc" style="margin-left:80px;"> <a href="#2%E3%80%81%E5%AE%89%E8%A3%85%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E6%8F%92%E4%BB%B6" rel="nofollow">2、安装用户管理插件</a></p> 
<p id="%C2%A03%E3%80%81%E5%BC%80%E5%90%AF%E6%8F%92%E4%BB%B6%E5%8A%9F%E8%83%BD-toc" style="margin-left:80px;"><a href="#%C2%A03%E3%80%81%E5%BC%80%E5%90%AF%E6%8F%92%E4%BB%B6%E5%8A%9F%E8%83%BD" rel="nofollow"> 3、开启插件功能</a></p> 
<p id="%C2%A04%E3%80%81%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86-toc" style="margin-left:80px;"><a href="#%C2%A04%E3%80%81%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86" rel="nofollow"> 4、验证用户管理</a></p> 
<p id="%C2%A05%E3%80%81%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E5%88%92%E5%88%86-toc" style="margin-left:80px;"><a href="#%C2%A05%E3%80%81%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E5%88%92%E5%88%86" rel="nofollow"> 5、用户权限划分</a></p> 
<p id="%C2%A06%E3%80%81Jenkins%20%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA-toc" style="margin-left:40px;"><a href="#%C2%A06%E3%80%81Jenkins%20%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA" rel="nofollow"> 6、Jenkins 参数化构建</a></p> 
<p id="1%E3%80%81%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA%E8%83%8C%E6%99%AF-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA%E8%83%8C%E6%99%AF" rel="nofollow">1、参数化构建背景</a></p> 
<p id="2%E3%80%81%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%E5%B9%B6%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%E5%B9%B6%E4%BD%BF%E7%94%A8" rel="nofollow">2、安装插件并使用</a></p> 
<p id="%C2%A03%E3%80%81%C2%A0%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#%C2%A03%E3%80%81%C2%A0%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6" rel="nofollow">3、 数据来源选择文件</a></p> 
<p id="%C2%A0%E4%B8%89%E3%80%81%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8Jenkins%2BGithub%2BTomcat%E5%AE%9E%E6%88%98-toc" style="margin-left:0px;"><a href="#%C2%A0%E4%B8%89%E3%80%81%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8Jenkins%2BGithub%2BTomcat%E5%AE%9E%E6%88%98" rel="nofollow"> 三、部署应用Jenkins+Github+Tomcat实战</a></p> 
<p id="%C2%A01%E3%80%81jenkins%E9%83%A8%E7%BD%B2-toc" style="margin-left:40px;"><a href="#%C2%A01%E3%80%81jenkins%E9%83%A8%E7%BD%B2" rel="nofollow"> 1、jenkins部署</a></p> 
<p id="%C2%A01%E3%80%81%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6-toc" style="margin-left:80px;"><a href="#%C2%A01%E3%80%81%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6" rel="nofollow"> 1、安装插件</a></p> 
<p id="2%E3%80%81%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B-toc" style="margin-left:80px;"> <a href="#2%E3%80%81%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B" rel="nofollow">2、插件安装过程</a></p> 
<p id="%C2%A03%E3%80%81%E9%85%8D%E7%BD%AE%E9%82%AE%E7%AE%B1%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89-toc" style="margin-left:80px;"><a href="#%C2%A03%E3%80%81%E9%85%8D%E7%BD%AE%E9%82%AE%E7%AE%B1%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89" rel="nofollow"> 3、配置邮箱（可选）</a></p> 
<p id="%C2%A04%E3%80%81%E9%85%8D%E7%BD%AEJenkins%E7%A7%81%E9%92%A5-toc" style="margin-left:80px;"><a href="#%C2%A04%E3%80%81%E9%85%8D%E7%BD%AEJenkins%E7%A7%81%E9%92%A5" rel="nofollow"> 4、配置Jenkins私钥</a></p> 
<p id="%C2%A05%E3%80%81%E6%B7%BB%E5%8A%A0%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8-toc" style="margin-left:80px;"><a href="#%C2%A05%E3%80%81%E6%B7%BB%E5%8A%A0%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8" rel="nofollow"> 5、添加后端服务器</a></p> 
<p id="%C2%A06%E3%80%81%E9%85%8D%E7%BD%AEjdk%EF%BC%8Cmaven%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#%C2%A06%E3%80%81%E9%85%8D%E7%BD%AEjdk%EF%BC%8Cmaven%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE" rel="nofollow"> 6、配置jdk，maven命令，全局配置</a></p> 
<p id="7%E3%80%81%E6%9E%84%E5%BB%BA%E5%8F%91%E5%B8%83%E4%BB%BB%E5%8A%A1-toc" style="margin-left:80px;"> <a href="#7%E3%80%81%E6%9E%84%E5%BB%BA%E5%8F%91%E5%B8%83%E4%BB%BB%E5%8A%A1" rel="nofollow">7、构建发布任务</a></p> 
<p id="%C2%A02%E3%80%81%E9%83%A8%E7%BD%B2java%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%81%9Ajenkins%E6%89%93%E5%8C%85%E4%B8%8A%E7%BA%BF-toc" style="margin-left:40px;"><a href="#%C2%A02%E3%80%81%E9%83%A8%E7%BD%B2java%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%81%9Ajenkins%E6%89%93%E5%8C%85%E4%B8%8A%E7%BA%BF" rel="nofollow"> 2、部署java服务器，做jenkins打包上线</a></p> 
<p id="3%E3%80%81%E5%9B%9E%E5%88%B0jenkins%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A1-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E5%9B%9E%E5%88%B0jenkins%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A1" rel="nofollow">3、回到jenkins页面开始构建任务</a></p> 
<p id="%E5%9B%9B%E3%80%81%E9%83%A8%E7%BD%B2jenkins%2Bgitlab%2Btomcat%E5%AE%9E%E6%88%98-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E9%83%A8%E7%BD%B2jenkins%2Bgitlab%2Btomcat%E5%AE%9E%E6%88%98" rel="nofollow">四、部署jenkins+gitlab+tomcat实战</a></p> 
<p id="1%E3%80%81gitlab%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E4%B8%8E%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#1%E3%80%81gitlab%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E4%B8%8E%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E9%85%8D%E7%BD%AE" rel="nofollow">1、gitlab本地仓库与远程仓库的配置</a></p> 
<p id="2%E3%80%81jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#2%E3%80%81jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE" rel="nofollow">2、jenkins服务器的配置</a></p> 
<p id="3%E3%80%81web%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88tomcat%EF%BC%89%E7%8E%AF%E5%A2%83%E6%B8%85%E7%90%86-toc" style="margin-left:40px;"><a href="#3%E3%80%81web%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88tomcat%EF%BC%89%E7%8E%AF%E5%A2%83%E6%B8%85%E7%90%86" rel="nofollow">3、web服务器（tomcat）环境清理</a></p> 
<p id="4%E3%80%81jenkins%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#4%E3%80%81jenkins%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE" rel="nofollow">4、jenkins项目的创建与配置</a></p> 
<p id="5%E3%80%81%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA-toc" style="margin-left:40px;"><a href="#5%E3%80%81%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA" rel="nofollow">5、项目构建</a></p> 
<p id="%C2%A06%E3%80%81%E6%8E%92%E9%94%99-toc" style="margin-left:40px;"><a href="#%C2%A06%E3%80%81%E6%8E%92%E9%94%99" rel="nofollow">6、排错</a></p> 
<p id="%E4%BA%94%E3%80%81%20Gitlab%2Bjenkins%2Btomcat%2Bwebhook%20%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81%20Gitlab%2Bjenkins%2Btomcat%2Bwebhook%20%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83" rel="nofollow">五、 Gitlab+jenkins+tomcat+webhook 自动发布</a></p> 
<p id="1%E3%80%81jenkins%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6-toc" style="margin-left:40px;"><a href="#1%E3%80%81jenkins%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6" rel="nofollow">1、jenkins安装插件</a></p> 
<p id="%C2%A02%E3%80%81gitlab%E9%85%8D%E7%BD%AE%E9%A1%B9%E7%9B%AE%E7%9A%84webhook-toc" style="margin-left:40px;"><a href="#%C2%A02%E3%80%81gitlab%E9%85%8D%E7%BD%AE%E9%A1%B9%E7%9B%AE%E7%9A%84webhook" rel="nofollow">2、gitlab配置项目的webhook</a></p> 
<p id="3%E3%80%81%E6%B5%8B%E8%AF%95%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E6%B5%8B%E8%AF%95%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83" rel="nofollow">3、测试自动发布</a></p> 
<p id="4%E3%80%81%E6%8E%92%E9%94%99-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E6%8E%92%E9%94%99" rel="nofollow">4、排错</a></p> 
<p id="1%E3%80%81gitlab%E5%87%BA%E7%8E%B0500%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-toc" style="margin-left:80px;"><a href="#1%E3%80%81gitlab%E5%87%BA%E7%8E%B0500%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95" rel="nofollow">1、gitlab出现500错误的解决方法</a></p> 
<p id="%C2%A02%E3%80%81%E5%9C%A8gitlab%E6%B5%8B%E8%AF%95webhook%E5%8A%9F%E8%83%BD%E7%9A%84%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0403%EF%BC%8C%E5%9B%BE%E7%89%87%E5%A6%82%E4%B8%8B%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%C2%A02%E3%80%81%E5%9C%A8gitlab%E6%B5%8B%E8%AF%95webhook%E5%8A%9F%E8%83%BD%E7%9A%84%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0403%EF%BC%8C%E5%9B%BE%E7%89%87%E5%A6%82%E4%B8%8B%EF%BC%9A" rel="nofollow"> 2、在gitlab测试webhook功能的时候出现403</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81CI%2FCD" style="margin-left:.0001pt;"><span style="color:#1a1a1a;"><span style="color:#333333;">一、CI/CD</span></span></h2> 
<h3 id="1%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%20CI%20%2F%20CD%20%E6%96%B9%E6%B3%95%E7%AE%80%E4%BB%8B" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">1、为什么要 用CI / CD </span></h3> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">软件开发的连续方法基于自动执行脚本，以最大限度地减少在开发应用程序时引入错误的可能性。从新代码的开发到部署，它们需要较少的人为干预甚至根本不需要干预。它涉及在每次小迭代中不断构建，测试和部署代码更改，从而减少基于有缺陷或失败的先前版本开发新代码的机会。这种方法有三种主要方法，每种方法都根据最适合您的策略进行应用。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续集成(Continuous Integration, CI):  代码合并，构建，部署，测试都在一起，不断地执行这个过程，并对结果反馈。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续交付(Continuous Deployment, CD):　部署到测试环境、预生产环境。　</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续部署(Continuous Delivery, CD):  将最终产品发布到生成环境、给用户使用。</span><img alt="" height="107" src="https://images2.imgbox.com/d6/9a/jiGwSZSD_o.png" width="605"></p> 
<h3 id="2%E3%80%81%E7%90%86%E8%A7%A3%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%E3%80%81%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2"><span style="color:#1a1a1a;">2、理解持续集成、持续交付、持续部署</span></h3> 
<h4 id="1%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">1、持续集成</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续集成（英语：Continuous integration，缩写为 CI），一种软件工程流程，将所有工程师对于软件的工作复本，每天集成数次到共用主线（mainline）上。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">这个名称最早由葛来迪·布区（Grady Booch）在他的布区方法中提出，但是他并没有提到要每天集成数次。之后成为极限编程（extreme programming，缩写为XP）的一部分。在测试驱动开发（TDD）的作法中，通常还会搭配自动单元测试。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续集成的提出，主要是为了解决软件进行系统集成时面临的各项问题，极限编程称这些问题为集成地狱（integration hell）。</span><img alt="" height="273" src="https://images2.imgbox.com/28/5f/hDU3i8B1_o.png" width="605"></p> 
<p><span style="color:#333333;">持续集成主要是强调开发人员提交了新代码之后，立刻进行构建、（单元）测试。根据测试结果，我们可以确定新代码和原有代码能否正确地集成在一起。简单来讲就是：频繁地（一天多次）将代码集成到主干。</span></p> 
<h4 id="2%E3%80%81%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%9B%AE%E7%9A%84%E5%9C%A8%E4%BA%A7%E7%94%9F%E4%BB%A5%E4%B8%8B%E6%95%88%E7%9B%8A"><span style="color:#1a1a1a;"><span style="color:#333333;">2</span><span style="color:#333333;">、持续集成目的在产生以下效益</span></span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">及早发现集成错误且由于修订的内容较小所以易于追踪，这可以节省项目的时间与成本。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">避免发布日期的前一分钟发生混乱，当每个人都会尝试为他们所造成的那一点点不兼容的版本做检查。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">当单元测试失或发生错误，若开发人员需要在不除错的情况下还原代码库到一个没有问题的状态，只需要放弃一小部分的更改 (因为集成的次数频繁)。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">让 "最新" 的程序可保持可用的状态供测试、展示或发布用。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">频繁的提交代码会促使开发人员创建模块化，低复杂性的代码。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">防止分支大幅偏离主干。如果不是经常集成，主干又在不断更新，会导致以后集成的难度变大，甚至难以集成。</span></p> 
<h4 id="3%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98" style="margin-left:.0001pt;"><span style="color:#1a1a1a;"><span style="color:#333333;">3、持续交付</span></span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续交付（英语：Continuous delivery，缩写为 CD），是一种软件工程手法，让软件产品的产出过程在一个短周期内完成，以保证软件可以稳定、持续的保持在随时可以释出的状况。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">它的目标在于让软件的建置、测试与释出变得更快以及更频繁。这种方式可以减少软件开发的成本与时间，减少风险。</span><img alt="" height="450" src="https://images2.imgbox.com/95/46/jzi4NiXu_o.png" width="605"></p> 
<p><span style="color:#333333;">持续交付在持续集成的基础上，将集成后的代码部署到更贴近真实运行环境的「类生产环境」（production-like environments）中。比如，我们完成单元测试后，可以把代码部署到连接数据库的Staging 环境中更多的测试。如果代码没有问题，可以继续手动部署到生产环境中。</span></p> 
<h4 id="4%20%E3%80%81%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">4 、持续部署</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续部署（英语：Continuous Deployment，缩写为 CD），是持续交付的下一步，指的是代码通过评审以后，自动部署到生产环境。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">有时候，持续部署也与持续交付混淆。持续部署意味着所有的变更都会被自动部署到生产环境中。持续交付意味着所有的变更都可以被部署到生产环境中，但是出于业务考虑，可以选择不部署。如果要实施持续部署，必须先实施持续交付。</span><img alt="" height="450" src="https://images2.imgbox.com/6e/c0/PuQgkofD_o.png" width="605"></p> 
<p><span style="color:#333333;">持续部署即在持续交付的基础上，把部署到生产环境的过程自动化。</span></p> 
<h2 id="%E4%BA%8C%3AJenkins%20CI%2FCD" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">二、Jenkins CI/CD</span></h2> 
<h3 id="1%E3%80%81%20Jenkins%20CI%2FCD%20%E6%B5%81%E7%A8%8B%E5%9B%BE%E2%80%8B%E7%BC%96%E8%BE%91" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">1、 Jenkins CI/CD 流程图</span><img alt="" height="371" src="https://images2.imgbox.com/fd/a9/5QPbjAGW_o.png" width="605"></h3> 
<p><span style="color:#333333;">说明：上线之前先把代码git到版本仓库，然后通过Jenkins 如Java项目通过maven去构建，这是在非容器之前，典型的自动化的一个版本上线流程.(存在环境依赖问题)</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">如：它的测试环境，预生产环境，测试环境。会存在一定的兼容性问题 （环境之间会有一定的差异）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="349" src="https://images2.imgbox.com/b1/44/L824gVVU_o.png" width="605"></p> 
<p><span style="color:#333333;">说明：这里有一个docker harbor 的镜像仓库，通常会把你的环境打包为一个镜像，通过镜像的方式来部署（解决环境依赖问题）。</span></p> 
<h3 id="2%E3%80%81Jenkins%20%E4%BB%8B%E7%BB%8D" style="margin-left:.0001pt;"><span style="color:#1a1a1a;"><span style="color:#333333;">2</span><span style="color:#333333;">、Jenkins 介绍</span></span></h3> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="195" src="https://images2.imgbox.com/eb/44/iih9BUkp_o.png" width="605"></p> 
<p><span style="color:#333333;">Jenkins 是一个用Java编写的开源的持续集成工具。在与Oracle发生争执后，项目从Hudson项目独立。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Jenkins </span><span style="color:#333333;">提供了软件开发的持续集成服务。它运行在Servlet容器中（例如Apache Tomcat）。它支持软件配置管理（SCM）工具（包括AccuRev SCM、CVS、Subversion、Git、Perforce、Clearcase和RTC），可以执行基于Apache Ant和Apache Maven的项目，以及任意的Shell脚本和Windows批处理命令。Jenkins的主要开发者是川口耕介。Jenkins是在MIT许可证下发布的自由软件。</span></p> 
<h4 id="1%E3%80%81Jenkins%20%E5%8A%9F%E8%83%BD" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">1、Jenkins 功能</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续的软件版本发布/测试项目。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">监控外部调用执行的工作。</span></p> 
<h4 id="2%E3%80%81Jenkins%20%E6%A6%82%E5%BF%B5" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">2、Jenkins 概念</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Jenkins</span><span style="color:#333333;">是一个功能强大的应用程序，允许持续集成和持续交付项目，无论用的是什么平台。这是一个免费的开源项目，可以处理任何类型的构建或持续集成。集成Jenkins可以用于一些测试和部署技术。Jenkins是一种软件允许持续集成。</span></p> 
<h4 id="3%E3%80%81Jenkins%20%E7%9B%AE%E7%9A%84" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">3、Jenkins 目的</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续、自动地构建/测试软件项目。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">监控软件开放流程，快速问题定位及处理，提提高开发效率。</span></p> 
<h4 id="4%E3%80%81Jenkins%20%E7%89%B9%E6%80%A7" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">4、Jenkins 特性</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">开源的java语言开发持续集成工具，支持CI，CD。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">易于安装部署配置：可通过yum安装,或下载war包以及通过docker容器等快速实现安装部署，可方便web界面配置管理。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">消息通知及测试报告：集成RSS/E-mail通过RSS发布构建结果或当构建完成时通过e-mail通知，生成JUnit/TestNG测试报告。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">分布式构建：支持Jenkins能够让多台计算机一起构建/测试。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">文件识别:Jenkins能够跟踪哪次构建生成哪些jar，哪次构建使用哪个版本的jar等。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">丰富的插件支持:支持扩展插件，你可以开发适合自己团队使用的工具，如git，svn，maven，docker等。</span></p> 
<h4 id="5%E3%80%81%E4%BA%A7%E5%93%81%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B" style="margin-left:.0001pt;"><span style="color:#1a1a1a;">5、产品发布流程</span></h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">产品设计成型 -&gt; 开发人员开发代码 -&gt; 测试人员测试功能 -&gt; 运维人员发布上线</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续集成（Continuous integration，简称CI）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续交付（Continuous delivery）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">持续部署（continuous deployment） </span></p> 
<h3 id="3%E3%80%81jenkins%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8" style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">3、jenkins安装与使用</span></h3> 
<h4 id="1%E3%80%81%E5%AE%89%E8%A3%85java%E5%92%8Cmaven"><span style="color:#333333;">1、安装java和maven</span></h4> 
<pre><code>将jdk的包和maven的包上传到服务器
[root@localhost ~]# ls
anaconda-ks.cfg  apache-maven-3.8.1-bin.tar.gz  jdk-8u191-linux-x64.tar.gz  
[root@localhost ~]# tar zxf jdk-8u191-linux-x64.tar.gz -C /usr/local/
[root@localhost ~]# mv /usr/local/jdk-8u191 /usr/local/java
[root@localhost ~]# tar zxf apache-maven-3.8.1-bin.tar.gz -C /usr/local/java
[root@localhost ~]# mv /usr/local/java/apache-maven /usr/local/java/maven
[root@localhost ~]# vim /etc/profile
JAVA_HOME=/usr/local/java
MAVEN_HOME=/usr/local/java/maven
PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$PATH
export JAVA_HOME MAVEN_HOME PATH
[root@localhost ~]# soure /etc/profile
验证java和maven
[root@localhost ~]# java -version
java version "1.8.0_191"
Java(TM) SE Runtime Environment (build 1.8.0_191-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)
[root@localhost ~]# mvn -v
Apache Maven 3.8.1 (05c21c65bdfed0f71a2f2ada8b84da59348c4c5d)
Maven home: /usr/local/java/maven
Java version: 1.8.0_191, vendor: Oracle Corporation, runtime: /usr/local/java/jre
Default locale: zh_CN, platform encoding: UTF-8
OS name: "linux", version: "3.10.0-693.el7.x86_64", arch: "amd64", family: "unix"
</code></pre> 
<h4 id="2%E3%80%81%E5%AE%89%E8%A3%85jenkins">2、安装jenkins</h4> 
<p>yum安装jenkins</p> 
<pre><code>[root@localhost ~]# wget https://mirrors.tuna.tsinghua.edu.cn/jenkins/redhat-stable/jenkins-2.235.1-1.1.noarch.rpm
[root@localhost ~]# yum install -y jenkins-2.235.1-1.1.noarch.rpm

jenkins 配置
[root@localhost ~]# rpm -ql jenkins
/etc/init.d/jenkins         # 启动文件
/etc/logrotate.d/jenkins    # 日志分割配置文件
/etc/sysconfig/jenkins      # jenkins主配置文件
/usr/lib/jenkins            # 存放war包目录
/usr/lib/jenkins/jenkins.war   # war 包 
/usr/sbin/rcjenkins         # 命令
/var/cache/jenkins          # war包解压目录 jenkins网页代码目录
/var/lib/jenkins            # jenkins 工作目录
/var/log/jenkins            # 日志
修改配置文件
[root@localhost ~]# grep "^[a-Z]" /etc/sysconfig/jenkins
JENKINS_HOME="/var/lib/jenkins"    # jenkins工作目录
JENKINS_JAVA_CMD=""
JENKINS_USER="jenkins"             # jenkinx启动用户
JENKINS_JAVA_OPTIONS="-Djava.awt.headless=true"
JENKINS_PORT="8080"                # 端口
JENKINS_LISTEN_ADDRESS=""
JENKINS_HTTPS_PORT=""
JENKINS_HTTPS_KEYSTORE=""
JENKINS_HTTPS_KEYSTORE_PASSWORD=""
JENKINS_HTTPS_LISTEN_ADDRESS=""
JENKINS_DEBUG_LEVEL="5"
JENKINS_ENABLE_ACCESS_LOG="no"
JENKINS_HANDLER_MAX="100"          # 最大连接
JENKINS_HANDLER_IDLE="20"
JENKINS_ARGS=""
首先需要修改一下启动脚本，文件在/etc/init.d/jenkins
因为jenkins的启动脚本默认java路径为：/usr/bin/java
但是我们新安装的java路径并不是在这个，所以我们需要新添加路径。如图下所示：
新路径地址为：/usr/local/java/bin/java
[root@localhost ~]# systemctl daemon-reload
[root@localhost ~]# systemctl start jenkins
</code></pre> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">以下是第二种安装方式</span></p> 
<pre><code>因为安装了jdk所以直接安装tomcat，将tomcat的压缩包上传到服务器，可以从官网下载，因为我有这个压缩包，所以我直接上传到我的虚拟机
[root@localhost ~]# tar apache-tomcat-8.5.69.tar.gz -C /usr/local/
[root@localhost ~]# mv /usr/local/apache-tomcat /usr/local/tomcat
tomcat的8009端口默认是关闭的，我们需要手动开启
[root@localhost ~]# vim /usr/local/tomcat/conf/server.xml
    &lt;Connector protocol="AJP/1.3"
               address="::1"                            #将这部分的注释取消掉就行，保存退出
               port="8009"
               redirectPort="8443" /&gt;

下载jenkins的安装包
安装jenkins:2.187  ----通过官网直接下载war包。
官网:http://updates.jenkins-ci.org/download/war/
我本来就有所以直接本地上传到虚拟机，然后将jenkins的war包复制到tomcat的网站发布目录，提前将tomcat这个目录里的全部内容都删除
[root@localhost ~]# cd /usr/local/tomcat/webapps/
[root@localhost webapps]#  rm -rf *
[root@jenkins-server webapps]# cp /root/jenkins.war .
然后启动tomcat
[root@localhost ~]# /usr/local/tomcat/bin/startup.sh 
Using CATALINA_BASE:   /usr/local/tomcat
Using CATALINA_HOME:   /usr/local/tomcat
Using CATALINA_TMPDIR: /usr/local/tomcat/temp
Using JRE_HOME:        /usr/local/java
Using CLASSPATH:       /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar
Using CATALINA_OPTS:   
Tomcat started.</code></pre> 
<h3 id="4%E3%80%81%E7%99%BB%E5%BD%95jenkins%20web%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2">4、<span style="color:#1a1a1a;">登录jenkins web管理界面</span></h3> 
<p>浏览器访问192.168.242.147:8080/jenkins（注意这个路径，直接访问8080端口是访问不到jenkins的），看到下面的界面，在虚拟机上查看对应密码</p> 
<p></p> 
<p><img alt="" height="421" src="https://images2.imgbox.com/60/1c/4TP9VFN2_o.png" width="752"></p> 
<p> <span style="color:#333333;">1、修改/root/.jenkins/updates/default.jso</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">jenkins </span><span style="color:#333333;">在下载插件之前会先检查网络连接，其会读取这个文件中的网址。默认是：</span><a href="www.google.com" rel="nofollow"><span style="color:#1e6fff;">www.google.com</span></a></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">访问谷歌，这就很坑了，服务器网络又不能 FQ，肯定监测失败呀，不得不说jenkins的开发者脑子锈了，所以将图下的google改为</span><a href="http://www.baidu.com/" rel="nofollow" title="www.baidu.com">www.baidu.com</a><span style="color:#333333;">即可，更改完重启服务。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;">{"connectionCheckUrl":"http://www.baidu.com/","core":{"buildDate":"Dec 02, 2020","name":"core","sha1":"fMwDSSmyX9SkyDzqpqhd2EjOUy4=","sha256":"Du3rKxGjJyastX2ybiYrGSPPQI6EcIuvRx47U0Yu1vE=","url":"https://updates</p> 
<p style="margin-left:.0001pt;text-align:justify;">.......</p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">2、 修改/root/.jenkins/hudson.model.UpdateCenter.xml</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">该文件为jenkins下载插件的源地址，改地址默认jenkins默认为：</span><a href="https://updates.jenkins.io/update-center.json" rel="nofollow" title="https://updates.jenkins.io/update-center.json">https://updates.jenkins.io/update-center.json</a><span style="color:#333333;">，就是因为https的问题，此处我们将其改为http即可，之后重启jenkins服务即可。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">其他国内备用地址（也可以选择使用）：</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" rel="nofollow" title="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></p> 
<p style="margin-left:.0001pt;text-align:left;"><a href="http://mirror.esuni.jp/jenkins/updates/update-center.json" rel="nofollow" title="http://mirror.esuni.jp/jenkins/updates/update-center.json">http://mirror.esuni.jp/jenkins/updates/update-center.json</a></p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="381" src="https://images2.imgbox.com/77/0f/vS4PWVNO_o.png" width="840"></p> 
<p> <img alt="" height="653" src="https://images2.imgbox.com/ef/92/HczhLMRQ_o.png" width="845"></p> 
<p> <span style="color:#333333;">域名可供选择(根据实际情况)</span></p> 
<p><img alt="" height="498" src="https://images2.imgbox.com/2f/0a/ClrQvZTF_o.png" width="605"></p> 
<p> <img alt="" height="247" src="https://images2.imgbox.com/f2/67/1j7juq4s_o.png" width="605"></p> 
<p> <span style="color:#333333;">点击“Start using jenkins”</span></p> 
<p><img alt="" height="526" src="https://images2.imgbox.com/bf/07/rJ6vFQFM_o.png" width="605"></p> 
<h3 id="5%E3%80%81Jenkins%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86">5、Jenkins用户权限管理</h3> 
<h4 id="1%E3%80%81%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E8%83%8C%E6%99%AF">1、用户管理背景</h4> 
<p>针对开发运维、测试针对不同角色进行不同权限划分，基于插件：</p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Role-based Authorization Strategy </span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Authorize Project </span></p> 
<h4 id="2%E3%80%81%E5%AE%89%E8%A3%85%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E6%8F%92%E4%BB%B6" style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">2、安装用户管理插件</span></h4> 
<p style="margin-left:.0001pt;text-align:left;">安装插件：</p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="894" src="https://images2.imgbox.com/78/5f/hhe20rzP_o.png" width="1200"></p> 
<p><img alt="" height="840" src="https://images2.imgbox.com/20/36/enIB5EEO_o.png" width="1200"></p> 
<h4 id="%C2%A03%E3%80%81%E5%BC%80%E5%90%AF%E6%8F%92%E4%BB%B6%E5%8A%9F%E8%83%BD"> 3、开启插件功能</h4> 
<p><img alt="" height="663" src="https://images2.imgbox.com/33/47/7nQQ0KCW_o.png" width="1180"></p> 
<p><img alt="" height="278" src="https://images2.imgbox.com/36/94/nlQnIda1_o.png" width="1200"></p> 
<p><img alt="" height="776" src="https://images2.imgbox.com/22/81/WN2WEKNl_o.png" width="1200"></p> 
<h4 id="%C2%A04%E3%80%81%E9%AA%8C%E8%AF%81%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"> 4、验证用户管理</h4> 
<p>1、将刚才的授权策略改回原来的</p> 
<p><img alt="" height="359" src="https://images2.imgbox.com/4e/ae/lYeZAXx5_o.png" width="1200"></p> 
<p> <span style="color:#1a1a1a;">2、开启允许用户注册（全局安全配置）</span></p> 
<p><img alt="" height="756" src="https://images2.imgbox.com/18/82/GL7dl6x0_o.png" width="1200"></p> 
<p> 3、注册一个新用户</p> 
<p><img alt="" height="581" src="https://images2.imgbox.com/a6/1c/yeaFFL69_o.png" width="1200"></p> 
<p><img alt="" height="448" src="https://images2.imgbox.com/82/ff/aTKyqq24_o.png" width="1200"></p> 
<p><img alt="" height="318" src="https://images2.imgbox.com/d9/e5/6AzIkSXw_o.png" width="1200"></p> 
<p><img alt="" height="821" src="https://images2.imgbox.com/76/65/HQRcbG3j_o.png" width="1200"></p> 
<p> 4、登录之后默认就是管理员，可以做任何事</p> 
<p><img alt="" height="755" src="https://images2.imgbox.com/2d/09/Fgc7rdXH_o.png" width="1200"></p> 
<p> 5、将授权策略改为<span style="color:#333333;">Role-based Authorization Strategy，保存</span></p> 
<p><img alt="" height="172" src="https://images2.imgbox.com/75/26/4qNv0Jq1_o.png" width="1200"></p> 
<p> 6、刷新刚才登录的用户页面，发现什么权限都没有了</p> 
<p><img alt="" height="320" src="https://images2.imgbox.com/bc/cc/SI4bA3I4_o.png" width="1200"></p> 
<h4 id="%C2%A05%E3%80%81%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E5%88%92%E5%88%86"> 5、用户权限划分</h4> 
<p> <span style="color:#333333;">安装 Role-Based Strategy 插件后，系统管理 中多了如图下所示的一个功能，用户权限的划分就是靠他来做的。</span></p> 
<p><img alt="" height="436" src="https://images2.imgbox.com/8d/21/n2sZqFkj_o.png" width="1200"></p> 
<p><img alt="" height="414" src="https://images2.imgbox.com/19/9a/PMjIshDw_o.png" width="1200"> <span style="color:#1a1a1a;">1、Manage Roles（管理角色）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Manage Roles</span><span style="color:#333333;">：管理角色，相当于针对角色赋予不同权限，然后在将该角色分配给用户。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">角色就相当于一个组。其里面又有Global roles（全局）、item roles（项目）、node roles（），来进行不同划分。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Global roles </span><span style="color:#333333;">（全局角色）：管理员等高级用户可以创建基于全局的角色</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Item roles</span><span style="color:#333333;">（项目角色）：针对某个或者某些项目的角色</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">node roles</span><span style="color:#333333;">（节点角色）：节点相关的权限</span></p> 
<p><span style="color:#1a1a1a;">（1）Global roles</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">默认是有一个admin用户的，是所有权限都有的，所有权限都是勾选了的。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">接下来我们来添加一个角色：zcg</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">zcg</span><span style="color:#333333;">：该角色为全局角色。这个角色需要绑定Overall下面的Read权限，是为了给所有用户绑定最基本的Jenkins访问权限。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">注意：如果不给后续用户绑定这个角色，会报错误：用户名 is missing the Overall/Read permission</span></p> 
<p><span style="color:#1a1a1a;">（2）Project roles</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">roles to add</span><span style="color:#333333;">：表示项目角色</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Pattern</span><span style="color:#333333;">：是用来做正则匹配的（匹配的内容是Job(项目名)），比如说根据正则匹配到的项目项目角色就都有权限；</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">接下来新建项目角色，改项目角色一般给其构建、取消、读取、读取空间权限，一般配置这4个即可</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">demo </span><span style="color:#333333;">：该角色为项目角色。使用正则表达式绑定 “demo.*"，意思是只能操作 demo 开头的项目。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">web </span><span style="color:#333333;">：该角色也为项目角色。绑定 "web.*”，意思是只能操作 web 开头的项目。</span></p> 
<p><span style="color:#1a1a1a;">（3）node roles</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">node roles</span><span style="color:#333333;">（节点角色）：节点相关的权限</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">roles to add</span><span style="color:#333333;">：表示项目角色</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Pattern</span><span style="color:#333333;">：是用来做正则匹配的（匹配的内容是节点(slave节点）），比如说根据正则匹配到的项目项目角色就都有权限；</span></p> 
<p style="margin-left:.0001pt;text-align:left;">我们创建一个全局角色，两个项目角色</p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="460" src="https://images2.imgbox.com/a7/53/gbZlSGQ1_o.png" width="1200"></p> 
<p><img alt="" height="529" src="https://images2.imgbox.com/1a/09/i9J2C0NO_o.png" width="1200"></p> 
<p><img alt="" height="569" src="https://images2.imgbox.com/68/da/FLtdidHg_o.png" width="1200"></p> 
<p><img alt="" height="608" src="https://images2.imgbox.com/23/46/xQ9nvnIe_o.png" width="1200"></p> 
<p> 保存</p> 
<p><img alt="" height="315" src="https://images2.imgbox.com/d9/a7/mGNeFFIf_o.png" width="1198"></p> 
<p>2、 创建可登录用户</p> 
<p><img alt="" height="486" src="https://images2.imgbox.com/7b/19/5FuQXHUM_o.png" width="1200"></p> 
<p><img alt="" height="468" src="https://images2.imgbox.com/00/ee/kIcfkOob_o.png" width="1200"> <span style="color:#1a1a1a;">3、给用户分配角色</span></p> 
<p><img alt="" height="468" src="https://images2.imgbox.com/df/00/us55HDmk_o.png" width="1200"></p> 
<p><img alt="" height="334" src="https://images2.imgbox.com/54/fa/5Z5COGdH_o.png" width="885"></p> 
<p> <span style="color:#333333;">demo-1 用户分别绑定 baseRole 全局角色和 demo 项目角色（有删除权限）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">web-1 </span><span style="color:#333333;">用户分别绑定 baseRole 全局角色和 web 项目角色（没有删除权限）</span></p> 
<p><img alt="" height="495" src="https://images2.imgbox.com/71/26/8gp6YfPt_o.png" width="1200"></p> 
<p><img alt="" height="280" src="https://images2.imgbox.com/6e/fb/j2RsJyRa_o.png" width="1200"></p> 
<p> 记得保存</p> 
<p><img alt="" height="224" src="https://images2.imgbox.com/59/a0/Y5BgpyMA_o.png" width="692"></p> 
<p> 4、<span style="color:#1a1a1a;">创建对应的项目分配登录相关的用户</span><img alt="" height="307" src="https://images2.imgbox.com/7a/b3/Ojt5Bd0n_o.png" width="1200"></p> 
<p><img alt="" height="164" src="https://images2.imgbox.com/c0/34/BRgDKVIH_o.png" width="1200"></p> 
<p> web<span style="color:#333333;">-1 </span><span style="color:#333333;">用户登录，只能看到 web01（web开头的） 项目</span></p> 
<p><img alt="" height="369" src="https://images2.imgbox.com/c7/64/k6LpbX9Q_o.png" width="1200"></p> 
<p> demo<span style="color:#333333;">-1 </span><span style="color:#333333;">用户登录，只能看到 demo01（demo开头的） 项目</span> </p> 
<p><img alt="" height="387" src="https://images2.imgbox.com/b1/c6/XOedxZJr_o.png" width="1200"></p> 
<p> <span style="color:#1a1a1a;">5、验证 demo01 用户授权的项目</span></p> 
<p><img alt="" height="680" src="https://images2.imgbox.com/1b/ca/OdguxNIC_o.png" width="1200"></p> 
<p> 6、验证 web01 用户授权的项目</p> 
<p><img alt="" height="637" src="https://images2.imgbox.com/22/15/ptMWto8f_o.png" width="1200"></p> 
<h3 id="%C2%A06%E3%80%81Jenkins%20%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA"> 6、Jenkins 参数化构建</h3> 
<h4 id="1%E3%80%81%E5%8F%82%E6%95%B0%E5%8C%96%E6%9E%84%E5%BB%BA%E8%83%8C%E6%99%AF">1、参数化构建背景</h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">如果只是简单的构建，jenkins自己默认的插件可以做，但是如果我们想要在构建过程中有更多功能，比如说：选择性构建、传参、项目指定变量等等其他功能，基础的参数化构建可以实现一些简单功能，但是要想使用更多功能这时候我们就需要借助参数化构建来实现交互的功能。此处我们来借助以下插件来进行实现：</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Extended Choice Parameter</span><span style="color:#333333;">（更丰富的参数化构建插件）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">Git Parameter</span></p> 
<h4 id="2%E3%80%81%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6%E5%B9%B6%E4%BD%BF%E7%94%A8" style="margin-left:.0001pt;text-align:left;">2、安装插件并使用</h4> 
<p style="margin-left:.0001pt;text-align:left;">1、跟上面安装插件的步骤一样</p> 
<h4 id="%E2%80%8B%E7%BC%96%E8%BE%91" style="margin-left:.0001pt;text-align:left;"><img alt="" height="819" src="https://images2.imgbox.com/bb/17/ZrmcFEnn_o.png" width="1200"></h4> 
<p><img alt="" height="749" src="https://images2.imgbox.com/42/95/4BtvhFHg_o.png" width="1200"></p> 
<p>2、项目配置</p> 
<p><img alt="" height="486" src="https://images2.imgbox.com/42/a4/USerRDDY_o.png" width="1200"></p> 
<p><img alt="" height="632" src="https://images2.imgbox.com/da/d3/ByvPQ5bN_o.png" width="1200"></p> 
<p> <span style="color:#333333;">这里这个branch 就相当于给其当做一个变量，然后来为其进行传参</span><img alt="" height="387" src="https://images2.imgbox.com/db/4e/YBvFD6wU_o.png" width="1200"></p> 
<p><img alt="" height="378" src="https://images2.imgbox.com/c7/fa/dM5LDkDK_o.png" width="696"></p> 
<p> <img alt="" height="364" src="https://images2.imgbox.com/29/f1/RuHoFymJ_o.png" width="661"><img alt="" height="186" src="https://images2.imgbox.com/b8/df/xyH5LgEF_o.png" width="587"></p> 
<p> 3<span style="color:#1a1a1a;">、构建选择执行shell进行测试</span></p> 
<p><img alt="" height="441" src="https://images2.imgbox.com/cc/28/YgXqPn2r_o.png" width="782"></p> 
<p><img alt="" height="740" src="https://images2.imgbox.com/7e/ec/yne13P6B_o.png" width="1200"></p> 
<p> 4、参数化配置已经生效</p> 
<p></p> 
<p><img alt="" height="270" src="https://images2.imgbox.com/4e/33/0WqzmmGp_o.png" width="1200"></p> 
<p><img alt="" height="346" src="https://images2.imgbox.com/35/1b/KpRb4qrJ_o.png" width="760"> <img alt="" height="832" src="https://images2.imgbox.com/12/7f/g1iSy5yN_o.png" width="1200"></p> 
<p><img alt="" height="378" src="https://images2.imgbox.com/a7/9c/60NXF2PY_o.png" width="955"></p> 
<h4 id="%C2%A03%E3%80%81%C2%A0%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6"> 3、 数据来源选择文件</h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">在jenkins所在服务器进行如下操作：</span></p> 
<pre><code>[root@localhost ~]# vim /opt/jenkins.property
web=WEB-1,WEB-2,WEB-3                                                                                                          

</code></pre> 
<p> <span style="color:#333333;">web </span><span style="color:#333333;">端配置：</span></p> 
<p><img alt="" height="327" src="https://images2.imgbox.com/0e/07/a6suSt9l_o.png" width="1200"></p> 
<p><img alt="" height="322" src="https://images2.imgbox.com/43/17/TMquL5wr_o.png" width="890"> 文件的路径就是刚才创建的文件的绝对路径，key就是文件中的web<img alt="" height="399" src="https://images2.imgbox.com/33/bd/cJOvuGFz_o.png" width="1200"></p> 
<p> <img alt="" height="103" src="https://images2.imgbox.com/ad/d0/GL7xORZA_o.png" width="389"></p> 
<p>测试</p> 
<p><img alt="" height="128" src="https://images2.imgbox.com/19/48/3waYJNPV_o.png" width="1200"><img alt="" height="343" src="https://images2.imgbox.com/cd/e3/E6RYowms_o.png" width="587"> </p> 
<p><img alt="" height="378" src="https://images2.imgbox.com/ea/cf/JTPSWC0M_o.png" width="848"></p> 
<h2 id="%C2%A0%E4%B8%89%E3%80%81%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8Jenkins%2BGithub%2BTomcat%E5%AE%9E%E6%88%98"> 三、部署应用Jenkins+<a href="https://so.csdn.net/so/search?q=Github&amp;spm=1001.2101.3001.7020" title="Github">Github</a>+Tomcat实战</h2> 
<p>jenkins：192.168.242.147</p> 
<p>web服务器（tomcat）：192.168.242.148</p> 
<h3 id="%C2%A01%E3%80%81jenkins%E9%83%A8%E7%BD%B2"> 1、jenkins部署</h3> 
<h4 id="%C2%A01%E3%80%81%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"> 1、安装插件</h4> 
<p> 需要安装的插件如下：</p> 
<p>Maven Integration：jenkins利用Maven编译，打包所需插件</p> 
<p>Deploy to container：--支持自动化代码部署到tomcat容器</p> 
<p>Git 插件</p> 
<p>Publish Over SSH：通过ssh连接</p> 
<h4 id="2%E3%80%81%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B">2、插件安装过程</h4> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#333333;">系统管理---&gt;插件管理----&gt;可选插件---&gt;过滤（插件名字）----&gt;勾选---&gt;直接安装。具体方法前文一样（建议在安装Git插件的时候，把过滤出来的Git、Gitlab、Github的相关插件都安装一下，也不需要太长时间）</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><img alt="" height="378" src="https://images2.imgbox.com/15/49/IubdG5ZD_o.png" width="1187"></p> 
<p> <img alt="" height="516" src="https://images2.imgbox.com/07/1b/tBloX8yC_o.png" width="931"></p> 
<p> <img alt="" height="606" src="https://images2.imgbox.com/f3/fc/T8isEIFR_o.png" width="1165"></p> 
<p> <img alt="" height="785" src="https://images2.imgbox.com/13/9d/49WK8N5z_o.png" width="1178"></p> 
<p> <img alt="" height="512" src="https://images2.imgbox.com/5d/f0/EfWFu6iC_o.png" width="1196"></p> 
<p> <img alt="" height="610" src="https://images2.imgbox.com/52/2b/JgqW6QR4_o.png" width="1166"></p> 
<h4 id="%C2%A03%E3%80%81%E9%85%8D%E7%BD%AE%E9%82%AE%E7%AE%B1%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"> 3、配置邮箱（可选）</h4> 
<p>Jenkins 系统管理员邮件地址是Jenkins发送邮件通知时的发件人。<br> 使用管理员帐号登录Jenkins，打开系统管理-系统配置：</p> 
<p><img alt="" height="575" src="https://images2.imgbox.com/61/36/tb31Lc1i_o.png" width="867"></p> 
<p> 找到Jenkins Location栏，在系统管理员邮件地址框中输入系统管理员的邮箱</p> 
<p><img alt="" height="334" src="https://images2.imgbox.com/89/11/exHt50Le_o.png" width="877"></p> 
<p><img alt="" height="712" src="https://images2.imgbox.com/aa/aa/N8Qf9fFY_o.png" width="1046"></p> 
<p> ​​​​​​<img alt="" height="698" src="https://images2.imgbox.com/87/e7/L3db5biY_o.png" width="1054"></p> 
<p><img alt="" height="656" src="https://images2.imgbox.com/7a/ba/G0Zxd4As_o.png" width="1014"></p> 
<p><img alt="" height="755" src="https://images2.imgbox.com/0f/cc/PGLkiRiO_o.png" width="1052"></p> 
<p> 可以看到测试邮件</p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/7a/bc/T2rt4rWN_o.png" width="772"></p> 
<h4 id="%C2%A04%E3%80%81%E9%85%8D%E7%BD%AEJenkins%E7%A7%81%E9%92%A5"> 4、配置Jenkins私钥</h4> 
<pre><code>jenkins服务器：
[root@localhost ~]# ssh-keygen
[root@localhost ~]# cat .ssh/id_rsa
...</code></pre> 
<p><img alt="" height="666" src="https://images2.imgbox.com/11/36/DeYabKVu_o.png" width="1017"></p> 
<h4 id="%C2%A05%E3%80%81%E6%B7%BB%E5%8A%A0%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%99%A8"> 5、添加后端服务器</h4> 
<p>需要将jenkins的公钥发送给后端服务器，才能实现免密：</p> 
<pre><code>jenkins服务器：192.168.242.147
[root@localhost ~]# ssh-copy-id root@192.168.242.148</code></pre> 
<p><img alt="" height="661" src="https://images2.imgbox.com/af/12/kIeYDgvW_o.png" width="965"></p> 
<p><strong> 修改完配置一定记得保存，不保存白瞎</strong></p> 
<h4 id="%C2%A06%E3%80%81%E9%85%8D%E7%BD%AEjdk%EF%BC%8Cmaven%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE"> 6、配置jdk，maven命令，全局配置</h4> 
<p>虽然Jenkins服务器上，已经安装了JDK和maven工具，但是，还需要在Jenkins服务中，进行配置；这样Jenkins才能自动化的使用两个工具；</p> 
<p><img alt="" height="145" src="https://images2.imgbox.com/07/d0/5PRiLQXe_o.png" width="778"></p> 
<p><img alt="" height="135" src="https://images2.imgbox.com/bb/41/zK6ETXmI_o.png" width="846"></p> 
<p> 必须把自动安装取消了<img alt="" height="339" src="https://images2.imgbox.com/25/2b/4bhQ5K6e_o.png" width="923"></p> 
<p> <img alt="" height="559" src="https://images2.imgbox.com/1f/b7/N62VaDlJ_o.png" width="984"></p> 
<p> <img alt="" height="162" src="https://images2.imgbox.com/d8/c9/r70lNSdi_o.png" width="655"></p> 
<p><img alt="" height="155" src="https://images2.imgbox.com/ab/4b/dvm335Vb_o.png" width="354"></p> 
<p> 同样要把自动安装取消掉</p> 
<p><img alt="" height="442" src="https://images2.imgbox.com/d9/c0/OFshoGiN_o.png" width="744"></p> 
<p><img alt="" height="489" src="https://images2.imgbox.com/40/de/LE5zoPP8_o.png" width="835"></p> 
<p><strong>修改完后点击保存。</strong> 如果有多个jdk和maven需要配置的话，可以点击新增jdk或者新增maven；</p> 
<h4 id="7%E3%80%81%E6%9E%84%E5%BB%BA%E5%8F%91%E5%B8%83%E4%BB%BB%E5%8A%A1">7、构建发布任务</h4> 
<p><img alt="" height="140" src="https://images2.imgbox.com/83/08/MlcHPx5Q_o.png" width="884"></p> 
<p> <img alt="" height="1200" src="https://images2.imgbox.com/ca/45/BvxIdjkX_o.png" width="1200"></p> 
<p> <img alt="" height="692" src="https://images2.imgbox.com/97/ba/6SMeeV08_o.png" width="1102"></p> 
<p> <a href="https://github.com/bingyue/easy-springmvc-maven" title='GitHub - bingyue/easy-springmvc-maven: A simple demo about how to use maven combine spring mvc,for the blog "Jenkins application" sample'>GitHub - bingyue/easy-springmvc-maven: A simple demo about how to use maven combine spring mvc,for the blog "Jenkins application" sample</a></p> 
<p>这里是我再github上，找的一个测试的小项目。能进行编译打包</p> 
<p><img alt="" height="395" src="https://images2.imgbox.com/2a/f7/xCEWy0hr_o.png" width="848"></p> 
<p><img alt="" height="756" src="https://images2.imgbox.com/bf/65/YLkqHRBN_o.png" width="1200"></p> 
<p><img alt="" height="268" src="https://images2.imgbox.com/f9/d3/nTDdz8zv_o.png" width="909"></p> 
<p><img alt="" height="740" src="https://images2.imgbox.com/9e/4c/kBiacf57_o.png" width="1200"></p> 
<p> 调用maven命令</p> 
<p><img alt="" height="365" src="https://images2.imgbox.com/c8/fa/HOqmaOP1_o.png" width="801"></p> 
<p><img alt="" height="109" src="https://images2.imgbox.com/fc/74/yDKFjESI_o.png" width="728"></p> 
<h3 id="%C2%A02%E3%80%81%E9%83%A8%E7%BD%B2java%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%81%9Ajenkins%E6%89%93%E5%8C%85%E4%B8%8A%E7%BA%BF"> 2、部署java服务器，做jenkins打包上线</h3> 
<p>java服务器（web服务器tomcat）：192.168.242.148</p> 
<pre><code>[root@localhost ~]# ls
apache-tomcat-8.5.69.tar.gz  jdk-8u191-linux-x64.tar.gz
[root@localhost ~]# tar zxf jdk-8u191-linux-x64.tar.gz -C /usr/local/
[root@localhost ~]# mv /usr/local/jdk1.8.0_191 /usr/local/java
[root@localhost ~]# mkdir -p /data/application
[root@localhost ~]# tar zxf apache-tomcat-8.5.69.tar.gz -C /data/application
[root@localhost ~]# mv /data/application/apache-tomcat-8.5.69/ /data/application/tomcat
[root@localhost ~]# vim /etc/profile
....在最后插入下面内容
JAVA_HOME=/usr/local/java
TOMCAT_HOME=/data/application/tomcat
PATH=$JAVA_HOME/bin:$TOMCAT_HOME/bin:$PATH
export PATH JAVA_HOME TOMCAT_HOME
[root@localhost ~]# source /etc/profile
[root@localhost ~]# java -version
java version "1.8.0_191"
Java(TM) SE Runtime Environment (build 1.8.0_191-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)
删除tomcat默认发布目录下面的内容:
[root@localhost ~]# rm -rf /data/application/tomcat/webapps/*
创建目录和脚本:
[root@localhost ~]# mkdir /opt/script
[root@localhost ~]# vim /opt/script/app-jenkins.sh
#!/usr/bin/bash
#本脚本适用于jenkins持续集成，实现备份war包到代码更新上线！使用时请注意全局变量。
#================
#Defining variables
export JAVA_HOME=/usr/local/java
webapp_path="/data/application/tomcat/webapps"
tomcat_run="/data/application/tomcat/bin"
updata_path="/data/update/`date +%F-%T`"
backup_path="/data/backup/`date +%F-%T`"
tomcat_pid=`ps -ef | grep tomcat | grep -v grep | awk '{print $2}'`
files_dir="easy-springmvc-maven"
files="easy-springmvc-maven.war"
job_path="/root/upload"

#Preparation environment
echo "Creating related directory"
mkdir -p $updata_path
mkdir -p $backup_path

echo "Move the uploaded war package to the update 2directory"
mv $job_path/$files $updata_path

echo "========================================================="
cd /opt
echo "Backing up java project"
if [ -f $webapp_path/$files ];then
	tar czf $backup_path/`date +%F-%H`.tar.gz $webapp_path
	if [ $? -ne 0 ];then
		echo "打包失败，自动退出"
		exit 1
	else
		echo "Checking if tomcat is started"
		if [ -n "$tomcat_pid" ];then
			kill -9 $tomcat_pid
			if [ $? -ne 0 ];then
				echo "tomcat关闭失败，将会自动退出"
				exit 2
			fi
		fi
		cd $webapp_path
		rm -rf $files &amp;&amp; rm -rf $files_dir
		cp $updata_path/$files $webapp_path
		cd /opt
		$tomcat_run/startup.sh
		sleep 5
		echo "显示tomcat的pid"
		echo "`ps -ef | grep tomcat | grep -v grep | awk '{print $2}'`"
		echo "tomcat startup"
		echo "请手动查看tomcat日志。脚本将会自动退出"
	fi
else
	echo "Checking if tomcat is started"
        if [ -n "$tomcat_pid" ];then
        	kill -9 $tomcat_pid
                if [ $? -ne 0 ];then
                	echo "tomcat关闭失败，将会自动退出"
                       	exit 2
                fi
        fi
	cp $updata_path/$files $webapp_path
	$tomcat_run/startup.sh
        sleep 5
        echo "显示tomcat的pid"
        echo "`ps -ef | grep tomcat | grep -v grep | awk '{print $2}'`"
        echo "tomcat startup"
        echo "请手动查看tomcat日志。脚本将会自动退出"
[root@localhost ~]# chmod a+x /opt/script/app-jenkins.sh</code></pre> 
<h3 id="3%E3%80%81%E5%9B%9E%E5%88%B0jenkins%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA%E4%BB%BB%E5%8A%A1">3、回到jenkins页面开始构建任务</h3> 
<p><img alt="" height="466" src="https://images2.imgbox.com/25/d6/W4nAqard_o.png" width="1200"></p> 
<p><img alt="" height="297" src="https://images2.imgbox.com/17/32/1QwJzW9h_o.png" width="1200"></p> 
<p> 多构建几次，看到下图内容，说明构建成功</p> 
<p><img alt="" height="773" src="https://images2.imgbox.com/16/0b/j1TmZ5r9_o.png" width="1200"></p> 
<h2 id="%E5%9B%9B%E3%80%81%E9%83%A8%E7%BD%B2jenkins%2Bgitlab%2Btomcat%E5%AE%9E%E6%88%98">四、部署jenkins+gitlab+tomcat实战</h2> 
<p>我们的实验环境没变，还是上面那个实验的jenkins和tomcat服务器，只是将远程仓库github改成了gitlab，这个gitlab是我们自己创建的私服，gitlab的的部署过程也比较长，这里就不写了，可以看之前的gitlab部署文章：<a class="link-info" href="https://blog.csdn.net/fajixianshouhu/article/details/124701256?spm=1001.2014.3001.5501" title="Gti版本控制系统Github与Gitlab的使用">Gti版本控制系统Github与Gitlab的使用</a></p> 
<p>实验环境：</p> 
<p>jenkins：192.168.242.147</p> 
<p>gitlab：192.168.242.145</p> 
<p>tomcat：192.168.242.148</p> 
<h3 id="1%E3%80%81gitlab%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E4%B8%8E%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E9%85%8D%E7%BD%AE">1、gitlab本地仓库与远程仓库的配置</h3> 
<p>因为我们要从gitlab远程仓库拉取文件到本地，所以gitlab服务器上也要下载git（要注意gitlab是远程仓库，git是版本控制系统）</p> 
<pre><code>gitlab:192.168.242.145
[root@localhost ~]# yum -y install git
安装之后，添加全局配置（username email）
[root@localhost ~]# git config --global user.name "root"
[root@localhost ~]# git config --global user.email "blg_uzi@163.com"</code></pre> 
<p>添加完全局配置后，还需要将root用户的公钥添加到gitlab的SSH密钥配置中<img alt="" height="349" src="https://images2.imgbox.com/aa/54/tSXdyUdb_o.png" width="857"></p> 
<p> <img alt="" height="652" src="https://images2.imgbox.com/bc/dc/xWtHH0iE_o.png" width="521"></p> 
<p><img alt="" height="696" src="https://images2.imgbox.com/1e/6b/Lp3lzYbl_o.png" width="1200"></p> 
<p> 在gitlab中创建一个分支</p> 
<p><img alt="" height="804" src="https://images2.imgbox.com/42/7c/sGBM5JEF_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/3e/dd/71UeTnbl_o.png" width="1200"></p> 
<p> 然后需要将main这个分支的保护机制取消，不然我们只能拉取文件到本地，但是无法将文件推送到main分支。</p> 
<p><img alt="" height="844" src="https://images2.imgbox.com/a5/17/rIUv3IuL_o.png" width="1200"></p> 
<p><img alt="" height="741" src="https://images2.imgbox.com/72/33/MA9eYlPD_o.png" width="1200"></p> 
<p> 然后我们在本地将cloud仓库拉取到本地，将项目的拷贝到拉取过来的文件中，接着讲文件推送到main分支</p> 
<pre><code>gitlab：192.168.242.145
[root@www ~]# unzip easy-springmvc-maven-master.zip
[root@www ~]# git clone git@www.zcg666.com:root/cloud.git
[root@www ~]# ls
anaconda-ks.cfg  cloud  easy-springmvc-maven-master  easy-springmvc-maven-master.zip
[root@www ~]# cp -r easy-springmvc-maven-master/* cloud/
同意覆盖文件 y
[root@www ~]# cd cloud
[root@www cloud]# git add .
[root@www cloud]# git commit -m "a"
...
[root@www cloud]# git push -u origin main
...
</code></pre> 
<p> 在gialab远程仓库查看是否推送成功</p> 
<p><img alt="" height="655" src="https://images2.imgbox.com/25/53/HxDIrHnS_o.png" width="1200"></p> 
<h3 id="2%E3%80%81jenkins%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE">2、jenkins服务器的配置</h3> 
<p> jenkins是从gitlab远程仓库拉取数据，所以jenkins服务器也要下载git，并进行相应的全局配置，因为我们的域名是假的，所以要提前关闭ssl，并且jenkins也要做域名解析，</p> 
<pre><code>jenkins：192.168.242.147
vim /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.242.145 www.zcg666.com
[root@localhost ~]# git config --global user.name "root"
[root@localhost ~]# git config --global user.email "blg_uzi@163.com"
[root@localhost ~]# git config --global http.sslVerify "false"
[root@localhost ~]# git config --global http.sslVerify false
[root@localhost ~]# cat /root/.gitconfig 
[user]
	name = root
	email = blg_uzi@163.com
[http]
	sslVerify = false
</code></pre> 
<h3 id="3%E3%80%81web%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88tomcat%EF%BC%89%E7%8E%AF%E5%A2%83%E6%B8%85%E7%90%86">3、web服务器（tomcat）环境清理</h3> 
<p>接下来是tomcat服务器环境清理</p> 
<pre><code>tomcat：192.18.242.148
[root@localhost ~]# /data/application/tomcat/bin/shutdown.sh
[root@localhost webapps]# cd /data/application/tomcat/webapps/
[root@localhost webapps]# rm -rf easy-springmvc-maven easy-springmvc-maven.war 
[root@localhost webapps]# cd /data/
[root@localhost data]# rm -rf backup/ update/</code></pre> 
<h3 id="4%E3%80%81jenkins%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE">4、jenkins项目的创建与配置</h3> 
<p>接着就可以去jenkins的页面上创建一个项目，进行相关配置</p> 
<p><img alt="" height="803" src="https://images2.imgbox.com/16/2a/mM1sTD3p_o.png" width="1200"></p> 
<p> 选择丢弃旧版本<img alt="" height="709" src="https://images2.imgbox.com/a9/0e/h8G1Mxkx_o.png" width="1200"></p> 
<p>源码管理</p> 
<p><img alt="" height="813" src="https://images2.imgbox.com/79/86/cy76Gm8N_o.png" width="1200"></p> 
<p> 构建环境</p> 
<p><img alt="" height="730" src="https://images2.imgbox.com/64/ff/D94s0h4V_o.png" width="1200"></p> 
<p><img alt="" height="446" src="https://images2.imgbox.com/14/e3/46N5FdpD_o.png" width="1200"></p> 
<p><img alt="" height="344" src="https://images2.imgbox.com/f6/50/6oizLpHE_o.png" width="1200"></p> 
<p><img alt="" height="86" src="https://images2.imgbox.com/85/12/wRpdLtjx_o.png" width="721"></p> 
<p> 按照上边标记的修改，其他的使用默认就行，修改完记得保存</p> 
<h3 id="5%E3%80%81%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA">5、项目构建</h3> 
<p><img alt="" height="311" src="https://images2.imgbox.com/75/53/uKPLxF2y_o.png" width="1200"></p> 
<p><img alt="" height="358" src="https://images2.imgbox.com/93/93/JUxMfjVc_o.png" width="1200"></p> 
<p> 然后访问web服务器进一步验证192.168.242.148:8080/easy-springmvc-maven</p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/44/d1/5WZan2VI_o.png" width="1019"></p> 
<p></p> 
<h3 id="%C2%A06%E3%80%81%E6%8E%92%E9%94%99"> 6、排错</h3> 
<p>在配置源码管理时，输入了gitlab仓库的https连接出现以下错误：</p> 
<p><img alt="" height="239" src="https://images2.imgbox.com/5e/e2/Si87gniq_o.png" width="1200"></p> 
<p> 出现这个错误，可以排查以下几个方面：</p> 
<p>1、检查gitlab的仓库是不是公开的</p> 
<p><img alt="" height="174" src="https://images2.imgbox.com/e5/b7/ZrjsDcIA_o.png" width="611"></p> 
<p>2、检查jenkins服务器和gitlab服务器的域名解析是否一致</p> 
<p><img alt="" height="85" src="https://images2.imgbox.com/a1/15/an7ZfLxF_o.png" width="927"></p> 
<p><img alt="" height="86" src="https://images2.imgbox.com/1e/6c/EAy2SpUs_o.png" width="961"></p> 
<p> 3、检查gitlab的配置文件/etc/gitlab/gitlab.rb中的external_url 'https://xxxx'与域名解析中的内容是否一致</p> 
<p><img alt="" height="65" src="https://images2.imgbox.com/90/1e/5Nkw8Huo_o.png" width="552"></p> 
<p> 4、检查jenkins是否做了gitlab的全局配置和是否关闭ssl</p> 
<p><img alt="" height="132" src="https://images2.imgbox.com/b1/0c/uILbjyEX_o.png" width="654"></p> 
<p> 如果没有的话，需要添加，可以直接在配置文件里修改，也可以通过命令</p> 
<p><img alt="" height="279" src="https://images2.imgbox.com/04/27/aAWrDldY_o.png" width="757"></p> 
<h2 id="%E4%BA%94%E3%80%81%20Gitlab%2Bjenkins%2Btomcat%2Bwebhook%20%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83">五、 Gitlab+jenkins+tomcat+webhook 自动发布</h2> 
<p>之前部署了Gitlab的代码托管平台和Jenkins的代码发布平台。通常是开发后的代码先推到Gitlab上管理，然后在Jenkins里通过脚本构建代码发布。这种方式每次在发版的时候，需要人工去执行jenkins上的构建动作，有时显得过于繁琐。于是就想到了Gitlab的Webhook功能，通过Webhook的相关设置，可以实现代码Push后，自动去触发jenkins上的构建动作，这样就不需要人工干预去执行发版操作了。</p> 
<p>目的：当我们修改仓库代码，提交的时候，提交完成他会自动触发jenkins，实验项目的自动发布。</p> 
<p>如果开发人员修改了代码；（钩子）利用webhook自动去代码仓库（gitlab）获取新的代码，在jenkins上利用maven进行构建；构建完成后发布到web-server（新版本的上线【新版本自动化上线】）</p> 
<h3 id="1%E3%80%81jenkins%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6">1、jenkins安装插件</h3> 
<p>插件：Generic Webhook Trigger</p> 
<p><img alt="" height="696" src="https://images2.imgbox.com/69/a2/QYoqPsX0_o.png" width="1200"></p> 
<p> 安装完成之后开始配置项目，在上面那个实验的基础上做修改</p> 
<p>构建触发器：在将更改的代码推送到 GitLab 时自动进行构建。</p> 
<p><img alt="" height="324" src="https://images2.imgbox.com/57/f9/FtclyEri_o.png" width="1200"></p> 
<p><img alt="" height="813" src="https://images2.imgbox.com/34/ac/isDmEQwd_o.png" width="1200"></p> 
<p><img alt="" height="672" src="https://images2.imgbox.com/d2/55/QszK994O_o.png" width="1200"></p> 
<h3 id="%C2%A02%E3%80%81gitlab%E9%85%8D%E7%BD%AE%E9%A1%B9%E7%9B%AE%E7%9A%84webhook"> 2、gitlab配置项目的webhook</h3> 
<p>1、开启允许从 Web 挂钩和服务向本地网络发出请求功能</p> 
<p><img alt="" height="425" src="https://images2.imgbox.com/6e/ae/EkTZ7KJb_o.png" width="752"></p> 
<p><img alt="" height="842" src="https://images2.imgbox.com/f3/b7/2acJEzHY_o.png" width="1200"></p> 
<p> 2、配置项目的webhook</p> 
<p><img alt="" height="903" src="https://images2.imgbox.com/fd/60/0q28x5Mj_o.png" width="1200"></p> 
<p><img alt="" height="770" src="https://images2.imgbox.com/26/b5/h6pTSi5I_o.png" width="1200"></p> 
<p><img alt="" height="700" src="https://images2.imgbox.com/e4/29/zu8E0Kgy_o.png" width="1072"></p> 
<p> 注意：看到200状态码说明设置成功。可以进行测试</p> 
<p><img alt="" height="473" src="https://images2.imgbox.com/0a/93/o08sgSmC_o.png" width="1092"></p> 
<p><img alt="" height="143" src="https://images2.imgbox.com/37/9b/oesAk4mG_o.png" width="1145"></p> 
<p> 然后在jenkins的界面上可以看到左下角的构建队列产生了一个任务</p> 
<p><img alt="" height="113" src="https://images2.imgbox.com/3a/95/RVNi9R5B_o.png" width="390"></p> 
<p> 在构建历史中查看控制台输出，可以看到构建成功<img alt="" height="696" src="https://images2.imgbox.com/b1/2d/k3RgRVnn_o.png" width="1200"></p> 
<p><img alt="" height="281" src="https://images2.imgbox.com/3c/c5/6HHh42Za_o.png" width="929"></p> 
<h3 id="3%E3%80%81%E6%B5%8B%E8%AF%95%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83">3、测试自动发布</h3> 
<p> 说明我们的webhook配置成功，我们进一步验证，修改一下gitlab远程仓库中的代码，让jenkins实现自动构建，构建完成后发布到web-server上</p> 
<p><img alt="" height="671" src="https://images2.imgbox.com/c9/93/PW6iKaOb_o.png" width="1200"></p> 
<p><img alt="" height="393" src="https://images2.imgbox.com/fd/61/tEDnGKlF_o.png" width="1164"></p> 
<p><img alt="" height="306" src="https://images2.imgbox.com/23/57/doWmDcux_o.png" width="1150"><img alt="" height="434" src="https://images2.imgbox.com/cd/47/hYtDcnYx_o.png" width="1056"></p> 
<p> 我们修改其中的内容</p> 
<p><img alt="" height="272" src="https://images2.imgbox.com/da/0e/TMy98u5x_o.png" width="1195"></p> 
<p><img alt="" height="529" src="https://images2.imgbox.com/71/b8/IlUCq0YS_o.png" width="1035"></p> 
<p><img alt="" height="352" src="https://images2.imgbox.com/a3/60/ON0FYaLJ_o.png" width="1200"></p> 
<p><img alt="" height="62" src="https://images2.imgbox.com/29/1b/1xKcZTZ2_o.png" width="435"></p> 
<p> 在jenkins上查看</p> 
<p><img alt="" height="442" src="https://images2.imgbox.com/31/db/oTlr3h2M_o.png" width="1200"></p> 
<p> 然后访问web-server，查看是否发生变化</p> 
<p><img alt="" height="238" src="https://images2.imgbox.com/f9/c8/LpsRLP14_o.png" width="885"></p> 
<p> 说明我们的实验部署成功，jenkins实现自动构建，并发布到web-server</p> 
<h3 id="4%E3%80%81%E6%8E%92%E9%94%99">4、排错</h3> 
<h4 id="1%E3%80%81gitlab%E5%87%BA%E7%8E%B0500%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><strong>1、gitlab出现500错误的解决方法</strong></h4> 
<p id="uf5dbb429"><strong>在保证所有配置都正确的前提下，在jenkins端进行以下操作:</strong></p> 
<p id="ucc47affa"><strong>项目主页----&gt;项目配置----&gt;构建触发器----&gt;高级----&gt;勾选“允许所有分支触发此作业”</strong></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/7f/21/YZ6RD4hB_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/1c/df/OoPvr9YF_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ad/f7/0foDW2kg_o.png"></p> 
<p id="ub6622587"><strong>注意：勾选保存退出后，再次进入查看会发现没有勾选，此为正常情况。</strong></p> 
<p id="u27ea7da7"><strong>再回到Gitlab端测试WebHooks服务。</strong></p> 
<h4 id="%C2%A02%E3%80%81%E5%9C%A8gitlab%E6%B5%8B%E8%AF%95webhook%E5%8A%9F%E8%83%BD%E7%9A%84%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0403%EF%BC%8C%E5%9B%BE%E7%89%87%E5%A6%82%E4%B8%8B%EF%BC%9A"> 2、在gitlab测试webhook功能的时候出现403，图片如下：</h4> 
<p><img alt="" height="238" src="https://images2.imgbox.com/0c/db/hM9fqYNO_o.png" width="1200"></p> 
<p>解决方案：下面的步骤都是在jenkins界面中做的</p> 
<p><strong>设置匿名用户拥有可读权限</strong></p> 
<p>Manage jenkins-&gt;Security-&gt;Configure Global Security</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/65/0a/B6scvwFy_o.png"></p> 
<p> 选择登陆用户可以做任何事，并开启匿名用户具有可读权限<img alt="" height="1200" src="https://images2.imgbox.com/6b/ad/0csCzs4i_o.png" width="1200"></p> 
<p><strong> 去掉Gitlab enable authentication 点选 放开</strong></p> 
<p>系统管理 -&gt; 系统设置 -&gt; Enable authentication for '/project' end-point</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/83/aa/BHyK71rJ_o.png"></p> 
<p></p> 
<p><strong>总结</strong></p> 
<pre><code>实验一：Gitlab+jenkins+web-server（tomcat）

更换了存放项目的仓库  gitlab 私有仓库（本地） 源码的下载速度也会提升

gitlab正常使用，gitlab仓库， cloud  项目上传到仓库
注意：在提交代码
有git命令，安装git，添加全局配置（username email）
git config --global user.email "xingdianvip@gmail.com"
git config --global user.name "xingdian"

取消gitlab中cloud的仓库main分支的保护（能够向main这个分支提交代码）

如果使用域名做本地解析，在gitlab添加提交服务器的公钥

git clone git@gitlab.example.com:xingdian/cloud.git

将项目压缩包上传到服务器 .zip 解压  并把解压后的内容拷贝到仓库目录下

git提交代码到cloud仓库 main分支



项目上传到仓库（操作）

更换成gitlab仓库地址
去掉gitlab的认证



实验二：GitHub+jenkins+web-server（tomcat） 构建的时候  网络连接超时（正常现象） githud仓库地址

1.安装对应的插件（jenkins） 
Deploy to container
Git （插件比较多）
Maven Integration
Publish Over SSH 
2.配置ssh
添加jenkins的私钥到key的位置
配置web-server的相关信息（name，ip地址，用户，目录）
jenkins---&gt; web-server 免密
3.全局配置 git maven jdk 相关配置
4.创建任务


实验三：Gitlab+jenkins+web-server（tomcat）+webhook 自动发布

当我们修改仓库代码，提交的时候，提交完成他会自动触发jenkins，实验项目的自动发布

如果开发人员修改了代码；（钩子）利用webhook自动去代码仓库（gitlab）获取新的代码，在jenkins上利用maven进行构建；
构建完成后发布到web-server（新版本的上线【新版本自动化上线】）

1.jenkins
	安装插件（Generic Webhook Trigger）
	配置项目（上午cloud项目，在这个基础上做的修改）
		在构建触发器：
			在将更改推送到 GitLab 时进行构建。GitLab webhook URL： http://192.168.222.129:8080/jenkins/project/cloud
	保证（gitlab的）webhook能够连接jenkins
		配置 ---&gt;  gitlab /project  对勾去掉
		全局安全配置 ----&gt; 保证登录用户可以做任何事情（匿名用户具有可读权限）
2.gitlab
	开启本地网络访问权限（目录：webhook能够连接jenkins）
	menu ---&gt; admin ---&gt;设置 ---&gt;网络 ----&gt; 出站请求  允许即可
	配置项目的webhook
	项目cloud---&gt;设置---&gt;webhook (添加)  网址 ：http://192.168.222.129:8080/jenkins/project/cloud （图见笔记） ---&gt; 测试 200 ok

3.gitlab（模拟项目代码的更新提交）
	项目cloud ---&gt; src/main/webapp/index.jsp ---&gt; 修改完后记得提交 （观察jenkins对应的项目） 等待一段时候后，浏览器访问web-server
</code></pre> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/76f9e7b4dfc8ac1878e67ae8fa01a94b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二分查找-面试选择题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/42d15960572d11cd8113c27e0d068ba7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java8 stream的常用法记录</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>