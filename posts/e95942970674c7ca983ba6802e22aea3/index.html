<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>spring注入jdbcTemplate时一直为空指针null - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="spring注入jdbcTemplate时一直为空指针null" />
<meta property="og:description" content="今天做一个项目，多数据源，第二个数据源采用的是spring的jdbcTemplate。三个项目，两个都没问题，其中一个jdbcTemplate一直为null。检查了一下，在spring启动时，jdbcTemplate对象也是有数据的，就是不知道为啥启动好之后，就变成null了，很头疼。后来去网上找了一下，发现其中一种解决方案可以解决我的问题。
先上我有问题的代码吧。
1、数据库配置（app-smsJdbc.xml）：
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;beans xmlns=&#34;http://www.springframework.org/schema/beans&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xmlns:context=&#34;http://www.springframework.org/schema/context&#34; xmlns:aop=&#34;http://www.springframework.org/schema/aop&#34; xmlns:tx=&#34;http://www.springframework.org/schema/tx&#34; xsi:schemaLocation=&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&#34;&gt; &lt;!-- IOC和DI的注解扫描 --&gt; &lt;context:component-scan base-package=&#34;cn.gtmap.estateplat.register.service.smsImpl&#34; &gt;&lt;/context:component-scan&gt; &lt;!-- 打开AOP的注解 --&gt; &lt;!-- 这里用的是中间的横线而不是下划线 --&gt; &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt; &lt;bean id=&#34;dataSource&#34; class=&#34;com.mchange.v2.c3p0.ComboPooledDataSource&#34; &gt; &lt;property name=&#34;driverClass&#34; value=&#34;${sms.db.driver}&#34;&gt;&lt;/property&gt; &lt;property name=&#34;jdbcUrl&#34; value=&#34;${sms.db.url}&#34;&gt;&lt;/property&gt; &lt;property name=&#34;user&#34; value=&#34;${sms.db.username}&#34;&gt;&lt;/property&gt; &lt;property name=&#34;password&#34; value=&#34;${sms.db.password}&#34;&gt;&lt;/property&gt; &lt;/bean&gt; &lt;bean id=&#34;jdbcTemplate&#34; class=&#34;org.springframework.jdbc.core.JdbcTemplate&#34;&gt; &lt;property name=&#34;dataSource&#34; ref=&#34;dataSource&#34;&gt;&lt;/property&gt; &lt;/bean&gt; &lt;bean id=&#34;cmccSmsServiceImpl&#34; class=&#34;cn.gtmap.estateplat.register.service.smsImpl.CmccSmsServiceImpl&#34;&gt; &lt;property name=&#34;jdbcTemplate&#34; ref=&#34;jdbcTemplate&#34;&gt;&lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt; 2、Java代码（CmccSmsServiceImpl.java）：
package cn.gtmap.estateplat.register.service.smsImpl; import cn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e95942970674c7ca983ba6802e22aea3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-31T17:14:46+08:00" />
<meta property="article:modified_time" content="2018-08-31T17:14:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">spring注入jdbcTemplate时一直为空指针null</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>今天做一个项目，多数据源，第二个数据源采用的是spring的jdbcTemplate。三个项目，两个都没问题，其中一个jdbcTemplate一直为null。检查了一下，在spring启动时，jdbcTemplate对象也是有数据的，就是不知道为啥启动好之后，就变成null了，很头疼。后来去网上找了一下，发现其中一种解决方案可以解决我的问题。</p> 
<p>先上我有问题的代码吧。</p> 
<p>1、数据库配置（app-smsJdbc.xml）：</p> 
<pre class="has"><code class="language-html">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
    &lt;beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:context="http://www.springframework.org/schema/context"
        xmlns:aop="http://www.springframework.org/schema/aop"
        xmlns:tx="http://www.springframework.org/schema/tx"
        xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop.xsd
       http://www.springframework.org/schema/tx
       http://www.springframework.org/schema/tx/spring-tx.xsd"&gt;

    &lt;!-- IOC和DI的注解扫描 --&gt;
    &lt;context:component-scan base-package="cn.gtmap.estateplat.register.service.smsImpl" &gt;&lt;/context:component-scan&gt;

    &lt;!-- 打开AOP的注解 --&gt;
    &lt;!-- 这里用的是中间的横线而不是下划线 --&gt;
    &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;

    &lt;bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" &gt;
        &lt;property name="driverClass" value="${sms.db.driver}"&gt;&lt;/property&gt;
        &lt;property name="jdbcUrl" value="${sms.db.url}"&gt;&lt;/property&gt;
        &lt;property name="user" value="${sms.db.username}"&gt;&lt;/property&gt;
        &lt;property name="password" value="${sms.db.password}"&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate"&gt;
        &lt;property name="dataSource" ref="dataSource"&gt;&lt;/property&gt;
    &lt;/bean&gt;

    &lt;bean id="cmccSmsServiceImpl" class="cn.gtmap.estateplat.register.service.smsImpl.CmccSmsServiceImpl"&gt;
        &lt;property name="jdbcTemplate" ref="jdbcTemplate"&gt;&lt;/property&gt;
    &lt;/bean&gt;

&lt;/beans&gt;</code></pre> 
<p>2、Java代码（CmccSmsServiceImpl.java）：</p> 
<pre class="has"><code class="language-java">package cn.gtmap.estateplat.register.service.smsImpl;

import cn.gtmap.estateplat.core.ex.AppException;
import cn.gtmap.estateplat.register.service.SmsService;
import cn.gtmap.estateplat.utils.CalendarUtil;
import com.gtis.common.util.UUIDGenerator;
import org.apache.commons.collections.CollectionUtils;
import org.apache.commons.lang3.StringUtils;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Service;

import javax.annotation.Resource;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

@Service("cmccSmsServiceImpl")
public class CmccSmsServiceImpl implements SmsService {

    private static final String PHONE_NUMBER_NULL = "电话号码为空！";
    private static final String CONTENT_NUMBER_NULL = "短信内容为空！";
    private static final String REQDELIVERYREPORT_NO_NUMBER = "需要状态报告不是数字！";
    private static final String MSGFMT_NO_NUMBER = "消息类型不是数字！";
    private static final String SENDMETHOD_NO_NUMBER = "短信发送形式不是数字！";
    private String extCode = "**";
    private String reqDeliveryReport = "*";
    private String msgFmt = "*";
    private String sendMethod = "*";
    private String applicationId = "**********";

    private JdbcTemplate jdbcTemplate;

    public JdbcTemplate getJdbcTemplate() {
        return jdbcTemplate;
    }
    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    @Override
    public void sendSms(HashMap hashMap, String model, String phone) {
        List&lt;String&gt; phoneList = new ArrayList&lt;String&gt;();
        phoneList.add(phone);
        if (CollectionUtils.isEmpty(phoneList)) {
            throw new AppException("电话号码为空！");
        } else if (StringUtils.isBlank(model)) {
            throw new AppException("短信内容为空！");
        } else if (!StringUtils.isNumeric(this.reqDeliveryReport)) {
            throw new AppException("需要状态报告不是数字！");
        } else if (!StringUtils.isNumeric(this.msgFmt)) {
            throw new AppException("消息类型不是数字！");
        } else if (!StringUtils.isNumeric(this.sendMethod)) {
            throw new AppException("短信发送形式不是数字！");
        } else {
            String sql = "INSERT INTO **** (SISMSID, EXTCODE, DESTADDR,MESSAGECONTENT, REQDELIVERYREPORT, MSGFMT, SENDMETHOD, REQUESTTIME, APPLICATIONID) VALUES (?,?,?,?,?,?,?,?,?)";
           // for(String phoneNum:phoneList){
                try {
                    Object[] param = new Object[]{UUIDGenerator.generate18(), this.extCode, phone, model, Integer.parseInt(this.reqDeliveryReport), Integer.parseInt(this.msgFmt), Integer.parseInt(this.sendMethod), CalendarUtil.getCurHMSDate(), this.applicationId};
                    jdbcTemplate.update(sql, param);
                } catch (Exception var5) {
                    throw new AppException(var5.getMessage());
                }
        //    }
    //        return null;
        }
    }
}
</code></pre> 
<p>3、项目启动时，这个jdbcTemplate对象还是有数据的：</p> 
<p><img alt="" class="has" height="215" src="https://images2.imgbox.com/29/9a/I2HXdslh_o.png" width="980"></p> 
<p>但是，项目启动成功后，再做业务，会发现jdbcTemplate对象为空了：</p> 
<p><img alt="" class="has" height="488" src="https://images2.imgbox.com/9c/5c/ssCpAeKz_o.png" width="795"></p> 
<p>是不是很尴尬。</p> 
<p> </p> 
<p>后来看了网上一些解决办法，找到了如下办法，在jdbcTemplate对象是加上注解：</p> 
<p> @Resource(name = "jdbcTemplate")，上代码（CmccSmsServiceImpl.java）：</p> 
<pre class="has"><code class="language-java">package cn.gtmap.estateplat.register.service.smsImpl;

import cn.gtmap.estateplat.core.ex.AppException;
import cn.gtmap.estateplat.register.service.SmsService;
import cn.gtmap.estateplat.utils.CalendarUtil;
import com.gtis.common.util.UUIDGenerator;
import org.apache.commons.collections.CollectionUtils;
import org.apache.commons.lang3.StringUtils;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Service;

import javax.annotation.Resource;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

@Service("cmccSmsServiceImpl")
public class CmccSmsServiceImpl implements SmsService {

    private static final String PHONE_NUMBER_NULL = "电话号码为空！";
    private static final String CONTENT_NUMBER_NULL = "短信内容为空！";
    private static final String REQDELIVERYREPORT_NO_NUMBER = "需要状态报告不是数字！";
    private static final String MSGFMT_NO_NUMBER = "消息类型不是数字！";
    private static final String SENDMETHOD_NO_NUMBER = "短信发送形式不是数字！";
    private String extCode = "**";
    private String reqDeliveryReport = "*";
    private String msgFmt = "*";
    private String sendMethod = "*";
    private String applicationId = "**********";
    @Resource(name = "jdbcTemplate")//注意看这里！！！！！！！！！！！！！！！！！！！！
    private JdbcTemplate jdbcTemplate;

    public JdbcTemplate getJdbcTemplate() {
        return jdbcTemplate;
    }
    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    @Override
    public void sendSms(HashMap hashMap, String model, String phone) {
        List&lt;String&gt; phoneList = new ArrayList&lt;String&gt;();
        phoneList.add(phone);
        if (CollectionUtils.isEmpty(phoneList)) {
            throw new AppException("电话号码为空！");
        } else if (StringUtils.isBlank(model)) {
            throw new AppException("短信内容为空！");
        } else if (!StringUtils.isNumeric(this.reqDeliveryReport)) {
            throw new AppException("需要状态报告不是数字！");
        } else if (!StringUtils.isNumeric(this.msgFmt)) {
            throw new AppException("消息类型不是数字！");
        } else if (!StringUtils.isNumeric(this.sendMethod)) {
            throw new AppException("短信发送形式不是数字！");
        } else {
            String sql = "INSERT INTO **** (SISMSID, EXTCODE, DESTADDR,MESSAGECONTENT, REQDELIVERYREPORT, MSGFMT, SENDMETHOD, REQUESTTIME, APPLICATIONID) VALUES (?,?,?,?,?,?,?,?,?)";
           // for(String phoneNum:phoneList){
                try {
                    Object[] param = new Object[]{UUIDGenerator.generate18(), this.extCode, phone, model, Integer.parseInt(this.reqDeliveryReport), Integer.parseInt(this.msgFmt), Integer.parseInt(this.sendMethod), CalendarUtil.getCurHMSDate(), this.applicationId};
                    jdbcTemplate.update(sql, param);
                } catch (Exception var5) {
                    throw new AppException(var5.getMessage());
                }
        //    }
    //        return null;
        }
    }
}
</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/991de5ec27306bd497c680dde0e7c399/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">人脸识别demo使用教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2d6390bd25871535176bc610f39a22e1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IO、NIO和AIO的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>