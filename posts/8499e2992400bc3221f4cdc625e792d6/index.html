<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ThreeJS 炫酷特效旋转多面体Web页 Demo 01《ThreeJS 炫酷特效制作》 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ThreeJS 炫酷特效旋转多面体Web页 Demo 01《ThreeJS 炫酷特效制作》" />
<meta property="og:description" content="本案例为一个 threejs 的特效网页，大小球体进行包裹，外球体为透明材质，但是进行了线框渲染，使其能够通过外球踢查看其内球体。
注：案例参考源于互联网，在此做代码解释，侵删
本案例除 ThreeJS 外不适用任何第三方框架，放心食用
懒的同学可以直接下载代码，打赏作者一根精神食粮：https://download.csdn.net/download/A757291228/87871503
这是 inscode 的代码，不过渲染有点问题，不过也可以看到大致效果：
一、ThreeJS 三要素 在编写 ThreeJS 前，需要明白 ThreeJS 的三个要素，若对建模、游戏有过了解的同学在学习 ThreeJS 时对知识点理解会更容易接受。
在 ThreeJS 中有三个很关键的对象，分别是 摄像头、场景以及渲染器：
其中 场景 是通过 ThreeJS “搭建”呈现特效的一个“舞台”，创建好一个场景后，即可往这个场景中添加对应的多种物体，例如多边形、粒子、球体等；创建好场景后我们需要在场景中添加摄像头用于呈现场景中的视觉效果，摄像头在 ThreeJS 中担任 “视觉采集”
角色，可以通过控制摄像头采集范围（大小）从而采集场景中视觉呈现；那么完成以上两步后，还需要对场景进行渲染，只有渲染过后才能进行视觉效果的呈现。 可以想象场景为一个场地，摄像头为一个摄像头，渲染器就是渲染器，然后拍成了一段视频或照片。
二、代码中创建三要素 2.1 创建 html 首先创建一个 html 文件，并且引入 CSS 与 JS 文件：
&lt;!DOCTYPE html&gt; &lt;html lang=&#34;en&#34;&gt; &lt;head&gt; &lt;meta charset=&#34;UTF-8&#34;&gt; &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;&gt; &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt; &lt;title&gt;1_bit ThreeJS 炫酷旋转多面体Web页 Demo&lt;/title&gt; &lt;link rel=&#34;stylesheet&#34; href=&#34;./style.css&#34;&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8499e2992400bc3221f4cdc625e792d6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-13T10:47:28+08:00" />
<meta property="article:modified_time" content="2023-06-13T10:47:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ThreeJS 炫酷特效旋转多面体Web页 Demo 01《ThreeJS 炫酷特效制作》</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本案例为一个 threejs 的特效网页，大小球体进行包裹，外球体为透明材质，但是进行了线框渲染，使其能够通过外球踢查看其内球体。<br> 注：案例参考源于互联网，在此做代码解释，侵删<br> 本案例除 ThreeJS 外不适用任何第三方框架，放心食用<br> 懒的同学可以直接下载代码，打赏作者一根精神食粮：<a href="https://download.csdn.net/download/A757291228/87871503">https://download.csdn.net/download/A757291228/87871503</a></p> 
<p><img src="https://images2.imgbox.com/ca/4c/kDcwGNQt_o.gif" alt="请添加图片描述"><br> 这是 inscode 的代码，不过渲染有点问题，不过也可以看到大致效果：</p> 
<p></p> 
<div class="inscode-box">
 <iframe width="100%" height="500px" src="https://inscode.csdn.net/@a757291228/Three.js/embed" scrolling="no" frameborder="no" allowfullscreen="allowfullscreen" sandbox="allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-modals"></iframe>
</div> 
<p></p> 
<h2><a id="ThreeJS__14"></a>一、ThreeJS 三要素</h2> 
<p>在编写 ThreeJS 前，需要明白 ThreeJS 的三个要素，若对建模、游戏有过了解的同学在学习 ThreeJS 时对知识点理解会更容易接受。</p> 
<p>在 ThreeJS 中有三个很关键的对象，分别是 摄像头、场景以及渲染器：</p> 
<ul><li>其中 场景 是通过 ThreeJS “搭建”呈现特效的一个“舞台”，创建好一个场景后，即可往这个场景中添加对应的多种物体，例如多边形、粒子、球体等；</li><li>创建好场景后我们需要在场景中添加摄像头用于呈现场景中的视觉效果，摄像头在 ThreeJS 中担任 “视觉采集”<br> 角色，可以通过控制摄像头采集范围（大小）从而采集场景中视觉呈现；</li><li>那么完成以上两步后，还需要对场景进行渲染，只有渲染过后才能进行视觉效果的呈现。</li></ul> 
<p>可以想象场景为一个场地，摄像头为一个摄像头，渲染器就是渲染器，然后拍成了一段视频或照片。</p> 
<h2><a id="_26"></a>二、代码中创建三要素</h2> 
<h3><a id="21__html_28"></a>2.1 创建 html</h3> 
<p>首先创建一个 html 文件，并且引入 CSS 与 JS 文件：</p> 
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>1_bit ThreeJS 炫酷旋转多面体Web页 Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./style.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>canvas<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>three.min.js<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./1bitDemo.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>在此需要注意，在 body 元素中添加了一个 div 并且 id 为 canvas，该 div 是为了之后在 js 代码中对应这个 div 添加渲染好的元素；除此之外还引入了 three.min.js 依赖，另外一个 js 名为 1bitDemo.js 是我们等下须编写的 js 文件代码。</p> 
<h3><a id="22_css__54"></a>2.2 css 编写</h3> 
<p>编写完 html 代码后，创建一个 style.css 文件用于给 html 添加一些基本样式，html 设置背景色，并且给与一个线性渐变，方向向下，随后给与 margin 为0，使其页面边缘贴合，代码过于简单在此不再赘述，css 如下：</p> 
<pre><code class="prism language-css"><span class="token selector">html</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to bottom<span class="token punctuation">,</span> #11e8bb 0%<span class="token punctuation">,</span> #8200c9 100%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">body</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>此时页面如下：<br> <img src="https://images2.imgbox.com/64/b7/610cKYnU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23__74"></a>2.3 创建三要素</h3> 
<p>接着做完准备工作后，创建一个 js 文件，在此我的 js 文件名为 1bitDemo.js ，在其中我们将创建 场景、渲染器、摄像头。</p> 
<p>由于我们为了一打开页面就进行渲染，所以在此需要创建一个 onload 事件：</p> 
<pre><code class="prism language-javascript">window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	
<span class="token punctuation">}</span>
</code></pre> 
<p>接着创建对应的对象存储三要素（渲染器、场景、摄像头）：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> renderer<span class="token punctuation">,</span> scene<span class="token punctuation">,</span> camera<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_91"></a>渲染器</h4> 
<p>我们在此先创建渲染器，通过调用 THREE 对象的 WebGLRenderer 对摄像头进行创建，WebGLRenderer 方法接收传入一个渲染器的配置项对象，例如代码为：</p> 
<pre><code class="prism language-javascript">renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">antialias</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>此时传入的配置项：</p> 
<ul><li>antialias 表示抗锯齿打开，使几何体边缘平滑；</li><li>alpha 表示渲染器渲染时的画面有透明通道，若不打开将不会存在透明通道，例如 png 图片与 jpg 区别；</li></ul> 
<p>接着配置渲染器的渲染大小：</p> 
<pre><code class="prism language-javascript">renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码中 <code>setSize</code> 方法用于设置渲染器渲染大小，通过 <code>window.innerWidth</code> 与 <code>window.innerHeight</code> 传入渲染宽高。</p> 
<p>此时就可以通过 js 获取到 canvas 元素，从而添加渲染器到 canvas 窗口即可：</p> 
<pre><code class="prism language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码中 renderer.domElement 是得到渲染器渲染出的 canvas。</p> 
<h4><a id="_120"></a>场景</h4> 
<p>场景创建很简单，通过 <code>THREE</code> 的 <code>Scene</code> 方法即可创建：</p> 
<pre><code class="prism language-javascript">scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_126"></a>摄像头</h4> 
<p>接着创建摄像头，透视摄像头创建使用 PerspectiveCamera 方法，代码如下：</p> 
<pre><code class="prism language-javascript">camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>PerspectiveCamera 方法接收 4 个参数，分别为：</p> 
<ul><li>相机可视垂直视野角度（玩过FPS的应该知道有一个视野角度）</li><li>相机可视长宽比</li><li>相机近端距离</li><li>相机远端距离</li></ul> 
<p>其中：</p> 
<ul><li>相机近端距离为 相机到场景中最近可视物体的距离</li><li>相机远端距离为 相机到场景中最远的可视物体的距离</li></ul> 
<p>若可视物体小于了 相机近端距离 和 大于了 相机远端距离 都会不可见。</p> 
<p>接着我们此时可以移动一下摄像机的 z 轴，代码为：</p> 
<pre><code class="prism language-javascript">camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>
</code></pre> 
<p>以下为 three 中的坐标系参考图：</p> 
<p><img src="https://images2.imgbox.com/cb/53/bUQz4H51_o.png" alt="在这里插入图片描述"></p> 
<p>此时 z 轴就是摄像机，或者说人的视窗所距离中心点的位置，若不移动这个距离，在创建几何体时将会无法很好的看见几何体，因为默认位置为这个坐标系的中心点。</p> 
<p>最后将这个摄像机添加到场景中即完成三要素创建：</p> 
<pre><code class="prism language-javascript">scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_164"></a>三、几何体创建</h2> 
<h3><a id="31__166"></a>3.1 创建二十面缓冲几何体</h3> 
<p>此时我们创建 2 个二十面的几何体，直接通过 IcosahedronGeometry 方法即可创建，代码为：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> geom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>IcosahedronGeometry</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> geom2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>IcosahedronGeometry</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码中 IcosahedronGeometry 接受两个参数，分别为：</p> 
<ul><li>radius 二十面体的半径，默认为1；</li><li>detail 设置面角，默认为0，值超过1则是球体，超过0小于1则会增加顶点使其转变成非二十面几何体；</li></ul> 
<h3><a id="32__179"></a>3.2 创建二十面体的显示样式</h3> 
<p>在 three 中要为 二十面体创建显示的样式需要创建材质（Material），在此我们要创建一种可以用来模拟物体表面反射光线的亮度和光滑度的材质，需要通过 MeshPhongMaterial 进行创建，随后在 MeshPhongMaterial 方法中传入对应的配置项即可：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> mat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span>
	<span class="token literal-property property">shading</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>FlatShading
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> mat2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span>
	<span class="token literal-property property">wireframe</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
	<span class="token literal-property property">side</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>DoubleSide
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码中的配置项对象值：</p> 
<ul><li><code>color</code> 表示颜色；</li><li><code>shading</code> 表示网格的渲染方式（之后要使用的网格），在此使用<br> <code>FlatShading</code>，表示使用平面着色来渲染网格，渲染的网格将会扁平化；</li><li><code>wireframe</code> 为 <code>true</code> 表示渲染的网格将会呈现线框形式</li><li><code>side</code> 设置为 <code>THREE.DoubleSide</code><br> 表示双面渲染，即渲染的时候物体双面都会进行渲染，而不是只有一面（性能考虑若想设置只渲染一面设置为 <code>THREE.FrontSide</code>）</li></ul> 
<h3><a id="33__Mesh__3D__202"></a>3.3 创建 Mesh 用于组装 3D 对象</h3> 
<p>Mesh 在 ThreeJS 的 3D 对象中是必要的，通过 创建 Mesh 组合 3D 对象，创建 Mesh 需要指定对应的几何体以及材质，如以下代码：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> planet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geom<span class="token punctuation">,</span> mat<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>其中 geom 为之前所创建的几何体，mat 为之前所创建的材质。</p> 
<p>随后我们需要对这个几何体 planet 进行缩放大小显示，在此放大 16 倍：</p> 
<pre><code class="prism language-javascript">planet<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>x <span class="token operator">=</span> planet<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>y <span class="token operator">=</span> planet<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
</code></pre> 
<p>接下来我们需要创建一个 Object3D 用于存放这个几何体，通过 Object3D 我们可以方便的对 完整的几何体进行 缩放、移动等。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> center <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
center<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planet<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>center<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上代码中创建了一个 cente rObject3D 对象，把创建好的几何体 planet 添加到 center 中，再把 center 添加到 scene 场景中即可。</p> 
<h4><a id="_225"></a>渲染</h4> 
<p>此时若想查看页面是什么样，可以在末尾直接通过渲染器调用 render 方法进行渲染即可，render 方法需要传入场景和摄像头对象，此时代码为：</p> 
<pre><code class="prism language-javascript">renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
</code></pre> 
<p>但此时渲染出来的画面是黑色的：</p> 
<p><img src="https://images2.imgbox.com/fc/6d/dMaGpFuF_o.png" alt="在这里插入图片描述"></p> 
<p>原因是场景中没有添加光源，所以暗淡无光，接下来我们创建光源，但在此之前，我们刚刚创建了两个 MeshPhongMaterial 材质和 IcosahedronGeometry 二十面体对象，我们在此只实现了一个对象的 mesh，我们此时再完成另一个 IcosahedronGeometry mesh 的创建，并且创建 Object3D 对象进行存放：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> planet2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geom2<span class="token punctuation">,</span> mat2<span class="token punctuation">)</span><span class="token punctuation">;</span>
planet2<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>x <span class="token operator">=</span> planet2<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>y <span class="token operator">=</span> planet2<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
outside <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
outside<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>planet2<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>outside<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="34__247"></a>3.4 创建光源</h3> 
<p>在此我们创建环境光，创建环境光通过方法 AmbientLight，AmbientLight 方法传入环境光颜色即可：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> ambientLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AmbientLight</span><span class="token punctuation">(</span><span class="token number">0x999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ambientLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>此时刷新界面如下：</p> 
<p><img src="https://images2.imgbox.com/a3/dc/qAOxjMhK_o.png" alt="在这里插入图片描述"><br> 此时我们还需要创建其他的太阳光。太阳光通过 DirectionalLight 进行创建，是一种平行光，并不会随距离而衰减。DirectionalLight 接受两个参数，一个是光照颜色一个是光照强度，光照强度默认为 1：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> lights1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lights1<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> lights2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0x11E8BB</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lights2<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> lights3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0x8200C9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lights3<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>lights1<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>lights2<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>lights3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>刷新界面重新渲染此时界面如下：<br> <img src="https://images2.imgbox.com/16/2f/Jh4PDv9s_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="35__272"></a>3.5 创建环境物体</h3> 
<p>接着开始创建环境物体，首先依照惯例创建一个 3D 容器，并且将这个容器添加到场景中：</p> 
<pre><code class="prism language-javascript">particle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Object3D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>particle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>接着创建一个四面体（第一个参数已经就是半径，第二个参数与二十面体一致）：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TetrahedronGeometry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>随后创建材质（与之前一致不再赘述）：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span>
	<span class="token literal-property property">shading</span><span class="token operator">:</span> <span class="token constant">THREE</span><span class="token punctuation">.</span>FlatShading
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>由于环境物体较多，在此直接使用for 循环进行循环创建：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
	mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">multiplyScalar</span><span class="token punctuation">(</span><span class="token number">90</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//旋转</span>

	particle<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>以上代码中首先创建了一个 mesh，随后 通过 mesh.position.set 设置其 x y z 的坐标，接着通过 multiplyScalar 方法对坐标进行放大，此时放大后将会使整体创建的 mesh 位置进行扩大，远离中心点，这样就可以使这些创建的物体发散到其他位置，最后在通过 mesh.rotation.set 设置他们的旋转角度，使创建的物体旋转方向发生改变，否则都是一个面反光并不是很好看，太单一了，最后添加到 particle 即可完成。</p> 
<p>此时页面效果如下：<br> <img src="https://images2.imgbox.com/ec/9d/xOEVBIMo_o.png" alt="在这里插入图片描述"></p> 
<p>为啥看起来球那么小？其实大家可以调整视角大小以及远端距离可以拉近与物体的距离，在此我把摄像头视觉方位调成70：</p> 
<pre><code class="prism language-javascript">camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>此时呈现效果确实变大了：<br> <img src="https://images2.imgbox.com/39/a3/lB87Ms8U_o.png" alt="在这里插入图片描述"><br> 最后就是完成动画，使其旋转。</p> 
<h3><a id="36_animation__318"></a>3.6 animation 动画</h3> 
<p>做过 unity 的同学应该很清楚，只需要每帧更改其位置即可，那么此时我们创建一个 animate 方法，设置其 Object3D 对象的 rotation 即可：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>

	particle<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">0.0010</span><span class="token punctuation">;</span>
	particle<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">0.0040</span><span class="token punctuation">;</span>
	inside<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">0.0020</span><span class="token punctuation">;</span>
	inside<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">0.0030</span><span class="token punctuation">;</span>
	outside<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">0.0010</span><span class="token punctuation">;</span>
	outside<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">0.0020</span><span class="token punctuation">;</span>
	renderer<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>以上方法中 requestAnimationFrame 为一个循环函数，传入对应的函数名即可重复执行，在此处我们只需要把 这个 animate 函数放到 onload 事件最后一行代码即可，并且删除 onload 中的 renderer 的 render 方法，因为在此处已经写有。</p> 
<p>以上代码中的 renderer.clear(); 为清理渲染器的缓存，准备下一次渲染，一般在场景重绘前调用即可，当然 clear 可以指定清理不同的缓冲区，同学们可以之后在了解一下。</p> 
<p>以上 animate 方法已经写好了，但是注意 renderer, scene, camera, inside, outside, particle 这些变量需要设置为全局变量，否则调用不到。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/442db852ca28a2e05c93570b59b0c3ec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用idea创建vue文件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/36b7e0ad29d4883e8e91fe266125cb31/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">TPS波动较大问题排查</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>