<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jetpack compose系列（入门基础案例讲解） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="jetpack compose系列（入门基础案例讲解）" />
<meta property="og:description" content="前言： 在上一章讲完compose的设计原理和基本概念之后，大家对compose的基本设计应该有了一个大概的了解，Jetpack Compose是在2019Google i/O大会上发布的新的库。Compose库是用响应式编程的方式对View进行构建,可以用更少更直观的代码，
更强大的功能，能提高开发速度（这一段是谷歌自己说的）。 说实话，View/Layout的模式对安卓工程师来说太过于熟悉，对于学习曲线陡峭的Jetpack Compose能不能学会还是有所担心，所以这一篇我们再来讲一些基本案例来为大家加深理解。
1. 教程 1.1 创建新的项目或导入库 Jetpack Compose是从Android Studio 4.2开始支持的，所以需要通过4.2(现在是canary版本)创建新的项目或者添加导入库。这里按照创建新的项目来进行介绍。
根据上图所示，在创建新的项目时需要选择Empty Compose Activity。
此时模块中的build.gradle文件会新增下列的库的依赖。
`dependencies { ... implementation &#39;androidx.ui:ui-layout:&#34;${compose_version}&#34;&#39; implementation &#39;androidx.ui:ui-material:&#34;${compose_version}&#34;&#39; implementation &#39;androidx.ui:ui-tooling:&#34;${compose_version}&#34;&#39; ... }` 还有在模块的build.gradle文件中新增下列的设置。
`android { ... buildFeatures { compose true } composeOptions { kotlinCompilerExtensionVersion &#34;${compose_version}&#34; kotlinCompilerVersion &#34;1.3.70-dev-withExperimentalGoogleExtensions-20200424&#34; } }` 1.2 UI相关 1.2.1 @Compose 所有关于构建View的方法都必须添加@Compose的注解才可以。并且@Compose跟协程的Suspend的使用方法比较类似,被@Compose的注解的方法只能在同样被@Comopse注解的方法中才能被调用。
`@Composable fun Greeting(name: String) { Text(text = &#34;Hello $name!&#34;) }` 1.2.2 @Preview 加上@Preview注解的方法可以在不运行App的情况下就可以确认布局的情况。
@Preview的注解中比较常用的参数如下：
name: String: 为该Preview命名，该名字会在布局预览中显示。showBackground: Boolean: 是否显示背景，true为显示。backgroundColor: Long: 设置背景的颜色。showDecoration: Boolean: 是否显示Statusbar和Toolbar，true为显示。group: String: 为该Preview设置group名字，可以在UI中以group为单位显示。fontScale: Float: 可以在预览中对字体放大，范围是从0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e1996f8e46d4250acbb87ef1d67045bb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-01T16:37:16+08:00" />
<meta property="article:modified_time" content="2023-03-01T16:37:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">jetpack compose系列（入门基础案例讲解）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>前言：</h3> 
<p>在上一章讲完compose的设计原理和基本概念之后，大家对compose的基本设计应该有了一个大概的了解，<code>Jetpack Compose</code>是在2019Google i/O大会上发布的新的库。<code>Compose</code>库是用响应式编程的方式对View进行构建,可以用更少更直观的代码，</p> 
<p>更强大的功能，能提高开发速度（这一段是谷歌自己说的）。 说实话，<code>View/Layout</code>的模式对安卓工程师来说太过于熟悉，对于学习曲线陡峭的<code>Jetpack Compose</code>能不能学会还是有所担心，所以这一篇我们再来讲一些基本案例来为大家加深理解。</p> 
<h3><a id="1__8"></a>1. 教程</h3> 
<h4><a id="11__11"></a>1.1 创建新的项目或导入库</h4> 
<p><code>Jetpack Compose</code>是从<code>Android Studio 4.2</code>开始支持的，所以需要通过4.2(现在是canary版本)创建新的项目或者添加导入库。这里按照创建新的项目来进行介绍。</p> 
<p><img src="https://images2.imgbox.com/09/44/10ix75KU_o.png" alt=""></p> 
<p>根据上图所示，在创建新的项目时需要选择<code>Empty Compose Activity</code>。</p> 
<p>此时模块中的<code>build.gradle</code>文件会新增下列的库的依赖。</p> 
<pre><code>`dependencies {     ...     implementation 'androidx.ui:ui-layout:"${compose_version}"'     implementation 'androidx.ui:ui-material:"${compose_version}"'     implementation 'androidx.ui:ui-tooling:"${compose_version}"'     ... }`

</code></pre> 
<p>还有在模块的<code>build.gradle</code>文件中新增下列的设置。</p> 
<pre><code>`android {     ...          buildFeatures {         compose true     }          composeOptions {         kotlinCompilerExtensionVersion "${compose_version}"          kotlinCompilerVersion "1.3.70-dev-withExperimentalGoogleExtensions-20200424"     } }`

</code></pre> 
<h4><a id="12_UI_33"></a>1.2 UI相关</h4> 
<h5><a id="121_Compose_35"></a>1.2.1 @Compose</h5> 
<p>所有关于构建View的方法都必须添加<code>@Compose</code>的注解才可以。并且<code>@Compose</code>跟协程的<code>Suspend</code>的使用方法比较类似,被<code>@Compose</code>的注解的方法只能在同样被<code>@Comopse</code>注解的方法中才能被调用。</p> 
<pre><code>`@Composable fun Greeting(name: String) {     Text(text = "Hello $name!") }`

</code></pre> 
<h5><a id="122_Preview_44"></a>1.2.2 @Preview</h5> 
<p>加上<code>@Preview</code>注解的方法可以在不运行App的情况下就可以确认布局的情况。</p> 
<p><code>@Preview</code>的注解中比较常用的参数如下：</p> 
<ol><li><code>name: String</code>: 为该Preview命名，该名字会在布局预览中显示。</li><li><code>showBackground: Boolean</code>: 是否显示背景，true为显示。</li><li><code>backgroundColor: Long</code>: 设置背景的颜色。</li><li><code>showDecoration: Boolean</code>: 是否显示Statusbar和Toolbar，true为显示。</li><li><code>group: String</code>: 为该Preview设置group名字，可以在UI中以group为单位显示。</li><li><code>fontScale: Float</code>: 可以在预览中对字体放大，范围是从0.01。</li><li><code>widthDp: Int</code>: 在Compose中渲染的最大宽度，单位为dp。</li><li><code>heightDp: Int</code>: 在Compose中渲染的最大高度，单位为dp。</li></ol> 
<p>上面的参数都是可选参数，还有像背景设置等的参数并<strong>不是</strong>对实际的App进行设置，只是对Preview中的背景进行设置，为了更容易看清布局。</p> 
<pre><code>`@Preview(showBackground = true, name = "Home UI", showDecoration = true) @Composable fun DefaultPreview() {     MyApplicationTheme {         Greeting("Android")     } }`

</code></pre> 
<p>在IDE的右上角有<code>Code</code>，<code>Split</code>,<code>Design</code>三个选项。分别是只显示代码，同时显示代码和布局和只显示布局。<br> 当更改跟UI相关的代码时，会显示如下图的一个横条通知，点击<code>Build&amp;Refresh</code>即可更新显示所更改代码的UI。<br> <img src="https://images2.imgbox.com/a9/16/wm2NojWn_o.png" alt=""></p> 
<h5><a id="123_setContent_69"></a>1.2.3 setContent</h5> 
<p><code>setContent</code>的作用是和zai<code>Layout/View</code>中的<code>setContentView</code>是一样的。<br> <code>setContent</code>的方法也是有<code>@Compose</code>注解的方法。所以，在<code>setContent</code>中写入关于UI的<code>@Compopse</code>方法，即可在Activity中显示。</p> 
<pre><code>    `override fun onCreate(savedInstanceState: Bundle?) {         super.onCreate(savedInstanceState)         setContent {             JetpackComposeDemoTheme {                 Greeting("Android")             }         }     }`

</code></pre> 
<p><strong>上面我们讲了一些@Compose@preview等方法，现在我们再来讲讲一些组件的应用</strong></p> 
<h4><a id="21__80"></a>2.1 组件应用</h4> 
<p>liveData是一个数据持有类</p> 
<ul><li>能够感知组件的生命周期，确保仅更新活跃组件</li><li>不会因Activity停止而导致崩溃，如果观察者的生命周期处于非活跃状态（如返回栈中的 Activity），则它不会接收任何 LiveData 事件</li><li>持有的数据可被观察者观察，在底层数据更改时通知视图</li><li>一对多观察者：观察者会绑定lifecycle对象，在生命周期结束时会自我清理（不会发生内存泄露）</li><li>共享资源：可以使用单例模式扩展 LiveData 对象以封装系统服务，以便在应用中共享它们。</li></ul> 
<h2><a id="liveData_90"></a>liveData使用：</h2> 
<ul><li>MutableLiveData：LiveData（抽象类）的子类</li><li>liveData.postValue()：可在任意线程下执行（切换线程操作）</li><li>liveData.setValue()：只能在主线程中执行</li><li>liveData.observe()：注册观察者</li><li>observe()源码：注册观察者保存在mObserves（map）中</li><li>感知生命周期：owner.getLifecycle().addObserver(wapper)，改变时调用onstatechanged()</li></ul> 
<h2><a id="_100"></a>观察者有两种情况会被回调：</h2> 
<p>1、postValue时会遍历观察者然后回调</p> 
<p>2、当组件生命周期发生变化或者第一次注册观察者时回调</p> 
<h2><a id="_107"></a>粘性事件：</h2> 
<p>这里得满足两个条件会触发粘性事件 1.数据发送早于注册监听 2.监听者的owner生命周期进入活跃状态</p> 
<h4><a id="22_ViewModelDataBinding_111"></a>2.2 ViewModel和DataBinding</h4> 
<ul><li>viewModel：注重以生命周期的方式存储和管理界面相关数据，不受activity生命周期影响</li><li>数据持久化：生命周期不受限制</li><li>异步回调问题不会造成内存泄露</li><li>隔离model层和view层：解耦</li><li>Fragment间共享数据</li><li>DataBinding：实现双向绑定，数据和UI同步</li></ul> 
<p>作用：当数据源发生改变时，及时更新给UI（p层做的事情交给系统源码去做）</p> 
<h4><a id="23_NavigationFragment_122"></a>2.3 Navigation和Fragment</h4> 
<p>Navigation：导航（回退栈）</p> 
<h2><a id="_125"></a>三大件：</h2> 
<p>Navigation Graph：导航图，包含了所有导航相关信息的XML资源。一般防止在res/navigation目录下</p> 
<p>NavHost：容器，用来显示Fragment的，即Activity中的fragment，要求实现NavHost</p> 
<p>NavController：在NavHost中管理应用导航的对象</p> 
<p>一句话就是，通过NavController，获取当行图中的特定路径以及目标，导航到特定的目标放到NavHost中</p> 
<p>Navigation是用来管理Fragment的切换，并且可以通过可视化的方式，看见APP的交互流程。</p> 
<h2><a id="_138"></a>总结</h2> 
<p>我们整理了一份阿里P7级别的Android架构师全套学习资料，特别适合有3-5年以上经验的小伙伴深入学习提升。</p> 
<p>主要包括腾讯，以及字节跳动，阿里，华为，小米，等一线互联网公司主流架构技术。如果你有需要，尽管拿走好了。</p> 
<p><img src="https://images2.imgbox.com/3c/d9/QRZD7T4g_o.jpg" alt="请添加图片描述"></p> 
<p><strong>如果你觉得自己学习效率低，缺乏正确的指导，可以扫描下方二维码，加入资源丰富，学习氛围浓厚的技术圈一起学习交流吧！</strong></p> 
<img src="https://images2.imgbox.com/0b/ec/NLH0MG7D_o.png"> 
<p>群内有许多来自一线的技术大牛，也有在小厂或外包公司奋斗的码农，我们致力打造一个平等，高质量的Android交流圈子，不一定能短期就让每个人的技术突飞猛进，但从长远来说，眼光，格局，长远发展的方向才是最重要的。</p> 
<p>35岁中年危机大多是因为被短期的利益牵着走，过早压榨掉了价值，如果能一开始就树立一个正确的长远的职业规划。35岁后的你只会比周围的人更值钱。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1b0e26f424fcabf3227a53c75212e5fe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">零基础熟悉mmdetection3d数据提取、模型搭建过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/86085332565960c27233bc8b8a61eb71/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux 系统下 docker 搭建和使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>