<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql全文检索与模糊查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql全文检索与模糊查询" />
<meta property="og:description" content="mysql数据库进阶学习 二 全文检索模糊查询 like用法正则表达 全文检索 新建全文检索方式（支持中文全文检索）：
本文使用mysql数据库版本为5.7&#43;，InnoDB数据库引擎
全文检索解析器ngram（解决不支持中文检索方式，版本要求5.7.6&#43;，为mysql内置插件，不需要安装，默认支持检索最短字符为2，即不支持单个字如’国’检索）
alter table news_info add fulltext index ft_in(title,category) with parser ngram; 第二种建立全文检索方法：
create fulltext index 检索名词（如:ft_in） on table_name(检索列名) with parser ngram; 其中fulltext表示全文，index索引，ft_in检索名称，（title,category）表示要设置全文检索的字段名，parser ngram即使用ngram全文解析。
执行完成后，就可以通过一下语句检索：
select *from news_info where match(title,category) against(&#39;中国&#39; in boolean mode); 查询结果如下：
首先解释一下sql语句，使用全文检索的格式：
select xxx from table_name where match(自己设置的检索字段名) against(&#39;xx&#39; in boolean mode); 关于设置ngram的最短检索字符值，请自行百度。
使用全文检索在数据量较大的情况下，比（like’’）模糊查询要更快一筹。
模糊查询 like用法 其实使用全文检索也可以达到模糊查询的效果，这里不做比较
注意使用like方法实现模糊查询会使建立好的索引失效（前提是你查询的字段名不是你建立的索引，例：我查询name，where条件是phone like‘%XXX%’其中phone设置了索引，但是name没有，那模糊查询就不会使用索引，如果查询的是phone，则模糊查询还是会使用索引，这是一个很细的细节哦）
关于检索的用法请看：mysql复合索引
使用sql语句：
select title from news_info where title like &#39;%中国%&#39; 这种like &#39;%X%&#39;是指查询包括x的所有数据，%指的是X之前无数个字符，或是X之后无数个字符 查询结果：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b9499aee46c5a8b940b84cb970981106/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-14T10:18:35+08:00" />
<meta property="article:modified_time" content="2019-10-14T10:18:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql全文检索与模糊查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>mysql数据库进阶学习 二</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">全文检索</a></li><li><a href="#_like_30" rel="nofollow">模糊查询 like用法</a></li><li><a href="#_74" rel="nofollow">正则表达</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>全文检索</h3> 
<p>新建全文检索方式（支持中文全文检索）：<br> 本文使用mysql数据库版本为5.7+，InnoDB数据库引擎<br> 全文检索解析器ngram（解决不支持中文检索方式，版本要求5.7.6+，为mysql内置插件，不需要安装，默认支持检索最短字符为2，即不支持单个字如’国’检索）</p> 
<pre><code>alter table news_info add fulltext index ft_in(title,category) with parser ngram;
</code></pre> 
<p>第二种建立全文检索方法：</p> 
<pre><code>create fulltext index 检索名词（如:ft_in） on table_name(检索列名) with parser ngram;
</code></pre> 
<p>其中fulltext表示全文，index索引，ft_in检索名称，（title,category）表示要设置全文检索的字段名，parser ngram即使用ngram全文解析。<br> 执行完成后，就可以通过一下语句检索：</p> 
<pre><code>select *from news_info where match(title,category) against('中国' in boolean mode);
</code></pre> 
<p>查询结果如下：<br> <img src="https://images2.imgbox.com/66/73/G4Y2yp8w_o.png" alt="在这里插入图片描述"><br> 首先解释一下sql语句，使用全文检索的格式：</p> 
<pre><code>select xxx from  table_name where 
match(自己设置的检索字段名) against('xx' in boolean mode);
</code></pre> 
<p>关于设置ngram的最短检索字符值，请自行百度。<br> 使用全文检索在数据量较大的情况下，比（like’’）模糊查询要更快一筹。</p> 
<h3><a id="_like_30"></a>模糊查询 like用法</h3> 
<p><strong>其实使用全文检索也可以达到模糊查询的效果，这里不做比较</strong><br> 注意使用like方法实现模糊查询会使建立好的索引失效（前提是你查询的字段名不是你建立的索引，<font color="blue">例：我查询name，where条件是phone like‘%XXX%’其中phone设置了索引，但是name没有，那模糊查询就不会使用索引，如果查询的是phone，则模糊查询还是会使用索引，这是一个很细的细节哦</font>）<br> 关于检索的用法请看：<a href="https://blog.csdn.net/Tobey_r1/article/details/97108528">mysql复合索引</a><br> 使用sql语句：</p> 
<pre><code>select title from news_info where title like '%中国%' 
这种like '%X%'是指查询包括x的所有数据，%指的是X之前无数个字符，或是X之后无数个字符
</code></pre> 
<p>查询结果：<br> <img src="https://images2.imgbox.com/0e/3d/d1Tr6Rtb_o.png" alt="在这里插入图片描述"><br> 我们可以看到使用了like’%中国%’，查询到的结果是所有包含中国的数据，无论中国所属的位置。我为什么要说所属的位置呢，因为如果查询条件换成like’中%'即输入如下：</p> 
<pre><code>select title from news_info where title like'中%'
</code></pre> 
<p><img src="https://images2.imgbox.com/b3/9c/a2azc12X_o.png" alt="在这里插入图片描述"><br> 我们发现查询到的数据都是中国开头的，我们继续输入查询语句（这里就不查中了，因为数据库里没有以中为结尾的）：</p> 
<pre><code>select title from news_info where title like'%会'
</code></pre> 
<p>结果如下：<br> <img src="https://images2.imgbox.com/fc/b2/3sxQmOaK_o.png" alt="在这里插入图片描述"><br> 我们发现查询到的数据都是末尾为会的。<br> 我们总结一下：<br> '%X%'表示查询所有包含X的数据，不管位置。<br> 'X%'表示查询以X为开头的数据。<br> '%X’表示查询以X为末尾的数据。<br> %表示n个字符。<br> 检查自己是否使用了索引只需要在select的前面加上explain，即：</p> 
<pre><code>explain select title from news_info where title like '%中国%' 
</code></pre> 
<p><img src="https://images2.imgbox.com/5c/08/povg0A6M_o.png" alt="在这里插入图片描述"><br> 其中title字段设置了索引，所以下面查询显示的key存在，且type为index检索。<br> 换一下查询内容：</p> 
<pre><code>explain select * from news_info where title like'%中%'
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/31/OrvORtrB_o.png" alt="在这里插入图片描述"><br> 我们可以看到type是所有，且key为空，即没有用到索引。</p> 
<h3><a id="_74"></a>正则表达</h3> 
<table><thead><tr><th>^</th><th>匹配输入字符串的开始位置。如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 ‘\n’ 或 ‘\r’ 之后的位置。</th></tr></thead><tbody><tr><td>$</td><td>匹配输入字符串的结束位置。如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 ‘\n’ 或 ‘\r’ 之前的位置。</td></tr></tbody></table> 
<p>通过实例讲解：<br> 输入以下sql语句：</p> 
<pre><code>select title from news_info where title regexp '^中'
</code></pre> 
<p>查询结果为：<br> <img src="https://images2.imgbox.com/ec/47/7f4G4hYI_o.png" alt="在这里插入图片描述"><br> 出来这个结果应该很熟悉吧，比较上面的like用法也查出来过，通过查询的内容，我们发现regexp '^X’表示查询以X为开头的数据。<br> 输入如下：</p> 
<pre><code>select title from news_info where title regexp '会$'
表示查询以会为结尾的数据
</code></pre> 
<p><img src="https://images2.imgbox.com/10/b1/GDZr91LT_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c85a17c8b3e6e0fb5a06858a81441bc7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">筛选重要特征的方法feature_importance_</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c7f130777bfb50f658e1875c1e1f834/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python将pyc转为py</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>