<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通过 python 打开 SecureCRT 软件并实现自动连接主机 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="通过 python 打开 SecureCRT 软件并实现自动连接主机" />
<meta property="og:description" content="如何通过 python 打开 SecureCRT 软件并实现自动连接主机？这个问题是我在实际应用中遇到的问题。做运维的工作上经常需要通过 SecureCRT 连接某个系统内的所有主机，话说 boss 们嫌这样太麻烦，希望通过编写一个程序软件，在该软件上通过下拉框选择特定的系统，再点击按钮就可实现连接该特定系统的所有主机。这是很好的想法，毕竟还是要方便嘛！ 通过 python 里的 os.system() 可以打开外部程序，当然也可以打开 SecureCRT 啦，通过os.system(&#39;...\\SecureCRT.exe&#39;) 即可（其中 ... 代表 SecureCRT 的安装路径），但是这仅仅是打开了 SecureCRT 软件而已，并不能实现自动连接主机啊。实际上通过运行 bat 文件调用 vbs 脚本可以实现自动打开 SecureCRT 并连接特定的主机。 我们写的 login.bat 文件的代码如下：
@set /p name=用户名： @set /p pwd=密码： start &#34;&#34; &#34;D:\Program Files\SecureCRT\SecureCRT.exe&#34; /SCRIPT &#34;D:\test\login.vbs&#34; /arg %name% /arg %pwd% :end exit login.vbs 脚本的代码如下： #$language = &#34;VBScript&#34; #$interface = &#34;1.0&#34; Dim UsrID &#39;用户名 Dim UsrPass &#39;密码 Public Sub login UsrID=crt.Arguments.Getarg(0) UsrPass=crt.Arguments.Getarg(1) End Sub Sub main login WXB End Sub Sub WXB crt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d48f10d566c3e5f00f3ec315a2f0b7e4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-07-16T00:12:31+08:00" />
<meta property="article:modified_time" content="2016-07-16T00:12:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通过 python 打开 SecureCRT 软件并实现自动连接主机</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style="font-family:微软雅黑; font-size:16px; line-height:24px">如何通过 python </span> 
<span style="font-family:微软雅黑; font-size:16px; line-height:1.5">打开 SecureCRT 软件并实现自动连接主机？这个问题是我在实际应用中遇到的问题。做运维的工作上经常需要通过 SecureCRT 连接某个系统内的所有主机，话说 boss 们嫌这样太麻烦，希望通过编写一个程序软件，在该软件上通过下拉框选择特定的系统，再点击按钮就可实现连接该特定系统的所有主机。这是很好的想法，毕竟还是要方便嘛！</span> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <span style="line-height:1.5; background-color:inherit">通过 python 里的 os.system() 可以打开外部程序，当然也可以打开 SecureCRT 啦，通过os.system('...\\SecureCRT.exe') 即可（其中 ... 代表 SecureCRT 的安装路径），但是这仅仅是打开了 SecureCRT 软件而已，并不能实现自动连接主机啊。实际上通过运行 bat 文件调用 vbs 脚本可以实现自动打开 SecureCRT 并连接特定的主机。</span> 
</div> 
<p style="font-family:微软雅黑; font-size:16px; line-height:24px"><span style="line-height:1.5; background-color:inherit">我们写的 login.bat 文件的代码如下：</span></p> 
<p style="font-family:微软雅黑; font-size:16px; line-height:24px"><span style="line-height:1.5; background-color:inherit"></span></p> 
<pre><code class="language-vb">@set /p name=用户名：
@set /p pwd=密码：
 
start "" "D:\Program Files\SecureCRT\SecureCRT.exe" /SCRIPT "D:\test\login.vbs" /arg %name% /arg %pwd%
:end
exit</code></pre> 
<span style="font-family:微软雅黑; font-size:16px; line-height:24px">login.vbs 脚本的代码如下：</span> 
<p></p> 
<p style="font-family:微软雅黑; font-size:16px; line-height:24px"><span style="line-height:1.5; background-color:inherit"></span></p> 
<pre><code class="language-vb">#$language = "VBScript"
#$interface = "1.0"
 
Dim UsrID  '用户名
Dim UsrPass    '密码
 
Public Sub login
  UsrID=crt.Arguments.Getarg(0)
  UsrPass=crt.Arguments.Getarg(1)
End Sub
 
Sub main
  login
  WXB
End Sub
 
Sub WXB
crt.Screen.Synchronous = True
crt.session.connectintab("/SSH2 /L " &amp; UsrID &amp; " /PASSWORD " &amp; UsrPass &amp; " /C 3DES /M MD5 192.168.206.128")
crt.session.connectintab("/SSH2 /L " &amp; UsrID &amp; " /PASSWORD " &amp; UsrPass &amp; " /C 3DES /M MD5 192.168.206.129")
End Sub</code></pre> 
<p></p> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px">
  login.bat 代码中的前两行表示设置两个变量 name 和 pwd，"/p" 表示通过弹出 cmd 窗口输入变量值。start 那一行表示通过 SecureCRT 调用 login.vbs 脚本并把 name 和 pwd 这两个变量的值作为参数传进去。 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px">
  login.vbs 代码中通过 Dim 声明了 UsrID 和 UsrPass 这两个变量，crt.Arguments.Getarg(0) 和 crt.Arguments.Getarg(1) 表示获得 login.bat 传进来的两个参数，也就是 %name% 和 %pwd%。crt.session.connectintab("/SSH2 /L " &amp; UsrID &amp; " /PASSWORD " &amp; UsrPass &amp; " /C 3DES /M MD5 192.168.206.128") 这行代码表示以打开一个新标签页的形式连接主机，我这里测试的是连接两太主机，ip 分别为 192.168.206.128 和 192.168.206.129。这两台主机登录的用户名和密码都是一样的，都是通过 login.bat 传进来的。 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px">
  现在我们再在 python 中通过 os.system('D:\\test\\login.bat') 来调用 login.bat 实现自动连接主机。 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <img src="https://images2.imgbox.com/8e/d2/hzW5QAvu_o.png" alt=""> 
 <br> 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <br> 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px">
  如上图所示，执行 python 代码后会调用 bat 文件从而弹出 cmd 窗口，输入正确的用户名和密码即可实现打开 SecureCRT 软件并自动连接主机。 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <br> 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px">
  这时又出现了一个问题，Boss 又说每次连接主机时都要弹出 cmd 窗口并输入用户名和密码，太麻烦了，希望能够 python 执行时隐藏 cmd 窗口直接连接主机。这个考虑也是适当的，本来这样做就是为了方便嘛。 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px">
  既然运行 bat 文件时不能弹出 cmd 窗口以输入用户名和密码，那就要把用户名和密码在 python 执行的时候通过参数的形式传到 bat 文件中。此时要将 login.bat 代码修改入下： 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <pre><code class="language-vb">@set name=%1
@set pwd=%2
 
start "" "D:\Program Files\SecureCRT\SecureCRT.exe" /SCRIPT "D:\test\login.vbs" /arg %name% /arg %pwd%
:end
exit</code></pre> 
 <span style="font-family:微软雅黑; font-size:16px; line-height:24px">代码中的 %1 和 %2 分别表示返回 bat 的第一个参数和第二个参数，用来接收 python 执行的代码中写入的用户名和密码这两个参数。用户名和密码这两个参数实际中是要通过提前输入验证的，这里我们直接写到 python 代码中测试：</span> 
 <br> 
 <img src="https://images2.imgbox.com/c0/9b/oTLDXFXa_o.png" alt=""> 
 <br> 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <br> 
</div> 
<div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px">
   此时便可以隐藏 cmd 窗口，不用每次在 cmd 窗口中输入用户名和密码了。 
 </div> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px">
   这是我觉得已经大功告成了，便拿到生产上去测试，谁知道又出了一点小问题。有些人设置的密码中含有等于号“=”，将带有“=”的参数值传给 bat 文件运行时，bat 会把“=”当成赋值从而导致“=”之后的字符不能传进去，也就是说只能读取到“=”之前的字符，所以密码传到 bat 里就是错误的了。 
 </div> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px">
   这时又要给密码这个字符串动点手脚了。在 python 代码中传入密码这个参数时前后加上双引号，也就是os.system('D:\\test\\login.bat %s "%s"' %('melisky','123456'))。此时密码这个参数传到 bat 中是带双引号的，所以在 bat 中要把双引号再去掉，具体的 bat 文件的代码实现如下： 
 </div> 
 <pre><code class="language-vb">@set name=%1
@set pwd=%2
set pwd1=%pwd:~1,-1%
 
start "" "D:\Program Files\SecureCRT\SecureCRT.exe" /SCRIPT "D:\test\login.vbs" /arg %name% /arg %pwd%
:end
exit</code></pre> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px">
   第3行代码实现就是去掉传进去的密码中双引号。 
 </div> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px">
   此时再执行就可以实现带有“=”的密码的输入了： 
 </div> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
  <img src="https://images2.imgbox.com/9e/d7/aO4tgcVz_o.png" alt=""> 
  <br> 
 </div> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
  <br> 
 </div> 
 <span style="font-family:微软雅黑; font-size:16px; line-height:24px">以上就是我</span> 
 <span style="font-family:微软雅黑; font-size:16px; line-height:24px">通过 python 调用 bat 运行 vbs 脚本实现的自动打开 SecureCRT 并自动连接特定主机的方法了。希望大家有更好的方法的提出来共同学习，也希望我的方法对大家也能有一点帮助。</span> 
 <div style="font-family:微软雅黑; font-size:16px; line-height:24px"> 
  <br> 
 </div> 
 <br> 
 <br> 
</div> 
<p></p> 
<p style="font-family:微软雅黑; font-size:16px; line-height:24px"><span style="line-height:1.5; background-color:inherit"><br> </span></p> 
<br> 
<br> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/748e9b858f8f7ebde48694fb7a0dbdf5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js处理数据的方式记录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/56133f8df004f112d2e1e9bfa8dae976/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql sql_mode小分享</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>