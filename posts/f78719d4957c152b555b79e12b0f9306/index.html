<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用matlab在hfss中建模 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用matlab在hfss中建模" />
<meta property="og:description" content="hfss可以导入vbs语言建模
怎么生成建模的vbs文档？
1.在hfss中建模建一遍
导出建模的vbs，然后笔记本打开vbs，需要改的话直接改。
参考 https://blog.csdn.net/m0_56117494/article/details/128007860 一文
这个方法朴实无华
但是需要写vbs语言，很麻烦
2.matlab编写vbs
还是用vbs，只是在matlab里编辑，通过fprintf和fid 在vbs里加入语句
实际上还是写vbs，如果不知道对应的vbs是什么就完了
和自己在vbs里敲代码没啥区别
3.matlab-hfss-api
当成函数库就行，注意要添加路径才能调用
这里加入了很多简单的hfss开头的函数
嘎嘎好用
这个代码的本质还是写vbs，只不过matlab程序和vbs的对应关系封装到这些函数里了
写完之后打开vbs可以看到生成了和前两种方式一样的vbs
tool→run script
就可以了
分享一个代码案例
close all; clc; addpath(genpath(&#34;D:\MATLAB\R2022a\MatlaHFSSApi&#34;)); %加入调用api的路径，很重要，不然会报错 false = 0; true = 1; tmpPrjFile = &#39;E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\Conical_Horn.hfss&#39;; tmpDataFile = &#39;E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\tmpData.m&#39;; tmpScriptFile = &#39;E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\Conical_Horn.vbs&#39;; % HFSS Executable Path. hfssExePath = &#39;&#34;C:\Program Files\AnsysEM\HFSS15.0\Win64\hfss.exe&#34;&#39;; fid = fopen(&#39;E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\Conical_Horn_18GHz.vbs&#39;, &#39;wt&#39;); % &#39;wt&#39;表示以文本模式打开文件，可写，覆盖原有内容 % 创建一个新的工程并插入一个新的设计 hfssNewProject(fid); hfssInsertDesign(fid, &#39;Conical_Horn&#39;); f = 18; %GHZ hfssaddVar(fid,&#39;f0&#39;,f,[]) f1 = 14; f2 = 22; lambda_in = &#39;1in*300/f0 /25." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f78719d4957c152b555b79e12b0f9306/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-14T15:10:17+08:00" />
<meta property="article:modified_time" content="2023-09-14T15:10:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用matlab在hfss中建模</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>hfss可以导入vbs语言建模<br> 怎么生成建模的vbs文档？<br> 1.在hfss中建模建一遍<br> 导出建模的vbs，然后笔记本打开vbs，需要改的话直接改。<br> 参考 https://blog.csdn.net/m0_56117494/article/details/128007860 一文<br> 这个方法朴实无华<br> 但是需要写vbs语言，很麻烦<br> 2.matlab编写vbs<br> 还是用vbs，只是在matlab里编辑，通过fprintf和fid 在vbs里加入语句<br> 实际上还是写vbs，如果不知道对应的vbs是什么就完了<br> 和自己在vbs里敲代码没啥区别<br> 3.matlab-hfss-api<br> 当成函数库就行，注意要添加路径才能调用<br> 这里加入了很多简单的hfss开头的函数<br> 嘎嘎好用<br> <img src="https://images2.imgbox.com/4c/01/XdjqAEHb_o.png" alt="在这里插入图片描述"><br> 这个代码的本质还是写vbs，只不过matlab程序和vbs的对应关系封装到这些函数里了<br> 写完之后打开vbs可以看到生成了和前两种方式一样的vbs<br> tool→run script<br> 就可以了<br> 分享一个代码案例</p> 
<pre><code>close all;
clc;
addpath(genpath("D:\MATLAB\R2022a\MatlaHFSSApi")); %加入调用api的路径，很重要，不然会报错
false = 0;
true = 1;
tmpPrjFile = 'E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\Conical_Horn.hfss';
tmpDataFile = 'E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\tmpData.m';
tmpScriptFile = 'E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\Conical_Horn.vbs';
% HFSS Executable Path.
hfssExePath = '"C:\Program Files\AnsysEM\HFSS15.0\Win64\hfss.exe"';
fid = fopen('E:\NYM\2023.9 HWHUIGENGSI\HFSSVBS\test20230914\Conical_Horn_18GHz.vbs', 'wt'); % 'wt'表示以文本模式打开文件，可写，覆盖原有内容
% 创建一个新的工程并插入一个新的设计
hfssNewProject(fid);
hfssInsertDesign(fid, 'Conical_Horn');
f = 18; %GHZ
hfssaddVar(fid,'f0',f,[])
f1 = 14;
f2 = 22;
lambda_in = '1in*300/f0 /25.4'; %英寸为单位的波长
Units = 'in';
Waveguide_R = 0.33;
Waveguide_L = 0.66;
Horn_R = 0.92;
Horn_L = 1.31;
Wall_T = 0.013;
hfssaddVar(fid,'lambda_in',lambda_in,[])
hfssaddVar(fid,'Waveguide_R',Waveguide_R,Units)
hfssaddVar(fid,'Waveguide_L',Waveguide_L,Units)
hfssaddVar(fid,'Horn_R',Horn_R,Units)
hfssaddVar(fid,'Horn_L',Horn_L,Units)
hfssaddVar(fid,'Wall_T',Wall_T,Units)
Name_1 = 'Waveguide_in';
Center = [0 0 0];
Axis = 'Z';
Radius = 'Waveguide_R';
Height = 'Waveguide_L';
hfssCylinder(fid, Name_1, Axis, Center, Radius, Height, Units)
Name_2 = 'Waveguide';
Radius = 'Waveguide_R + Wall_T';
hfssCylinder(fid, Name_2, Axis, Center, Radius, Height, Units)
hfssSubtract(fid, Name_2, Name_1)
fclose(fid);
disp('Sctrip Completed')
clear all;
</code></pre> 
<p>无敌大佬的教程<br> 链接：https://pan.baidu.com/s/10vQa89RNsaMd4SP36UTYjg?pwd=f9zt<br> 提取码：f9zt</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f4ff2b17bceec4c5a4d221b58ef81ad5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Vue前端框架12 组件生命周期、生命周期的应用、动态组件、组件保持存活、异步组件、依赖注入、Vue应用原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3234d10db5b310c8db888e5988b5b46a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">greenDao分页加载</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>