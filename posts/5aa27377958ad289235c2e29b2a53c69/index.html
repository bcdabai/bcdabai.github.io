<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>TensorFlow 2.0教程04：Early Stopping - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="TensorFlow 2.0教程04：Early Stopping" />
<meta property="og:description" content="在训练过程中，神经网络中的weights会更新，以使模型在训练数据上的表现更好。一段时间以来，训练集上的改进与测试集上的改进呈正相关。但是，有时会开始过度拟合训练数据，进一步的“改进”将导致泛化性能降低。这称为过度拟合。Early stopping是一种用于在过度拟合发生之前终止训练的技术。
本教程说明了如何在TensorFlow 2中实现early stopping。本教程的所有代码均可在我们的code中找到。
通过tf.keras.EarlyStopping回调函数在TensorFlow中实现early stopping
earlystop_callback = EarlyStopping( monitor=&#39;val_accuracy&#39;, min_delta=0.0001, patience=1)​ monitor跟踪用于决定是否应终止训练的quantity。在这种情况下，我们使用验证准确性。min_delta是触发终止的阈值。在这种情况下，我们要求精度至少应提高0.0001。patience是等待训练停止的“无改善时期”的数量。使用时patience = 1，训练会在第一个时期后立即终止，并且没有改善。
现在，我们可以附加early stop callback并使用early stopping进行训练：
model.fit(train_dataset, epochs=10, callbacks=[earlystop_callback], validation_data=test_dataset, validation_freq=1) ​ Epoch 1/10 390/390 [==============================] - 73s 187ms/step - loss: 2.7133 - accuracy: 0.3300 - val_loss: 6.3186 - val_accuracy: 0.1752 Epoch 2/10 390/390 [==============================] - 39s 100ms/step - loss: 2.2262 - accuracy: 0.4914 - val_loss: 2.5499 - val_accuracy: 0.4358 Epoch 3/10 390/390 [==============================] - 39s 100ms/step - loss: 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5aa27377958ad289235c2e29b2a53c69/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-17T01:24:08+08:00" />
<meta property="article:modified_time" content="2020-08-17T01:24:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">TensorFlow 2.0教程04：Early Stopping</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在训练过程中，神经网络中的weights会更新，以使模型在训练数据上的表现更好。一段时间以来，训练集上的改进与测试集上的改进呈正相关。但是，有时会开始过度拟合训练数据，进一步的“改进”将导致泛化性能降低。这称为过度拟合。Early stopping是一种用于在过度拟合发生之前终止训练的技术。</p> 
<p>本教程说明了如何在TensorFlow 2中实现early stopping。本教程的所有代码均可在我们的<a href="https://github.com/lambdal/TensorFlow2-tutorial/tree/master/04-early-stopping">code</a>中找到。</p> 
<p>通过<code>tf.keras.EarlyStopping</code>回调函数在TensorFlow中实现early stopping</p> 
<pre>earlystop_callback = EarlyStopping(
  monitor='val_accuracy', min_delta=0.0001,
  patience=1)​</pre> 
<p><code>monitor</code>跟踪用于决定是否应终止训练的quantity。在这种情况下，我们使用验证准确性。<code>min_delta</code>是触发终止的阈值。在这种情况下，我们要求精度至少应提高0.0001。<code>patience</code>是等待训练停止的“无改善时期”的数量。使用时<code>patience = 1</code>，训练会在第一个时期后立即终止，并且没有改善。</p> 
<p>现在，我们可以附加early stop callback并使用early stopping进行训练：</p> 
<pre>model.fit(train_dataset,
          epochs=10, callbacks=[earlystop_callback],
          validation_data=test_dataset,
          validation_freq=1)
​
Epoch 1/10
390/390 [==============================] - 73s 187ms/step - loss: 2.7133 - accuracy: 0.3300 - val_loss: 6.3186 - val_accuracy: 0.1752
Epoch 2/10
390/390 [==============================] - 39s 100ms/step - loss: 2.2262 - accuracy: 0.4914 - val_loss: 2.5499 - val_accuracy: 0.4358
Epoch 3/10
390/390 [==============================] - 39s 100ms/step - loss: 1.9842 - accuracy: 0.5801 - val_loss: 2.5666 - val_accuracy: 0.4708
Epoch 4/10
390/390 [==============================] - 39s 99ms/step - loss: 1.8144 - accuracy: 0.6333 - val_loss: 2.2643 - val_accuracy: 0.5407
Epoch 5/10
390/390 [==============================] - 39s 99ms/step - loss: 1.6799 - accuracy: 0.6770 - val_loss: 2.1015 - val_accuracy: 0.5841
Epoch 6/10
390/390 [==============================] - 39s 99ms/step - loss: 1.5700 - accuracy: 0.7104 - val_loss: 2.0468 - val_accuracy: 0.6078
Epoch 7/10
390/390 [==============================] - 38s 98ms/step - loss: 1.4697 - accuracy: 0.7388 - val_loss: 2.0628 - val_accuracy: 0.5925
Epoch 00007: early stopping</pre> 
<p>请注意，第7个Epoch的结果更好的训练准确性，但验证准确性却较低。因此，尽管最大次数设置为10，但训练仍在第7个Epoch终止。</p> 
<p><strong>总结</strong></p> 
<p>本教程说明了TensorFlow 2中如何实现early stopping 。关键要点是使用<code>tf.keras.EarlyStopping</code>回调。通过监视某个值（例如，验证准确性）在最近一段时间内是否有所改善（由<code>patience</code>参数控制）来触发提前停止。</p> 
<p>要重现这些结果，请参考此<a href="https://github.com/lambdal/TensorFlow2-tutorial/tree/master/04-early-stopping">code repo</a></p> 
<p> </p> 
<p>接下来，给大家介绍一下租用GPU做实验的方法，我们是在智星云租用的GPU，使用体验很好。具体大家可以参考：智星云官网： <a href="http://www.ai-galaxy.cn/" rel="nofollow">http://www.ai-galaxy.cn/</a>，淘宝店：<a href="https://shop36573300.taobao.com/" rel="nofollow">https://shop36573300.taobao.com/</a>公众号: 智星AI</p> 
<p><img alt="" src="https://images2.imgbox.com/6e/ff/2F6yowd6_o.png" width="367"></p> 
<p>​</p> 
<p>参考文献：</p> 
<p><a href="https://lambdalabs.com/blog/tensorflow-2-0-tutorial-04-early-stopping/" rel="nofollow">https://lambdalabs.com/blog/tensorflow-2-0-tutorial-04-early-stopping/</a></p> 
<p><a href="https://github.com/lambdal/TensorFlow2-tutorial/tree/master/04-early-stopping">https://github.com/lambdal/TensorFlow2-tutorial/tree/master/04-early-stopping</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/855fbb160a73c746e7c39ae5a2656ccf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二叉排序树之红黑树</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/766649aac7e47f12f5898e68deca8f12/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">互联网公司90%的人都不会开会！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>