<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>docker网络 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="docker网络" />
<meta property="og:description" content="文章目录 简介能干嘛网络模式bridgehostnonecontainer 简介 docker不启动，默认网络情况:
ens33 lo virbr0 在CentOS7的安装过程中如果有选择相关虚拟化的的服务安装系统后，启动网卡时会发现有一个以网桥连接的私网地址的virbr0网卡(virbr0网卡：它还有一个固定的默认IP地址192.168.122.1)，是做虚拟机网桥的使用的，其作用是为连接其上的虚机网卡提供 NAT访问外网的功能。
将libvirtd服务卸载
yum remove libvirt-libs.x86_64 docker启动后，网络情况
会产生一个名为docker0的虚拟网桥
默认创建3大网络模式
All命令
Commands: connect Connect a container to a network create Create a network disconnect Disconnect a container from a network inspect Display detailed information on one or more networks ls List networks prune Remove all unused networks rm Remove one or more networks 查看网络
docker network ls 查看网络源数据
docker network inspect XXX 网络名字 删除网络" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/62dbd7c2e00a1add795e54f9c9d4ee75/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-10T22:04:14+08:00" />
<meta property="article:modified_time" content="2024-01-10T22:04:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">docker网络</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">简介</a></li><li><a href="#_66" rel="nofollow">能干嘛</a></li><li><a href="#_73" rel="nofollow">网络模式</a></li><li><ul><li><ul><li><a href="#bridge_76" rel="nofollow">bridge</a></li><li><a href="#host_104" rel="nofollow">host</a></li><li><a href="#none_106" rel="nofollow">none</a></li><li><a href="#container_109" rel="nofollow">container</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>简介</h2> 
<p>docker不启动，默认网络情况:</p> 
<pre><code class="prism language-bash">ens33

lo

virbr0
</code></pre> 
<blockquote> 
 <p>在CentOS7的安装过程中如果有选择相关虚拟化的的服务安装系统后，启动网卡时会发现有一个以网桥连接的私网地址的virbr0网卡(virbr0网卡：它还有一个固定的默认IP地址192.168.122.1)，是做虚拟机网桥的使用的，其作用是为连接其上的虚机网卡提供 NAT访问外网的功能。</p> 
</blockquote> 
<p>将libvirtd服务卸载</p> 
<pre><code class="prism language-bash">yum remove libvirt-libs.x86_64
</code></pre> 
<p>docker启动后，网络情况<br> 会产生一个名为docker0的虚拟网桥</p> 
<p><img src="https://images2.imgbox.com/7d/90/UER5ch5M_o.png" alt="在这里插入图片描述"><br> <strong>默认创建3大网络模式</strong></p> 
<p><img src="https://images2.imgbox.com/e3/fd/IAuNOxs6_o.png" alt="在这里插入图片描述"><br> All命令<br> <img src="https://images2.imgbox.com/b3/c6/AlAB1N3e_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">Commands:
  connect     Connect a container to a network
  create      Create a network
  disconnect  Disconnect a container from a network
  inspect     Display detailed information on one or <span class="token function">more</span> networks
  <span class="token function">ls</span>          List networks
  prune       Remove all unused networks
  <span class="token function">rm</span>          Remove one or <span class="token function">more</span> networks

</code></pre> 
<p>查看网络</p> 
<pre><code class="prism language-bash"><span class="token function">docker</span> network <span class="token function">ls</span>
</code></pre> 
<p>查看网络源数据</p> 
<pre><code class="prism language-bash"><span class="token function">docker</span> network inspect  XXX 网络名字
</code></pre> 
<p>删除网络</p> 
<pre><code class="prism language-bash"><span class="token function">docker</span> network <span class="token function">rm</span> XXX网络名字
</code></pre> 
<p>案例</p> 
<pre><code class="prism language-bash"><span class="token comment"># 创建新的网络</span>
<span class="token function">docker</span> network create aa_network
<span class="token comment"># 查看</span>
<span class="token function">docker</span> network <span class="token function">ls</span>
<span class="token comment"># 删除</span>
<span class="token function">docker</span> network <span class="token function">rm</span> aa_network
</code></pre> 
<h2><a id="_66"></a>能干嘛</h2> 
<pre><code class="prism language-bash">容器间的互联和通信以及端口映射<span class="token operator">!</span><span class="token punctuation">[</span>请添加图片描述<span class="token punctuation">]</span>

容器IP变动时候可以通过服务名直接网络通信而不受到影响
</code></pre> 
<h2><a id="_73"></a>网络模式</h2> 
<p><img src="https://images2.imgbox.com/5a/67/GQCUY7Xg_o.png" alt="请添加图片描述"><br> 容器实例内默认网络IP生产规则:docker容器内部的ip是有可能会发生改变的</p> 
<h4><a id="bridge_76"></a>bridge</h4> 
<p>Docker 服务默认会创建一个 docker0 网桥（其上有一个 docker0 内部接口），该桥接网络的名称为docker0，它在内核层连通了其他的物理或虚拟网卡，这就将所有容器和本地主机都放到同一个物理网络。Docker 默认指定了 docker0 接口 的 IP 地址和子网掩码，让主机和容器之间可以通过网桥相互通信。</p> 
<pre><code class="prism language-bash"><span class="token comment"># 查看 bridge 网络的详细信息，并通过 grep 获取名称项</span>

<span class="token function">docker</span> network inspect bridge <span class="token operator">|</span> <span class="token function">grep</span> name
</code></pre> 
<p>1 Docker使用Linux桥接，在宿主机虚拟一个Docker容器网桥(docker0)，Docker启动一个容器时会根据Docker网桥的网段分配给容器一个IP地址，称为Container-IP，同时Docker网桥是每个容器的默认网关。因为在同一宿主机内的容器都接入同一个网桥，这样容器之间就能够通过容器的Container-IP直接通信。</p> 
<p>2 docker run 的时候，没有指定network的话默认使用的网桥模式就是bridge，使用的就是docker0。在宿主机ifconfig,就可以看到docker0和自己create的network(后面讲)eth0，eth1，eth2……代表网卡一，网卡二，网卡三……，lo代表127.0.0.1，即localhost，inet addr用来表示网卡的IP地址</p> 
<p>3 网桥docker0创建一对对等虚拟设备接口一个叫veth，另一个叫eth0，成对匹配。</p> 
<p>3.1 整个宿主机的网桥模式都是docker0，类似一个交换机有一堆接口，每个接口叫veth，在本地主机和容器内分别创建一个虚拟接口，并让他们彼此联通（这样一对接口叫veth pair）；</p> 
<p>3.2 每个容器实例内部也有一块网卡，每个接口叫eth0；</p> 
<p>3.3 docker0上面的每个veth匹配某个容器实例内部的eth0，两两配对，一一匹配。</p> 
<p>通过上述，将宿主机上的所有容器都连接到这个内部网络上，两个容器在同一个网络下,会从这个网关下各自拿到分配的ip，此时两个容器的网络是互通的。<br> <img src="https://images2.imgbox.com/6d/34/Ee6vTf0K_o.png" alt="请添加图片描述"></p> 
<h4><a id="host_104"></a>host</h4> 
<p>容器将不会获得一个独立的Network Namespace， 而是和宿主机共用一个Network Namespace。容器将不会虚拟出自己的网卡而是使用宿主机的IP和端口。<img src="https://images2.imgbox.com/79/c2/dt1sQ6Ct_o.png" alt="请添加图片描述"></p> 
<h4><a id="none_106"></a>none</h4> 
<p>禁用网络功能，只有lo标识(就是127.0.0.1表示本地回环)</p> 
<h4><a id="container_109"></a>container</h4> 
<p>container⽹络模式</p> 
<p>新建的容器和已经存在的一个容器共享一个网络ip配置而不是和宿主机共享。新创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围等。同样，两个容器除了网络方面，其他的如文件系统、进程列表等还是隔离的。<br> <img src="https://images2.imgbox.com/1e/f1/Zb9R90CP_o.png" alt="请添加图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5aa31b77185fdc1e4ca62173bb390f6d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Springboot整合Mybatis的一般步骤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/736b4372d596a46646919268e4aa0deb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【SpringCloud】@Validated @Valid 不起作用 2.3.0及以上版本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>