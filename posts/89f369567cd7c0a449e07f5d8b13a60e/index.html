<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rabbitmq-exporteréƒ¨ç½²æ–¹å¼ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="rabbitmq-exporteréƒ¨ç½²æ–¹å¼" />
<meta property="og:description" content="ç›®å½• rabbitmq-exporteréƒ¨ç½²æ–¹å¼æ¥æºè¯´æ˜éƒ¨ç½²æ–¹å¼dockeréƒ¨ç½²ï¼šé…ç½®æ–‡ä»¶é…ç½® æ‰©å±•çš„ RabbitMQ åŠŸèƒ½ rabbitmq-exporteréƒ¨ç½²æ–¹å¼ æ¥æº https://github.com/kbudde/rabbitmq_exporter/
è¯´æ˜ RabbitMQ æŒ‡æ ‡çš„ Prometheus å¯¼å‡ºå™¨ã€‚æ•°æ®ç”±prometheus æŠ“å–ã€‚
è¯·æ³¨æ„è¿™æ˜¯ä¸€ä¸ªéå®˜æ–¹æ’ä»¶ã€‚è¿˜æœ‰ä¸€ä¸ªæ¥è‡ªRabbitMQ.comçš„å®˜æ–¹æ’ä»¶ã€‚æŸ¥çœ‹ä¸å®˜æ–¹å‡ºå£å•†çš„æ¯”è¾ƒ
éƒ¨ç½²æ–¹å¼ dockeréƒ¨ç½²ï¼š rabbitmq_exporter ä¸ rabbitmq å®¹å™¨å…±äº«ç½‘ç»œæ¥å£ -&gt; å¯ä»¥ä½¿ç”¨ localhost å’Œé»˜è®¤ç”¨æˆ·/å¯†ç ï¼ˆguestï¼‰ã€‚
å¯åŠ¨rabbitMQ docker run -d -e RABBITMQ_NODENAME=my-rabbit --name my-rabbit -p 9419:9419 rabbitmq:3-management åœ¨å®¹å™¨ä¸­å¯åŠ¨ rabbitmq_exporter docker run -d --net=container:my-rabbit kbudde/rabbitmq-exporter ç°åœ¨æ‚¨çš„æŒ‡æ ‡é€šè¿‡http://host:9419/metricså…¬å¼€
é…ç½®æ–‡ä»¶é…ç½® æ–‡ä»¶ä¸‹è½½ï¼š
https://github.com/kbudde/rabbitmq_exporter/releases/download/v1.0.0-RC8/rabbitmq_exporter-1.0.0-RC8.linux-amd64.tar.gz
è§£å‹åè¿›å…¥ç›®å½•ï¼›
Rabbitmq_exporter å¯ä»¥ä½¿ç”¨ json é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ã€‚
Rabbitmq_exporter éœ€è¦â€œconf/rabbitmq.confâ€ä¸­çš„é…ç½®æ–‡ä»¶ã€‚å¦‚æœæ‚¨åœ¨å®¹å™¨ (docker/kubernetes) ä¸­è¿è¡Œå¯¼å‡ºå™¨ï¼Œåˆ™é…ç½®å¿…é¡»åœ¨â€œ/conf/rabbitmq.confâ€ä¸­ã€‚æ–‡ä»¶åå¯ä»¥ç”¨æ ‡å¿—è¦†ç›–ï¼š
./rabbitmq_exporter -config-file config.example.json å…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š
{ &#34;rabbit_url&#34;: &#34;http://127.0.0.1:15672&#34;, &#34;rabbit_user&#34;: &#34;guest&#34;, &#34;rabbit_pass&#34;: &#34;guest&#34;, &#34;publish_port&#34;: &#34;9419&#34;, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/89f369567cd7c0a449e07f5d8b13a60e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-16T15:10:42+08:00" />
<meta property="article:modified_time" content="2021-07-16T15:10:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">rabbitmq-exporteréƒ¨ç½²æ–¹å¼</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>ç›®å½•</h4> 
 <ul><li><a href="#rabbitmqexporter_1" rel="nofollow">rabbitmq-exporteréƒ¨ç½²æ–¹å¼</a></li><li><ul><li><a href="#_2" rel="nofollow">æ¥æº</a></li><li><a href="#_4" rel="nofollow">è¯´æ˜</a></li><li><a href="#_9" rel="nofollow">éƒ¨ç½²æ–¹å¼</a></li><li><ul><li><a href="#docker_10" rel="nofollow">dockeréƒ¨ç½²ï¼š</a></li><li><a href="#_22" rel="nofollow">é…ç½®æ–‡ä»¶é…ç½®</a></li></ul> 
   </li><li><a href="#_RabbitMQ__91" rel="nofollow">æ‰©å±•çš„ RabbitMQ åŠŸèƒ½</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="rabbitmqexporter_1"></a>rabbitmq-exporteréƒ¨ç½²æ–¹å¼</h2> 
<h3><a id="_2"></a>æ¥æº</h3> 
<p><a href="https://github.com/kbudde/rabbitmq_exporter/">https://github.com/kbudde/rabbitmq_exporter/</a></p> 
<h3><a id="_4"></a>è¯´æ˜</h3> 
<p>RabbitMQ æŒ‡æ ‡çš„ Prometheus å¯¼å‡ºå™¨ã€‚æ•°æ®ç”±prometheus æŠ“å–ã€‚</p> 
<p>è¯·æ³¨æ„è¿™æ˜¯ä¸€ä¸ªéå®˜æ–¹æ’ä»¶ã€‚è¿˜æœ‰ä¸€ä¸ªæ¥è‡ªRabbitMQ.comçš„å®˜æ–¹æ’ä»¶ã€‚æŸ¥çœ‹ä¸<a href="https://github.com/kbudde/rabbitmq_exporter/#-Comparison-to-official-exporter">å®˜æ–¹å‡ºå£å•†</a>çš„æ¯”è¾ƒ</p> 
<h3><a id="_9"></a>éƒ¨ç½²æ–¹å¼</h3> 
<h4><a id="docker_10"></a>dockeréƒ¨ç½²ï¼š</h4> 
<p>rabbitmq_exporter ä¸ rabbitmq å®¹å™¨å…±äº«ç½‘ç»œæ¥å£ -&gt; å¯ä»¥ä½¿ç”¨ localhost å’Œé»˜è®¤ç”¨æˆ·/å¯†ç ï¼ˆguestï¼‰ã€‚</p> 
<ol><li>å¯åŠ¨rabbitMQ</li></ol> 
<pre><code> docker run -d -e RABBITMQ_NODENAME=my-rabbit --name my-rabbit -p 9419:9419 rabbitmq:3-management
</code></pre> 
<ol start="2"><li>åœ¨å®¹å™¨ä¸­å¯åŠ¨ rabbitmq_exporter</li></ol> 
<pre><code> docker run -d --net=container:my-rabbit kbudde/rabbitmq-exporter
</code></pre> 
<p>ç°åœ¨æ‚¨çš„æŒ‡æ ‡é€šè¿‡http://host:9419/metricså…¬å¼€</p> 
<h4><a id="_22"></a>é…ç½®æ–‡ä»¶é…ç½®</h4> 
<p>æ–‡ä»¶ä¸‹è½½ï¼š<br> <a href="https://github.com/kbudde/rabbitmq_exporter/releases/download/v1.0.0-RC8/rabbitmq_exporter-1.0.0-RC8.linux-amd64.tar.gz">https://github.com/kbudde/rabbitmq_exporter/releases/download/v1.0.0-RC8/rabbitmq_exporter-1.0.0-RC8.linux-amd64.tar.gz</a><br> è§£å‹åè¿›å…¥ç›®å½•ï¼›<br> Rabbitmq_exporter å¯ä»¥ä½¿ç”¨ json é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ã€‚<br> Rabbitmq_exporter éœ€è¦â€œconf/rabbitmq.confâ€ä¸­çš„é…ç½®æ–‡ä»¶ã€‚å¦‚æœæ‚¨åœ¨å®¹å™¨ (docker/kubernetes) ä¸­è¿è¡Œå¯¼å‡ºå™¨ï¼Œåˆ™é…ç½®å¿…é¡»åœ¨â€œ/conf/rabbitmq.confâ€ä¸­ã€‚æ–‡ä»¶åå¯ä»¥ç”¨æ ‡å¿—è¦†ç›–ï¼š</p> 
<pre><code>./rabbitmq_exporter -config-file config.example.json
</code></pre> 
<p>å…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š</p> 
<pre><code>{
    "rabbit_url": "http://127.0.0.1:15672",
    "rabbit_user": "guest",
    "rabbit_pass": "guest",
    "publish_port": "9419",
    "publish_addr": "",
    "output_format": "TTY",
    "ca_file": "ca.pem",
    "cert_file": "client-cert.pem",
    "key_file": "client-key.pem",
    "insecure_skip_verify": false,
    "exlude_metrics": [],
    "include_queues": ".*",
    "skip_queues": "^$",
    "skip_vhost": "^$",
    "include_vhost": ".*",
    "rabbit_capabilities": "no_sort,bert",
    "enabled_exporters": [
            "exchange",
            "node",
            "overview",
            "queue"
    ],
    "timeout": 30,
    "max_queues": 0
}
</code></pre> 
<p><strong>æ³¨ï¼š</strong></p> 
<table><thead><tr><th>Environment</th><th>variable</th><th>default description</th></tr></thead><tbody><tr><td>RABBIT_URL</td><td>http://127.0.0.1:15672</td><td>url to rabbitMQ management plugin (must start with http(s)ğŸ˜•/)</td></tr><tr><td>RABBIT_USER</td><td>guest</td><td>username for rabbitMQ management plugin. User needs monitoring tag!</td></tr><tr><td>RABBIT_PASSWORD</td><td>guest</td><td>password for rabbitMQ management plugin</td></tr><tr><td>RABBIT_USER_FILE</td><td></td><td>location of file with username (useful for docker secrets)</td></tr><tr><td>RABBIT_PASSWORD_FILE</td><td></td><td>location of file with password (useful for docker secrets)</td></tr><tr><td>PUBLISH_PORT</td><td>9419</td><td>Listening port for the exporter</td></tr><tr><td>PUBLISH_ADDR</td><td>â€œâ€</td><td>Listening host/IP for the exporter</td></tr><tr><td>OUTPUT_FORMAT</td><td>TTY</td><td>Log ouput format. TTY and JSON are suported</td></tr><tr><td>LOG_LEVEL</td><td>info</td><td>log level. possible values: â€œdebugâ€, â€œinfoâ€, â€œwarningâ€, â€œerrorâ€, â€œfatalâ€, or â€œpanicâ€</td></tr><tr><td>CAFILE</td><td>ca.pem</td><td>path to root certificate for access management plugin. Just needed if self signed certificate is used. Will be ignored if the file does not exist</td></tr><tr><td>CERTFILE</td><td>client-cert.pem</td><td>path to client certificate used to verify the exporterâ€™s authenticity. Will be ignored if the file does not exist</td></tr><tr><td>KEYFILE</td><td>client-key.pem</td><td>path to private key used with certificate to verify the exporterâ€™s authenticity. Will be ignored if the file does not exist</td></tr><tr><td>SKIPVERIFY</td><td>false</td><td>true/0 will ignore certificate errors of the management plugin</td></tr><tr><td>SKIP_VHOST</td><td>^$</td><td>regex, matching vhost names are not exported. First performs INCLUDE_VHOST, then SKIP_VHOST</td></tr><tr><td>INCLUDE_VHOST</td><td>.*</td><td>regex vhost filter. Only queues in matching vhosts are exported</td></tr><tr><td>INCLUDE_QUEUES</td><td>.*</td><td>regex queue filter. Just matching names are exported</td></tr><tr><td>SKIP_QUEUES</td><td>^$</td><td>regex, matching queue names are not exported (useful for short-lived rpc queues). First performed INCLUDE, after SKIP</td></tr><tr><td>RABBIT_CAPABILITIES</td><td>bert,no_sort</td><td>comma-separated list of extended scraping capabilities supported by the target RabbitMQ server</td></tr><tr><td>RABBIT_EXPORTERS</td><td>exchange,node,queue</td><td>List of enabled modules. Possible modules: connections,shovel,federation,exchange,node,queue,memory</td></tr><tr><td>RABBIT_TIMEOUT</td><td>30</td><td>timeout in seconds for retrieving data from management plugin.</td></tr><tr><td>MAX_QUEUES</td><td>0</td><td>max number of queues before we drop metrics (disabled if set to 0)</td></tr><tr><td>EXCLUDE_METRICS</td><td></td><td>Metric names to exclude from export. comma-seperated. e.g. â€œrecv_oct, recv_cntâ€. See exporter_*.go for names</td></tr></tbody></table> 
<p>ç¤ºä¾‹å’Œæ¨èè®¾ç½®ï¼š</p> 
<pre><code>SKIP_QUEUES="RPC_.*" MAX_QUEUES=5000 ./rabbitmq_exporter
</code></pre> 
<h3><a id="_RabbitMQ__91"></a>æ‰©å±•çš„ RabbitMQ åŠŸèƒ½</h3> 
<p>â€‚â€‚è¾ƒæ–°ç‰ˆæœ¬çš„ RabbitMQ å¯ä»¥æä¾›ä¸€äº›åŠŸèƒ½ï¼Œä»¥å‡å°‘å› æŠ“å–æ­¤å¯¼å‡ºå™¨æ‰€éœ€çš„æ•°æ®è€Œé€ æˆçš„å¼€é”€ã€‚RABBIT_CAPABILITIESenv varç›®å‰æ”¯æŒä»¥ä¸‹åŠŸèƒ½ ï¼š</p> 
<ul><li>no_sortï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒRabbitMQ ç®¡ç†æ’ä»¶ä½¿ç”¨ vhost/name çš„é»˜è®¤æ’åºé¡ºåºå¯¹ç»“æœè¿›è¡Œæ’åºã€‚?sort=ä»ç‰ˆæœ¬ 3.6.8 å¼€å§‹ï¼Œå¯ä»¥é€šè¿‡å°†ç©ºæ’åºå‚æ•° ( )ä¼ é€’ç»™ RabbitMQæ¥é¿å…è¿™ç§æ’åºå¼€é”€ã€‚åœ¨æ—©æœŸçš„ 3.6.X ç‰ˆæœ¬ä¸Šå¯ä»¥å®‰å…¨åœ°å¯ç”¨æ­¤é€‰é¡¹ï¼Œä½†å®ƒä¸ä¼šæä¾›ä»»ä½•æ€§èƒ½æ”¹è¿›ã€‚å®ƒä¸ 3.4.X å’Œ 3.5.X ä¸å…¼å®¹ã€‚</li><li>bertï¼šä» 3.6.9ï¼ˆå‚è§ https://github.com/rabbitmq/rabbitmq-management/pull/367ï¼‰å¼€å§‹ï¼ŒRabbitMQ æ”¯æŒ BERT ç¼–ç ä½œä¸º JSON æ›¿ä»£æ–¹æ¡ˆã€‚é‰´äº BERT ç¼–ç æ˜¯åœ¨ Erlang VM ä¸­ç”¨ C å®ç°çš„ï¼Œå®ƒæ¯”çº¯ Erlang JSON ç¼–ç æ›´æœ‰æ•ˆã€‚æ‰€ä»¥å½“æˆ‘ä»¬åœ¨ RabbitMQ ä¸­æœ‰å¾ˆå¤šå¯¹è±¡æ—¶ï¼Œè¿™å¤§å¤§å‡å°‘äº†ç›‘æ§å¼€é”€ã€‚<br> rabbmitmq &lt; 3.6 ç”¨æˆ·æ³¨æ„äº‹é¡¹<br> é»˜è®¤æƒ…å†µä¸‹å¯ç”¨ no_sort å’Œ bertã€‚æ‚¨å¿…é¡»ä½¿ç”¨ä»¥ä¸‹å†…å®¹è¦†ç›–é»˜è®¤è®¾ç½®ï¼š</li></ul> 
<pre><code>RABBIT_CAPABILITIES=nobert ./rabbitmq_exporter
</code></pre> 
<p>æ‰€æœ‰æŒ‡æ ‡ï¼ˆgolang/prometheus æŒ‡æ ‡é™¤å¤–ï¼‰éƒ½ä»¥â€œrabbitmq_â€ä¸ºå‰ç¼€ã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d427671da50b8a86f81fc0a10142e457/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">postgres-exporteréƒ¨ç½²ä¹¦å†Œ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/219745279bd39a42243e0cf323ba42dc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">è§£å†³wordæˆ–wpsåˆ é™¤ç©ºç™½é¡µåé¡µé¢å¸ƒå±€å˜ä¹±</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>