<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue element&#43;vue-cropper(图片剪裁&#43;上传服务器) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue element&#43;vue-cropper(图片剪裁&#43;上传服务器)" />
<meta property="og:description" content="1.预览效果
官网地址可以去看看里面的介绍:https://github.com/xyxiao001/vue-cropper
1.先在项目中安装一下
方法1：npm install vue-cropper 方法2：yarn add vue-cropper 2.安装成功在项目中的main.js引入
import VueCropper from &#39;vue-cropper&#39; Vue.use(VueCropper) //方便我们直接用 3.我们最好把这个封装成一个组件 这样的话在其他页面都能用
组件：YUploadImg
&lt;template&gt; &lt;el-dialog title=&#34;图片剪裁&#34; width=&#34;630px&#34; :visible.sync=&#34;dialogVisible&#34; append-to-body&gt; &lt;div class=&#34;cropper-content&#34;&gt; &lt;div class=&#34;cropper&#34; style=&#34;text-align: center&#34;&gt; &lt;!-- 这个组件vueCropper就是我们刚才引入在main.js里面的那个 直接拿来用 就好 --&gt; &lt;vueCropper ref=&#34;cropper&#34; :img=&#34;option.img&#34; :output-size=&#34;option.size&#34; :output-type=&#34;option.outputType&#34; :info=&#34;true&#34; :full=&#34;option.full&#34; :can-move=&#34;option.canMove&#34; :can-move-box=&#34;option.canMoveBox&#34; :original=&#34;option.original&#34; :auto-crop=&#34;option.autoCrop&#34; :fixed=&#34;option.fixed&#34; :fixed-number=&#34;option.fixedNumber&#34; :center-box=&#34;option.centerBox&#34; :info-true=&#34;option.infoTrue&#34; :fixed-box=&#34;option.fixedBox&#34; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;div slot=&#34;footer&#34; class=&#34;dialog-footer&#34;&gt; &lt;el-button&gt; &lt;el-upload class=&#34;avatar-uploader&#34; list-type=&#34;picture&#34; action=&#34;&#34; :auto-upload=&#34;false&#34; :show-file-list=&#34;false&#34; :on-change=&#34;changeUpload&#34;&gt; &lt;i class=&#34;el-icon-refresh&#34; style=&#34; margin-right: 5px;&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1e24e3886c5ce7ddafc923bb5dd32bc3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-24T18:10:10+08:00" />
<meta property="article:modified_time" content="2022-05-24T18:10:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue element&#43;vue-cropper(图片剪裁&#43;上传服务器)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.预览效果</p> 
<p><img alt="" height="592" src="https://images2.imgbox.com/87/48/K7879faN_o.png" width="636"></p> 
<p>官网地址可以去看看里面的介绍:https://github.com/xyxiao001/vue-cropper</p> 
<p>1.先在项目中安装一下</p> 
<pre><code class="language-javascript">方法1：npm install vue-cropper

方法2：yarn add vue-cropper</code></pre> 
<p>2.安装成功在项目中的main.js引入</p> 
<pre><code class="language-javascript">import VueCropper from 'vue-cropper'
Vue.use(VueCropper)  //方便我们直接用</code></pre> 
<p></p> 
<p>3.我们最好把这个封装成一个组件 这样的话在其他页面都能用</p> 
<p>组件：YUploadImg</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;el-dialog title="图片剪裁" width="630px" :visible.sync="dialogVisible" append-to-body&gt;
    &lt;div class="cropper-content"&gt;
      &lt;div class="cropper" style="text-align: center"&gt;
        &lt;!-- 这个组件vueCropper就是我们刚才引入在main.js里面的那个 直接拿来用 就好 --&gt;
        &lt;vueCropper ref="cropper" :img="option.img" :output-size="option.size" :output-type="option.outputType" :info="true" :full="option.full" :can-move="option.canMove" :can-move-box="option.canMoveBox" :original="option.original" :auto-crop="option.autoCrop" :fixed="option.fixed" :fixed-number="option.fixedNumber" :center-box="option.centerBox" :info-true="option.infoTrue" :fixed-box="option.fixedBox" /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div slot="footer" class="dialog-footer"&gt;
      &lt;el-button&gt;
        &lt;el-upload class="avatar-uploader" list-type="picture" action="" :auto-upload="false" :show-file-list="false" :on-change="changeUpload"&gt;
          &lt;i class="el-icon-refresh" style=" margin-right: 5px;" /&gt;换图片
        &lt;/el-upload&gt;
      &lt;/el-button&gt;
      &lt;el-button @click="dialogVisible = false"&gt;取 消&lt;/el-button&gt;
      &lt;el-button type="primary" @click="finish"&gt;确认&lt;/el-button&gt;
    &lt;/div&gt;
  &lt;/el-dialog&gt;
&lt;/template&gt;
&lt;script&gt;
import axios from 'axios'  //你们有封装接口了的 就直接用你们封装的方法来写 我这里是为了做样式 就直接用了axios请求
export default {
  data() {
    return {
      dialogVisible: false,
      // 这都是需要用到的参数看个人需求 用不到的可以删除  可以去官网参考一下
      option: {
        name: '',
        img: '', 
        info: true,
        outputSize: 1, 
        outputType: 'png',
        canScale: false,
        autoCrop: true, 
        fixedBox: false, 
        fixed: true, 
        fixedNumber: [300, 170],
        full: true, 
        canMoveBox: true, 
        original: false, 
        centerBox: false, 
        infoTrue: true, 
      },
    }
  },
  mounted() {
  },
  methods: {
    changeUpload(file) {
      let testmsg = file.name.substring(file.name.lastIndexOf('.') + 1)
      const isJPG = testmsg === 'jpg'
      const isPNG = testmsg === 'png'
      if (!isJPG &amp;&amp; !isPNG) {
        this.$message.error('上传封面图片只能是 JPG 或 PNG 格式!');
        return
      }
      this.$nextTick(() =&gt; {
        this.option.img = file.url
        this.option.name = file.name
        this.dialogVisible = true
      })
    },
    finish() {
      this.$refs.cropper.getCropBlob(async (data) =&gt; {
        let file = new FormData() //转formData格式 因为我们获取的是blob类型 我后端只支持文件类型所以转了 如果你们后端什么格式都接受 这里就不用走了
        var abc = new File([data], this.option.name, { type: "image/jpg", });
        file.append('file', abc)
        axios.post('这里是你要上传服务器的地址', file, { headers: { 'Content-Type': 'application/x-www-form-urlencoded', 'token': '这里是token  后端需要的话就带 不需要这个可以删掉' } }).then(res =&gt; {
          console.log(res);//后端返回来的图片地址
          this.dialogVisible = false
        })
      })
    },
  }
}
&lt;/script&gt;

&lt;style scoped&gt;
.cropper {
  width: 100%;
  height: 400px;
}
&lt;/style&gt;
</code></pre> 
<p>页面上使用：</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div class="unload-box"&gt;
    &lt;YUploadImg ref="YUploadImgref" /&gt;
    &lt;!-- 这里是element的上传图片组件 需要加上on-change这个事件 我们就用他的选择图片操作 上传的操作我们就交给vue-cropper他来 --&gt;
    &lt;el-upload class="avatar-uploader" list-type="picture" action="" :auto-upload="false" :show-file-list="false" :on-change="changeUpload"&gt;
      &lt;img :src="图片地址" class="avatar"&gt;
    &lt;/el-upload&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import YUploadImg from '@/components/y-upload-img/index.vue'
export default {
  methods: {
    changeUpload(file) {
      let testmsg = file.name.substring(file.name.lastIndexOf('.') + 1)
      const isJPG = testmsg === 'jpg'
      const isPNG = testmsg === 'png'
      if (!isJPG &amp;&amp; !isPNG) {
        this.$message.error('上传头像图片只能是 JPG 或 PNG 格式!');
        return
      }
      this.$nextTick(() =&gt; { //一下操作是赋值给组件那边的
        this.$refs.YUploadImgref.option.img = file.url
        this.$refs.YUploadImgref.option.name = file.name
        this.$refs.YUploadImgref.dialogVisible = true
      })
    }
  }
}

&lt;/script&gt;</code></pre> 
<p>溜啦溜啦 </p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8f95a335315bed87b6cee4f858060133/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">php基础知识点及留言板功能实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d6d6b0436cafbe1fcd601a0a26ae5560/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">php json_encode 返回 this request has no response data available</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>