<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>R语言实现 Copula 算法建模相依性案例分析报告 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="R语言实现 Copula 算法建模相依性案例分析报告" />
<meta property="og:description" content="最近我们被要求撰写关于Copula 的研究报告，包括一些图形和统计输出。 copula是将多变量分布函数与其边缘分布函数耦合的函数，通常称为边缘。Copula是建模和模拟相关随机变量的绝佳工具。Copula的主要吸引力在于，通过使用它们，你可以分别对相关结构和边缘（即每个随机变量的分布）进行建模。 相关视频：Copula算法原理和R语言股市收益率相依性可视化分析 Copula算法原理和R语言股市收益率相依性可视化分析
，时长16:34
copulas如何工作 首先，让我们了解copula的工作方式。 set.seed（100） m &lt; - 3 n &lt; - 2000 z &lt; - mvrnorm（n，mu = rep（0，m），Sigma = sigma，empirical = T） 我们使用cor()和散点图矩阵检查样本相关性。 pairs.panels（Z） [，1] [，2] [，3] [1，] 1.0000000 0.3812244 0.1937548 [2，] 0.3812244 1.0000000 -0.7890814 [3，] 0.1937548 -0.7890814 1.0000000 pairs.panels（U） 这是包含新随机变量的散点图矩阵u。 我们可以绘制矢量的3D图表示u。 现在，作为最后一步，我们只需要选择边缘并应用它。我选择了边缘为Gamma，Beta和Student，并使用下面指定的参数。
x1 &lt; - qgamma（u [，1]，shape = 2，scale = 1） x2 &lt; - qbeta（u [，2]，2,2） x3 &lt; - qt（u [，3]，df = 5） 下面是我们模拟数据的3D图。 df &lt; - cbind（x1，x2，x3） pairs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1b43c337d89af97da7d5141910879d43/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-18T22:51:20+08:00" />
<meta property="article:modified_time" content="2024-01-18T22:51:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">R语言实现 Copula 算法建模相依性案例分析报告</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0px;">最近我们被要求撰写关于Copula 的研究报告，包括一些图形和统计输出。</h3> 
<p style="margin-left:0px;"></p> 
<p style="margin-left:0px;">copula是将多变量分布函数与其边缘分布函数耦合的函数，通常称为边缘。Copula是建模和模拟相关随机变量的绝佳工具。Copula的主要吸引力在于，通过使用它们，你可以分别对相关结构和边缘（即每个随机变量的分布）进行建模。 </p> 
<h3><strong>相关视频：Copula算法原理和R语言股市收益率相依性可视化分析</strong></h3> 
<p></p> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="TU5EOqqu-1647569869487" frameborder="0" src="https://player.bilibili.com/player.html?aid=809810874" allowfullscreen="true" data-mediaembed="bilibili"></iframe> 
 <p>Copula算法原理和R语言股市收益率相依性可视化分析</p> 
</div> 
<p>，时长16:34</p> 
<h2 style="margin-left:0px;"><strong><span style="color:#ce4f00;">copulas如何工作 </span></strong></h2> 
<p>首先，让我们了解copula的工作方式。 </p> 
<pre class="has" style="margin-left:0px;"><code class="language-html"> set.seed（100）

m &lt; -  3
n &lt; -  2000
 
z &lt; -  mvrnorm（n，mu = rep（0，m），Sigma = sigma，empirical = T）
</code></pre> 
<p>我们使用<code>cor()</code>和散点图矩阵检查样本相关性。 </p> 
<pre class="has" style="margin-left:0px;"><code class="language-html"> 
pairs.panels（Z）

          [，1] [，2] [，3]
[1，] 1.0000000 0.3812244 0.1937548
[2，] 0.3812244 1.0000000 -0.7890814
[3，] 0.1937548 -0.7890814 1.0000000
</code></pre> 
<p style="margin-left:0px;"><br><span style="color:#000000;"> </span></p> 
<p style="margin-left:0px;"><img alt="" class="has" height="406" src="https://images2.imgbox.com/3d/50/AfFskQLB_o.png" width="451"></p> 
<pre class="has" style="margin-left:0px;"><code class="language-html"> 
pairs.panels（U）
</code></pre> 
<p>这是包含新随机变量的散点图矩阵<code>u</code>。 </p> 
<p style="margin-left:0px;"><img alt="" class="has" height="398" src="https://images2.imgbox.com/c1/96/TgexvG58_o.png" width="388"><br>  </p> 
<p> 我们可以绘制矢量的3D图表示<code>u</code>。 </p> 
<p style="margin-left:0px;"><img alt="" class="has" height="396" src="https://images2.imgbox.com/26/bd/oWVL3S1F_o.png" width="452"></p> 
<p style="margin-left:0px;"><span style="color:#000000;"> </span><br>  </p> 
<p>现在，作为最后一步，我们只需要选择边缘并应用它。我选择了边缘为Gamma，Beta和Student，并使用下面指定的参数。</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html">x1 &lt; -  qgamma（u [，1]，shape = 2，scale = 1）
x2 &lt; -  qbeta（u [，2]，2,2）
x3 &lt; -  qt（u [，3]，df = 5）
 </code></pre> 
<p>下面是我们模拟数据的3D图。 </p> 
<p style="margin-left:0px;"><img alt="" class="has" height="375" src="https://images2.imgbox.com/00/71/yivFjRqa_o.png" width="371"></p> 
<p style="margin-left:0px;"><span style="color:#000000;"> </span></p> 
<pre class="has" style="margin-left:0px;"><code class="language-html">df &lt; -  cbind（x1，x2，x3）
pairs.panels（DF）
 
          x1 x2 x3
x1 1.0000000 0.3812244 0.1937548
x2 0.3812244 1.0000000 -0.7890814
x3 0.1937548 -0.7890814 1.0000000
</code></pre> 
<p>这是随机变量的散点图矩阵：</p> 
<p style="margin-left:0px;"><img alt="" class="has" height="390" src="https://images2.imgbox.com/fc/d8/1EDvDgkr_o.png" width="466"></p> 
<p style="margin-left:0px;"></p> 
<h2 style="margin-left:0px;"><strong><span style="color:#ce4f00;">使用copula</span></strong></h2> 
<p>让我们使用copula复制上面的过程。</p> 
<p>现在我们已经通过copula（普通copula）指定了相依结构并设置了边缘，<code>mvdc()</code>函数生成了所需的分布。然后我们可以使用<code>rmvdc()</code>函数生成随机样本。</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html"> 
colnames（Z2）&lt; -  c（“x1”，“x2”，“x3”）
pairs.panels（Z2）
</code></pre> 
<p>模拟数据当然非常接近之前的数据，显示在下面的散点图矩阵中：</p> 
<p style="margin-left:0px;"><img alt="" class="has" height="402" src="https://images2.imgbox.com/98/a9/tDR1oFLu_o.png" width="421"></p> 
<p style="margin-left:0px;"></p> 
<h2 style="margin-left:0px;"><strong><span style="color:#ce4f00;">简单的应用示例</span></strong></h2> 
<p>现在为现实世界的例子。我们将拟合两个股票 ，并尝试使用copula模拟 。 </p> 
<p>让我们在R中加载 ：</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html">cree &lt; -  read.csv（'cree_r.csv'，header = F）$ V2
yahoo &lt; -  read.csv（'yahoo_r.csv'，header = F）$ V2
</code></pre> 
<p>在直接进入copula拟合过程之前，让我们检查两个股票收益之间的相关性并绘制回归线：</p> 
<p>我们可以看到 正相关 ：</p> 
<p style="margin-left:0px;"><img alt="" class="has" height="348" src="https://images2.imgbox.com/4a/73/dAa1vrH9_o.png" width="344"></p> 
<p style="margin-left:0px;"></p> 
<p style="margin-left:0px;">在上面的第一个例子中，我选择了一个正态的copula模型，但是，当将这些模型应用于实际数据时，应该仔细考虑哪些更适合数据。例如，许多copula更适合建模非对称相关，其他强调尾部相关性等等。我对股票收益率的猜测是，t-copula应该没问题，但是猜测肯定是不够的。本质上， 允许我们通过函数使用BIC和AIC执行copula选择 ：</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html"> 
  pobs（as.matrix（cbind（cree，yahoo）））[，1]
  selectedCopula
 

$ PAR
[1] 0.4356302

$ PAR2
[1] 3.844534
</code></pre> 
<p style="margin-left:0px;">拟合算法确实选择了t-copula并为我们估计了参数。 <br> 让我们尝试拟合建议的模型，并检查参数拟合。</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html">t.cop  
set.seed（500）
m &lt; -  pobs（as.matrix（cbind（cree，yahoo）））
 
COEF（FIT）

  rho.1 df 
0.43563 3.84453 
</code></pre> 
<p style="margin-left:0px;"> 我们来看看我们刚估计的copula的密度</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html">rho &lt; -  coef（fit）[1]
df &lt; -  coef（fit）[2]
 
</code></pre> 
<p style="margin-left:0px;"><img alt="" class="has" height="273" src="https://images2.imgbox.com/fb/d8/eazuRLCz_o.png" width="317"></p> 
<p>现在我们只需要建立Copula并从中抽取3965个随机样本。</p> 
<pre class="has" style="margin-left:0px;"><code class="language-html">  rCopula（3965，tCopula（  = 2， ，df = df））
 

          [，1] [，2]
[1，] 1.0000000 0.3972454
[2，] 0.3972454 1.0000000
</code></pre> 
<p style="margin-left:0px;">这是包含的样本的图：</p> 
<p style="margin-left:0px;"><img alt="" class="has" height="363" src="https://images2.imgbox.com/c4/55/2v5lXBIJ_o.png" width="342"></p> 
<p style="margin-left:0px;"><span style="color:#000000;"> </span></p> 
<p>t-copula通常适用于在极值（分布的尾部）中存在高度相关性的现象。<br> 现在我们面临困难：对边缘进行建模。为简单起见，我们将假设正态分布 。因此，我们估计边缘的参数。</p> 
<p>直方图显示如下：</p> 
<p style="margin-left:0px;"><img alt="" class="has" height="265" src="https://images2.imgbox.com/db/80/JhdAcAGr_o.png" width="461"><img alt="" class="has" height="274" src="https://images2.imgbox.com/6a/da/QXoXLzB9_o.png" width="453"></p> 
<p>现在我们在函数中应用copula，从生成的多变量分布中获取模拟观测值。最后，我们将模拟结果与原始数据进行比较。</p> 
<p>这是在假设正态分布边缘和相依结构的t-copula的情况下数据的最终散点图：</p> 
<p style="margin-left:0px;"></p> 
<p style="margin-left:0px;"><img alt="" class="has" height="329" src="https://images2.imgbox.com/ce/6f/xkKzvK5E_o.png" width="459"></p> 
<p>正如您所看到的，t-copula导致结果接近实际观察结果 。 </p> 
<p>让我们尝试<code>df=1</code>和<code>df=8：</code></p> 
<p>显然，该参数<code>df</code>对于确定分布的形状非常重要。随着<code>df</code>增加，t-copula倾向于正态分布copula。</p> 
<p style="margin-left:0px;"><img alt="" class="has" height="345" src="https://images2.imgbox.com/51/5b/wkQp8ioy_o.png" width="452"></p> 
<h3>非常感谢您阅读本文，有任何问题请在下面留言！</h3> 
<hr> 
<p><img alt="" height="226" src="https://images2.imgbox.com/b6/87/Atr6Iesc_o.jpg" width="362"></p> 
<p>参考文献</p> 
<p>1.<a href="http://tecdat.cn/%E7%94%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AF%86%E5%88%AB%E4%B8%8D%E6%96%AD%E5%8F%98%E5%8C%96%E7%9A%84%E8%82%A1%E5%B8%82%E7%8A%B6%E5%86%B5-%E9%9A%90%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB/" rel="nofollow" title="用机器学习识别不断变化的股市状况—隐马尔科夫模型(HMM)的应用">用机器学习识别不断变化的股市状况—隐马尔科夫模型(HMM)的应用</a></p> 
<p>2.<a href="http://tecdat.cn/r%E8%AF%AD%E8%A8%80garch-dcc%E6%A8%A1%E5%9E%8B%E5%92%8Cdcc%EF%BC%88mvt%EF%BC%89%E5%BB%BA%E6%A8%A1%E4%BC%B0%E8%AE%A1/" rel="nofollow" title="R语言GARCH-DCC模型和DCC（MVT）建模估计">R语言GARCH-DCC模型和DCC（MVT）建模估计</a></p> 
<p>3.<a href="http://tecdat.cn/r%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0-copula-%E7%AE%97%E6%B3%95%E5%BB%BA%E6%A8%A1%E4%BE%9D%E8%B5%96%E6%80%A7%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" rel="nofollow" title="R语言实现 Copula 算法建模相依性案例分析报告">R语言实现 Copula 算法建模相依性案例分析报告</a></p> 
<p>4.<a href="http://tecdat.cn/r%E8%AF%AD%E8%A8%80copulas%E5%92%8C%E9%87%91%E8%9E%8D%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E6%A1%88%E4%BE%8B/" rel="nofollow" title="R语言COPULAS和金融时间序列数据VaR分析">R语言COPULAS和金融时间序列数据VaR分析</a></p> 
<p>5.<a href="http://tecdat.cn/r%E8%AF%AD%E8%A8%80%E5%A4%9A%E5%85%83copula-garch-%E6%A8%A1%E5%9E%8B%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B/" rel="nofollow" title="R语言多元COPULA GARCH 模型时间序列预测">R语言多元COPULA GARCH 模型时间序列预测</a></p> 
<p>6.<a href="http://tecdat.cn/%E7%94%A8r%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E9%A2%84%E6%B5%8B%E8%82%A1%E7%A5%A8%E5%AE%9E%E4%BE%8B/" rel="nofollow" title="用R语言实现神经网络预测股票实例">用R语言实现神经网络预测股票实例</a></p> 
<p>7.<a href="http://tecdat.cn/r%E8%AF%AD%E8%A8%80%E9%A2%84%E6%B5%8B%E6%B3%A2%E5%8A%A8%E7%8E%87%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%9Aarch%E6%A8%A1%E5%9E%8B%E4%B8%8Ehar-rv%E6%A8%A1%E5%9E%8B/" rel="nofollow" title="r语言预测波动率的实现：ARCH模型与HAR-RV模型">r语言预测波动率的实现：ARCH模型与HAR-RV模型</a></p> 
<p>8.<a href="http://tecdat.cn/r%E8%AF%AD%E8%A8%80%E5%A6%82%E4%BD%95%E5%81%9A%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E8%BD%AC%E6%8D%A2%E6%A8%A1%E5%9E%8Bmarkov-switching-model/" rel="nofollow" title="R语言如何做马尔科夫转换模型markov switching model">R语言如何做马尔科夫转换模型markov switching model</a></p> 
<p>9.<a href="http://tecdat.cn/matlab%E4%BD%BF%E7%94%A8copula%E4%BB%BF%E7%9C%9F%E4%BC%98%E5%8C%96%E5%B8%82%E5%9C%BA%E9%A3%8E%E9%99%A9/" rel="nofollow" title="matlab使用Copula仿真优化市场风险">matlab使用Copula仿真优化市场风险</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8683519f4ed52def43e2f204e420eb6c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">查看pip及Python版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c0fa2bb6c87138fa4078a263614ce0d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">外包干了2个月，技术退步明显了...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>