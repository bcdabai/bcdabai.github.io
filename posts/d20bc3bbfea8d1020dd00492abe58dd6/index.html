<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言-判断线段是否与矩形范围有交集 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C语言-判断线段是否与矩形范围有交集" />
<meta property="og:description" content="原文地址:http://blog.csdn.net/hbuxiaoshe/article/details/5833094
判断线段AB是否与矩形范围有交集
这里的矩形指的是边与坐标轴平行的矩形，可用x和y上最大最小值表示。
判断是否相交，先快速排斥，再做跨立，通过向量的叉积判断矩形的四个顶点是否在线段的两侧，是说明有交集。
（如果判断与矩形的边是否有交集的话，可判断线段是否与矩形的每条边是否有交集，线段与线段的交集判断。）
这里在介绍另外一种方法，降维的方法：
例如，有线段AB和矩形MN，如图所示：
通过M和N点的y坐标计算直线AB上的D和C点，B和C点中取y值小的点B，A和D点中取y值大的点D，
最后确定了线段BD在x轴上的投影GH，矩形在x轴上的投影EF，判断EF和GH是否有交集。
C语言代码如下：
/* * 判断区间[x1, x2]和区间[x3, x4](x4可能小于x3)是否有交集，有返回1，无0 */ int IntervalOverlap(double x1, double x2, double x3, double x4) { double t; if (x3 &gt; x4) { t = x3; x3 = x4; x4 = t; } if (x3 &gt; x2 || x4 &lt; x1) return 0; else return 1; } /* * 判断矩形r和线段AB是否有交集，有返回1，无0 */ int RSIntersection(Rectangle r, Point A, Point B) { if (A." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d20bc3bbfea8d1020dd00492abe58dd6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-12-12T14:29:29+08:00" />
<meta property="article:modified_time" content="2014-12-12T14:29:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言-判断线段是否与矩形范围有交集</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 原文地址:http://blog.csdn.net/hbuxiaoshe/article/details/5833094</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> <strong>判断线段AB是否与矩形范围有交集</strong></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 这里的矩形指的是边与坐标轴平行的矩形，可用x和y上最大最小值表示。</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 判断是否相交，先快速排斥，再做跨立，通过向量的叉积判断矩形的四个顶点是否在线段的两侧，是说明有交集。</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> （如果判断与矩形的边是否有交集的话，可判断线段是否与矩形的每条边是否有交集，线段与线段的交集判断。）</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">  </p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 这里在介绍另外一种方法，降维的方法：</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 例如，有线段AB和矩形MN，如图所示：</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> <img src="https://images2.imgbox.com/86/0f/s8OecgXn_o.gif" alt="" style="border:none; max-width:100%"></p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 通过M和N点的y坐标计算直线AB上的D和C点，B和C点中取y值小的点B，A和D点中取y值大的点D，</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> 最后确定了线段BD在x轴上的投影GH，矩形在x轴上的投影EF，判断EF和GH是否有交集。</p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">  </p> 
<p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"> C语言代码如下：</p> 
<pre style="white-space:pre-wrap; word-wrap:break-word; color:rgb(51,51,51); font-size:14px; line-height:26px; background-color:rgb(255,255,255)"><span style="background-color:rgb(235,235,235)">/*
 * 判断区间[x1, x2]和区间[x3, x4](x4可能小于x3)是否有交集，有返回1，无0
 */
int <strong>IntervalOverlap</strong>(double x1, double x2, double x3, double x4)
{
	double t;
	if (x3 &gt; x4)
	{
		t = x3;
		x3 = x4;
		x4 = t;
	}
	
	if (x3 &gt; x2 || x4 &lt; x1)
		return 0;
	else
		return 1;
}

/*
 * 判断矩形r和线段AB是否有交集，有返回1，无0
 */
int <strong>RSIntersection</strong>(Rectangle r, Point A, Point B)
{
	if (A.y == B.y)	// 线段平行于x轴
	{
		if (A.y &lt;= r.ymax &amp;&amp; A.y &gt;= r.ymin)
		{
			return IntervalOverlap(r.xmin, r.xmax, A.x, B.x);
		}
		else
		{
			return 0;
		}
	}
	// AB两点交换，让B点的y坐标最大
	Point t;
	if (A.y &gt; B.y)
	{
		t = A;
		A = B;
		B = t;
	}
	
	// 在线段AB上确定点C和D
	// 两点确定一条直线: (x-x1)/(x2-x1)=(y-y1)/(y2-y1)
	double k = (B.x - A.x)/(B.y - A.y);
	Point C, D;
	if (A.y &lt; r.ymin)
	{
		C.y = r.ymin;
		C.x = k * (C.y - A.y) + A.x;
	}
	else
		C = A;
		
	if (B.y &gt; r.ymax)
	{
		D.y = r.ymax;
		D.x = k * (D.y - A.y) + A.x;
	}
	else
		D = B;
		
	if (D.y &gt;= C.y)	// y维上有交集
	{
		return IntervalOverlap(r.xmin, r.xmax, D.x, C.x);
	}
	else
	{
		return 0;
	}
}</span></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/af04d824154e8b78bf2c3869372a816f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IPSEC 中的AH,ESP,SPI用途</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/84fe2f448a80e8337e8e14f464142e89/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Invalid location of tag 解决办法分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>