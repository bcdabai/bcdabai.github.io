<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>三平面映射TriPlanar - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="三平面映射TriPlanar" />
<meta property="og:description" content="shader效果中存在“缝隙”：（最后的代码中已经注释的很清楚了）
出现缝隙的原因：因为UV坐标是不连续的，所以会有缝隙。。。（法线的T，B,是根据U和V生成的，所以用法线也会有裂缝，这里的法线和下面用作mask的用法是不一样的）
三平面映射的效果：图中的边界是有过渡和缓冲，如下图
基本展示：
世界空间XY平面效果：
世界空间XZ展示：
存在的问题（不可避免的问题）：！！！！！！！！！
宏观思路 ：
（1）
（2）法线遮罩效果 和 思路：
（3）
换成noise图看不出缝隙！！！！
Shader &#34;Unlit/TriPlanar_Code&#34; { Properties { _MainTex (&#34;Texture&#34;, 2D) = &#34;white&#34; {} _Tilling(&#34;Main Tilling&#34;,Vector) = (1,1,1,1) _Contrast(&#34;Contrast&#34;,Range(1,10)) = 5 } SubShader { Tags { &#34;RenderType&#34;=&#34;Opaque&#34; } LOD 100 Pass { CGPROGRAM #pragma vertex vert #pragma fragment frag #include &#34;UnityCG.cginc&#34; struct appdata { float4 vertex : POSITION; float2 uv : TEXCOORD0; float3 normal : NORMAL; }; struct v2f { float2 uv : TEXCOORD0;	float4 vertex : SV_POSITION; float3 worldPos : TEXCOORD01; float3 worldPivot : TEXCOORD02; float3 worldNormal : TEXCOORD03; }; sampler2D _MainTex; float4 _MainTex_ST; float4 _Tilling; float _Contrast; v2f vert (appdata v) { v2f o; o." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4da8fe6893bddb50c36a6a2cb5747dc0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-03T22:23:52+08:00" />
<meta property="article:modified_time" content="2021-07-03T22:23:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">三平面映射TriPlanar</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>shader效果中存在“缝隙”：（最后的代码中已经注释的很清楚了）<br> 出现缝隙的原因：因为UV坐标是不连续的，所以会有缝隙。。。（法线的T，B,是根据U和V生成的，所以用法线也会有裂缝，这里的法线和下面用作mask的用法是不一样的）<br> <img src="https://images2.imgbox.com/91/18/fiRJnDmB_o.png" alt="在这里插入图片描述"><br> 三平面映射的效果：图中的边界是有过渡和缓冲，如下图<br> <img src="https://images2.imgbox.com/57/1c/YYuNQtyc_o.png" alt="在这里插入图片描述"></p> 
<p>基本展示：<br> 世界空间XY平面效果：<br> <img src="https://images2.imgbox.com/40/9a/O8J9KeuN_o.png" alt="在这里插入图片描述">世界空间XZ展示：</p> 
<p><img src="https://images2.imgbox.com/c3/18/glf1k4rj_o.png" alt="在这里插入图片描述"></p> 
<p><em><strong>存在的问题（不可避免的问题）：！！！！！！！！！</strong></em></p> 
<p><img src="https://images2.imgbox.com/0d/47/pcgBSOE2_o.png" alt="在这里插入图片描述"></p> 
<p>宏观思路 ：<br> （1）</p> 
<p><img src="https://images2.imgbox.com/e8/a2/SnTFxELS_o.png" alt="三平面映射原理"><br> （2）法线遮罩效果 和 思路：</p> 
<p><img src="https://images2.imgbox.com/6b/5d/ae8VIs0H_o.png" alt="在这里插入图片描述"><br> （3）<br> <img src="https://images2.imgbox.com/c3/a4/GMOKuf3M_o.png" alt="在这里插入图片描述">换成noise图看不出缝隙！！！！<br> <img src="https://images2.imgbox.com/89/98/Zf1rdlzM_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-csharp">Shader <span class="token string">"Unlit/TriPlanar_Code"</span>
<span class="token punctuation">{<!-- --></span>
	Properties
	<span class="token punctuation">{<!-- --></span>
		_MainTex <span class="token punctuation">(</span><span class="token string">"Texture"</span><span class="token punctuation">,</span> <span class="token number">2</span>D<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"white"</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
		<span class="token function">_Tilling</span><span class="token punctuation">(</span><span class="token string">"Main Tilling"</span><span class="token punctuation">,</span>Vector<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token function">_Contrast</span><span class="token punctuation">(</span><span class="token string">"Contrast"</span><span class="token punctuation">,</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span>
	<span class="token punctuation">}</span>
	SubShader
	<span class="token punctuation">{<!-- --></span>
		Tags <span class="token punctuation">{<!-- --></span> <span class="token string">"RenderType"</span><span class="token operator">=</span><span class="token string">"Opaque"</span> <span class="token punctuation">}</span>
		<span class="token class-name">LOD</span> <span class="token number">100</span>

		Pass
		<span class="token punctuation">{<!-- --></span>
			CGPROGRAM
			<span class="token preprocessor property">#<span class="token directive keyword">pragma</span> vertex vert</span>
			<span class="token preprocessor property">#<span class="token directive keyword">pragma</span> fragment frag</span>
						
			<span class="token preprocessor property">#include </span><span class="token string">"UnityCG.cginc"</span>

			<span class="token keyword">struct</span> appdata
			<span class="token punctuation">{<!-- --></span>
				float4 vertex <span class="token punctuation">:</span> POSITION<span class="token punctuation">;</span>
				float2 uv <span class="token punctuation">:</span> TEXCOORD0<span class="token punctuation">;</span>
				float3 normal <span class="token punctuation">:</span> NORMAL<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>

			<span class="token keyword">struct</span> v2f
			<span class="token punctuation">{<!-- --></span>
				float2 uv <span class="token punctuation">:</span> TEXCOORD0<span class="token punctuation">;</span>	
				float4 vertex <span class="token punctuation">:</span> SV_POSITION<span class="token punctuation">;</span>
				float3 worldPos <span class="token punctuation">:</span> TEXCOORD01<span class="token punctuation">;</span>
				float3 worldPivot <span class="token punctuation">:</span> TEXCOORD02<span class="token punctuation">;</span>
				float3 worldNormal <span class="token punctuation">:</span> TEXCOORD03<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>

			sampler2D _MainTex<span class="token punctuation">;</span>
			float4 _MainTex_ST<span class="token punctuation">;</span>
			float4 _Tilling<span class="token punctuation">;</span>
			<span class="token keyword">float</span> _Contrast<span class="token punctuation">;</span>
			v2f vert <span class="token punctuation">(</span>appdata v<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				v2f o<span class="token punctuation">;</span>
				o<span class="token punctuation">.</span>vertex <span class="token operator">=</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
				o<span class="token punctuation">.</span>uv <span class="token operator">=</span> <span class="token function">TRANSFORM_TEX</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>uv<span class="token punctuation">,</span> _MainTex<span class="token punctuation">)</span><span class="token punctuation">;</span>
				o<span class="token punctuation">.</span>worldPos <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>unity_ObjectToWorld<span class="token punctuation">,</span> v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">.</span>xyz<span class="token punctuation">;</span>
				o<span class="token punctuation">.</span>worldPivot <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>unity_ObjectToWorld<span class="token punctuation">,</span> <span class="token function">float4</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>xyz<span class="token punctuation">;</span>
				o<span class="token punctuation">.</span>worldNormal <span class="token operator">=</span> <span class="token function">UnityObjectToWorldNormal</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>normal<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> o<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// 根据法线的 三个轴  ， 生成遮罩</span>
			float3 <span class="token function">NormalMask</span><span class="token punctuation">(</span>float3 wNormal<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				float3 tempNormal <span class="token operator">=</span>  <span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>wNormal<span class="token punctuation">)</span><span class="token punctuation">,</span>_Contrast<span class="token punctuation">)</span><span class="token punctuation">;</span>
				float3 mask <span class="token operator">=</span> tempNormal <span class="token operator">/</span><span class="token punctuation">(</span>tempNormal<span class="token punctuation">.</span>x <span class="token operator">+</span> tempNormal<span class="token punctuation">.</span>y <span class="token operator">+</span> tempNormal<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> mask<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			float4 <span class="token function">TriPlanar</span><span class="token punctuation">(</span>float3 maskValue<span class="token punctuation">,</span>float3 worldPos<span class="token punctuation">,</span>float3 worldPivot<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				float3 tempPos <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>worldPos <span class="token operator">-</span> worldPivot<span class="token punctuation">)</span> <span class="token operator">*</span> _Tilling<span class="token punctuation">.</span>xyz<span class="token punctuation">)</span><span class="token punctuation">.</span>xyz<span class="token punctuation">;</span>
				<span class="token comment">//  xy 平面的像素正常显示 但是  其他轴对应平面的值不正确，所以 乘以 maskValue.z，屏蔽掉其它轴面的值。</span>
				float4 colorZ <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span>tempPos<span class="token punctuation">.</span>xy<span class="token punctuation">)</span> <span class="token operator">*</span> maskValue<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
				float4 colorY <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span>tempPos<span class="token punctuation">.</span>xz<span class="token punctuation">)</span> <span class="token operator">*</span> maskValue<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
				float4 colorX <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span>tempPos<span class="token punctuation">.</span>yz<span class="token punctuation">)</span> <span class="token operator">*</span> maskValue<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
				<span class="token comment">//  三个轴面的正确结果相加  ，  归一化</span>
				<span class="token keyword">return</span> <span class="token function">normalize</span><span class="token punctuation">(</span>colorX <span class="token operator">+</span> colorY <span class="token operator">+</span> colorZ<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token punctuation">}</span>


			
			fixed4 frag <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_Target
			<span class="token punctuation">{<!-- --></span>
				float3 maskValue <span class="token operator">=</span> <span class="token function">NormalMask</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>worldNormal<span class="token punctuation">)</span><span class="token punctuation">;</span>
				float4 triColor <span class="token operator">=</span> <span class="token function">TriPlanar</span><span class="token punctuation">(</span>maskValue<span class="token punctuation">,</span>i<span class="token punctuation">.</span>worldPos<span class="token punctuation">,</span>i<span class="token punctuation">.</span>worldPivot<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> triColor<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			ENDCG
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><a href="https://blog.csdn.net/liu_if_else/article/details/73833656?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162530018916780255216855%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=162530018916780255216855&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-11-73833656.first_rank_v2_pc_rank_v29_1&amp;utm_term=%E4%B8%89%E5%B9%B3%E9%9D%A2%E6%98%A0%E5%B0%84&amp;spm=1018.2226.3001.4187">平面映射的延申</a></p> 
<p><a href="https://blog.csdn.net/ezcome11/article/details/117051470?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162532031716780261951378%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=162532031716780261951378&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-117051470.first_rank_v2_pc_rank_v29_1&amp;utm_term=%E4%B8%89%E5%B9%B3%E9%9D%A2%E6%98%A0%E5%B0%84&amp;spm=1018.2226.3001.4187">TriPlanar</a></p> 
<p><img src="https://images2.imgbox.com/4b/08/xkQ0iaED_o.gif" alt="在这里插入图片描述"><br> 通过 在3DMax中的 ”顶点色“ 来控制顶点的运动幅度。。。<br> 顶点动画在播放 但是 眼睛不要动， 骨头的根部不要动。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/83d31aa0209abed888deca52042c55eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2021-07-03</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5811522e0bf5aa490693d8924b8fb68e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计组——关于补码乘法的一点思考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>