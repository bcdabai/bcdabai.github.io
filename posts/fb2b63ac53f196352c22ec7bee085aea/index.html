<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>银联Iso8583报文  POS终端报文结构 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="银联Iso8583报文  POS终端报文结构" />
<meta property="og:description" content="终端则
(一) 基础知识
1byte = 8bit
1byte = 2个16进制数
BCD码：用4位二进制数来表示1位十进制数中的0~9这10个数码，即1bcd码=4bit
(二) 报文结构
报文长度
TPDU头
报文头
应用数据
2字节16进制表示的报文长度（不包括本身）
5字节
12字节
交易数据（不定长度）
TPDU头 = ID（60H） &#43; 目的地址（N4） &#43; 源地址（N4），长度为10字节，压缩时用BCD码表示为5个字节长度的数值。
报文头 = 应用类别定义（N2 ）&#43;软件总版本号（N2） &#43; 终端状态（N1） &#43; 处理要求 （N1）&#43; 软件分版本号（N6），总长度为12字节，压缩时用BCD码表示为6个字节长度的数值。
上面的参数值大家只需知道有这回事就行了，具体开发时参见开发文档对号入座
(三) 报文域属性和数据格式（以消费报文为例）
================================
[F002]type=[ LLVAR] len=[016]value=[6225561620345170]
[F003]type=[NUMERIC] len=[006] value=[280000]
[F004]type=[ AMOUNT] len=[012] value=[0.02]
[F011]type=[NUMERIC] len=[006] value=[7]
[F022]type=[NUMERIC] len=[003] value=[22]
[F025]type=[NUMERIC] len=[002] value=[82]
[F035]type=[ LLVAR] len=[037]value=[6225561620345170=17061010000015500000]
[F036]type=[ LLLVAR] len=[104] value=[996225561620345170=1561562915590002
170013300000010101017061=000000000000=00000=0000000622556155000004000]
[F037]type=[ ALPHA] len=[012]value=[110153000006]" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fb2b63ac53f196352c22ec7bee085aea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-29T12:54:36+08:00" />
<meta property="article:modified_time" content="2016-09-29T12:54:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">银联Iso8583报文  POS终端报文结构</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>终端则</p> 
<p><strong>(一)   基础知识</strong></p> 
<p>1byte = 8bit</p> 
<p>1byte = 2个16进制数</p> 
<p>BCD码：<span style="color:rgb(51,51,51)">用</span><span style="color:rgb(51,51,51)">4</span><span style="color:rgb(51,51,51)">位二进制数来表示</span><span style="color:rgb(51,51,51)">1</span><span style="color:rgb(51,51,51)">位</span><a target="_blank" href="http://baike.baidu.com/view/1502867.htm" rel="nofollow noopener noreferrer"><span style="color:rgb(19,110,194)">十进制数</span></a><span style="color:rgb(51,51,51)">中的</span><span style="color:rgb(51,51,51)">0~9</span><span style="color:rgb(51,51,51)">这</span><span style="color:rgb(51,51,51)">10</span><span style="color:rgb(51,51,51)">个数码，即</span><span style="color:rgb(51,51,51)">1bcd</span><span style="color:rgb(51,51,51)">码</span><span style="color:rgb(51,51,51)">=4bit</span></p> 
<p><strong>(二)   报文结构</strong></p> 
<table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>报文长度</p> </td><td> <p>TPDU头</p> </td><td> <p>报文头</p> </td><td> <p>应用数据</p> </td></tr><tr><td> <p>2字节16进制表示的报文长度（不包括本身）</p> </td><td> <p>5字节</p> </td><td> <p>12字节</p> </td><td> <p>交易数据（不定长度）</p> </td></tr></tbody></table> 
<p>TPDU头 =  ID（60H） + 目的地址（N4） + 源地址（N4），长度为10字节，压缩时用BCD码表示为5个字节长度的数值。</p> 
<p>报文头 = 应用类别定义（N2 ）+软件总版本号（N2） + 终端状态（N1） + 处理要求 （N1）+ 软件分版本号（N6），总长度为12字节，压缩时用BCD码表示为6个字节长度的数值。</p> 
<p><strong>上面的参数值大家只需知道有这回事就行了，具体开发时参见开发文档对号入座</strong></p> 
<p><strong>(三)   报文域属性和数据格式（以消费报文为例）</strong></p> 
<p>================================</p> 
<p> </p> 
<p>[F002]type=[  LLVAR] len=[016]value=[6225561620345170]</p> 
<p>[F003]type=[NUMERIC] len=[006] value=[280000]</p> 
<p>[F004]type=[ AMOUNT] len=[012] value=[0.02]</p> 
<p>[F011]type=[NUMERIC] len=[006] value=[7]</p> 
<p>[F022]type=[NUMERIC] len=[003] value=[22]</p> 
<p>[F025]type=[NUMERIC] len=[002] value=[82]</p> 
<p>[F035]type=[  LLVAR] len=[037]value=[6225561620345170=17061010000015500000]</p> 
<p>[F036]type=[ LLLVAR] len=[104] value=[996225561620345170=1561562915590002</p> 
<p>170013300000010101017061=000000000000=00000=0000000622556155000004000]</p> 
<p>[F037]type=[  ALPHA] len=[012]value=[110153000006]</p> 
<p>[F041]type=[  ALPHA] len=[008] value=[05740001]</p> 
<p>[F042]type=[  ALPHA] len=[015]value=[000000000000001]</p> 
<p>[F049]type=[  ALPHA] len=[003] value=[156]</p> 
<p>[F053]type=[NUMERIC] len=[016] value=[600000000000000]</p> 
<p>[F064]type=[ BINARY] len=[064] value=[A99E90F8B08FEE85]</p> 
<p> </p> 
<p>================================</p> 
<p>16进制报文：</p> 
<p><span style="background:darkcyan">0173</span><span style="background:yellow">6000030000</span><span style="background:fuchsia">603100311004</span><span style="background:darkgray">0200</span><a target="_blank" name="OLE_LINK8"></a><a target="_blank" name="OLE_LINK8"></a><a target="_blank" name="OLE_LINK7"></a><a target="_blank" name="OLE_LINK8"></a><a target="_blank" name="OLE_LINK7"></a><a target="_blank" name="OLE_LINK6"><span style="background:lime">7020048038C08801</span></a>166225561620345170280000000000000002000007022082376225561620345170D</p> 
<p>1706101000001550000000104996225561620345170D1561562915590002170013300000010101017061D000000000000D00000D00000006</p> 
<p>2255615500000400031313031353330303030303630353734303030313030303030303030303030303030313135360600000000000000</p> 
<p><span style="background:olive">A99E90F8B08FEE85</span></p> 
<p>青色背景：报文长度</p> 
<p>黄色背景：TUDU头</p> 
<p>红色背景：报文头</p> 
<p>灰色背景：消息类型</p> 
<p>绿色背景：bitmap位图，转成bit显示，</p> 
<p>0111000000100000000001001000000000111000110000001000100000000001</p> 
<p>“1”代表包含该位置的域</p> 
<p>“0”代表不包含该位置的域</p> 
<p>首位如果为0表示只有64bit，为1表示有128bit</p> 
<p> </p> 
<p>如下解析图：</p> 
<p><img src="https://images2.imgbox.com/69/e4/fwMAqRg9_o.png" alt="图图"></p> 
<p></p> 
<p><strong>(四)   密钥简介</strong></p> 
<p>略</p> 
<p><strong>(五)   PIN的加密与解密</strong></p> 
<p>略</p> 
<p><strong>(六)   MAC的加密</strong></p> 
<p>POS终端采用ECB的加密方式，简述如下：</p> 
<p>A)     将欲发送给POS中心的消息中，从消息类型（MIT）到63域之间的部分构成MAC ELEMENT BLOCK（MAB）。</p> 
<p>B)     使用ECB算法做加密，取前8个字节作为MAC值</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e25f2ce6ed6ca6a4f0e3b6dddda56f7f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序之组件学习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b7f6a5ce9e7137a6e13fc8de267d9aea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">QST青软实训学员学习总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>