<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android 闪图三种实现方式 动态闪 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android 闪图三种实现方式 动态闪" />
<meta property="og:description" content="闪图作用不用说了：广告啊 公司标识之类的 1、静态图片放大动画 1）在activity中先插入动画效果方法
//放大图片 public void animateImage() { //设置缩放动画 ObjectAnimator animatorX = ObjectAnimator.ofFloat(splash, &#34;scaleX&#34;, 1f, 1.5f); ObjectAnimator animatorY = ObjectAnimator.ofFloat(splash, &#34;scaleY&#34;, 1f, 1.5f); AnimatorSet animatorSet = new AnimatorSet(); animatorSet.setDuration(2000).play(animatorX).with(animatorY); animatorSet.start(); //动画完成监听 animatorSet.addListener(new AnimatorListenerAdapter() { @Override public void onAnimationEnd(Animator animation) { //动画完成后跳转首页 startActivity(new Intent(FlashActivity.this,MainActivity.class)); finish(); overridePendingTransition(android.R.anim.fade_in, android.R.anim.fade_out); } }); } 2）在activity中开启子线程，延迟调用
2、Glide加载动态GIF图片 1）先在build.gradle添加依赖
implementation &#39;com.github.bumptech.glide:glide:3.7.0&#39; 2）在activity中调用Glide方法加载，再延迟跳转
Glide.with(this).load(R.drawable.flash_gif).into(splash); 效果图：
3、VideoView加载asserts视频资源 1)先插入视频播放代码。
有小伙伴可能有疑惑，VideoView不是有进度条吗，只需要设置
mediaController.setVisibility(View.INVISIBLE);//隐藏播放进度条 //视频播放 private void playVideo(){ mVideoView = (VideoView)this.findViewById(R.id.vid_splash); //获得下载目录，不推荐使用，api29已弃用，返回的是公共下载目录，需要声明存储权限 //File directory_doc = Environment." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ea6b8278c6bc3f47b318230e4bf4ead6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-05T15:11:31+08:00" />
<meta property="article:modified_time" content="2022-12-05T15:11:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android 闪图三种实现方式 动态闪</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>闪图作用不用说了：广告啊 公司标识之类的</h3> 
<h3>1、静态图片放大动画</h3> 
<p>1）在activity中先插入动画效果方法</p> 
<pre><code class="language-java">//放大图片
    public void animateImage() {

        //设置缩放动画
        ObjectAnimator animatorX = ObjectAnimator.ofFloat(splash, "scaleX", 1f,
                1.5f);
        ObjectAnimator animatorY = ObjectAnimator.ofFloat(splash, "scaleY", 1f,
                1.5f);

        AnimatorSet animatorSet = new AnimatorSet();
        animatorSet.setDuration(2000).play(animatorX).with(animatorY);
        animatorSet.start();

        //动画完成监听
        animatorSet.addListener(new AnimatorListenerAdapter() {

            @Override
            public void onAnimationEnd(Animator animation) {

                //动画完成后跳转首页
                startActivity(new Intent(FlashActivity.this,MainActivity.class));
                finish();
                overridePendingTransition(android.R.anim.fade_in, android.R.anim.fade_out);
            }
        });
    }</code></pre> 
<p>2）在activity中开启子线程，延迟调用</p> 
<p><img alt="" height="513" src="https://images2.imgbox.com/2c/8f/r8pPBvIo_o.png" width="721"></p> 
<p></p> 
<p></p> 
<h3>2、Glide加载动态GIF图片</h3> 
<p>1）先在build.gradle添加依赖</p> 
<pre>implementation 'com.github.bumptech.glide:glide:3.7.0'</pre> 
<p>2）在activity中调用Glide方法加载，再延迟跳转</p> 
<pre>Glide.with(this).load(R.drawable.flash_gif).into(splash);</pre> 
<p><img alt="" height="646" src="https://images2.imgbox.com/c5/0d/evfwOnBG_o.png" width="886"></p> 
<p>效果图：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3e/12/lw2KmfcX_o.gif"></p> 
<p></p> 
<h3>3、VideoView加载asserts视频资源</h3> 
<p>1)先插入视频播放代码。</p> 
<p>有小伙伴可能有疑惑，VideoView不是有进度条吗，只需要设置</p> 
<pre>mediaController.setVisibility(View.INVISIBLE);//隐藏播放进度条</pre> 
<pre><code class="language-java">  //视频播放
    private void playVideo(){
        mVideoView = (VideoView)this.findViewById(R.id.vid_splash);
        //获得下载目录，不推荐使用，api29已弃用，返回的是公共下载目录，需要声明存储权限
        //File directory_doc = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS);
        //获得下载目录，返回的是应用下载目录
        String filePath=getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS).toString()+"/video";
        Log.d("播放地址",filePath);
        Deposit(filePath,"video_splash.mp4");
        String path=filePath+"/video_splash.mp4";
        Log.d("播放地址",path);
        mVideoView.setVideoPath(path);
        //创建MediaController对象
        MediaController mediaController = new MediaController(this);
        mediaController.setVisibility(View.INVISIBLE);//隐藏播放进度条
        //绑定mediaController
        mVideoView.setMediaController(mediaController);
        mVideoView.requestFocus();
        mVideoView.start();
    }</code></pre> 
<p>2）插入asserts资源写进应用目录代码</p> 
<p><img alt="" height="124" src="https://images2.imgbox.com/b8/43/IGZVdSCI_o.png" width="271">asserts要有视频资源</p> 
<p> 代码中视频文件名改为自己的</p> 
<pre><code class="language-java"> /**
     * byte数组的初始化，数组的长度为1024， 从你的代码看来表达的是每次从文件读取1024个字节。
     * 8bit(位)是1byte(字节)
     * 1024byte(字节)是1kb
     * byte[] bytes = new byte[1024]是1kb
     * */
    //将assets内文件存储到本地下载目录
    public Boolean Deposit(String path,String fileName){
        InputStream inputStream;
        try {
            //判断文件是否存在
            File file1=new File(path + "/" + fileName);

            if(!file1.exists()){
                inputStream=getAssets().open(fileName);
                File file = new File(path);
                //当目录不存在时创建目录
                if(!file.exists()){
                    file.mkdirs();
                }
                FileOutputStream fileOutputStream = new FileOutputStream(path + "/" + fileName);// 构建FileOutputStream对象,文件不存在会自动新建
                byte[] buffer = new byte[1024];//每次从文件读取1024个字节。
                int count = 0;
                while ((count = inputStream.read(buffer)) &gt; 0) {
                    fileOutputStream.write(buffer, 0, count);//write(byte[] b, int off, int len) 将byte数组中的 索引位置在off到len之间的数据  写出到流通道
                }
                fileOutputStream.flush();
                fileOutputStream.close();
                inputStream.close();

            }else {
                Log.d("adam:","视频资源已存在");
            }
            return true;

        }catch (IOException e){
            e.printStackTrace();
        }
        return false;
    }</code></pre> 
<p>3）activity中调用。</p> 
<p><img alt="" height="726" src="https://images2.imgbox.com/b7/a8/8B3jEE9H_o.png" width="946"></p> 
<p>效果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b5/62/cEnr0jZc_o.gif"></p> 
<p><strong> 细心的小伙伴可能发现效果图都是灰色的，因为最近某伟人去世了，各大app都灰朦朦的，这里浅试了下。</strong></p> 
<p><strong>采用的方式是View的硬件加速方案，view.setLayerType(layerType,null),第二个参数刚好是Paint</strong></p> 
<p>实现代码：</p> 
<pre><code class="language-java">/**
 * 硬件加速方案,设置黑灰
 * view.setLayerType(layerType, null);
 * 第二个参数是Paint
 * Activity 可以拿到 decorView,一般在BaseActivity中的onCreate()方法里调用即可
 * getWindow().getDecorView()即可拿到decorView
 * */
public class GrayManager {

    private static GrayManager sInstance;
    private Paint mGrayPaint;
    private ColorMatrix mGrayMatrix;

    public static GrayManager getInstance() {
        if (sInstance == null) {
            synchronized (GrayManager.class) {
                if (sInstance == null) {
                    sInstance = new GrayManager();
                }
            }
        }
        return sInstance;
    }

    //初始化
    public void init() {
        mGrayMatrix = new ColorMatrix();
        mGrayPaint = new Paint();
        mGrayMatrix.setSaturation(0);
        mGrayPaint.setColorFilter(new ColorMatrixColorFilter(mGrayMatrix));
    }

    //硬件加速置灰方法
    public void setLayerGrayType(View view) {
        if (mGrayMatrix == null || mGrayPaint == null) {
            init();
        }
        view.setLayerType(View.LAYER_TYPE_HARDWARE, mGrayPaint);
    }
}</code></pre> 
<p>1）一般在BaseActivity里的onCreate()方法调用即可，其它activity再继承于BaseActivity。你该不会没有吧<img alt="" height="314" src="https://images2.imgbox.com/25/25/LPvDG9A9_o.png" width="1084"></p> 
<p> 2）除非你没有，也可以在Application中的ActivityLifecycleCallbacks 实现监听。</p> 
<p> 首先实现这个接口Application.ActivityLifecycleCallbacks对activity生命周期进行监听，在下面方法调用硬件加速方法</p> 
<p><img alt="" height="55" src="https://images2.imgbox.com/bc/f4/MyAz2PnO_o.png" width="668"></p> 
<p> 然后在application初始化的時候注冊监听</p> 
<p><img alt="" height="24" src="https://images2.imgbox.com/ed/e1/J54W4RuP_o.png" width="617"></p> 
<p>效果如下：</p> 
<p><img alt="" height="810" src="https://images2.imgbox.com/15/a1/dNkGsPU4_o.gif" width="456"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42cae71f68d84c03161419fb3b268f53/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C语言】求素数的三种方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2aa893930d6a8b3c21f2d4257b803ba5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">域名查ip方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>