<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JavaScript 格式化数字、金额、千分位、保留几位小数、舍入舍去… - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JavaScript 格式化数字、金额、千分位、保留几位小数、舍入舍去…" />
<meta property="og:description" content="前端开发中经常会碰到用 JavaScript 格式化数字，最最常见的是格式化金额，一般格式化金额需要千分位分隔，保留2位小数等等。
简单的功能函数 类似的代码网上有很多：
JavaScript 代码:
/*** 将数值四舍五入(保留2位小数)后格式化成金额形式** @param num 数值(Number或者String)* @return 金额格式的字符串,如&#39;1,234,567.45&#39;* @type String*/function formatCurrency(num) {num = num.toString().replace(/\$|\,/g,&#39;&#39;);if(isNaN(num))num = &#34;0&#34;;sign = (num == (num = Math.abs(num)));num = Math.floor(num*100&#43;0.50000000001);cents = num%100;num = Math.floor(num/100).toString();if(cents&lt;10)cents = &#34;0&#34; &#43; cents;for (var i = 0; i &lt; Math.floor((num.length-(1&#43;i))/3); i&#43;&#43;)num = num.substring(0,num.length-(4*i&#43;3))&#43;&#39;,&#39;&#43;num.substring(num.length-(4*i&#43;3));return (((sign)?&#39;&#39;:&#39;-&#39;) &#43; num &#43; &#39;.&#39; &#43; cents);} 或者
JavaScript 代码:
function fmoney(s, n) {/** 参数说明：* s：要格式化的数字* n：保留几位小数* */n = n &gt; 0 &amp;&amp; n &lt;= 20 ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b6fe16361e81e7ce48191ed507f6b2ef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-06-13T14:31:00+08:00" />
<meta property="article:modified_time" content="2018-06-13T14:31:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JavaScript 格式化数字、金额、千分位、保留几位小数、舍入舍去…</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="content" id="articleContent"> 
 <p>前端开发中经常会碰到用 JavaScript 格式化数字，最最常见的是格式化金额，一般格式化金额需要千分位分隔，保留2位小数等等。</p> 
 <span id="OSC_h3_1"></span> 
 <h4>简单的功能函数</h4> 
 <p>类似的代码网上有很多：</p> 
 <pre> </pre> 
 <p>JavaScript 代码:</p> 
 <ol><li>/**</li><li>* 将数值四舍五入(保留2位小数)后格式化成金额形式</li><li>*</li><li>* <a href="https://my.oschina.net/u/2303379" rel="nofollow" class="referer">@param</a> num 数值(Number或者String)</li><li>* <a href="https://my.oschina.net/u/556800" rel="nofollow" class="referer">@return</a> 金额格式的字符串,如'1,234,567.45'</li><li>* <a href="https://my.oschina.net/fanren1919" rel="nofollow" class="referer">@type</a> String</li><li>*/</li><li>function formatCurrency(num) {<!-- --></li><li>num = num.toString().replace(/\$|\,/g,'');</li><li>if(isNaN(num))</li><li>num = "0";</li><li>sign = (num == (num = Math.abs(num)));</li><li>num = Math.floor(num*100+0.50000000001);</li><li>cents = num%100;</li><li>num = Math.floor(num/100).toString();</li><li>if(cents&lt;10)</li><li>cents = "0" + cents;</li><li>for (var i = 0; i &lt; Math.floor((num.length-(1+i))/3); i++)</li><li>num = num.substring(0,num.length-(4*i+3))+','+</li><li>num.substring(num.length-(4*i+3));</li><li>return (((sign)?'':'-') + num + '.' + cents);</li><li>}</li></ol> 
 <p>或者</p> 
 <pre> </pre> 
 <p>JavaScript 代码:</p> 
 <ol><li>function fmoney(s, n) {<!-- --></li><li>/*</li><li>* 参数说明：</li><li>* s：要格式化的数字</li><li>* n：保留几位小数</li><li>* */</li><li>n = n &gt; 0 &amp;&amp; n &lt;= 20 ? n : 2;</li><li>s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + "";</li><li>var l = s.split(".")[0].split("").reverse(),</li><li>r = s.split(".")[1];</li><li>t = "";</li><li>for (i = 0; i &lt; l.length; i++) {<!-- --></li><li>t += l[i] + ((i + 1) % 3 == 0 &amp;&amp; (i + 1) != l.length ? "," : "");</li><li>}</li><li>return t.split("").reverse().join("") + "." + r;</li><li>}</li><li>//调用</li><li>fmoney(9.7,2);//9.70</li><li>fmoney('12345.675910', 3);//12,345.676</li></ol> 
 <span id="OSC_h2_2"></span> 
 <h3>更加完善的功能函数</h3> 
 <p>这些代码基本能很好的运行。不过关系到经济利益的时候，还要考虑舍去或者舍入几厘。大家懂的，每个用户几厘钱可能带来巨大的经济收益。就比如说收手续费，如果一笔手续费计算出来是 <code>3.4521</code>元，精确到分一般都会收 <code>3.46</code> 元。当然如果是付出去，那可能就是直接舍去了，一般会计算为 <code>3.45</code> 元。</p> 
 <p>以前收集过类似方法，<a href="http://www.css88.com/archives/5307" rel="nofollow">http://www.css88.com/archives/5307</a>，不过在使用的时候会有BUG，JS 浮点型计算的精度问题。所以抽时间修复了一下：</p> 
 <pre> </pre> 
 <p>JavaScript 代码:</p> 
 <ol><li>function number_format(number, decimals, dec_point, thousands_sep,roundtag) {<!-- --></li><li>/*</li><li>* 参数说明：</li><li>* number：要格式化的数字</li><li>* decimals：保留几位小数</li><li>* dec_point：小数点符号</li><li>* thousands_sep：千分位符号</li><li>* roundtag:舍入参数，默认 "ceil" 向上取,"floor"向下取,"round" 四舍五入</li><li>* */</li><li>number = (number + '').replace(/[^0-9+-Ee.]/g, '');</li><li>roundtag = roundtag || "ceil"; //"ceil","floor","round"</li><li>var n = !isFinite(+number) ? 0 : +number,</li><li>prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),</li><li>sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,</li><li>dec = (typeof dec_point === 'undefined') ? '.' : dec_point,</li><li>s = '',</li><li>toFixedFix = function (n, prec) {<!-- --></li><li> </li><li>var k = Math.pow(10, prec);</li><li>console.log();</li><li> </li><li>return '' + parseFloat(Math[roundtag](parseFloat((n * k).toFixed(prec*2))).toFixed(prec*2)) / k;</li><li>};</li><li>s = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');</li><li>var re = /(-?\d+)(\d{3})/;</li><li>while (re.test(s[0])) {<!-- --></li><li>s[0] = s[0].replace(re, "$1" + sep + "$2");</li><li>}</li><li> </li><li>if ((s[1] || '').length &lt; prec) {<!-- --></li><li>s[1] = s[1] || '';</li><li>s[1] += new Array(prec - s[1].length + 1).join('0');</li><li>}</li><li>return s.join(dec);</li><li>}</li><li>console.log(number_format(2, 2, ".", ","))//"2.00"</li><li>console.log(number_format(3.7, 2, ".", ","))//"3.70"</li><li>console.log(number_format(3, 0, ".", ",")) //"3"</li><li>console.log(number_format(9.0312, 2, ".", ","))//"9.03"</li><li>console.log(number_format(9.00, 2, ".", ","))//"9.00"</li><li>console.log(number_format(39.715001, 2, ".", ",", "floor")) //"39.71"</li><li>console.log(number_format(9.7, 2, ".", ","))//"9.70"</li><li>console.log(number_format(39.7, 2, ".", ","))//"39.70"</li><li>console.log(number_format(9.70001, 2, ".", ","))//"9.71"</li><li>console.log(number_format(39.70001, 2, ".", ","))//"39.71"</li><li>console.log(number_format(9996.03, 2, ".", ","))//"9996.03"</li><li>console.log(number_format(1.797, 3, ".", ",", "floor"))//"1.797"</li></ol> 
 <p>参数有点多，你可以根据你自己的需求去修改。</p> 
 <span id="OSC_h3_3"></span> 
 <h4>推荐的类库 Numeral.js 和 accounting.js</h4> 
 <span id="OSC_h4_4"></span> 
 <h5>Numeral.js</h5> 
 <p>一个用于格式化和操作数字的JavaScript库。数字可以被格式化为货币，百分比，时间，几个小数位数，千分位等等。 您也可以随时创建自定义格式。</p> 
 <p>官网及文档：<a href="http://numeraljs.com/" rel="nofollow">http://numeraljs.com/</a></p> 
 <p>GitHub：<a href="https://github.com/adamwdraper/Numeral-js">https://github.com/adamwdraper/Numeral-js</a></p> 
 <span id="OSC_h4_5"></span> 
 <h5>accounting.js</h5> 
 <p>一个轻量级的JavaScript库，用于格式化数字，金额和货币等。</p> 
 <p>官网及文档：<a href="http://openexchangerates.github.io/accounting.js/" rel="nofollow">http://openexchangerates.github.io/accounting.js/</a></p> 
 <p>GitHub：<a href="https://github.com/openexchangerates/accounting.js">accounting.js</a></p> 
 <p> </p> 
</div> 
<p>转载于:https://my.oschina.net/u/1431982/blog/1829528</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cdf3d115fc96992fb58045e8b4135996/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">com.sun.mail.util.MailConnectException: Couldn&#39;t connect to host异常解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2073fe82ec657d625d8e98f47096e5db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">unity中实现城市夜晚汽车流水的效果</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>