<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>华为华三思科路由器连接交换机的几种方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="华为华三思科路由器连接交换机的几种方法" />
<meta property="og:description" content="路由器一般连接不同网段，隔离广播域，交换机用来扩展主机，可以隔离冲突域；
路由器和交换机连接有以下几种方法：
路由器和交换机连接方法一般为以下三种： 1.交换机划分VLAN，并通过VLAN虚接口配置地址，将路由器与交换机互联的接口划分到相应的VLAN下，此时链路类型trunk和access都可以，路由器直接在三层接口下配地址；
2.路由器和交换机分别划分VLAN后通过VLAN虚接口配置地址，然后在路由器和交换机上将互联的接口划分到相应的VLAN下；
3.路由器划分子接口，并封装802.1协议，交换机和路由器链路类型为trunk；
以下是在华为华三思科模拟器上做实验的结果： 华为设备配置命令： 拓扑图：
方法1.路由器：
interface Ethernet0/0/0
ip address 10.10.23.2 255.255.255.0
交换机：
interface Vlanif10
ip address 10.10.23.3 255.255.255.0
interface GigabitEthernet0/0/1
port link-type access
port default vlan 10
方法2.路由器：
interface Vlanif10
ip address 10.10.25.2 255.255.255.0
interface Ethernet0/0/1
portswitch （三层接口与二层接口转换）
port link-type access
port default vlan 10
交换机：
interface Vlanif20
ip address 10.10.25.5 255.255.255.0
interface GigabitEthernet0/0/1
port link-type access
port default vlan 20
方法3：路由器：
interface GigabitEthernet0/0/0.30" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5a1066ca57bbeb4216bc794f46e47d1e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-29T11:11:28+08:00" />
<meta property="article:modified_time" content="2020-03-29T11:11:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">华为华三思科路由器连接交换机的几种方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>路由器一般连接不同网段，隔离广播域，交换机用来扩展主机，可以隔离冲突域；</p> 
<p>路由器和交换机连接有以下几种方法：</p> 
<h2 style="margin-left:0cm;"><span style="color:#000000;">路由器和交换机连接方法一般为以下三种：</span></h2> 
<p style="margin-left:0cm;"><span style="color:#000000;">1.</span><span style="color:#000000;">交换机划分VLAN，并通过VLAN虚接口配置地址，将路由器与交换机互联的接口划分到相应的VLAN下，此时链路类型trunk和access都可以，路由器直接在三层接口下配地址；</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">2.</span><span style="color:#000000;">路由器和交换机分别划分VLAN后通过VLAN虚接口配置地址，然后在路由器和交换机上将互联的接口划分到相应的VLAN下；</span></p> 
<p><span style="color:#000000;">3.</span><span style="color:#000000;">路由器划分子接口，并封装802.1协议，交换机和路由器链路类型为</span><span style="color:#FF0000;">trunk</span><span style="color:#000000;">；</span></p> 
<h2><strong><span style="color:#000000;">以下是在华为华三思科模拟器上做实验的结果：</span></strong></h2> 
<h4 style="margin-left:0cm;"><strong><span style="color:#000000;">华为设备配置命令：</span></strong></h4> 
<p style="margin-left:0cm;"><span style="color:#000000;">拓扑图：</span></p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;"><img alt="" height="494" src="https://images2.imgbox.com/85/4d/DRWaHTfb_o.png" width="744"></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法1.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Ethernet0/0/0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.23.2 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlanif10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.23.3 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet0/0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-type access</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port default vlan 10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法2.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlanif10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.25.2 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Ethernet0/0/1</span></p> 
<p style="margin-left:0cm;">   <span style="color:#FF0000;">portswitch                  </span><span style="color:#FF0000;">（三层接口与二层接口转换）</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-type access</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port default vlan 10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlanif20</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.25.5 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet0/0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-type access</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;"> port default vlan 20</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法3：路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet0/0/0.30</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   <u>dot1q termination vid 30</u></span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.24.2 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlanif30</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.24.4 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Ethernet0/0/1</span></p> 
<p style="margin-left:0cm;">   <span style="color:#FF0000;">port link-type trunk              </span><span style="color:#FF0000;">（利用子接口连接，链路类型必须为trunk）</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port trunk allow-pass vlan 30</span></p> 
<h4 style="margin-left:0cm;"><strong><span style="color:#000000;">华三设备配置命令：</span></strong></h4> 
<p style="margin-left:0cm;"><span style="color:#000000;">拓扑图：</span></p> 
<p style="margin-left:0cm;"><img alt="" height="410" src="https://images2.imgbox.com/2c/04/yV8xH5XW_o.png" width="693"></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法1.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet0/2</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-mode route</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.14.1 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet1/0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-mode route                </span><span style="color:#f33b45;">（华三支持直接将二层口转为三层口）</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">ip address 10.10.14.4 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法2.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlan-interface10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.10.1 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet0/0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-mode bridge</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port access vlan 10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：interface Vlan-interface10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.10.2 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet1/0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-mode bridge</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port access vlan 10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法3.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet0/1.20</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.13.1 255.255.255.0</span></p> 
<p style="margin-left:0cm;">   <span style="color:#FF0000;">vlan-type dot1q vid 20            </span><span style="color:#FF0000;">（华为华三思科三者封装命令有区别）</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlan-interface20</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.13.3 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface GigabitEthernet1/0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-mode bridge</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port link-type trunk</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   port trunk permit vlan 1 20</span></p> 
<h4 style="margin-left:0cm;"><strong><span style="color:#000000;">思科设备配置命令：</span></strong></h4> 
<p style="margin-left:0cm;"><span style="color:#000000;">拓扑图：</span></p> 
<p style="margin-left:0cm;"><img alt="" height="186" src="https://images2.imgbox.com/5d/85/JnWS54g0_o.png" width="537"></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法1.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface FastEthernet0/0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.12.1 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface Vlan10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.12.2 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface FastEthernet0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   switchport access vlan 10</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">方法2.路由器：</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface FastEthernet0/1.20</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   <u>encapsulation dot1Q 20</u>            </span><span style="color:#f33b45;">（先封装后加地址，否则有可能无法添加地址）</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.13.1 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">交换机：interface Vlan20</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   ip address 10.10.13.3 255.255.255.0</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">interface FastEthernet0/1</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">   switchport trunk allowed vlan 20</span></p> 
<p><span style="color:#000000;">   switchport mode trunk</span></p> 
<p> </p> 
<h3><strong>总结：</strong></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">路由器与交换机连接一般都可以用这几种办法来配置，比较常用的就是利用802.1q协议来封装，此时需要注意的就是链路类型为trunk模式，当路由器利用VLAN来连接时，需要将端口类型转换为二层接口，</span><strong><span style="color:#f33b45;">但是对于一些路由器型号来说不支持三层与二层互相转换</span></strong><span style="color:#000000;">，对于思科设备来说，在接口下加地址时，记得每次都要将端口开启，思科默认为关闭模式。</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/686b192eac2844d87b892693c481e53d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">信贷系统架构概要</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c2097067943d5ed952600070835406ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java详细学习路线及路线图</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>