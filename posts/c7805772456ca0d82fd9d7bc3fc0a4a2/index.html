<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zoj 2672 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zoj 2672" />
<meta property="og:description" content="zoj 2672
#include &lt;stdio.h&gt; #include &lt;string.h&gt; #define MAXN 3010 #define Inf 10000 #define Prime 24971 #define HashSize ( 1 &lt;&lt; 20 ) using namespace std; typedef short int Integer; int N , Num [MAXN] , Ans [MAXN] , Len , Left [MAXN]; Integer MaxLong [MAXN] [MAXN] , * S [MAXN]; struct TNode { int Key , Next; Integer Long; }; int Hash [HashSize]; TNode Node [MAXN]; bool init (); void solve (); void print (); Integer * find ( int ); Integer * Insert ( int ); main () { bool first = true; while ( init () ) { if ( first ) first = false; else printf ( &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c7805772456ca0d82fd9d7bc3fc0a4a2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-07-21T12:50:49+08:00" />
<meta property="article:modified_time" content="2012-07-21T12:50:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zoj 2672</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <a href="zoj" rel="nofollow"></a> 
<p><a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemId=1672" rel="nofollow">zoj 2672</a></p> 
<p><br> <a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemId=1672" rel="nofollow"></a></p> 
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#define MAXN 3010
#define Inf  10000
#define Prime  24971
#define HashSize ( 1 &lt;&lt; 20 )
using namespace std;

typedef short int  Integer;


int     N , Num [MAXN] , Ans [MAXN] , Len , Left [MAXN];
Integer MaxLong [MAXN] [MAXN] , * S [MAXN];

struct  TNode {
        int   Key , Next;
        Integer Long;
};

int     Hash [HashSize];
TNode   Node [MAXN];

bool    init ();
void    solve ();
void    print ();
Integer *   find ( int );
Integer *   Insert ( int );

main ()
{
     bool    first = true;
     while ( init () ) {
           if ( first ) first = false; else printf ( "\n" );
           solve ();
           print ();
     }
}

Integer * Insert ( int K )
{
        int p = K &amp; ( HashSize - 1 ) , q;
        for ( q = Hash [p]; q != -1; q = Node [q].Next ) if ( Node [q].Key == K ) return &amp; Node [q].Long;
        Node [Len].Key = K , Node [Len].Next = Hash [p] , Hash [p] = Len ++;
        return &amp; Node [Len - 1].Long;
}

Integer * find ( int K )
{
        int p = K &amp; ( HashSize - 1 ) , q;
        for ( q = Hash [p]; q != -1; q = Node [q].Next ) if ( Node [q].Key == K ) return &amp; Node [q].Long;
        return NULL;
}

void solve ()
{
     if ( N &lt; 3 ) return;

     int  i , j;
     Integer * p;
     Len = 0;
     memset ( Hash , 0xff , sizeof ( Hash ));

     for ( i = 0; i &lt; N; i ++ ) {
         for ( j = i - 1; j &gt;= 0; j -- ) if ( Num [i] == Num [j] ) break;
         Left [i] = j;
     }
     for ( i = 0; i &lt; N; i ++ ) for ( j = i + 1; j &lt; N; j ++ ) MaxLong [i] [j] = 2;

     for ( i = 0; i + 1 &lt; N; i ++ ) {
         for ( j = 0; j + 1 &lt; i; j ++ ) *S [j] = 0;
         if ( i ) S [i - 1] = Insert ( Num [i - 1] ) , * S [i - 1] = 0;
         for ( j = 0; j &lt; i; j ++ )
             if ( MaxLong [j] [i] &gt; *S [j] ) *S [j] = MaxLong [j] [i];

         for ( j = i + 1; j &lt; N; j ++ ) {
             if ( Num [i] &amp;&amp; Left [j] &gt; i ) continue;
             p = find ( Num [j] - Num [i] );
             MaxLong [i] [j] = ( p == NULL ? 2 : *p + 1 );
         }
     }
}

bool init ()
{
     if ( scanf ( "%d" , &amp;N ) == EOF ) return false;
     for ( int i = 0; i &lt; N; i ++ ) scanf ( "%d" , &amp;Num [i] );
     return true;
}

void print ()
{
     if ( N &lt; 3 ) {
          printf ( "%d\n" , N );
          for ( int i = 0; i &lt; N; i ++ ) {
              if ( i ) printf ( " " );
              printf ( "%d" , Num [i] );
          }
          return;
     }
     int  a = 0 , b = 1 , l;
     for ( int i = 0; i &lt; N; i ++ )
         for ( int j = i + 1; j &lt; N; j ++ ) if ( MaxLong [i] [j] &gt; MaxLong [a] [b] ) a = i , b = j;

     l = MaxLong [a] [b];

     printf ( "%d\n" , l );
     Ans [l - 1] = Num [b] , Ans [l - 2] = Num [a];
     for ( int i = l - 3; i &gt;= 0; i -- ) Ans [i] = Ans [i + 2] - Ans [i + 1];
     for ( int i = 0; i &lt; l; i ++ ) {
         if ( i ) printf ( " " );
         printf ( "%d" , Ans [i] );
     }
     printf ( "\n" );
}
/*
24
1 2 3 5 -1 2 1 3 4 7 11 0 11 11 22 7 29 36 65 0 1 2 3 4
18
-1 0 -1 1 -1 1 -1 2 8 3 13 5 21 8 0 13 9 21
*/
</code></pre> 
<br> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ffc739e20d24dc4cc3b303055b4a70e7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">poj  1043</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/934980996b753b42642d93b8207072ec/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第四章　WINDOWS绘图程序设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>