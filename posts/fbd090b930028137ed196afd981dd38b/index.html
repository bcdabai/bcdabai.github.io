<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用MATLAB实现求椭球上任意两点的最短弧长 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用MATLAB实现求椭球上任意两点的最短弧长" />
<meta property="og:description" content="基于法向矢量导向的求椭球上两点的最短弧长 问题分析 求椭球上任意两点间的最短弧长用数学来推算解析解的话十分复杂，因此考虑通过使用计算机来近似求解。问题的难点在于怎样让每一步都是处在最优的状态，以及怎样使每一步的方向都尽量处在该点能够选择的最优方向上。
求椭球上两点的最短路，很容易想到用传统的最短路算法如迪杰斯特拉算法或弗洛伊德算法求解，但是在椭球将步长离散化后，构造以及运用邻接矩阵十分复杂，在保证一定精度的条件下需要极大的运算量，所以最短路算法暂时没有太好的应用条件。
另一种考虑过的思路为采用经典优化算法，如粒子群算法或者蚁群算法等进行迭代求解。这种方法理论上是可行的，但是由于构造出椭球面的离散化极坐标坐标点相当多，以及这类算法本身有较大的运算量以及结果的随机性，暂时不予以考虑。
还曾考虑过用梯度下降算法来求解，就是将椭球旋转至使目标点的法向量为沿z轴负方向时构造出此时的椭球的函数表达式，即可使用梯度下降算法。这种方法是最为理想的方法，但是椭球的旋转涉及到仿射变换，构造变换矩阵非常复杂，所以暂时不予考虑。
根据梯度下降算法，可以很自然的想到既然椭球不转那我们能不能直接利用目标点的外法向量作为一个基准方向来进行导向。由次我们就想出了基于法向矢量导向的椭球上最短路求解。
模型假设 （1） 假设椭球上的网格足够小，运动点在椭球上的运动方向近似为椭球表面的切线方向
（2） 运动点到达距离终点的欧式距离小于一定范围时就视为到达终点
（3） 椭球上的运动点每次移动的欧式距离近似等于在表面移动时的弧长
（4） 椭球上的运动点的每次移动都会选择最优的方向
模型建立与算法设计 步骤操作1给定起点A和终点B的椭球极坐标，计算其直角坐标，并计算B的外法向量记为BW2计算A点在二维极坐标中以A为中心的一定宽度方格内的点Mi的极坐标3计算所有Mi的直角坐标，并且计算出向量AMi，并将其全部化为单位向量4计算BW*AMi的值，并找出使该值最小的Mi点作为下一个A点，重复步骤1 变量与符号说明 A……………………………………………….代指椭球表面的运动点的当前位置
B………………………………………………………………………………….终点
AM i _{i} i​……………………….椭球运动点在某次运动中可选择的单位方向向量集合
BW…………………………………………………椭球终点的垂直于表面的法向量
d i _{i} i​ ………………………………………………………每次运动点移动的欧式距离
ϵ \epsilon ϵ ………………………………………………………………………….终点判断值
D…………………………………………………………………………总路径的长度
模型建立与算法设计 当A要向B靠近时，求使AMi的单位方向向量与BW乘积最大的AMi作为从当前运动点指向下一个运动点的向量。对于共线的向量AMi的情况 ，取AMi长度较小的一方指向的点作为下一个A点，这样可以通过减小步长来适当降低误差。
注意注意，这里的A点周围的单位向量其实并不在一个平面内，因为我们找的是椭球上A相邻极坐标的点，所以只是椭球上从一个点出发到周围多个点的连线，我们只是用这些连线形成的向量来帮我们判断下一步的方向以及下一步所到的点。
1 给定起点和终点B的椭球极坐标，，A初始值设为起点坐标，计算其直角坐标，并计算B的外法向量记为BW
2 计算A点在二维极坐标中以A为中心的一定宽度方格内的点Mi的极坐标
3 计算所有Mi的直角坐标，并且计算出向量AMi，并将其全部化为单位向量
4 计算BW*AMi的值，并找出使该值最大的Mi点作为下一个A点
5 计算当前A点与B的欧式距离，若该距离小于 ϵ \epsilon ϵ ，则停止循环，输出D
6 计算下一个点A于当前点A之间的欧式距离d i _{i} i​，D=D&#43;d i _{i} i​
代码实现 椭球坐标转化为直角坐标函数：
function [x,y,z]=elip2cart(theta,alpha) a=6000; b=5000; x=a.*sin(theta).*sin(alpha); y=a." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fbd090b930028137ed196afd981dd38b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-06T21:06:22+08:00" />
<meta property="article:modified_time" content="2022-05-06T21:06:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用MATLAB实现求椭球上任意两点的最短弧长</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>基于法向矢量导向的求椭球上两点的最短弧长</h2> 
<h3><a id="_1"></a>问题分析</h3> 
<p>求椭球上任意两点间的最短弧长用数学来推算解析解的话十分复杂，因此考虑通过使用计算机来近似求解。问题的难点在于怎样让每一步都是处在最优的状态，以及怎样使每一步的方向都尽量处在该点能够选择的最优方向上。<br> 求椭球上两点的最短路，很容易想到用传统的<strong>最短路算法如迪杰斯特拉算法或弗洛伊德算法</strong>求解，但是在椭球将步长离散化后，构造以及运用邻接矩阵十分复杂，在保证一定精度的条件下需要极大的运算量，所以最短路算法暂时没有太好的应用条件。<br> 另一种考虑过的思路为采用经典优化算法，如<strong>粒子群算法或者蚁群算法</strong>等进行迭代求解。这种方法理论上是可行的，但是由于构造出椭球面的离散化极坐标坐标点相当多，以及这类算法本身有较大的运算量以及结果的随机性，暂时不予以考虑。<br> 还曾考虑过用<strong>梯度下降算法</strong>来求解，就是将椭球旋转至使目标点的法向量为沿z轴负方向时构造出此时的椭球的函数表达式，即可使用梯度下降算法。这种方法是最为理想的方法，但是椭球的旋转涉及到<strong>仿射变换</strong>，构造变换矩阵非常复杂，所以暂时不予考虑。<br> 根据梯度下降算法，可以很自然的想到既然椭球不转那我们能不能直接利用目标点的外法向量作为一个基准方向来进行导向。由次我们就想出了基于法向矢量导向的椭球上最短路求解。</p> 
<h3><a id="_7"></a>模型假设</h3> 
<p>（1） 假设椭球上的网格足够小，运动点在椭球上的运动方向近似为椭球表面的切线方向</p> 
<p>（2） 运动点到达距离终点的欧式距离小于一定范围时就视为到达终点</p> 
<p>（3） 椭球上的运动点每次移动的欧式距离近似等于在表面移动时的弧长</p> 
<p>（4） 椭球上的运动点的每次移动都会选择最优的方向</p> 
<h3><a id="_16"></a>模型建立与算法设计</h3> 
<table><thead><tr><th>步骤</th><th>操作</th></tr></thead><tbody><tr><td>1</td><td>给定起点A和终点B的椭球极坐标，计算其直角坐标，并计算B的外法向量记为<strong>BW</strong></td></tr><tr><td>2</td><td>计算A点在二维极坐标中以A为中心的一定宽度方格内的点Mi的极坐标</td></tr><tr><td>3</td><td>计算所有Mi的直角坐标，并且计算出向量<strong>AM</strong>i，并将其全部化为单位向量</td></tr><tr><td>4</td><td>计算<strong>BW</strong>*<strong>AM</strong>i的值，并找出使该值最小的Mi点作为下一个A点，重复步骤1</td></tr></tbody></table> 
<h3><a id="_23"></a>变量与符号说明</h3> 
<p>A……………………………………………….代指椭球表面的运动点的当前位置</p> 
<p>B………………………………………………………………………………….终点</p> 
<p>AM<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
        
          i 
         
        
       
      
        _{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.461664em; vertical-align: -0.15em;"></span><span class="mord"><span class=""></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>……………………….椭球运动点在某次运动中可选择的单位方向向量集合</p> 
<p>BW…………………………………………………椭球终点的垂直于表面的法向量</p> 
<p>d<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
        
          i 
         
        
       
      
        _{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.461664em; vertical-align: -0.15em;"></span><span class="mord"><span class=""></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ………………………………………………………每次运动点移动的欧式距离</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
      
        \epsilon 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span> ………………………………………………………………………….终点判断值</p> 
<p>D…………………………………………………………………………总路径的长度</p> 
<h4><a id="_38"></a>模型建立与算法设计</h4> 
<p><img src="https://images2.imgbox.com/f2/cf/j8d3mh2u_o.jpg" alt="在这里插入图片描述"><br> 当A要向B靠近时，求使AMi的单位方向向量与BW乘积最大的AMi作为从当前运动点指向下一个运动点的向量。对于共线的向量AMi的情况 ，取AMi长度较小的一方指向的点作为下一个A点，这样可以通过减小步长来适当降低误差。</p> 
<p>注意注意，这里的A点周围的单位向量其实并不在一个平面内，因为我们找的是椭球上A相邻极坐标的点，所以只是椭球上从一个点出发到周围多个点的连线，我们只是用这些连线形成的向量来帮我们判断下一步的方向以及下一步所到的点。</p> 
<p><img src="https://images2.imgbox.com/0d/14/ZUvtObu7_o.jpg" alt="在这里插入图片描述"><br> 1 给定起点和终点B的椭球极坐标，，A初始值设为起点坐标，计算其直角坐标，并计算B的外法向量记为BW</p> 
<p>2 计算A点在二维极坐标中以A为中心的一定宽度方格内的点Mi的极坐标</p> 
<p>3 计算所有Mi的直角坐标，并且计算出向量AMi，并将其全部化为单位向量</p> 
<p>4 计算BW*AMi的值，并找出使该值最大的Mi点作为下一个A点</p> 
<p>5 计算当前A点与B的欧式距离，若该距离小于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ϵ 
        
       
      
        \epsilon 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">ϵ</span></span></span></span></span> ，则停止循环，输出D</p> 
<p>6 计算下一个点A于当前点A之间的欧式距离d<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
        
          i 
         
        
       
      
        _{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.461664em; vertical-align: -0.15em;"></span><span class="mord"><span class=""></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，D=D+d<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
        
          i 
         
        
       
      
        _{i} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.461664em; vertical-align: -0.15em;"></span><span class="mord"><span class=""></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
<h3><a id="_57"></a>代码实现</h3> 
<p>椭球坐标转化为直角坐标函数：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>alpha<span class="token punctuation">)</span>
a<span class="token operator">=</span><span class="token number">6000</span><span class="token punctuation">;</span>
b<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">;</span>
x<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
y<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
end
</code></pre> 
<p>主程序：</p> 
<pre><code class="prism language-javascript">clear all
a<span class="token operator">=</span><span class="token number">6000</span><span class="token punctuation">;</span>
b<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">;</span>
<span class="token operator">%</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2200</span> <span class="token number">2900</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">%</span>y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3600</span> <span class="token number">3300</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token operator">%</span>z<span class="token operator">=</span>b<span class="token operator">*</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token operator">*</span>x<span class="token operator">+</span>y<span class="token punctuation">.</span><span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>comval<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

pcs<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">;</span><span class="token operator">%</span>网格精度，不能超过<span class="token number">3000</span>，否则电脑会无法存储过多的网格坐标数据而崩溃
cho<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span><span class="token operator">%</span>AMi的选择个数控制，选择个数为（<span class="token number">2</span><span class="token operator">*</span>cho<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>设置的越高，曲线就越平滑，但是可能出现跨度比较大的点，必须为正整数，一般设为<span class="token number">6</span>以上

g<span class="token operator">=</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>pi<span class="token punctuation">,</span>pcs<span class="token punctuation">)</span><span class="token punctuation">;</span>h<span class="token operator">=</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>pi<span class="token punctuation">,</span>pcs<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
thetaS<span class="token operator">=</span><span class="token function">g</span><span class="token punctuation">(</span>pcs<span class="token operator">*</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alphaS<span class="token operator">=</span><span class="token function">h</span><span class="token punctuation">(</span>pcs<span class="token operator">*</span><span class="token number">1.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
thetaP<span class="token operator">=</span><span class="token function">g</span><span class="token punctuation">(</span>pcs<span class="token operator">*</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alphaP<span class="token operator">=</span><span class="token function">h</span><span class="token punctuation">(</span>pcs<span class="token operator">*</span><span class="token number">1.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>给出<span class="token constant">S</span><span class="token punctuation">,</span><span class="token constant">T</span>的极坐标
sphS<span class="token operator">=</span><span class="token punctuation">[</span>thetaS<span class="token punctuation">,</span>alphaS<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span>路径点集
tL<span class="token operator">=</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>aL<span class="token operator">=</span>tL<span class="token punctuation">;</span>
<span class="token punctuation">[</span>theta<span class="token punctuation">,</span>alpha<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">meshgrid</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>theta<span class="token punctuation">,</span>alpha<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算椭圆上所有点的直角坐标
<span class="token punctuation">[</span>xs<span class="token punctuation">,</span> ys <span class="token punctuation">,</span>zs<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>thetaS<span class="token punctuation">,</span>alphaS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>xt <span class="token punctuation">,</span>yt <span class="token punctuation">,</span>zt<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>thetaP<span class="token punctuation">,</span>alphaP<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>计算<span class="token constant">S</span><span class="token punctuation">,</span> <span class="token constant">T</span>的直角坐标
pw<span class="token operator">=</span><span class="token punctuation">[</span>xt<span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>a<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>yt<span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>a<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>zt<span class="token operator">*</span><span class="token number">2</span><span class="token operator">/</span>b<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">%</span>计算<span class="token constant">T</span>点的外法向量
pw<span class="token operator">=</span>pw<span class="token operator">/</span><span class="token function">norm</span><span class="token punctuation">(</span>pw<span class="token punctuation">)</span><span class="token punctuation">;</span>
num<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
lasts1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>lasts2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">%</span>距离终点的欧式距离


<span class="token keyword">while</span> num<span class="token operator">&lt;</span><span class="token number">10000</span>
    <span class="token operator">%</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>构造所有的AMi的选择向量的指向点<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
    m<span class="token operator">=</span>thetaS<span class="token operator">-</span>cho<span class="token operator">*</span>tL<span class="token operator">:</span>tL<span class="token operator">:</span>thetaS<span class="token operator">+</span>cho<span class="token operator">*</span>tL<span class="token punctuation">;</span>
    n<span class="token operator">=</span>alphaS<span class="token operator">-</span>cho<span class="token operator">*</span>aL<span class="token operator">:</span>aL<span class="token operator">:</span>alphaS<span class="token operator">+</span>cho<span class="token operator">*</span>aL<span class="token punctuation">;</span><span class="token operator">%</span>生成网格节点
    <span class="token punctuation">[</span>moveSt<span class="token punctuation">,</span>moveSa<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">meshgrid</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    moveSt<span class="token operator">=</span><span class="token function">reshape</span><span class="token punctuation">(</span>moveSt<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>cho<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    moveSa<span class="token operator">=</span><span class="token function">reshape</span><span class="token punctuation">(</span>moveSa<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>cho<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token punctuation">[</span>xmove<span class="token punctuation">,</span>ymove<span class="token punctuation">,</span>zmove<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>moveSt<span class="token punctuation">,</span>moveSa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>通过自己写的elip2cart函数将极坐标转为直角坐标    
    <span class="token operator">%</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>进行核心算法判断，来选择椭圆表面移动点的下一个位置
    sm<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span>cho<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cval<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>cho<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>cho<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
        <span class="token function">sm</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">xmove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>xs<span class="token punctuation">,</span><span class="token function">ymove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>ys<span class="token punctuation">,</span><span class="token function">zmove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>zs<span class="token punctuation">]</span><span class="token operator">/</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">xmove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>xs<span class="token punctuation">,</span><span class="token function">ymove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>ys<span class="token punctuation">,</span><span class="token function">zmove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>zs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">cval</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">sm</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token operator">*</span>pw'<span class="token punctuation">;</span><span class="token operator">%</span>计算每个AMi与<span class="token constant">PW</span>的乘积
    end
    nextp<span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span>cval<span class="token operator">==</span><span class="token function">max</span><span class="token punctuation">(</span>cval<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">%</span>按照设计好的算法来选出最大乘积的AMi
    
    thetaS<span class="token operator">=</span><span class="token function">moveSt</span><span class="token punctuation">(</span><span class="token function">nextp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alphaS<span class="token operator">=</span><span class="token function">moveSa</span><span class="token punctuation">(</span><span class="token function">nextp</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>移动，将选出的<span class="token constant">M</span>点坐标作为下一个起点
    
    <span class="token punctuation">[</span>xs<span class="token punctuation">,</span> ys <span class="token punctuation">,</span>zs<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>thetaS<span class="token punctuation">,</span>alphaS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    sphS<span class="token operator">=</span><span class="token punctuation">[</span>sphS<span class="token punctuation">;</span>thetaS<span class="token punctuation">,</span>alphaS<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    num<span class="token operator">=</span>num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    
    k<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>xs<span class="token operator">-</span>xt<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>ys<span class="token operator">-</span>yt<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>zs<span class="token operator">-</span>zt<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算当前移动后的点与终点的距离，若小于<span class="token number">20</span>（也可以自己设）则判读其到达了目的地
    
    <span class="token keyword">if</span> k<span class="token operator">&lt;</span><span class="token number">20</span>
        <span class="token keyword">break</span>       
    end
    
end


thetaS<span class="token operator">=</span><span class="token function">g</span><span class="token punctuation">(</span>pcs<span class="token operator">*</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alphaS<span class="token operator">=</span><span class="token function">h</span><span class="token punctuation">(</span>pcs<span class="token operator">*</span><span class="token number">1.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>这个地方必须要跟前面设置的起点坐标保持一致
<span class="token punctuation">[</span>xs<span class="token punctuation">,</span> ys <span class="token punctuation">,</span>zs<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span>thetaS<span class="token punctuation">,</span>alphaS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>xr<span class="token punctuation">,</span>yr<span class="token punctuation">,</span>zr<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">elip2cart</span><span class="token punctuation">(</span><span class="token function">sphS</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">sphS</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
td<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">%</span>总距离
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>xr<span class="token punctuation">)</span>
    td<span class="token operator">=</span>td<span class="token operator">+</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">xr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">xr</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">yr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">yr</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">zr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">zr</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
end

<span class="token operator">%</span><span class="token function">comval</span><span class="token punctuation">(</span>cho<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>pcs<span class="token operator">-</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">=</span>td<span class="token punctuation">;</span>
td
realval<span class="token operator">=</span><span class="token number">17314.47799</span>





<span class="token function">mesh</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on
<span class="token function">plot3</span><span class="token punctuation">(</span>xs<span class="token punctuation">,</span> ys <span class="token punctuation">,</span>zs<span class="token punctuation">,</span><span class="token string">'r.'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
<span class="token function">plot3</span><span class="token punctuation">(</span>xt <span class="token punctuation">,</span>yt <span class="token punctuation">,</span>zt<span class="token punctuation">,</span><span class="token string">'r.'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
<span class="token function">plot3</span><span class="token punctuation">(</span>xr<span class="token punctuation">,</span>yr<span class="token punctuation">,</span>zr<span class="token punctuation">,</span><span class="token string">'r.'</span><span class="token punctuation">,</span><span class="token string">'markersize'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token operator">%</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token function">length</span><span class="token punctuation">(</span>comval<span class="token punctuation">)</span><span class="token punctuation">,</span>realval<span class="token punctuation">.</span><span class="token operator">*</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">length</span><span class="token punctuation">(</span>comval<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_155"></a>运行结果及结果分析</h3> 
<p><img src="https://images2.imgbox.com/91/f7/9KpIFtGf_o.jpg" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/82/5d/RAEQsQ7y_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1f/87/7KwAvVJh_o.jpg" alt="在这里插入图片描述"><br> 可以从图中看出，基本上已经实现了椭球上最短距离的寻找。接下来选取两个特殊点进行结果的验证和分析。</p> 
<p>选取椭球的最高点到最低点的作为起点和终点，根据现有的理论近似公式计算出理论近似值，将其与通过该方法计算出的值进行比较。</p> 
<p><img src="https://images2.imgbox.com/93/c8/R4tTZ6vD_o.jpg" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/90/76/26Nt0KCm_o.jpg" alt="在这里插入图片描述"><br> 理论计算的公式为计算椭圆的周长公式，名为Ramanujan近似公式。</p> 
<p><img src="https://images2.imgbox.com/95/91/UCuGgs4l_o.jpg" alt="在这里插入图片描述"><br> 计算得到的理论值为17314.47799，如上图所示，我们通过该方法计算得到的值为1.7283*104，与真实值比较接近。误差的来源可能为每次计算的欧式距离总是小于实际上的弧长，也可能是理论计算公式的带来的近似误差。<br> <img src="https://images2.imgbox.com/b7/87/R9QxMkXK_o.jpg" alt="在这里插入图片描述"><br> 当改变网格的精度时，会使结果与理论计算值之间的差异发生变化，计算得到的值近似收敛于某个定值。推测收敛到这个值可能即为最短距离的真实值。<br> 当改变AMi的可选择方向数目时对结果的影响不大。</p> 
<h3><a id="_175"></a>优缺点及改进方向</h3> 
<p>本次实验较好地实现了通过计算机求解椭球面上两点的最短距离，得出的结果与理论近似公式得出的结果非常接近，对于椭球上的任意两点能够比较灵敏地自动寻找轨迹。所运用的方法是根据现有的梯度下降法的思想，方法创新性较强。</p> 
<p>对于两个影响指标进行了分析，得到了这两个指标对结果的影响，并且给出了可能的解释。对于其中一个影响指标的趋势给出了可能的猜测。</p> 
<p>本实验较大的不足在于，主要的算法没有进行严格的数学证明，是仅凭主观意识得出的结论，虽然结果比较理想但是没有严格证明结果的可靠性和正确性。</p> 
<p>核心算法有漏洞，可能会导致特殊情况下路径选择的偏离。具体为，当向量AMi的选择范围较大时，比如大于100个方向向量，其选择的方向可能导致前后两个运动点间的跨度过大，从而导致路径偏离和较大的误差。如图所示。<br> <img src="https://images2.imgbox.com/79/5e/bTKD94RR_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dbeb380f26b4e56e16d3de3f7a6f9840/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Transformer 优秀开源工作：timm 库 vision transformer 代码解读</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/115ff93164a624f0ff279b683a8f5f64/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【java】浅谈双指针</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>