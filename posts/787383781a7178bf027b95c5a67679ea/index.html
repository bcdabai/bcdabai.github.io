<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CS使用&#43;后渗透 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CS使用&#43;后渗透" />
<meta property="og:description" content="首先，让我们了解CS是什么，
又称“Cobalt Strike” 一款以由美国redteam团队，研 发出来的一款以Metasploit为基础的GUI框架 式渗透测试工具。
它是一款基于java的渗透测试神器，常被业界人称为CS，也被戏称为“线上多人运动平台”
为什么又叫“多人运动平台”？
CS使用了C/S架构，它分为客户端和服务端，服务端只要一个，客户端可有多个，多人 连接服务端后可协同测试，与其他人分享shell。
首先官网下载，在kali中解压压缩包并且将压缩包单独放入一个文件 或者在本机中压缩拉入kali。
环境
攻击机：Kali-linux ip：192.168.1.47
靶机 ：windows7 ip：192.168.1.45
工具
Cobaltstrike
搭建服务器
首先进入kali，切换root权限，密码kali
进入CS目录，并且给予相关权限
Ls 查看名下10个目录
cd cobalt­­­­_strike_4.5 进入cs目录
chmod 777 * 最高指令，给所有的文件可读，可写可执行权限（777表示可读可写可执行）
.运行CS文件，设置服务器IP，密码
./teamserver &#43;kali的IP &#43; 连接密码
./teamserver.sh 192.168.1.47 admin
可以看到上图端口是50050，记得后面需要确认端口号
接下来再重新打开一个终端，也就是所谓的客户端，命令按照上面再输一遍
会弹出一个窗口，名字随便写，密码admin
登陆成功的界面
点击左上方CobaltStrike选项——&gt;在下拉框中选择 监听器 接着选择 添加
1.
2. 下面会弹出一个窗口，
名字是监听器名字可随便写，
点击加号，shell反弹的主机，也就是我们kali的ip
此时监听器已经启动可以开始克隆下一步
点击(攻击)选项，选择clone site(网站克隆)
攻击---钓鱼攻击---克隆网站
Clone Url(克隆url): 选择要复制的网站，我这里选择心理登录网站
Local URL(本地url): 如果你自己有网站域名那就填写
勾选一下 下面的选项，这个是监听键盘选项
点击确认之后，会生成一个url,点击url去访问就可以了
为什么上面和下面端口不一样
同一个端口应该是被占用了，这里换了一个8080就可以进去了
通过访问view(视图)的web" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/787383781a7178bf027b95c5a67679ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-16T23:49:02+08:00" />
<meta property="article:modified_time" content="2023-08-16T23:49:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CS使用&#43;后渗透</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">首先，让我们了解CS是什么，</span></strong></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">又称“Cobalt Strike” 一款以由美国redteam团队，研 发出来的一款以Metasploit为基础的GUI框架 式渗透测试工具。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">它是一款基于java的渗透测试神器，常被业界人称为CS，也被戏称为“线上多人运动平台”</span></p> 
<p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">为什么又叫“多人运动平台”？</span></strong></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">CS</span><span style="color:#4d4d4d;">使用了C/S架构，它分为客户端和服务端，服务端只要一个，客户端可有多个，多人 连接服务端后可协同测试，与其他人分享shell。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">首先官网下载，在kali中解压压缩包并且将压缩包单独放入一个文件 或者在本机中压缩拉入kali。</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="451" src="https://images2.imgbox.com/0e/3e/MwP4FHQk_o.png" width="462"></p> 
<p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">环境</span></strong></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">攻击机：Kali-linux ip：192.168.1.47</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">靶机 ：windows7 ip：192.168.1.45</span></p> 
<p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">工具</span></strong></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">Cobaltstrike</span></p> 
<p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">搭建服务器</span></strong></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">首先进入kali，切换root权限，密码kali</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="91" src="https://images2.imgbox.com/10/53/w0aI7Qph_o.png" width="437"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">进入CS目录，并且给予相关权限</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">Ls  </span><span style="color:#4d4d4d;">查看名下10个目录</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">cd cobalt­­­­_strike_4.5  </span><span style="color:#4d4d4d;">进入cs目录</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">chmod 777 *         </span><span style="color:#4d4d4d;">最高指令，给所有的文件可读，可写可执行权限（777表示可读可写可执行）</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="228" src="https://images2.imgbox.com/bd/e6/9CUFnQF2_o.png" width="1008"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">.</span><span style="color:#4d4d4d;">运行CS文件，设置服务器IP，密码</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">./teamserver +kali</span><span style="color:#4d4d4d;">的IP + 连接密码</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">./teamserver.sh 192.168.1.47 admin</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="172" src="https://images2.imgbox.com/63/c6/DeljzRbo_o.png" width="1067"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">可以看到上图端口是50050，记得后面需要确认端口号</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">接下来再重新打开一个终端，也就是所谓的客户端，命令按照上面再输一遍</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="392" src="https://images2.imgbox.com/e2/d2/gTFKYjAK_o.png" width="1176"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">会弹出一个窗口，名字随便写，密码admin</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="372" src="https://images2.imgbox.com/0f/08/uy1T6gUr_o.png" width="627"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">登陆成功的界面</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="712" src="https://images2.imgbox.com/35/0e/f9VqVJIH_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">点击左上方CobaltStrike选项——&gt;在下拉框中选择 监听器 接着选择 添加</span></p> 
<p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">1.</span></strong></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="238" src="https://images2.imgbox.com/7d/e7/pwTV2qWI_o.png" width="197"><strong> </strong></p> 
<p style="margin-left:0;text-align:left;"><strong><span style="color:#4d4d4d;">2.      </span></strong></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="115" src="https://images2.imgbox.com/32/f2/Zvu84Fge_o.png" width="498"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">下面会弹出一个窗口，</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">名字是监听器名字可随便写，</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">点击加号，shell反弹的主机，也就是我们kali的ip</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="607" src="https://images2.imgbox.com/4b/71/i0lZdbLk_o.png" width="545"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">此时监听器已经启动可以开始克隆下一步</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">点击(攻击)选项，选择clone site(网站克隆)</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">攻击---钓鱼攻击---克隆网站</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="230" src="https://images2.imgbox.com/6d/23/vT1oNS5t_o.png" width="543"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">Clone Url(</span><span style="color:#4d4d4d;">克隆url): 选择要复制的网站，我这里选择心理登录网站</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">Local URL(</span><span style="color:#4d4d4d;">本地url): 如果你自己有网站域名那就填写</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">勾选一下 下面的选项，这个是监听键盘选项</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="363" src="https://images2.imgbox.com/38/fb/hOe076tf_o.png" width="466"></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="220" src="https://images2.imgbox.com/11/e9/PeSzVFTx_o.png" width="376"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">点击确认之后，会生成一个url,点击url去访问就可以了</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">为什么上面和下面端口不一样</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">同一个端口应该是被占用了，这里换了一个8080就可以进去了</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="717" src="https://images2.imgbox.com/2e/3f/HDUpk5aP_o.png" width="1008"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">通过访问view(视图)的web</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">log(Web</span><span style="color:#4d4d4d;">日志) 选项，可 以知晓键盘监听的结果。</span></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">视图--web日志</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="422" src="https://images2.imgbox.com/ba/59/5jsA58Un_o.png" width="912"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">到这里呢，就可以看到刚才我们输入的账号密码可以查看到了</span></p> 
<p style="margin-left:0;text-align:left;"><strong>生成exe程序，win7双击系统上线</strong></p> 
<p style="margin-left:0;text-align:left;">选择攻击模块---生成后门---windows可执行程序</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="206" src="https://images2.imgbox.com/00/80/6G4pbwfR_o.png" width="409"></p> 
<p style="margin-left:0;text-align:left;"><strong>选择监听器，并且勾选下面的使用64</strong></p> 
<p style="margin-left:0;text-align:left;"><strong>payload</strong><strong>，之后点击生成</strong></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="252" src="https://images2.imgbox.com/3b/99/WqBAUhRa_o.png" width="427"></p> 
<p style="margin-left:0;text-align:left;"><strong>点击右边三个点，选择taikule</strong></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="377" src="https://images2.imgbox.com/8d/bf/kqKTSWSu_o.png" width="838"></p> 
<p style="margin-left:0;text-align:left;"><strong>选择exe 木马的生成地址，我这里选择了/home/kali目录。</strong></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="424" src="https://images2.imgbox.com/de/40/w1IWsI82_o.png" width="682"></p> 
<p style="margin-left:0;text-align:left;">Windows里面，转到中途站主机上，如果木马不见了的话，是因为防火墙自动杀掉了，</p> 
<p style="margin-left:0;text-align:left;">记得添加信任区，生成到信任区就好</p> 
<p style="margin-left:0;text-align:left;">此时将木马放入win7中，可以利用之前所写的ms17-010（永恒之蓝）漏洞，使用upload命令将木马文件上传win7桌面</p> 
<p style="margin-left:0;text-align:left;">我这里是用的“永恒之蓝”漏洞上传的，具体操作请翻看之前的帖子</p> 
<p style="margin-left:0;text-align:left;">将木马放到靶机win7中，放入之后，双击木马，之后CS会提示上线<img alt="" height="451" src="https://images2.imgbox.com/0f/42/pL1yiUrz_o.png" width="632"></p> 
<p style="margin-left:0;text-align:left;">当我们点击interact(会话交互)后，便会和msfconsole一样，进入命令模式。</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="267" src="https://images2.imgbox.com/80/06/8JCLpatE_o.png" width="412"></p> 
<p style="margin-left:0;text-align:left;">右键点击上线的靶机，然后在session(会话操作)里面将，sleep(回连间隔)的参数改为0</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="286" src="https://images2.imgbox.com/7a/cd/vq3GWIh8_o.png" width="348"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;"><span style="color:#4d4d4d;">获取系统用户名和密码--远程桌面连接</span></p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="313" src="https://images2.imgbox.com/65/a8/ieiUBP9W_o.png" width="862"></p> 
<p style="margin-left:0;text-align:left;">执行系统命令，比如以下操作网络探测、端口扫描、截图等就不一一演示了</p> 
<p style="margin-left:0;text-align:left;"><img alt="" height="197" src="https://images2.imgbox.com/04/0b/jEsD4aE1_o.png" width="222"></p> 
<p><span style="color:#4d4d4d;">好，今天学习到此为止，让我们一起进步吧。</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c622b5a4a4c006ace00d7c3efb9dc1fd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;调用matlab编译的动态链接库dll</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0b20c56f95f1e3ea77aa97e36cb16a77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">将微信小程序页面转为图片</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>