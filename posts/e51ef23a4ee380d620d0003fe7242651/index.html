<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Rust-Rocket框架笔记 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Rust-Rocket框架笔记" />
<meta property="og:description" content="Rust-Rocket框架笔记 Rocket-Learn-docRocket Addr视频地址 What is RocketQuickStart下载Rocket-Rust运行Rust-Rocket-Hello-错误-端口占用解决查看端口占用情况添加Rocket.toml配置文件更改Rocket默认启动端口启动成功 GetStart-Hello world创建项目cargoIDEA 添加依赖添加Rocket.toml配置文件main.rsres Rocket-生命周期Rocket-请求方法动态路径路径保护忽略路径转发通过参数类型捕获rank默认等级 请求守卫转发守卫 Cookie隐私Cookie密钥 格式Format请求体数据Json开启json特性引入use设置请求体数据体（struct）编写方法临时文件流媒体 QueryString静态参数动态参数尾随参数 错误处理器 Rocket-响应Responder包装例子 自定义应答器简单示例完整示例 Responder实现OptionResult 响应Json模板添加依赖修改Cargo.tomlmain.rs添加页面模板 Rocket-状态管理Rocket-连接池连接数据库Mysql添加依赖设置数据库连接配置(Rocket.toml)main.rs 使用Figment提取自定义配置添加依赖设置app.tomlmain.rs Rocket-Learn-doc createTime:20230430author:syf20020816@outlook.comemail:syf20020816@outlook.com Rocket Addr 地址：https://rocket.rs/v0.5-rc/guide/introduction/
视频地址 https://www.bilibili.com/video/BV14h41177Ga/?spm_id_from=333.999.0.0&amp;vd_source=9c2ae08297163e79152407c969f04717
What is Rocket Rocket是Rust的Web框架。如果你愿意，你可以把火箭看作是一个更灵活，更友好支持热插拔,我们更愿意把火箭看作是一种新的东西。Rocket的目标是快速、简单和灵活，同时尽可能提供有保证的安全性。更重要的是，Rocket还致力于成为乐趣，它通过确保您编写尽可能少的代码来完成任务来实现这一点。
Rocket的设计围绕着三个核心理念：
安全性、正确性和开发人员体验至关重要。
阻力最小的路径应该会引导您获得最安全，最正确的Web应用程序，尽管安全性和正确性不应该以降低开发人员体验为代价。Rocket易于使用，同时采取了很好的措施来确保您的应用程序是安全和正确的，而无需认知开销。
所有请求处理信息都应该是类型化的，并且是独立的。
因为Web和HTTP本身是无类型的（或弦地 类型的，正如一些人所说的那样），这意味着某些东西或某人必须将字符串转换为本地类型。Rocket可以为你做到这一点，而且编程开销为零。更何况，火箭的请求处理是自足的 零全局状态：处理程序是具有常规参数的常规函数。
不应强迫作出决定。
模板、序列化、会话以及几乎所有其他组件都是可插拔的可选组件。虽然Rocket对每一个都有官方支持和库，但它们是完全可选和可交换的。
这三个想法决定了Rocket的界面，你会发现它们都嵌入了Rocket的核心功能
QuickStart 下载Rocket-Rust git clone https://github.com/SergioBenitez/Rocket cd Rocket/examples/hello cargo run 运行Rust-Rocket-Hello-错误-端口占用 Configured for debug. &gt;&gt; address: 127.0.0.1 &gt;&gt; port: 8000 &gt;&gt; workers: 8 &gt;&gt; max blocking threads: 512 &gt;&gt; ident: Rocket &gt;&gt; IP header: X-Real-IP &gt;&gt; limits: bytes = 8KiB, data-form = 2MiB, file = 1MiB, form = 32KiB, json = 1MiB, msgpack = 1MiB, string = 8KiB &gt;&gt; temp dir: C:\Users\SYF200~1\AppData\Local\Temp\ &gt;&gt; http/2: true &gt;&gt; keep-alive: 5s &gt;&gt; tls: disabled &gt;&gt; shutdown: ctrlc = true, force = true, grace = 2s, mercy = 3s &gt;&gt; log level: normal &gt;&gt; cli colors: true Routes: &gt;&gt; (hello) GET /?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e51ef23a4ee380d620d0003fe7242651/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-03T02:32:18+08:00" />
<meta property="article:modified_time" content="2023-05-03T02:32:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Rust-Rocket框架笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Rust-Rocket框架笔记</h4> 
 <ul><li><a href="#RocketLearndoc_1" rel="nofollow">Rocket-Learn-doc</a></li><li><a href="#Rocket_Addr_7" rel="nofollow">Rocket Addr</a></li><li><ul><li><a href="#_10" rel="nofollow">视频地址</a></li></ul> 
  </li><li><a href="#What_is_Rocket_12" rel="nofollow">What is Rocket</a></li><li><a href="#QuickStart_32" rel="nofollow">QuickStart</a></li><li><ul><li><a href="#RocketRust_34" rel="nofollow">下载Rocket-Rust</a></li><li><a href="#RustRocketHello_42" rel="nofollow">运行Rust-Rocket-Hello-错误-端口占用</a></li><li><ul><li><a href="#_79" rel="nofollow">解决</a></li><li><a href="#_81" rel="nofollow">查看端口占用情况</a></li><li><a href="#RockettomlRocket_87" rel="nofollow">添加Rocket.toml配置文件更改Rocket默认启动端口</a></li><li><a href="#_100" rel="nofollow">启动成功</a></li></ul> 
  </li></ul> 
  </li><li><a href="#GetStartHello_world_139" rel="nofollow">GetStart-Hello world</a></li><li><ul><li><a href="#_141" rel="nofollow">创建项目</a></li><li><ul><li><a href="#cargo_143" rel="nofollow">cargo</a></li><li><a href="#IDEA_149" rel="nofollow">IDEA</a></li></ul> 
   </li><li><a href="#_155" rel="nofollow">添加依赖</a></li><li><a href="#Rockettoml_162" rel="nofollow">添加Rocket.toml配置文件</a></li><li><a href="#mainrs_169" rel="nofollow">main.rs</a></li><li><ul><li><a href="#res_189" rel="nofollow">res</a></li></ul> 
  </li></ul> 
  </li><li><a href="#Rocket_235" rel="nofollow">Rocket-生命周期</a></li><li><a href="#Rocket_239" rel="nofollow">Rocket-请求</a></li><li><ul><li><a href="#_241" rel="nofollow">方法</a></li><li><a href="#_263" rel="nofollow">动态路径</a></li><li><a href="#_276" rel="nofollow">路径保护</a></li><li><a href="#_296" rel="nofollow">忽略路径</a></li><li><a href="#_312" rel="nofollow">转发</a></li><li><ul><li><a href="#_344" rel="nofollow">通过参数类型捕获</a></li><li><a href="#rank_358" rel="nofollow">rank默认等级</a></li></ul> 
   </li><li><a href="#_371" rel="nofollow">请求守卫</a></li><li><ul><li><a href="#_395" rel="nofollow">转发守卫</a></li></ul> 
   </li><li><a href="#Cookie_433" rel="nofollow">Cookie</a></li><li><ul><li><a href="#Cookie_435" rel="nofollow">隐私Cookie</a></li><li><a href="#_491" rel="nofollow">密钥</a></li></ul> 
   </li><li><a href="#Format_499" rel="nofollow">格式Format</a></li><li><a href="#_519" rel="nofollow">请求体数据</a></li><li><ul><li><a href="#Json_530" rel="nofollow">Json</a></li><li><ul><li><a href="#json_534" rel="nofollow">开启json特性</a></li><li><a href="#use_540" rel="nofollow">引入use</a></li><li><a href="#struct_546" rel="nofollow">设置请求体数据体（struct）</a></li><li><a href="#_557" rel="nofollow">编写方法</a></li><li><a href="#_571" rel="nofollow">临时文件</a></li><li><a href="#_586" rel="nofollow">流媒体</a></li></ul> 
   </li></ul> 
   </li><li><a href="#QueryString_611" rel="nofollow">QueryString</a></li><li><ul><li><a href="#_615" rel="nofollow">静态参数</a></li><li><a href="#_629" rel="nofollow">动态参数</a></li><li><a href="#_671" rel="nofollow">尾随参数</a></li></ul> 
   </li><li><a href="#_696" rel="nofollow">错误处理器</a></li></ul> 
  </li><li><a href="#Rocket_754" rel="nofollow">Rocket-响应</a></li><li><ul><li><a href="#Responder_758" rel="nofollow">Responder</a></li><li><a href="#_762" rel="nofollow">包装</a></li><li><ul><li><a href="#_802" rel="nofollow">例子</a></li></ul> 
   </li><li><a href="#_820" rel="nofollow">自定义应答器</a></li><li><ul><li><a href="#_824" rel="nofollow">简单示例</a></li><li><a href="#_839" rel="nofollow">完整示例</a></li></ul> 
   </li><li><a href="#Responder_884" rel="nofollow">Responder实现</a></li><li><ul><li><a href="#Option_897" rel="nofollow">Option</a></li><li><a href="#Result_912" rel="nofollow">Result</a></li></ul> 
   </li><li><a href="#Json_927" rel="nofollow">响应Json</a></li><li><a href="#_944" rel="nofollow">模板</a></li><li><ul><li><a href="#_946" rel="nofollow">添加依赖</a></li><li><a href="#Cargotoml_952" rel="nofollow">修改Cargo.toml</a></li><li><a href="#mainrs_959" rel="nofollow">main.rs</a></li><li><a href="#_980" rel="nofollow">添加页面模板</a></li></ul> 
  </li></ul> 
  </li><li><a href="#Rocket_996" rel="nofollow">Rocket-状态管理</a></li><li><a href="#RocketMysql_1052" rel="nofollow">Rocket-连接池连接数据库Mysql</a></li><li><ul><li><a href="#_1054" rel="nofollow">添加依赖</a></li><li><a href="#Rockettoml_1060" rel="nofollow">设置数据库连接配置(Rocket.toml)</a></li><li><a href="#mainrs_1073" rel="nofollow">main.rs</a></li></ul> 
  </li><li><a href="#Figment_1113" rel="nofollow">使用Figment提取自定义配置</a></li><li><ul><li><a href="#_1115" rel="nofollow">添加依赖</a></li><li><a href="#apptoml_1121" rel="nofollow">设置app.toml</a></li><li><a href="#mainrs_1127" rel="nofollow">main.rs</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="RocketLearndoc_1"></a>Rocket-Learn-doc</h2> 
<ul><li>createTime:20230430</li><li>author:syf20020816@outlook.com</li><li>email:syf20020816@outlook.com</li></ul> 
<h2><a id="Rocket_Addr_7"></a>Rocket Addr</h2> 
<p>地址：https://rocket.rs/v0.5-rc/guide/introduction/</p> 
<h3><a id="_10"></a>视频地址</h3> 
<p><a href="https://www.bilibili.com/video/BV14h41177Ga/?spm_id_from=333.999.0.0&amp;vd_source=9c2ae08297163e79152407c969f04717" rel="nofollow">https://www.bilibili.com/video/BV14h41177Ga/?spm_id_from=333.999.0.0&amp;vd_source=9c2ae08297163e79152407c969f04717</a></p> 
<h2><a id="What_is_Rocket_12"></a>What is Rocket</h2> 
<p>Rocket是Rust的Web框架。如果你愿意，你可以把火箭看作是一个更灵活，更友好支持热插拔,我们更愿意把火箭看作是一种新的东西。Rocket的目标是快速、简单和灵活，同时尽可能提供有保证的安全性。更重要的是，Rocket还致力于成为<em>乐趣</em>，它通过确保您编写尽可能少的代码来完成任务来实现这一点。</p> 
<p>Rocket的设计围绕着三个核心理念：</p> 
<ul><li> <p><strong>安全性、正确性和开发人员体验至关重要。</strong></p> <p>阻力最小的路径应该会引导您获得最安全，最正确的Web应用程序，尽管安全性和正确性不应该以降低开发人员体验为代价。Rocket易于使用，同时采取了很好的措施来确保您的应用程序是安全和正确的，而无需认知开销。</p> </li><li> <p><strong>所有请求处理信息都应该是类型化的，并且是独立的。</strong></p> <p>因为Web和HTTP本身是无类型的（或<em>弦地</em> 类型的，正如一些人所说的那样），这意味着某些东西或某人必须将字符串转换为本地类型。Rocket可以为你做到这一点，而且编程开销为零。更何况，火箭的请求处理是<strong>自足的</strong> 零全局状态：处理程序是具有常规参数的常规函数。</p> </li><li> <p><strong>不应强迫作出决定。</strong></p> <p>模板、序列化、会话以及几乎所有其他组件都是可插拔的可选组件。虽然Rocket对每一个都有官方支持和库，但它们是完全可选和可交换的。</p> </li></ul> 
<p>这三个想法决定了Rocket的界面，你会发现它们都嵌入了Rocket的核心功能</p> 
<h2><a id="QuickStart_32"></a>QuickStart</h2> 
<h3><a id="RocketRust_34"></a>下载Rocket-Rust</h3> 
<pre><code class="prism language-bash"><span class="token function">git</span> clone https://github.com/SergioBenitez/Rocket
<span class="token builtin class-name">cd</span> Rocket/examples/hello
cargo run
</code></pre> 
<h3><a id="RustRocketHello_42"></a>运行Rust-Rocket-Hello-错误-端口占用</h3> 
<pre><code class="prism language-bash">Configured <span class="token keyword">for</span> debug.
   <span class="token operator">&gt;&gt;</span> address: <span class="token number">127.0</span>.0.1
   <span class="token operator">&gt;&gt;</span> port: <span class="token number">8000</span>
   <span class="token operator">&gt;&gt;</span> workers: <span class="token number">8</span>
   <span class="token operator">&gt;&gt;</span> max blocking threads: <span class="token number">512</span>
   <span class="token operator">&gt;&gt;</span> ident: Rocket
   <span class="token operator">&gt;&gt;</span> IP header: X-Real-IP
   <span class="token operator">&gt;&gt;</span> limits: bytes <span class="token operator">=</span> 8KiB, data-form <span class="token operator">=</span> 2MiB, <span class="token function">file</span> <span class="token operator">=</span> 1MiB, form <span class="token operator">=</span> 32KiB, json <span class="token operator">=</span> 1MiB, msgpack
 <span class="token operator">=</span> 1MiB, string <span class="token operator">=</span> 8KiB
   <span class="token operator">&gt;&gt;</span> temp dir: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>SYF200~1<span class="token punctuation">\</span>AppData<span class="token punctuation">\</span>Local<span class="token punctuation">\</span>Temp<span class="token punctuation">\</span>
   <span class="token operator">&gt;&gt;</span> http/2: <span class="token boolean">true</span>
   <span class="token operator">&gt;&gt;</span> keep-alive: 5s
   <span class="token operator">&gt;&gt;</span> tls: disabled
   <span class="token operator">&gt;&gt;</span> shutdown: ctrlc <span class="token operator">=</span> true, force <span class="token operator">=</span> true, grace <span class="token operator">=</span> 2s, mercy <span class="token operator">=</span> 3s
   <span class="token operator">&gt;&gt;</span> log level: normal
   <span class="token operator">&gt;&gt;</span> cli colors: <span class="token boolean">true</span>
Routes:
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>hello<span class="token punctuation">)</span> GET /?<span class="token operator">&lt;</span>lang<span class="token operator">&gt;&amp;</span><span class="token operator">&lt;</span>opt<span class="token punctuation">..</span><span class="token operator">&gt;</span>
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>wave<span class="token punctuation">)</span> GET /wave/<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>age<span class="token operator">&gt;</span>
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>mir<span class="token punctuation">)</span> GET /hello/мир
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>world<span class="token punctuation">)</span> GET /hello/world
Fairings:
   <span class="token operator">&gt;&gt;</span> Shield <span class="token punctuation">(</span>liftoff, response, singleton<span class="token punctuation">)</span>
   <span class="token operator">&gt;&gt;</span> Compatibility Normalizer <span class="token punctuation">(</span>request<span class="token punctuation">)</span>
Error: Rocket failed to <span class="token builtin class-name">bind</span> network socket to given address/port.
   <span class="token operator">&gt;&gt;</span> 以一种访问权限不允许的方式做了一个访问套接字的尝试。 <span class="token punctuation">(</span>os error <span class="token number">10013</span><span class="token punctuation">)</span>
thread <span class="token string">'main'</span> panicked at <span class="token string">'aborting due to socket bind error'</span>, E:<span class="token punctuation">\</span>Rust<span class="token punctuation">\</span>rocket_learn<span class="token punctuation">\</span>Rocket<span class="token punctuation">\</span>co
re<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>src<span class="token punctuation">\</span>error.rs:204:17
note: run with <span class="token variable"><span class="token variable">`</span><span class="token assign-left variable">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span><span class="token variable">`</span></span> environment variable to display a backtrace
error: process didn't <span class="token builtin class-name">exit</span> successfully: <span class="token variable"><span class="token variable">`</span>E:<span class="token punctuation">\</span>Rust<span class="token punctuation">\</span>rocket_learn<span class="token punctuation">\</span>Rocket<span class="token punctuation">\</span>examples<span class="token punctuation">\</span>target<span class="token punctuation">\</span>debug<span class="token punctuation">\</span>h
ello.exe<span class="token variable">`</span></span> <span class="token punctuation">(</span>exit code: <span class="token number">101</span><span class="token punctuation">)</span>

</code></pre> 
<h4><a id="_79"></a>解决</h4> 
<h4><a id="_81"></a>查看端口占用情况</h4> 
<pre><code class="prism language-bash"><span class="token function">netstat</span> -ano <span class="token operator">|</span>findstr <span class="token number">8000</span>
</code></pre> 
<h4><a id="RockettomlRocket_87"></a>添加Rocket.toml配置文件更改Rocket默认启动端口</h4> 
<p><img src="https://images2.imgbox.com/26/72/dYkiBGiV_o.png" alt="在这里插入图片描述"></p> 
<p>添加如下内容修改默认端口：</p> 
<pre><code class="prism language-toml">[default]
address = "127.0.0.1"
port = 8080
</code></pre> 
<h4><a id="_100"></a>启动成功</h4> 
<pre><code class="prism language-bash">Configured <span class="token keyword">for</span> debug.
   <span class="token operator">&gt;&gt;</span> address: <span class="token number">127.0</span>.0.1
   <span class="token operator">&gt;&gt;</span> port: <span class="token number">8080</span>
   <span class="token operator">&gt;&gt;</span> workers: <span class="token number">8</span>
   <span class="token operator">&gt;&gt;</span> max blocking threads: <span class="token number">512</span>
   <span class="token operator">&gt;&gt;</span> ident: Rocket
   <span class="token operator">&gt;&gt;</span> IP header: X-Real-IP
   <span class="token operator">&gt;&gt;</span> limits: bytes <span class="token operator">=</span> 8KiB, data-form <span class="token operator">=</span> 2MiB, <span class="token function">file</span> <span class="token operator">=</span> 1MiB, form <span class="token operator">=</span> 32KiB, json <span class="token operator">=</span> 1MiB, msgpack
 <span class="token operator">=</span> 1MiB, string <span class="token operator">=</span> 8KiB
   <span class="token operator">&gt;&gt;</span> temp dir: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>SYF200~1<span class="token punctuation">\</span>AppData<span class="token punctuation">\</span>Local<span class="token punctuation">\</span>Temp<span class="token punctuation">\</span>
   <span class="token operator">&gt;&gt;</span> http/2: <span class="token boolean">true</span>
   <span class="token operator">&gt;&gt;</span> keep-alive: 5s
   <span class="token operator">&gt;&gt;</span> tls: disabled
   <span class="token operator">&gt;&gt;</span> shutdown: ctrlc <span class="token operator">=</span> true, force <span class="token operator">=</span> true, grace <span class="token operator">=</span> 2s, mercy <span class="token operator">=</span> 3s
   <span class="token operator">&gt;&gt;</span> log level: normal
   <span class="token operator">&gt;&gt;</span> cli colors: <span class="token boolean">true</span>
Routes:
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>hello<span class="token punctuation">)</span> GET /?<span class="token operator">&lt;</span>lang<span class="token operator">&gt;&amp;</span><span class="token operator">&lt;</span>opt<span class="token punctuation">..</span><span class="token operator">&gt;</span>
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>wave<span class="token punctuation">)</span> GET /wave/<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>age<span class="token operator">&gt;</span>
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>mir<span class="token punctuation">)</span> GET /hello/мир
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>world<span class="token punctuation">)</span> GET /hello/world
Fairings:
   <span class="token operator">&gt;&gt;</span> Compatibility Normalizer <span class="token punctuation">(</span>request<span class="token punctuation">)</span>
   <span class="token operator">&gt;&gt;</span> Shield <span class="token punctuation">(</span>liftoff, response, singleton<span class="token punctuation">)</span>
Shield:
   <span class="token operator">&gt;&gt;</span> Permissions-Policy: interest-cohort<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token operator">&gt;&gt;</span> X-Frame-Options: SAMEORIGIN
   <span class="token operator">&gt;&gt;</span> X-Content-Type-Options: nosniff
Rocket has launched from http://127.0.0.1:8080

</code></pre> 
<p>访问：<code>127.0.0.1:8080/?emoji&amp;lang=en</code><br> <img src="https://images2.imgbox.com/6d/4f/LmQJQR7B_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="GetStartHello_world_139"></a>GetStart-Hello world</h2> 
<h3><a id="_141"></a>创建项目</h3> 
<h4><a id="cargo_143"></a>cargo</h4> 
<pre><code class="prism language-bash">cargo new hello-rocket
</code></pre> 
<h4><a id="IDEA_149"></a>IDEA</h4> 
<p><img src="https://images2.imgbox.com/ee/5e/RwXNCmCS_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ae/09/06cdjqVr_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_155"></a>添加依赖</h3> 
<pre><code class="prism language-toml">[dependencies]
rocket = "=0.5.0-rc.3"
</code></pre> 
<h3><a id="Rockettoml_162"></a>添加Rocket.toml配置文件</h3> 
<pre><code class="prism language-toml">[default]
port = 8080
</code></pre> 
<h3><a id="mainrs_169"></a>main.rs</h3> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[macro_use]</span> <span class="token keyword">extern</span> <span class="token keyword">crate</span> <span class="token module-declaration namespace">rocket</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/index"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">"🙂hello world"</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span>_<span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/apiV1_4"</span><span class="token punctuation">,</span><span class="token macro property">routes!</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li><code>#[get("/")]</code>:表示设置一个Get请求的方法，在括号中设置请求地址</li><li><code>#[launch]</code>：替代了<code>fn main()</code>成为Rocket的主入口</li><li><code>mount</code>：方法绑定路由，前面第一个参数是路由前缀</li></ul> 
<h4><a id="res_189"></a>res</h4> 
<pre><code class="prism language-bash">E:<span class="token punctuation">\</span>Rust<span class="token punctuation">\</span>rocket_learn<span class="token punctuation">\</span>hello_rocket<span class="token operator">&gt;</span>cargo run
   Compiling hello_rocket v0.1.0 <span class="token punctuation">(</span>E:<span class="token punctuation">\</span>Rust<span class="token punctuation">\</span>rocket_learn<span class="token punctuation">\</span>hello_rocket<span class="token punctuation">)</span>
    Finished dev <span class="token punctuation">[</span>unoptimized + debuginfo<span class="token punctuation">]</span> target<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">2</span>.04s
     Running <span class="token variable"><span class="token variable">`</span>target<span class="token punctuation">\</span>debug<span class="token punctuation">\</span>hello_rocket.exe<span class="token variable">`</span></span>
Configured <span class="token keyword">for</span> debug.
   <span class="token operator">&gt;&gt;</span> address: <span class="token number">127.0</span>.0.1
   <span class="token operator">&gt;&gt;</span> port: <span class="token number">8080</span>
   <span class="token operator">&gt;&gt;</span> workers: <span class="token number">8</span>
   <span class="token operator">&gt;&gt;</span> max blocking threads: <span class="token number">512</span>
   <span class="token operator">&gt;&gt;</span> ident: Rocket
   <span class="token operator">&gt;&gt;</span> IP header: X-Real-IP
   <span class="token operator">&gt;&gt;</span> limits: bytes <span class="token operator">=</span> 8KiB, data-form <span class="token operator">=</span> 2MiB, <span class="token function">file</span> <span class="token operator">=</span> 1MiB, form <span class="token operator">=</span> 32KiB, json <span class="token operator">=</span> 1MiB, msgpack
 <span class="token operator">=</span> 1MiB, string <span class="token operator">=</span> 8KiB
   <span class="token operator">&gt;&gt;</span> temp dir: C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>SYF200~1<span class="token punctuation">\</span>AppData<span class="token punctuation">\</span>Local<span class="token punctuation">\</span>Temp<span class="token punctuation">\</span>
   <span class="token operator">&gt;&gt;</span> http/2: <span class="token boolean">true</span>
   <span class="token operator">&gt;&gt;</span> keep-alive: 5s
   <span class="token operator">&gt;&gt;</span> tls: disabled
   <span class="token operator">&gt;&gt;</span> shutdown: ctrlc <span class="token operator">=</span> true, force <span class="token operator">=</span> true, grace <span class="token operator">=</span> 2s, mercy <span class="token operator">=</span> 3s
   <span class="token operator">&gt;&gt;</span> log level: normal
   <span class="token operator">&gt;&gt;</span> cli colors: <span class="token boolean">true</span>
Routes:
   <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>index<span class="token punctuation">)</span> GET /apiV1_4/index
Fairings:
   <span class="token operator">&gt;&gt;</span> Shield <span class="token punctuation">(</span>liftoff, response, singleton<span class="token punctuation">)</span>
Shield:
   <span class="token operator">&gt;&gt;</span> X-Frame-Options: SAMEORIGIN
   <span class="token operator">&gt;&gt;</span> X-Content-Type-Options: nosniff
   <span class="token operator">&gt;&gt;</span> Permissions-Policy: interest-cohort<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Rocket has launched from http://127.0.0.1:8080
GET /prefix/index text/html:
   <span class="token operator">&gt;&gt;</span> No matching routes <span class="token keyword">for</span> GET /prefix/index text/html.
   <span class="token operator">&gt;&gt;</span> No <span class="token number">404</span> catcher registered. Using Rocket default.
   <span class="token operator">&gt;&gt;</span> Response succeeded.
GET /apiV1_4/index text/html:
   <span class="token operator">&gt;&gt;</span> Matched: <span class="token punctuation">(</span>index<span class="token punctuation">)</span> GET /apiV1_4/index
   <span class="token operator">&gt;&gt;</span> Outcome: Success
   <span class="token operator">&gt;&gt;</span> Response succeeded.

</code></pre> 
<p><img src="https://images2.imgbox.com/97/00/F92ztNR5_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Rocket_235"></a>Rocket-生命周期</h2> 
<p><img src="https://images2.imgbox.com/a8/6c/3toyag3S_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="Rocket_239"></a>Rocket-请求</h2> 
<h3><a id="_241"></a>方法</h3> 
<p>以下方法均支持：</p> 
<pre><code>`get`、`put`、`post`、`delete`、`head`、`patch`，或`options`
</code></pre> 
<p>写法：</p> 
<pre><code>#[方法类型(路径)]
#[route(方法类型, uri=地址路径)]
</code></pre> 
<p>例子：</p> 
<pre><code>#[get("/")]
#[route(GET , uri = "/")]
</code></pre> 
<h3><a id="_263"></a>动态路径</h3> 
<p>Restful风格API，使用<code>&lt;&gt;</code>进行设置</p> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[get(<span class="token string">"/hello/&lt;name&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{<!-- --></span>
    <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"Hello, {}!"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token attribute attr-name">#[get(<span class="token string">"/hello/&lt;name&gt;/&lt;age&gt;/&lt;cool&gt;"</span>)]</span>
</code></pre> 
<h3><a id="_276"></a>路径保护</h3> 
<p>防止路径遍历攻击，必须写在所有路径的最后面</p> 
<pre><code>&lt;path..&gt;
</code></pre> 
<p>例子：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>path<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Path</span><span class="token punctuation">,</span> <span class="token class-name">PathBuf</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">NamedFile</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/&lt;file..&gt;"</span>)]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">files</span><span class="token punctuation">(</span>file<span class="token punctuation">:</span> <span class="token class-name">PathBuf</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">NamedFile</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">NamedFile</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"static/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_296"></a>忽略路径</h3> 
<p>使用占位符<code>_</code>对路径进行忽略，多路径则使用<code>&lt;_..&gt;</code>表示对路径进行的忽略操作</p> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[get(<span class="token string">"/foo/&lt;_&gt;/bar"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo_bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Foo _____ bar!"</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/&lt;_..&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">everything</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Hey, you're here."</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_312"></a>转发</h3> 
<p>路径相同，但是动态路径类型不同，此时会根据类型进行方法的匹配，当然我们可以使用rank提升优先级<code>#[get("/user/&lt;id&gt;",rank=3)]</code></p> 
<p>rank越小优先级越大</p> 
<pre><code class="prism language-rust"><span class="token comment">// #[macro_use] extern crate rocket;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span>get<span class="token punctuation">,</span> launch<span class="token punctuation">,</span>routes<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//rank越小优先级越大-&gt;@Order("1")</span>
<span class="token attribute attr-name">#[get(<span class="token string">"/user/&lt;id&gt;"</span>,rank=3)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_user</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"get_user"</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/user/&lt;id&gt;"</span>, rank = 2)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_user1</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"get_user1"</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/user/&lt;id&gt;"</span>, rank = 1)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_user2</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"get_user2"</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token macro property">routes!</span><span class="token punctuation">[</span>get_user<span class="token punctuation">,</span> get_user1<span class="token punctuation">,</span> get_user2<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_344"></a>通过参数类型捕获</h4> 
<p>我们可以通过使用Result或Option类型在传入参数上进行捕获，增加其逻辑</p> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[get(<span class="token string">"/user/&lt;id&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_user</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">match</span> id<span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token string">"res"</span><span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=&gt;</span>e
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="rank_358"></a>rank默认等级</h4> 
<p>路径和查询有三种“颜色”：</p> 
<ol><li><code>static</code>，这意味着所有组件都是静态的</li><li><code>partial</code>，意味着至少一个组件是动态的</li><li><code>wild</code>，意味着所有组件都是动态的</li></ol> 
<p>静态路径比静态查询具有更大的权重。对于偏路径和野路径也是如此。这将产生以下默认排名表：</p> 
<p><img src="https://images2.imgbox.com/51/a2/Q4QHIj0o_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_371"></a>请求守卫</h3> 
<p>核心：<code>FromRequest</code> trait</p> 
<p>我们的守卫需要实现<code>FromRequest</code> trait，守卫不设置在路径中，而是直接放置到参数里</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>request<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token class-name">Request</span><span class="token punctuation">,</span> <span class="token class-name">FromRequest</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[rocket::async_trait]</span>
<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'r</span><span class="token operator">&gt;</span> <span class="token class-name">FromRequest</span> <span class="token keyword">for</span> <span class="token class-name">Security</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">type</span> <span class="token type-definition class-name">Error</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">from_request</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'r</span> <span class="token class-name">Request</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Outcome</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span><span class="token class-name">Security</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_395"></a>转发守卫</h4> 
<p>请求防护和转发是强制执行策略的强大组合。为了说明，我们考虑如何使用这些机制来实现一个简单的授权系统。</p> 
<p>我们从两个请求守卫开始：</p> 
<ul><li> <p><code>User</code>：经过身份验证的常规用户。</p> <p>该<code>FromRequest</code> 实现<code>User</code> 检查cookie是否标识用户并返回<code>User</code> 值如果是如果没有用户可以通过身份验证，则防护转发。</p> </li><li> <p><code>AdminUser</code>：已验证为管理员的用户。</p> <p>该<code>FromRequest</code> 实现<code>AdminUser</code> 检查cookie是否标识<em>行政的</em> 用户并返回<code>AdminUser</code> 值如果是如果没有用户可以通过身份验证，则防护转发。</p> </li></ul> 
<p>我们现在将这两个守卫与转发结合使用，实现以下三条路由，每条路由都通向位于<code>/admin</code>：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>response<span class="token punctuation">::</span></span><span class="token class-name">Redirect</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/login"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Template</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* .. */</span> <span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/admin"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">admin_panel</span><span class="token punctuation">(</span>admin<span class="token punctuation">:</span> <span class="token class-name">AdminUser</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Hello, administrator. This is the admin panel!"</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/admin"</span>, rank = 2)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">admin_panel_user</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Sorry, you must be an administrator to access this page."</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/admin"</span>, rank = 3)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">admin_panel_redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Redirect</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Redirect</span><span class="token punctuation">::</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token macro property">uri!</span><span class="token punctuation">(</span>login<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Cookie_433"></a>Cookie</h3> 
<h4><a id="Cookie_435"></a>隐私Cookie</h4> 
<p>一般来说是用于存储一些隐私信息，例如User的信息，防止截获</p> 
<p>必须在toml中开启<code>features=["secrets"]</code></p> 
<pre><code>[dependencies]
rocket = { version = "=0.5.0-rc.3", features = ["secrets"] }
</code></pre> 
<p>示例：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span>get<span class="token punctuation">,</span> launch<span class="token punctuation">,</span> routes<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>request<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token class-name">Request</span><span class="token punctuation">,</span> <span class="token class-name">FromRequest</span><span class="token punctuation">,</span> <span class="token class-name">Outcome</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>http<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Cookie</span><span class="token punctuation">,</span> <span class="token class-name">CookieJar</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>response<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Flash</span><span class="token punctuation">,</span> <span class="token class-name">Redirect</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/user_id"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">user_id</span><span class="token punctuation">(</span>cookie<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">CookieJar</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    cookie<span class="token punctuation">.</span><span class="token function">get_private</span><span class="token punctuation">(</span><span class="token string">"user_id"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>res<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"user id:{}"</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>


<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token macro property">routes!</span><span class="token punctuation">[</span>user_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>示例：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>http<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Cookie</span><span class="token punctuation">,</span> <span class="token class-name">CookieJar</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>response<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Flash</span><span class="token punctuation">,</span> <span class="token class-name">Redirect</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/// Retrieve the user's ID, if any.</span>
<span class="token attribute attr-name">#[get(<span class="token string">"/user_id"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">user_id</span><span class="token punctuation">(</span>cookies<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">CookieJar</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    cookies<span class="token punctuation">.</span><span class="token function">get_private</span><span class="token punctuation">(</span><span class="token string">"user_id"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>crumb<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"User ID: {}"</span><span class="token punctuation">,</span> crumb<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/// Remove the `user_id` cookie.</span>
<span class="token attribute attr-name">#[post(<span class="token string">"/logout"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">logout</span><span class="token punctuation">(</span>cookies<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">CookieJar</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Flash</span><span class="token operator">&lt;</span><span class="token class-name">Redirect</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    cookies<span class="token punctuation">.</span><span class="token function">remove_private</span><span class="token punctuation">(</span><span class="token class-name">Cookie</span><span class="token punctuation">::</span><span class="token function">named</span><span class="token punctuation">(</span><span class="token string">"user_id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Flash</span><span class="token punctuation">::</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token class-name">Redirect</span><span class="token punctuation">::</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Successfully logged out."</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_491"></a>密钥</h4> 
<p>在Rocket.toml中配置<code>secret_key</code>设置需要的密钥，该参数的值可以是256位base64或十六进制字符串，也可以是32字节片。</p> 
<p>通常通过以下工具完成<code>openssl</code>.使用<code>openssl</code>，可以使用以下命令生成256位base64密钥<code>openssl rand -base64 32</code>.</p> 
<p>https://api.rocket.rs/v0.5-rc/rocket/config/struct.SecretKey.html</p> 
<h3><a id="Format_499"></a>格式Format</h3> 
<p>我们常使用的Format：</p> 
<ol><li>form-data</li><li>x-www-form-urlencoded</li><li>json</li><li>xml</li><li>raw</li><li>binary</li></ol> 
<p>https://api.rocket.rs/v0.5-rc/rocket/http/struct.ContentType.html#method.parse_flexible</p> 
<p>直接在类属性宏中添加format属性进行设置即可</p> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[post(<span class="token string">"/user"</span>, format = <span class="token string">"application/json"</span>, data = <span class="token string">"&lt;user&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">new_user</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_519"></a>请求体数据</h3> 
<p>对于请求体数据，我们使用<code>data="&lt;param&gt;"</code>进行匹配</p> 
<pre><code>#[post("/", data = "&lt;input&gt;")]
fn new(input: T) { /* .. */ }
</code></pre> 
<p>注意所有能够被Rocket所处理的传入数据体必须要实现FromData，但是这个trait在人工实现下费时费力，所以我们有以下的处理方式</p> 
<h4><a id="Json_530"></a>Json</h4> 
<p>使用Json对于<code>application/json</code>的format进行处理，常见于POST和PUT方法中</p> 
<h5><a id="json_534"></a>开启json特性</h5> 
<pre><code>rocket = { version = "=0.5.0-rc.3", features = ["secrets","json"] }
</code></pre> 
<h5><a id="use_540"></a>引入use</h5> 
<pre><code>use rocket::serde::{Serialize, Deserialize, json::Json};
</code></pre> 
<h5><a id="struct_546"></a>设置请求体数据体（struct）</h5> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[derive(Debug, Deserialize)]</span>
<span class="token attribute attr-name">#[serde(crate = <span class="token string">"rocket::serde"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{<!-- --></span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_557"></a>编写方法</h5> 
<p><code>Json&lt;User&gt;</code>帮助我们实现FromData</p> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[post(<span class="token string">"/login"</span>, format = <span class="token string">"json"</span>, data = <span class="token string">"&lt;user&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> <span class="token class-name">Json</span><span class="token operator">&lt;</span><span class="token class-name">User</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:#?}"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/40/23/dLcCmF6s_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_571"></a>临时文件</h5> 
<p>该<a href="https://api.rocket.rs/v0.5-rc/rocket/fs/enum.TempFile.html" rel="nofollow"><code>TempFile</code></a> 数据保护直接将数据流传输到临时文件，然后该临时文件可以被持久化。它使接受文件上传变得微不足道：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">TempFile</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[post(<span class="token string">"/upload"</span>, format = <span class="token string">"plain"</span>, data = <span class="token string">"&lt;file&gt;"</span>)]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">upload</span><span class="token punctuation">(</span><span class="token keyword">mut</span> file<span class="token punctuation">:</span> <span class="token class-name">TempFile</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    file<span class="token punctuation">.</span><span class="token function">persist_to</span><span class="token punctuation">(</span>permanent_location<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span>
<span class="token punctuation">}</span>


</code></pre> 
<h5><a id="_586"></a>流媒体</h5> 
<p>有时候你只想直接处理传入的数据。例如，您可能希望将传入数据流式传输到某个接收器。Rocket通过<a href="https://api.rocket.rs/v0.5-rc/rocket/data/struct.Data.html" rel="nofollow"><code>Data</code></a> 类型：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span>tokio<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>data<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Data</span><span class="token punctuation">,</span> <span class="token class-name">ToByteUnit</span><span class="token punctuation">,</span> <span class="token class-name">FromData</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token attribute attr-name">#[post(<span class="token string">"/debug"</span>, data = <span class="token string">"&lt;data&gt;"</span>)]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">debug</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token class-name">Data</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Stream at most 512KiB all of the body data to stdout.</span>
    data<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">.</span><span class="token function">kibibytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">stream_to</span><span class="token punctuation">(</span><span class="token namespace">tokio<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token function">stdout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token keyword">await</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>上面的路由接受任何<code>POST</code> 请求<code>/debug</code> 最多512 KiB的传入数据流输出到<code>stdout</code>如果上传失败，则返回错误响应。上面的处理程序已完成。真的就这么简单！</p> 
<blockquote> 
 <p><strong>注意事项：</strong> Rocket要求在阅读传入数据时设置限制。</p> 
</blockquote> 
<blockquote> 
 <p>为了帮助防止DoS攻击，请设置为128KB的整数倍</p> 
</blockquote> 
<h3><a id="QueryString_611"></a>QueryString</h3> 
<p>出现在请求URL中的URL编码形式。查询参数的声明方式类似于路径参数，但处理方式类似于常规的URL编码表单字段</p> 
<h4><a id="_615"></a>静态参数</h4> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[get(<span class="token string">"/?hello&amp;cat=♥"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">cats</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Hello, kittens!"</span>
<span class="token punctuation">}</span>

<span class="token comment">// The following GET requests match `cats`. `%E2%99%A5` is encoded `♥`.</span>
<span class="token string">"/?cat=%E2%99%A5&amp;hello"</span>
<span class="token string">"/?hello&amp;cat=%E2%99%A5"</span>
<span class="token string">"/?dogs=amazing&amp;hello&amp;there&amp;cat=%E2%99%A5"</span>
</code></pre> 
<h4><a id="_629"></a>动态参数</h4> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[derive(Debug, PartialEq, FromFormField)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">Color</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Red</span><span class="token punctuation">,</span>
    <span class="token class-name">Blue</span><span class="token punctuation">,</span>
    <span class="token class-name">Green</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug, PartialEq, FromForm)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Pet</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'r</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'r</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug, PartialEq, FromForm)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Person</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'r</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
  pet<span class="token punctuation">:</span> <span class="token class-name">Pet</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'r</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/?&lt;name&gt;&amp;&lt;color&gt;&amp;&lt;person&gt;&amp;&lt;other&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> color<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Color</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> person<span class="token punctuation">:</span> <span class="token class-name">Person</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">usize</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"George"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>color<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name">Color</span><span class="token punctuation">::</span><span class="token class-name">Red</span><span class="token punctuation">,</span> <span class="token class-name">Color</span><span class="token punctuation">::</span><span class="token class-name">Green</span><span class="token punctuation">,</span> <span class="token class-name">Color</span><span class="token punctuation">::</span><span class="token class-name">Green</span><span class="token punctuation">,</span> <span class="token class-name">Color</span><span class="token punctuation">::</span><span class="token class-name">Blue</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token class-name">Person</span> <span class="token punctuation">{<!-- --></span>
      pet<span class="token punctuation">:</span> <span class="token class-name">Pet</span> <span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span> <span class="token string">"Fi Fo Alex"</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// A request with these query segments matches as above.</span>
name<span class="token operator">=</span><span class="token class-name">George</span><span class="token operator">&amp;</span>\
color<span class="token operator">=</span>red<span class="token operator">&amp;</span>\
color<span class="token operator">=</span>green<span class="token operator">&amp;</span>\
person<span class="token punctuation">.</span>pet<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token class-name">Fi</span><span class="token operator">+</span><span class="token class-name">Fo</span><span class="token operator">+</span><span class="token class-name">Alex</span><span class="token operator">&amp;</span>\
color<span class="token operator">=</span>green<span class="token operator">&amp;</span>\
person<span class="token punctuation">.</span>pet<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>\
color<span class="token operator">=</span>blue<span class="token operator">&amp;</span>\
extra<span class="token operator">=</span>yes\
</code></pre> 
<h4><a id="_671"></a>尾随参数</h4> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>form<span class="token punctuation">::</span></span><span class="token class-name">Form</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(FromForm)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'r</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'r</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    active<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/?hello&amp;&lt;id&gt;&amp;&lt;user..&gt;"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">user</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span> user<span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">1337</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"Bob Smith"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>active<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// A request with these query segments matches as above.</span>
hello<span class="token operator">&amp;</span>\
name<span class="token operator">=</span><span class="token class-name">Bob</span><span class="token operator">+</span><span class="token class-name">Smith</span><span class="token operator">&amp;</span>\
id<span class="token operator">=</span><span class="token number">1337</span><span class="token operator">&amp;</span>\
active<span class="token operator">=</span>yes\
</code></pre> 
<h3><a id="_696"></a>错误处理器</h3> 
<p>应用程序处理是不可靠的。错误来自以下来源：</p> 
<ul><li>失败的守卫。</li><li>一个失败的响应者。</li><li>路由失败。</li></ul> 
<p>如果发生任何这些情况，Rocket会向客户端返回一个错误。为了生成错误，Rocket调用<em>捕集器</em> 对应于错误的状态代码和范围。Catchers类似于routes，除了：</p> 
<ol><li>捕获器仅在出现错误时调用。</li><li>捕获器是用<code>catch</code> 属性</li><li>捕手是<em>注册的</em> 与<a href="https://api.rocket.rs/v0.5-rc/rocket/struct.Rocket.html#method.register" rel="nofollow"><code>register()</code></a> 而不是<a href="https://api.rocket.rs/v0.5-rc/rocket/struct.Rocket.html#method.mount" rel="nofollow"><code>mount()</code></a>.</li><li>在调用捕获器之前，清除对cookie的任何修改。</li><li>错误捕获器不能调用防护。</li><li>错误捕获器不应该无法产生响应。</li><li>捕获器的作用域为路径前缀。</li></ol> 
<p>若要声明给定状态代码的捕捉器，请使用<a href="https://api.rocket.rs/v0.5-rc/rocket/attr.catch.html" rel="nofollow"><code>catch</code></a> 属性，该属性接受与要捕获的HTTP状态代码对应的单个整数。例如，为<code>404 Not Found</code> 错误</p> 
<p>例子：</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span>get<span class="token punctuation">,</span> post<span class="token punctuation">,</span> launch<span class="token punctuation">,</span> routes<span class="token punctuation">,</span> catch<span class="token punctuation">,</span> catchers<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>request<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token class-name">Request</span><span class="token punctuation">,</span> <span class="token class-name">FromRequest</span><span class="token punctuation">,</span> <span class="token class-name">Outcome</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>http<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Cookie</span><span class="token punctuation">,</span> <span class="token class-name">CookieJar</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>response<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Flash</span><span class="token punctuation">,</span> <span class="token class-name">Redirect</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>serde<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Serialize</span><span class="token punctuation">,</span> <span class="token class-name">Deserialize</span><span class="token punctuation">,</span> <span class="token namespace">json<span class="token punctuation">::</span></span><span class="token class-name">Json</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">TempFile</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span>tokio<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>data<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Data</span><span class="token punctuation">,</span> <span class="token class-name">ToByteUnit</span><span class="token punctuation">,</span> <span class="token class-name">FromData</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/login"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"login"</span>
<span class="token punctuation">}</span>
<span class="token comment">//404的错误处理器</span>
<span class="token attribute attr-name">#[catch(404)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">not_found</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Error: Not Found"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//构建默认错误处理</span>
<span class="token attribute attr-name">#[catch(default)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">default_catch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Error:Default catch"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token macro property">routes!</span><span class="token punctuation">[</span>login<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token macro property">catchers!</span><span class="token punctuation">[</span>not_found<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">//注册错误处理器</span>
        <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token macro property">catchers!</span><span class="token punctuation">[</span>default_catch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">//注册处理器</span>
<span class="token punctuation">}</span>


</code></pre> 
<h2><a id="Rocket_754"></a>Rocket-响应</h2> 
<p>方法的任何类型的值<a href="https://api.rocket.rs/v0.5-rc/rocket/response/trait.Responder.html" rel="nofollow"><code>Responder</code></a> trait可以被返回，包括你自己的</p> 
<h3><a id="Responder_758"></a>Responder</h3> 
<p>作为Rocket的响应返回，包装我们的消息体数据，一个<code>Response</code> 包括HTTP状态、报头和正文。尸体可能是<em>固定尺寸的</em> 或<em>流</em>.给定的<code>Responder</code> 实现决定使用哪个</p> 
<h3><a id="_762"></a>包装</h3> 
<p>以下是官方提供的已经为我们包装好，可以自己直接调用的：</p> 
<ul><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.Accepted.html" rel="nofollow">Accepted</a></p> <p>Sets the status of the response to 202 (Accepted).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.BadRequest.html" rel="nofollow">BadRequest</a></p> <p>Sets the status of the response to 400 (Bad Request).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.Conflict.html" rel="nofollow">Conflict</a></p> <p>Sets the status of the response to 409 (Conflict).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.Created.html" rel="nofollow">Created</a></p> <p>Sets the status of the response to 201 (Created).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.Custom.html" rel="nofollow">Custom</a></p> <p>Creates a response with the given status code and underlying responder.</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.Forbidden.html" rel="nofollow">Forbidden</a></p> <p>Sets the status of the response to 403 (Forbidden).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.NoContent.html" rel="nofollow">NoContent</a></p> <p>Sets the status of the response to 204 (No Content).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.NotFound.html" rel="nofollow">NotFound</a></p> <p>Sets the status of the response to 404 (Not Found).</p> </li><li> <p><a href="https://api.rocket.rs/v0.5-rc/rocket/response/status/struct.Unauthorized.html" rel="nofollow">Unauthorized</a></p> <p>Sets the status of the response to 401 (Unauthorized).</p> </li></ul> 
<h4><a id="_802"></a>例子</h4> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>http<span class="token punctuation">::</span></span><span class="token class-name">Status</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>response<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span>content<span class="token punctuation">,</span> status<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/test"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Accepted</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Accepted</span><span class="token punctuation">(</span><span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"test-hello"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/custom"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">test_custom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Custom</span><span class="token operator">&lt;</span><span class="token class-name">RawJson</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Custom</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">::</span><span class="token class-name">Accepted</span><span class="token punctuation">,</span> <span class="token class-name">RawJson</span><span class="token punctuation">(</span><span class="token string">"{\"hi\":\"你好\"}"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_820"></a>自定义应答器</h3> 
<p>该<a href="https://api.rocket.rs/v0.5-rc/rocket/response/trait.Responder.html" rel="nofollow"><code>Responder</code></a> trait文档详细说明了如何通过显式实现trait来实现您自己的自定义响应器。然而，对于大多数用例，Rocket使得自动派生的实现成为可能<code>Responder</code>。特别是，如果您的自定义响应程序包装了现有的响应程序、标头或设置了自定义状态或内容类型，<code>Responder</code> 可以自动导出：</p> 
<h4><a id="_824"></a>简单示例</h4> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Responder</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Responder)]</span>
<span class="token attribute attr-name">#[response(status = 200, content_type = <span class="token string">"json"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Response_default</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/json"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Response_default</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Response_default</span><span class="token punctuation">(</span><span class="token string">"{ \"hi\": \"world\" }"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_839"></a>完整示例</h4> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Responder</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug, Deserialize, Serialize)]</span>
<span class="token attribute attr-name">#[serde(crate = <span class="token string">"rocket::serde"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{<!-- --></span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Responder)]</span>
<span class="token attribute attr-name">#[response(status = 200, content_type = <span class="token string">"json"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">MyResponse2</span> <span class="token punctuation">{<!-- --></span>
    inner<span class="token punctuation">:</span> <span class="token class-name">Json</span><span class="token operator">&lt;</span><span class="token class-name">User</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    headers<span class="token punctuation">:</span> <span class="token class-name">ContentType</span><span class="token punctuation">,</span>
    more<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'static</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[response(ignore)]</span>
    unrelated<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/login"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">MyResponse2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">MyResponse2</span> <span class="token punctuation">{<!-- --></span>
        inner<span class="token punctuation">:</span> <span class="token class-name">Json</span><span class="token punctuation">(</span><span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
            username<span class="token punctuation">:</span> <span class="token string">"zhangsan"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            password<span class="token punctuation">:</span> <span class="token string">"123456"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        headers<span class="token punctuation">:</span> <span class="token class-name">ContentType</span><span class="token punctuation">::</span><span class="token constant">JSON</span><span class="token punctuation">,</span>
        more<span class="token punctuation">:</span> <span class="token class-name">Header</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">,</span> <span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        unrelated<span class="token punctuation">:</span> <span class="token string">"test-ignore"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>于上面的示例，Rocket生成一个<code>Responder</code> 实施方式：</p> 
<ul><li>将响应的状态设置为<code>200</code>.</li><li>将Content-Type设置为<code>application/json</code>.</li><li>添加标题<code>self.header</code> 和/或<code>self.more</code> 到回应。</li><li>完成响应，使用<code>self.inner</code>.</li></ul> 
<p>请注意，<em>第一</em> 字段用作内部响应者，而所有剩余字段（除非使用<code>#[response(ignore)]</code>）作为头添加到响应中。可选的<code>#[response]</code> 属性可用于自定义响应的状态和内容类型。因为<code>ContentType</code> 和/或<code>Status</code> 本身是头，您还可以通过简单地包含这些类型的字段来动态设置内容类型和状态。</p> 
<h3><a id="Responder_884"></a>Responder实现</h3> 
<p>在Rocket中已经为：<code>String</code>、<code>&amp;str</code>、<code>File</code>、<code>Option</code>，以及<code>Result</code>.实现好了</p> 
<p>我们可以在应用中直接进行使用</p> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[get(<span class="token string">"/string"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"Hello there! I'm a string!"</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="Option_897"></a>Option</h4> 
<p>成功使用Some则响应为200，若出现错误则是404 Not Found</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">NamedFile</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/&lt;file..&gt;"</span>)]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">files</span><span class="token punctuation">(</span>file<span class="token punctuation">:</span> <span class="token class-name">PathBuf</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">NamedFile</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">NamedFile</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"static/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="Result_912"></a>Result</h4> 
<p>无论成功还是失败都有返回</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">NamedFile</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>response<span class="token punctuation">::</span>status<span class="token punctuation">::</span></span><span class="token class-name">NotFound</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/&lt;file..&gt;"</span>)]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">files</span><span class="token punctuation">(</span>file<span class="token punctuation">:</span> <span class="token class-name">PathBuf</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">NamedFile</span><span class="token punctuation">,</span> <span class="token class-name">NotFound</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token class-name">Path</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"static/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">NamedFile</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">map_err</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>e<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">NotFound</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Json_927"></a>响应Json</h3> 
<p>我们可以直接是使用为我们包装好的<code>Json</code>进行返回</p> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>serde<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Serialize</span><span class="token punctuation">,</span> <span class="token namespace">json<span class="token punctuation">::</span></span><span class="token class-name">Json</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Serialize)]</span>
<span class="token attribute attr-name">#[serde(crate = <span class="token string">"rocket::serde"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Task</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* .. */</span> <span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/todo"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Json</span><span class="token operator">&lt;</span><span class="token class-name">Task</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Json</span><span class="token punctuation">(</span><span class="token class-name">Task</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* .. */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_944"></a>模板</h3> 
<h4><a id="_946"></a>添加依赖</h4> 
<pre><code class="prism language-bash">cargo <span class="token function">add</span> rocket_dyn_templates
</code></pre> 
<h4><a id="Cargotoml_952"></a>修改Cargo.toml</h4> 
<pre><code class="prism language-toml">[dependencies]
rocket_dyn_templates = { version = "0.1.0-rc.3", features = ["handlebars", "tera"] }
</code></pre> 
<h4><a id="mainrs_959"></a>main.rs</h4> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket_dyn_templates<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Template</span><span class="token punctuation">,</span>context<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/index"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span><span class="token class-name">Template</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Template</span><span class="token punctuation">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">,</span><span class="token macro property">context!</span> <span class="token punctuation">{<!-- --></span>
        foo<span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token macro property">routes!</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token class-name">Template</span><span class="token punctuation">::</span><span class="token function">fairing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_980"></a>添加页面模板</h4> 
<p>在templates下创建index.tera，名字对应<code> Template::render('template_name',context!...)</code></p> 
<p><img src="https://images2.imgbox.com/c1/09/HeuapYrM_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-tera">&lt;html&gt;
    &lt;head&gt;&lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;index tera&lt;/h1&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<h2><a id="Rocket_996"></a>Rocket-状态管理</h2> 
<p>在 Rust 的 Rocket 框架中，Managed State（管理状态）是一种在应用程序全局范围内共享数据的机制。它允许您在整个应用程序中存储和检索数据，并从多个处理程序中访问该数据，而不必每次使用时都传递它。</p> 
<p>Managed State 在以下情况下非常有用：</p> 
<ol><li><strong>保存全局配置信息</strong>：如果您需要将某些配置信息在应用程序的多个部分之间共享，那么 Managed State 是很好的选择。例如，您可能需要保存数据库连接字符串或应用程序运行所需的其他配置变量。</li><li><strong>缓存数据</strong>：Managed State 还可以用于存储应用程序中经常使用的数据，以避免反复查询数据库或重复执行昂贵的操作。将这些数据存储在 Managed State 中可以提高应用程序的性能和响应速度。</li><li><strong>跨请求共享数据</strong>：由于 Managed State 存在于整个应用程序生命周期中，因此您可以在多个请求之间共享数据。这使得在不同请求之间共享数据变得更加容易。</li></ol> 
<pre><code class="prism language-rust"><span class="token attribute attr-name">#[derive(Debug,Serialize,Deserialize)]</span>
<span class="token attribute attr-name">#[serde(crate=<span class="token string">"rocket::serde"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">SqlServer</span> <span class="token punctuation">{<!-- --></span>
    uri<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    port<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    password<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    sqlType<span class="token punctuation">:</span> <span class="token constant">SQL</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token attribute attr-name">#[derive(Debug,Serialize,Deserialize)]</span>
<span class="token attribute attr-name">#[serde(crate=<span class="token string">"rocket::serde"</span>)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">SQL</span> <span class="token punctuation">{<!-- --></span>
    <span class="token constant">MYSQL</span><span class="token punctuation">,</span>
    <span class="token constant">ORACLE</span><span class="token punctuation">,</span>
    <span class="token constant">REDIS</span><span class="token punctuation">,</span>
    <span class="token constant">MONGO</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">SqlServer</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new_mysql</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span><span class="token class-name">SqlServer</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SqlServer</span><span class="token punctuation">{<!-- --></span>
            uri<span class="token punctuation">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            port<span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
            username<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            password<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            sqlType<span class="token punctuation">:</span> <span class="token constant">SQL</span><span class="token punctuation">::</span><span class="token constant">MYSQL</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[get(<span class="token string">"/state"</span>)]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">getState</span><span class="token punctuation">(</span>sql_server_data<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">State</span><span class="token operator">&lt;</span><span class="token class-name">SqlServer</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Json</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token class-name">SqlServer</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> tmp <span class="token operator">=</span> sql_server_data<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Json</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token class-name">SqlServer</span><span class="token punctuation">::</span><span class="token function">new_mysql</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token macro property">routes!</span><span class="token punctuation">[</span>getState<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="RocketMysql_1052"></a>Rocket-连接池连接数据库Mysql</h2> 
<h3><a id="_1054"></a>添加依赖</h3> 
<pre><code class="prism language-toml">rocket_db_pools = {version ="0.1.0-rc.3",features = ["sqlx_mysql"]}
</code></pre> 
<h3><a id="Rockettoml_1060"></a>设置数据库连接配置(Rocket.toml)</h3> 
<pre><code class="prism language-toml">[default.databases.mysql_db]
url="mysql://username:password@localhost:3306/数据库名称?ssl-mode=disabled"

#以下都是可以配置的
min_connections = 64
max_connections = 1024
connect_timeout = 5
idle_timeout = 120
</code></pre> 
<h3><a id="mainrs_1073"></a>main.rs</h3> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span>launch<span class="token punctuation">,</span> get<span class="token punctuation">,</span> post<span class="token punctuation">,</span> <span class="token class-name">State</span><span class="token punctuation">,</span> routes<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>serde<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token namespace">json<span class="token punctuation">::</span></span><span class="token class-name">Json</span><span class="token punctuation">,</span> <span class="token class-name">Serialize</span><span class="token punctuation">,</span> <span class="token class-name">Deserialize</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket_db_pools<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Connection</span><span class="token punctuation">,</span> <span class="token class-name">Database</span><span class="token punctuation">,</span> <span class="token class-name">Pool</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket_db_pools<span class="token punctuation">::</span>sqlx<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">MySqlPool</span><span class="token punctuation">,</span> query<span class="token punctuation">,</span> <span class="token class-name">Row</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket_db_pools<span class="token punctuation">::</span>sqlx<span class="token punctuation">::</span>mysql<span class="token punctuation">::</span></span><span class="token class-name">MySqlRow</span><span class="token punctuation">;</span>


<span class="token attribute attr-name">#[derive(Database)]</span>
<span class="token attribute attr-name">#[database(<span class="token string">"mysql_db"</span>)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">MysqlDB</span><span class="token punctuation">(</span><span class="token class-name">MySqlPool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token attribute attr-name">#[get(<span class="token string">"/mysql"</span>)]</span>
<span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">connect_mysql</span><span class="token punctuation">(</span><span class="token keyword">mut</span> connect<span class="token punctuation">:</span> <span class="token class-name">Connection</span><span class="token operator">&lt;</span><span class="token class-name">MysqlDB</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM rolelist"</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> rows<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">MySqlRow</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">fetch_all</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token operator">*</span>connect<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> row <span class="token keyword">in</span> rows<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> id<span class="token punctuation">:</span><span class="token keyword">i32</span> <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> name<span class="token punctuation">:</span><span class="token class-name">String</span> <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"id:{}"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"role_name{}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"testOK"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token macro property">routes!</span><span class="token punctuation">[</span>connect_mysql<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token class-name">MysqlDB</span><span class="token punctuation">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="Figment_1113"></a>使用Figment提取自定义配置</h2> 
<h3><a id="_1115"></a>添加依赖</h3> 
<pre><code>figment = "0.10.8"
</code></pre> 
<h3><a id="apptoml_1121"></a>设置app.toml</h3> 
<pre><code class="prism language-toml">app_name="test-rocket"
</code></pre> 
<h3><a id="mainrs_1127"></a>main.rs</h3> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span>serde<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Serialize</span><span class="token punctuation">,</span> <span class="token class-name">Deserialize</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">State</span><span class="token punctuation">,</span> <span class="token namespace">fairing<span class="token punctuation">::</span></span><span class="token class-name">AdHoc</span><span class="token punctuation">,</span>launch<span class="token punctuation">,</span>get<span class="token punctuation">,</span>routes<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">figment<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Figment</span><span class="token punctuation">,</span> <span class="token class-name">Profile</span><span class="token punctuation">,</span> <span class="token namespace">providers<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">Format</span><span class="token punctuation">,</span> <span class="token class-name">Toml</span><span class="token punctuation">,</span> <span class="token class-name">Serialized</span><span class="token punctuation">,</span> <span class="token class-name">Env</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token attribute attr-name">#[launch]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">rocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> _ <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token class-name">Figment</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token class-name">Toml</span><span class="token punctuation">::</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"app.toml"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">"rocket"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> app_name <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">extract_inner</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">"app_name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>app_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token namespace">rocket<span class="token punctuation">::</span></span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token macro property">routes!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1fb7b57e1ece16e47089fe00a24ebf49/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Docker】Nacos2.0.3的配置部署与基于SpringBoot3.0.5的代码基础配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f55d1a5022d848af431eb5591bfde10c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringCloudStream集成RabbitMQ实现消息收发</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>