<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 7 部署 ZeroTier Moon 节点 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 7 部署 ZeroTier Moon 节点" />
<meta property="og:description" content="ZeroTier是一套使用UDP协议构建的SD-WAN网络软件，其主要有三部分组成：行星服务器Planet、月亮服务器Moon、客户端节点Leaf，行星服务器是ZeroTier的根节点，可以采用ZeroTier官方的服务器，也可以使用开源代码自行搭建。
月亮服务器介于行星与客户端之间，官方行星都在国外，因此可以就近公网搭建月亮服务器，客户端可以优先使用延迟更低的月亮节点进行P2P打洞或者网络中转。
客户端节点既可以安装在客户端进行远程网络接入，也可以部署后开启路由转发功能，配置静态路由后实现两个网络组网
本例是在阿里云上面操作的：IP：114.55.84.170
一、Moon节点服务器安装
1、安装
curl -s https://install.zerotier.com/ | sudo bash 2、启动
systemctl start zerotier-one systemctl enable zerotier-one 3、加入网络
zerotier-cli join 363c67c55a92a902 4、ZeroTier 官网勾选 Auth
5、生成节点配置
cd /var/lib/zerotier-one/ zerotier-idtool initmoon identity.public &gt; moon.json 6、编辑
vim moon.json # 修改 &#34;stableEndpoints&#34;: [&#34;114.55.84.170/9993&#34;] 7、生成签名，成功后会出现一个 000000b8cdf1fe5d.moon 文件，这个文件名前6位0是固定的，后面b8cdf1fe5d其实就是官网上面设备ID
zerotier-idtool genmoon moon.json 8、 配置 moons.d 目录
mkdir moons.d mv 000000b8cdf1fe5d.moon moons.d/ 9、重启
systemctl restart zerotier-one 10、阿里云放行 UDP 9993
二、Windows 客户端
1、打开命令行运行，其中的 b8cdf1fe5d 就是上面的ID值
zerotier-cli orbit b8cdf1fe5d b8cdf1fe5d # 显示 200 orbit OK 2、重启 Zerotier" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/87f220b40cc93e1c6d583a39f309246d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-31T09:01:56+08:00" />
<meta property="article:modified_time" content="2024-01-31T09:01:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 7 部署 ZeroTier Moon 节点</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>ZeroTier是一套使用UDP协议构建的SD-WAN网络软件，其主要有三部分组成：行星服务器Planet、月亮服务器Moon、客户端节点Leaf，行星服务器是ZeroTier的根节点，可以采用ZeroTier官方的服务器，也可以使用开源代码自行搭建。</p> 
<p>月亮服务器介于行星与客户端之间，官方行星都在国外，因此可以就近公网搭建月亮服务器，客户端可以优先使用延迟更低的月亮节点进行P2P打洞或者网络中转。</p> 
<p>客户端节点既可以安装在客户端进行远程网络接入，也可以部署后开启路由转发功能，配置静态路由后实现两个网络组网</p> 
<p>本例是在阿里云上面操作的：IP：114.55.84.170</p> 
<p>一、Moon节点服务器安装</p> 
<p>1、安装</p> 
<pre><code>curl -s https://install.zerotier.com/ | sudo bash</code></pre> 
<p>2、启动</p> 
<pre><code>systemctl start zerotier-one
systemctl enable zerotier-one</code></pre> 
<p>3、加入网络</p> 
<pre><code>zerotier-cli join 363c67c55a92a902</code></pre> 
<p>4、ZeroTier 官网勾选 Auth</p> 
<p><img alt="" height="92" src="https://images2.imgbox.com/11/ef/76Yzemp4_o.png" width="703"></p> 
<p>5、生成节点配置</p> 
<pre><code>cd /var/lib/zerotier-one/
zerotier-idtool initmoon identity.public &gt; moon.json
</code></pre> 
<p>6、编辑</p> 
<pre><code>vim moon.json


# 修改

"stableEndpoints": ["114.55.84.170/9993"]</code></pre> 
<p>7、生成签名，成功后会出现一个 000000b8cdf1fe5d.moon 文件，这个文件名前6位0是固定的，后面b8cdf1fe5d其实就是官网上面设备ID</p> 
<pre><code>zerotier-idtool genmoon moon.json</code></pre> 
<p>8、 配置 moons.d 目录</p> 
<pre><code>mkdir moons.d
mv 000000b8cdf1fe5d.moon moons.d/</code></pre> 
<p>9、重启</p> 
<pre><code>systemctl restart zerotier-one</code></pre> 
<p>10、阿里云放行 UDP 9993</p> 
<p><img alt="" height="401" src="https://images2.imgbox.com/74/07/P8QGBV1P_o.png" width="943"></p> 
<p>二、Windows 客户端</p> 
<p> 1、打开命令行运行，其中的 b8cdf1fe5d 就是上面的ID值</p> 
<pre><code>zerotier-cli orbit b8cdf1fe5d b8cdf1fe5d

# 显示
200 orbit OK</code></pre> 
<p>2、重启 Zerotier</p> 
<p><img alt="" height="589" src="https://images2.imgbox.com/c9/d4/KdrcH3FV_o.png" width="869"></p> 
<p> 2、查看</p> 
<pre><code>zerotier-cli listpeers

# 输出
200 listpeers &lt;ztaddr&gt; &lt;path&gt; &lt;latency&gt; &lt;version&gt; &lt;role&gt;
200 listpeers 1c08211b95 120.204.172.145/37242;13402;13402 124 1.10.2 LEAF
200 listpeers 363c67c55a 35.209.66.142/21043;4594;4594 376 1.12.2 LEAF
200 listpeers 622b9fd914 - -1 - LEAF
200 listpeers 62f865ae71 50.7.252.138/9993;36124;125996 -406 - PLANET
200 listpeers 778cde7190 103.195.103.66/9993;36124;125120 470 - PLANET
200 listpeers b8cdf1fe5d 114.55.84.170/9993;4186;4156 32 1.12.2 MOON    # 成功显示
200 listpeers cafe04eba9 84.17.53.155/9993;36124;842 391 - PLANET
200 listpeers cafe9efeb9 104.194.8.134/9993;36124;19434 -500 - PLANET
200 listpeers ea298ccce2 61.218.44.107/63384;19372;19372 94 1.12.2 LEAF</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5e2faf4d7d1ae29685e441108b708884/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Compose | UI组件(十二) | Lazy Layout - 列表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0155adb23462d40a2a1f9e857a530291/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git分布式版本控制系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>