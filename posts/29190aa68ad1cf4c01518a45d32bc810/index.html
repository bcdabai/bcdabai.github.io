<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java使用JaxWsDynamicClientFactory和HttpURLConnection两种方式调取webservice的接口 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Java使用JaxWsDynamicClientFactory和HttpURLConnection两种方式调取webservice的接口" />
<meta property="og:description" content="方式1.代理类工厂的方式,需要拿到对方的接口 try {
// 接口地址
// 代理工厂
JaxWsProxyFactoryBean jaxWsProxyFactoryBean = new JaxWsProxyFactoryBean();
// 设置代理地址 wsdlAddress: WSDL地址（http://localhost:8082/ws/services/bank?wsdl）
jaxWsProxyFactoryBean.setAddress(wsdlAddress); // 设置接口类型
jaxWsProxyFactoryBean.setServiceClass(ICommonService.class);
// 创建一个代理接口实现
ICommonService cs = (ICommonService) jaxWsProxyFactoryBean.create();
// 数据准备
String userName = &#34;Leftso&#34;;
// 调用代理接口的方法调用并返回结果
String result = cs.sayHello(userName);
System.out.println(&#34;返回结果:&#34; &#43; result);
} catch (Exception e) {
e.printStackTrace();
} 方式2. 动态调用方式 //WSDL路径 String wsUrl = &#34;http://localhost:8082/ws/services/bank?wsdl&#34; ; //方法名 String method = &#34;getCaseProve&#34;; JaxWsDynamicClientFactory factory = JaxWsDynamicClientFactory.newInstance(); Client client = factory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/29190aa68ad1cf4c01518a45d32bc810/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-30T14:00:00+08:00" />
<meta property="article:modified_time" content="2018-11-30T14:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java使用JaxWsDynamicClientFactory和HttpURLConnection两种方式调取webservice的接口</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <div class="cnblogs_code"> 
  <pre><span style="font-size:18pt;">方式1.代理类工厂的方式,需要拿到对方的接口</span></pre> 
  <pre>try {<!-- --><br>    // 接口地址<br>    // 代理工厂<br>    JaxWsProxyFactoryBean jaxWsProxyFactoryBean = new JaxWsProxyFactoryBean();<br>    // 设置代理地址 wsdlAddress: WSDL地址（http://localhost:8082/ws/services/bank?wsdl）<br>    jaxWsProxyFactoryBean.setAddress(wsdlAddress);</pre> 
  <pre><em id="__mceDel">    // 设置接口类型<br>    jaxWsProxyFactoryBean.setServiceClass(ICommonService.class);<br>    // 创建一个代理接口实现<br>    ICommonService cs = (ICommonService) jaxWsProxyFactoryBean.create();<br>    // 数据准备<br>    String userName = "Leftso";<br>    // 调用代理接口的方法调用并返回结果<br>    String result = cs.sayHello(userName);<br>    System.out.println("返回结果:" + result);<br>} catch (Exception e) {<!-- --><br>    e.printStackTrace();<br>}</em></pre> 
  <pre><span style="font-size:18pt;">方式2. 动态调用方式</span></pre> 
  <pre>　　//WSDL路径 <br>　　String wsUrl = "http://localhost:8082/ws/services/bank?wsdl"<span style="color:#000000;">  ;  
   //方法名 <br>   String method </span>= "getCaseProve"<span style="color:#000000;">; 
    
    JaxWsDynamicClientFactory factory </span>=<span style="color:#000000;"> JaxWsDynamicClientFactory.newInstance();
    Client client </span>=<span style="color:#000000;"> factory.createClient(wsUrl);
    Endpoint endpoint </span>=<span style="color:#000000;"> client.getEndpoint();
    QName opName </span>= <span style="color:#0000ff;">new</span><span style="color:#000000;"> QName(endpoint.getService().getName().getNamespaceURI(), method);
    BindingInfo bindingInfo </span>=<span style="color:#000000;"> endpoint.getEndpointInfo().getBinding();
   System.out.println(client);
    </span><span style="color:#0000ff;">if</span> (bindingInfo.getOperation(opName) == <span style="color:#0000ff;">null</span><span style="color:#000000;">) {
      </span><span style="color:#0000ff;">for</span><span style="color:#000000;"> (BindingOperationInfo operationInfo : bindingInfo.getOperations()) {
        </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (method.equals(operationInfo.getName().getLocalPart())) {
          opName </span>=<span style="color:#000000;"> operationInfo.getName();
          </span><span style="color:#0000ff;">break</span><span style="color:#000000;">;
        }
      }
    }<br>　　//请求报文
　　String xmlInput</span>= "&lt;Request RequestType=\"RegInfo\"&gt;&lt;MachineInfo MachineAccount=\"1\" MachinePassword=\"1\"&gt;&lt;/MachineInfo&gt;&lt;FiterInfo UnitNo=\""
          +<span style="color:#000000;"> unit
          </span>+ "\" HouseID=\""
          +<span style="color:#000000;"> houseId
          </span>+ "\" RecHouseNum=\""
          + recHouseNum + "\"&gt;&lt;/FiterInfo&gt;&lt;/Request&gt;"<span style="color:#000000;">;
　　Object[] res </span>= <span style="color:#0000ff;">null</span><span style="color:#000000;">;     
   </span><span style="color:#0000ff;">try</span><span style="color:#000000;"> { 
     res </span>=<span style="color:#000000;"> client.invoke(opName, xmlInput);  
     String xml </span>= (String) res[0<span style="color:#000000;">];
     System.err.println(</span>"@@@@@@@@@@@@@@@@@"+<span style="color:#000000;">xml);
   } </span><span style="color:#0000ff;">catch</span><span style="color:#000000;"> (Exception e) {     
     e.printStackTrace();     
   }<br>方式2所需jar  百度云盘<br></span></pre> 
  <p>　　链接：https://pan.baidu.com/s/15UjnqWU3J6Sx6CibizyqFw <br>　　提取码：yjfl </p> 
  <pre><span style="color:#000000;"> </span></pre> 
 </div> 
 <p> <span style="font-size:18pt;font-family:'Courier New';">方式3. </span><span style="font-family:'Courier New';"><span style="font-size:24px;">HttpURLConnection</span></span><span style="font-family:'Courier New';font-size:18pt;">调用方式</span></p> 
 <div class="cnblogs_code"> 
  <pre><span style="color:#000000;">第一步（读取配置文件）：
</span><span style="color:#0000ff;">public</span> <span style="color:#0000ff;">class</span><span style="color:#000000;"> PropertiesUtil {
    </span><span style="color:#0000ff;">private</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">final</span> Logger logger =<span style="color:#000000;"> LoggerFactory
            .getLogger(PropertiesUtil.</span><span style="color:#0000ff;">class</span><span style="color:#000000;">);
    </span><span style="color:#0000ff;">private</span> <span style="color:#0000ff;">static</span> Properties properties = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
    </span><span style="color:#0000ff;">private</span> <span style="color:#0000ff;">static</span> String fileName = "/app.properties"<span style="color:#000000;">;
    </span><span style="color:#0000ff;">static</span><span style="color:#000000;"> {
        properties </span>= <span style="color:#0000ff;">new</span><span style="color:#000000;"> Properties();
        </span><span style="color:#0000ff;">try</span><span style="color:#000000;"> {
            properties.load(PropertiesUtil.</span><span style="color:#0000ff;">class</span><span style="color:#000000;">.getResourceAsStream(fileName));
        } </span><span style="color:#0000ff;">catch</span><span style="color:#000000;"> (IOException e) {
            logger.error(</span>"加载配置文件失败"<span style="color:#000000;">, e);
        }
    }

    </span><span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span><span style="color:#000000;"> Properties getProperties() {
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> properties;
    }

    </span><span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span><span style="color:#000000;"> String getProp(String propName) {
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> properties.getProperty(propName);
    }
}<br><br><br></span></pre> 
 </div> 
 <div class="cnblogs_code"> 
  <pre><span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> Map&lt;String, String&gt;<span style="color:#000000;"> resultInterface(String id,String type, String jsonStr) {
    StringBuilder res </span>= <span style="color:#0000ff;">new</span><span style="color:#000000;"> StringBuilder();
    </span><span style="color:#008000;">//</span><span style="color:#008000;"> 1：创建服务地址</span>
<span style="color:#000000;">    URL url;
    String resultUserName </span>= PropertiesUtil.getProp("resultUserName"<span style="color:#000000;">);
    String resultPassWord </span>= PropertiesUtil.getProp("resultPassWord"<span style="color:#000000;">);
    Map</span>&lt;String, String&gt; map = <span style="color:#0000ff;">new</span> HashMap&lt;String, String&gt;<span style="color:#000000;">();
    </span><span style="color:#0000ff;">try</span><span style="color:#000000;"> {
      url </span>= <span style="color:#0000ff;">new</span> URL(PropertiesUtil.getProp("resultUrl"<span style="color:#000000;">));
      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 2：打开到服务地址的一个连接</span>
      HttpURLConnection connection =<span style="color:#000000;"> (HttpURLConnection) url.openConnection();
      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 3：设置连接参数
      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 3.1设置发送方式：POST必须大写</span>
      connection.setRequestMethod("POST"<span style="color:#000000;">);
      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 3.2设置数据格式：Content-type</span>
      connection.setRequestProperty("content-type", "text/xml;charset=utf-8"<span style="color:#000000;">);
      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 3.3设置输入输出，新创建的connection默认是没有读写权限的，</span>
      connection.setDoInput(<span style="color:#0000ff;">true</span><span style="color:#000000;">);
      connection.setDoOutput(</span><span style="color:#0000ff;">true</span><span style="color:#000000;">);
      </span><span style="color:#008000;">//</span><span style="color:#008000;">"{\"ANNOUNCEMENT_CODE\": \"CSGGBH001\",\"ANNOUNCEMENT_CONNECT\": \"asdfasdfasdfasdfasdfasdfasdfsa\",\"ANNOUNCEMENT_DEADLINE\": \"20181031\",\"ANNOUNCEMENT_GUID\": \"71F15848-C296-4A60-883C-223C55E9E8D8\",\"ANNOUNCEMENT_START_TIME\": \"20181101\",\"ANNOUNCEMENT_TITLE\": \"公告标题\",\"ANNOUNCEMENT_TYPE\": \"1\",\"ANNOUNCEMENT_UNIT\": \"单位\",\"ATTACHMENT_SET_CODE\": \"123\",\"CANCEL_REASON\": \"撤销理由\",\"CHANGE_TIME\": \"20181101\",\"CONTACT_NUMBER\": \"13333333333\",\"CONTACT_PERSON\": \"联系人\",\"CREATE_TIME\": \"20181101\",\"DATA_TIMESTAMP\": \"20181101154911\",\"EMAIL\": \"123@qq.com\",\"END_DATE\": \"20181101\",\"FIELD_NUM\": \"123\",\"LAND_DISTRICT\": \"440601\",\"LIAISON_UNIT\": \"单位\",\"LISTING_DEADLINE\": \"\",\"LISTING_START_TIME\": \"\",\"LISTING_TYPE\": \"0\",\"PLATFORM_CODE\": \"91441900708017879M\",\"PUBLISHING_TIME\": \"20181101\",\"PUB_SERVICE_PLAT_CODE\": \"123707003283632515\",\"RETREAT_TIME\": \"20181101\",\"SUPPLY_TYPE\": \"1\",\"UNIFIED_DEAL_CODE\": \"B01-123707003283632515-20181025-000015-V\",\"UNIT_ADDRESS\": \"单位地址\",\"URL\": \"</span><span style="color:#008000;text-decoration:underline;">http://www.baidu.com</span><span style="color:#008000;">\",\"ZIP_CODE\": \"215600\"}";
      </span><span style="color:#008000;">//</span><span style="color:#008000;">TDJYGG
      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 4：组织SOAP协议数据，发送给服务端</span>
      String soapXML = "&lt;soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\"&gt;"
          + "       &lt;soap12:Header&gt;                           "
          + "         &lt;root xmlns=\"http://tempuri.org/\"&gt;      "
          + "           &lt;UserName&gt;"+resultUserName+"&lt;/UserName&gt;           "
          + "           &lt;PassWord&gt;"+resultPassWord+"&lt;/PassWord&gt;           "
          + "         &lt;/root&gt;                                 "
          + "       &lt;/soap12:Header&gt;                          "
          + "       &lt;soap12:Body&gt;                             "
          + "         &lt;Push xmlns=\"http://tempuri.org/\"&gt;      "
          + "           &lt;Type&gt;"+type+"&lt;/Type&gt;                   "
          + "           &lt;JsonStr&gt;"+jsonStr+"&lt;/JsonStr&gt;"
          + "         &lt;/Push&gt;                                 "
          + "       &lt;/soap12:Body&gt;                            "
          + "     &lt;/soap12:Envelope&gt;"<span style="color:#000000;">;
      OutputStream os </span>=<span style="color:#000000;"> connection.getOutputStream();
      os.write(soapXML.getBytes(</span>"utf-8"<span style="color:#000000;">));

      </span><span style="color:#008000;">//</span><span style="color:#008000;"> 5：接收服务端的响应</span>
      <span style="color:#0000ff;">int</span> responseCode =<span style="color:#000000;"> connection.getResponseCode();
      </span><span style="color:#0000ff;">if</span> (200 == responseCode) {<!-- --><span style="color:#008000;">//</span><span style="color:#008000;"> 表示服务端响应成功</span>
        InputStream is =<span style="color:#000000;"> connection.getInputStream();
        InputStreamReader isr </span>= <span style="color:#0000ff;">new</span> InputStreamReader(is,"utf-8"<span style="color:#000000;">);
        BufferedReader br </span>= <span style="color:#0000ff;">new</span><span style="color:#000000;"> BufferedReader(isr);
        String temp </span>= <span style="color:#0000ff;">null</span><span style="color:#000000;">;
        </span><span style="color:#0000ff;">while</span> (<span style="color:#0000ff;">null</span> != (temp =<span style="color:#000000;"> br.readLine())) {
          res.append(temp);
        }
        
        is.close();
        isr.close();
        br.close();
        String xml </span>=<span style="color:#000000;"> res.toString();
        Document doc </span>= DocumentHelper.parseText(xml); <span style="color:#008000;">//</span><span style="color:#008000;"> 将字符串转为XML</span>
        Element rootElt = doc.getRootElement(); <span style="color:#008000;">//</span><span style="color:#008000;"> 获取根节点
        </span><span style="color:#008000;">//</span><span style="color:#008000;">System.out.println("根节点：" + rootElt.getStringValue()); </span>
<span style="color:#000000;">        
        Element nameElem </span>= rootElt.element("Body").element("PushResponse").element("PushResult"<span style="color:#000000;">);
        String code </span>= nameElem.element("Code"<span style="color:#000000;">).getTextTrim();
        String description </span>= nameElem.element("Description"<span style="color:#000000;">).getTextTrim();
        map.put(</span>"code"<span style="color:#000000;">, code);
        map.put(</span>"description"<span style="color:#000000;">, description);
      } </span><span style="color:#0000ff;">else</span><span style="color:#000000;"> {
        </span><span style="color:#008000;">//</span><span style="color:#008000;">res.append("调接口异常!");</span>
        map.put("code", "500"<span style="color:#000000;">);
        map.put(</span>"description", "数据推送失败,服务端响应失败!"<span style="color:#000000;">);
        logger.error(</span>"数据推送失败,服务端响应失败!"<span style="color:#000000;">);
      }
      os.close();
    } </span><span style="color:#0000ff;">catch</span><span style="color:#000000;"> (Exception e) {
      </span><span style="color:#008000;">//</span><span style="color:#008000;">res.append("调接口异常!");</span>
      map.put("code", "500"<span style="color:#000000;">);
      map.put(</span>"description", "数据推送异常,推送信息为trans_notice表或trans_target表的id&gt;&gt;&gt;&gt;:" +<span style="color:#000000;"> id);
      logger.error(</span>"数据推送异常,推送信息为trans_notice表或trans_target表的id&gt;&gt;&gt;&gt;:" + id + ""<span style="color:#000000;">, e);
    }
    
    </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> map;
  }</span></pre> 
 </div> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/gaomanito/p/10043753.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8faad3c8bde09ec71ca00f0b07c44b3e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">腾讯企业邮发送邮件Error: need EHLO and AUTH first !</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc8ab9c8f8174c870b031575ec34706a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">3.2快速傅里叶变换的FPGA实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>