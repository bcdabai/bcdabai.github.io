<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用 TypeScript &#43; React &#43; Redux 进行项目开发（入门篇，附源码） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用 TypeScript &#43; React &#43; Redux 进行项目开发（入门篇，附源码）" />
<meta property="og:description" content="本文详细介绍了如何使用 Create-React-App 编写 TypeScript &#43; React 项目
前言 对于 TypeScript &#43; React 开发，MicroSoft 编写了一个 TypeScript-React-Starter 的例子，Github 地址。有需要的朋友可以去看一下。
我自己也看了一下，文档说明讲解的很好，但是 Demo 拉下来却无法正常运行，一直报错。所以我自己使用 TypeScript &#43; React &#43; Redux 写了 Demo，作为范例来用一下。
本文 Demo 地址 本文 Counter Demo 是一个简易的例子，可以用来作为入门参考，Counter Demo
另外还写了一个 TodoList 的例子，稍微更有难度一些，代码量和组件更多更详细。有需要的朋友也可以参考一下。TodoList Demo
建议 可以先下载 Counter Demo 后，运行项目，查看运行效果，然后对照本文进行阅读，效果更佳！
使用 TypeScript 编写 React 需要注意的规范 必须遵守的要求：
所有用到 jsx 语法的文件都需要以 tsx 后缀命名使用组件声明时的 Component&lt;P, S&gt; 泛型参数声明，来代替 PropTypes进行类型校验 额外的代码规范：
全局变量或者自定义的 window 对象属性，统一在项目根下的 global.d.ts 中进行声明定义对于项目中常用到的接口数据对象，最好在 types/ 目录下定义好其结构化类型声明 安装 Create-React-App $ npm install create-react-app -g 复制代码 创建项目 先创建一个新的项目，这里我们命名为 typescript-react-app $ create-react-app typescript-react-app --scripts-version=react-scripts-ts 复制代码 react-scripts-ts是一系列适配器，它利用标准的create-react-app工程管道并把TypeScript混入进来。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3170cf8a31d983cb035bba556058441f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-08T02:29:47+08:00" />
<meta property="article:modified_time" content="2019-03-08T02:29:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用 TypeScript &#43; React &#43; Redux 进行项目开发（入门篇，附源码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="article-content"> 
 <p>本文详细介绍了如何使用 Create-React-App 编写 TypeScript + React 项目</p> 
 <h3 class="heading">前言</h3> 
 <p>对于 TypeScript + React 开发，MicroSoft 编写了一个 TypeScript-React-Starter 的例子，<a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2FMicrosoft%2FTypeScript-Node-Starter" rel="nofollow">Github 地址</a>。有需要的朋友可以去看一下。</p> 
 <p>我自己也看了一下，文档说明讲解的很好，但是 Demo 拉下来却无法正常运行，一直报错。所以我自己使用 TypeScript + React + Redux 写了 Demo，作为范例来用一下。</p> 
 <h4 class="heading">本文 Demo 地址</h4> 
 <ul><li> <p>本文 Counter Demo 是一个简易的例子，可以用来作为入门参考，<strong><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fbeichensky%2Ftypescript-react-example%2Ftree%2Fmaster%2Ftypescript-react-app" rel="nofollow">Counter Demo</a></strong></p> </li><li> <p>另外还写了一个 TodoList 的例子，稍微更有难度一些，代码量和组件更多更详细。有需要的朋友也可以参考一下。<strong><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fbeichensky%2Ftypescript-react-example%2Ftree%2Fmaster%2Ftypescript-react-todos" rel="nofollow">TodoList Demo</a></strong></p> </li></ul> 
 <h4 class="heading">建议</h4> 
 <p>可以先下载 Counter Demo 后，运行项目，查看运行效果，然后对照本文进行阅读，效果更佳！</p> 
 <h4 class="heading">使用 <code>TypeScript</code> 编写 <code>React</code> 需要注意的规范</h4> 
 <ul><li> <p>必须遵守的要求：</p> 
   <ul><li>所有用到 <code>jsx</code> 语法的文件都需要以 <code>tsx</code> 后缀命名</li><li>使用组件声明时的 <code>Component&lt;P, S&gt;</code> 泛型参数声明，来代替 <code>PropTypes</code>进行类型校验</li></ul></li><li> <p>额外的代码规范：</p> 
   <ul><li>全局变量或者自定义的 <code>window</code> 对象属性，统一在项目根下的 <code>global.d.ts</code> 中进行声明定义</li><li>对于项目中常用到的接口数据对象，最好在 <code>types/</code> 目录下定义好其结构化类型声明</li></ul></li></ul> 
 <hr> 
 <h3 class="heading">安装 Create-React-App</h3> 
 <pre><code class="hljs bash copyable">$ npm install create-react-app -g
<span class="copy-code-btn">复制代码</span></code></pre> 
 <hr> 
 <h3 class="heading">创建项目</h3> 
 <h4 class="heading">先创建一个新的项目，这里我们命名为 typescript-react-app</h4> 
 <pre><code class="hljs bash copyable">$ create-react-app typescript-react-app --scripts-version=react-scripts-ts
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Freact-scripts-ts" rel="nofollow">react-scripts-ts</a>是一系列适配器，它利用标准的create-react-app工程管道并把TypeScript混入进来。</p> 
 <p>项目创建成功后，此时项目结构如下所示：</p> 
 <pre><code class="hljs bash copyable">my-app/
├─ node_modules/
├─ public/
├─ src/
│  └─ ...
├─ .gitignore
├─ images.d.ts
├─ package.json
├─ README.md
├─ tsconfig.json
├─ tsconfig.prod.json
├─ tsconfig.test.json
├─ tslint.json
└─ yarn.lock
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h4 class="heading">注意：</h4> 
 <ul><li>tsconfig.json包含了工程里TypeScript特定的选项。</li><li>tslint.json保存了要使用的代码检查器的设置，TSLint。</li><li>package.json包含了依赖，还有一些命令的快捷方式，如测试命令，预览命令和发布应用的命令。</li><li>public包含了静态资源如HTML页面或图片。除了index.html文件外，其它的文件都可以删除。</li><li>src包含了TypeScript和CSS源码。index.tsx是强制使用的入口文件。</li></ul> 
 <h4 class="heading">运行项目</h4> 
 <p>先运行项目，看看是否能够正常启动，如果可以，说明项目创建没有问题。 运行命令：</p> 
 <pre><code class="hljs bash copyable">$ npm run start

<span class="hljs-comment"># 或者运行 yarn run start</span>
<span class="copy-code-btn">复制代码</span></code></pre> 
 <hr> 
 <h3 class="heading">React 配合 TypeScript 的基本使用</h3> 
 <p>在当前项目中，可以看到 index.tsx 和 App.jsx 文件中已经使用了 TypeScript，我们现在自己来用 TypeScript 编写一个 React 组件吧。</p> 
 <h4 class="heading">定义一个 Counter 组件</h4> 
 <p>我们在 src 下创建一个 components 目录，新增 Counter 组件：</p> 
 <p>Counter.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">import * as React from 'react';


// 创建类型接口
export interface Iprops {
    value: number
}

// 使用接口代替 PropTypes 进行类型校验
const Counter = ({ value }: Iprops) =&gt; {
    return &lt;p&gt;Clicked: { value } times&lt;/p&gt;
}

export default Counter;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h4 class="heading">在 App.tsx 中引用 Counter 组件并展示</h4> 
 <pre><code class="hljs tsx copyable" lang="tsx">import * as React from 'react';
import './App.css';

import Counter from './components/Counter.jsx';
// import logo from './logo.svg';

class App extends React.Component {
  public render() {
    return (
      &lt;div className="App"&gt;
        &lt;Counter value={ 0 } /&gt;
      &lt;/div&gt;
    );
  }
}

export default App;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>运行项目：<code>npm run start</code>，可以看到浏览器中展示出了 <code>Clicked: 0 times</code>，说明我们第一个 Counter 组件已经编写并使用成功了。</p> 
 <h4 class="heading">使用类的方式定义 Counter 组件</h4> 
 <p>刚才是使用函数组件的方式定义的 Counter 组件，现在我们使用类的方式来改写一下。两种方式都试一试：</p> 
 <p>Counter.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">import * as React from 'react';


// 创建类型接口
export interface IProps {
    value: number
}

// 使用接口代替 PropTypes 进行类型校验
export default class Counter extends React.PureComponent&lt;IProps&gt; {
    public render() {
        return &lt;p&gt;Clicked: { this.props.value } times&lt;/p&gt;
    }
}
<span class="copy-code-btn">复制代码</span></code></pre> 
 <hr> 
 <h3 class="heading">进阶：在项目中配合 Redux 进行使用</h3> 
 <h4 class="heading">安装项目需要的插件</h4> 
 <p>安装redux和react-redux以及它们的类型文件做为依赖。</p> 
 <pre><code class="hljs bash copyable">$ npm install -S redux react-redux @types/react-redux
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>这里我们不需要安装@types/redux，因为Redux已经自带了声明文件（.d.ts文件）。</p> 
 <h4 class="heading">定义应用的状态 State</h4> 
 <p>一般会将常用的结构类型存放到 /types 目录下。所以我们在 src 目录下新建 types 目录。 此时项目中只有一个 state，就是 Counter 中的点击次数，所以就没有使用借口来作为约束，而是直接使用了 type。</p> 
 <p>type/index.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">// 定义 State 结构类型
export type StoreState = number;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h4 class="heading">添加 actions</h4> 
 <p>在 src 下创建 constants 目录，在 index.tsx 文件中添加需要响应的消息类型</p> 
 <p>constants/index.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">// 定义增加 state 类型常量
export const INCREMENT = "INCREMENT";
export type INCREMENT = typeof INCREMENT;

// 定义减少 state 类型常量
export const DECREMENT = "DECREMENT";
export type DECREMENT = typeof DECREMENT;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>这里的const/type模式允许我们以容易访问和重构的方式使用TypeScript的字符串字面量类型。 接下来，我们创建一些 actions 以及创建这些 actions 的函数，src/actions/index.tsx。</p> 
 <p>actions/index.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">export interface IINCREMENTAction {
    type: INCREMENT;
}

export interface IDECREMENTAction {
    type: DECREMENT;
}

// 定义 modifyAction 类型，包含 IINCREMENTAction 和 IDECREMENTAction 接口类型
export type ModifyAction = IINCREMENTAction | IDECREMENTAction;


// 增加 state 次数的方法
export const increment = (): IINCREMENTAction =&gt; ({
    type: INCREMENT,
})

// 减少 state 次数的方法
export const decrement = (): IDECREMENTAction =&gt; ({
    type: DECREMENT
})
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p><code>actions/index.tsx</code> 中定义了两个类型，分别负责添加和减少操作的行为。我们还定义了一个类型（<code>ModifyAction</code>），它描述了哪些 <code>action</code> 是可以增加或减少的。 最后，我们定义了两个函数用来创建实际的 <code>actions</code>。</p> 
 <h4 class="heading">添加 reducer</h4> 
 <p>我们的reducer将放在src/reducers/index.tsx文件里。 它的功能是保证增加操作会让 <code>times</code> 加1，减少操作则要将 <code>times</code> 减1。</p> 
 <p>reducers/index.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">import { ModifyAction } from '../actions';
import { DECREMENT, INCREMENT } from '../constants';


// 处理并返回 state 
export default (state = 0, action: ModifyAction): number =&gt; {
    switch (action.type) {
      case INCREMENT:
        return state + 1
      case DECREMENT:
        return state - 1
      default:
        return state
    }
}
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h4 class="heading">创建容器组件</h4> 
 <p>之前我们已经使用了 Counter 组件，但是这个组件是一个纯组件，此时我们需要一个组件将 Counter 和 数据连接起来。我们先修改一下原先的 Counter 组件，在其中添加一些操作按钮</p> 
 <p>components/Counter.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">import * as React from 'react';


// 创建类型接口
export interface IProps {
    value: number,
    onIncrement: () =&gt; void,
    onDecrement: () =&gt; void
}

// 使用接口代替 PropTypes 进行类型校验
export default class Counter extends React.PureComponent&lt;IProps&gt; {
    public render() {
        const { value, onIncrement, onDecrement } = this.props;
        return (
            &lt;p&gt;
                Clicked: { value } times
                &lt;br /&gt;
                &lt;br /&gt;
                &lt;button onClick={ onIncrement } style={<!-- -->{ marginRight: 20 }}&gt; +  &lt;/button&gt;
                &lt;button onClick={ onDecrement }&gt; - &lt;/button&gt;
            &lt;/p&gt;
        )
    }
}

<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>然后我们再创建一个 <code>container</code> 目录，用来存放需要与数据交互的组件，新建 <code>CounterCon.tsx</code> 文件.</p> 
 <p>两个关键点是初始的 <code>Counter</code> 组件和 <code>react-redux</code> 的 <code>connect</code> 函数。 <code>connect</code> 可以将我们的 <code>Counter</code> 组件转换成一个容器，通过以下两个函数：</p> 
 <ul><li>mapStateToProps将当前store里的数据以我们的组件需要的形式传递到组件。</li><li>mapDispatchToProps利用dispatch函数，创建回调props将actions送到store。</li></ul> 
 <p>container/CounterCon.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">import { connect } from 'react-redux';
import { Dispatch } from 'redux';

import { decrement, increment } from '../actions';
import Counter from '../components/Counter';
import { StoreState } from '../types';


// 将 reducer 中的状态插入到组件的 props 中
const mapStateToProps = (state: StoreState): { value: number } =&gt; ({
    value: state
})

// 将 对应action 插入到组件的 props 中
const mapDispatchToProps = (dispatch: Dispatch) =&gt; ({
    onDecrement: () =&gt; dispatch(decrement()),
    onIncrement: () =&gt; dispatch(increment())
})

// 使用 connect 高阶组件对 Counter 进行包裹
export default connect(mapStateToProps, mapDispatchToProps)(Counter);
<span class="copy-code-btn">复制代码</span></code></pre> 
 <h4 class="heading">创建 store</h4> 
 <p>让我们回到src/index.tsx。 要把所有的东西合到一起，我们需要创建一个带初始状态的store，并用我们所有的reducers来设置它。 并且使用 react-redux 的 Provider 将 props 和 容器连接起来</p> 
 <p>index.tsx</p> 
 <pre><code class="hljs tsx copyable" lang="tsx">import * as React from 'react';
import * as ReactDOM from 'react-dom';
import { Provider } from 'react-redux';
import { createStore } from 'redux';

import App from './App';
import './index.css';
import reducer from './reducer'; 
import registerServiceWorker from './registerServiceWorker';


// 1、创建 store
const store = createStore(reducer);

ReactDOM.render(
    // 2、然后使用react-redux的Provider将props与容器连通起来
    &lt;Provider store={ store }&gt;
        &lt;App /&gt;
    &lt;/Provider&gt; ,
    document.getElementById('root') as HTMLElement
);
registerServiceWorker();
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>回到我们的 App.jsx 文件中，之前我们引用的是 components 中的 Counter 组件，但是此时我们需要使用的是与数据有交互的 CounterCon 组件。改写如下：</p> 
 <p>App.jsx</p> 
 <pre><code class="hljs jsx copyable" lang="jsx"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./App.css'</span>;

<span class="hljs-comment">// 引入 container 组件 CountCon</span>
<span class="hljs-keyword">import</span> CountCon <span class="hljs-keyword">from</span> <span class="hljs-string">'./container/CountCon'</span>;
<span class="hljs-comment">// import logo from './logo.svg';</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  public render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"App"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CountCon</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App;
<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>注意，此时 <code>CountCon</code> 不再需要 <code>props</code> 了，因为我们使用了 <code>connect</code> 函数为包裹起来的 <code>Hello</code> 组件的 <code>props</code> 适配了应用的状态。</p> 
 <p>此时，运行项目，点击 + 或者 - 按钮，即可看到 <code>times</code> 的次数会发生变化。</p> 
 <h3 class="heading">总结</h3> 
 <p>至此，对于使用 <code>TypeScript</code> 编写 <code>React</code> 应用应该有了一定的了解。其实写法也比较固定，刚接触的话可能有些地方容易出现问题，多写几个组件之后，应该就没什么问题了。 在编写项目的过程中，<code>create-react-app</code> 自带的 <code>tslint</code> 可能要求比较严严格，比如：</p> 
 <ul><li>在标签里不允许使用 lambda 表达式，在 <code>tslint.json</code> 文件 <code>rules</code> 属性中添加：<code>"jsx-no-lambda": false</code> 即可</li><li>在导入模块时，必须按照字母顺序导入，在 <code>tslint.json</code> 文件 <code>rules</code> 属性中添加："<code>ordered-imports": false</code> 即可</li></ul> 
 <p>还有很多别的配置，有需要的话，可以查看文档：<a href="https://link.juejin.im?target=https%3A%2F%2Fpalantir.github.io%2Ftslint%2Frules%2F" rel="nofollow">TSLint core rules</a>。</p> 
 <hr> 
 <h3 class="heading">本文 Demo 地址</h3> 
 <ul><li> <p>本文 <code>Counter Demo</code> 是一个简易的例子，可以用来作为入门参考：<strong><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fbeichensky%2Ftypescript-react-example%2Ftree%2Fmaster%2Ftypescript-react-app" rel="nofollow">Counter Demo</a></strong></p> </li><li> <p>另外还写了一个 <code>TodoList</code> 的例子，稍微更有难度一些，代码量和组件更多更详细。有需要的朋友也可以参考一下：<strong><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fbeichensky%2Ftypescript-react-example%2Ftree%2Fmaster%2Ftypescript-react-todos" rel="nofollow">TodoList Demo</a></strong></p> </li></ul> 
</div> 
<p>转载于:https://juejin.im/post/5c81d10b5188257ee7275222</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e958d34ccf1027dafdfccf0dcf12b6bc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java学习笔记40：String类、StringBuild和Stringbuffer、不可变和可变字符序列使用的陷阱</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/29ca734231b500284c3761172791bf15/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LaTex 论文排版(2): 插入公式 (从MathType公式编辑器导入到LaTex中)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>