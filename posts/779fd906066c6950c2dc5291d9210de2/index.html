<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【vue3】vue3组件通信方式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【vue3】vue3组件通信方式" />
<meta property="og:description" content="一、props 可以实现父子组件通信，子组件通过defineProps获取父组件传递的数据，且在子组件内部不需要引入defineProps方法就可以直接使用！
1、父组件给子组件传递数据
&lt;Child hobby=&#34;学习&#34; :money=&#34;money&#34;&gt;&lt;/Child&gt; &lt;script setup lang=&#34;ts&#34;&gt; import Child from &#34;./Child.vue&#34;; import { ref } from &#34;vue&#34;; let money = ref(10000); &lt;/script&gt; 2、子组件获取父组件传递数据
①方式1：对象类型接收
let props = defineProps({ hobby:{ type:String,//接受的数据类型 default:&#39;赚一个亿&#39;,//接受默认数据 }, money:{ type:Number, default:0 }}) ②方式2：数组类型接收
let props = defineProps([&#34;hobby&#34;,&#34;money&#34;]) 3、在模板中使用
&lt;p&gt;{{props.hobby}}&lt;/p&gt; &lt;p&gt;{{props.money}}&lt;/p&gt; 在模板中也可以省略props，但在script中不能省略
&lt;p&gt;{{hobby}}&lt;/p&gt; &lt;p&gt;{{money}}&lt;/p&gt; 注意点：props只能读取不能修改
const updateProps = ()=&gt;{ props.money&#43;=10; } 如果通过事件去改，会报警告并且值并不会进行修改
二、自定义事件 在vue中的事件分为原生的DOM事件和自定义事件，原生DOM事件可以让用户与网页进行交互，自定义事件可以实现子组件给父组件传递数据
1、原生DOM事件
vue3中的click、dbclick、change(这类原生DOM事件)，不管是在普通标签还是组件标签上都是原生DOM事件，而在vue2中组件标签需要通过native修饰符才能变为原生DOM事件。
&lt;div @click=&#34;handler1(1,2,3,$event)&#34;&gt;传递多个参数&lt;/div&gt; 注意：如果要传递参数并获取event事件对象，注入的事件对象务必叫做$event
2、自定义事件
组件标签写@click应该为原生DOM事件,但是如果子组件内部通过defineEmits定义就变为自定义事件了
1、子组件给父组件传递数据
子组件通过defineEmits方法传递一个数组，元素为将来组件需要触发的自定义事件类型，方法执行会返回一个$emit方法用于触发自定义事件，第一个参数为触发事件类型，第二个、三个、N个参数即为传递给父组件的数据。
&lt;script setup lang=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/779fd906066c6950c2dc5291d9210de2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-14T15:55:31+08:00" />
<meta property="article:modified_time" content="2023-06-14T15:55:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【vue3】vue3组件通信方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="props_0"></a>一、props</h5> 
<blockquote> 
 <p>可以实现父子组件通信，子组件通过<code>defineProps</code>获取父组件传递的数据，且在子组件内部不需要引入defineProps方法就可以直接使用！</p> 
</blockquote> 
<p><strong>1、父组件给子组件传递数据</strong></p> 
<pre><code class="prism language-vue">&lt;Child hobby="学习" :money="money"&gt;&lt;/Child&gt;
</code></pre> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> Child <span class="token keyword">from</span> <span class="token string">"./Child.vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> money <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>2、子组件获取父组件传递数据</strong></p> 
<p>①方式1：对象类型接收</p> 
<pre><code class="prism language-vue">let props = defineProps({
  hobby:{
   type:String,//接受的数据类型
   default:'赚一个亿',//接受默认数据
  },
  money:{
   type:Number,
   default:0
}})
</code></pre> 
<p>②方式2：数组类型接收</p> 
<pre><code class="prism language-vue">let props = defineProps(["hobby","money"])
</code></pre> 
<p><strong>3、在模板中使用</strong></p> 
<pre><code class="prism language-vue">&lt;p&gt;{<!-- -->{props.hobby}}&lt;/p&gt;
&lt;p&gt;{<!-- -->{props.money}}&lt;/p&gt;
</code></pre> 
<p>在模板中也可以省略<code>props</code>，但在<code>script</code>中不能省略</p> 
<pre><code class="prism language-vue">&lt;p&gt;{<!-- -->{hobby}}&lt;/p&gt;
&lt;p&gt;{<!-- -->{money}}&lt;/p&gt;
</code></pre> 
<p><code>注意点：props</code>只能读取不能修改</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">updateProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  props<span class="token punctuation">.</span>money<span class="token operator">+=</span><span class="token number">10</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/58/c1/6iF8eZh4_o.png" alt="在这里插入图片描述">如果通过事件去改，会报警告并且值并不会进行修改</p> 
<h5><a id="_54"></a>二、自定义事件</h5> 
<blockquote> 
 <p>在vue中的事件分为原生的DOM事件和自定义事件，原生DOM事件可以让用户与网页进行交互，自定义事件可以实现子组件给父组件传递数据</p> 
</blockquote> 
<p><strong>1、原生DOM事件</strong></p> 
<blockquote> 
 <p>vue3中的click、dbclick、change(这类原生DOM事件)，不管是在普通标签还是组件标签上都是<code>原生DOM事件</code>，而在vue2中组件标签需要通过<code>native</code>修饰符才能变为原生DOM事件。</p> 
</blockquote> 
<pre><code class="prism language-vue">&lt;div @click="handler1(1,2,3,$event)"&gt;传递多个参数&lt;/div&gt;
</code></pre> 
<p><code>注意：</code>如果要传递参数并获取event事件对象，注入的事件对象务必叫做<code>$event</code></p> 
<p><strong>2、自定义事件</strong></p> 
<blockquote> 
 <p>组件标签写@click应该为原生DOM事件,但是如果子组件内部通过defineEmits定义就变为自定义事件了</p> 
</blockquote> 
<p><strong>1、子组件给父组件传递数据</strong></p> 
<blockquote> 
 <p>子组件通过<code>defineEmits</code>方法传递一个数组，元素为将来组件需要触发的自定义事件类型，方法执行会返回一个<code>$emit</code>方法用于触发自定义事件，第一个参数为触发事件类型，第二个、三个、N个参数即为传递给父组件的数据。</p> 
</blockquote> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">let</span> $emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'doStudy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'doStudy'</span><span class="token punctuation">,</span><span class="token string">'学习'</span><span class="token punctuation">,</span><span class="token string">'卷起来'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>2、父组件获取子组件传递的数据</strong></p> 
<pre><code class="prism language-vue">&lt;Child @doStudy="getStudyData" &gt;&lt;/Child &gt;
</code></pre> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">const</span> <span class="token function-variable function">getStudyData</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">param1<span class="token punctuation">,</span>param2</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>param1<span class="token punctuation">,</span>param2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2e/74/g8A5hERA_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_94"></a>三、全局事件总线</h5> 
<blockquote> 
 <p>全局事件总线可以实现任意组件通信，借助插件<code>mitt</code>来实现。官网地址：<a href="https://www.npmjs.com/package/mitt" rel="nofollow"><strong>https://www.npmjs.com/package/mitt</strong></a></p> 
</blockquote> 
<p>在vue2中可以根据VM与VC关系推出全局事件总线，但是在vue3中没有Vue构造函数，也就没有Vue.prototype以及组合式API写法没有this</p> 
<p><strong>1、下载</strong></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> <span class="token function">install</span> --save mitt
</code></pre> 
<p><strong>2、引入</strong><br> 在src文件夹下新建<code>bus</code>文件夹，里面建<code>index.ts</code>文件</p> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> mitt <span class="token keyword">from</span> <span class="token string">'mitt'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $bus <span class="token operator">=</span> <span class="token function">mitt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> $bus<span class="token punctuation">;</span>
</code></pre> 
<p>引入mitt插件：mitt一个方法，方法执行会返回bus对象</p> 
<p><strong>3、使用</strong><br> 如：兄弟组件间通信</p> 
<p>① 传递数据的组件</p> 
<pre><code class="prism language-vue">&lt;script setup lang="ts"&gt;
//引入$bus对象
import $bus from '../../bus';
$bus.emit('goStudy',{type:"编程"});
&lt;/script&gt;
</code></pre> 
<p>② 接收数据的组件</p> 
<pre><code class="prism language-vue">&lt;script setup lang="ts"&gt;
import $bus from '../../bus';
import { onMounted } from "vue";
onMounted(() =&gt; {
  //第一个参数:即为事件类型  第二个参数:即为事件回调
  $bus.on("goStudy", (type) =&gt; {
    console.log(type);
  });
});
&lt;/script&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/fd/1b/ZBmeo7bg_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="vmodel_141"></a>四、v-model</h5> 
<blockquote> 
 <p>v-model指令可以收集表单数据(数据双向绑定)，它也可以实现父子组件数据同步。</p> 
</blockquote> 
<p>父组件传值到子组件，子组件传值到父组件可以用<code>props</code>和<code>自定义事件</code></p> 
<p><strong>1、父组件</strong></p> 
<pre><code class="prism language-vue">&lt;Child :modelValue="study " @update:modelValue="handle"&gt;&lt;/Child&gt;
</code></pre> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> study <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">"去学习"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/44/29/qUXJXBWH_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2、子组件</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"modelValue"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> $emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'update:modelValue'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'update:modelValue'</span><span class="token punctuation">,</span>props<span class="token punctuation">.</span>modelValue <span class="token operator">+</span> <span class="token string">'come on'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>3、知识点</strong></p> 
<pre><code class="prism language-vue">&lt;Child :modelValue="study " @update:modelValue="handle"&gt;&lt;/Child&gt;
</code></pre> 
<p>等同于：</p> 
<pre><code class="prism language-vue">&lt;Child v-model="study"&gt;&lt;/Child&gt;
</code></pre> 
<p><code>v-model</code>在组件身上使用：</p> 
<p>① 给子组件传递props参数名为<code>modelValue</code></p> 
<p><img src="https://images2.imgbox.com/89/44/dTA9gLb9_o.png" alt="在这里插入图片描述"></p> 
<p>② 给子组件绑定自定义事件，事件名为<code>update:modelValue</code></p> 
<p><img src="https://images2.imgbox.com/ad/62/kH8rcW09_o.png" alt="在这里插入图片描述"></p> 
<p><code>注意点：</code>一个组件可以通过使用多个v-model，让父子组件多个数据同步</p> 
<pre><code class="prism language-vue">&lt;Child v-model:page="page" v-model:size="size"&gt;&lt;/Child&gt;
</code></pre> 
<p>上方代码相当于给组件Child传递两个props分别是page与size，以及绑定两个自定义事件update:page与update:size实现父子数据同步</p> 
<h5><a id="useAttrs_195"></a>五、useAttrs</h5> 
<blockquote> 
 <p>利用useAttrs方法获取组件的属性与事件</p> 
</blockquote> 
<p><strong>1、父组件</strong></p> 
<pre><code class="prism language-vue">&lt;Child :modelValue="study " @update:modelValue="handle"&gt;&lt;/Child&gt;
</code></pre> 
<p><strong>2、子组件</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>useAttrs<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token comment">//此方法执行会返回一个对象</span>
<span class="token keyword">let</span> $attrs <span class="token operator">=</span> <span class="token function">useAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cc/89/kkxIlpc7_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/7d/b8/yJoSyjJj_o.png" alt="在这里插入图片描述"></p> 
<p><code>注意点：</code>这种方式类似于<code>props</code>，可以接受父组件传递过来的属性与属性值，如果<code>defineProps</code>接受了某一个属性，<code>useAttrs</code>方法返回的对象身上就没有相应属性与属性值。</p> 
<h5><a id="refparent_218"></a>六、ref与$parent</h5> 
<blockquote> 
 <p>通过<code>ref</code>可以获取元素的DOM或者获取子组件实例的VC，那么子组件内部的方法与响应式数据父组件是可以使用的</p> 
</blockquote> 
<blockquote> 
 <p>通过<code>$parent</code>可以获取某个组件的父组件实例VC,因此可以使用父组件内部的数据与方法</p> 
</blockquote> 
<p><strong>1、父组件</strong></p> 
<pre><code class="prism language-vue">&lt;Child ref="child"&gt;&lt;/Child&gt;
</code></pre> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> Child <span class="token keyword">from</span> <span class="token string">"./Child .vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> task <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">"一起学习"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Child<span class="token punctuation">.</span>value<span class="token punctuation">.</span>study<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Child<span class="token punctuation">.</span>value<span class="token punctuation">.</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
   task
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/48/59/z00Gkddp_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2、子组件</strong></p> 
<p>子组件内部拥有一个按钮点击时候获取父组件实例</p> 
<pre><code class="prism language-vue">&lt;button @click="getParent($parent)"&gt;点击获取父组件实例&lt;/button&gt;
</code></pre> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token comment">//数据</span>
<span class="token keyword">let</span> study <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">"编程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//方法</span>
<span class="token keyword">const</span> <span class="token function-variable function">handle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"去学习"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  study<span class="token punctuation">,</span>
  handle 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">getParent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$parent<span class="token punctuation">.</span>task<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6a/47/wJWGjRDY_o.png" alt="在这里插入图片描述"></p> 
<p><code>注意：</code>父组件获取子组件的数据或者方法需要通过<code>defineExpose</code>对外暴露,因为vue3中组件内部的数据对外“关闭的”，外部不能访问，反之亦然。</p> 
<h5><a id="provideinject_272"></a>七、provide与inject</h5> 
<blockquote> 
 <p>可以实现隔辈组件传递参数（父、子、孙…）</p> 
</blockquote> 
<p><strong>1、父组件</strong></p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>provide<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'money'</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><code>provide</code>方法用于提供数据，此方法执需要传递两个参数，分别提供数据的key与value</p> 
<p><strong>2、子孙组件</strong></p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>inject<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> money <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">'money'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
money <span class="token operator">+=</span> <span class="token number">9999</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/22/Jatw8yMc_o.png" alt="在这里插入图片描述"></p> 
<p>后代组件可以通过<code>inject</code>方法获取数据，通过key获取存储的数值</p> 
<h5><a id="pinia_300"></a>八、pinia</h5> 
<blockquote> 
 <p><code>pinia</code>是集中式管理状态容器，类似于vuex，可以实现任意组件之间通信。但是核心概念没有mutation、modules，使用方式参照官网<a href="https://pinia.web3doc.top/" rel="nofollow">https://pinia.web3doc.top/</a></p> 
</blockquote> 
<p><strong>1、下载</strong></p> 
<pre><code class="prism language-shell"><span class="token function">npm</span> <span class="token function">install</span> pinia
</code></pre> 
<p><strong>2、创建仓库</strong></p> 
<p>① 在src文件夹下新建<code>store</code>文件夹</p> 
<p><img src="https://images2.imgbox.com/e6/95/pKVjAuTw_o.png" alt="在这里插入图片描述"></p> 
<p>② 在<code>index.ts</code>中创建大仓库并暴露</p> 
<pre><code class="prism language-ts"><span class="token comment">//createPinia方法可以用于创建大仓库</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</code></pre> 
<p>③ 在<code>main.ts</code>入口文件中引入store并挂载</p> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
</code></pre> 
<p><strong>3、使用</strong></p> 
<h6><a id="1API_331"></a>1、选择式API</h6> 
<p>① 在<code>modules</code>文件夹中可以定义一些小仓库如：info</p> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span>
<span class="token comment">//第一个参数:小仓库名字  第二个参数:小仓库配置对象</span>
<span class="token comment">//defineStore方法执行会返回一个函数，函数作用就是让组件可以获取到仓库数据</span>
<span class="token keyword">let</span> useInfoStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"info"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//存储数据:state</span>
    <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
            count<span class="token operator">:</span> <span class="token number">99</span><span class="token punctuation">,</span>
            arr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//注意:函数没有context上下文对象，没有commit、没有mutations去修改数据</span>
        <span class="token function">updateNum</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    getters<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">total</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">let</span> result<span class="token operator">:</span><span class="token builtin">any</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> next<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> prev <span class="token operator">+</span> next<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//对外暴露方法</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useInfoStore<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/da/d9/kl6LE2Eo_o.png" alt="在这里插入图片描述"></p> 
<p>② 在组件中操作仓库中的数据和方法</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> useInfoStore <span class="token keyword">from</span> <span class="token string">"../../store/modules/info"</span><span class="token punctuation">;</span>
<span class="token comment">//获取小仓库对象</span>
<span class="token keyword">let</span> infoStore <span class="token operator">=</span> <span class="token function">useInfoStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>infoStore<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//修改数据方法</span>
infoStore<span class="token punctuation">.</span><span class="token function">updateNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/35/61/h4Ovo8As_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="2API_381"></a>2、组合式API</h6> 
<pre><code class="prism language-ts"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token comment">//创建小仓库</span>
<span class="token keyword">let</span> useInfoStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> total <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> arr<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> prev <span class="token operator">+</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//务必要返回一个对象:属性与方法可以提供给组件使用</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        count<span class="token punctuation">,</span>
        arr<span class="token punctuation">,</span>
        total<span class="token punctuation">,</span>
        <span class="token function">updateNum</span><span class="token punctuation">(</span>a<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
           count<span class="token punctuation">.</span>value <span class="token operator">=</span> count<span class="token punctuation">.</span>value <span class="token operator">+</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useInfoStore<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="slot_408"></a>九、slot</h5> 
<blockquote> 
 <p>默认插槽、具名插槽、作用域插槽可以实现父子组件通信</p> 
</blockquote> 
<h6><a id="1_412"></a>1、默认插槽</h6> 
<p>在子组件内部的模板中书写slot全局组件标签</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<p>在父组件内部提供结构：Child为子组件在父组件内部使用，在双标签内部书写结构传递给子组件，注意开发项目的时候默认插槽一般只有一个。</p> 
<pre><code class="prism language-vue">&lt;Child&gt;
  &lt;h1&gt;我是默认插槽填充的结构&lt;/h1&gt;
&lt;/Child&gt;
</code></pre> 
<h6><a id="2_429"></a>2、具名插槽</h6> 
<blockquote> 
 <p>在组件内部留多个指定名字的插槽</p> 
</blockquote> 
<p>在子组件内部的模板中书写slot，用<code>name</code>进行命名</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;slot name="a"&gt;&lt;/slot&gt;
    &lt;slot name="b"&gt;&lt;/slot&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<p>父组件内部向指定的具名插槽传递结构。<code>v-slot：</code>可以替换为<code>#</code></p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;Todo&gt;
      &lt;template v-slot:a&gt;  //可以用#a替换
        &lt;div&gt;填入组件A部分的结构&lt;/div&gt;
      &lt;/template&gt;
      &lt;template v-slot:b&gt;//可以用#b替换
        &lt;div&gt;填入组件B部分的结构&lt;/div&gt;
      &lt;/template&gt;
    &lt;/Todo&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre> 
<h6><a id="3_457"></a>3、<strong>作用域插槽</strong></h6> 
<blockquote> 
 <p>子组件数据由父组件提供，但是子组件内部决定不了自身结构与外观(样式)。子组件可以将数据回传给父组件，父组件决定这些回传的<br> 数据是以何种结构或者外观在子组件内部去展示。</p> 
</blockquote> 
<p>子组件接收到父组件的数据后再传回去</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;todo&lt;/h1&gt;
    &lt;ul&gt;
     &lt;!--组件内部遍历数组--&gt;
      &lt;li v-for="(item,index) in todos" :key="item.id"&gt;
         &lt;!--作用域插槽将数据回传给父组件--&gt;
         &lt;slot :$row="item" :$index="index"&gt;&lt;/slot&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script setup lang="ts"&gt;
defineProps(['todos']);//接受父组件传递过来的数据
&lt;/script&gt;
</code></pre> 
<p>父组件把数据传给子组件，再接收子组件回传的数据</p> 
<pre><code class="prism language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;slot&lt;/h1&gt;
    &lt;Todo :todos="todos"&gt;
      &lt;template v-slot="{$row,$index}"&gt;
         &lt;!--父组件决定子组件的结构与外观--&gt;
         &lt;span :style="{color:$row.done?'green':'red'}"&gt;{<!-- -->{$row.title}}&lt;/span&gt;
      &lt;/template&gt;
    &lt;/Todo&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import Todo from "./Todo.vue";
import { ref } from "vue";
//父组件内部数据
let todos = ref([
  { id: 1, title: "vue开发", done: true },
  { id: 2, title: "react开发", done: false },
  { id: 3, title: "小程序开发", done: true }
]);
&lt;/script&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/17/nlNXdkiX_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f196652df5ef113ce2986f28b6a5a62/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">常用HTTP响应状态码介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/852c066bc98e6934775f614a1f209156/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最新出炉的Java面试题（2023亲身经历）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>