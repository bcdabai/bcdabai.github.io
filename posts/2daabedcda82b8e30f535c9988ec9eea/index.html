<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QT对话框中show和exec的区别 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QT对话框中show和exec的区别" />
<meta property="og:description" content="QT对话框中show和exec的区别 转自：http://hi.baidu.com/wangjuns8/blog/item/24b382460dd1c1338694737d.html
QDialog的显示有两个函数show()和exec()。他们的区别在参考文档上的解释如下：
show(): 显示一个非模式对话框。控制权即刻返回给调用函数。 弹出窗口是否模式对话框，取决于modal属性的值。 （原文：Shows the dialog as a modeless dialog. Control returns immediately to the calling code. The dialog will be modal or modeless according to the value of the modal property. ）
exec(): 显示一个模式对话框，并且锁住程序直到用户关闭该对话框为止。函数返回一个DialogCode结果。 在对话框弹出期间，用户不可以切换同程序下的其它窗口，直到该对话框被关闭。 （原文：Shows the dialog as a modal dialog, blocking until the user closes it. The function returns a DialogCode result. Users cannot interact with any other window in the same application until they close the dialog." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2daabedcda82b8e30f535c9988ec9eea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-09-17T02:05:42+08:00" />
<meta property="article:modified_time" content="2014-09-17T02:05:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QT对话框中show和exec的区别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 class="postTitle" style="margin:0px 0px 10px; padding:0px 15px; font-size:12px; font-weight:normal; font-family:微软雅黑; line-height:18px"> <a target="_blank" id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/hujianhua/archive/2012/06/24/2559761.html" rel="nofollow noopener noreferrer" style="margin:0px; padding:0px; font-size:24px; color:rgb(0,0,0); text-decoration:none">QT对话框中show和exec的区别</a></h2> 
<div class="clear" style="margin:0px; padding:0px; clear:both; font-family:微软雅黑; line-height:18px"> 
</div> 
<div class="postBody" style="margin:0px 0px 5px; padding:0px 15px; font-size:14px; font-family:微软雅黑"> 
 <div id="cnblogs_post_body" style="margin:0px 0px 30px; padding:0px; overflow:auto"> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">转自：<a target="_blank" href="http://hi.baidu.com/wangjuns8/blog/item/24b382460dd1c1338694737d.html" rel="nofollow noopener noreferrer" style="margin:0px; padding:1px 3px; color:green; text-decoration:none">http://hi.baidu.com/wangjuns8/blog/item/24b382460dd1c1338694737d.html</a></p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">QDialog的显示有两个函数show()和exec()。他们的区别在参考文档上的解释如下：</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">show():<br style="margin:0px; padding:0px"> 显示一个非模式对话框。控制权即刻返回给调用函数。<br style="margin:0px; padding:0px"> 弹出窗口是否模式对话框，取决于modal属性的值。<br style="margin:0px; padding:0px"> （原文：Shows the dialog as a modeless dialog. Control returns immediately to the calling code. <br style="margin:0px; padding:0px"> The dialog will be modal or modeless according to the value of the modal property. ）</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">exec():<br style="margin:0px; padding:0px"> 显示一个模式对话框，并且锁住程序直到用户关闭该对话框为止。函数返回一个DialogCode结果。<br style="margin:0px; padding:0px"> 在对话框弹出期间，用户不可以切换同程序下的其它窗口，直到该对话框被关闭。<br style="margin:0px; padding:0px"> （原文：Shows the dialog as a modal dialog, blocking until the user closes it. The function returns a DialogCode result. <br style="margin:0px; padding:0px"> Users cannot interact with any other window in the same application until they close the dialog. ）</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">先简单说一下我对模式和非模式对话框的一点点理解：<br style="margin:0px; padding:0px"> 模式对话框，就是在弹出窗口的时候，整个程序就被锁定了，处于等待状态，直到对话框被关闭。这时往往是需要对话框的返回值进行下面的操作。如：确认窗口（选择“是”或“否”）。<br style="margin:0px; padding:0px"> 非模式对话框，在调用弹出窗口之后，调用即刻返回，继续下面的操作。这里只是一个调用指令的发出，不等待也不做任何处理。如：查找框。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">从字面上看，show()即可以显示非模式也可以显示模式对话框（设置modal值）。当modal=true的时候是否跟exec()就一样了呢？<br style="margin:0px; padding:0px"> 经过测试，还是有区别的。<br style="margin:0px; padding:0px"> 使用show()，虽然在对话框弹出的时候，程序的其它操作（按钮、窗口切换等）都失效了；但是程序仍然在调用对话框之后，马上返回继续执行后面的代码。这样，你就不会得到窗口的返回值。以这个来看，show()只能算是“半模式”。<br style="margin:0px; padding:0px"> 而使用exec(),在调用之后，程序就被锁定在原地。等待窗口的关闭。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">实际上，QDialog的show()函数来自其父类QWidget。而exec()则是自己的。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">我最近特别喜欢继承QWidget类来做弹出窗口，它的好处就是方便、灵活，既可以做为弹出窗口用也可以嵌入另外的页面里（QDialog是不行的）。但问题是，QWidget没有exec()函数。所以想弹出这样模拟出来的模式对话框就不行了。<br style="margin:0px; padding:0px"> 也查过一些资料，有说用while(true)循环的，有说用接收事件的，但都感觉不太好。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">所以，目前还没有找到比较好的解决办法。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">续：<br style="margin:0px; padding:0px"> 上面遗留的问题经过查看QTE源代码（没有找到QT的）总算解决了。<br style="margin:0px; padding:0px"> 我查看了QDialog类的exec()函数。发现里面同样调用了show()，只是在后面又调用了一句qApp-&gt;enter_loop()嵌套一个新的消息循环来阻塞当前事件的执行；然后在hide()函数里调用了qApp-&gt;exit_loop()来退出当前的消息循环并继续执行原事件。</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">到QT帮助里查了一下这两个函数，解释如下：<br style="margin:0px; padding:0px"> enter_loop()：<br style="margin:0px; padding:0px"> 这个函数被废弃了。它仍然被保留下来是为了使旧的代码能够继续工作。我们强烈建议不要在新写的代码里使用它。这个函数直接介入主消息循环里（递归地）。除非你真的知道你在做什么，否则不要调用它。建议使用：QApplication::eventLoop()-&gt;enterLoop()。<br style="margin:0px; padding:0px"> exit_loop()：<br style="margin:0px; padding:0px"> 同样被废弃了。建议使用：QApplication::eventLoop()-&gt;exitLoop()。<br style="margin:0px; padding:0px"> 提醒：这两个操作都会进入主消息循环，慎用！</p> 
  <p style="margin:10px auto; padding-top:0px; padding-bottom:0px">那就按照建议的做吧，反正效果都是一样的。修改原来的自定义窗口，在里面增加了两个函数，分别实现打开和关闭窗口，封装了eventLoop()的调用。代码如下：<br style="margin:0px; padding:0px"> #include &lt;qapplication.h&gt;<br style="margin:0px; padding:0px"> #include &lt;qeventloop.h&gt;<br style="margin:0px; padding:0px"> /*模拟QDialog::exec()，以模式对话框方式显示*/<br style="margin:0px; padding:0px"> void MyWidget::doExec()<br style="margin:0px; padding:0px"> {<!-- --><br style="margin:0px; padding:0px">     this-&gt;show();<br style="margin:0px; padding:0px">     in_loop = TRUE;<br style="margin:0px; padding:0px">     //qApp-&gt;enter_loop();<br style="margin:0px; padding:0px">     QApplication::eventLoop()-&gt;enterLoop();<br style="margin:0px; padding:0px"> }<br style="margin:0px; padding:0px"> /*关闭窗口*/<br style="margin:0px; padding:0px"> void MyWidget::doClose()<br style="margin:0px; padding:0px"> {<!-- --><br style="margin:0px; padding:0px">     if ( in_loop ) {<!-- --><br style="margin:0px; padding:0px"> in_loop = FALSE;<br style="margin:0px; padding:0px"> //qApp-&gt;exit_loop();<br style="margin:0px; padding:0px">         QApplication::eventLoop()-&gt;exitLoop();<br style="margin:0px; padding:0px">     }<br style="margin:0px; padding:0px">     this-&gt;close();<br style="margin:0px; padding:0px"> }</p> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/02067f2730d1f840e13271ee99e87a30/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[小技巧] ubuntu 12.04中在全局菜单栏的右上角设置时间显示星期和日期</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f51caa139fe93e2db00b15ce5f2ee4d1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Qt 事件系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>