<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Spring Boot基于注解的Redis缓存实现 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Spring Boot基于注解的Redis缓存实现" />
<meta property="og:description" content="一、添加Spring Data Redis依赖启动器 &lt;!--Spring Data Redis 依赖启动器--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt; &lt;/dependency&gt; 二、Redis服务连接配置 #MySQL数据库连接配置 spring.datasource.url=jdbc:mysql://192.168.152.120:3306/springboottest?serverTimezone=UTC spring.datasource.username=root spring.datasource.password=1 #显示使用JPA进行数据库查询的SQL语句 spring.jpa.show-sql=true #redis相关配置 spring.redis.host=192.168.152.120 spring.redis.port=6379 spring.redis.password=1 三、实体类 四、repository package com.uos.cache.repository; import com.uos.cache.domain.Comment; import org.springframework.data.jpa.repository.JpaRepository; import org.springframework.data.jpa.repository.Modifying; import org.springframework.data.jpa.repository.Query; import javax.transaction.Transactional; public interface CommentRepository extends JpaRepository&lt;Comment,Integer&gt; { // 根据评论id修改评论作者 @Transactional @Modifying @Query(&#34;UPDATE t_comment c SET c.author= ?1 WHERE c.id = ?2&#34;) public int updateComment(String author,Integer id); } 五、service package com.uos.cache.service; import com.uos.cache.domain.Comment; import com.uos.cache.repository.CommentRepository; import org." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/dad86d681c5bcedd347eff9f195f1adc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-19T14:36:00+08:00" />
<meta property="article:modified_time" content="2019-12-19T14:36:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Spring Boot基于注解的Redis缓存实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body"> 
 <h2><strong><span style="color:#ff00ff;">一、添加Spring Data Redis依赖启动器</span></strong></h2> 
 <p><img alt="" height="528" src="https://images2.imgbox.com/d0/08/AqyqmdzL_o.png" width="936"></p> 
 <pre><code class="language-html">        &lt;!--Spring Data Redis 依赖启动器--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
        &lt;/dependency&gt;
</code></pre> 
 <h2><br><strong><span style="color:#ff00ff;">二、Redis服务连接配置</span></strong></h2> 
 <p><strong><span style="color:#ff00ff;"><img alt="" height="467" src="https://images2.imgbox.com/09/c1/3TlzyNyU_o.png" width="949"></span></strong></p> 
 <div> 
  <pre><code class="language-html hljs">#MySQL数据库连接配置
spring.datasource.url=jdbc:mysql://192.168.152.120:3306/springboottest?serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=1
#显示使用JPA进行数据库查询的SQL语句
spring.jpa.show-sql=true
#redis相关配置
spring.redis.host=192.168.152.120
spring.redis.port=6379
spring.redis.password=1</code></pre> 
 </div> 
 <h2><strong><span style="color:#ff00ff;">三、实体类</span></strong></h2> 
 <p><strong><span style="color:#ff00ff;"><img alt="" height="606" src="https://images2.imgbox.com/73/67/wxitjt1J_o.png" width="972"></span></strong></p> 
 <h2><strong><span style="color:#ff00ff;"> 四、repository</span></strong></h2> 
 <p><strong><span style="color:#ff00ff;"><img alt="" height="569" src="https://images2.imgbox.com/ce/7b/fhwhOmwW_o.png" width="968"></span></strong></p> 
 <div> 
  <pre><code class="language-java">package com.uos.cache.repository;


import com.uos.cache.domain.Comment;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;

import javax.transaction.Transactional;

public interface CommentRepository extends JpaRepository&lt;Comment,Integer&gt; {
    // 根据评论id修改评论作者
    @Transactional
    @Modifying
    @Query("UPDATE t_comment c SET c.author= ?1 WHERE  c.id = ?2")
    public int updateComment(String author,Integer id);
}</code></pre> 
  <p> </p> 
 </div> 
 <h2><strong><span style="color:#ff00ff;">五、service</span></strong></h2> 
 <p><strong><span style="color:#ff00ff;"><img alt="" height="878" src="https://images2.imgbox.com/ea/d1/NENWgId6_o.png" width="984"></span></strong></p> 
 <div> 
  <pre><code class="language-java">package com.uos.cache.service;

import com.uos.cache.domain.Comment;
import com.uos.cache.repository.CommentRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.*;
import org.springframework.stereotype.Service;

import java.util.Optional;

@Service
public class CommentService {
    @Autowired
    private CommentRepository commentRepository;
    @Cacheable(cacheNames = "comment",unless = "#result==null")
    public Comment findById(int comment_id){
        Optional&lt;Comment&gt; optional = commentRepository.findById(comment_id);
        if(optional.isPresent()){
            return optional.get();
        }
        return null;
    }
    @CachePut(cacheNames = "comment",key = "#result.id")
    public Comment updateComment(Comment comment){
        commentRepository.updateComment(comment.getAuthor(), comment.getaId());
        return comment;
    }
    @CacheEvict(cacheNames = "comment")
    public void deleteComment(int comment_id){
        commentRepository.deleteById(comment_id);
    }
}</code></pre> 
  <p> </p> 
 </div> 
 <h2><strong><span style="color:#ff00ff;">六、controller</span></strong></h2> 
 <p><strong><span style="color:#ff00ff;"><img alt="" height="632" src="https://images2.imgbox.com/33/56/H2TeDk49_o.png" width="992"></span></strong></p> 
 <div> 
  <pre><code class="language-java">package com.uos.cache.controller;


import com.uos.cache.domain.Comment;
import com.uos.cache.service.CommentService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class CommentController {
    @Autowired
    private CommentService commentService;
    @GetMapping("/get/{id}")
    public Comment findById(@PathVariable("id") int comment_id){
        Comment comment = commentService.findById(comment_id);
        return comment;
    }
    @GetMapping("/update/{id}/{author}")
    public Comment updateComment(@PathVariable("id") int comment_id,
                                 @PathVariable("author") String author){
        Comment comment = commentService.findById(comment_id);
        comment.setAuthor(author);
        Comment updateComment = commentService.updateComment(comment);
        return updateComment;
    }
    @GetMapping("/delete/{id}")
    public void deleteComment(@PathVariable("id") int comment_id){
        commentService.deleteComment(comment_id);}

}</code></pre> 
  <p> </p> 
 </div> 
 <h2><span style="color:#ff00ff;"><strong>七、主程序类</strong></span></h2> 
 <p><img alt="" height="526" src="https://images2.imgbox.com/bc/4a/CDUkL8HC_o.png" width="1004"></p> 
 <p> </p> 
 <h2><strong><span style="color:#ff00ff;"> 八、测试结果</span></strong></h2> 
 <h2><strong><span style="color:#ff00ff;">查询测试</span></strong></h2> 
 <p><img alt="" height="229" src="https://images2.imgbox.com/9f/7d/duPNujBX_o.png" width="1009"></p> 
 <p> </p> 
 <h2><strong><span style="color:#ff00ff;"> 更新测试</span></strong></h2> 
 <p><img alt="" height="227" src="https://images2.imgbox.com/14/c4/kTMrxLtj_o.png" width="1022"></p> 
 <p> </p> 
 <h2><strong><span style="color:#ff00ff;"> 删除测试</span></strong></h2> 
 <p><img alt="" height="455" src="https://images2.imgbox.com/1e/df/QV6TI3pW_o.png" width="1023"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6fa7eca994a71be668ca8a61c03e984d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用浏览器访问 www.baidu.com 的过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1a5de043935b0bd91d21043d0d0840ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue-cli  兼容移动端低版本系统步骤详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>