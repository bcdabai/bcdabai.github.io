<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>BurpSuite官方实验室之逻辑漏洞 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="BurpSuite官方实验室之逻辑漏洞" />
<meta property="og:description" content="BurpSuite官方实验室之逻辑漏洞 这是BurpSuit官方的实验室靶场，以下将记录个人逻辑漏洞共11个Lab的通关过程
Web Security Academy: Free Online Training from PortSwigger
lab1： Excessive trust in client-side controls
过度信任客户端控件
目标是买一件Lightweight “l33t” Leather Jacket，给了账号和密码账户wiener:peter
登录后账号只有100美金但购买的商品是1337美金，直接购买会提示余额不足。
查看了apply和place order的请求包并不存在相关的金额数量参数
重新将商品加入购物车拦截请求包
请求包如下
猜测price为金额字段进行修改，修改为0和0.1失败，修改为1成功加入购物车，金额为0.01美元
成功提交订单
lab2： High-level logic vulnerability
高级逻辑漏洞
目标同样是买一件Lightweight “l33t” Leather Jacket
同样拦截加入购物车的请求包，发现没了price只能更改数量
加入另一个商品，抓包更改请求quantity属性为-20
总价为负数提交失败，增加到正数
购买成功
lab3： Inconsistent security controls
不一致的安全控制
目标到管理后台删除Carlos用户
在target=&gt;site map
可以线程数设置大一点，扫的有点慢
也可以用脚本，扫到存在/admin的路径
尝试访问/admin,访问失败说只有DontWannaCry用户才能访问这个界面
这个DontWannaCry是什么鬼，进入注册页面给了提示，使用@dontwannacry.com的邮箱地址就可以了
用@dontwannacry.com结尾的邮箱注册失败
在email client界面找到了我们的邮箱
格式为
@exploit-0a98002904e66735c1014106016d00d1.exploit-server.net 注册一个
tpaer@exploit-0a98002904e66735c1014106016d00d1.exploit-server.net 找到响应的link
访问url注册成功
登录来到如下页面
直接把邮箱后缀修改为@dontwannacry.com结尾，成功多出Admin pannel
删除Carlos用户成功通关
lab4： Flawed enforcement of business rules" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1cc64d2c611324f699ff0b91b85cc632/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-28T21:27:48+08:00" />
<meta property="article:modified_time" content="2022-11-28T21:27:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">BurpSuite官方实验室之逻辑漏洞</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="BurpSuite_0"></a>BurpSuite官方实验室之逻辑漏洞</h2> 
<p>这是BurpSuit官方的实验室靶场，以下将记录个人逻辑漏洞共11个Lab的通关过程</p> 
<p><a href="https://portswigger.net/web-security" rel="nofollow">Web Security Academy: Free Online Training from PortSwigger</a></p> 
<h3><a id="lab1_6"></a>lab1：</h3> 
<p><code>Excessive trust in client-side controls</code></p> 
<p>过度信任客户端控件</p> 
<p>目标是买一件Lightweight “l33t” Leather Jacket，给了账号和密码账户wiener:peter<br> <img src="https://images2.imgbox.com/94/bf/zYwAL4t8_o.png" alt="在这里插入图片描述"></p> 
<p>登录后账号只有100美金但购买的商品是1337美金，直接购买会提示余额不足。</p> 
<p><img src="https://images2.imgbox.com/80/49/LuFEy6Sp_o.png" alt="在这里插入图片描述"></p> 
<p>查看了apply和place order的请求包并不存在相关的金额数量参数</p> 
<p>重新将商品加入购物车拦截请求包</p> 
<p><img src="https://images2.imgbox.com/2c/87/DodSxmK4_o.png" alt="在这里插入图片描述"></p> 
<p>请求包如下</p> 
<p><img src="https://images2.imgbox.com/a6/37/a6LRSmvP_o.png" alt="在这里插入图片描述"></p> 
<p>猜测price为金额字段进行修改，修改为0和0.1失败，修改为1成功加入购物车，金额为0.01美元</p> 
<p><img src="https://images2.imgbox.com/49/8b/AxxqnkvL_o.png" alt="在这里插入图片描述"></p> 
<p>成功提交订单</p> 
<p><img src="https://images2.imgbox.com/0e/96/VeejQ4XX_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab2_49"></a>lab2：</h3> 
<p><code>High-level logic vulnerability</code></p> 
<p>高级逻辑漏洞</p> 
<p>目标同样是买一件Lightweight “l33t” Leather Jacket</p> 
<p>同样拦截加入购物车的请求包，发现没了price只能更改数量</p> 
<p><img src="https://images2.imgbox.com/78/02/tq580fbg_o.png" alt="在这里插入图片描述"></p> 
<p>加入另一个商品，抓包更改请求quantity属性为-20</p> 
<p><img src="https://images2.imgbox.com/9b/88/fOLCzlcR_o.png" alt="在这里插入图片描述"></p> 
<p>总价为负数提交失败，增加到正数</p> 
<p><img src="https://images2.imgbox.com/51/ee/iWXRT2WF_o.png" alt="在这里插入图片描述"></p> 
<p>购买成功</p> 
<p><img src="https://images2.imgbox.com/42/fd/1NuEV56H_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab3_79"></a>lab3：</h3> 
<p><code>Inconsistent security controls</code></p> 
<p>不一致的安全控制</p> 
<p>目标到管理后台删除Carlos用户</p> 
<p>在target=&gt;site map</p> 
<p><img src="https://images2.imgbox.com/7f/60/G1V5ZqxM_o.png" alt="在这里插入图片描述"></p> 
<p>可以线程数设置大一点，扫的有点慢</p> 
<p><img src="https://images2.imgbox.com/f8/40/SvkfE1Ab_o.png" alt="在这里插入图片描述"></p> 
<p>也可以用脚本，扫到存在/admin的路径</p> 
<p><img src="https://images2.imgbox.com/1a/cd/yyvB2EIO_o.png" alt="在这里插入图片描述"></p> 
<p>尝试访问/admin,访问失败说只有DontWannaCry用户才能访问这个界面</p> 
<p><img src="https://images2.imgbox.com/c3/57/0L3bGvFm_o.png" alt="在这里插入图片描述"></p> 
<p>这个DontWannaCry是什么鬼，进入注册页面给了提示，使用@dontwannacry.com的邮箱地址就可以了</p> 
<p><img src="https://images2.imgbox.com/66/b1/CKxkiRHf_o.png" alt="在这里插入图片描述"></p> 
<p>用@dontwannacry.com结尾的邮箱注册失败</p> 
<p><img src="https://images2.imgbox.com/c0/e2/iQTiLGu7_o.png" alt="在这里插入图片描述"></p> 
<p>在email client界面找到了我们的邮箱</p> 
<p>格式为</p> 
<pre><code> @exploit-0a98002904e66735c1014106016d00d1.exploit-server.net
</code></pre> 
<p><img src="https://images2.imgbox.com/49/63/Bszk3Ov0_o.png" alt="在这里插入图片描述"></p> 
<p>注册一个</p> 
<pre><code>tpaer@exploit-0a98002904e66735c1014106016d00d1.exploit-server.net
</code></pre> 
<p>找到响应的link</p> 
<p><img src="https://images2.imgbox.com/3f/23/DB2WcopM_o.png" alt="在这里插入图片描述"></p> 
<p>访问url注册成功</p> 
<p><img src="https://images2.imgbox.com/33/0f/giCak1Z0_o.png" alt="在这里插入图片描述"></p> 
<p>登录来到如下页面</p> 
<p><img src="https://images2.imgbox.com/e8/3d/zeHZIcqA_o.png" alt="在这里插入图片描述"></p> 
<p>直接把邮箱后缀修改为@dontwannacry.com结尾，成功多出Admin pannel</p> 
<p><img src="https://images2.imgbox.com/b0/2c/vQ50B1ns_o.png" alt="在这里插入图片描述"></p> 
<p>删除Carlos用户成功通关<br> <img src="https://images2.imgbox.com/2c/8f/8GCV2A7W_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab4_159"></a>lab4：</h3> 
<p><code>Flawed enforcement of business rules</code></p> 
<p>商业规则的执行有缺陷</p> 
<p>目标购买Lightweight “l33t” Leather Jacket，进页面给了提示在结账时使用这个code</p> 
<p><img src="https://images2.imgbox.com/c0/39/YDVhVDGp_o.png" alt="在这里插入图片描述"></p> 
<p>取结账页面发现这个代码实际是一个5美金优惠券的代码，添加即可减少金额</p> 
<p><img src="https://images2.imgbox.com/ff/d7/FyBbd3lO_o.png" alt="在这里插入图片描述"></p> 
<p>减5美金肯定是不够的，看看这个券的code能不能重复使用，显示优惠券重复使用了<br> <img src="https://images2.imgbox.com/57/25/nlyGwG02_o.png" alt="在这里插入图片描述"></p> 
<p>看在哪还能找到优惠券，在商品底部发现一个sign up界面<br> <img src="https://images2.imgbox.com/bf/33/ZP1NoP4G_o.png" alt="在这里插入图片描述"></p> 
<p>用我们的邮箱登录获得了另一张优惠券SIGNUP30</p> 
<p><img src="https://images2.imgbox.com/79/8b/W5xbd8v6_o.png" alt="在这里插入图片描述"></p> 
<p>这个减的多减了400刀，但还是买不起</p> 
<p><img src="https://images2.imgbox.com/54/7d/RS3yg39B_o.png" alt="在这里插入图片描述"></p> 
<p>试着可不可以间优惠券重复利用，成功利用</p> 
<p><img src="https://images2.imgbox.com/7b/29/zp3S1XF3_o.png" alt="在这里插入图片描述"></p> 
<p>利用该逻辑漏洞成功零元购</p> 
<p><img src="https://images2.imgbox.com/65/88/gfmUar2c_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab5_205"></a>lab5：</h3> 
<p><code>Low-level logic flaw</code></p> 
<p>低级逻辑缺陷</p> 
<p>目标购买Lightweight “l33t” Leather Jacket</p> 
<p>还是钱不够，可控的只有商品的购买数量</p> 
<p><img src="https://images2.imgbox.com/be/28/i9Yx3oFc_o.png" alt="在这里插入图片描述"></p> 
<p>如果一个参数超过了后端编程语言变量类型的整数最大值就会循环到最小值</p> 
<p>例如-2147483648~2147483647，当超过2147483647就会从-2147483648开始</p> 
<p>我们可以控制数量进而控制总金额超过整数最大值变为负数，配合购买其他商品实现零元购。</p> 
<p>更改quantity商品增加数量为99（最大值），试了100不可以</p> 
<p><img src="https://images2.imgbox.com/7a/0b/74v07kWp_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b2/93/wHjY6IE2_o.png" alt="在这里插入图片描述"></p> 
<p>开始爆破到总价趋近于0时停止，经测试大概320多次99<br> <img src="https://images2.imgbox.com/cc/60/7gR8nK8J_o.png" alt="在这里插入图片描述"></p> 
<p>接下来添加另一个商品，将总金额提升到0~100<br> <img src="https://images2.imgbox.com/ff/df/w0zKZIWb_o.png" alt="在这里插入图片描述"></p> 
<p>成功购买</p> 
<p><img src="https://images2.imgbox.com/f3/8b/OWHfhpS9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab6_249"></a>lab6：</h3> 
<p><code>Inconsistent handling of exceptional input</code></p> 
<p>异常输入的不一致处理</p> 
<p>目标到管理面板删除carlos用户</p> 
<p>这个关卡似曾相识和lab3差不多，尝试一样的方法注册账号</p> 
<p><img src="https://images2.imgbox.com/62/0a/9THxNAgR_o.png" alt="在这里插入图片描述"></p> 
<p>知道了我们注册的邮箱后缀，进行注册</p> 
<pre><code>@exploit-0a81002e04cdda20c143199d014d00b6.exploit-server.net
</code></pre> 
<p><img src="https://images2.imgbox.com/40/c8/CYdkOVfl_o.png" alt="在这里插入图片描述"></p> 
<p>登录后台这次不一样了，没给更改邮箱的按钮</p> 
<p><img src="https://images2.imgbox.com/a5/0a/lCA9RKUX_o.png" alt="在这里插入图片描述"></p> 
<p>尝试使用</p> 
<pre><code>{多个字符}@dontwannacry.com@exploit-0a81002e04cdda20c143199d014d00b6.exploit-server.net
</code></pre> 
<p>多个字符把后面的@exploit-0a81002e04cdda20c143199d014d00b6.exploit-server.net屏蔽掉</p> 
<pre><code>ssdsasdasdsadsasdasdasdsadasdasdsadsadsadsadasdsadsadasdasdsadsadsadsadsadsadsadadasdasdsadasdasdassssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss@dontwannacry.com.exploit-0a81002e04cdda20c143199d014d00b6.exploit-server.net
</code></pre> 
<p><img src="https://images2.imgbox.com/52/5d/yHHiPTxE_o.png" alt="在这里插入图片描述"></p> 
<p>成功进入管理面板删除carlos用户</p> 
<p><img src="https://images2.imgbox.com/9d/62/aOEmLuXd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab7_297"></a>lab7：</h3> 
<p><code>Weak isolation on dual-use endpoint</code></p> 
<p>两用端点上的弱隔离</p> 
<p>目标是登录administrator删除carlos用户，给了账号密码wiener:peter</p> 
<p>登录后界面如下，尝试更改密码</p> 
<p><img src="https://images2.imgbox.com/cb/51/SGadDmJe_o.png" alt="在这里插入图片描述"></p> 
<p>抓包</p> 
<p><img src="https://images2.imgbox.com/83/98/tty0YDZF_o.png" alt="在这里插入图片描述"></p> 
<p>删除current-password看是否能修改，修改成功</p> 
<p><img src="https://images2.imgbox.com/c3/52/eTJvyb59_o.png" alt="在这里插入图片描述"></p> 
<p>更改username为administrator看是否能修改其他用户密码，修改成功<br> <img src="https://images2.imgbox.com/78/61/P1NO0JZk_o.png" alt="在这里插入图片描述"></p> 
<p>使用administrator账户登录，删除carlos<br> <img src="https://images2.imgbox.com/aa/ee/EhQzu8L9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab8_330"></a>lab8：</h3> 
<p><code>Insufficient workflow validation</code></p> 
<p>工作流验证不足</p> 
<p>目标给了账号让买商品</p> 
<p>号里有100刀，先随便购买一个便宜的place order并抓包</p> 
<p>POST /cart/checkout请求会重定向到订单确认页面</p> 
<p><img src="https://images2.imgbox.com/cc/8d/XLC6KtIB_o.png" alt="在这里插入图片描述"></p> 
<p>GET /cart/order-confirmation?order-confirmation=true</p> 
<p><img src="https://images2.imgbox.com/b5/30/2Dot5S2H_o.png" alt="在这里插入图片描述"></p> 
<p>成功购买</p> 
<p><img src="https://images2.imgbox.com/29/b3/PFFRbfuW_o.png" alt="在这里插入图片描述"></p> 
<p>当将购买商品加入购物车<br> <img src="https://images2.imgbox.com/cd/b6/5mbcy2CJ_o.png" alt="在这里插入图片描述"></p> 
<p>重新发包GET /cart/order-confirmation?order-confirmation=true</p> 
<p><img src="https://images2.imgbox.com/d4/ea/xRczXX2T_o.png" alt="在这里插入图片描述"></p> 
<p>购买成功<br> <img src="https://images2.imgbox.com/fe/e4/YMlCi30e_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab9_370"></a>lab9：</h3> 
<p><code>Authentication bypass via flawed state machine</code></p> 
<p>通过有缺陷的状态机绕过认证</p> 
<p>目标给了用户管理界面删除carlos</p> 
<p>登录后有个选角色的界面</p> 
<p><img src="https://images2.imgbox.com/0b/0f/Iytl57IM_o.png" alt="在这里插入图片描述"></p> 
<p>抓包登录</p> 
<p><img src="https://images2.imgbox.com/fa/17/o8MvkKo3_o.png" alt="在这里插入图片描述"></p> 
<p>其中第二个包/role-selector好像是角色选取把它drop掉</p> 
<p><img src="https://images2.imgbox.com/3d/9d/0UwqsSHo_o.png" alt="在这里插入图片描述"></p> 
<p>现在路径如下</p> 
<pre><code>https://0a6300dc03469877c024b48000ce0035.web-security-academy.net/role-selector
</code></pre> 
<p><img src="https://images2.imgbox.com/33/a2/YH2j8Kt4_o.png" alt="在这里插入图片描述"></p> 
<p>删除/role-selector直接访问首页，因为跳过了角色选择默认为administrator当访问首页是以administrator权限进行访问的因此会有Admin panel</p> 
<p><img src="https://images2.imgbox.com/f5/21/kyJqMmyG_o.png" alt="在这里插入图片描述"></p> 
<p>直接进入Admin panel删除carlos</p> 
<p><img src="https://images2.imgbox.com/a3/c5/d1t5UvbK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab10_414"></a>lab10：</h3> 
<p><code>Infinite money logic flaw</code></p> 
<p>无限金钱逻辑缺陷</p> 
<p>目标买商品</p> 
<p>在页面底端注册获得优惠券</p> 
<pre><code>SIGNUP30
</code></pre> 
<p><img src="https://images2.imgbox.com/74/14/vvamyYkU_o.png" alt="在这里插入图片描述"></p> 
<p>使用优惠券购买Gift Card礼品卡（礼品卡相当于一个10元的购物券可以赠送），当用3元优惠券购买10元的礼品卡，就相当于7元购买了10元然后再进行使用用户的余额就会多了3元将优惠券金额转换为真实的余额。</p> 
<p><img src="https://images2.imgbox.com/72/36/b41LdmLF_o.png" alt="在这里插入图片描述"></p> 
<p>购买后得到礼品卡的卡号</p> 
<pre><code>YRhyyNYl8T
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/d5/O7kOOaXK_o.png" alt="在这里插入图片描述"></p> 
<p>在用户页面进行兑换</p> 
<p><img src="https://images2.imgbox.com/8b/65/FdPypxg5_o.png" alt="在这里插入图片描述"></p> 
<p>余额成功如预期一样增加了3元</p> 
<p><img src="https://images2.imgbox.com/b2/ed/vGaN9Lmv_o.png" alt="在这里插入图片描述"></p> 
<p>如果优惠券可以重复使用，就可以利用该操作达到无限金额的效果，成功复用优惠券</p> 
<p><img src="https://images2.imgbox.com/f6/b2/KtYgsVab_o.png" alt="在这里插入图片描述"></p> 
<p>接下来利用bp中的宏来进行完成一系列的自动化操作</p> 
<p>首先新建规则，范围包括所有的URL：</p> 
<p><img src="https://images2.imgbox.com/8d/b6/ePPYY6BE_o.png" alt="在这里插入图片描述"></p> 
<p>新建宏指令：</p> 
<p><img src="https://images2.imgbox.com/47/30/5A51zYMC_o.png" alt="在这里插入图片描述"></p> 
<p>选择如下5个URL</p> 
<p><img src="https://images2.imgbox.com/00/57/ZQMrqJw2_o.png" alt="在这里插入图片描述"></p> 
<p>为第四个URL配置项目<br> <img src="https://images2.imgbox.com/4f/45/BFby1Bc6_o.png" alt="在这里插入图片描述"></p> 
<p>选择gift-card的code并起名gift-card</p> 
<p><img src="https://images2.imgbox.com/8a/35/LdPBa9sQ_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/28/47/oC4yRoBT_o.png" alt="在这里插入图片描述"></p> 
<p>为第五个URL配置项目</p> 
<p><img src="https://images2.imgbox.com/24/24/RMch494p_o.png" alt="在这里插入图片描述"></p> 
<p>选择参数 gift-card 的来源自第四个响应包：</p> 
<p><img src="https://images2.imgbox.com/28/59/oiHm7xnP_o.png" alt="在这里插入图片描述"></p> 
<p>配置完毕后测试宏，账户成功又增加了3刀<br> <img src="https://images2.imgbox.com/65/db/eISfqAz4_o.png" alt="在这里插入图片描述"></p> 
<p>sniper模式爆破/my-account<br> <img src="https://images2.imgbox.com/e7/cc/fjnwZrAA_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/f2/0f/N2ZcMYAy_o.png" alt="在这里插入图片描述"></p> 
<p>需要单线程来跑，这个2022的burp</p> 
<p><img src="https://images2.imgbox.com/60/a3/lJXehrlL_o.png" alt="在这里插入图片描述"></p> 
<p>跑了很久终于跑完了</p> 
<p><img src="https://images2.imgbox.com/8e/8c/uDUJw4iM_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="lab11_519"></a>lab11：</h3> 
<p><code>Authentication bypass via encryption oracle</code></p> 
<p>通过加密oracle绕过身份验证</p> 
<p>目标管理界面删除carlos</p> 
<p>登录界面，有stay logged in（保持登录状态）选项</p> 
<p><img src="https://images2.imgbox.com/af/14/kgRjCaXS_o.png" alt="在这里插入图片描述"></p> 
<p>勾选登录会有如下请求包</p> 
<p><img src="https://images2.imgbox.com/77/5d/D2C6wCxz_o.png" alt="在这里插入图片描述"></p> 
<p>在评论区评论</p> 
<p><img src="https://images2.imgbox.com/2a/d8/7ZIyX6wM_o.png" alt="在这里插入图片描述"></p> 
<p>拦截到如下请求：</p> 
<p>第一个包</p> 
<p><img src="https://images2.imgbox.com/50/9d/dj2W7wMm_o.png" alt="在这里插入图片描述"></p> 
<p>第二个包</p> 
<p><img src="https://images2.imgbox.com/42/17/xX1ZhlDA_o.png" alt="在这里插入图片描述"></p> 
<p>第三个包<br> <img src="https://images2.imgbox.com/87/17/WMhxF3cT_o.png" alt="在这里插入图片描述"></p> 
<p>当使用错误的电子邮箱评论时<br> <img src="https://images2.imgbox.com/f0/cb/DOdbcbit_o.png" alt="在这里插入图片描述"></p> 
<p>响应会重定向到刚才的博客页面，并设置一个加密的cookie字段<code>notification</code></p> 
<p><img src="https://images2.imgbox.com/12/21/bJtjx9Jl_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/4a/01/ooAANz8m_o.png" alt="在这里插入图片描述"></p> 
<p>将cookie中的<code>stay-logged-in</code>字段复制到<code>notification</code>中进行发包得到当前用户名+时间戳</p> 
<pre><code>wiener:1669636281964
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/65/C1mpBzri_o.png" alt="在这里插入图片描述"></p> 
<p>邮件参数更改为管理员用户名+时间戳</p> 
<pre><code>administrator:1669636281964
</code></pre> 
<p>发送请求后从cookie字段 得到新的 notification 的值，解密后发现有干扰字段 Invalid email</p> 
<p><img src="https://images2.imgbox.com/a0/e7/oXPjsdMO_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/51/70/SEOKORFZ_o.png" alt="在这里插入图片描述"></p> 
<p>将得到的新的 notification 利用 Burp Decoder进行解密加密</p> 
<p>Decode:</p> 
<p>URL=&gt;Base64=&gt;Hex删除23字节<br> <img src="https://images2.imgbox.com/ab/01/X7JmCQj8_o.png" alt="在这里插入图片描述"></p> 
<p>Encode:</p> 
<p>Base64=&gt;URL</p> 
<p><img src="https://images2.imgbox.com/01/8d/iaurxwsS_o.png" alt="在这里插入图片描述"></p> 
<p>最终得到</p> 
<pre><code>%7a%7a%73%4c%34%6d%6f%68%30%6e%77%4d%34%53%55%76%70%78%73%31%5a%42%4f%4f%30%71%6a%4a%68%46%35%59%76%48%62%34%77%39%4e%69%6b%4d%65%79%57%73%39%6b%6c%50%46%73%77%39%49%3d
</code></pre> 
<p>将编码替换到cookie 字段的 notification 值</p> 
<p>随后观察错误信息发现使用了基于块的加密算法，输入长度必须是16的倍数</p> 
<p><img src="https://images2.imgbox.com/82/10/hnTHQoZq_o.png" alt="在这里插入图片描述"></p> 
<p>用一些的字节来填充 email，最后获得新的 notification</p> 
<p>administrator + 时间戳</p> 
<pre><code>xxxxxxxxxadministrator:1669636281964
</code></pre> 
<p><img src="https://images2.imgbox.com/6e/6e/FsO2v7PT_o.png" alt="在这里插入图片描述"></p> 
<pre><code>FklldvYsXP81Suq15eJd7AQ75jOjvpsPom8buuyniI5aMt2BY3cKBS2oxaIO%2b24xz3qDeQHraVMB0fT49MivDA%3d%3d
</code></pre> 
<p>对字符串进行解码编码：</p> 
<p>Decode:</p> 
<p>URL=&gt;Base64=&gt;Hex删除32字节(16倍数)<br> <img src="https://images2.imgbox.com/5a/4e/8tbuNmdD_o.png" alt="在这里插入图片描述"></p> 
<p>Encode:</p> 
<p>Base64=&gt;URL</p> 
<p><img src="https://images2.imgbox.com/d3/3d/HJYpzyFR_o.png" alt="在这里插入图片描述"></p> 
<p>最终得到如下编码，替换notification重发评论包可以看到正确的administrator + 时间戳</p> 
<pre><code>%57%6a%4c%64%67%57%4e%33%43%67%55%74%71%4d%57%69%44%76%74%75%4d%63%39%36%67%33%6b%42%36%32%6c%54%41%64%48%30%2b%50%54%49%72%77%77%3d
</code></pre> 
<p><img src="https://images2.imgbox.com/9f/7c/Q8UKRLs8_o.png" alt="在这里插入图片描述"></p> 
<p>点击 HOME 回到主页，拦截请求包，删除cookie中的 session ，替换 stay-logged-in 为刚才解码的得到的URL编码，修改后放包<br> <img src="https://images2.imgbox.com/77/a9/EGZ7w7qk_o.png" alt="在这里插入图片描述"></p> 
<p>回到主页面后发现是以administrator身份登录的，有Admin panel的管理界面<br> <img src="https://images2.imgbox.com/e8/f7/mUilObyF_o.png" alt="在这里插入图片描述"></p> 
<p>删除carlos成功通关</p> 
<p><img src="https://images2.imgbox.com/83/2e/EyOPwD2f_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b80356b286294b21ab1184a1f3801330/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">水晶报表示例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4e661b5d1eadb252c668fd95417465dc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux学习之安装CentOS7-Mac版&#43;避坑指南</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>