<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【微信小程序开发】微信小程序集成腾讯位置项目配置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【微信小程序开发】微信小程序集成腾讯位置项目配置" />
<meta property="og:description" content="第一步 进入官网 按照Hello World流程走 腾讯位置服务官网
1、申请密钥 当然没账号的要先注册一个账号
在我的应用里创建一个新的应用，印象中需要小程序ID，去微信开发者工具里面找到自己的小程序ID填入即可
添加key中勾选勾选WebServiceAPI
2、下载SDK 从官网里下载，我这里下载的是v1.2
3、设置域名 打开微信开发者工具
在查找小程序ID的地方下滑找到服务器域名修改，把request域名添加https://apis.map.qq.com
4、将下载的SDK压缩包放在自己需要的位置 这里我是将解压的文件放在了我项目的utils文件夹中
5、在app.js文件中导入 其实可以只在需要的位置的js文件中导入，我这里直接在app.js中导入，在其他需要的js文件中通过getAPP()来进行获取
// app.js // 按照地址引入核心类，注意是引入.min.js这个文件 var QQMapWX = require(&#39;./pages/utils/qqmap-wx-jssdk1.2/qqmap-wx-jssdk.min.js&#39;) App({ globalData:{ patrolForm: { checkaddress: &#34;&#34;, }, // 实例化API核心类 qqmapsdk: new QQMapWX({ // 这个key就是你刚刚申请下来的key key: &#39;填入你申请下来的key&#39; // 必填 }) }, }) qqmapsdk中要填入自己刚刚申请下来的key
6、在所需的页面的js文件中引入 //我这里实在location/index.js中引用 // getAPP()相当于获得app.js中的数据 const app = getApp() // 实例化API核心类 // 相当于从app.js 中拿到 globalData 中的 qqmapsdk const qqmapsdk = app.globalData.qqmapsdk Page({ //." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/74ef609276bb828bffcb075146965847/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-02T18:32:39+08:00" />
<meta property="article:modified_time" content="2023-05-02T18:32:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【微信小程序开发】微信小程序集成腾讯位置项目配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <h2><a id="__Hello_World_0"></a>第一步 进入官网 按照Hello World流程走</h2> 
</blockquote> 
<p><img src="https://images2.imgbox.com/cc/9e/tgrY7EkN_o.png" alt="在这里插入图片描述"></p> 
<p><a href="https://lbs.qq.com/miniProgram/jsSdk/jsSdkGuide/jsSdkOverview" rel="nofollow">腾讯位置服务官网</a></p> 
<h3><a id="1_4"></a>1、申请密钥</h3> 
<p>当然没账号的要先注册一个账号<br> <img src="https://images2.imgbox.com/a9/3e/OjpMZiQk_o.png" alt="在这里插入图片描述"><br> 在我的应用里创建一个新的应用，印象中需要小程序ID，去<a href="https://mp.weixin.qq.com/wxamp/home" rel="nofollow">微信开发者工具</a>里面找到自己的小程序ID填入即可</p> 
<p><img src="https://images2.imgbox.com/08/79/I187nnvJ_o.png" alt="在这里插入图片描述"><br> 添加<code>key</code>中勾选勾选<code>WebServiceAPI</code></p> 
<h3><a id="2SDK_11"></a>2、下载SDK</h3> 
<p><img src="https://images2.imgbox.com/1e/67/rp9yp2lw_o.png" alt="在这里插入图片描述"><br> 从官网里下载，我这里下载的是<code>v1.2</code></p> 
<h3><a id="3_14"></a>3、设置域名</h3> 
<p>打开<a href="https://mp.weixin.qq.com/wxamp/home" rel="nofollow">微信开发者工具</a><br> <img src="https://images2.imgbox.com/d9/da/Fd1eGm6k_o.png" alt="在这里插入图片描述"><br> 在查找小程序ID的地方下滑找到服务器域名修改，把request域名添加<code>https://apis.map.qq.com</code></p> 
<h3><a id="4SDK_19"></a>4、将下载的SDK压缩包放在自己需要的位置</h3> 
<p>这里我是将解压的文件放在了我项目的<code>utils</code>文件夹中<br> <img src="https://images2.imgbox.com/70/df/Nyp7MTFD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5appjs_22"></a>5、在app.js文件中导入</h3> 
<p>其实可以只在需要的位置的<code>js</code>文件中导入，我这里直接在<code>app.js</code>中导入，在其他需要的<code>js</code>文件中通过<code>getAPP()</code>来进行获取</p> 
<pre><code class="prism language-js"><span class="token comment">// app.js</span>
<span class="token comment">// 按照地址引入核心类，注意是引入.min.js这个文件</span>
<span class="token keyword">var</span> QQMapWX <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./pages/utils/qqmap-wx-jssdk1.2/qqmap-wx-jssdk.min.js'</span><span class="token punctuation">)</span>

<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">globalData</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">patrolForm</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">checkaddress</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
          
        <span class="token comment">// 实例化API核心类</span>
        <span class="token literal-property property">qqmapsdk</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">QQMapWX</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 这个key就是你刚刚申请下来的key</span>
          <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'填入你申请下来的key'</span> 
          <span class="token comment">// 必填</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><mark>qqmapsdk中要填入自己刚刚申请下来的<code>key</code></mark></p> 
<h3><a id="6js_46"></a>6、在所需的页面的js文件中引入</h3> 
<pre><code class="prism language-js"><span class="token comment">//我这里实在location/index.js中引用</span>
<span class="token comment">// getAPP()相当于获得app.js中的数据</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 实例化API核心类</span>
<span class="token comment">// 相当于从app.js 中拿到 globalData 中的 qqmapsdk</span>
<span class="token keyword">const</span> qqmapsdk <span class="token operator">=</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>qqmapsdk
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
<span class="token comment">//...其他业务代码</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>这样我们实例化的API核心类<code>qqmapsdk</code>就可以调用官网给出的方法来进行开发了<br> 比如调用<code>qqmapsdk.reverseGeocoder</code>来进行<code>逆地址解析</code><a href="https://lbs.qq.com/miniProgram/jsSdk/jsSdkGuide/methodReverseGeocoder" rel="nofollow">逆地址解析(官网)</a></p> 
<blockquote> 
 <h2><a id="_60"></a>问题</h2> 
</blockquote> 
<h3><a id="1wxgetLocation_61"></a>1.wx.getLocation问题</h3> 
<p><img src="https://images2.imgbox.com/97/6f/NloJWOKw_o.png" alt="在这里插入图片描述"><br> 出现</p> 
<pre><code>WAServiceMainContext.js?t=wechat&amp;s=1682391372194&amp;v=2.30.4:1 
wx.getLocation need to be declared in the requiredPrivateInfos field in app.json/ext.json
(env: macOS,mp,1.06.2301160; lib: 2.30.4)
</code></pre> 
<p><strong>解决方法</strong><br> 自 2022 年 7 月 14 日后发布的小程序，要声明<code>requiredPrivateInfos</code>字段</p> 
<pre><code class="prism language-json"><span class="token comment">//app.json</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"pages"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"pages/index/index"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"requiredPrivateInfos"</span><span class="token operator">:</span> <span class="token punctuation">[</span> 
    <span class="token string">"getLocation"</span><span class="token punctuation">,</span>
    <span class="token string">"onLocationChange"</span><span class="token punctuation">,</span>
    <span class="token string">"startLocationUpdateBackground"</span>
    <span class="token string">"chooseAddress"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fd112f4ffdf0068603897e7ca27eeecd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【微信小程序开发】【源码学习】基于微信小程序的地图获取地点信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eed038899fe0aac2adf71c7459f21477/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">第一次项目总结(瑞吉外卖)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>