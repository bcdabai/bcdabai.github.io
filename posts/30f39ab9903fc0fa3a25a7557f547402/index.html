<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微信小程序如何获取元素节点信息？ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微信小程序如何获取元素节点信息？" />
<meta property="og:description" content="通常在做微信小程序的时候我们经常会需要获取元素的信息，但是微信小程序有没有完整的“DOM”操作，无法像浏览器中获取元素。
不过在微信中也有一套自己的“DOM”，那就是NodesRef，它可以让我们像开发浏览器程序一样轻松愉快的获取页面元素
一、NodesRef 节点对象 1.1、NodesRef是什么？ NodesRef 用于获取 WXML 节点信息的对象
1.2、NodesRef具备的方法？ NodesRef.fields(Object fields) 获取节点的相关信息获取节点的相关信息NodesRef.boundingClientRect() 添加节点的布局位置的查询请求相对于显示区域，以像素为单位功能类似于 DOM 的 getBoundingClientRectNodesRef.scrollOffset() 添加节点的滚动位置查询请求以像素为单位节点必须是 scroll-view 或者 viewport 二、SelectorQuery 查询节点信息的对象 1.1、 创建SelectorQuery查询对象 let query = wx.createSelectorQuery() 1.2、SelectorQuery方法 SelectorQuery.in (对应的组件)
将选择器的选取范围更改为自定义组件 component 内初始时，选择器仅选取页面范围的节点，不会选取任何自定义组件中的节点 SelectorQuery.select(string selector)
在当前页面下选择第一个匹配选择器 selector 的节点 SelectorQuery.selectAll()
在当前页面下选择匹配选择器 selector 的所有节点。 SelectorQuery.selectViewport()
选择显示区域用于获取显示区域的尺寸、滚动位置等信息 SelectorQuery.exec(function callback)
执行所有的请求请求结果按请求次序构成数组，在callback的第一个参数中返回 三、获取某个元素节点信息 第一步、 创建SelectorQuery查询对象 let query = wx.createSelectorQuery() 第二步、 获取节点对象 方法一：query.select(queryString) 选择第一个匹配节点
方法二：query.selectAll(queryString) 选择所有匹配节点
queryString 类型 ID选择器：#the-idclass选择器（可以连续指定多个）：.a-class.another-class子元素选择器：.the-parent &gt; .the-child后代选择器：.the-ancestor .the-descendant跨自定义组件的后代选择器：.the-ancestor &gt;&gt;&gt; ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/30f39ab9903fc0fa3a25a7557f547402/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-30T15:05:50+08:00" />
<meta property="article:modified_time" content="2023-10-30T15:05:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微信小程序如何获取元素节点信息？</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>通常在做微信小程序的时候我们经常会需要获取元素的信息，但是微信小程序有没有完整的“DOM”操作，无法像浏览器中获取元素。</p> 
 <p>不过在微信中也有一套自己的“DOM”，那就是NodesRef，它可以让我们像开发浏览器程序一样轻松愉快的获取页面元素</p> 
</blockquote> 
<h3>一、NodesRef 节点对象</h3> 
<h4>1.1、NodesRef是什么？</h4> 
<p>NodesRef 用于获取 WXML 节点信息的对象</p> 
<h4>1.2、NodesRef具备的方法？</h4> 
<ul><li>NodesRef.fields(Object fields) 
  <ul><li><strong>获取节点的相关信息</strong></li><li>获取节点的相关信息</li></ul></li><li>NodesRef.boundingClientRect() 
  <ul><li><strong>添加节点的布局位置的查询请求</strong></li><li>相对于显示区域，以像素为单位</li><li>功能类似于 DOM 的 getBoundingClientRect</li></ul></li><li>NodesRef.scrollOffset() 
  <ul><li><strong>添加节点的滚动位置查询请求</strong></li><li>以像素为单位</li><li>节点必须是 scroll-view 或者 viewport</li></ul></li></ul> 
<p></p> 
<h3>二、SelectorQuery 查询节点信息的对象</h3> 
<h4>1.1、 创建SelectorQuery查询对象</h4> 
<pre><code class="language-javascript">let query = wx.createSelectorQuery()</code></pre> 
<h4>1.2、SelectorQuery方法</h4> 
<ul><li> <p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/SelectorQuery.in.html" rel="nofollow" title="SelectorQuery.in">SelectorQuery.in</a> (对应的组件)</p> 
  <ul><li>将选择器的选取范围更改为自定义组件 component 内</li><li>初始时，选择器仅选取页面范围的节点，不会选取任何自定义组件中的节点</li></ul></li><li> <p>SelectorQuery.select(string selector)</p> 
  <ul><li>在当前页面下选择第一个匹配选择器 selector 的节点</li></ul></li><li> <p>SelectorQuery.selectAll()</p> 
  <ul><li>在当前页面下选择匹配选择器 selector 的所有节点。</li></ul></li><li> <p>SelectorQuery.selectViewport()</p> 
  <ul><li>选择显示区域</li><li>用于获取显示区域的尺寸、滚动位置等信息</li></ul></li><li> <p>SelectorQuery.exec(function callback)</p> 
  <ul><li>执行所有的请求</li><li>请求结果按请求次序构成数组，在callback的第一个参数中返回</li></ul></li></ul> 
<h3>三、获取某个元素节点信息</h3> 
<h5>第一步、 创建SelectorQuery查询对象</h5> 
<pre><code class="language-javascript">let query = wx.createSelectorQuery()</code></pre> 
<h5>第二步、 获取节点对象</h5> 
<ul><li> <p>方法一：query.select(queryString) 选择第一个匹配节点</p> </li><li> <p>方法二：query.selectAll(queryString) 选择所有匹配节点</p> 
  <ul><li><strong>queryString 类型</strong> 
    <ul><li><strong>ID选择器</strong>：#the-id</li><li><strong>class选择器</strong>（可以连续指定多个）：.a-class.another-class</li><li><strong>子元素选择器</strong>：.the-parent &gt; .the-child</li><li><strong>后代选择器</strong>：.the-ancestor .the-descendant</li><li><strong>跨自定义组件的后代选择器</strong>：.the-ancestor &gt;&gt;&gt; .the-descendant</li><li><strong>多选择器的并集</strong>：#a-node, .some-other-nodes</li></ul></li></ul></li></ul> 
<pre><code class="language-javascript">let queryString = '.blue-product&gt;&gt;&gt;.product-list' let queryNode = query.selectAll(queryString)</code></pre> 
<h5>第三步、调用节点对象方法</h5> 
<ul><li><strong>获取节点的相关属性</strong></li><li><a class="has-card" href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/NodesRef.fields.html" rel="nofollow" title="developers.weixin.qq.com/miniprogram…"><span class="link-card-box"><span class="link-title">developers.weixin.qq.com/miniprogram…</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/7c/d7/wIDyyVoQ_o.png" alt="icon-default.png?t=N7T8">https://developers.weixin.qq.com/miniprogram/dev/api/wxml/NodesRef.fields.html</span></span></a></li></ul> 
<pre><code class="language-javascript">queryNode.fields({
      id:false,//是否返回节点id
      rect:fasle,//是否返回节点布局位置
      dataset: true,//返回数据集
      size: true,//返回宽高
      scrollOffset: true,//返回 scrollLeft,scrollTop
      properties: ['scrollX', 'scrollY'],//监听属性名
      computedStyle: ['margin', 'backgroundColor']//此处返回指定要返回的样式名
    }, function(res) {
      console.log(res)
    })
    
    // 返回结果
    [{
        dataset:{},
        width:247,
        height:1065,
        scrollLeft:0,
        scrollTop:0,
        margin:"0px 0px 10px",
        backgroundColor:"rgba(0, 0, 0, 0)",
    },{
        dataset:{},
        width:247,
        height:1065,
        scrollLeft:0,
        scrollTop:0,
        margin:"0px 0px 10px",
        backgroundColor:"rgba(0, 0, 0, 0)",
    },{
        dataset:{},
        width:247,
        height:1065,
        scrollLeft:0,
        scrollTop:0,
        margin:"0px 0px 10px",
        backgroundColor:"rgba(0, 0, 0, 0)",
    }]
</code></pre> 
<p></p> 
<ul><li><strong>添加节点的布局位置的查询请求</strong></li><li><a class="has-card" href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/SelectorQuery.selectAll.html" rel="nofollow" title="developers.weixin.qq.com/miniprogram…"><span class="link-card-box"><span class="link-title">developers.weixin.qq.com/miniprogram…</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/30/d8/lVYUCpht_o.png" alt="icon-default.png?t=N7T8">https://developers.weixin.qq.com/miniprogram/dev/api/wxml/SelectorQuery.selectAll.html</span></span></a></li></ul> 
<pre><code class="language-javascript"> query.selectAll(queryClass).boundingClientRect(function(rect){
      rect.id      // 节点的ID
      rect.dataset // 节点的dataset
      rect.left    // 节点的左边界坐标
      rect.right   // 节点的右边界坐标
      rect.top     // 节点的上边界坐标
      rect.bottom  // 节点的下边界坐标
      rect.width   // 节点的宽度
      rect.height  // 节点的高度
 })
</code></pre> 
<ul><li>添加节点的滚动位置查询请求</li><li><a class="has-card" href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/SelectorQuery.selectViewport.html" rel="nofollow" title="developers.weixin.qq.com/miniprogram…"><span class="link-card-box"><span class="link-title">developers.weixin.qq.com/miniprogram…</span><span class="link-link"><img class="link-link-icon" src="https://images2.imgbox.com/49/93/HdYaPqG8_o.png" alt="icon-default.png?t=N7T8">https://developers.weixin.qq.com/miniprogram/dev/api/wxml/SelectorQuery.selectViewport.html</span></span></a></li></ul> 
<pre><code class="language-javascript"> wx.createSelectorQuery().selectViewport().scrollOffset(function(res){
      res.id      // 节点的ID
      res.dataset // 节点的dataset
      res.scrollLeft // 节点的水平滚动位置
      res.scrollTop  // 节点的竖直滚动位置
 })
</code></pre> 
<h5>第四步：可一返回所有的节点信息</h5> 
<pre><code class="language-javascript">query.exec(function(res) { console.log(res) })</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/89bc2d1d83dd37ff7cc993fd4a3fb2f0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">OA——菜单里无法找到流程监控</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a23e21d796bf4cb60ccc347c15550273/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python123：统计学生成绩、统计学生平均成绩与及格人数、成绩转换（C语言）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>