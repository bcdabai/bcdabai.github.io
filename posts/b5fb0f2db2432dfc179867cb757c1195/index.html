<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>[swift实战入门]手把手教你编写2048(一) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="[swift实战入门]手把手教你编写2048(一)" />
<meta property="og:description" content="苹果设备越来越普及，拿着个手机就想捣鼓点啥，于是乎就有了这个系列，会一步一步教大家学习swift编程，学会自己做一个自己的app，github地址：https://github.com/scarlettbai/2048.git。
这篇文章需要大家了解一些swift基本语法，这里注重实践，就不讲太多基本语法了，不懂的大家可以Google一下，swift开发环境也很简单，直接在mac上安装一个XCode即可，首先我们来看下最终我们要实现的效果： 当然你也可以将其中的数字换成文字给你女票安手机上，还可以给个小惊喜，效果如下： 从上图可以看出来，最终效果其实主要分为计分板和游戏面板，游戏面板里是一个背景和很多的小块，小块中间有间隔，今天先教大家编写出游戏面板。 首先新建一个swift工程，这里就不多说了，然后新建文件NumbertailGameController.swift，这个文件主要处理游戏的初始化等逻辑 新建一个NumbertailGameController类继承UIViewController，其中包含如下属性： class NumbertailGameController : UIViewController { var demension : Int //2048游戏中每行每列含有多少个块 var threshold : Int //最高分数，判断输赢时使用，今天暂时不会用到，预留 let boardWidth: CGFloat = 260.0 //游戏区域的长度和高度 let thinPadding: CGFloat = 3.0 //游戏区里面小块间的间距 let viewPadding: CGFloat = 10.0 //计分板和游戏区块的间距 let verticalViewOffset: CGFloat = 0.0 //一个初始化属性，后面会有地方用到 } 接下来给NumbertailGameController添加init方法 init(demension d : Int , threshold t : Int) { demension = d &lt; 2 ? 2 : d threshold = t &lt; 8 ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b5fb0f2db2432dfc179867cb757c1195/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-04-09T23:17:50+08:00" />
<meta property="article:modified_time" content="2016-04-09T23:17:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[swift实战入门]手把手教你编写2048(一)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>苹果设备越来越普及，拿着个手机就想捣鼓点啥，于是乎就有了这个系列，会一步一步教大家学习swift编程，学会自己做一个自己的app，github地址：<a href="https://github.com/scarlettbai/2048.git">https://github.com/scarlettbai/2048.git</a>。</p> 
</blockquote> 
<p>这篇文章需要大家了解一些swift基本语法，这里注重实践，就不讲太多基本语法了，不懂的大家可以Google一下，swift开发环境也很简单，直接在mac上安装一个XCode即可，首先我们来看下最终我们要实现的效果： <br> <img src="https://images2.imgbox.com/65/f8/eWv7eM9c_o.jpg" alt="" title=""> <br></p> 
<p>当然你也可以将其中的数字换成文字给你女票安手机上，还可以给个小惊喜，效果如下： <br> <img src="https://images2.imgbox.com/c2/e3/l0ZthIuw_o.jpg" alt="" title=""> <br></p> 
<p>从上图可以看出来，最终效果其实主要分为计分板和游戏面板，游戏面板里是一个背景和很多的小块，小块中间有间隔，今天先教大家编写出游戏面板。 </p> 
<p>首先新建一个swift工程，这里就不多说了，然后新建文件NumbertailGameController.swift，这个文件主要处理游戏的初始化等逻辑 </p> 
<p>新建一个NumbertailGameController类继承UIViewController，其中包含如下属性： </p> 
<pre class="prettyprint"><code class="language-swift hljs javascript"><span class="hljs-keyword">class</span> NumbertailGameController : UIViewController {
    <span class="hljs-keyword">var</span> demension : Int  <span class="hljs-comment">//2048游戏中每行每列含有多少个块</span>
    <span class="hljs-keyword">var</span> threshold : Int  <span class="hljs-comment">//最高分数，判断输赢时使用，今天暂时不会用到，预留</span>
    <span class="hljs-keyword">let</span> boardWidth: CGFloat = <span class="hljs-number">260.0</span>  <span class="hljs-comment">//游戏区域的长度和高度</span>
    <span class="hljs-keyword">let</span> thinPadding: CGFloat = <span class="hljs-number">3.0</span>  <span class="hljs-comment">//游戏区里面小块间的间距</span>
    <span class="hljs-keyword">let</span> viewPadding: CGFloat = <span class="hljs-number">10.0</span>  <span class="hljs-comment">//计分板和游戏区块的间距</span>
    <span class="hljs-keyword">let</span> verticalViewOffset: CGFloat = <span class="hljs-number">0.0</span>  <span class="hljs-comment">//一个初始化属性，后面会有地方用到</span>
}</code></pre> 
<p>接下来给NumbertailGameController添加init方法 </p> 
<pre class="prettyprint"><code class="language-swift hljs objectivec">init(demension d : Int , threshold t : Int) {
    demension = d &lt; <span class="hljs-number">2</span> ? <span class="hljs-number">2</span> : d
    threshold = t &lt; <span class="hljs-number">8</span> ? <span class="hljs-number">8</span> : t
    <span class="hljs-keyword">super</span><span class="hljs-variable">.init</span>(nibName: <span class="hljs-literal">nil</span>, bundle: <span class="hljs-literal">nil</span>)
    view<span class="hljs-variable">.backgroundColor</span> = <span class="hljs-built_in">UIColor</span>(red : <span class="hljs-number">0xE6</span>/<span class="hljs-number">255</span>, green : <span class="hljs-number">0xE2</span>/<span class="hljs-number">255</span>, blue : <span class="hljs-number">0xD4</span>/<span class="hljs-number">255</span>, alpha : <span class="hljs-number">1</span>)
}</code></pre> 
<p>这里主要是限制了最少两个块以及最低分数为8分，另外设置了整个面板的背景色，关于颜色，大家可以取自己喜欢的色和直接换掉上面的十六进制数值即可。 </p> 
<p>接下来我们在Main.storyboard里添加一个开始游戏的按钮，然后在默认的ViewController.swift中添加如下响应方法： </p> 
<pre class="prettyprint"><code class="language-swift hljs ruby"><span class="hljs-variable">@IBAction</span> func setupGame(<span class="hljs-symbol">sender:</span> <span class="hljs-constant">UIButton</span>) {
    let game = <span class="hljs-constant">NumbertailGameController</span>(<span class="hljs-symbol">demension:</span> <span class="hljs-number">4</span> , <span class="hljs-symbol">threshold:</span> <span class="hljs-number">2048</span>)
    <span class="hljs-keyword">self</span>.presentViewController(game, <span class="hljs-symbol">animated:</span> <span class="hljs-keyword">true</span> , <span class="hljs-symbol">completion:</span> <span class="hljs-keyword">nil</span>)
}</code></pre> 
<p>然后我们点击XCode中的运行，就可以看到效果了，点击开始游戏，效果如下： <br> <img src="https://images2.imgbox.com/90/02/ZLf15xWl_o.jpg" alt="" title=""> <br></p> 
<p>大家可以看到此处出现了背景色为我们设置的背景色的视图，下面我们来添加游戏区块： </p> 
<p>新建GamebordView.swift文件，这个文件就是我们游戏区块的视图文件，在文件中添加如下代码： </p> 
<pre class="prettyprint"><code class="language-swift hljs objectivec">import UIKit
class GamebordView : <span class="hljs-built_in">UIView</span> {
    var demension : Int <span class="hljs-comment">//每行(列)区块个数</span>
    var tileWidth : <span class="hljs-built_in">CGFloat</span>  <span class="hljs-comment">//每个小块的宽度</span>
    var tilePadding : <span class="hljs-built_in">CGFloat</span>  <span class="hljs-comment">//每个小块间的间距</span>
    <span class="hljs-comment">//初始化，其中backgroundColor是游戏区块的背景色，foregroundColor是小块的颜色</span>
    init(demension d : Int, titleWidth width : <span class="hljs-built_in">CGFloat</span>, titlePadding padding : <span class="hljs-built_in">CGFloat</span>, backgroundColor : <span class="hljs-built_in">UIColor</span>, foregroundColor : <span class="hljs-built_in">UIColor</span> ) {
        demension = d
        tileWidth = width
        tilePadding = padding
        let totalWidth = tilePadding + <span class="hljs-built_in">CGFloat</span>(demension)*(tilePadding + tileWidth)
        <span class="hljs-keyword">super</span><span class="hljs-variable">.init</span>(frame : CGRectMake(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, totalWidth, totalWidth))
        <span class="hljs-keyword">self</span><span class="hljs-variable">.backgroundColor</span> = backgroundColor
    }
}</code></pre> 
<p>在这里我们是创建了一个游戏区块的模板，接下来我们在游戏的主控制器NumbertailGameController中添加如下代码来初始化一个游戏区块对象并添加到我们的面板中： </p> 
<pre class="prettyprint"><code class="language-swift hljs avrasm">override func viewDidLoad() {
    super<span class="hljs-preprocessor">.viewDidLoad</span>()
    setupGame()
}

func setupGame(){
    let viewWidth = view<span class="hljs-preprocessor">.bounds</span><span class="hljs-preprocessor">.size</span><span class="hljs-preprocessor">.width</span>
    let viewHeight = view<span class="hljs-preprocessor">.bounds</span><span class="hljs-preprocessor">.size</span><span class="hljs-preprocessor">.height</span>
    //获取游戏区域左上角那个点的<span class="hljs-built_in">x</span>坐标
    func xposition2Center(view v : UIView) -&gt; CGFloat{
        let vWidth = v<span class="hljs-preprocessor">.bounds</span><span class="hljs-preprocessor">.size</span><span class="hljs-preprocessor">.width</span>
        return <span class="hljs-number">0.5</span>*(viewWidth - vWidth)

    }
    //获取游戏区域左上角那个点的<span class="hljs-built_in">y</span>坐标
    func yposition2Center(order : Int , views : [UIView]) -&gt; CGFloat {
        assert(views<span class="hljs-preprocessor">.count</span> &gt; <span class="hljs-number">0</span>)
        let totalViewHeigth = CGFloat(views<span class="hljs-preprocessor">.count</span> - <span class="hljs-number">1</span>)*viewPadding +
            views<span class="hljs-preprocessor">.map</span>({$<span class="hljs-number">0.</span>bounds<span class="hljs-preprocessor">.size</span><span class="hljs-preprocessor">.height</span>})<span class="hljs-preprocessor">.reduce</span>(verticalViewOffset, combine: {$<span class="hljs-number">0</span> + $<span class="hljs-number">1</span>})
        let firstY = <span class="hljs-number">0.5</span>*(viewHeight - totalViewHeigth)

        var acc : CGFloat = <span class="hljs-number">0</span>
        for i <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span>.&lt;order{
            acc += viewPadding + views[i]<span class="hljs-preprocessor">.bounds</span><span class="hljs-preprocessor">.size</span><span class="hljs-preprocessor">.height</span>
        }
        return acc + firstY
    }
    //获取具体每一个区块的边长，即：(游戏区块长度-间隙总和)/块数
    let width = (boardWidth - thinPadding*CGFloat(demension + <span class="hljs-number">1</span>))/CGFloat(demension)
    //初始化一个游戏区块对象
    let gamebord = GamebordView(
        demension : demension,
        titleWidth: width,
        titlePadding: thinPadding,
        backgroundColor:  UIColor(red : <span class="hljs-number">0x90</span>/<span class="hljs-number">255</span>, green : <span class="hljs-number">0x8D</span>/<span class="hljs-number">255</span>, blue : <span class="hljs-number">0x80</span>/<span class="hljs-number">255</span>, alpha : <span class="hljs-number">1</span>),
        foregroundColor:UIColor(red : <span class="hljs-number">0xF9</span>/<span class="hljs-number">255</span>, green : <span class="hljs-number">0xF9</span>/<span class="hljs-number">255</span>, blue : <span class="hljs-number">0xE3</span>/<span class="hljs-number">255</span>, alpha : <span class="hljs-number">0.5</span>)
    )
    //现在面板中所有的视图对象，目前只有游戏区块，后续加入计分板
    let views = [gamebord]
    //设置游戏区块在整个面板中的的绝对位置，即左上角第一个点
    var f = gamebord<span class="hljs-preprocessor">.frame</span>
    f<span class="hljs-preprocessor">.origin</span><span class="hljs-preprocessor">.x</span> = xposition2Center(view: gamebord)
    f<span class="hljs-preprocessor">.origin</span><span class="hljs-preprocessor">.y</span> = yposition2Center(<span class="hljs-number">0</span>, views: views)
    gamebord<span class="hljs-preprocessor">.frame</span> = f
    //将游戏对象加入当前面板中
    view<span class="hljs-preprocessor">.addSubview</span>(gamebord)

}</code></pre> 
<p>上面的代码中注释已经很详细了，大家可能疑问的就是x和y坐标的计算，x坐标很简单，其实就是：<strong>当前面板总宽度减去游戏区块宽度，剩下的就是空余的宽度，再除以2就是x点的坐标了</strong>。y坐标稍微复杂点在于，以后会加入计分面板，所以他的值应该是：<strong>当前面板总高度减去所有视图的总高度除以2然后在加上在游戏区块之前的视图的总高度，就是游戏区域的y坐标值</strong>。 </p> 
<p>其他地方都很简单，其中的foregroundColor是注释中有，是下面给游戏区块添加默认小方块时用的颜色。 <br> 我们来运行看效果： <br> <img src="https://images2.imgbox.com/2d/05/8tNkp7Ay_o.jpg" alt="" title=""> <br></p> 
<p>可以看到面板已经有了，接下来我们要给面板中加入初始化的半透明小方块，我们在GamebordView中添加如下方法： </p> 
<pre class="prettyprint"><code class="language-swift hljs objectivec">func setColor(backgroundColor bgcolor : <span class="hljs-built_in">UIColor</span>, foregroundColor forecolor : <span class="hljs-built_in">UIColor</span>){
    <span class="hljs-keyword">self</span><span class="hljs-variable">.backgroundColor</span> = bgcolor
    var xCursor = tilePadding
    var yCursor : <span class="hljs-built_in">CGFloat</span>

    <span class="hljs-keyword">for</span> _ in <span class="hljs-number">0.</span>.&lt;demension{
        yCursor = tilePadding
        <span class="hljs-keyword">for</span> _ in <span class="hljs-number">0.</span>.&lt;demension {
            let tileFrame = <span class="hljs-built_in">UIView</span>(frame : <span class="hljs-built_in">CGRect</span>(x: xCursor, y: yCursor, width: tileWidth, height: tileWidth))
            tileFrame<span class="hljs-variable">.backgroundColor</span> = forecolor
            tileFrame<span class="hljs-variable">.layer</span><span class="hljs-variable">.cornerRadius</span> = <span class="hljs-number">8</span>
            addSubview(tileFrame)
            yCursor += tilePadding + tileWidth
        }
        xCursor += tilePadding + tileWidth
    }

}</code></pre> 
<p>这个方法其实就是在游戏区块中添加了demension*demension个小块，每个小块的颜色是我们传入的foregroundColor <br> 来运行下看效果： <br> <img src="https://images2.imgbox.com/5b/7f/QpF6GSqx_o.jpg" alt="" title=""> <br></p> 
<p>可以看到基本的游戏面板已经有了，今天先讲到这里，大家可以尝试自己把计分板添加进来，当然后续我也会讲到。</p> 
<p>我的博客：blog.scarlettbai.com <br> 我的微信公众号：读书健身编程 <br> 欢迎扫码关注我的公众号查看更多文章 <br> <img src="https://images2.imgbox.com/40/ef/wka5bsEA_o.jpg" alt="" title=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/58c57708960e34170ba02c723d0c235a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PointPlay(document.getElementById(&#39;selectForPlay&#39;).value);</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5e6168135980a76761b9f1c0ac9cb96a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Fedora 安装chrome浏览器的方法&lt;&gt;</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>