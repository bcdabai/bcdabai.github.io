<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AD域控 Dsquery 查询命令实例汇总 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AD域控 Dsquery 查询命令实例汇总" />
<meta property="og:description" content="在AD管理中，有了查询可以为工作省去很多麻烦。
几个通用的参数：
-limit 0 指定传回符合搜寻条件的对象数目，如果值是 0，将传回所有符合的对象。如果不指定此参数，根据默认将只显示前 100 个结果。
-o{dn | rdn | upn | samid}指定输出格式。预设: 分辨名称 (DN)。
-desc寻找描述符合筛选器&lt;Description&gt; 的使用者
1. dsquery computer - 寻找目录中的计算机
1.1 寻找过去四星期以来不在作用中的所有计算机
dsquery computer -inactive 4 -limit 0
1.2 寻找100天未变更密码的计算机
dsquery computer ou=test,dc=china,dc=com -stalepwd 100 -limit 0
1.3 寻找帐户已经停用的计算机
dsquery computer domainroot -disabled -limit 0
1.4 寻找账户已经停用的,名称以P开头，描述以ms开头的所有计算机
dsquery computer domainroot-disabled -name P* -desc ms* -limit 0
1.5 寻找名称以P开头，描述以ms开头的所有计算机
dsquery computer domainroot -name P* -desc ms*" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e73fc4013d516f525826ce888dc2dd25/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-11-24T16:06:03+08:00" />
<meta property="article:modified_time" content="2015-11-24T16:06:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AD域控 Dsquery 查询命令实例汇总</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="artical-content-bak main-content editor-side-new"> 
 <div class="con editor-preview-side" id="result"> 
  <p><span style="font-family:'宋体';">在</span>AD<span style="font-family:'宋体';">管理中，有了查询可以为工作省去很多麻烦。</span><br></p> 
  <p><span style="font-family:'宋体';">几个通用的参数：</span></p> 
  <p>-limit 0 <span style="font-family:'宋体';">指定传回符合搜寻条件的对象数目，如果值是</span> 0<span style="font-family:'宋体';">，将传回所有符合的对象。如果不指定此参数，根据默认将只显示前</span> 100 <span style="font-family:'宋体';">个结果。</span></p> 
  <p>-o{dn | rdn | upn | samid}<span style="font-family:'宋体';">指定输出格式。预设</span>: <span style="font-family:'宋体';">分辨名称</span> (DN)<span style="font-family:'宋体';">。</span></p> 
  <p>-desc<span style="font-family:'宋体';">寻找描述符合筛选器</span>&lt;Description&gt; <span style="font-family:'宋体';">的使用者</span></p> 
  <p><br></p> 
  <p>1. dsquery computer - <span style="font-family:'宋体';">寻找目录中的<a class="infotextkey" href="***tags-%E8%AE%A1%E7%AE%97%E6%9C%BA-0.html" rel="nofollow">计算机</a></span></p> 
  <p>1.1 <span style="font-family:'宋体';">寻找过去四星期以来不在作用中的所有计算机</span></p> 
  <p>dsquery computer -inactive 4 -limit 0</p> 
  <p>1.2 <span style="font-family:'宋体';">寻找</span>100<span style="font-family:'宋体';">天未变更密码的计算机</span></p> 
  <p>dsquery computer ou=test,dc=china,dc=com -stalepwd 100 -limit 0</p> 
  <p>1.3 <span style="font-family:'宋体';">寻找帐户已经停用的计算机</span></p> 
  <p>dsquery computer domain<a href="***linux/" rel="nofollow"><span style="text-decoration:underline;">root</span></a> -disabled -limit 0</p> 
  <p>1.4 <span style="font-family:'宋体';">寻找账户已经停用的</span>,<span style="font-family:'宋体';">名称以</span>P<span style="font-family:'宋体';">开头，描述以</span>ms<span style="font-family:'宋体';">开头的所有计算机</span></p> 
  <p>dsquery computer domainroot-disabled -name P* -desc ms* -limit 0</p> 
  <p>1.5 <span style="font-family:'宋体';">寻找名称以</span>P<span style="font-family:'宋体';">开头，描述以</span>ms<span style="font-family:'宋体';">开头的所有计算机</span></p> 
  <p>dsquery computer domainroot -name P* -desc ms*</p> 
  <p>1.6 <span style="font-family:'宋体';">寻找组织单位中</span> ou=sales,dc=micrsoft,dc=com <span style="font-family:'宋体';">的所有计算机，并显示它们的</span> DN:</p> 
  <p>dsquery computer ou=sales,dc=<a class="infotextkey" href="***tags-Microsoft-0.html" rel="nofollow">Microsoft</a>,dc=com</p> 
  <p>dsquery computer <span style="font-family:'宋体';">所有计算机</span></p> 
  <p>dsquery computer -limit 0 <span style="font-family:'宋体';">超过</span>100<span style="font-family:'宋体';">个的请在后面加上</span>-limit 0 <span style="font-family:'宋体';">显示全部</span></p> 
  <p>1.7 <span style="font-family:'宋体';">在</span>CN=Computers,dc=book,DC=Com<span style="font-family:'宋体';">指定的组织单位中查找被禁用的计算器并显示可分辨名称</span></p> 
  <p>Dsquery computer cn=computers,dc=book,dc=com –disabled</p> 
  <p>dsquery computer domainroot -o rdn</p> 
  <p>dsquery computer domainroot -o samid</p> 
  <p>2. dsquery contact - <span style="font-family:'宋体';">寻找目录中的联系人</span></p> 
  <p>2.1 <span style="font-family:'宋体';">在当前域中查找所有名称以“</span>pp<span style="font-family:'宋体';">”开头的联系人，并显示其可分辨的名称</span></p> 
  <p>Dsquery contact domainroot –name pp*</p> 
  <p>2.2 <span style="font-family:'宋体';">寻找组织单位中</span> ou=sales,dc=micrsoft,dc=com <span style="font-family:'宋体';">的所有联系人，并显示它们的</span> DN:</p> 
  <p>dsquery contact ou=sales,dc=microsoft,dc=com</p> 
  <p>3. dsquery subnet - <span style="font-family:'宋体';">寻找目录中的子网</span></p> 
  <p>3.1 <span style="font-family:'宋体';">查找所有子网</span></p> 
  <p>dsquery subnet</p> 
  <p>3.2 <span style="font-family:'宋体';">寻找<a class="infotextkey" href="***tags-%E7%BD%91%E7%BB%9C-0.html" rel="nofollow">网络</a></span> IP <span style="font-family:'宋体';">地址以</span> 123.12 <span style="font-family:'宋体';">开头的所有子网</span>:</p> 
  <p>dsquery subnet -name 123.12.*</p> 
  <p>3.3 <span style="font-family:'宋体';">在站台中寻找名称为</span> "Latin-America" <span style="font-family:'宋体';">的所有子网，并将它们的名称显示为相对分辨名称</span> (RDN):</p> 
  <p>dsquery subnet -o rdn -site Latin-America</p> 
  <p>3.4 <span style="font-family:'宋体';">列出定义在目录中的所有子网的名称</span> (RDN):</p> 
  <p>dsquery subnet -o rdn</p> 
  <p>4. dsquery group - <span style="font-family:'宋体';">寻找目录中的群组</span></p> 
  <p>4.1 <span style="font-family:'宋体';">在当前域中查找所有名称以“</span>pp<span style="font-family:'宋体';">”开头，描述以“</span>desktop<span style="font-family:'宋体';">”开头的组，并显示其可分辨的名称</span></p> 
  <p>Dsquery group domainroot –name pp* -desc desktop*</p> 
  <p>4.2 <span style="font-family:'宋体';">在域中查找</span> ou=sales,dc=micrsoft,dc=com <span style="font-family:'宋体';">的所有组并显示它们的</span> DN:</p> 
  <p>dsquery group ou=sales,dc=microsoft,dc=com</p> 
  <p>4.3net group</p> 
  <p>net group qq_group /domain <span style="font-family:'宋体';">显示网域中</span>qq_group<span style="font-family:'宋体';">中的成员</span></p> 
  <p>net group qq_group /del /domain <span style="font-family:'宋体';">删除域中的群组</span></p> 
  <p>net group qq_group qq /del /domain <span style="font-family:'宋体';">删除群组中的成员</span>QQ</p> 
  <p>net group qq_group /add /domain <span style="font-family:'宋体';">增加域中的群组</span></p> 
  <p>5. dsquery ou - <span style="font-family:'宋体';">寻找目录中的组织单位</span></p> 
  <p>5.1 <span style="font-family:'宋体';">在当前域中查找所有名称以“</span>pp<span style="font-family:'宋体';">”开头，描述以“</span>desktop<span style="font-family:'宋体';">”开头的组织单位，并显示其可分辨的名称</span></p> 
  <p>Dsquery ou domainroot –name pp* -desc desktop*</p> 
  <p>5.2 <span style="font-family:'宋体';">在域中查找</span> dc=micrsoft,dc=com <span style="font-family:'宋体';">的所有组织单位并显示它们的</span> DN:</p> 
  <p>dsquery ou dc=microsoft,dc=com</p> 
  <p>6. dsquery site - <span style="font-family:'宋体';">寻找目录中的站台</span></p> 
  <p>6.1 <span style="font-family:'宋体';">寻找在北美洲名称以</span> "north" <span style="font-family:'宋体';">开头的所有站台，并显示它们的</span> DN:</p> 
  <p>dsquery site -name north*</p> 
  <p>6.2 <span style="font-family:'宋体';">列出定义在目录中的所有站台的分辨名称</span>(RDN):</p> 
  <p>dsquery site -o rdn</p> 
  <p>7. dsquery server - <span style="font-family:'宋体';">寻找目录中的域控制器</span></p> 
  <p>7.1 <span style="font-family:'宋体';">寻找目前网域的所有</span> DC:</p> 
  <p>dsquery server</p> 
  <p>dsquery server -o rdn</p> 
  <p>7.2 <span style="font-family:'宋体';">寻找树系中的所有</span> DC<span style="font-family:'宋体';">，并显示它们的相对分辨名称</span>:</p> 
  <p>dsquery server -o rdn -<a href="***program/" rel="nofollow"><span style="text-decoration:underline;">for</span></a>est</p> 
  <p>dsquery server -forest</p> 
  <p>7.3 <span style="font-family:'宋体';">寻找站台中，名称为</span> "Latin-America" <span style="font-family:'宋体';">的所有</span> DC<span style="font-family:'宋体';">，并显示它们的相对分辨名称</span>:</p> 
  <p>dsquery server -o rdn -site Latin-America</p> 
  <p>7.4 <span style="font-family:'宋体';">寻找树系中担任架构</span> FSMO <span style="font-family:'宋体';">角色的</span> DC:</p> 
  <p>dsquery server -forest -hasfsmo schema</p> 
  <p>7.5 <span style="font-family:'宋体';">寻找网域</span> example.microsoft.com <span style="font-family:'宋体';">中，属于全局编录<a class="infotextkey" href="***tags-%E6%9C%8D%E5%8A%A1%E5%99%A8-0.html" rel="nofollow">服务器</a>的所有</span> DC:</p> 
  <p>dsquery server -domain example.microsoft.com -isgc</p> 
  <p>7.6 <span style="font-family:'宋体';">寻找目前网域中拥有名称为</span> "ApplicationSales" <span style="font-family:'宋体';">的目录分区的所有域控制器</span>:</p> 
  <p>dsquery server -part "Application*"</p> 
  <p>8. dsquery user - <span style="font-family:'宋体';">寻找目录中的用户</span></p> 
  <p>8.1 <span style="font-family:'宋体';">寻找组织单位中的所有用户</span>"ou=Marketing,dc=microsoft,dc=com"<span style="font-family:'宋体';">，并将它们加入营销员工群组</span>:</p> 
  <p>dsquery user ou=Marketing,dc=microsoft,dc=com | dsmod group"cn=Marketing Staff,ou=Marketing,dc=microsoft,dc=com" -addmbr</p> 
  <p>8.2 <span style="font-family:'宋体';">寻找姓名以</span> "John" <span style="font-family:'宋体';">开头的用户，并显示其办公室号码</span>:</p> 
  <p>dsquery user -name John* | dsget user -<a class="infotextkey" href="***tags-Office-0.html" rel="nofollow">Office</a></p> 
  <p>8.3 <span style="font-family:'宋体';">寻找</span>100<span style="font-family:'宋体';">天未变更密码的用户</span></p> 
  <p>dsquery user ou=test,dc=test,dc=com -stalepwd 100</p> 
  <p>dsquery user domainroot -stalepwd 100</p> 
  <p>8.4 <span style="font-family:'宋体';">在指定的组织单位</span> (OU) <span style="font-family:'宋体';">中寻找名字以</span> "jon" <span style="font-family:'宋体';">开头，帐户的登入功能已经被停用的所有用户，并显示他们的用户主要名称</span> (UPN):</p> 
  <p>dsquery user ou=Test,dc=microsoft,dc=com -o upn -name jon* -disabled</p> 
  <p>8.5 <span style="font-family:'宋体';">只寻找在目前网域中，名字以</span> "smith" <span style="font-family:'宋体';">结尾，至少过去<a class="infotextkey" href="***tags-%E4%B8%89%E6%98%9F-0.html" rel="nofollow">三星</a>期以来都不在作用中的所有用户，并显示他们的</span> DN:</p> 
  <p>dsquery user domainroot -name *smith -inactive 3</p> 
  <p>dsquery user domainroot -inactive 3</p> 
  <p>net user qq password /domain <span style="font-family:'宋体';">更改域用户密码</span></p> 
  <p>8.6 <span style="font-family:'宋体';">寻找组织单位中</span> ou=sales,dc=microsoft,dc=com <span style="font-family:'宋体';">的所有用户，并显示他们的</span> UPN:</p> 
  <p>dsquery user ou=sales,dc=microsoft,dc=com -o upn(<span style="font-family:'宋体';">显示工号</span>)</p> 
  <p>dsquery user ou=sales,dc=microsoft,dc=com -o upn –limit 0</p> 
  <p>dsquery user ou=sales,dc=microsoft,dc=com -o rdn</p> 
  <p>dsquery user ou=sales,dc=microsoft,dc=com -o samid</p> 
  <p>8.7 <span style="font-family:'宋体';">列出定义在目录中的所有站台的分辨名称</span> (RDN):</p> 
  <p>dsquery user ou=sales,dc=microsoft,dc=com -o rdn –limit 0</p> 
  <p>8.8 <span style="font-family:'宋体';">只寻找在目前网域中，名字以</span> "kill" <span style="font-family:'宋体';">结尾所有用户的可分辨名称。</span></p> 
  <p>dsquery user domainroot -name *kill</p> 
  <p>dsquery user ou=test,dc=test,dc=com-name *<span style="font-family:'宋体';">梅</span></p> 
  <p>8.9 <span style="font-family:'宋体';">寻找组织单位中</span>ou=test,dc=test,dc=com <span style="font-family:'宋体';">的所有使用者</span>,<span style="font-family:'宋体';">并输入到</span>C<span style="font-family:'宋体';">盘保存为</span>a.txt</p> 
  <p>dsquery user ou=test,dc=test,dc=com -o upn -limit 0 &gt;c:\&gt;a.txt</p> 
  <p>8.10 <span style="font-family:'宋体';">在指定的组织单位</span> (OU) <span style="font-family:'宋体';">中寻找帐户的登入功能已经被停用的所有使用者</span></p> 
  <p>dsquery user ou=test,dc=test,,dc=com -disabled</p> 
  <p>9. dsquery quota - <span style="font-family:'宋体';">寻找目录中的配额规格</span></p> 
  <p>9.1 <span style="font-family:'宋体';">列出已将配额规范分配至的当前域中的所有账户</span></p> 
  <p>Dsquery quota domainroot</p> 
  <p>9.2 <span style="font-family:'宋体';">要列出名字以</span> Jon <span style="font-family:'宋体';">开头，已经有委派配额的的所有使用者名称</span></p> 
  <p>dsquery user -name jon* | dsquery quota domainroot -acct | dsget quota-acct</p> 
  <p>10. dsquery partition - <span style="font-family:'宋体';">寻找目录中的磁盘分区</span></p> 
  <p>10.1 <span style="font-family:'宋体';">列出当前目录林中所有目录分区的可分辨名称</span></p> 
  <p>Dsquery partition</p> 
  <p>10.2 <span style="font-family:'宋体';">要列出树系中所有目录分区开头是</span>SQL <span style="font-family:'宋体';">的一般名称，请输入</span>:</p> 
  <p>dsquery partition -part SQL*</p> 
  <p>10.3 <span style="font-family:'宋体';">列出</span>AD Server <a href="***wlan" rel="nofollow"><span style="text-decoration:underline;">192.168.1.1</span></a><span style="font-family:'宋体';">所有磁盘分区</span></p> 
  <p>dsquery partition -s 192.168.1.1</p> 
  <p>11. dsquery * - <span style="font-family:'宋体';">使用标准的</span> LDAP <span style="font-family:'宋体';">查询在目录中寻找任何对象</span></p> 
  <p>11.1 <span style="font-family:'宋体';">使用</span> dsquery * <span style="font-family:'宋体';">命令，可以显示目录中提供对象的任选一组属性。例如，显示对象</span> DN <span style="font-family:'宋体';">为</span>ou=Test,dc=microsoft,dc=com <span style="font-family:'宋体';">的</span>sAMAccountName<span style="font-family:'宋体';">、</span>userPrincipalName<span style="font-family:'宋体';">和部门属性</span>:</p> 
  <p>dsquery * ou=Test,dc=microsoft,dc=com -scope base -attr sAMAccountNameuserPrincipalName department</p> 
  <p>11.2 <span style="font-family:'宋体';">读取对象</span> DN <span style="font-family:'宋体';">为</span> ou=Test,dc=microsoft,dc=com <span style="font-family:'宋体';">的所有属性</span>:</p> 
  <p>dsquery * ou=Test,dc=microsoft,dc=com -scope base -attr *</p> 
  <p>11.3 <span style="font-family:'宋体';">寻找目前网域中</span> SAM <span style="font-family:'宋体';">帐户名称以<a class="infotextkey" href="***tags-%E5%AD%97%E7%AC%A6%E4%B8%B2-0.html" rel="nofollow">字符串</a></span> "jon" <span style="font-family:'宋体';">开头的所有用户，并以表格的格式显示它们的</span> SAM <span style="font-family:'宋体';">帐户名称、用户主要名称</span> (UPN) <span style="font-family:'宋体';">和部门</span>:</p> 
  <p>dsquery * domainroot -filter"(&amp;(objectCategory=Person)(objectClass=User)(sAMAccountName=jon*))"-attr sAMAccountName userPrincipalName department</p> 
  <p>11.4 <span style="font-family:'宋体';">读取对象</span> DN <span style="font-family:'宋体';">为</span> ou=Test,dc=microsoft,dc=com <span style="font-family:'宋体';">的</span> sAMAccountName<span style="font-family:'宋体';">、</span>userPrincipalName<span style="font-family:'宋体';">和部门属性</span>:</p> 
  <p>Dsquery *ou=Test,dc=microsoft,dc=com -scope base -attr sAMAccountName userPrincipalNamedepartment</p> 
  <p>11.5 <span style="font-family:'宋体';">读取对象</span> DN <span style="font-family:'宋体';">为</span> ou=Test,dc=microsoft,dc=com <span style="font-family:'宋体';">的所有属性</span>:</p> 
  <p>Dsquery * ou=Test,dc=microsoft,dc=com -scope base -attr *</p> 
  <p>11.6 <span style="font-family:'宋体';">读取其可分辨名称为</span>OU=test,DC=test,DC=COM<span style="font-family:'宋体';">的对象的</span>SAM<span style="font-family:'宋体';">账户名，用户主体名称和部门属性</span></p> 
  <p>dsquery *ou=test,dc=test,dc=com -scope base -attr SamAccountName userPrincipalNamedepartment</p> 
  <p></p> 
 </div> 
</div> 
<p>转载于:https://blog.51cto.com/122269875/1716414</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ac7ae7d4064e6504e0369b4a8e9fccfe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">消息机制Too many arguments to function call错误</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c5c6f94ffa70933e82a597c06e4b98f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">细数Scala下划线“_”的用法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>