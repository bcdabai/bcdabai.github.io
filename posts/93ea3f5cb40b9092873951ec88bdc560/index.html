<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pt-online-schema-change - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pt-online-schema-change" />
<meta property="og:description" content="pt-online-schema-change NAME pt-online-schema-change - ALTER tables without locking them.
------------------------------------------------------------------------------------
目前InnoDB引擎是通过以下步骤来进行DDL的：
1 按照原始表（original_table）的表结构和DDL语句，新建一个不可见的临时表（tmp_table）
2 在原表上加write lock，阻塞所有更新操作（insert、delete、update等）
3 执行insert into tmp_table select * from original_table
4 rename original_table和tmp_table，最后drop original_table
5 释放 write lock。
我们可以看见在InnoDB执行DDL的时候，原表是只能读不能写的。为此 perconal 推出一个工具 pt-online-schema-change ，其特点是修改过程中不会造成读写阻塞。
工作原理：
如果表有外键，除非使用 –alter-foreign-keys-method 指定特定的值，否则工具不予执行。
1 创建一个和你要执行 alter 操作的表一样的空表结构。
2 执行表结构修改，然后从原表中的数据到copy到 表结构修改后的表，
3 在原表上创建触发器将 copy 数据的过程中，在原表的更新操作 更新到新表.
注意:如果表中已经定义了触发器这个工具就不能工作了。
4 copy 完成以后，用rename table 新表代替原表，默认删除原表。
用法介绍：
pt-online-schema-change [OPTIONS] DSN
options 可以自行查看 help，DNS 为你要操作的数据库和表。这里有两个参数需要介绍一下：
–dry-run
这个参数不建立触发器，不拷贝数据，也不会替换原表。只是创建和更改新表。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/93ea3f5cb40b9092873951ec88bdc560/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-12-24T15:17:03+08:00" />
<meta property="article:modified_time" content="2016-12-24T15:17:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pt-online-schema-change</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="artical-content-bak main-content editor-side-new"> 
 <div class="con editor-preview-side" id="result"> 
  <h2 id="pt-online-schema-change-1" style="font-family:'Open Sans', sans-serif;line-height:36px;color:rgb(51,51,51);font-size:32px;"><span class="anchor-wrapper"><span class="program">pt-online-schema-change</span></span></h2> 
  <h3 id="n-a-m-e" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">NAME</span></h3> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> - ALTER tables without locking them.</p> 
  <p style="line-height:26px;">------------------------------------------------------------------------------------</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">目前InnoDB引擎是通过以下步骤来进行DDL的：<br>1 按照原始表（original_table）的表结构和DDL语句，新建一个不可见的临时表（tmp_table）<br>2 在原表上加write lock，阻塞所有更新操作（insert、delete、update等）<br>3 执行insert into tmp_table <a href="http://www.111cn.net/tags.php/select/" rel="nofollow" style="font-size:15px;color:rgb(45,100,179);">select</a> * from original_table<br>4 rename original_table和tmp_table，最后drop original_table<br>5 释放 write lock。<br>我们可以看见在InnoDB执行DDL的时候，原表是只能读不能写的。为此 perconal 推出一个工具 pt-online-schema-change ，其特点是修改过程中不会造成读写阻塞。<br>工作原理：<br>如果表有外键，除非使用 –alter-foreign-keys-method 指定特定的值，否则工具不予执行。<br>1 创建一个和你要执行 alter 操作的表一样的空表结构。<br>2 执行表结构修改，然后从原表中的数据到copy到 表结构修改后的表，<br>3 在原表上创建<a href="http://www.111cn.net/tags.php/%B4%A5%B7%A2%C6%F7/" rel="nofollow" style="font-size:15px;color:rgb(45,100,179);">触发器</a>将 copy 数据的过程中，在原表的更新操作 更新到新表.<br>注意:如果表中已经定义了触发器这个工具就不能工作了。<br>4 copy 完成以后，用rename table 新表代替原表，默认删除原表。</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">用法介绍：<br>pt-online-schema-change [OPTIONS] DSN<br>options 可以自行查看 help，DNS 为你要操作的<a href="http://www.111cn.net/list-55/" rel="nofollow" style="font-size:15px;color:rgb(45,100,179);">数据库</a>和表。这里有两个参数需要介绍一下：<br>–dry-run<br>这个参数不建立触发器，不拷贝数据，也不会替换原表。只是创建和更改新表。<br>–execute<br>这个参数的作用和前面工作原理的介绍的一样，会建立触发器，来保证最新变更的数据会影响至新表。注意：如果不加这个参数，这个工具会在执行一些检查后退出。</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">依赖条件<br>1操作的表必须有主键否则 报如下错误。</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">[root@rac1 bin]#  ./pt-online-schema-change -u root -h 10.250.7.50  -p yang --alter='add column vid int ' --execute D=houyi,t=ga<br>Cannot connect to D=houyi,h=127.0.0.1,p=...,u=root<br>Cannot chunk the original table `houyi`.`ga`: There is no good index and the table is oversized. at ./pt-online-schema-change line 5353.<br>测试例子：<br>1 添加字段</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">[root@rac1 bin]#  ./pt-online-schema-change -u root -h 10.250.7.50  -p yang --alter='add column vid int ' --execute D=houyi,t=ga<br>Cannot connect to D=houyi,h=127.0.0.1,p=...,u=root<br>Operation, tries, wait:<br>  copy_rows, 10, 0.25<br>  create_triggers, 10, 1<br>  drop_triggers, 10, 1<br>  swap_tables, 10, 1<br>  update_foreign_keys, 10, 1<br>Altering `houyi`.`ga`...<br>Creating new table...<br>Created new table houyi._ga_new OK.<br>Altering new table...<br>Altered `houyi`.`_ga_new` OK.<br>Creating triggers...<br>Created triggers OK.<br>Copying approximately 746279 rows...<br>Copied rows OK.<br>Swapping tables...<br>Swapped original and new tables OK.<br>Dropping old table...<br>Dropped old table `houyi`.`_ga_old` OK.<br>Dropping triggers...<br>Dropped triggers OK.<br>Successfully altered `houyi`.`ga`.<br>2 添加索引</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">[root@rac1 bin]# ./pt-online-schema-change -u root -h 10.250.7.50  -p yang --alter='add key indx_vid(vid) ' --execute D=houyi,t=ga<br>3 删除字段</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">[root@rac1 bin]# ./pt-online-schema-change -u root -h 10.250.7.50  -p yang --alter='drop  column vid ' --execute D=houyi,t=ga<br>++++++++++++++++++++++++++++文艺青年分割线+++++++++++++++++++++++++++<br>所谓的文艺用法,就是通过OSC实现slave和master数据差异时候的恢复.有人说,这个是pt-table-sync该干的事情.但是在表数据差异较大的时候,使用OSC可能效率更好,而且更加简单可靠.<br>OSC如何实现master到slave的数据差异恢复的?<br>由于OSC的原理是新建表和使用触发器.然后把原表的数据insert into select from的方式导入新表.如果这个时候,我们把binlog改成row格式.那么insert into记录的肯定是源表的数据了.触发器在row格式的时候,也是在日志中记录的源表数据.也就是说,通过OSC可以逻辑的,无阻塞的把源表的数据同步到所有slave.</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">pt-online-schema-change –set-vars ‘binlog_format=ROW’ –alter ‘engine=INNODB’ D=test,t=tt1,h=localhost –execute<br>如果你本来就工作在row格式下,那么–set-vars ‘binlog_format=ROW’就可以不设置了.</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br>详细原理解剖,转自http://hi.baidu.com/ytjwt/item/7ea9c637c29079f6e6bb7a0d<br>pt-online-schema-change在线更改表结构的实现核心有如下几个过程：<br>（注：在跟改过程中涉及到三个表：原表、tmp_table即作为原表导数据的临时表，old_table在最后rename 原表的结果表）<br>1、CREATE TABLE `$db`.`$tmp_tbl` LIKE`$db`.`$tbl`” 新建tmp_table，表结构同原表<br>2、在tmp_table上更改表结构为需要的表结构<br>3、在原表上建立三个触发器，如下：<br>（1）CREATETRIGGER mk_osc_del AFTER DELETE ON $table ” “FOR EACH ROW ”<br>“DELETE IGNORE FROM $new_table “”WHERE$new_table.$chunk_column = OLD.$chunk_column”;<br>（2）CREATETRIGGER mk_osc_ins AFTER INSERT ON $table ” “FOR EACH ROW ”<br>“REPLACEINTO $new_table ($columns) ” “VALUES($new_values)”;<br>（3）CREATETRIGGER mk_osc_upd AFTER UPDATE ON $table ” “FOR EACH ROW ”<br>“REPLACE INTO $new_table ($columns) “”VALUES ($new_values)”;</p> 
  <p style="list-style:none;font-size:14px;line-height:26px;color:rgb(68,68,68);font-family:Simsun;">我们可以看到这三个触发器分别对应于INSERT、UPDATE、DELETE三种操作：<br>（1）mk_osc_del，DELETE操作，我们注意到DELETEIGNORE，当新有数据时，我们才进行操作，也就是说，当在后续导入过程中，如果删除的这个数据还未导入到新表，那么我们可以不在新表执行操作，因为在以后的导入过程中，原表中改行数据已经被删除，已经没有数据，那么他也就不会导入到新表中；<br>（2）mk_osc_ins，INSERT操作，所有的INSERT INTO全部转换为REPLACEINTO，为了确保数据的一致性，当有新数据插入到原表时，如果触发器还未把原表数据未同步到新表，这条数据已经被导入到新表了，那么我们就可以利用replaceinto进行覆盖，这样数据也是一致的<br>（3）mk_osc_upd UPDATE操作，所有的UPDATE也转换为REPLACEINTO，因为当跟新的数据的行还未同步到新表时，新表是不存在这条记录的，那么我们就只能插入该条数据，如果已经同步到新表了，那么也可以进行覆盖插入，所有数据与原表也是一致的；<br>我们也能看出上述的精髓也就这这几条replaceinto操作，正是因为这几条replaceinto才能保证数据的一致性<br>4、拷贝原表数据到临时表中，在脚本中使用如下语句<br>INSERT IGNORE INTO $to_table ($columns) ” “SELECT $columns FROM $from_table “”WHERE ($chunks-&gt;[$chunkno])”，我们能看到他是通过一些查询（基本为主键、唯一键值）分批把数据导入到新的表中，在导入前，我们能通过参数–chunk-size对每次导入行数进行控制，已减少对原表的锁定时间，并且在导入时，我们能通过—sleep参数控制，在每个chunk导入后与下一次chunk导入开始前sleep一会，sleep时间越长，对于磁盘IO的冲击就越小<br>5、Rename 原表到old表中，在把临时表Rename为原表，<br>“RENAME TABLE `$db`.`$tmp_tbl`TO `$db`.`$tbl`”; 在rename过程，其实我们还是会导致写入读取堵塞的，所以从严格意思上说，我们的OSC也不是对线上环境没有一点影响，但由于rename操作只是一个修改名字的过程，也只会修改一些表的信息，基本是瞬间结束，故对线上影响不太大<br>6、清理以上过程中的不再使用的数据，如OLD表。</p> 
  <p style="line-height:26px;">-------------------------------------------------------------------------------------------</p> 
  <h3 id="s-y-n-o-p-s-i-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">SYNOPSIS</span></h3> 
  <h4 id="usage-1" style="font-family:inherit;line-height:36px;color:inherit;font-size:26px;"><span class="anchor-wrapper">Usage</span></h4> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">pt-online-schema-change [OPTIONS] DSN</pre> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> alters a table’s structure without blocking reads or writes. Specify the database and table in the DSN. Do not use this tool before reading its documentation and checking your backups carefully.</p> 
  <p style="line-height:26px;">Add a column to sakila.actor:</p> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">pt-online-schema-change --alter "ADD COLUMN c1 INT" D=sakila,t=actor</pre> 
  <p style="line-height:26px;">Change sakila.actor to InnoDB, effectively performing OPTIMIZE TABLE in a non-blocking fashion because it is already an InnoDB table:</p> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">pt-online-schema-change --alter "ENGINE=InnoDB" D=sakila,t=actor</pre> 
  <h3 id="r-i-s-k-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">RISKS</span></h3> 
  <p style="line-height:26px;">The following section is included to inform users about the potential risks, whether known or unknown, of using this tool. The two main categories of risks are those created by the nature of the tool (e.g. read-only tools vs. read-write tools) and those created by bugs.</p> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> modifies data and structures. You should be careful with it, and test it before using it in production. You should also ensure that you have recoverable backups before using this tool.</p> 
  <p style="line-height:26px;">At the time of this release, we know of no bugs that could cause harm to users.</p> 
  <p style="line-height:26px;">The authoritative source for updated information is always the online issue tracking system. Issues that affect this tool will be marked as such. You can see a list of such issues at the following URL: <a class="reference external" href="http://www.percona.com/bugs/pt-online-schema-change" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://www.percona.com/bugs/pt-online-schema-change</a>.</p> 
  <p style="line-height:26px;">See also “BUGS” for more information on filing bugs and getting help.</p> 
  <h3 id="d-e-s-c-r-i-p-t-i-o-n" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">DESCRIPTION</span></h3> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> emulates the way that MySQL alters tables internally, but it works on a copy of the table you wish to alter. This means that the original table is not locked, and clients may continue to read and change data in it.</p> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> works by creating an empty copy of the table to alter, modifying it as desired, and then copying rows from the original table into the new table. When the copy is complete, it moves away the original table and replaces it with the new one. By default, it also drops the original table.</p> 
  <p style="line-height:26px;">The data copy process is performed in small chunks of data, which are varied to attempt to make them execute in a specific amount of time (see <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-time" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-time</em></a>). This process is very similar to how other tools, such as pt-table-checksum, work. Any modifications to data in the original tables during the copy will be reflected in the new table, because the tool creates triggers on the original table to update the corresponding rows in the new table. The use of triggers means that the tool will not work if any triggers are already defined on the table.</p> 
  <p style="line-height:26px;">When the tool finishes copying data into the new table, it uses an atomic <tt class="docutils literal"><span class="pre">RENAME</span> <span class="pre">TABLE</span></tt> operation to simultaneously rename the original and new tables. After this is complete, the tool drops the original table.</p> 
  <p style="line-height:26px;">Foreign keys complicate the tool’s operation and introduce additional risk. The technique of atomically renaming the original and new tables does not work when foreign keys refer to the table. The tool must update foreign keys to refer to the new table after the schema change is complete. The tool supports two methods for accomplishing this. You can read more about this in the documentation for <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--alter-foreign-keys-method" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--alter-foreign-keys-method</em></a>.</p> 
  <p style="line-height:26px;">Foreign keys also cause some side effects. The final table will have the same foreign keys and indexes as the original table (unless you specify differently in your ALTER statement), but the names of the objects may be changed slightly to avoid object name collisions in MySQL and InnoDB.</p> 
  <p style="line-height:26px;">For safety, the tool does not modify the table unless you specify the <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--execute" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--execute</em></a> option, which is not enabled by default. The tool supports a variety of other measures to prevent unwanted load or other problems, including automatically detecting replicas, connecting to them, and using the following safety checks:</p> 
  <ul class="simple list-paddingleft-2"><li><p>The tool refuses to operate if it detects replication filters. See <em class="xref std std-option">--[no]check-replication-filters</em> for details.</p></li><li><p>The tool pauses the data copy operation if it observes any replicas that are delayed in replication. See <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--max-lag" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--max-lag</em></a> for details.</p></li><li><p>The tool pauses or aborts its operation if it detects too much load on the server. See <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--max-load" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--max-load</em></a> and <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--critical-load" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--critical-load</em></a>for details.</p></li><li><p>The tool sets its lock wait timeout to 1 second so that it is more likely to be the victim of any lock contention, and less likely to disrupt other transactions. See <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--lock-wait-timeout" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--lock-wait-timeout</em></a> for details.</p></li><li><p>The tool refuses to alter the table if foreign key constraints reference it, unless you specify <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--alter-foreign-keys-method" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--alter-foreign-keys-method</em></a>.</p></li><li><p>The tool cannot alter MyISAM tables on “Percona XtraDB Cluster” nodes.</p></li></ul> 
  <h3 id="percona-xtra-d-b-cluster" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">Percona XtraDB Cluster</span></h3> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> works with Percona XtraDB Cluster (PXC) 5.5.28-23.7 and newer, but there are two limitations: only InnoDB tables can be altered, and <tt class="docutils literal">wsrep_OSU_method</tt> must be set to <tt class="docutils literal">TOI</tt> (total order isolation). The tool exits with an error if the host is a cluster node and the table is MyISAM or is being converted to MyISAM (<tt class="docutils literal">ENGINE=MyISAM</tt>), or if <tt class="docutils literal">wsrep_OSU_method</tt> is not <tt class="docutils literal">TOI</tt>. There is no way to disable these checks.</p> 
  <h3 id="o-u-t-p-u-t" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">OUTPUT</span></h3> 
  <p style="line-height:26px;">The tool prints information about its activities to STDOUT so that you can see what it is doing. During the data copy phase, it prints <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--progress" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--progress</em></a> reports to STDERR. You can get additional information by specifying <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--print" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--print</em></a>.</p> 
  <p style="line-height:26px;">If <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--statistics" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--statistics</em></a> is specified, a report of various internal event counts is printed at the end, like:</p> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);"># Event  Count# ====== =====# INSERT     1</pre> 
  <h3 id="o-p-t-i-o-n-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">OPTIONS</span></h3> 
  <p style="line-height:26px;"><a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--dry-run" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--dry-run</em></a> and <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--execute" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--execute</em></a> are mutually exclusive.</p> 
  <p style="line-height:26px;">This tool accepts additional command-line arguments. Refer to the “SYNOPSIS” and usage information for details.</p> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--alter</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string</p><p style="line-height:26px;">The schema modification, without the ALTER TABLE keywords. You can perform multiple modifications to the table by specifying them with commas. Please refer to the MySQL manual for the syntax of ALTER TABLE.</p><p style="line-height:26px;">The following limitations apply which, if attempted, will cause the tool to fail in unpredictable ways:</p> 
    <ul style="list-style-type:square;" class="list-paddingleft-2"><li><p class="first" style="line-height:26px;">The <tt class="docutils literal">RENAME</tt> clause cannot be used to rename the table.</p></li><li><p class="first" style="line-height:26px;">Columns cannot be renamed by dropping and re-adding with the new name. The tool will not copy the original column’s data to the new column.</p></li><li><p class="first" style="line-height:26px;">If you add a column without a default value and make it NOT NULL, the tool will fail, as it will not try to guess a default value for you; You must specify the default.</p></li><li><p class="first" style="line-height:26px;"><tt class="docutils literal"><span class="pre">DROP</span> <span class="pre">FOREIGN</span> <span class="pre">KEY</span> <span class="pre">constraint_name</span></tt> requires specifying <tt class="docutils literal">_constraint_name</tt> rather than the real <tt class="docutils literal">constraint_name</tt>. Due to a limitation in MySQL, <span class="program" style="font-weight:700;">pt-online-schema-change</span> adds a leading underscore to foreign key constraint names when creating the new table. For example, to drop this contraint:</p><pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">CONSTRAINT `fk_foo` FOREIGN KEY (`foo_id`) REFERENCES `bar` (`foo_id`)</pre><p style="line-height:26px;">You must specify <tt class="docutils literal"><span class="pre">--alter</span> <span class="pre">"DROP</span> <span class="pre">FOREIGN</span> <span class="pre">KEY</span> <span class="pre">_fk_foo"</span></tt>.</p></li><li><p class="first" style="line-height:26px;">The tool does not use <tt class="docutils literal"><span class="pre">LOCK</span> <span class="pre">IN</span> <span class="pre">SHARE</span> <span class="pre">MODE</span></tt> with MySQL 5.0 because it can cause a slave error which breaks replication:</p><pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">Query caused different errors on master and slave. Error on master:'Deadlock found when trying to get lock; try restarting transaction' (1213),
Error on slave: 'no error' (0). Default database: 'pt_osc'.
Query: 'INSERT INTO pt_osc.t (id, c) VALUES ('730', 'new row')'</pre><p style="line-height:26px;">The error happens when converting a MyISAM table to InnoDB because MyISAM is non-transactional but InnoDB is transactional. MySQL 5.1 and newer handle this case correctly, but testing reproduces the error 5% of the time with MySQL 5.0.</p><p style="line-height:26px;">This is a MySQL bug, similar to <a class="reference external" href="http://bugs.mysql.com/bug.php?id=45694" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://bugs.mysql.com/bug.php?id=45694</a>, but there is no fix or workaround in MySQL 5.0. Without <tt class="docutils literal"><span class="pre">LOCK</span> <span class="pre">IN</span> <span class="pre">SHARE</span> <span class="pre">MODE</span></tt>, tests pass 100% of the time, so the risk of data loss or breaking replication should be negligible.</p><p style="line-height:26px;"><span style="font-weight:700;">Be sure to verify the new table if using MySQL 5.0 and converting from MyISAM to InnoDB!</span></p></li></ul></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--alter-foreign-keys-method</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string</p><p style="line-height:26px;">How to modify foreign keys so they reference the new table. Foreign keys that reference the table to be altered must be treated specially to ensure that they continue to reference the correct table. When the tool renames the original table to let the new one take its place, the foreign keys “follow” the renamed table, and must be changed to reference the new table instead.</p><p style="line-height:26px;">The tool supports two techniques to achieve this. It automatically finds “child tables” that reference the table to be altered.</p><p style="line-height:26px;">auto</p> 
    <blockquote style="font-size:17.5px;border-left-width:0px;"> 
     <p>Automatically determine which method is best. The tool uses <tt class="docutils literal">rebuild_constraints</tt> if possible (see the description of that method for details), and if not, then it uses <tt class="docutils literal">drop_swap</tt>.</p> 
    </blockquote><p style="line-height:26px;">rebuild_constraints</p> 
    <blockquote style="font-size:17.5px;border-left-width:0px;"> 
     <p style="font-size:15px;line-height:26px;">This method uses <tt class="docutils literal"><span class="pre">ALTER</span> <span class="pre">TABLE</span></tt> to drop and re-add foreign key constraints that reference the new table. This is the preferred technique, unless one or more of the “child” tables is so large that the <tt class="docutils literal">ALTER</tt> would take too long. The tool determines that by comparing the number of rows in the child table to the rate at which the tool is able to copy rows from the old table to the new table. If the tool estimates that the child table can be altered in less time than the <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-time" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-time</em></a>, then it will use this technique. For purposes of estimating the time required to alter the child table, the tool multiplies the row-copying rate by <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-size-limit" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-size-limit</em></a>, because MySQL’s <tt class="docutils literal"><span class="pre">ALTER</span> <span class="pre">TABLE</span></tt> is typically much faster than the external process of copying rows.</p> 
     <p style="font-size:15px;line-height:26px;">Due to a limitation in MySQL, foreign keys will not have the same names after the ALTER that they did prior to it. The tool has to rename the foreign key when it redefines it, which adds a leading underscore to the name. In some cases, MySQL also automatically renames indexes required for the foreign key.</p> 
    </blockquote><p style="line-height:26px;">drop_swap</p> 
    <blockquote style="font-size:17.5px;border-left-width:0px;"> 
     <p style="font-size:15px;line-height:26px;">Disable foreign key checks (FOREIGN_KEY_CHECKS=0), then drop the original table before renaming the new table into its place. This is different from the normal method of swapping the old and new table, which uses an atomic<tt class="docutils literal">RENAME</tt> that is undetectable to client applications.</p> 
     <p style="font-size:15px;line-height:26px;">This method is faster and does not block, but it is riskier for two reasons. First, for a short time between dropping the original table and renaming the temporary table, the table to be altered simply does not exist, and queries against it will result in an error. Secondly, if there is an error and the new table cannot be renamed into the place of the old one, then it is too late to abort, because the old table is gone permanently.</p> 
     <p style="font-size:15px;line-height:26px;">This method forces <tt class="docutils literal">--no-swap-tables</tt> and <tt class="docutils literal">--no-drop-old-table</tt>.</p> 
    </blockquote><p style="line-height:26px;">none</p> 
    <blockquote style="font-size:17.5px;border-left-width:0px;"> 
     <p style="font-size:15px;line-height:26px;">This method is like <tt class="docutils literal">drop_swap</tt> without the “swap”. Any foreign keys that referenced the original table will now reference a nonexistent table. This will typically cause foreign key violations that are visible in <tt class="docutils literal"><span class="pre">SHOW</span> <span class="pre">ENGINE</span> <span class="pre">INNODB</span><span class="pre">STATUS</span></tt>, similar to the following:</p> 
     <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">Trying to add to index `idx_fk_staff_id` tuple:
DATA TUPLE: 2 fields;
0: len 1; hex 05; asc  ;;
1: len 4; hex 80000001; asc     ;;
But the parent table `sakila`.`staff_old`or its .ibd file does not currently exist!</pre> 
     <p style="font-size:15px;line-height:26px;">This is because the original table (in this case, sakila.staff) was renamed to sakila.staff_old and then dropped. This method of handling foreign key constraints is provided so that the database administrator can disable the tool’s built-in functionality if desired.</p> 
    </blockquote></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--ask-pass</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Prompt for a password when connecting to MySQL.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--charset</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -A; type: string</p><p style="line-height:26px;">Default character set. If the value is utf8, sets Perl’s binmode on STDOUT to utf8, passes the mysql_enable_utf8 option to DBD::mysql, and runs SET NAMES UTF8 after connecting to MySQL. Any other value sets binmode on STDOUT without the utf8 layer, and runs SET NAMES after connecting to MySQL.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--check-interval</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: time; default: 1</p><p style="line-height:26px;">Sleep time between checks for <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--max-lag" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--max-lag</em></a>.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--[no]check-alter</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">default: yes</p><p style="line-height:26px;">Parses the <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--alter" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--alter</em></a> specified and tries to warn of possible unintended behavior. Currently, it checks for:</p><p style="line-height:26px;">Column renames</p> 
    <blockquote style="font-size:17.5px;border-left-width:0px;"> 
     <p>In previous versions of the tool, renaming a column with <tt class="docutils literal"><span class="pre">CHANGE</span> <span class="pre">COLUMN</span> <span class="pre">name</span> <span class="pre">new_name</span></tt> would lead to that column’s data being lost. The tool now parses the alter statement and tries to catch these cases, so the renamed columns should have the same data as the originals. However, the code that does this is not a full-blown SQL parser, so you should first run the tool with <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--dry-run" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--dry-run</em></a> and <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--print" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--print</em></a> and verify that it detects the renamed columns correctly.</p> 
    </blockquote><p style="line-height:26px;">DROP PRIMARY KEY</p> 
    <blockquote style="font-size:17.5px;border-left-width:0px;"> 
     <p>If <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--alter" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--alter</em></a> contain <tt class="docutils literal"><span class="pre">DROP</span> <span class="pre">PRIMARY</span> <span class="pre">KEY</span></tt> (case- and space-insensitive), a warning is printed and the tool exits unless <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--dry-run" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--dry-run</em></a> is specified. Altering the primary key can be dangerous, but the tool can handle it. The tool’s triggers, particularly the DELETE trigger, are most affected by altering the primary key because the tool prefers to use the primary key for its triggers. You should first run the tool with <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--dry-run" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--dry-run</em></a> and <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--print" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--print</em></a> and verify that the triggers are correct.</p> 
    </blockquote></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--[no]check-plan</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">default: yes</p><p style="line-height:26px;">Check query execution plans for safety. By default, this option causes the tool to run EXPLAIN before running queries that are meant to access a small amount of data, but which could access many rows if MySQL chooses a bad execution plan. These include the queries to determine chunk boundaries and the chunk queries themselves. If it appears that MySQL will use a bad query execution plan, the tool will skip the chunk of the table.</p><p style="line-height:26px;">The tool uses several heuristics to determine whether an execution plan is bad. The first is whether EXPLAIN reports that MySQL intends to use the desired index to access the rows. If MySQL chooses a different index, the tool considers the query unsafe.</p><p style="line-height:26px;">The tool also checks how much of the index MySQL reports that it will use for the query. The EXPLAIN output shows this in the key_len column. The tool remembers the largest key_len seen, and skips chunks where MySQL reports that it will use a smaller prefix of the index. This heuristic can be understood as skipping chunks that have a worse execution plan than other chunks.</p><p style="line-height:26px;">The tool prints a warning the first time a chunk is skipped due to a bad execution plan in each table. Subsequent chunks are skipped silently, although you can see the count of skipped chunks in the SKIPPED column in the tool’s output.</p><p style="line-height:26px;">This option adds some setup work to each table and chunk. Although the work is not intrusive for MySQL, it results in more round-trips to the server, which consumes time. Making chunks too small will cause the overhead to become relatively larger. It is therefore recommended that you not make chunks too small, because the tool may take a very long time to complete if you do.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--[no]check-replication-filters</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">default: yes</p><p style="line-height:26px;">Abort if any replication filter is set on any server. The tool looks for server options that filter replication, such as binlog_ignore_db and replicate_do_db. If it finds any such filters, it aborts with an error.</p><p style="line-height:26px;">If the replicas are configured with any filtering options, you should be careful not to modify any databases or tables that exist on the master and not the replicas, because it could cause replication to fail. For more information on replication rules, see <a class="reference external" href="http://dev.mysql.com/doc/en/replication-rules.html" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://dev.mysql.com/doc/en/replication-rules.html</a>.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--check-slave-lag</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string</p><p style="line-height:26px;">Pause the data copy until this replica’s lag is less than <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--max-lag" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--max-lag</em></a>. The value is a DSN that inherits properties from the the connection options (<a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--port" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--port</em></a>, <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--user" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--user</em></a>, etc.). This option overrides the normal behavior of finding and continually monitoring replication lag on ALL connected replicas. If you don’t want to monitor ALL replicas, but you want more than just one replica to be monitored, then use the DSN option to the <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--recursion-method" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--recursion-method</em></a> option instead of this option.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--chunk-index</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string</p><p style="line-height:26px;">Prefer this index for chunking tables. By default, the tool chooses the most appropriate index for chunking. This option lets you specify the index that you prefer. If the index doesn’t exist, then the tool will fall back to its default behavior of choosing an index. The tool adds the index to the SQL statements in a <tt class="docutils literal"><span class="pre">FORCE</span> <span class="pre">INDEX</span></tt> clause. Be careful when using this option; a poor choice of index could cause bad performance.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--chunk-index-columns</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: int</p><p style="line-height:26px;">Use only this many left-most columns of a <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-index" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-index</em></a>. This works only for compound indexes, and is useful in cases where a bug in the MySQL query optimizer (planner) causes it to scan a large range of rows instead of using the index to locate starting and ending points precisely. This problem sometimes occurs on indexes with many columns, such as 4 or more. If this happens, the tool might print a warning related to the <em class="xref std std-option">--[no]check-plan</em> option. Instructing the tool to use only the first N columns of the index is a workaround for the bug in some cases.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--chunk-size</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: size; default: 1000</p><p style="line-height:26px;">Number of rows to select for each chunk copied. Allowable suffixes are k, M, G.</p><p style="line-height:26px;">This option can override the default behavior, which is to adjust chunk size dynamically to try to make chunks run in exactly <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-time" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-time</em></a> seconds. When this option isn’t set explicitly, its default value is used as a starting point, but after that, the tool ignores this option’s value. If you set this option explicitly, however, then it disables the dynamic adjustment behavior and tries to make all chunks exactly the specified number of rows.</p><p style="line-height:26px;">There is a subtlety: if the chunk index is not unique, then it’s possible that chunks will be larger than desired. For example, if a table is chunked by an index that contains 10,000 of a given value, there is no way to write a WHERE clause that matches only 1,000 of the values, and that chunk will be at least 10,000 rows large. Such a chunk will probably be skipped because of <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-size-limit" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-size-limit</em></a>.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--chunk-size-limit</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: float; default: 4.0</p><p style="line-height:26px;">Do not copy chunks this much larger than the desired chunk size.</p><p style="line-height:26px;">When a table has no unique indexes, chunk sizes can be inaccurate. This option specifies a maximum tolerable limit to the inaccuracy. The tool uses &lt;EXPLAIN&gt; to estimate how many rows are in the chunk. If that estimate exceeds the desired chunk size times the limit, then the tool skips the chunk.</p><p style="line-height:26px;">The minimum value for this option is 1, which means that no chunk can be larger than <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-size" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-size</em></a>. You probably don’t want to specify 1, because rows reported by EXPLAIN are estimates, which can be different from the real number of rows in the chunk. You can disable oversized chunk checking by specifying a value of 0.</p><p style="line-height:26px;">The tool also uses this option to determine how to handle foreign keys that reference the table to be altered. See <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--alter-foreign-keys-method" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--alter-foreign-keys-method</em></a> for details.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--chunk-time</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: float; default: 0.5</p><p style="line-height:26px;">Adjust the chunk size dynamically so each data-copy query takes this long to execute. The tool tracks the copy rate (rows per second) and adjusts the chunk size after each data-copy query, so that the next query takes this amount of time (in seconds) to execute. It keeps an exponentially decaying moving average of queries per second, so that if the server’s performance changes due to changes in server load, the tool adapts quickly.</p><p style="line-height:26px;">If this option is set to zero, the chunk size doesn’t auto-adjust, so query times will vary, but query chunk sizes will not. Another way to do the same thing is to specify a value for <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--chunk-size" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--chunk-size</em></a> explicitly, instead of leaving it at the default.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--config</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: Array</p><p style="line-height:26px;">Read this comma-separated list of config files; if specified, this must be the first option on the command line.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--critical-load</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: Array; default: Threads_running=50</p><p style="line-height:26px;">Examine SHOW GLOBAL STATUS after every chunk, and abort if the load is too high. The option accepts a comma-separated list of MySQL status variables and thresholds. An optional <tt class="docutils literal">=MAX_VALUE</tt> (or <tt class="docutils literal">:MAX_VALUE</tt>) can follow each variable. If not given, the tool determines a threshold by examining the current value at startup and doubling it.</p><p style="line-height:26px;">See <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--max-load" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--max-load</em></a> for further details. These options work similarly, except that this option will abort the tool’s operation instead of pausing it, and the default value is computed differently if you specify no threshold. The reason for this option is as a safety check in case the triggers on the original table add so much load to the server that it causes downtime. There is probably no single value of Threads_running that is wrong for every server, but a default of 50 seems likely to be unacceptably high for most servers, indicating that the operation should be canceled immediately.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--default-engine</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Remove <tt class="docutils literal">ENGINE</tt> from the new table.</p><p style="line-height:26px;">By default the new table is created with the same table options as the original table, so if the original table uses InnoDB, then the new table will use InnoDB. In certain cases involving replication, this may cause unintended changes on replicas which use a different engine for the same table. Specifying this option causes the new table to be created with the system’s default engine.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--defaults-file</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -F; type: string</p><p style="line-height:26px;">Only read mysql options from the given file. You must give an absolute pathname.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--[no]drop-new-table</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">default: yes</p><p style="line-height:26px;">Drop the new table if copying the original table fails.</p><p style="line-height:26px;">Specifying <tt class="docutils literal">--no-drop-new-table</tt> and <tt class="docutils literal">--no-swap-tables</tt> leaves the new, altered copy of the table without modifying the original table. The new table name is like <tt class="docutils literal">_TBL_new</tt> where <tt class="docutils literal">TBL</tt> is the table name.</p><p style="line-height:26px;">–no-drop-new-table does not work with <tt class="docutils literal"><span class="pre">alter-foreign-keys-method</span> <span class="pre">drop_swap</span></tt>.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--[no]drop-old-table</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">default: yes</p><p style="line-height:26px;">Drop the original table after renaming it. After the original table has been successfully renamed to let the new table take its place, and if there are no errors, the tool drops the original table by default. If there are any errors, the tool leaves the original table in place.</p><p style="line-height:26px;">If <tt class="docutils literal">--no-swap-tables</tt> is specified, then there is no old table to drop.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--dry-run</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Create and alter the new table, but do not create triggers, copy data, or replace the original table.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--execute</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Indicate that you have read the documentation and want to alter the table. You must specify this option to alter the table. If you do not, then the tool will only perform some safety checks and exit. This helps ensure that you have read the documentation and understand how to use this tool. If you have not read the documentation, then do not specify this option.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--help</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Show help and exit.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--host</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -h; type: string</p><p style="line-height:26px;">Connect to host.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--lock-wait-timeout</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: int; default: 1</p><p style="line-height:26px;">Set the session value of <tt class="docutils literal">innodb_lock_wait_timeout</tt>. This option helps guard against long lock waits if the data-copy queries become slow for some reason. Setting this option dynamically requires the InnoDB plugin, so this works only on newer InnoDB and MySQL versions. If the setting’s current value is greater than the specified value, and the tool cannot set the value as desired, then it prints a warning. If the tool cannot set the value but the current value is less than or equal to the desired value, there is no error.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--max-lag</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: time; default: 1s</p><p style="line-height:26px;">Pause the data copy until all replicas’ lag is less than this value. After each data-copy query (each chunk), the tool looks at the replication lag of all replicas to which it connects, using Seconds_Behind_Master. If any replica is lagging more than the value of this option, then the tool will sleep for <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--check-interval" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--check-interval</em></a> seconds, then check all replicas again. If you specify <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--check-slave-lag" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--check-slave-lag</em></a>, then the tool only examines that server for lag, not all servers. If you want to control exactly which servers the tool monitors, use the DSN value to <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--recursion-method" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--recursion-method</em></a>.</p><p style="line-height:26px;">The tool waits forever for replicas to stop lagging. If any replica is stopped, the tool waits forever until the replica is started. The data copy continues when all replicas are running and not lagging too much.</p><p style="line-height:26px;">The tool prints progress reports while waiting. If a replica is stopped, it prints a progress report immediately, then again at every progress report interval.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--max-load</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: Array; default: Threads_running=25</p><p style="line-height:26px;">Examine SHOW GLOBAL STATUS after every chunk, and pause if any status variables are higher than their thresholds. The option accepts a comma-separated list of MySQL status variables. An optional <tt class="docutils literal">=MAX_VALUE</tt> (or <tt class="docutils literal">:MAX_VALUE</tt>) can follow each variable. If not given, the tool determines a threshold by examining the current value and increasing it by 20%.</p><p style="line-height:26px;">For example, if you want the tool to pause when Threads_connected gets too high, you can specify “Threads_connected”, and the tool will check the current value when it starts working and add 20% to that value. If the current value is 100, then the tool will pause when Threads_connected exceeds 120, and resume working when it is below 120 again. If you want to specify an explicit threshold, such as 110, you can use either “Threads_connected:110” or “Threads_connected=110”.</p><p style="line-height:26px;">The purpose of this option is to prevent the tool from adding too much load to the server. If the data-copy queries are intrusive, or if they cause lock waits, then other queries on the server will tend to block and queue. This will typically cause Threads_running to increase, and the tool can detect that by running SHOW GLOBAL STATUS immediately after each query finishes. If you specify a threshold for this variable, then you can instruct the tool to wait until queries are running normally again. This will not prevent queueing, however; it will only give the server a chance to recover from the queueing. If you notice queueing, it is best to decrease the chunk time.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--password</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -p; type: string</p><p style="line-height:26px;">Password to use when connecting.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--pid</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string</p><p style="line-height:26px;">Create the given PID file. The file contains the process ID of the tool’s instance. The PID file is removed when the tool exits. The tool checks for the existence of the PID file when starting; if it exists and the process with the matching PID exists, the tool exits.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--port</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -P; type: int</p><p style="line-height:26px;">Port number to use for connection.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--print</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Print SQL statements to STDOUT. Specifying this option allows you to see most of the statements that the tool executes. You can use this option with <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--dry-run" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--dry-run</em></a>, for example.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--progress</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: array; default: time,30</p><p style="line-height:26px;">Print progress reports to STDERR while copying rows. The value is a comma-separated list with two parts. The first part can be percentage, time, or iterations; the second part specifies how often an update should be printed, in percentage, seconds, or number of iterations.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--quiet</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -q</p><p style="line-height:26px;">Do not print messages to STDOUT (disables <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--progress" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--progress</em></a>). Errors and warnings are still printed to STDERR.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--recurse</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: int</p><p style="line-height:26px;">Number of levels to recurse in the hierarchy when discovering replicas. Default is infinite. See also <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--recursion-method" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--recursion-method</em></a>.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--recursion-method</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: array; default: processlist,hosts</p><p style="line-height:26px;">Preferred recursion method for discovering replicas. Possible methods are:</p><pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">METHOD       USES===========  ==================processlist  SHOW PROCESSLIST
hosts        SHOW SLAVE HOSTSdsn=DSN      DSNs from a table
none         Do not find slaves</pre><p style="line-height:26px;">The processlist method is the default, because SHOW SLAVE HOSTS is not reliable. However, the hosts method can work better if the server uses a non-standard port (not 3306). The tool usually does the right thing and finds all replicas, but you may give a preferred method and it will be used first.</p><p style="line-height:26px;">The hosts method requires replicas to be configured with report_host, report_port, etc.</p><p style="line-height:26px;">The dsn method is special: it specifies a table from which other DSN strings are read. The specified DSN must specify a D and t, or a database-qualified t. The DSN table should have the following structure:</p><pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">CREATE TABLE `dsns` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `parent_id` int(11) DEFAULT NULL,
  `dsn` varchar(255) NOT NULL,
  PRIMARY KEY (`id`));</pre><p style="line-height:26px;">To make the tool monitor only the hosts 10.10.1.16 and 10.10.1.17 for replication lag, insert the values <tt class="docutils literal">h=10.10.1.16</tt> and<tt class="docutils literal">h=10.10.1.17</tt> into the table. Currently, the DSNs are ordered by id, but id and parent_id are otherwise ignored.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--retries</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: int; default: 3</p><p style="line-height:26px;">Retry a chunk this many times when there is a nonfatal error. Nonfatal errors are problems such as a lock wait timeout or the query being killed. This option applies to the data copy operation.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--set-vars</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string; default: wait_timeout=10000</p><p style="line-height:26px;">Set these MySQL variables. Immediately after connecting to MySQL, this string will be appended to SET and executed.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--socket</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -S; type: string</p><p style="line-height:26px;">Socket file to use for connection.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--statistics</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Print statistics about internal counters. This is useful to see how many warnings were suppressed compared to the number of INSERT.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--[no]swap-tables</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">default: yes</p><p style="line-height:26px;">Swap the original table and the new, altered table. This step completes the online schema change process by making the table with the new schema take the place of the original table. The original table becomes the “old table,” and the tool drops it unless you disable <em class="xref std std-option">--[no]drop-old-table</em>.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--user</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">short form: -u; type: string</p><p style="line-height:26px;">User for login if not current user.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--version</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">Show version and exit.</p></li></ul> 
  <ul class="option list-paddingleft-2"><li><p><tt class="descname">--version-check</tt><tt class="descclassname"></tt></p></li><li><p style="line-height:26px;">type: string; default: off</p><p style="line-height:26px;">Send program versions to Percona and print suggested upgrades and problems. Possible values for –version-check:</p><p style="line-height:26px;">https, http, auto, off</p><p style="line-height:26px;"><tt class="docutils literal">auto</tt> first tries using <tt class="docutils literal">https</tt>, and resorts to <tt class="docutils literal">http</tt> if that fails. Keep in mind that <tt class="docutils literal">https</tt> might not be available if<tt class="docutils literal">IO::Socket::SSL</tt> is not installed on your system, although <tt class="docutils literal"><span class="pre">--version-check</span> <span class="pre">http</span></tt> should work everywhere.</p><p style="line-height:26px;">The version check feature causes the tool to send and receive data from Percona over the web. The data contains program versions from the local machine. Percona uses the data to focus development on the most widely used versions of programs, and to suggest to customers possible upgrades and known bad versions of programs.</p><p style="line-height:26px;">For more information, visit <a class="reference external" href="http://www.percona.com/version-check" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://www.percona.com/version-check</a>.</p></li></ul> 
  <h3 id="d-s-n-o-p-t-i-o-n-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">DSN OPTIONS</span></h3> 
  <p style="line-height:26px;">These DSN options are used to create a DSN. Each option is given like <tt class="docutils literal">option=value</tt>. The options are case-sensitive, so P and p are not the same option. There cannot be whitespace before or after the <tt class="docutils literal">=</tt> and if the value contains whitespace it must be quoted. DSN options are comma-separated. See the percona-toolkit manpage for full details.</p> 
  <ul class="simple list-paddingleft-2"><li><p>A</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: charset; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Default character set.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>D</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: database; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Database for the old and new table.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>F</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: mysql_read_default_file; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Only read default options from the given file</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>h</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: host; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Connect to host.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>p</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: password; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Password to use when connecting.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>P</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: port; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Port number to use for connection.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>S</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: mysql_socket; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">Socket file to use for connection.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>t</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: table; copy: no</p> 
   <p style="font-size:15px;line-height:26px;">Table to alter.</p> 
  </blockquote> 
  <ul class="simple list-paddingleft-2"><li><p>u</p></li></ul> 
  <blockquote style="font-size:17.5px;border-left-width:0px;"> 
   <p style="font-size:15px;line-height:26px;">dsn: user; copy: yes</p> 
   <p style="font-size:15px;line-height:26px;">User for login if not current user.</p> 
  </blockquote> 
  <h3 id="e-n-v-i-r-o-n-m-e-n-t" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">ENVIRONMENT</span></h3> 
  <p style="line-height:26px;">The environment variable <tt class="docutils literal">PTDEBUG</tt> enables verbose debugging output to STDERR. To enable debugging and capture all output to a file, run the tool like:</p> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">PTDEBUG=1 pt-online-schema-change ... &gt; FILE 2&gt;&amp;1</pre> 
  <p style="line-height:26px;">Be careful: debugging output is voluminous and can generate several megabytes of output.</p> 
  <h3 id="s-y-s-t-e-m-r-e-q-u-i-r-e-m-e-n-" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">SYSTEM REQUIREMENTS</span></h3> 
  <p style="line-height:26px;">You need Perl, DBI, DBD::mysql, and some core packages that ought to be installed in any reasonably new version of Perl.</p> 
  <p style="line-height:26px;">This tool works only on MySQL 5.0.2 and newer versions, because earlier versions do not support triggers.</p> 
  <h3 id="b-u-g-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">BUGS</span></h3> 
  <p style="line-height:26px;">For a list of known bugs, see <a class="reference external" href="http://www.percona.com/bugs/pt-online-schema-change" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://www.percona.com/bugs/pt-online-schema-change</a>.</p> 
  <p style="line-height:26px;">Please report bugs at <a class="reference external" href="https://bugs.launchpad.net/percona-toolkit" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">https://bugs.launchpad.net/percona-toolkit</a>. Include the following information in your bug report:</p> 
  <ul class="simple list-paddingleft-2"><li><p>Complete command-line used to run the tool</p></li><li><p>Tool <a class="reference internal" href="https://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html#cmdoption-pt-online-schema-change--version" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;"><em class="xref std std-option">--version</em></a></p></li><li><p>MySQL version of all servers involved</p></li><li><p>Output from the tool including STDERR</p></li><li><p>Input files (log/dump/config files, etc.)</p></li></ul> 
  <p style="line-height:26px;">If possible, include debugging output by running the tool with <tt class="docutils literal">PTDEBUG</tt>; see “ENVIRONMENT”.</p> 
  <h3 id="d-o-w-n-l-o-a-d-i-n-g" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">DOWNLOADING</span></h3> 
  <p style="line-height:26px;">Visit <a class="reference external" href="http://www.percona.com/software/percona-toolkit/" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://www.percona.com/software/percona-toolkit/</a> to download the latest release of Percona Toolkit. Or, get the latest release from the command line:</p> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">wget percona.com/get/percona-toolkit.tar.gz

wget percona.com/get/percona-toolkit.rpm

wget percona.com/get/percona-toolkit.deb</pre> 
  <p style="line-height:26px;">You can also get individual tools from the latest release:</p> 
  <pre style="font-size:13px;line-height:1.42857;font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;border:1px dashed rgb(230,200,138);">wget percona.com/get/TOOL</pre> 
  <p style="line-height:26px;">Replace <tt class="docutils literal">TOOL</tt> with the name of any tool.</p> 
  <h3 id="a-u-t-h-o-r-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">AUTHORS</span></h3> 
  <p style="line-height:26px;">Daniel Nichter and Baron Schwartz</p> 
  <h3 id="a-c-k-n-o-w-l-e-d-g-m-e-n-t-s" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">ACKNOWLEDGMENTS</span></h3> 
  <p style="line-height:26px;">The “online schema change” concept was first implemented by Shlomi Noach in his tool <tt class="docutils literal">oak-online-alter-table</tt>, part of<a class="reference external" href="http://code.google.com/p/openarkkit/" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://code.google.com/p/openarkkit/</a>. Engineers at Facebook then built another version called <tt class="docutils literal">OnlineSchemaChange.php</tt>as explained by their blog post: <a class="reference external" href="http://tinyurl.com/32zeb86" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://tinyurl.com/32zeb86</a>. This tool is a hybrid of both approaches, with additional features and functionality not present in either.</p> 
  <h3 id="a-b-o-u-t-p-e-r-c-o-n-a-t-o-o-l-" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">ABOUT PERCONA TOOLKIT</span></h3> 
  <p style="line-height:26px;">This tool is part of Percona Toolkit, a collection of advanced command-line tools developed by Percona for MySQL support and consulting. Percona Toolkit was forked from two projects in June, 2011: Maatkit and Aspersa. Those projects were created by Baron Schwartz and developed primarily by him and Daniel Nichter, both of whom are employed by Percona. Visit <a class="reference external" href="http://www.percona.com/software/" rel="nofollow" style="color:rgb(191,49,25);text-decoration:none;">http://www.percona.com/software/</a> for more software developed by Percona.</p> 
  <h3 id="c-o-p-y-r-i-g-h-t-l-i-c-e-n-s-e-" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">COPYRIGHT, LICENSE, AND WARRANTY</span></h3> 
  <p style="line-height:26px;">This program is copyright 2011-2013 Percona Ireland Ltd.</p> 
  <p style="line-height:26px;">THIS PROGRAM IS PROVIDED “AS IS” AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.</p> 
  <p style="line-height:26px;">This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 2; OR the Perl Artistic License. On UNIX and similar systems, you can issue `man perlgpl’ or `man perlartistic’ to read these licenses.</p> 
  <p style="line-height:26px;">You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA.</p> 
  <h3 id="v-e-r-s-i-o-n" style="font-family:inherit;font-weight:400;line-height:36px;color:inherit;font-size:28px;"><span class="anchor-wrapper">VERSION</span></h3> 
  <p style="line-height:26px;"><span class="program" style="font-weight:700;">pt-online-schema-change</span> 2.1.10</p> 
  <p><br></p> 
 </div> 
</div> 
<p>转载于:https://blog.51cto.com/songlisha/1885751</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/91116f73b4f6d965057274db8394172d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">高德地图API开发应用-----地图显示&#43;定位&#43;marker</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8a1be4d66efb2b0d1a8d34c324c12f0c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据库mysql 主从方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>