<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql基础入门 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql基础入门" />
<meta property="og:description" content="1.2 数据库介绍 1.2.1 作用 数据库是用来存放数据的仓库
数据库中存放的是表，表中存放的是数据。
1.2.2 数据库的发展史 萌芽阶段：文件系统
最初始的数据库是用磁盘来存储数据的。文件就是最早的数据库。
第一代数据库：层次模型
优点：这是导航结构
优点：结构清晰，分类查询方便
缺点：有可能造成数据无效
第一代数据库：网状模型
网状模型解决了层次模型的数据不一致的问题，但没有解决导航问题。导航结构在查询中有时候效率低下，比如查询整个公司的四月的营业额。
第二阶段：关系模型
特点：
1、每个表都是独立的
2、通过关系字段将两个表连接起来
3、关系：两个表的公共字段
4、关系型数据库中多表联合查询效率低下。
多学一招：为了解决关系型数据库多表查询效率的问题，项目中使用了NoSQL(非关系型数据库，Redis、mongodb等等)，在数据库中按照键值对来存储，它是关系型数据库的补充。
1.2.3 SQL Structured Query Language（结构化查询语言），是用来操作关系型数据库的一门语言。这是一个关系型数据库的通用操作语言，也成为标准SQL，也叫SQL-92。
脚下留心：数据库的生产厂商为了占有市场份额，都会在标准SQL的基础上扩展一些自己的东西以吸引用户。
1.2.4 常用的关系型数据库 关系型数据库开发公司使用语言access微软公司SQLSQL Server微软公司T-SQLOracle甲骨文公司PL/SQLMySQL被甲骨文公司收购MySQL 思考：已知标准SQL可以在所有的关系型数据库上运行，在Oracle上编写的PL/SQL能否在MySQL上运行？
答：不可以，只能运行标准SQL
1.3 连接服务器 数据库是CS模式的软件，所以要连接数据库必须要有客户端软件。
MySQL数据库默认端口号是3306
1.3.1 window界面连接服务器 1、Navicat
2、MySQL-Front
1.3.2 通过web窗体连接 主要有浏览器就可以访问数据库
1.3.3 命令行连接 host	-h	主机 port	-P	端口号 （大写） user	-u	用户名 password	-p	密码 （小写） 例题
-- 连接数据库 F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -h127.0.0.1 -P3306 -uroot -proot -- 明文 -- 如果连接本地数据库 -h可以省略 如果服务器端口是3306，-P端口号也可以省略 F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -uroot -proot	-- 明文 -- 密文 F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -uroot -p Enter password: **** 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/41a1adfd8382cffd317ee91aaf8454a9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-30T18:26:40+08:00" />
<meta property="article:modified_time" content="2022-11-30T18:26:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql基础入门</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="12___0"></a>1.2 数据库介绍</h3> 
<h5><a id="121___2"></a>1.2.1 作用</h5> 
<p><img src="https://images2.imgbox.com/65/51/62pcrvkk_o.png" alt="1559957061817"></p> 
<p>数据库是用来存放数据的仓库</p> 
<p><img src="https://images2.imgbox.com/2f/fe/WZpbvDqr_o.png" alt="1559957123533"></p> 
<p>数据库中存放的是表，表中存放的是数据。</p> 
<h5><a id="122___16"></a>1.2.2 数据库的发展史</h5> 
<p>萌芽阶段：文件系统</p> 
<p>最初始的数据库是用磁盘来存储数据的。文件就是最早的数据库。</p> 
<p>第一代数据库：层次模型</p> 
<p><img src="https://images2.imgbox.com/b6/31/0xC3oIoI_o.png" alt="1559957586284"></p> 
<p>优点：这是导航结构</p> 
<p>优点：结构清晰，分类查询方便</p> 
<p>缺点：有可能造成数据无效</p> 
<p>第一代数据库：网状模型</p> 
<p><img src="https://images2.imgbox.com/67/09/XEinaiTE_o.png" alt="1559957699793"></p> 
<p>网状模型解决了层次模型的数据不一致的问题，但没有解决导航问题。导航结构在查询中有时候效率低下，比如查询整个公司的四月的营业额。</p> 
<p>第二阶段：关系模型</p> 
<p><img src="https://images2.imgbox.com/e5/ca/W7EJGGH7_o.png" alt="1559958018623"></p> 
<p>特点：</p> 
<p>1、每个表都是独立的</p> 
<p>2、通过关系字段将两个表连接起来</p> 
<p>3、关系：两个表的公共字段</p> 
<p>4、关系型数据库中多表联合查询效率低下。</p> 
<p>多学一招：为了解决关系型数据库多表查询效率的问题，项目中使用了NoSQL(非关系型数据库，Redis、mongodb等等)，在数据库中按照键值对来存储，它是关系型数据库的补充。</p> 
<h5><a id="123__SQL_64"></a>1.2.3 SQL</h5> 
<p>Structured Query Language（结构化查询语言），是用来操作关系型数据库的一门语言。这是一个关系型数据库的通用操作语言，也成为标准SQL，也叫SQL-92。</p> 
<p>脚下留心：数据库的生产厂商为了占有市场份额，都会在标准SQL的基础上扩展一些自己的东西以吸引用户。</p> 
<h5><a id="124___72"></a>1.2.4 常用的关系型数据库</h5> 
<table><thead><tr><th>关系型数据库</th><th>开发公司</th><th>使用语言</th></tr></thead><tbody><tr><td>access</td><td>微软公司</td><td>SQL</td></tr><tr><td>SQL Server</td><td>微软公司</td><td>T-SQL</td></tr><tr><td>Oracle</td><td>甲骨文公司</td><td>PL/SQL</td></tr><tr><td>MySQL</td><td>被甲骨文公司收购</td><td>MySQL</td></tr></tbody></table> 
<p>思考：已知标准SQL可以在所有的关系型数据库上运行，在Oracle上编写的PL/SQL能否在MySQL上运行？</p> 
<p>答：不可以，只能运行标准SQL</p> 
<h3><a id="13___87"></a>1.3 连接服务器</h3> 
<p>数据库是CS模式的软件，所以要连接数据库必须要有客户端软件。</p> 
<p>MySQL数据库默认端口号是3306</p> 
<h5><a id="131__window_93"></a>1.3.1 window界面连接服务器</h5> 
<p>1、Navicat</p> 
<p>2、MySQL-Front</p> 
<h5><a id="132__web_101"></a>1.3.2 通过web窗体连接</h5> 
<p><img src="https://images2.imgbox.com/33/db/0YHNPaLa_o.png" alt="1559961205568"></p> 
<p>主要有浏览器就可以访问数据库</p> 
<h5><a id="133___109"></a>1.3.3 命令行连接</h5> 
<pre><code>host		-h	主机
port		-P	端口号   （大写）
user		-u	用户名
password	-p	密码     （小写）
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 连接数据库
F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -h127.0.0.1 -P3306 -uroot -proot  -- 明文

-- 如果连接本地数据库 -h可以省略 如果服务器端口是3306，-P端口号也可以省略
F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -uroot -proot	-- 明文

-- 密文
F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -uroot -p  
Enter password: ****
</code></pre> 
<h5><a id="134___134"></a>1.3.4 退出登录</h5> 
<pre><code class="prism language-mysql">mysql&gt; exit		-- 方法一
mysql&gt; quit		-- 方法二
mysql&gt; \q		-- 方法三
</code></pre> 
<h3><a id="14___144"></a>1.4 数据库基本概念</h3> 
<h5><a id="141___146"></a>1.4.1 数据库、表相关</h5> 
<ol><li> <p>数据库：数据库中存放的是表，一个数据库中可以存放多个表</p> </li><li> <p>表：表是用来存放数据的。</p> </li><li> <p>关系：两个表的公共字段</p> </li><li> <p>行：也称记录，也称实体</p> </li><li> <p>列：也称字段，也称属性</p> </li></ol> 
<p>脚下留心：就表结构而言，表分为行和列；就表数据而言，表分为记录和字段；就面向对象而言，一个记录就是一个实体，一个字段就是一个属性。</p> 
<h5><a id="142___160"></a>1.4.2 数据相关</h5> 
<p>1、数据冗余：相同的数据存储在不同的地方</p> 
<pre><code>冗余只能减少，不能杜绝。
减少冗余的方法是分表
</code></pre> 
<p><img src="https://images2.imgbox.com/77/37/89h5pHVR_o.png" alt="1559962635355"></p> 
<p>2、数据完整性：正确性+准确性=数据完整性</p> 
<p><img src="https://images2.imgbox.com/7b/f2/9uEjXhlH_o.png" alt="1559962794246"></p> 
<pre><code>正确性：数据类型正确
准确性：数据范围要准确
</code></pre> 
<p>思考：学生的年龄是整型，输入1000岁，正确性和准确性如何？</p> 
<p>答：正确的，但不准确。失去了数据完整性。</p> 
<h5><a id="143___188"></a>1.4.3 数据库执行过程</h5> 
<p><img src="https://images2.imgbox.com/6a/fb/CVmruAee_o.png" alt="1559963884775"></p> 
<h3><a id="15___194"></a>1.5 数据库的操作</h3> 
<h5><a id="151___196"></a>1.5.1 创建数据库</h5> 
<p>语法：</p> 
<pre><code>create database [if not exists] 数据名 [选项]
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 创建数据库
mysql&gt; create database stu;
Query OK, 1 row affected (0.06 sec)

-- 创建数据库时，如果数据库已经存在就要报错
mysql&gt; create database stu;
# ERROR 1007 (HY000): Can't create database 'stu'; database exists

-- 在创建数据库时候，判断数据库是否存在，不存在就创建
mysql&gt; create database if not exists stu;
Query OK, 1 row affected, 1 warning (0.00 sec)

-- 特殊字符、关键字做数据库名，使用反引号将数据库名括起来
mysql&gt; create database `create`;
Query OK, 1 row affected (0.04 sec)

mysql&gt; create database `%$`;
Query OK, 1 row affected (0.05 sec)

-- 创建数据库时指定存储的字符编码
mysql&gt; create database emp charset=gbk;
Query OK, 1 row affected (0.00 sec)
# 如果不指定编码，数据库默认使用安装数据库时指定的编码
</code></pre> 
<p>MySQL数据库的目录</p> 
<pre><code>数据库保存的路径在安装MySQL的时候就配置好。
也可以在my.ini配置文件中更改数据库的保存地址。(datadir="F:/wamp/PHPTutorial/MySQL/data/")
一个数据库就对应一个文件夹，在文件夹中有一个db.opt文件。在此文件中设置数据库的字符集和校对集
</code></pre> 
<p><img src="https://images2.imgbox.com/78/86/LYKcdWnt_o.png" alt="1559965193019">****</p> 
<p>小结：</p> 
<p>1、如果创建的数据库已存在，就会报错。</p> 
<pre><code>解决方法：创建数据库的时候判断一下数据库是否存在，如果不存在再创建
</code></pre> 
<p>2、如果数据库名是关键字和特殊字符要报错。</p> 
<pre><code>解决：在特殊字符、关键字行加上反引号
</code></pre> 
<p>3、创建数据库的时候可以指定字符编码</p> 
<pre><code>脚下留心：创建数据库如果不指定字符编码，默认和MySQL服务器的字符编码是一致的。
</code></pre> 
<h5><a id="152___266"></a>1.5.2 显示所有数据库</h5> 
<p>语法：</p> 
<pre><code>show databases
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| test               |
+--------------------+
4 rows in set (0.00 sec)
</code></pre> 
<p>注意：数据库安装后，只带上面四个数据库</p> 
<h5><a id="153____293"></a>1.5.3 删除数据库</h5> 
<p>语法：</p> 
<pre><code>drop database [if exists] 数据库名
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">mysql&gt; drop database `create`;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; drop database `%$`;
Query OK, 0 rows affected (0.00 sec)
-- 判断数据库是否存在，如果存在就删除
mysql&gt; drop database if exists stu;
Query OK, 0 rows affected (0.00 sec)
</code></pre> 
<p>小结：<br> 1、如果删除的数据库不存在，会报错</p> 
<pre><code>解决：删除之前判断一下，如果存在就删除
</code></pre> 
<h5><a id="154__323"></a>1.5.4 显示创建数据库的语句</h5> 
<p>语法：</p> 
<pre><code>show create database 数据库名
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; show create database emp;
+----------+-------------------------------------------------------------+
| Database | Create Database                                             |
+----------+-------------------------------------------------------------+
| emp      | CREATE DATABASE `emp` /*!40100 DEFAULT CHARACTER SET gbk */ |
+----------+-------------------------------------------------------------+
1 row in set (0.00 sec)
</code></pre> 
<h5><a id="155___345"></a>1.5.5 修改数据库</h5> 
<p>只能修改数据库选项，数据库的选项只有字符编码</p> 
<p>语法：</p> 
<pre><code>alter database 数据库名 charset=字符编码
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; alter database emp charset=utf8;
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>小结：</p> 
<p>1、修改数据库只能修改数据库的字符编码</p> 
<p>2、在MySQL中utf字符编码之间没有横杆 utf8</p> 
<h5><a id="156___370"></a>1.5.6 选择数据库</h5> 
<p>语法：</p> 
<pre><code>use 数据库名
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">mysql&gt; use emp;
Database changed
</code></pre> 
<h3><a id="16___387"></a>1.6 表的操作</h3> 
<pre><code class="prism language-mysql">mysql&gt; create database data;
Query OK, 1 row affected (0.00 sec)

mysql&gt; use data;
Database changed
</code></pre> 
<h5><a id="161___399"></a>1.6.1 创建表</h5> 
<p>语法：</p> 
<pre><code>create table [if not exists] `表名`(
    `字段名` 数据类型 [null|not null] [default] [auto_increment] [primary key] [comment],
    `字段名 数据类型 …
)[engine=存储引擎] [charset=字符编码]

null|not null     是否为空
default:          默认值
auto_increment    自动增长,默认从1开始，每次递增1
primary key       主键，主键的值不能重复，不能为空,每个表必须只能有一个主键
comment:          备注
engine            引擎决定了数据的存储和查找   myisam、innodb

脚下留心：表名和字段名如果用了关键字，要用反引号引起来。
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql"> -- 设置客户端和服务器通讯的编码
mysql&gt; set names gbk;  
Query OK, 0 rows affected (0.00 sec)

-- 创建简单的表
mysql&gt; create table stu1(
    -&gt; id int auto_increment primary key,
    -&gt; name varchar(20) not null
    -&gt; )engine=innodb charset=gbk;
Query OK, 0 rows affected (0.11 sec)

-- 创建复杂的表
mysql&gt; create table stu2(
    -&gt; id int auto_increment primary key comment '主键',
    -&gt; name varchar(20) not null comment '姓名',
    -&gt; `add` varchar(50) not null default '地址不详' comment '地址',
    -&gt; score int comment '成绩,可以为空'
    -&gt; )engine=myisam;
Query OK, 0 rows affected (0.06 sec)
</code></pre> 
<p>小结：</p> 
<p>1、如果不指定引擎，默认是innodb</p> 
<p>2、如果不指定字符编码，默认和数据库编码一致</p> 
<p>3、varchar(20) 表示长度是20个字符</p> 
<p>数据表的文件</p> 
<pre><code>一个数据库对应一个文件夹
一个表对应一个或多个文件
引擎是myisam，一个表对应三个文件
	.frm	：存储的是表结构
	.myd	:存储的是表数据
	.myi	:存储的表数据的索引
引擎是innodb,一个表对应一个表结构文件，innodb的都有表的数据都保存在ibdata1文件中，如果数据量很大，会自动的创建ibdata2，ibdata3...
</code></pre> 
<p>innodb和myisam的区别</p> 
<table><thead><tr><th>引擎</th><th></th></tr></thead><tbody><tr><td>myisam</td><td>1、查询速度快<br>2、容易产生碎片<br>3、不能约束数据</td></tr><tr><td>innodb</td><td>1、以前没有myisam查询速度快，现在已经提速了<br>2、不产生碎片<br>3、可以约束数据</td></tr></tbody></table> 
<p>脚下留心：推荐使用innodb。</p> 
<h5><a id="162___476"></a>1.6.2 显示所有表</h5> 
<p>语法</p> 
<pre><code>show tables;
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; show tables;
Empty set (0.00 sec)
</code></pre> 
<h5><a id="163____493"></a>1.6.3 显示创建表的语句</h5> 
<p>语法</p> 
<pre><code>show create table;	 -- 结果横着排列
show create table \G  -- 将结果竖着排列
</code></pre> 
<p>例题</p> 
<p><img src="https://images2.imgbox.com/d8/74/6zQOz8Sz_o.png" alt="1559977785806"></p> 
<h5><a id="164___508"></a>1.6.4 查看表结构</h5> 
<p>语法</p> 
<pre><code>desc[ribe] 表名
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 方法一
mysql&gt; describe stu2;
+-------+-------------+------+-----+----------+----------------+
| Field | Type        | Null | Key | Default  | Extra          |
+-------+-------------+------+-----+----------+----------------+
| id    | int(11)     | NO   | PRI | NULL     | auto_increment |
| name  | varchar(20) | NO   |     | NULL     |                |
| add   | varchar(50) | NO   |     | 地址不详        |                |
| score | int(11)     | YES  |     | NULL     |                |
+-------+-------------+------+-----+----------+----------------+
4 rows in set (0.05 sec)

-- 方法二
mysql&gt; desc stu2;
+-------+-------------+------+-----+----------+----------------+
| Field | Type        | Null | Key | Default  | Extra          |
+-------+-------------+------+-----+----------+----------------+
| id    | int(11)     | NO   | PRI | NULL     | auto_increment |
| name  | varchar(20) | NO   |     | NULL     |                |
| add   | varchar(50) | NO   |     | 地址不详        |                |
| score | int(11)     | YES  |     | NULL     |                |
+-------+-------------+------+-----+----------+----------------+
4 rows in set (0.00 sec)
</code></pre> 
<h5><a id="165___546"></a>1.6.5 复制表</h5> 
<p>**语法一：**create table 新表 select 字段 from 旧表</p> 
<p>特点：不能复制父表的键，能够复制父表的数据</p> 
<p><img src="https://images2.imgbox.com/45/eb/2sChtISN_o.png" alt="1559978344649"></p> 
<p>**语法二：**create table 新表 like 旧表</p> 
<p>特点：只能复制表结构，不能复制表数据</p> 
<p><img src="https://images2.imgbox.com/9a/47/Ga0tQj6G_o.png" alt="1559978418674"></p> 
<p>小结：</p> 
<p>*表示所有字段</p> 
<h5><a id="166___568"></a>1.6.6 删除表</h5> 
<p>语法：</p> 
<pre><code>drop table [if exists] 表1，表2,… 
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">-- 删除表
mysql&gt; drop table stu4;
Query OK, 0 rows affected (0.06 sec)

-- 如果表存在就删除
mysql&gt; drop table if exists stu4;
Query OK, 0 rows affected, 1 warning (0.00 sec)

-- 一次删除多个表
mysql&gt; drop table stu2,stu3;
Query OK, 0 rows affected (0.03 sec)
</code></pre> 
<h5><a id="167___594"></a>1.6.7 修改表</h5> 
<pre><code>语法：alter table 表名 
</code></pre> 
<p>创建初始表</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu(
    -&gt; id int,
    -&gt; name varchar(20)
    -&gt; );
Query OK, 0 rows affected (0.00 sec)
</code></pre> 
<p>1、添加字段：alter table 表名add [column] 字段名 数据类型 [位置]</p> 
<pre><code class="prism language-mysql">mysql&gt; alter table stu add `add` varchar(20);	-- 默认添加字段放在最后
Query OK, 0 rows affected (0.05 sec)

mysql&gt; alter table stu add sex char(1) after name;  -- 在name之后添加sex字段
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; alter table stu add age int first;  -- age放在最前面
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; desc stu;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| age   | int(11)     | YES  |     | NULL    |       |
| id    | int(11)     | YES  |     | NULL    |       |
| name  | varchar(20) | YES  |     | NULL    |       |
| sex   | char(1)     | YES  |     | NULL    |       |
| add   | varchar(20) | YES  |     | NULL    |       |
+-------+-------------+------+-----+---------+-------+
5 rows in set (0.00 sec)
</code></pre> 
<p>2、删除字段：alter table 表 drop [column] 字段名</p> 
<pre><code class="prism language-mysql">mysql&gt; alter table stu drop age;   -- 删除age字段
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>3、修改字段(改名)：alter table 表 change [column] 原字段名 新字段名 数据类型 …</p> 
<pre><code class="prism language-mysql">-- 将name字段更改为stuname varchar(10)
mysql&gt; alter table stu change name stuname varchar(10);
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; desc stu;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| id      | int(11)     | YES  |     | NULL    |       |
| stuname | varchar(10) | YES  |     | NULL    |       |
| sex     | char(1)     | YES  |     | NULL    |       |
| add     | varchar(20) | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code></pre> 
<p>4、修改字段（不改名）:alter table 表 modify 字段名 字段属性…</p> 
<pre><code class="prism language-mysql">-- 将sex数据类型更改为varchar(20)
mysql&gt; alter table stu  modify sex varchar(20);
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

-- 将add字段更改为varchar(20) 默认值是‘地址不详’
mysql&gt; alter table stu modify `add` varchar(20) default '地址不详';
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>5、修改引擎：alter table 表名 engine=引擎名</p> 
<pre><code class="prism language-mysql">mysql&gt; alter table stu engine=myisam;
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>6、修改表名:alter table 表名 rename to 新表名</p> 
<pre><code class="prism language-mysql">-- 将stu表名改成student
mysql&gt; alter table stu rename to student;
Query OK, 0 rows affected (0.00 sec)
</code></pre> 
<p>7、将表移动到其他数据库</p> 
<pre><code class="prism language-mysql">-- 将当前数据库中的student表移动到php74数据库中改名为stu
mysql&gt; alter table student rename to php74.stu;
Query OK, 0 rows affected (0.00 sec)
</code></pre> 
<h3><a id="17___719"></a>1.7 数据操作</h3> 
<h5><a id="171___721"></a>1.7.1 插入数据</h5> 
<p>语法：insert into 表名 (字段名, 字段名,…) values (值1, 值1,…)</p> 
<p>1、插入所有字段</p> 
<pre><code class="prism language-mysql">-- 插入所有字段
mysql&gt; insert into stu (id,stuname,sex,`add`) values (1,'tom','男','北京');
Query OK, 1 row affected (0.00 sec)

-- 插入部分字段
mysql&gt; insert into stu(id,stuname) values (2,'berry');

-- 插入的字段和表的字段可以顺序不一致。但是插入字段名和插入的值一定要一一对应
mysql&gt; insert into stu(sex,`add`,id,stuname) values ('女','上海',3,'ketty');
Query OK, 1 row affected (0.00 sec)

-- 插入字段名可以省略
mysql&gt; insert into stu values(4,'rose','女','重庆');
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>小结：</p> 
<pre><code>1、插入字段名的顺序和数据表中字段名的顺序可以不一致
2、插入值的个数、顺序必须和插入字段名的个数、顺序要一致。
3、如果插入的值的顺序和个数与表字段的顺序个数一致，插入字段可以省略。
</code></pre> 
<p>2、插入默认值和空值</p> 
<pre><code class="prism language-mysql">mysql&gt; insert into stu values (5,'jake',null,default);
Query OK, 1 row affected (0.05 sec)
</code></pre> 
<p>小结：</p> 
<pre><code>default关键字用来插入默认值，null用来插入空值.
</code></pre> 
<p>3、插入多条数据</p> 
<pre><code class="prism language-mysql">mysql&gt; insert into stu values (6,'李白','男','四川'),(7,'杜甫','男','湖北');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0
</code></pre> 
<h5><a id="172___779"></a>1.7.2 更新数据</h5> 
<p>语法：update 表名 set 字段=值 [where 条件]</p> 
<pre><code class="prism language-mysql">-- 将berry性别改为女
mysql&gt; update stu set sex='女' where stuname='berry';
Query OK, 1 row affected (0.06 sec)

-- 将编号是1号的学生性别改成女，地址改为上海。
mysql&gt; update stu set sex='女',`add`='上海' where id=1;
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<h5><a id="173___795"></a>1.7.3 删除数据</h5> 
<p>语法：delete from 表名 [where 条件]</p> 
<pre><code class="prism language-mysql">-- 删除1号学生
mysql&gt; delete from stu where id=1;

-- 删除名字是berry的学生
mysql&gt; delete from stu where stuname='berry';
Query OK, 1 row affected (0.00 sec)

-- 删除所有数据
mysql&gt; delete from stu;
Query OK, 5 rows affected (0.00 sec)
</code></pre> 
<p>多学一招：delete from 表和truncate table 表区别？</p> 
<pre><code>1、delete from 表：遍历表记录，一条一条的删除
2、truncate table：将原表销毁，再创建一个同结构的新表。就清空表而言，这种方法效率高。
</code></pre> 
<h5><a id="174___823"></a>1.7.4 查询数据</h5> 
<p>语法：</p> 
<pre><code>select 列名 from 表名
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 查询id字段的值
mysql&gt; select id from stu;

-- 查询id,stuname字段的值
mysql&gt; select id,stuname from stu;、

-- 查询所有字段的值
mysql&gt; select * from stu;
</code></pre> 
<h5><a id="175___846"></a>1.7.5 数据传输时使用字符集</h5> 
<p>发现：在插入数据的时候，如果有中文会报错（或者中文无法插入）</p> 
<p><img src="https://images2.imgbox.com/65/71/XUk9e9UX_o.png" alt="1559983722073"></p> 
<p>分析：</p> 
<p>1、查看客户端发送的编码</p> 
<p><img src="https://images2.imgbox.com/60/10/N2nBU0Mi_o.png" alt="1559983940973"></p> 
<p>2、查看服务器接受，返回的编码</p> 
<p><img src="https://images2.imgbox.com/89/9d/w9PV2CSe_o.png" alt="1559984111548"></p> 
<p>更改接受客户端指令的编码</p> 
<pre><code class="prism language-mysql">mysql&gt; set character_set_client=gbk;
Query OK, 0 rows affected (0.05 sec)
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/d9/Bli0sI4k_o.png" alt="1559984265382"></p> 
<p>原因：返回编码是utf8，客户端是gbk;</p> 
<p>测试：成功</p> 
<p><img src="https://images2.imgbox.com/4d/67/VHAjampF_o.png" alt="1559984355222"></p> 
<p>可以通过set names一次性设置</p> 
<p><img src="https://images2.imgbox.com/c6/0a/HbVsHqjK_o.png" alt="1559984478388"></p> 
<p>小结：</p> 
<p>1、设置什么编码取决于客户端的编码</p> 
<p>2、通过set names 设置编码</p> 
<h3><a id="18___897"></a>1.8 补充知识</h3> 
<p>每次执行指令要进入相应的目录中，麻烦，可以通过环境变量简化操作。</p> 
<h5><a id="181___901"></a>1.8.1 环境变量配置</h5> 
<p>我的电脑右键——属性——高级</p> 
<p><img src="https://images2.imgbox.com/23/fc/i1webbUm_o.png" alt="1559984730075"></p> 
<p>将mysql指令目录地址添加到环境变量的Path值中</p> 
<p><img src="https://images2.imgbox.com/62/5d/mRqKBgCH_o.png" alt="1559984804007"></p> 
<p>这时候就可以在任意目录下使用mysql指令</p> 
<p><img src="https://images2.imgbox.com/a5/b2/v6OMd9GH_o.png" alt="1559984875241"></p> 
<p>原理：</p> 
<p>1、输入指令后，首先在当前目录下查找，如果当前目录下找不到，就到环境变量的Path中查找</p> 
<p>2、Path中有很多目录，从前往后查找</p> 
<h5><a id="182___927"></a>1.8.2 校对集</h5> 
<p>1、概念：在某种字符集下，字符之间的比较关系，比如a和B的大小关系，如果区分大小写a&gt;B，如果不区分大小写则a&lt;B。比如赵钱孙李大小关系，不同的标准关系不一样</p> 
<p>2、校对集依赖与字符集，不同的字符集的的比较规则不一样，如果字符集更改，校对集也重新定义。</p> 
<p>3、不同的校对集对同一字符序列比较的结果是不一致的。</p> 
<p>4、 可以在定义字符集的同时定义校对集、 语法：</p> 
<pre><code> collate = 校对集
</code></pre> 
<p>例题：</p> 
<p>定义两个表，相同字符集不同校对集</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu1(
    -&gt; name char(1)
    -&gt; )charset=utf8 collate=utf8_general_ci;
Query OK, 0 rows affected (0.05 sec)

mysql&gt; create table stu2(
    -&gt; name char(1)
    -&gt; )charset=utf8 collate=utf8_bin;
Query OK, 0 rows affected (0.05 sec)

mysql&gt; insert into stu1 values ('a'),('B');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql&gt; insert into stu2 values ('a'),('B');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0
</code></pre> 
<p>测试：两个表的数据都是有小到大排序</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stu1 order by name;   -- 不区分大小写
+------+
| name |
+------+
| a    |
| B    |
+------+
2 rows in set (0.08 sec)

mysql&gt; select * from stu2 order by name;   -- 区分大小写
+------+
| name |
+------+
| B    |
| a    |
+------+
2 rows in set (0.00 sec)

</code></pre> 
<p>小结校对集规则：</p> 
<p>_bin：按二进制编码比较，区别大小写</p> 
<p>_ci：不区分大小写</p> 
<h3><a id="12___996"></a>1.2 数据类型</h3> 
<p>MySQL中的数据类型是强类型</p> 
<h5><a id="121___1000"></a>1.2.1 数值型</h5> 
<p><strong>1、 整型</strong></p> 
<table><thead><tr><th>整形</th><th>占用字节数</th><th>范围</th></tr></thead><tbody><tr><td>tinyint</td><td>1</td><td>-128~127</td></tr><tr><td>smallint</td><td>2</td><td>-32768~32767</td></tr><tr><td>mediumint</td><td>3</td><td>-8388608~8388607</td></tr><tr><td>int</td><td>4</td><td>-2147483648~2147483647</td></tr><tr><td>bigint</td><td>8</td><td>-9223372036854775808~9223372036854775807</td></tr></tbody></table> 
<p>选择的范围尽可能小，范围越小占用资源越少</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu1(
    -&gt; id tinyint,      # 范围要尽可能小，范围越小，占用空间越少
    -&gt; name varchar(20)
    -&gt; );
Query OK, 0 rows affected (0.02 sec)

-- 超出范围会报错
mysql&gt; insert into stu1 values (128,'tom');
ERROR 1264 (22003): Out of range value for column 'id' at row 1
</code></pre> 
<p>无符号整形（unsigned） 无符号整形就是没有负数，无符号整数是整数的两倍</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu2(
    -&gt; id tinyint unsigned    # 无符号整数
    -&gt; );
Query OK, 0 rows affected (0.02 sec)

mysql&gt; insert into stu2 values (128);
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>整形支持显示宽度，显示宽带是最小的显示位数，如int(11)表示整形最少用11位表示，如果不够位数用0填充。显示宽度默认不起作用，必须结合zerofill才起作用。</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu4(
    -&gt; id int(5),
    -&gt; num int(5) zerofill   # 添加前导0,int(5)显示宽带是5
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

mysql&gt; insert into stu4 values (12,12);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu4;
+------+-------+
| id   | num   |
+------+-------+
|   12 | 00012 |
+------+-------+
1 row in set (0.00 sec)
</code></pre> 
<p>小结：</p> 
<pre><code>1、范围要尽可能小，范围越小，占用空间越少
2、无符号整数是整数的两倍
3、整形支持显示宽度，显示宽带是最小的显示位数，必须结合zerofill才起作用
</code></pre> 
<p><strong>2、浮点型</strong></p> 
<table><thead><tr><th>浮点型</th><th>占用字节数</th><th>范围</th></tr></thead><tbody><tr><td>float（单精度型）</td><td>4</td><td>-3.4E+38~3.4E+38</td></tr><tr><td>double（双精度型）</td><td>8</td><td>-1.8E+308~1.8E+308</td></tr></tbody></table> 
<p>浮点型的声明：float(M,D) double(M,D)</p> 
<pre><code> M：总位数   D：小数位数
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu5(
    -&gt; num1 float(5,2),   -- 浮点数
    -&gt; num2 double(6,1)	  -- 双精度数
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

mysql&gt; insert into stu5 values (3.1415,12.96);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu5;
+------+------+
| num1 | num2 |
+------+------+
| 3.14 | 13.0 |
+------+------+
1 row in set (0.00 sec)
</code></pre> 
<p>MySQL浮点数支持科学计数法</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu6(
    -&gt; num float   # 不指定位数，默认是小数点后面6位  double默认是17位
    -&gt; );
Query OK, 0 rows affected (0.03 sec)

mysql&gt; insert into stu6 values (5E2),(6E-2); # 插入科学计数法
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql&gt; select * from stu6;
+------+
| num  |
+------+
|  500 |
| 0.06 |
+------+
2 rows in set (0.00 sec)
</code></pre> 
<p>浮点数精度会丢失</p> 
<pre><code class="prism language-mysql">mysql&gt; insert into stu6 values(99.999999999);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu6;
+------+
| num  |
+------+
|  100 |
+------+
</code></pre> 
<p>小结：</p> 
<pre><code>1、浮点数有单精度和双精度
2、浮点数支持科学计数法
3、浮点数精度会丢失
</code></pre> 
<p>3、小数（定点数）</p> 
<p>原理：将整数部分和小数部分分开存储</p> 
<p>语法：</p> 
<pre><code>decimal(M,D)
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu8(
    -&gt; num decimal(20,9)   # 存放定点数
    -&gt; );
Query OK, 0 rows affected (0.00 sec)

mysql&gt; insert into stu8 values(12.999999999);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu8;
+--------------+
| num          |
+--------------+
| 12.999999999 |
+--------------+
1 row in set (0.00 sec)
</code></pre> 
<p>小结：</p> 
<pre><code>1、decimal是变长的，大致是每9个数字用4个字节存储，整数和小数分开计算。M最大是65,D最大是30，默认是（10,2）。
2、定点和浮点都支持无符号、显示宽度0填充。
</code></pre> 
<h5><a id="122___1196"></a>1.2.2 字符型</h5> 
<p>在数据库中没有字符串概念，只有字符，所以数据库中只能用单引号</p> 
<table><thead><tr><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>char</td><td>定长字符，最大可以到255</td></tr><tr><td>varchar</td><td>可变长度字符，最大可以到65535</td></tr><tr><td>tinytext</td><td>2<sup>8</sup>–1 =255</td></tr><tr><td>text</td><td>2<sup>16</sup>–1 =65535</td></tr><tr><td>mediumtext</td><td>2<sup>24</sup>–1</td></tr><tr><td>longtext</td><td>2<sup>32</sup>–1</td></tr></tbody></table> 
<p>char(4)：存放4个字符，中英文一样。</p> 
<p>varchar(L)实现变长机制，需要额外的空间来记录数据真实的长度。</p> 
<p>L的理论长度是65535，但事实上达不到，因为有的字符是多字节字符，所以L达不到65535。</p> 
<p><img src="https://images2.imgbox.com/92/77/Lqd4ZRvS_o.png" alt="1560050625970"></p> 
<p><img src="https://images2.imgbox.com/87/55/H2P3Vrl4_o.png" alt="1560050684461"></p> 
<p>text系列的类型在表中存储的是地址，占用大小大约10个字节</p> 
<p><img src="https://images2.imgbox.com/db/9a/LqmLKxud_o.png" alt="1560051173896"></p> 
<p>一个记录的所有字段的总长度也不能超过65535个字节。</p> 
<p><img src="https://images2.imgbox.com/d1/a9/ANAfv9If_o.png" alt="1560050966898"></p> 
<p>小结：</p> 
<pre><code>1、char是定长，var是变长
2、char最大值是255，varchar最大值是65535，具体要看字符编码
3、text系列在表中存储的是地址
4、一条记录的总长度不能超过65535
</code></pre> 
<h5><a id="123__enum_1244"></a>1.2.3 枚举(enum)</h5> 
<p>从集合中选择一个值作为数据（单选）</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu12(
    -&gt; name varchar(20),
    -&gt; sex enum('男','女','保密') # 枚举
    -&gt; );
Query OK, 0 rows affected (0.06 sec)

-- 插入的枚举值只能是枚举中提供的选项
mysql&gt; insert into stu12 values ('tom','男');
Query OK, 1 row affected (0.00 sec)
-- 报错，只能插入男、女、保密
mysql&gt; insert into stu12 values ('tom','不告诉你');
ERROR 1265 (01000): Data truncated for column 'sex' at row 1
</code></pre> 
<p>枚举值是通过整形数字来管理的，第一个值是1，第二个值是2，以此类推，枚举值在数据库存储的是整形数字。</p> 
<pre><code class="prism language-mysql">mysql&gt; insert into stu12 values ('berry',2);   -- 插入数字
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu12;
+-------+------+
| name  | sex  |
+-------+------+
| tom   | 男     |
| berry | 女    |
+-------+------+

mysql&gt; select * from stu12 where sex=2;   -- 2表示第二个枚举值
+-------+------+
| name  | sex  |
+-------+------+
| berry | 女    |
+-------+------+
1 row in set (0.00 sec)
</code></pre> 
<p>枚举优点：</p> 
<pre><code>（1）、限制值
（2）、节省空间
（3）、运行速度快（整形比字符串运行速度快）
</code></pre> 
<p>思考：已知枚举占用两个字节，所以最多可以有多少个枚举值？</p> 
<p>答：2字节=16位，2<sup>16</sup>=65536，范围是（0-65535），由于枚举从1开始，所以枚举值最多有65535个</p> 
<h5><a id="124__set_1300"></a>1.2.4 集合(set)</h5> 
<p>从集合中选择一些值作为数据（多选）</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu13(
    -&gt; name varchar(20),
    -&gt; hobby set('爬山','读书','游泳','烫头')  -- 集合
    -&gt; );
Query OK, 0 rows affected (0.00 sec)

mysql&gt; insert into stu13 values ('tom','爬山');

mysql&gt; insert into stu13 values ('Berry','爬山,游泳');
Query OK, 1 row affected (0.00 sec)

mysql&gt; insert into stu13 values ('Berry','游泳,爬山');   -- 插入的顺序不一样，但显示的顺序一样
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu13;
+-------+-----------+
| name  | hobby     |
+-------+-----------+
| tom   | 爬山         |
| Berry | 爬山,游泳       |
| Berry | 爬山,游泳       |
+-------+-----------+
3 rows in set (0.00 sec)
</code></pre> 
<p>集合和枚举一样，也为每个集合元素分配一个固定值，分配方式是从前往后按2的0、1、2、…次方，转换成二进制后只有一位是1，其他都是0。</p> 
<pre><code class="prism language-mysql">'爬山','读书','游泳','烫头'
  1		2		4	8
  
mysql&gt; select hobby+0 from stu13;
+---------+
| hobby+0 |
+---------+
|       1 |
|       5 |
|       5 |
+---------+

mysql&gt; insert into stu13 values ('rose',15);
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>已知集合类型占8个字节，那么集合中最多有多少选项</p> 
<p>答：有64个选项。</p> 
<h5><a id="125___1359"></a>1.2.5 日期时间型</h5> 
<table><thead><tr><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>datetime</td><td>日期时间，占用8个字节</td></tr><tr><td>date</td><td>日期 占用3个字节</td></tr><tr><td>time</td><td>时间 占用3个字节</td></tr><tr><td>year</td><td>年份，占用1个字节</td></tr><tr><td>timestamp</td><td>时间戳，占用4个字节</td></tr></tbody></table> 
<p>1、datetime和date</p> 
<p>datetime格式：年-月-日 小时:分钟:秒。支持的范围是’1000-01-01 00:00:00’到’9999-12-31<br> 23:59:59’。</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu14(
    -&gt; t1 datetime,    -- 日期时间
    -&gt; t2 date				-- 日期
    -&gt; );
Query OK, 0 rows affected (0.05 sec)
-- 插入测试数据
mysql&gt; insert into stu14 values ('2019-01-15 12:12:12','2019-01-15 12:12:12');
Query OK, 1 row affected, 1 warning (0.00 sec)
-- 查询
mysql&gt; select * from stu14;
+---------------------+------------+
| t1                  | t2         |
+---------------------+------------+
| 2019-01-15 12:12:12 | 2019-01-15 |
+---------------------+------------+
1 row in set (0.00 sec)
</code></pre> 
<p>2、timestamp（时间戳）</p> 
<p>datetime类型和timestamp类型表现上是一样的，他们的区别在于：</p> 
<p>datetime从1000到9999，而timestamp从1970年~2038年（原因在于timestamp占用4个字节，和整形的范围一样，2038年01月19日11:14:07以后的秒数就超过了4个字节的长度）</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu15(
    -&gt; t1 timestamp
    -&gt; );
Query OK, 0 rows affected (0.06 sec)

mysql&gt; insert into stu15 values ('2038-01-19 11:14:07');
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>3、year</p> 
<p>只能表示1901~2155之间的年份，因为只占用1个字节，只能表示255个数</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu16(
    -&gt; y1 year
    -&gt; );
Query OK, 0 rows affected (0.08 sec)

mysql&gt; insert into stu16 values (2155);
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>4、time</p> 
<p>可以表示时间，也可以表示时间间隔。范围是：-838:59:59~838:59:59</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu17(
    -&gt; t1 time
    -&gt; );
Query OK, 0 rows affected (0.02 sec)

mysql&gt; insert into stu17 values ('12:12:12');
Query OK, 1 row affected (0.00 sec)

mysql&gt; insert into stu17 values ('212:12:12');
Query OK, 1 row affected (0.00 sec)

mysql&gt; insert into stu17 values ('-212:12:12');
Query OK, 1 row affected (0.00 sec)

mysql&gt; insert into stu17 values ('839:00:00');   -- 报错
ERROR 1292 (22007): Incorrect time value: '839:00:00' for column 't1' at row 1

-- time支持以天的方式来表示时间间隔
mysql&gt; insert into stu17 values ('10 10:25:25');   -- 10天10小时25分25秒
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu17;
+------------+
| t1         |
+------------+
| 12:12:12   |
| 212:12:12  |
| -212:12:12 |
| 250:25:25  |
+------------+
4 rows in set (0.00 sec)
</code></pre> 
<h5><a id="126__Boolean_1469"></a>1.2.6 Boolean</h5> 
<p>MySQL不支持布尔型，true和false在数据库中对应的是1和0</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu18(
    -&gt; flag boolean
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

mysql&gt; desc stu18;
+-------+------------+------+-----+---------+-------+
| Field | Type       | Null | Key | Default | Extra |
+-------+------------+------+-----+---------+-------+
| flag  | tinyint(1) | YES  |     | NULL    |       |
+-------+------------+------+-----+---------+-------+
1 row in set (0.00 sec)

mysql&gt; insert into stu18 values (true),(false);
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql&gt; select * from stu18;
+------+
| flag |
+------+
|    1 |
|    0 |
+------+
2 rows in set (0.00 sec
</code></pre> 
<p>小结：</p> 
<p>boolean型在MySQL中对应的是tinyint。</p> 
<h5><a id="126___1507"></a>1.2.6 练习题</h5> 
<pre><code>电话号码一般使用什么数据类型存储?			 varchar
手机号码用什么数据类型						char
性别一般使用什么数据类型存储?				  char  tinyint  enum
年龄信息一般使用什么数据类型存储?			 tinyint
照片信息一般使用什么数据类型存储?		 	 binary
薪水一般使用什么数据类型存储?			      decimal
</code></pre> 
<h3><a id="13___1520"></a>1.3 列属性</h3> 
<h5><a id="131__nullnot_null_1522"></a>1.3.1 是否为空（null|not null）</h5> 
<pre><code>null表示字段值可以为null
not null字段值不能为空
</code></pre> 
<p>练习</p> 
<pre><code>学员姓名允许为空吗?					not null
家庭地址允许为空吗?					not null
电子邮件信息允许为空吗?			   null
考试成绩允许为空吗?					null
</code></pre> 
<h5><a id="132__default_1540"></a>1.3.2 默认值（default）</h5> 
<p>如果一个字段没有插入值，可以默认插入一个指定的值</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu19(
    -&gt; name varchar(20) not null default '姓名不详',
    -&gt; addr varchar(50) not null default '地址不详'
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

mysql&gt; insert into stu19(name) values ('tom');
Query OK, 1 row affected (0.00 sec)

mysql&gt; insert into stu19 values (default,default);
Query OK, 1 row affected (0.00 sec)

mysql&gt; select * from stu19;
+----------+----------+
| name     | addr     |
+----------+----------+
| tom      | 地址不详        |
| 姓名不详         | 地址不详        |
+----------+----------+
2 rows in set (0.00 sec)
</code></pre> 
<p>小结：</p> 
<p>default关键字用来插入默认值</p> 
<h5><a id="133__auto_increment_1573"></a>1.3.3 自动增长（auto_increment）</h5> 
<p>字段值从1开始，每次递增1，自动增长的值就不会有重复，适合用来生成唯一的id。在MySQL中只要是自动增长列必须是主键</p> 
<h5><a id="134__primary_key_1579"></a>1.3.4 主键（primary key）</h5> 
<p>主键概念：唯一标识表中的记录的一个或一组列称为主键。</p> 
<p>特点：</p> 
<pre><code>1、不能重复、不能为空
2、一个表只能有一个主键。
</code></pre> 
<p>作用：</p> 
<pre><code>1、保证数据完整性
2、加快查询速度
</code></pre> 
<p>选择主键的原则</p> 
<pre><code>最少性：尽量选择单个键作为主键
稳定性：尽量选择数值更新少的列作为主键

比如：学号，姓名、地址  这三个字段都不重复，选哪个做主键
选学号，因为学号最稳定
</code></pre> 
<p>练习</p> 
<pre><code class="prism language-mysql">-- 创建主键方法一
mysql&gt; create table stu20(
    -&gt; id int auto_increment primary key,
    -&gt; name varchar(20)
    -&gt; );
Query OK, 0 rows affected (0.04 sec)

-- 创建主键方法二
mysql&gt; create table stu21(
    -&gt; id int auto_increment,
    -&gt; name varchar(20),
    -&gt; primary key(id)
    -&gt; );
Query OK, 0 rows affected (0.02 sec)
</code></pre> 
<p>组合键</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu22(
    -&gt; classname varchar(20),
    -&gt; stuname varchar(20),
    -&gt; primary key(classname,stuname)  -- 创建组合键
    -&gt; );
Query OK, 0 rows affected (0.00 sec)

mysql&gt; desc stu22;
+-----------+-------------+------+-----+---------+-------+
| Field     | Type        | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+-------+
| classname | varchar(20) | NO   | PRI |         |       |
| stuname   | varchar(20) | NO   | PRI |         |       |
+-----------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)
</code></pre> 
<p>通过更改表添加主键</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu23(
    -&gt; id int,
    -&gt; name varchar(20)
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

-- 添加主键
mysql&gt; alter table stu23 add primary key(id);
Query OK, 0 rows affected (0.09 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>删除主键</p> 
<pre><code class="prism language-mysql">mysql&gt; alter table stu23 drop primary key;
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>插入数据</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu25(
    -&gt; id tinyint unsigned auto_increment primary key,
    -&gt; name varchar(20)
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

-- 插入数据
mysql&gt; insert into stu25 values (3,'tom');   -- 可以直接插入数字
Query OK, 1 row affected (0.06 sec)

-- 自动增长列可以插入null,让列的值自动递增
mysql&gt; insert into stu25 values (null,'berry');
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>小结：</p> 
<p>1、只要是auto_increment必须是主键，但是主键不一定是auto_increment</p> 
<p>2、主键特点是不能重复不能为空</p> 
<p>3、一个表只能有一个主键，但是一个主键可以有多个字段组成</p> 
<p>4、自动增长列通过插入null值让其递增</p> 
<p>5、自动增长列的数据被删除，默认不再重复使用。truncate table删除数据后，再次插入从1开始</p> 
<p>练习</p> 
<pre><code>在主键列输入的数值，允许为空吗?		不可以
一个表可以有多个主键吗?				不可以
在一个学校数据库中，如果一个学校内允许重名的学员，但是一个班级内不允许学员重名，可以组合班级和姓名两个字段一起来作为主键吗？						对
标识列（自动增长列）允许为字符数据类型吗？	不允许
一个自动增长列中，插入3行，删除2行，插入3行，删除2行，插入3行，删除2行，再次插入是多少？  10
</code></pre> 
<h5><a id="135__unique_1721"></a>1.3.5 唯一键（unique）</h5> 
<table><thead><tr><th>键</th><th>区别</th></tr></thead><tbody><tr><td>主键</td><td>1、不能重复，不能为空<br>2、一个表只能有一个主键</td></tr><tr><td>唯一键</td><td>1、不能重刻，可以为空<br>2、一个表可以有多个唯一键</td></tr></tbody></table> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 创建表的时候创建唯一键 
mysql&gt; create table stu26(
    -&gt; id int auto_increment primary key,
    -&gt; name varchar(20) unique    -- 唯一键
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

-- 方法二 
mysql&gt; create table stu27(
    -&gt; id int primary key,
    -&gt; name varchar(20),
    -&gt; unique(name)
    -&gt; );
Query OK, 0 rows affected (0.05 sec)

多学一招：
unique 或 unique key 是一样的
</code></pre> 
<p>通过修改表添加唯一键</p> 
<pre><code class="prism language-mysql">-- 将name设为唯一键
mysql&gt; alter table stu28 add unique(name);  

-- 将name,addr设为唯一键
mysql&gt; alter table stu28 add unique(name),add unique(addr);
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; desc stu28;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| id    | int(11)     | NO   | PRI | NULL    |       |
| name  | varchar(20) | YES  | UNI | NULL    |       |
| addr  | varchar(20) | YES  | UNI | NULL    |       |
+-------+-------------+------+-----+---------+-------+
3 rows in set (0.02 sec)
</code></pre> 
<p>通过show create table 查看唯一键的名字</p> 
<p><img src="https://images2.imgbox.com/13/af/hYPpH1We_o.png" alt="1560067957522"></p> 
<p>通过唯一键的名字删除唯一键</p> 
<pre><code class="prism language-mysql">mysql&gt; alter table stu28 drop index name;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<h5><a id="136__comment_1788"></a>1.3.6 备注（comment）</h5> 
<p>说明性文本</p> 
<pre><code class="prism language-mysql">mysql&gt; create table stu29(
    -&gt; id int primary key comment '学号',
    -&gt; name varchar(20) not null comment '姓名'
    -&gt; );
Query OK, 0 rows affected (0.03 sec)
</code></pre> 
<p>注意：备注属于SQL代码的一部分</p> 
<p><img src="https://images2.imgbox.com/ad/d8/85JotW0g_o.png" alt="1560068676274"></p> 
<h3><a id="14__SQL_1806"></a>1.4 SQL注释</h3> 
<p>单行注释</p> 
<pre><code class="prism language-mysql">-- 单行注释
# 单行注释
多行注释  /*     */
</code></pre> 
<p><img src="https://images2.imgbox.com/e2/ab/iWTLjT2k_o.png" alt="1560068815346"></p> 
<h3><a id="15___1822"></a>1.5 数据完整性</h3> 
<h5><a id="151___1824"></a>1.5.1 数据完整性包括</h5> 
<p>1、实体完整性</p> 
<pre><code>1、主键约束
2、唯一约束
3、标识列
</code></pre> 
<p>2、 域完整性</p> 
<pre><code>1、数据类型约束
2、非空约束
3、默认值约束
</code></pre> 
<p>3、 引用完整性</p> 
<pre><code>外键约束
</code></pre> 
<p>4、 自定义完整性</p> 
<pre><code>1、存储过程
2、触发器
</code></pre> 
<h5><a id="152___1857"></a>1.5.2 主表和从表</h5> 
<ol><li>主表中没有的记录，从表不允许插入</li><li>从表中有的记录，主表中不允许删除</li><li>删除主表前，先删子表</li></ol> 
<h5><a id="153__foreign_key_1865"></a>1.5.3 外键（foreign key）</h5> 
<p>外键：从表中的公共字段</p> 
<pre><code class="prism language-mysql">-- 创建表的时候添加外键
drop table if exists stuinfo;
create table stuinfo(
       id tinyint primary key,
       name varchar(20)
)engine=innodb;

drop table if exists stuscore;
create table stuscore(
       sid tinyint primary key,
       score tinyint unsigned,
       foreign key(sid) references stuinfo(id)   -- 创建外键
)engine=innodb;

-- 通过修改表的时候添加外键
语法：alter table 从表 add foreign key(公共字段) references 主表(公共字段)

drop table if exists stuinfo;
create table stuinfo(
       id tinyint primary key,
       name varchar(20)
)engine=innodb;

drop table if exists stuscore;
create table stuscore(
       sid tinyint primary key,
       score tinyint unsigned
)engine=innodb;

alter table stuscore add foreign key (sid) references stuinfo(id)
</code></pre> 
<p>删除外键</p> 
<pre><code>通过外键的名字删除外键
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/27/YLmoh1l7_o.png" alt="1560071984394"></p> 
<pre><code class="prism language-mysql">-- 删除外键
mysql&gt; alter table stuscore drop foreign key `stuscore_ibfk_1`;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>小结：</p> 
<pre><code>1、只有innodb才能支持外键
2、公共字段的名字可以不一样，但是数据类型要一样
</code></pre> 
<h5><a id="154___1928"></a>1.5.4 三种外键操作</h5> 
<p>1、 严格限制（参见主表和从表）</p> 
<p>2、 置空操作（set null）：如果主表记录删除，或关联字段更新，则从表外键字段被设置为null。</p> 
<p>3、 级联操作（cascade）：如果主表记录删除，则从表记录也被删除。主表更新，从表外键字段也更新。</p> 
<p>语法：foreign key (外键字段) references 主表名 (关联字段) [主表记录删除时的动作] [主表记录更新时的动作]。</p> 
<p>一般说删除时置空，更新时级联。</p> 
<pre><code class="prism language-mysql">drop table if exists stuinfo;
create table stuinfo(
       id tinyint primary key comment '学号，主键',
       name varchar(20) comment '姓名'
)engine=innodb;

drop table if exists stuscore;
create table stuscore(
       id int auto_increment primary key comment '主键',
       sid tinyint comment '学号，外键',
       score tinyint unsigned comment '成绩',
       foreign key(sid) references stuinfo(id) on delete set null on update cascade
)engine=innodb;
</code></pre> 
<p>小结：</p> 
<pre><code>置空、级联操作中外键不能是从表的主键
</code></pre> 
<h3><a id="16___1964"></a>1.6 补充</h3> 
<p>phpstudy中MySQL默认不是严格模式，将MySQL设置成严格模式</p> 
<p>打开my.ini，在sql-mode的值中，添加STRICT_TRANS_TABLES</p> 
<pre><code class="prism language-mysql">sql-mode="NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES"
</code></pre> 
<p>测试</p> 
<p><img src="https://images2.imgbox.com/fa/d8/EA4Ja6NE_o.png" alt="1560045247420"></p> 
<p>单词</p> 
<pre><code>medium：中等的
small:小
tiny:微小
big:大
</code></pre> 
<h3><a id="12___1989"></a>1.2 实体之间的关系</h3> 
<p><img src="https://images2.imgbox.com/29/18/v2QHGswO_o.png" alt=""></p> 
<h5><a id="121__1N_1995"></a>1.2.1 一对多（1：N）</h5> 
<p>主表中的一条记录对应从表中的多条记录</p> 
<p><img src="https://images2.imgbox.com/38/92/QNxf2NQO_o.png" alt="1560221075643"></p> 
<p>实现一对多的方式：主键和非主键建关系</p> 
<p>问题：说出几个一对多的关系？</p> 
<pre><code>班主任表——学生表
品牌表——商品表
</code></pre> 
<h5><a id="122__N1_2012"></a>1.2.2 多对一（N：1）</h5> 
<p>多对一就是一对多</p> 
<h5><a id="123__11_2018"></a>1.2.3 一对一（1:1）</h5> 
<p><img src="https://images2.imgbox.com/ca/42/VQHXIFOp_o.png" alt="1560221405217"></p> 
<p>如何实现一对一：主键和主键建关系</p> 
<p>思考：一对一两个表完全可以用一个表实现，为什么还要分成两个表？</p> 
<pre><code>答：在字段数量很多情况下，数据量也就很大，每次查询都需要检索大量数据，这样效率低下。我们可以将所有字段分成两个部分，“常用字段”和“不常用字段”，这样对大部分查询者来说效率提高了。【表的垂直分割】
</code></pre> 
<h5><a id="123__NM_2034"></a>1.2.3 多对多（N：M）</h5> 
<p>主表中的一条记录对应从表中的多条记录，从表中的一条记录，对应主表中的多条记录</p> 
<p><img src="https://images2.imgbox.com/0a/5c/1dHsSE6G_o.png" alt="1560221806844"></p> 
<p>如何实现多对多：利用第三张关系表</p> 
<p>问题：说出几个多对多的关系？</p> 
<pre><code>讲师表——学生表
课程表——学生表
商品表——订单表
</code></pre> 
<p>小结：</p> 
<pre><code>如何实现一对一：主键和主键建关系
如果实现一对多：主键和非主键建关系
如何实现多对多：引入第三张关系表
</code></pre> 
<h3><a id="13__2062"></a>1.3 数据库设计</h3> 
<h5><a id="131___2064"></a>1.3.1 数据库设计的步骤</h5> 
<ol><li> <p>收集信息：与该系统有关人员进行交流、坐谈，充分理解数据库需要完成的任务</p> </li><li> <p>标识对象（实体－Entity）：标识数据库要管理的关键对象或实体</p> </li><li> <p>标识每个实体的属性（Attribute）</p> </li><li> <p>标识对象之间的关系（Relationship）</p> </li><li> <p>将模型转换成数据库</p> </li><li> <p>规范化</p> </li></ol> 
<h5><a id="132___2078"></a>1.3.2 例题</h5> 
<p>第一步：收集信息</p> 
<pre><code>BBS论坛的基本功能：
用户注册和登录，后台数据库需要存放用户的注册信息和在线状态信息；
用户发贴，后台数据库需要存放贴子相关信息，如贴子内容、标题等；
用户可以对发帖进行回复；
论坛版块管理：后台数据库需要存放各个版块信息，如版主、版块名称、贴子数等；
</code></pre> 
<p>第二步：标识对象</p> 
<pre><code>实体一般是名词：
1、用户对象
2、板块对象
3、帖子对象
4、跟帖对象
</code></pre> 
<p>第三步：标识每个实体的属性</p> 
<p><img src="https://images2.imgbox.com/4e/52/VTj7BlIr_o.png" alt="1560223195475"></p> 
<p>第四步：标识对象之间的关系</p> 
<h5><a id="133__ER_2110"></a>1.3.3 绘制E-R图</h5> 
<p>E-R（Entity－Relationship）实体关系图）</p> 
<p><img src="https://images2.imgbox.com/f3/dc/FbqoQNQI_o.png" alt="1560223286699"></p> 
<p><img src="https://images2.imgbox.com/38/ba/r6mvXqXi_o.png" alt="1560223316751"></p> 
<p>完整的E-R图</p> 
<p><img src="https://images2.imgbox.com/77/60/qnjMzBme_o.png" alt="1560223404717"></p> 
<h5><a id="134___ER_2128"></a>1.3.4 将E-R图转成表</h5> 
<ol><li>实体转成表，属性转成字段</li><li>如果没有合适的字段做主键，给表添加一个自动增长列做主键。</li></ol> 
<h3><a id="14___2135"></a>1.4 数据规范化</h3> 
<h5><a id="141___2137"></a>1.4.1 第一范式：确保每列原则性</h5> 
<p>第一范式：的目标是确保每列的原子性，一个字段表示一个含义</p> 
<p><img src="https://images2.imgbox.com/19/b1/f4KLQPXw_o.png" alt="1560224318942"></p> 
<p>思考如下表是否满足第一范式</p> 
<p><img src="https://images2.imgbox.com/6f/82/Fnhj5Ch4_o.png" alt="1560224468259"></p> 
<p>思考：地址包含省、市、县、地区是否需要拆分？</p> 
<p>答：如果仅仅起地址的作用，不需要统计，可以不拆分；如果有按地区统计的功能需要拆分。</p> 
<p>在实际项目中，建议拆分。</p> 
<h5><a id="142___2157"></a>1.4.2 第二范式：非键字段必须依赖于键字段</h5> 
<p>第二范式：在满足第一范式的前提下，要求每个表只描述一件事情</p> 
<p><img src="https://images2.imgbox.com/1d/23/WDYZ360l_o.png" alt=""></p> 
<p>思考：如下表设计是否合理</p> 
<p><img src="https://images2.imgbox.com/27/08/dzzztnSY_o.png" alt="1560225229812"></p> 
<h5><a id="143___2167"></a>1.4.3 第三范式：消除传递依赖</h5> 
<p>第三范式：在满足第二范式的前提下，除了主键以外的其他列消除传递依赖。</p> 
<p><img src="https://images2.imgbox.com/64/3b/qph2qb4o_o.png" alt="1560225494968"></p> 
<p>思考：如下表设计是否合理？</p> 
<p><img src="https://images2.imgbox.com/db/21/ZeSXq7aP_o.png" alt="1560225662925"></p> 
<p>结论：不满足第三范式，因为语文和数学确定了，总分就确定了</p> 
<h5><a id="144__3NF_2179"></a>1.4.4 反3NF</h5> 
<p>范式越高，数据冗余越少，但是效率有时就越地下，为了提高运行效率，可以适当让数据冗余。</p> 
<table><thead><tr><th>学号</th><th>姓名</th><th>语文</th><th>数学</th><th>总分</th></tr></thead><tbody><tr><td>1</td><td>李白</td><td>77</td><td>88</td><td>165</td></tr></tbody></table> 
<p>上面的设计不满足第三范式，但是高考分数表就是这样设计的，为什么？</p> 
<p>答：高考分数峰值访问量非常大，这时候就是性能更重要。当性能和规范化冲突的时候，我们首选性能。这就是“反三范式”。</p> 
<p>小结</p> 
<p>1、第一范式约束的所有字段</p> 
<p>2、第二范式约束的主键和非主键的关系</p> 
<p>3、第三范式约束的非主键之间的关系</p> 
<p>4、范式越高，冗余越少，但表业越多。</p> 
<p>5、规范化和性能的关系 ：性能比规范化更重要</p> 
<h5><a id="145___2207"></a>1.4.5 例题</h5> 
<p>需求</p> 
<pre><code>假设某建筑公司要设计一个数据库。公司的业务规
则概括说明如下：
公司承担多个工程项目，每一项工程有：工程号、工程名称、施工人员等
公司有多名职工，每一名职工有：职工号、姓名、性别、职务（工程师、技术员）等
公司按照工时和小时工资率支付工资，小时工资率由职工的职务决定（例如，技术员的小时工资率与工程师不同）
</code></pre> 
<p>标识实体</p> 
<pre><code>1、工程
2、职工
3、工时
4、小时工资率
</code></pre> 
<p><img src="https://images2.imgbox.com/34/00/yVTNFX2z_o.png" alt="1560235875441"></p> 
<h3><a id="15___2232"></a>1.5 查询语句</h3> 
<pre><code class="prism language-mysql">语法：select [选项] 列名 [from 表名] [where 条件]  [group by 分组] [order by 排序][having 条件] [limit 限制]
</code></pre> 
<h5><a id="151____2238"></a>1.5.1 字段表达式</h5> 
<pre><code class="prism language-mysql">-- 可以直接输出内容
mysql&gt; select '锄禾日当午';
+------------+
| 锄禾日当午          |
+------------+
| 锄禾日当午          |
+------------+
1 row in set (0.00 sec)

-- 输出表达式
mysql&gt; select 10*10;
+-------+
| 10*10 |
+-------+
|   100 |
+-------+
1 row in set (0.00 sec)

mysql&gt; select ch,math,ch+math from stu;
+------+------+---------+
| ch   | math | ch+math |
+------+------+---------+
|   80 | NULL |    NULL |
|   77 |   76 |     153 |
|   55 |   82 |     137 |
| NULL |   74 |    NULL |


-- 表达式部分可以用函数
mysql&gt; select rand();
+--------------------+
| rand()             |
+--------------------+
| 0.6669325378415478 |
+--------------------+
1 row in set (0.00 sec)
</code></pre> 
<p>通过as给字段取别名</p> 
<pre><code class="prism language-mysql">mysql&gt; select '锄禾日当午' as '标题';   -- 取别名
+------------+
| 标题           |
+------------+
| 锄禾日当午          |
+------------+
1 row in set (0.00 sec)

mysql&gt; select ch,math,ch+math as '总分' from stu;
+------+------+------+
| ch   | math | 总分    |
+------+------+------+
|   80 | NULL | NULL |
|   77 |   76 |  153 |
|   55 |   82 |  137 |
| NULL |   74 | NULL |

-- 多学一招：as可以省略
mysql&gt; select ch,math,ch+math '总分' from stu;
+------+------+------+
| ch   | math | 总分    |
+------+------+------+
|   80 | NULL | NULL |
|   77 |   76 |  153 |
|   55 |   82 |  137 |
| NULL |   74 | NULL |
</code></pre> 
<h5><a id="152___from_2312"></a>1.5.2 from子句</h5> 
<p>from：来自，from后面跟的是数据源。数据源可以有多个。返回笛卡尔积。</p> 
<p>插入测试表</p> 
<pre><code class="prism language-mysql">create table t1(
       str char(2)
);
insert into t1 values ('aa'),('bb');
create table t2(
       num int
);
insert into t2 values (10),(20);
</code></pre> 
<p>测试</p> 
<pre><code class="prism language-mysql">-- from子句
mysql&gt; select * from t1;
+------+
| str  |
+------+
| aa   |
| bb   |
+------+
2 rows in set (0.00 sec)

-- 多个数据源,返回笛卡尔积
mysql&gt; select * from t1,t2;
+------+------+
| str  | num  |
+------+------+
| aa   |   10 |
| bb   |   10 |
| aa   |   20 |
| bb   |   20 |
+------+------+
4 rows in set (0.00 sec)
</code></pre> 
<h5><a id="153___dual_2357"></a>1.5.3 dual表</h5> 
<p>dual表是一个伪表。在有些特定情况下，没有具体的表的参与，但是为了保证select语句的完整又必须要一个表名，这时候就使用伪表。</p> 
<pre><code class="prism language-mysql">mysql&gt; select 10*10 as 结果 from dual;
+------+
| 结果     |
+------+
|  100 |
+------+
1 row in set (0.00 sec)
</code></pre> 
<h5><a id="154___where_2373"></a>1.5.4 where子句</h5> 
<p>where后面跟的是条件，在数据源中进行筛选。返回条件为真记录</p> 
<p>MySQL支持的运算符</p> 
<pre><code class="prism language-MySQL">-- 比较运算符
&gt;	大于
&lt;	小于
&gt;=	大于等于
&lt;=	小于等于
=	等于
!=	不等于
-- 逻辑运算符
and  与
or   或
not  非
-- 其他
in | not in	 					 字段的值在枚举范围内
between…and|not between…and      字段的值在数字范围内
is null | is not null			 字段的值不为空
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">-- 查找语文成绩及格的学生
mysql&gt; select * from stu where ch&gt;=60;
-- 查询语文和数学都及格的学生
mysql&gt; select * from stu where ch&gt;=60 and math&gt;=60;
-- 查询语文或数学不及格的学生
mysql&gt; select * from stu where ch&lt;60 or math&lt;60;
</code></pre> 
<p>思考：如下语句输出什么？</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stu where 1;		-- 输出所有数据
mysql&gt; select * from stu where 0;		-- 不输出数据
</code></pre> 
<p>思考：如何查找北京和上海的学生</p> 
<pre><code class="prism language-mysql">-- 通过or实现
mysql&gt; select * from stu where stuaddress='北京' or stuaddress='上海';

-- 通过in语句实现
mysql&gt; select * from stu where stuaddress in ('北京','上海');

-- 查询不是北京和上海的学生
mysql&gt; select * from stu where stuaddress not in ('北京','上海');
</code></pre> 
<p>思考：查找年龄在20~25之间</p> 
<pre><code class="prism language-mysql">-- 方法一：
mysql&gt; select * from stu where stuage&gt;=20 and stuage&lt;=25;

-- 方法二：
mysql&gt; select * from stu where not(stuage&lt;20 or stuage&gt;25);

-- 方法三：between...and...
mysql&gt; select * from stu where stuage between 20 and 25;

-- 年龄不在20~25之间
mysql&gt; select * from stu where stuage not between 20 and 25;
</code></pre> 
<p>思考：</p> 
<pre><code class="prism language-mysql">-- 查找缺考的学生
mysql&gt; select * from stu where ch is null or math is null;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           |   80 | NULL |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | NULL |   74 |
+--------+----------+--------+--------+---------+------------+------+------+

-- 查找没有缺考的学生
mysql&gt; select * from stu where ch is not null and math is not null;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25302 | 李文才        | 男       |     31 |       3 | 上海          |   77 |   76 |
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |   55 |   82 |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |   72 |   56 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |   74 |   67 |
| s25320 | Tom      | 男       |     24 |       8 | 北京           |   65 |   67 |
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
+--------+----------+--------+--------+---------+------------+------+------+
7 rows in set (0.00 sec)

-- 查找需要补考的学生
mysql&gt; select * from stu where ch&lt;60 or math&lt;60 or ch is null or math is null;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           |   80 | NULL |
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |   55 |   82 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | NULL |   74 |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |   72 |   56 |
+--------+----------+--------+--------+---------+------------+------+------+
4 rows in set (0.00 sec)
</code></pre> 
<p>练习：</p> 
<pre><code class="prism language-mysql">-- 1、查找学号是s25301,s25302,s25303的学生
mysql&gt; select * from stu where stuno in ('s25301','s25302','s25303');
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |   80 | NULL |
| s25302 | 李文才       | 男       |     31 |       3 | 上海          |   77 |   76 |
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |   55 |   82 |
+--------+---------+--------+--------+---------+------------+------+------+
3 rows in set (0.00 sec)

-- 2、查找年龄是18~20的学生
mysql&gt; select * from stu where stuage between 18 and 20;
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |   80 | NULL |
+--------+---------+--------+--------+---------+------------+------+------+
1 row in set (0.00 sec)
</code></pre> 
<h5><a id="155__group_by__2516"></a>1.5.5 group by 【分组查询】</h5> 
<p>将查询的结果分组，分组查询目的在于统计数据。</p> 
<pre><code class="prism language-mysql">-- 查询男生和女生的各自语文平均分
mysql&gt; select stusex,avg(ch) '平均分' from stu group by stusex;
+--------+---------+
| stusex | 平均分       |
+--------+---------+
| 女      | 72.2500 |
| 男       | 77.0000 |
+--------+---------+
2 rows in set (0.00 sec)

-- 查询男生和女生各自多少人
mysql&gt; select stusex,count(*) 人数 from stu group by stusex;
+--------+------+
| stusex | 人数     |
+--------+------+
| 女      |    4 |
| 男       |    5 |
+--------+------+
2 rows in set (0.00 sec)

-- 查询每个地区多少人
mysql&gt; select stuaddress,count(*) from stu group by stuaddress;
+------------+----------+
| stuaddress | count(*) |
+------------+----------+
| 上海          |        1 |
| 北京           |        3 |
| 天津           |        2 |
| 河北          |        2 |
| 河南           |        1 |
+------------+----------+
5 rows in set (0.00 sec)

-- 每个地区的数学平均分
mysql&gt; select stuaddress,avg(math) from stu group by stuaddress;
+------------+-----------+
| stuaddress | avg(math) |
+------------+-----------+
| 上海          |   76.0000 |
| 北京           |   74.5000 |
| 天津           |   83.0000 |
| 河北          |   72.0000 |
| 河南           |   56.0000 |
+------------+-----------+
5 rows in set (0.00 sec)
</code></pre> 
<p>查询字段是普通字段，只取第一个值</p> 
<p><img src="https://images2.imgbox.com/75/da/uhDy8Crq_o.png" alt="1560240652887"></p> 
<p>通过group_concat()函数将同一组的值连接起来显示</p> 
<pre><code class="prism language-mysql">mysql&gt; select group_concat(stuname),stusex,avg(math) from stu group by stusex;
+-------------------------------------+--------+-----------+
| group_concat(stuname)               | stusex | avg(math) |
+-------------------------------------+--------+-----------+
| 李斯文,诸葛丽丽,梅超风,Tabm             | 女      |   70.5000 |
| 张秋丽,李文才,欧阳俊雄,争青小子,Tom      | 男       |   77.2500 |
+-------------------------------------+--------+-----------+
2 rows in set (0.00 sec)
</code></pre> 
<p>多列分组</p> 
<pre><code class="prism language-mysql">mysql&gt; select stuaddress,stusex,avg(math) from stu group by stuaddress,stusex;
+------------+--------+-----------+
| stuaddress | stusex | avg(math) |
+------------+--------+-----------+
| 上海          | 男       |   76.0000 |
| 北京           | 女      |   82.0000 |
| 北京           | 男       |   67.0000 |
| 天津           | 男       |   83.0000 |
| 河北          | 女      |   72.0000 |
| 河南           | 女      |   56.0000 |
+------------+--------+-----------+
6 rows in set (0.00 sec)
</code></pre> 
<p>小结：</p> 
<pre><code>1、如果是分组查询，查询字段是分组字段和聚合函数。
2、查询字段是普通字段，只取第一个值
3、group_concat()将同一组的数据连接起来
</code></pre> 
<h5><a id="156_order_by_2616"></a>1.5.6 order by排序</h5> 
<p>asc：升序【默认】</p> 
<p>desc：降序</p> 
<pre><code class="prism language-mysql">-- 按年龄的升序排列
mysql&gt; select * from stu order by stuage asc;
mysql&gt;  select * from stu order by stuage;       -- 默认是升序

-- 按总分降序
mysql&gt; select *,ch+math '总分' from stu order by ch+math desc;
</code></pre> 
<p>多列排序</p> 
<pre><code class="prism language-mysql">-- 年龄升序，如果年龄一样，按ch降序排列
mysql&gt; select * from stu order by stuage asc,ch desc;
</code></pre> 
<p>思考如下代码表示什么含义</p> 
<pre><code class="prism language-mysql">select * from stu order by stuage desc,ch desc;     #年龄降序，语文降序
select * from stu order by stuage desc,ch asc;		#年龄降序，语文升序
select * from stu order by stuage,ch desc;          #年龄升序、语文降序
select * from stu order by stuage,ch; 				#年龄升序、语文升序
</code></pre> 
<h5><a id="157__having_2649"></a>1.5.7 having条件</h5> 
<p>having：是在结果集上进行条件筛选</p> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 查询女生
mysql&gt; select * from stu where stusex='女';
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |   55 |   82 |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |   72 |   56 |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |   74 |   67 |
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
+--------+----------+--------+--------+---------+------------+------+------+
4 rows in set (0.00 sec)

-- 查询女生
mysql&gt; select * from stu having stusex='女';
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |   55 |   82 |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |   72 |   56 |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |   74 |   67 |
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
+--------+----------+--------+--------+---------+------------+------+------+
4 rows in set (0.00 sec)

-- 查询女生姓名
mysql&gt; select stuname from stu where stusex='女';
+----------+
| stuname  |
+----------+
| 李斯文        |
| 诸葛丽丽         |
| 梅超风        |
| Tabm     |
+----------+
4 rows in set (0.00 sec)

-- 使用having报错，因为结果集中没有stusex字段
mysql&gt; select stuname from stu having stusex='女';
ERROR 1054 (42S22): Unknown column 'stusex' in 'having clause'
</code></pre> 
<p>小结：having和where的区别：</p> 
<p>where是对原始数据进行筛选，having是对记录集进行筛选。</p> 
<h5><a id="158_limit_2705"></a>1.5.8 limit</h5> 
<p>语法：limit [起始位置]，显示长度</p> 
<pre><code class="prism language-mysql">-- 从第0个位置开始取，取3条记录
mysql&gt; select * from stu limit 0,3;

-- 从第2个位置开始取，取3条记录
mysql&gt; select * from stu limit 2,3;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |   55 |   82 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | NULL |   74 |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |   72 |   56 |
+--------+----------+--------+--------+---------+------------+------+------+
3 rows in set (0.00 sec)
</code></pre> 
<p>起始位置可以省略，默认是从0开始</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stu limit 3;
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |   80 | NULL |
| s25302 | 李文才       | 男       |     31 |       3 | 上海          |   77 |   76 |
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |   55 |   82 |
+--------+---------+--------+--------+---------+------------+------+------+
3 rows in set (0.00 sec)
</code></pre> 
<p>例题：找出班级总分前三名</p> 
<pre><code class="prism language-mysql">mysql&gt; select *,ch+math total from stu order by (ch+math) desc limit 0,3;
+--------+----------+--------+--------+---------+------------+------+------+-------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math | total |
+--------+----------+--------+--------+---------+------------+------+------+-------+
| s25318 | 争青小子   | 男       |     26 |       6 | 天津           |   86 |   92 |   178 |
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |   165 |
| s25302 | 李文才    | 男       |     31 |       3 | 上海          |   77 |   76 |   153 |
+--------+----------+--------+--------+---------+------------+------+------+-------+
3 rows in set (0.00 sec)
</code></pre> 
<p>多学一招：limit在update和delete语句中也是可以使用的。</p> 
<pre><code class="prism language-mysql">-- 	前3名语文成绩加1分
mysql&gt; update stu set ch=ch+1 order by ch+math desc limit 3;
Query OK, 3 rows affected (0.00 sec)
Rows matched: 3  Changed: 3  Warnings: 0

-- 前3名删除
mysql&gt; delete from stu order by ch+math desc limit 3;
Query OK, 3 rows affected (0.00 sec)
</code></pre> 
<h5><a id="159__2770"></a>1.5.9 查询语句中的选项</h5> 
<p>查询语句中的选项有两个：</p> 
<p>1、 all：显示所有数据 【默认】</p> 
<p>2、 distinct：去除结果集中重复的数据</p> 
<pre><code class="prism language-mysql">mysql&gt; select all stuaddress from stu;
+------------+
| stuaddress |
+------------+
| 北京           |
| 北京           |
| 天津           |
| 河南           |
| 河北          |
| 北京           |
+------------+
6 rows in set (0.00 sec)

-- 去除重复的项
mysql&gt; select distinct stuaddress from stu;
+------------+
| stuaddress |
+------------+
| 北京           |
| 天津           |
| 河南           |
| 河北          |
+------------+
4 rows in set (0.00 sec)
</code></pre> 
<h3><a id="16____2807"></a>1.6 聚合函数</h3> 
<ol><li>sum() 求和</li><li>avg() 求平均值</li><li>max() 求最大值</li><li>min() 求最小值</li><li>count() 求记录数</li></ol> 
<pre><code class="prism language-mysql"># 语文最高分
mysql&gt; select max(ch) '语文最大值' from stu;
+------------+
| 语文最大值          |
+------------+
|         88 |
+------------+
1 row in set (0.00 sec)

#求语文总分、语文平均分、语文最低分、总人数

mysql&gt; select max(ch) 语文最高分,min(ch) 语文最低分,sum(ch) 语文总分,avg(ch) 语文平均分,count(*) 总人数 from stu;
+------------+------------+----------+------------+--------+
| 语文最高分  | 语文最低分   | 语文总分   | 语文平均分  | 总人数  |
+------------+------------+----------+------------+--------+
|         88 |         55 |      597 |    74.6250 |      9 |
+------------+------------+----------+------------+--------+
1 row in set (0.00 sec)
</code></pre> 
<h3><a id="17____2838"></a>1.7 模糊查询</h3> 
<h5><a id="171____2840"></a>1.7.1 通配符</h5> 
<ol><li>_ [下划线] 表示任意一个字符</li><li>% 表示任意字符</li></ol> 
<p>练习</p> 
<pre><code>1、满足“T_m”的有（A、C）
A：Tom         B：Toom       C：Tam         D：Tm     E：Tmo

2、满足“T_m_”的有（ B C）
A:Tmom   B:Tmmm  C:T1m2    D:Tmm     E:Tm

3、满足“张%”的是（ABCD）
A:张三     B：张三丰     C：张牙舞爪      D：张      E：小张

4、满足“%诺基亚%”的是（ABCD）
A：诺基亚2100   B：2100诺基亚   C：把我的诺基亚拿过来   D：诺基亚
</code></pre> 
<h5><a id="172___like_2863"></a>1.7.2 模糊查询（like）</h5> 
<p>模糊查询的条件不能用’='，要使用like。</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stu where stuname like 'T_m';
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25320 | Tom     | 男       |     24 |       8 | 北京           |   65 |   67 |
+--------+---------+--------+--------+---------+------------+------+------+
1 row in set (0.00 sec)

-- 查询姓张的学生
mysql&gt; select * from stu where stuname like '张%';
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽   | 男     |     18 |       1 | 北京        |   80 | NULL |
+--------+---------+--------+--------+---------+------------+------+------+
1 row in set (0.00 sec)
</code></pre> 
<h3><a id="18__union_2888"></a>1.8 union（联合）</h3> 
<p>插入测试数据</p> 
<pre><code class="prism language-mysql">create table emp(
       id tinyint unsigned auto_increment primary key,
       name varchar(20) not null,
       skill set('PHP','mysql','java')
 );
 
insert into emp values (null,'李白',1),(null,'杜甫',2),(null,'白居易',4)
insert into emp values (null,'争青小子',3)
</code></pre> 
<h5><a id="181_union_2903"></a>1.8.1 union的使用</h5> 
<p>作用：将多个select语句结果集纵向联合起来</p> 
<pre><code class="prism language-mysql">语法：select 语句 union [选项] select 语句 union [选项] select 语句
</code></pre> 
<pre><code class="prism language-mysql">-- 查询stu表中的姓名和emp表中姓名 结果自动合并的重复的记录
mysql&gt; select stuname from stu union select name from emp;
</code></pre> 
<p>例题：查询上海的男生和北京的女生</p> 
<pre><code class="prism language-mysql">-- 方法一：
mysql&gt; select * from stu where (stuaddress='上海' and stusex='男') or (stuaddress='北京' and stusex='女');
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25302 | 李文才       | 男       |     31 |       3 | 上海          |   77 |   76 |
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |   55 |   82 |
+--------+---------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)

-- 方法二：union
mysql&gt; select * from stu where stuaddress='上海' and stusex='男' union select * from stu where stuaddress='北京' and stusex='女';
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25302 | 李文才       | 男       |     31 |       3 | 上海          |   77 |   76 |
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |   55 |   82 |
+--------+---------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)

结论：union可以将一个复杂的条件转成两个简单的条件
</code></pre> 
<h5><a id="182___union_2944"></a>1.8.2 union的选项</h5> 
<p>union的选项有两个</p> 
<p>1、 all：显示所有数据</p> 
<p>2、 distinct：去除重复的数据【默认】</p> 
<pre><code class="prism language-mysql">mysql&gt; select stuname from stu union all select name from emp;
</code></pre> 
<h5><a id="183___union_2958"></a>1.8.3 union的注意事项</h5> 
<p>1、 union两边的select语句的字段个数必须一致</p> 
<p>2、 union两边的select语句的字段名可以不一致，最终按第一个select语句的字段名。</p> 
<p>3、 union两边的select语句中的数据类型可以不一致。</p> 
<h3><a id="19__2968"></a>1.9 补充</h3> 
<h5><a id="191___2970"></a>1.9.1 插入数据时主键冲突</h5> 
<pre><code class="prism language-mysql">-- 插入测试表
mysql&gt; create table stu(
    -&gt; id char(4) primary key,
    -&gt; name varchar(20)
    -&gt; )engine=innodb;
Query OK, 0 rows affected (0.06 sec)

-- 插入测试数据
mysql&gt; insert into stu values ('s001','tom');
Query OK, 1 row affected (0.00 sec)
</code></pre> 
<p>如果插入的主键重复会报错</p> 
<p>解决方法：如果插入的主键重复就执行替换</p> 
<p>语法一：</p> 
<pre><code class="prism language-mysql">mysql&gt; replace into stu values('s002','ketty');
Query OK, 2 rows affected (0.00 sec)
# 原理：如果插入的主键不重复就直接插入，如果主键重复就替换（删除原来的记录，插入新记录）
</code></pre> 
<p>语法二（推荐）：</p> 
<pre><code class="prism language-mysql">on duplicate key update # 当插入的值与主键或唯一键有冲突执行update操作
-- 例题
mysql&gt; insert into stu values ('s002','李白') on duplicate key update name='李白';
Query OK, 2 rows affected (0.00 sec)
# 插入的数据和主键或唯一键起冲突，将s002的name字段改为‘李白’
</code></pre> 
<h3><a id="12___3007"></a>1.2 多表查询</h3> 
<h5><a id="121___3009"></a>1.2.1 内连接</h5> 
<p>规则：返回两个表的公共记录</p> 
<p>语法：</p> 
<pre><code class="prism language-mysql">-- 语法一
select * from 表1 inner join 表2 on 表1.公共字段=表2.公共字段
-- 语法二
select * from 表1，表2 where 表1.公共字段=表2.公共字段

</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- inner join
mysql&gt; select * from stuinfo inner join stumarks on stuinfo.stuno=stumarks.stuno;
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | stuNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 | s25303 |          80 |      58 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 | s25302 |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 | s25304 |          65 |      50 |
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 | s25301 |          77 |      82 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 | s25318 |          56 |      48 |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
5 rows in set (0.00 sec)

-- 相同的字段只显示一次
mysql&gt; select s.stuno,stuname,stusex,writtenexam,labexam from stuinfo s inner join stumarks m on s.stuno=m.stuno;
+--------+----------+--------+-------------+---------+
| stuno  | stuname  | stusex | writtenexam | labexam |
+--------+----------+--------+-------------+---------+
| s25303 | 李斯文        | 女      |          80 |      58 |
| s25302 | 李文才        | 男       |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |          65 |      50 |
| s25301 | 张秋丽         | 男       |          77 |      82 |
| s25318 | 争青小子        | 男       |          56 |      48 |
+--------+----------+--------+-------------+---------+
5 rows in set (0.00 sec)

-- 使用where
mysql&gt; select * from stuinfo,stumarks where stuinfo.stuno=stumarks.stuno;
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | stuNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 | s25303 |          80 |      58 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 | s25302 |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 | s25304 |          65 |      50 |
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 | s25301 |          77 |      82 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 | s25318 |          56 |      48 |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
5 rows in set (0.00 sec)
</code></pre> 
<p>多学一招：</p> 
<pre><code class="prism language-mysql">-- 1、内连接中inner可以省略
select * from 表1  join 表2 on 表1.公共字段=表2.公共字段

mysql&gt; select * from stuinfo join stumarks on stuinfo.stuno=stumarks.stuno;
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | stuNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 | s25303 |          80 |      58 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 | s25302 |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 | s25304 |          65 |      50 |
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 | s25301 |          77 |      82 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 | s25318 |          56 |      48 |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
5 rows in set (0.00 sec)

-- 如何实现三表查询
select * from 表1 inner join 表2 on 表1.公共字段=表2.公共字段 inner join 表3 on 表2.公共字段=表3.公共字段

-- 表连接越多，效率越低
</code></pre> 
<p>思考：</p> 
<pre><code>select * from 表1 inner join 表2 on 表1.公共字段=表2.公共字段
和
select * from 表2 inner join 表1 on 表1.公共字段=表2.公共字段   一样吗？

答：一样的
</code></pre> 
<h5><a id="122___3104"></a>1.2.2 左外连接</h5> 
<p>规则：以左边的表为准，右边如果没有对应的记录用null显示</p> 
<p>语法：</p> 
<pre><code>select * from 表1 left join 表2 on 表1.公共字段=表2.公共字段
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; select stuname,writtenexam,labexam from stuinfo left join stumarks on stuinfo.stuno=stumarks.stuno;
+----------+-------------+---------+
| stuname  | writtenexam | labexam |
+----------+-------------+---------+
| 张秋丽         |          77 |      82 |
| 李文才        |          50 |      90 |
| 李斯文        |          80 |      58 |
| 欧阳俊雄        |          65 |      50 |
| 诸葛丽丽         |        NULL |    NULL |
| 争青小子        |          56 |      48 |
| 梅超风        |        NULL |    NULL |
+----------+-------------+---------+
7 rows in set (0.01 sec)
</code></pre> 
<p>思考：</p> 
<pre><code>select * from 表1 left join 表2 on 表1.公共字段=表2.公共字段
和
select * from 表2 left join 表1 on 表1.公共字段=表2.公共字段   一样吗？

答：不一样，第一个SQL以表1为准，第二个SQL以表2为准。
</code></pre> 
<h5><a id="123___3144"></a>1.2.3 右外连接</h5> 
<p>规则：以右边的表为准，左边如果没有对应的记录用null显示</p> 
<p>语法：</p> 
<pre><code>select * from 表1 right join 表2 on 表1.公共字段=表2.公共字段
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; select stuname,writtenexam,labexam from stuinfo right join stumarks on stuinfo.stuno=stumarks.stuno;
+----------+-------------+---------+
| stuname  | writtenexam | labexam |
+----------+-------------+---------+
| 李斯文        |          80 |      58 |
| 李文才        |          50 |      90 |
| 欧阳俊雄        |          65 |      50 |
| 张秋丽         |          77 |      82 |
| 争青小子        |          56 |      48 |
| NULL     |          66 |      77 |
+----------+-------------+---------+
6 rows in set (0.00 sec)
</code></pre> 
<p>思考</p> 
<pre><code>select * from 表1 left join 表2 on 表1.公共字段=表2.公共字段
和
select * from 表2 right join 表1 on 表1.公共字段=表2.公共字段   一样吗？

答：一样
</code></pre> 
<h5><a id="124___3183"></a>1.2.4 交叉连接</h5> 
<p>语法，返回笛卡尔积</p> 
<pre><code>select * from 表1 cross join 表2
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 交叉连接
mysql&gt; select * from stuinfo cross join stumarks;

-- 交叉连接有连接表达式与内连接是一样的
mysql&gt; select * from stuinfo cross join stumarks on stuinfo.stuno=stumarks.stuno;
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | stuNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 | s25303 |          80 |      58 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 | s25302 |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 | s25304 |          65 |      50 |
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 | s25301 |          77 |      82 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 | s25318 |          56 |      48 |
+--------+----------+--------+--------+---------+------------+---------+--------+-------------+---------+
5 rows in set (0.00 sec)
</code></pre> 
<p>小结</p> 
<p>1、交叉连接如果没有连接条件返回笛卡尔积</p> 
<p>2、如果有连接条件和内连接是一样的。</p> 
<h5><a id="125___3219"></a>1.2.5 自然连接</h5> 
<p>自动判断条件连接，判断的条件是依据同名字段</p> 
<p>1、自然内连接（natural join）</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stuinfo natural join stumarks;
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 |          80 |      58 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 |          65 |      50 |
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 |          77 |      82 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 |          56 |      48 |
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
5 rows in set (0.00 sec)
</code></pre> 
<p>2、自然左外连接（natural left join）</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stuinfo natural left join stumarks;
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 |          77 |      82 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 |          50 |      90 |
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 |          80 |      58 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 |          65 |      50 |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           | NULL    |        NULL |    NULL |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 |          56 |      48 |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          | NULL    |        NULL |    NULL |
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
7 rows in set (0.00 sec)
</code></pre> 
<p>3、自然右外连接（natural right join）</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stuinfo natural right join stumarks;
+--------+---------+-------------+---------+----------+--------+--------+---------+------------+
| stuNo  | examNo  | writtenExam | labExam | stuName  | stuSex | stuAge | stuSeat | stuAddress |
+--------+---------+-------------+---------+----------+--------+--------+---------+------------+
| s25303 | s271811 |          80 |      58 | 李斯文        | 女      |     22 |       2 | 北京           |
| s25302 | s271813 |          50 |      90 | 李文才        | 男       |     31 |       3 | 上海          |
| s25304 | s271815 |          65 |      50 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |
| s25301 | s271816 |          77 |      82 | 张秋丽         | 男       |     18 |       1 | 北京           |
| s25318 | s271819 |          56 |      48 | 争青小子        | 男       |     26 |       6 | 天津           |
| s25320 | s271820 |          66 |      77 | NULL     | NULL   |   NULL |    NULL | NULL       |
+--------+---------+-------------+---------+----------+--------+--------+---------+------------+
6 rows in set (0.00 sec)
</code></pre> 
<p>小结：</p> 
<p>1、表连接是通过同名字段来连接的</p> 
<p>2、如果没有同名字段就返回笛卡尔积</p> 
<p>3、同名的连接字段只显示一个，并且将该字段放在最前面</p> 
<h5><a id="126__using_3288"></a>1.2.6 using</h5> 
<p>using用来指定连接字段</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from stuinfo inner join stumarks using(stuno);
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | examNo  | writtenExam | labExam |
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           | s271811 |          80 |      58 |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          | s271813 |          50 |      90 |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           | s271815 |          65 |      50 |
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           | s271816 |          77 |      82 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           | s271819 |          56 |      48 |
+--------+----------+--------+--------+---------+------------+---------+-------------+---------+
5 rows in set (0.00 sec)
</code></pre> 
<p>using的结果也会对公共字段进行优化，优化的规则和自然连接是一样的；</p> 
<h5><a id="127___3310"></a>1.2.7 练习</h5> 
<p>1、显示地区及每个地区参加笔试的人数，并按人数降序排列</p> 
<pre><code class="prism language-mysql">-- 第一步： 显示地区及每个地区参加笔试的人数
mysql&gt; select stuaddress,count(writtenexam) from stuinfo left join stumarks using(stuno) group by stuaddress;
+------------+--------------------+
| stuaddress | count(writtenexam) |
+------------+--------------------+
| 上海          |                  1 |
| 北京           |                  2 |
| 天津           |                  2 |
| 河北          |                  0 |
| 河南           |                  0 |
+------------+--------------------+
5 rows in set (0.00 sec)

-- 第二步：将结果降序排列
mysql&gt; select stuaddress,count(writtenexam) c from stuinfo left join stumarks using(stuno) group by stuaddress order by c desc;
+------------+---+
| stuaddress | c |
+------------+---+
| 北京           | 2 |
| 天津           | 2 |
| 上海          | 1 |
| 河北          | 0 |
| 河南           | 0 |
+------------+---+
5 rows in set (0.00 sec)
</code></pre> 
<p>2、显示有学生参加考试的地区</p> 
<pre><code class="prism language-mysql">-- having筛选
mysql&gt; select stuaddress,count(writtenexam) c from stuinfo left join stumarks using(stuno) group by stuaddress having c&gt;0;
+------------+---+
| stuaddress | c |
+------------+---+
| 上海          | 1 |
| 北京           | 2 |
| 天津           | 2 |
+------------+---+
3 rows in set (0.00 sec)

-- 表连接实现
-- 第一步：右连接获取有成绩的地区
mysql&gt; select stuaddress from stuinfo right join stumarks using(stuno);
+------------+
| stuaddress |
+------------+
| 北京           |
| 上海          |
| 天津           |
| 北京           |
| 天津           |
| NULL       |
+------------+
6 rows in set (0.00 sec)
-- 第二步：去重复
mysql&gt; select distinct stuaddress from stuinfo right join stumarks using(stuno);
+------------+
| stuaddress |
+------------+
| 北京           |
| 上海          |
| 天津           |
| NULL       |
+------------+
4 rows in set (0.00 sec)

-- 去除null
mysql&gt; select distinct stuaddress from stuinfo right join stumarks using(stuno) having stuaddress is not null;
+------------+
| stuaddress |
+------------+
| 北京           |
| 上海          |
| 天津           |
+------------+
3 rows in set (0.00 sec)
</code></pre> 
<p>3、显示男生和女生的人数</p> 
<pre><code class="prism language-mysql">-- 方法一： 分组查询
mysql&gt; select stusex,count(*) from stuinfo group by stusex;
+--------+----------+
| stusex | count(*) |
+--------+----------+
| 女      |        3 |
| 男       |        4 |
+--------+----------+
2 rows in set (0.00 sec)

-- 方法二： union
mysql&gt; select stusex,count(*) from stuinfo where stusex='男' union select stusex,count(*) from stuinfo where stusex='女';
+--------+----------+
| stusex | count(*) |
+--------+----------+
| 男       |        4 |
| 女      |        3 |
+--------+----------+
2 rows in set (0.00 sec)

-- 方法三：直接写条件

mysql&gt; select sum(stusex='男') 男,sum(stusex='女') 女 from stuinfo;
+------+------+
| 男     | 女    |
+------+------+
|    4 |    3 |
+------+------+
1 row in set (0.00 sec)
</code></pre> 
<p>4、显示每个地区男生、女生、总人数</p> 
<pre><code class="prism language-mysql">mysql&gt; select stuaddress,count(*) 总人数,sum(stusex='男') 男,sum(stusex='女') 女 from stuinfo group by stuaddress;
+------------+--------+------+------+
| stuaddress | 总人数       | 男     | 女    |
+------------+--------+------+------+
| 上海          |      1 |    1 |    0 |
| 北京           |      2 |    1 |    1 |
| 天津           |      2 |    2 |    0 |
| 河北          |      1 |    0 |    1 |
| 河南           |      1 |    0 |    1 |
+------------+--------+------+------+
5 rows in set (0.00 sec)
</code></pre> 
<h3><a id="13___3452"></a>1.3 子查询</h3> 
<p>语法：select * from 表1 where （子查询）</p> 
<p>外面的查询称为父查询</p> 
<p>子查询为父查询提供查询条件</p> 
<h5><a id="131___3462"></a>1.3.1 标量子查询</h5> 
<p>特点：子查询返回的值是一个</p> 
<pre><code class="prism language-mysql">-- 查找笔试成绩是80的学生
mysql&gt; select * from stuinfo where stuno=(select stuno from stumarks where writtenexam=80);
+--------+---------+--------+--------+---------+------------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |
+--------+---------+--------+--------+---------+------------+
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |
+--------+---------+--------+--------+---------+------------+
1 row in set (0.00 sec)


-- 查找最高分的学生
-- 方法一
mysql&gt; select * from stuinfo where stuno=(select stuno from stumarks order by writtenexam desc limit 1);
+--------+---------+--------+--------+---------+------------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |
+--------+---------+--------+--------+---------+------------+
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |
+--------+---------+--------+--------+---------+------------+
1 row in set (0.00 sec)

-- 方法二：
mysql&gt; select * from stuinfo where stuno=(select stuno from stumarks where writtenexam=(select max(writtenexam) from stumarks))
+--------+---------+--------+--------+---------+------------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |
+--------+---------+--------+--------+---------+------------+
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |
+--------+---------+--------+--------+---------+------------+
1 row in set (0.00 sec)
</code></pre> 
<h5><a id="132___3499"></a>1.3.2 列子查询</h5> 
<p>特点： 子查询返回的结果是一列</p> 
<p>如果子查询的结果返回多条记录，不能使用等于，用in或not in</p> 
<pre><code class="prism language-mysql">-- 查找及格的同学
mysql&gt; select * from stuinfo where stuno in (select stuno from stumarks where writtenexam&gt;=60);
+--------+----------+--------+--------+---------+------------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |
+--------+----------+--------+--------+---------+------------+
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           |
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |
+--------+----------+--------+--------+---------+------------+
3 rows in set (0.00 sec)

-- 查询不及格的同学
mysql&gt; select * from stuinfo where stuno in (select stuno from stumarks where writtenexam&lt;60);
+--------+----------+--------+--------+---------+------------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |
+--------+----------+--------+--------+---------+------------+
| s25302 | 李文才        | 男       |     31 |       3 | 上海          |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |
+--------+----------+--------+--------+---------+------------+
2 rows in set (0.00 sec)

-- 查询需要补考的学生
mysql&gt; select * from stuinfo where stuno not in (select stuno from stumarks where writtenexam&gt;=60);
+--------+----------+--------+--------+---------+------------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |
+--------+----------+--------+--------+---------+------------+
| s25302 | 李文才        | 男       |     31 |       3 | 上海          |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |
+--------+----------+--------+--------+---------+------------+
4 rows in set (0.00 sec)
</code></pre> 
<h5><a id="133___3542"></a>1.3.3 行子查询</h5> 
<p>特点：子查询返回的结果是多个字段组成</p> 
<pre><code class="prism language-mysql">-- 查找语文成绩最高的男生和女生

mysql&gt; select * from stu where(stusex,ch) in (select stusex,max(ch) from stu group by stusex);
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
+--------+----------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)
</code></pre> 
<h5><a id="134___3561"></a>1.3.4 表子查询</h5> 
<p>特点：将子查询的结果作为表</p> 
<pre><code class="prism language-mysql">-- 查找语文成绩最高的男生和女生

mysql&gt; select * from (select * from stu order by ch desc) t group by stusex;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |
+--------+----------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)
</code></pre> 
<p>注意：from后面跟的是数据源，如果将子查询当成表来看， 必须给结果集取别名。</p> 
<h5><a id="135__exists_3582"></a>1.3.5 exists子查询</h5> 
<pre><code class="prism language-mysql">-- 如果笔试成绩有人超过80人，就显示所有学生信息
mysql&gt; select * from stuinfo where exists (select * from stumarks where writtenexam&gt;=80);

-- 没有超过80的学生，就显示所有学生信息
mysql&gt; select * from stuinfo where not exists (select * from stumarks where writtenexam&gt;=80);
Empty set (0.00 sec)
</code></pre> 
<p>作用：提高查询效率</p> 
<h3><a id="14___3597"></a>1.4 视图</h3> 
<h5><a id="141___3599"></a>1.4.1 概述</h5> 
<p>1、视图是一张虚拟表，它表示一张表的部分数据或多张表的综合数据，其结构和数据是建立在对表的查询基础上</p> 
<p>2、视图中并不存放数据，而是存放在视图所引用的原始表（基表）中</p> 
<p>3、同一张原始表，根据不同用户的不同需求，可以创建不同的视图</p> 
<h5><a id="142___3609"></a>1.4.2 作用</h5> 
<p>1、筛选表中的行</p> 
<p>2、防止未经许可的用户访问敏感数据</p> 
<p>3、隐藏数据表的结构</p> 
<p>4、降低数据表的复杂程度</p> 
<h5><a id="143___3621"></a>1.4.3 创建视图</h5> 
<p>语法：</p> 
<pre><code class="prism language-mysql">-- 创建视图
create view 视图名
as 
	select 语句；
	
-- 查询视图
select 列名 from 视图
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">-- 创建视图
mysql&gt; create view view1
    -&gt; as
    -&gt; select * from stu where ch&gt;=60 and math&gt;=60;
Query OK, 0 rows affected (0.00 sec)

-- 查询视图
mysql&gt; select * from view1;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25302 | 李文才        | 男       |     31 |       3 | 上海          |   77 |   76 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |   74 |   67 |
| s25320 | Tom      | 男       |     24 |       8 | 北京           |   65 |   67 |
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
+--------+----------+--------+--------+---------+------------+------+------+
5 rows in set (0.02 sec)

-- 视图可以使得降低SQL语句的复杂度
mysql&gt; create view view2
    -&gt; as
    -&gt; select stuno,stusex,writtenexam,labexam from stuinfo natural join stumarks;
Query OK, 0 rows affected (0.01 sec)
</code></pre> 
<h5><a id="144___3666"></a>1.4.4 修改视图</h5> 
<p>语法</p> 
<pre><code>alter view 视图名
as
	select 语句
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">mysql&gt; alter view view2
    -&gt; as
    -&gt; select stuname from stuinfo;
Query OK, 0 rows affected (0.00 sec)
</code></pre> 
<h5><a id="145___3687"></a>1.4.5 删除视图</h5> 
<p>语法</p> 
<pre><code>drop view [if exists ] 视图1，视图,...
</code></pre> 
<p>例题</p> 
<pre><code class="prism language-mysql">mysql&gt; drop view view2;
Query OK, 0 rows affected (0.00 sec)
</code></pre> 
<h5><a id="146___3704"></a>1.4.6 查看视图信息</h5> 
<pre><code class="prism language-mysql">-- 方法一；
mysql&gt; show tables;	-- 显示所有的表和视图

-- 方法二：精确查找视图（视图信息存储在information_schema下的views表中）
mysql&gt; select table_name from information_schema.views;
+------------+
| table_name |
+------------+
| view1      |
+------------+
1 row in set (0.05 sec)

-- 方法三：通过表的comment属性查询视图
mysql&gt; show table status\G;		-- 查询所有表和视图的详细状态信息
mysql&gt; show table status where comment='view'\G   -- 只查找视图信息
</code></pre> 
<p>查询视图的结构</p> 
<pre><code class="prism language-mysql">mysql&gt; desc view1;
</code></pre> 
<p>查询创建视图的语法</p> 
<pre><code class="prism language-mysql">mysql&gt; show create view view1\G
</code></pre> 
<h5><a id="147___3740"></a>1.4.7 视图算法</h5> 
<p>场景：找出语文成绩最高的男生和女生</p> 
<p>方法一：</p> 
<pre><code class="prism language-mysql">mysql&gt; select * from (select * from stu order by ch desc) t group by stusex;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |
+--------+----------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)
</code></pre> 
<p>方法二：</p> 
<pre><code class="prism language-mysql">mysql&gt; create view view3
    -&gt; as
    -&gt; select * from stu order by ch desc;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select * from view3 group by stusex;
+--------+---------+--------+--------+---------+------------+------+------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+---------+--------+--------+---------+------------+------+------+
| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |   80 | NULL |
| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |   55 |   82 |
+--------+---------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)
</code></pre> 
<p>结论：方法一和方法二的结果不一样，这是因为视图的算法造成的。</p> 
<p>视图的算法有：</p> 
<p>1、merge：合并算法（将视图语句和外层语句合并后再执行）</p> 
<p>2、temptable:临时表算法（将视图作为一个临时表来执行）</p> 
<p>3、undefined：未定义算法（用哪种算法有MySQL决定，这是默认算法，视图一般会选merge算法）</p> 
<p>重新通过视图实现</p> 
<pre><code class="prism language-mysql">-- 创建视图，指定算法为临时表算法
mysql&gt; create or replace algorithm=temptable view view3
    -&gt; as
    -&gt; select * from stu order by ch desc;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select * from view3 group by stusex;
+--------+----------+--------+--------+---------+------------+------+------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |
+--------+----------+--------+--------+---------+------------+------+------+
| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |
+--------+----------+--------+--------+---------+------------+------+------+
2 rows in set (0.00 sec)
</code></pre> 
<p>结论：和子查询结果一致。</p> 
<h3><a id="15___3810"></a>1.5 事务</h3> 
<h5><a id="151___3812"></a>1.5.1 概述</h5> 
<p>事务(TRANSACTION)是一个整体，要么一起执行，要么一起不执行</p> 
<h5><a id="152___3818"></a>1.5.2 事务特性</h5> 
<p>事务必须具备以下四个属性，简称ACID 属性：</p> 
<p>原子性（Atomicity）：事务是一个完整的操作。事务的各步操作是不可分的（原子的）；要么都执行，要么都不执行</p> 
<p>一致性（Consistency）：当事务完成时，数据必须处于一致状态</p> 
<p>隔离性（Isolation）：对数据进行修改的所有并发事务是彼此隔离的。</p> 
<p>永久性（Durability）：事务完成后，它对数据库的修改被永久保持。</p> 
<h5><a id="153___3832"></a>1.5.3 事务处理</h5> 
<p>开启事务</p> 
<pre><code class="prism language-mysql">start transaction  或 begin [work]
</code></pre> 
<p>提交事务</p> 
<pre><code class="prism language-mysql">commit
</code></pre> 
<p>回滚事务</p> 
<pre><code class="prism language-mysql">rollback
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">-- 插入测试数据
mysql&gt; create table bank(
    -&gt; card char(4) primary key comment '卡号',
    -&gt; money decimal(10,2) not null
    -&gt; )engine=innodb charset=utf8;
Query OK, 0 rows affected (0.05 sec)

mysql&gt; insert into bank values ('1001',1000),('1002',1);
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

-- 开启事务
mysql&gt; begin;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; delimiter //   -- 更改定界符
mysql&gt; update bank set money=money-100 where card='1001';
    -&gt; update bank set money=money+100 where card='1002' //
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

-- 回滚事务
mysql&gt; rollback //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select * from bank  //
+------+---------+
| card | money   |
+------+---------+
| 1001 | 1000.00 |
| 1002 |    1.00 |
+------+---------+
2 rows in set (0.00 sec)

------------------------------------------------------------------
-- 开启事务
mysql&gt; start transaction  //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; update bank set money=money-100 where card='1001';
    -&gt; update bank set money=money+100 where card='1002' //
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

-- 提交事务
mysql&gt; commit //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select * from bank //
+------+--------+
| card | money  |
+------+--------+
| 1001 | 900.00 |
| 1002 | 101.00 |
+------+--------+
</code></pre> 
<p>设置事务的回滚点</p> 
<pre><code class="prism language-mysql">-- 开启事务
mysql&gt; begin  //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; insert into bank values ('1003',500) //
Query OK, 1 row affected (0.00 sec)

-- 记录事务的回滚点
mysql&gt; savepoint a1  //
Query OK, 0 rows affected (0.00 sec)

mysql&gt; insert into bank values ('1004',200) //
Query OK, 1 row affected (0.00 sec)

-- 回滚到回滚点
mysql&gt; rollback  to a1  //
Query OK, 0 rows affected (0.00 sec)
-- 查询
mysql&gt; select * from bank //
+------+--------+
| card | money  |
+------+--------+
| 1001 | 900.00 |
| 1002 | 101.00 |
| 1003 | 500.00 |
+------+--------+
3 rows in set (0.00 sec)

</code></pre> 
<p>自动提交事务</p> 
<pre><code>每一个SQL语句都是一个独立的事务
</code></pre> 
<p>小结：</p> 
<p>1、事务是事务开启的时候开始</p> 
<p>2、提交事务、回滚事务后事务都结束</p> 
<p>3、只有innodb支持事务</p> 
<p>4、一个SQL语句就是一个独立的事务，开启事务是将多个SQL语句放到一个事务中执行</p> 
<h3><a id="16___3969"></a>1.6 索引</h3> 
<h5><a id="161__3971"></a>1.6.1 概述</h5> 
<p>优点</p> 
<pre><code>加快查询速度
</code></pre> 
<p>缺点：</p> 
<pre><code>带索引的表在数据库中需要更多的存储空间
增、删、改命令需要更长的处理时间，因为它们需要对索引进行更新
</code></pre> 
<h5><a id="162___3988"></a>1.6.2 创建索引的指导原则</h5> 
<p>适合创建索引的列</p> 
<pre><code>1、该列用于频繁搜索
2、该列用于对数据进行排序
3、在WHERE子句中出现的列，在join子句中出现的列。
</code></pre> 
<p>请不要使用下面的列创建索引：</p> 
<pre><code>1、列中仅包含几个不同的值。
2、表中仅包含几行。为小型表创建索引可能不太划算，因为MySQL在索引中搜索数据所花的时间比在表中逐行搜索所花的时间更长 
</code></pre> 
<h5><a id="163___4007"></a>1.6.3 创建索引</h5> 
<p>1、主键索引：主要创建了主键就会自动的创建主键索引</p> 
<p>2、唯一索引：创建唯一键就创建了唯一索引</p> 
<pre><code class="prism language-mysql">-- 创建表的时候添加唯一索引
create table t5(
    id int primary key,
    name varchar(20),
    unique ix_name(name)	-- 添加唯一索引
);

-- 给表添加唯一索引
mysql&gt; create table t5(
    -&gt; name varchar(20),
    -&gt; addr varchar(50)
    -&gt; );
Query OK, 0 rows affected (0.00 sec)

mysql&gt; create unique index ix_name on t5(name);
Query OK, 0 rows affected (0.06 sec)
Records: 0  Duplicates: 0  Warnings: 0

-- 通过更改表的方式创建唯一索引
mysql&gt; alter table t5 add unique ix_addr (addr);
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>普通索引</p> 
<pre><code class="prism language-mysql">-- 创建表的时候添加普通索引
mysql&gt; create table t6(
    -&gt;        id int primary key,
    -&gt;        name varchar(20),
    -&gt;        index ix_name(name)
    -&gt; );
Query OK, 0 rows affected (0.02 sec)

-- 给表添加普通索引
mysql&gt; create table t7(
    -&gt; name varchar(20),
    -&gt; addr varchar(50)
    -&gt; );
Query OK, 0 rows affected (0.00 sec)

mysql&gt; create index ix_name on t7(name) ;
Query OK, 0 rows affected (0.08 sec)
Records: 0  Duplicates: 0  Warnings: 0

-- 通过更改表的方式创建索引
mysql&gt; alter table t7 add index ix_addr(addr);
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<p>小结：</p> 
<p>1、创建主键就会创建主键索引</p> 
<p>2、创建唯一键就会创建唯一索引</p> 
<p>3、创建唯一键的语法</p> 
<pre><code>--语法一
create unique [index] 索引名 on 表名（字段名）
-- 方法二
alter table 表名 add uniqe [index] 索引名(字段名)
</code></pre> 
<p>4、创建普通索引</p> 
<pre><code>-- 语法一
create index 索引名 on 表名（字段名）
-- 语法二
alter table 表名 add index 索引名(字段名)
</code></pre> 
<p>5、索引创建后，数据库根据查询语句自动选择索引</p> 
<h5><a id="164___4096"></a>1.6.4 删除索引</h5> 
<p>语法：drop index 索引名 on 表名</p> 
<pre><code class="prism language-mysql">mysql&gt; drop index ix_name on t7;
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0
</code></pre> 
<h3><a id="17___4108"></a>1.7 函数</h3> 
<h5><a id="171___4110"></a>1.7.1 数字类</h5> 
<pre><code class="prism language-mysql">-- 获取随机数
mysql&gt; select rand();
+------------------+
| rand()           |
+------------------+
| 0.25443412666622 |
+------------------+
1 row in set (0.00 sec)

-- 随机排序
mysql&gt; select * from stuinfo order by rand();

-- 随机获取一条记录
mysql&gt; select * from stuinfo order by rand() limit 1;

-- 四舍五入，向上取整，向下取整
mysql&gt; select round(3.1415926,3) '四舍五入',truncate(3.14159,3) '截取数据',ceil(3.1) '向上取整',floor(3.9) '向下取整';
+----------+----------+----------+----------+
| 四舍五入  | 截取数据  | 向上取整   | 向下取整        |
+----------+----------+----------+----------+
|    3.142 |    3.141 |        4 |        3 |
+----------+----------+----------+----------+
1 row in set (0.04 sec)
注意： 截取数据直接截取，不四舍五入
</code></pre> 
<h5><a id="172__4141"></a>1.7.2 字符串类</h5> 
<pre><code class="prism language-mysql">-- 大小写转换
mysql&gt; select ucase('i name is tom') '转成大写',lcase('My Name IS TOM') '转成小写';
+---------------+----------------+
| 转成大写       | 转成小写         |
+---------------+----------------+
| I NAME IS TOM | my name is tom |
+---------------+----------------+
1 row in set (0.00 sec)

-- 截取字符串
mysql&gt; select left('abcdef',3) '从左边截取',right('abcdef',3) '从右边截取',substring('abcdef',2,3) '字符串';
+------------+------------+--------+
| 从左边截取  | 从右边截取    | 字符串      |
+------------+------------+--------+
| abc        | def        | bcd    |
+------------+------------+--------+
1 row in set (0.00 sec)

-- 字符串相连
mysql&gt; select concat('中国','北京','顺义') '地址';
+--------------+
| 地址            |
+--------------+
| 中国北京顺义           |
+--------------+
1 row in set (0.00 sec)

mysql&gt; select concat(stuname,'-',stusex) 信息 from stuinfo;
+-------------+
| 信息           |
+-------------+
| 张秋丽-男           |
| 李文才-男          |
| 李斯文-女         |
| 欧阳俊雄-男          |
| 诸葛丽丽-女          |
| 争青小子-男          |
| 梅超风-女         |
+-------------+
7 rows in set (0.00 sec)

-- coalesce(str1,str2)  :str1有值显示str1,如果str1为空就显示str2
-- 将成绩为空的显示为缺考
mysql&gt; select stuname,coalesce(writtenexam,'缺考'),coalesce(labexam,'缺考') from stuinfo natural left join stumarks;
+----------+------------------------------+--------------------------+
| stuname  | coalesce(writtenexam,'缺考')    | coalesce(labexam,'缺考')    |
+----------+------------------------------+--------------------------+
| 张秋丽         | 77                          | 82                       |
| 李文才        | 50                           | 90                       |
| 李斯文        | 80                           | 58                       |
| 欧阳俊雄        | 65                           | 50                       |
| 诸葛丽丽         | 缺考                            | 缺考                        |
| 争青小子        | 56                           | 48                       |
| 梅超风        | 缺考                            | 缺考                        |
+----------+------------------------------+--------------------------+
7 rows in set (0.02 sec)

-- length（）:字节长度，char_length()：字符长度
mysql&gt; select length('锄禾日当午') 字节,char_length('锄禾日当午') 字符;
+------+------+
| 字节  | 字符    |
+------+------+
|   10 |    5 |
+------+------+
1 row in set (0.00 sec)
</code></pre> 
<h5><a id="173__4213"></a>1.7.3 时间类</h5> 
<pre><code class="prism language-mysql">-- 时间戳
mysql&gt; select unix_timestamp();
+------------------+
| unix_timestamp() |
+------------------+
|       1560330458 |
+------------------+
1 row in set (0.00 sec)

-- 格式化时间戳
mysql&gt; select from_unixtime(unix_timestamp());
+---------------------------------+
| from_unixtime(unix_timestamp()) |
+---------------------------------+
| 2019-06-12 17:08:18             |
+---------------------------------+
1 row in set (0.05 sec)

-- 获取当前格式化时间
mysql&gt; select now();
+---------------------+
| now()               |
+---------------------+
| 2019-06-12 17:08:50 |
+---------------------+
1 row in set (0.00 sec)

-- 获取年，月，日，小时，分钟，秒
mysql&gt; select year(now()) 年,month(now()) 月,day(now()) 日,hour(now()) 小时,minute(now()) 分钟,second(now())秒;
+------+------+------+------+------+------+
| 年   | 月   | 日    | 小时  | 分钟 | 秒     |
+------+------+------+------+------+------+
| 2019 |    6 |   12 |   17 |   10 |   48 |
+------+------+------+------+------+------+
1 row in set (0.00 sec)

-- 星期，本年第几天;
mysql&gt; select dayname(now()) 星期,dayofyear(now()) 本年第几天;
+-----------+------------+
| 星期          | 本年第几天          |
+-----------+------------+
| Wednesday |        163 |
+-----------+------------+
1 row in set (0.00 sec)

-- 日期相减
mysql&gt; select datediff(now(),'2010-08-08') 相距天数;
+----------+
| 相距天数         |
+----------+
|     3230 |
+----------+
1 row in set (0.00 sec)
</code></pre> 
<h5><a id="174__4271"></a>1.7.4 加密函数</h5> 
<p>1、md5()</p> 
<p>2、sha()</p> 
<pre><code class="prism language-mysql">mysql&gt; select md5('aa');
+----------------------------------+
| md5('aa')                        |
+----------------------------------+
| 4124bc0a9335c27f086f24ba207a4912 |
+----------------------------------+
1 row in set (0.00 sec)

mysql&gt; select sha('aa');
+------------------------------------------+
| sha('aa')                                |
+------------------------------------------+
| e0c9035898dd52fc65c41454cec9c4d2611bfb37 |
+------------------------------------------+
1 row in set (0.00 sec)
</code></pre> 
<h3><a id="18___4297"></a>1.8 预处理</h3> 
<p>每个代码的段的执行都要经历：词法分析——语法分析——编译——执行</p> 
<p>预编译一次，可以多次执行。用来解决一条SQL语句频繁执行的问题。</p> 
<pre><code>预处理语句：prepare 预处理名字 from ‘sql语句’
执行预处理：execute 预处理名字 [using 变量]
</code></pre> 
<p>例题：不带参数的预处理</p> 
<pre><code class="prism language-mysql">-- 创建预处理
mysql&gt; prepare stmt from 'select * from stuinfo';
Query OK, 0 rows affected (0.06 sec)
Statement prepared

-- 执行预处理
mysql&gt; execute stmt;
+--------+----------+--------+--------+---------+------------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |
+--------+----------+--------+--------+---------+------------+
| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           |
| s25302 | 李文才        | 男       |     31 |       3 | 上海          |
| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |
| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |
| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |
+--------+----------+--------+--------+---------+------------+
7 rows in set (0.00 sec)
</code></pre> 
<p>例题：带一个参数的预处理</p> 
<pre><code class="prism language-mysql">-- 创建带有位置占位符的预处理语句
mysql&gt; prepare stmt from 'select * from stuinfo where stuno=?' ;
Query OK, 0 rows affected (0.00 sec)
Statement prepared

-- 调用预处理，并传参数
mysql&gt; delimiter //
mysql&gt; set @id='s25301';
    -&gt; execute stmt using @id //
Query OK, 0 rows affected (0.00 sec)

+--------+---------+--------+--------+---------+------------+
| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |
+--------+---------+--------+--------+---------+------------+
| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |
+--------+---------+--------+--------+---------+------------+
1 row in set (0.00 sec)
</code></pre> 
<p>例题：传递多个参数</p> 
<pre><code class="prism language-mysql">mysql&gt; prepare stmt from 'select * from stuinfo where stuage&gt;? and stusex=?' //
Query OK, 0 rows affected (0.00 sec)
Statement prepared

mysql&gt; set @age=20;
    -&gt; set @sex='男';
    -&gt; execute stmt using @age,@sex //
Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

+--------+----------+--------+--------+---------+------------+
| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |
+--------+----------+--------+--------+---------+------------+
| s25302 | 李文才        | 男       |     31 |       3 | 上海          |
| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |
| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |
+--------+----------+--------+--------+---------+------------+
3 rows in set (0.00 sec)
</code></pre> 
<p>小结：</p> 
<p>1、MySQL中变量以@开头</p> 
<p>2、通过set给变量赋值</p> 
<p>3、？是位置占位符</p> 
<h3><a id="_4394"></a></h3> 
<h3><a id="12____4396"></a>1.2 连接数据库</h3> 
<p><img src="https://images2.imgbox.com/a9/44/Jq26WEPA_o.png" alt="1560480407216"></p> 
<p>通过PHP做MySQL的客户端</p> 
<h5><a id="121__mysqli_4406"></a>1.2.1 开启mysqli扩展</h5> 
<p>在php.ini中开启mysqli扩展</p> 
<pre><code>extension=php_mysqli.dll
</code></pre> 
<p>开启扩展后重启服务器，就可以使用mysqli_函数了，</p> 
<p><img src="https://images2.imgbox.com/98/79/q6HyM6u0_o.png" alt="1560480672990"></p> 
<h5><a id="122___4420"></a>1.2.2 连接数据库</h5> 
<p><strong>创建news数据库</strong></p> 
<pre><code class="prism language-mysql">-- 创建表
drop table if exists news;
create table news(
       id int unsigned auto_increment primary key comment '主键',
       title varchar(20) not null comment '标题',
       content text not null comment '内容',
       createtime int not null comment '添加时间'
)engine=innodb charset=utf8 comment '新闻表';

-- 插入测试数据
insert into news values (null,'锄禾','锄禾日当午',unix_timestamp());
insert into news values (null,'草','离离原上草',unix_timestamp());
</code></pre> 
<p>思考：时间字段可以用datetime类型，也可以使用int类型。一般用int，因为datetime占用8个字节，int占用4个字节。</p> 
<p><strong>连接数据库</strong></p> 
<pre><code class="prism language-php"><span class="token function">mysqli_connect</span><span class="token punctuation">(</span>主机<span class="token constant">IP</span>，用户名，密码，数据库名，端口号<span class="token punctuation">)</span> <span class="token comment">//如果端口号是3306可以省略</span>
<span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取连接数据库的错误信息
<span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取连接数据库的错误编码
<span class="token function">mysqli_set_charset</span><span class="token punctuation">(</span>连接对象<span class="token punctuation">,</span>字符编码<span class="token punctuation">)</span>    
</code></pre> 
<p>代码如下：</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//连接数据库，连接成功返回连接对象</span>
<span class="token variable">$link</span><span class="token operator">=</span>@<span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'3306'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//var_dump($link);			//object(mysqli)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">echo</span> <span class="token string single-quoted-string">'错误号：'</span><span class="token operator">.</span><span class="token function">mysqli_connect_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&lt;br&gt;'</span><span class="token punctuation">;</span>	<span class="token comment">//显示错误编码</span>
	<span class="token keyword">echo</span> <span class="token string single-quoted-string">'错误信息：'</span><span class="token operator">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//显示错误信息</span>
	<span class="token keyword">exit</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//设置字符编码</span>
<span class="token function">mysqli_set_charset</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
</code></pre> 
<p>脚下留心：与数据库相关用utf8，与页面显示相关用utf-8</p> 
<h3><a id="13___4472"></a>1.3 操作数据</h3> 
<h5><a id="131___4474"></a>1.3.1 数据操作语句</h5> 
<p>通过mysqli_query()执行SQL语句</p> 
<p>增、删、改语句执行成功返回true，失败返回false</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//1、连接数据库</span>
<span class="token variable">$link</span><span class="token operator">=</span><span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2、设置支付编码</span>
<span class="token function">mysqli_set_charset</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3、执行SQL语句</span>

<span class="token comment">//3.1  执行insert语句</span>
<span class="token comment">/*
$rs=mysqli_query($link,"insert into news values (null,'静夜思','床前明月光',unix_timestamp())");
if($rs)
	echo '自动增长的编号是：'.mysqli_insert_id($link);
*/</span>

<span class="token comment">//3.2  执行update语句</span>
<span class="token comment">/*
$rs=mysqli_query($link,"update news set content='疑是地上霜' where id=4");
if($rs)
	echo '受影响的记录数是：'.mysqli_affected_rows($link);
else{
	echo '错误码：'.mysqli_errno($link),'&lt;br&gt;';
	echo '错误信息：'.mysqli_error($link);	
}
*/</span>

<span class="token comment">//3.3  执行delete语句</span>
<span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"delete from news where id=5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p>用到的函数</p> 
<pre><code class="prism language-php"><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：执行<span class="token constant">SQL</span>语句
<span class="token function">mysqli_insert_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取插入记录自动增长的<span class="token constant">ID</span>
<span class="token function">mysqli_affected_rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取受影响的记录数
<span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取执行<span class="token constant">SQL</span>语句的错误信息
<span class="token function">mysqli_errno</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取执行<span class="token constant">SQL</span>语句的错误码
</code></pre> 
<h5><a id="132___4523"></a>1.3.2 数据查询语句</h5> 
<p>数据查询用select、desc、show，成功会返回结果集，失败返回false</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//1、连接数据库</span>
<span class="token variable">$link</span><span class="token operator">=</span>@<span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'错误信息：'</span><span class="token operator">.</span><span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2、设置字符编码</span>
<span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'set names utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3、执行查询语句</span>
<span class="token variable">$rs</span><span class="token operator">=</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'select * from news'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//var_dump($rs);	//object(mysqli_result)</span>
<span class="token comment">//4、获取对象中的数据</span>
<span class="token comment">//4.1  将对象中的一条数据匹配成索引数组,指针下移一条</span>
<span class="token comment">//$rows=mysqli_fetch_row($rs);</span>

<span class="token comment">//4.2  将对象中的一条数据匹配成关联数组,指针下移一条</span>
<span class="token comment">//$rows=mysqli_fetch_assoc($rs);</span>

<span class="token comment">//4.3  将对象中的一条数据匹配成索引，关联数组,指针下移一条</span>
<span class="token comment">//$rows=mysqli_fetch_array($rs);</span>

<span class="token comment">//4.4  总列数、总行数</span>
<span class="token comment">//echo '总行数'.mysqli_num_rows($rs),'&lt;br&gt;';</span>
<span class="token comment">//echo '总列数'.mysqli_num_fields($rs),'&lt;br&gt;';</span>

<span class="token comment">//4.5  获取所有数据</span>
<span class="token comment">//$list=mysqli_fetch_all($rs);		//默认是索引数组</span>
<span class="token comment">//$list=mysqli_fetch_all($rs,MYSQLI_NUM);		//匹配成索引数组</span>
<span class="token comment">//$list=mysqli_fetch_all($rs,MYSQLI_ASSOC);		//匹配成关联数组</span>
<span class="token variable">$list</span><span class="token operator">=</span><span class="token function">mysqli_fetch_all</span><span class="token punctuation">(</span><span class="token variable">$rs</span><span class="token punctuation">,</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//匹配成关联、索引数组</span>

<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;pre&gt;'</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$list</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//5、销毁结果集</span>
<span class="token function">mysqli_free_result</span><span class="token punctuation">(</span><span class="token variable">$rs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//6、关闭连接</span>
<span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<p>使用的函数</p> 
<pre><code class="prism language-php"><span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：将一条数组匹配关联数组
<span class="token function">mysqli_fetch_row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：将一条记录匹配成索引数组
<span class="token function">mysqli_fetch_array</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：将一条记录匹配成既有关联数组又有索引数组
<span class="token function">mysqli_fetch_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：匹配所有记录
<span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：总行数
<span class="token function">mysqli_num_fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：总记录数
<span class="token function">mysqli_free_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：销毁结果集
<span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：关闭连接
</code></pre> 
<h3><a id="14___4582"></a>1.4 新闻模块</h3> 
<h5><a id="141___4584"></a>1.4.1 包含文件</h5> 
<p>由于所有的操作都要连接数据库，将连接数据库的代码存放到包含文件中</p> 
<p>步骤</p> 
<p>1、在站点下创建inc文件夹</p> 
<p>2、在inc下创建conn.php文件，用来连接数据库，代码就是上面连接数据库的代码</p> 
<p>代码实现</p> 
<pre><code class="prism language-mysql">&lt;?php
//连接数据库
$link=@mysqli_connect('localhost','root','root','data') or die('错误：'.mysqli_connect_error());
mysqli_set_charset($link,'utf8');
</code></pre> 
<h5><a id="142___4605"></a>1.4.2 显示新闻</h5> 
<p>步骤：</p> 
<p>1、连接数据库</p> 
<p>2、获取数据</p> 
<p>3、遍历循环数据</p> 
<p>代码</p> 
<pre><code class="prism language-php+HTML">&lt;style type="text/css"&gt;
	table{
		width:780px;
		border:solid 1px #000;
		margin:auto;
	}
	th,td{
		border:solid 1px #000;
	}
&lt;/style&gt;
&lt;body&gt;
&lt;?php
//1、连接数据库
require './inc/conn.php';
//2、获取数据
$rs=mysqli_query($link,'select * from news order by id desc');	//返回结果集对象
$list=mysqli_fetch_all($rs,MYSQLI_ASSOC);		//将结果匹配成关联数组
?&gt;
&lt;table&gt;
	&lt;tr&gt;
		&lt;th&gt;编号&lt;/th&gt; &lt;th&gt;标题&lt;/th&gt; &lt;th&gt;内容&lt;/th&gt; &lt;th&gt;时间&lt;/th&gt; &lt;th&gt;修改&lt;/th&gt; &lt;th&gt;删除&lt;/th&gt;
        &lt;!--3、循环显示数据--&gt;
		&lt;?php foreach($list as $rows):?&gt;
		&lt;tr&gt;
			&lt;td&gt;&lt;?php echo $rows['id']?&gt;&lt;/td&gt;
			&lt;td&gt;&lt;?php echo $rows['title']?&gt;&lt;/td&gt;
			&lt;td&gt;&lt;?php echo $rows['content']?&gt;&lt;/td&gt;
			&lt;td&gt;&lt;?php echo date('Y-m-d H:i:s',$rows['createtime'])?&gt;&lt;/td&gt;
			&lt;td&gt;&lt;input type="button" value="修改" οnclick=""&gt;&lt;/td&gt;
			&lt;td&gt;&lt;input type="button" value="删除" οnclick=""&gt;&lt;/td&gt;
		&lt;/tr&gt;
		&lt;?php endforeach;?&gt;
	&lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;
</code></pre> 
<p>运行结果</p> 
<p><img src="https://images2.imgbox.com/6d/c9/hBji3iEz_o.png" alt="1560494286358"></p> 
<h5><a id="143___4661"></a>1.4.3 添加新闻</h5> 
<p>步骤：</p> 
<p>1、创建表单</p> 
<p>2、连接数据库</p> 
<p>3、将新闻数据写入到数据库中</p> 
<p>入口(list.php）</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./add.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>添加新闻<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>代码实现</p> 
<pre><code class="prism language-php+HTML">&lt;body&gt;
&lt;?php
if(!empty($_POST)) {
	//2、连接数据库
	require './inc/conn.php';
    //3、插入数据
	$time=time();	//获取时间戳
	$sql="insert into news values (null,'{$_POST['title']}','{$_POST['content']}',$time)";  //拼接SQL语句
	
	if(mysqli_query($link,$sql))	//执行SQL语句
		header('location:./list.php');	//插入成功就跳转到list.php页面
	else{
		echo 'SQL语句插入失败&lt;br&gt;';
		echo '错误码：'.mysqli_errno($link),'&lt;br&gt;';
		echo '错误信息：'.mysqli_error($link);
	}
}
?&gt;
&lt;!--1、创建表单--&gt;
&lt;form method="post" action=""&gt;
	标题： &lt;input type="text" name="title"&gt; &lt;br /&gt; &lt;br /&gt;
	内容:  &lt;textarea name="content" rows="5" cols="30"&gt;&lt;/textarea&gt; &lt;br /&gt; &lt;br /&gt;
	&lt;input type="submit" name="button" value="提交"&gt;
&lt;/form&gt;
&lt;/body&gt;
</code></pre> 
<p>运行结果</p> 
<p><img src="https://images2.imgbox.com/26/c8/nfFTOBNv_o.png" alt="1560495319869"></p> 
<h5><a id="144___4713"></a>1.4.4 删除新闻</h5> 
<p>步骤：</p> 
<p>1、在list.php页面点击删除按钮，跳转到del.php页面，传递删除的id</p> 
<p>2、在del.php页面连接数据库</p> 
<p>3、通过id删除数据</p> 
<p>4、删除成功后，跳转到list.php</p> 
<p>入口（list.php）</p> 
<pre><code class="prism language-php+HTML">&lt;input type="button" value="删除" οnclick="if(confirm('确定要删除吗'))location.href='./del.php?id=&lt;?php echo $rows['id']?&gt;'"&gt;
</code></pre> 
<p>del.php</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//1、连接数据库</span>
<span class="token keyword">require</span> <span class="token string single-quoted-string">'./inc/conn.php'</span><span class="token punctuation">;</span>
<span class="token comment">//2、拼接SQL语句</span>
<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"delete from news where id=<span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">;</span>
<span class="token comment">//3、执行SQL语句</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'location:./list.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">echo</span> <span class="token string single-quoted-string">'删除失败'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>小结：</p> 
<p>1、一个页面是否写HTML架构，取决于是否有显示功能。</p> 
<p>2、如果一个页面只是做业务逻辑，没有显示功能，就不需要写HTML架构，比如del.php页面</p> 
<p><img src="https://images2.imgbox.com/79/11/PYa0gxbe_o.png" alt="1560496299270"></p> 
<h5><a id="145___4759"></a>1.4.5 修改新闻</h5> 
<p>入口（list.php）</p> 
<pre><code class="prism language-php+HTML">&lt;input type="button" value="修改" οnclick="location.href='edit.php?id=&lt;?php echo $rows['id']?&gt;'"&gt;
</code></pre> 
<p>edit.php页面</p> 
<p>步骤</p> 
<p>第一步：显示修改界面</p> 
<p>​ 1、连接数据库</p> 
<p>​ 2、获取修改的数据</p> 
<p>​ 3、将数据显示到表单中</p> 
<p>第二步：执行修改逻辑</p> 
<p>​ 1、获取新数据</p> 
<p>​ 2、拼接修改的SQL语句，执行修改逻辑</p> 
<p>代码如下</p> 
<pre><code class="prism language-php+HTML">&lt;?php
//连接数据库
require './inc/conn.php';
//1、获取修改的数据库
$sql="select * from news where id={$_GET['id']}";	//拼接SQL语句
$rs=mysqli_query($link,$sql);	//获取修改的数据
$rows=mysqli_fetch_assoc($rs);	//将修改的数据匹配成一维关联数组
//2、执行修改的逻辑
if(!empty($_POST)) {
	$id=$_GET['id'];		//获取修改的id
	$title=$_POST['title'];	//修改的标题
	$content=$_POST['content'];	//修改的内容
	$sql="update news set title='$title',content='$content' where id=$id"; //拼接SQL语句
	if(mysqli_query($link,$sql))
		header('location:list.php');   //修改成功跳转到list.php页面
	else
		echo '错误：'.mysqli_error($link);
	exit;
}
?&gt;
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;form method="post" action=""&gt;
	标题： &lt;input type="text" name="title" value='&lt;?php echo $rows['title']?&gt;'&gt; &lt;br /&gt; &lt;br /&gt;
	内容:  &lt;textarea name="content" rows="5" cols="30"&gt;&lt;?php echo $rows['content']?&gt;&lt;/textarea&gt; &lt;br /&gt; &lt;br /&gt;
	&lt;input type="submit" name="button" value="提交"&gt;
	&lt;input type="button" value="返回" οnclick="location.href='list.php'"&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre> 
<p>运行结果</p> 
<p><img src="https://images2.imgbox.com/35/f3/PiOfrRU6_o.png" alt="1560497260530"></p> 
<h3><a id="15___4834"></a>1.5 数据备份与还原</h3> 
<p>数据库中的数据需要定期备份，数据量小的可以一周备份一次，数据量的可以一天备份一次。</p> 
<h5><a id="151___4838"></a>1.5.1 数据备份</h5> 
<p>利用mysqldump工具，语法：</p> 
<pre><code>mysqldump 数据库连接 数据库 &gt; SQL文件备份地址
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">-- 将data数据库中所有的表导出到data.sql中
F:\wamp\PHPTutorial\MySQL\bin&gt;mysqldump -uroot -proot data&gt;c:\data.sql

-- 将data数据库中的stuinfo、stumarks表
F:\wamp\PHPTutorial\MySQL\bin&gt;mysqldump -uroot -proot data stuinfo stumarks&gt;c:\data.sql

-- 导出data数据库，导出的语句中带有创建数据库的语法
F:\wamp\PHPTutorial\MySQL\bin&gt;mysqldump -uroot -proot -B data&gt;c:\data1.sql
</code></pre> 
<h5><a id="152___4859"></a>1.5.2 数据还原</h5> 
<p>方法一：MySQL的source指令（需要登录MySQL才能使用）</p> 
<pre><code class="prism language-mysql">mysql&gt; source c:/data.sql;
注意：地址分隔符用斜线，不能用反斜线
</code></pre> 
<p>方法二：通过mysql指令数据还原（不需要登录MySQL）</p> 
<p>语法：</p> 
<pre><code>mysql 连接数据库 导入的数据库名 &lt; 导入的SQL文件
</code></pre> 
<p>例题：</p> 
<pre><code class="prism language-mysql">F:\wamp\PHPTutorial\MySQL\bin&gt;mysql -uroot -proot data1 &lt; c:\data.sql
</code></pre> 
<h3><a id="16___4884"></a>1.6 作业：</h3> 
<p>1、通过循环的方式获取表中的所有记录</p> 
<p>2、通过异步实现增、删、改</p> 
<p><strong>异步添加</strong></p> 
<p>add.html</p> 
<pre><code class="prism language-php+HTML">&lt;body&gt;
&lt;script src='./js/jquery-3.3.1.min.js'&gt;&lt;/script&gt;
&lt;script&gt;
$(document).ready(function() {
	$(':button:first').click(function(){
		var title=$('#title').val();
		var content=$('#content').val();
		$.post('./add.php',{'title':title,'content':content},function(data){
			if(data){
				alert('添加成功');
				location.href='list.php';
			}else{
				alert('添加失败');
			}
		})
	})
});
&lt;/script&gt;
&lt;!--1、创建表单--&gt;
&lt;form method="post" action=""&gt;
	标题： &lt;input type="text" id="title"&gt; &lt;br /&gt; &lt;br /&gt;
	内容:  &lt;textarea id="content" rows="5" cols="30"&gt;&lt;/textarea&gt; &lt;br /&gt; &lt;br /&gt;
	&lt;input type="button" name="button" value="提交"&gt;
&lt;/form&gt;
&lt;/body&gt;
</code></pre> 
<p>add.php</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require</span> <span class="token string single-quoted-string">'./inc/conn.php'</span><span class="token punctuation">;</span>
<span class="token variable">$title</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$content</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$time</span><span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"insert into news values (null,'<span class="token interpolation"><span class="token variable">$title</span></span>','<span class="token interpolation"><span class="token variable">$content</span></span>',<span class="token interpolation"><span class="token variable">$time</span></span>)"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>异步删除</strong></p> 
<p>list.php</p> 
<pre><code class="prism language-html">-- button按钮
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>删除<span class="token punctuation">"</span></span> <span class="token attr-name">op</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>del<span class="token punctuation">'</span></span> <span class="token attr-name">newsid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>&lt;?php</span> <span class="token attr-name">echo</span> <span class="token attr-name">$rows['id']?</span><span class="token punctuation">&gt;</span></span>&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>./js/jquery-3.3.1.min.js<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">':button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">var</span> tr<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parents</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//按钮所在的行</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'op'</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'del'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token keyword">var</span> id<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'newsid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//获取新闻的id</span>
			$<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'./del.php'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string-property property">'id'</span><span class="token operator">:</span>id<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				
				<span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
					tr<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span>
					<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'删除失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>del.php</p> 
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//1、连接数据库</span>
<span class="token keyword">require</span> <span class="token string single-quoted-string">'./inc/conn.php'</span><span class="token punctuation">;</span>
<span class="token comment">//2、拼接SQL语句</span>
<span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"delete from news where id=<span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>"</span><span class="token punctuation">;</span>
<span class="token comment">//3、执行SQL语句</span>
<span class="token keyword">echo</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/91245ea6c60ddb03824ac4605cfb35eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CIFAR-10 数据集简介</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/448f2f2515c7324fe03ce33d95881a8e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">8个免费的高清视频素材下载网站，资源超多，随意下载</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>