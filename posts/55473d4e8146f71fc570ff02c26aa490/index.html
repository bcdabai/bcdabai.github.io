<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>红黑树的插入与验证——附图详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="红黑树的插入与验证——附图详解" />
<meta property="og:description" content="文章目录 红黑树性质 红黑树的插入前言寻找插入位置情况 1.0情况 1.1情况 1.2情况 1.3 情况 2.0情况 2.1情况 2.2情况 2.3 完整代码红黑树的检验验证代码和用例 红黑树 上篇文章我们说到 AVL 树在新增 / 减少结点的时候会进行旋转以保持 AVL 树的高度平衡, 但是实际上在需要 频繁加入 / 删除结点的场景中, AVL 树在旋转上开销会很大, 总体效率也会较为低下。
故而有这样一个数据结构——红黑树, 这里我们不再讨论平衡因子, 而是维护结点中的颜色（只有红或黑）来间接地调整树的「相对平衡」，也就是说红黑树的平衡并没有 AVL 树那样严格，所以相比 AVL 树，红黑树有的旋转次数会显著减少，我们来具体看看：
性质 如果一棵树是红黑树，它必然有如下性质：（这几条性质建议多熟悉一下）
结点只有红，黑两种属性（显而易见对吧，红黑树嘛）根节点为黑色叶子结点视为黑色，这里的叶子结点指的是最底层的空节点不能存在两个连续的红色节点从「任意节点开始到其后代叶子节点」的简单路径上，有「相同数量的黑色节点」 具备了以上几条性质，我们就能保证：红黑树最长路径是最短路径的两倍
因为在「从任意结点开始到叶子结点具有相同数量的黑色结点」和「不能连续存在两个红色结点」的限制，最短路径就是路径上 N 个点全是 黑色的，最长路径就是这 N 个黑色结点和 N 个红色结点交替出现，长度最多是2 N，故而具备了这个特点。
然后对于红黑树的节点，我们定义为：
private static class RBTreeNode { private RBTreeNode parent; private RBTreeNode left; private RBTreeNode right; private COLOR color; // 结点颜色 int val ; } // 在另一个 Java 文件中 public enum COLOR { BLACK, RED } 红黑树的插入 前言 首先对于一个新节点的插入，这个新节点我们需要先默认设置为红色，那为什么不设置成黑色呢？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/55473d4e8146f71fc570ff02c26aa490/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-22T09:32:57+08:00" />
<meta property="article:modified_time" content="2022-11-22T09:32:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">红黑树的插入与验证——附图详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p></p> 
 <div class="toc"> 
  <h4>文章目录</h4> 
  <ul><li><a href="#_2" rel="nofollow">红黑树</a></li><li><ul><li><a href="#_6" rel="nofollow">性质</a></li></ul> 
   </li><li><a href="#_36" rel="nofollow">红黑树的插入</a></li><li><ul><li><a href="#_37" rel="nofollow">前言</a></li><li><a href="#_42" rel="nofollow">寻找插入位置</a></li><li><a href="#_10_103" rel="nofollow">情况 1.0</a></li><li><ul><li><a href="#_11_114" rel="nofollow">情况 1.1</a></li><li><a href="#_12_172" rel="nofollow">情况 1.2</a></li><li><a href="#_13_204" rel="nofollow">情况 1.3</a></li></ul> 
    </li><li><a href="#_20_298" rel="nofollow">情况 2.0</a></li><li><ul><li><a href="#_21_307" rel="nofollow">情况 2.1</a></li><li><a href="#_22_321" rel="nofollow">情况 2.2</a></li><li><a href="#_23_334" rel="nofollow">情况 2.3</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_380" rel="nofollow">完整代码</a></li><li><a href="#_548" rel="nofollow">红黑树的检验</a></li><li><ul><li><a href="#_612" rel="nofollow">验证代码和用例</a></li></ul> 
  </li></ul> 
 </div> 
 <p></p> 
</blockquote> 
<hr> 
<h2><a id="_2"></a>红黑树</h2> 
<p>上篇文章我们说到 AVL 树在新增 / 减少结点的时候会进行旋转以保持 AVL 树的高度平衡, 但是实际上在需要 频繁加入 / 删除结点的场景中, AVL 树在旋转上开销会很大, 总体效率也会较为低下。</p> 
<p>故而有这样一个数据结构——红黑树, 这里我们不再讨论平衡因子, 而是维护结点中的颜色（只有红或黑）来间接地调整树的「相对平衡」，也就是说红黑树的平衡并没有 AVL 树那样严格，所以相比 AVL 树，红黑树有的旋转次数会显著减少，我们来具体看看：</p> 
<h3><a id="_6"></a>性质</h3> 
<p>如果一棵树是红黑树，它必然有如下性质：（这几条性质建议多熟悉一下）</p> 
<ol><li>结点只有红，黑两种属性（显而易见对吧，红黑树嘛）</li><li>根节点为黑色</li><li>叶子结点视为黑色，这里的叶子结点指的是最底层的空节点</li><li>不能存在两个连续的红色节点</li><li>从「任意节点开始到其后代叶子节点」的简单路径上，有「相同数量的黑色节点」</li></ol> 
<p>具备了以上几条性质，我们就能保证：红黑树最长路径是最短路径的两倍</p> 
<blockquote> 
 <p>因为在「从任意结点开始到叶子结点具有相同数量的黑色结点」和「不能连续存在两个红色结点」的限制，最短路径就是路径上 N 个点全是 黑色的，最长路径就是这 N 个黑色结点和 N 个红色结点交替出现，长度最多是2 N，故而具备了这个特点。</p> 
</blockquote> 
<p>然后对于红黑树的节点，我们定义为：</p> 
<pre><code class="prism language-java">	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">RBTreeNode</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> <span class="token class-name">RBTreeNode</span> parent<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">RBTreeNode</span> left<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">RBTreeNode</span> right<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">COLOR</span> color<span class="token punctuation">;</span>     <span class="token comment">// 结点颜色</span>
        <span class="token keyword">int</span> val <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token comment">// 在另一个 Java 文件中</span>
	<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">COLOR</span> <span class="token punctuation">{<!-- --></span>
	    <span class="token constant">BLACK</span><span class="token punctuation">,</span> <span class="token constant">RED</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_36"></a>红黑树的插入</h2> 
<h3><a id="_37"></a>前言</h3> 
<p>首先对于一个新节点的插入，这个新节点我们需要先默认设置为<font color="red">红色</font>，那为什么不设置成<strong>黑色</strong>呢？</p> 
<ul><li>在插入新节点之前，这棵树肯定已经是红黑树了，那么它就满足性质4（任意结点节点到叶子结点路径上黑色节点个数相等），而如果这时候插入一个黑色的节点，那肯定会破坏这个性质。</li><li>而我们设定新节点为红色的，那只是可能会破坏性质3（不存在连续两红），但是我们可以通过修改结点颜色或者树的结构来纠正这棵红黑树</li></ul> 
<h3><a id="_42"></a>寻找插入位置</h3> 
<p><strong>接下来开始我们的红黑树插入阶段：</strong><br> 如果红黑树的根节点为空，那么这个新节点设置为根节点即可，再将这个点的颜色设为黑色（因为新节点默认是红色, 且根节点为黑）</p> 
<p><strong>否则：</strong><br> 我们就要寻找新节点的插入位置了，这和 AVL 树对应的代码是一样的（二分，然后连接新节点），这里直接上代码</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBTreeNode</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RBTreeNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            root <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
            root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span> <span class="token comment">// 根节点颜色为 黑</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 寻找插入位置</span>
        <span class="token class-name">RBTreeNode</span> parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 重复节点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 至此 cur 为空，parent 为 cur 的父节点</span>
        <span class="token comment">// 完成节点的插入</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>val <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            parent<span class="token punctuation">.</span>left <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            parent<span class="token punctuation">.</span>right <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        newNode<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span> <span class="token comment">// 双向连接</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>接着，我们来熟悉一下这几个结点 👇，接下来需要频繁用到</p> 
<p><img src="https://images2.imgbox.com/bc/71/7F4PX90J_o.png" alt="在这里插入图片描述"></p> 
<p>因为插入新元素之前树就是红黑树了，而我们新插入的结点（下文简称为 <code>newNode</code>）都是默认红色的，所以当 newNode 的 parent 是黑色的时候，这时候是不会破坏红黑树的性质的，直接插入即可。</p> 
<p>所以只有当 <code>cur.parent 的颜色为红色的时候</code> ，我们需要从 cur 结点开始往根节点「检查并调整树的颜色或者结构」，于是就有这样的 while 循环</p> 
<pre><code class="prism language-java"><span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span>
</code></pre> 
<p>然后由于接下来的情况需要基于 grandparent 而定，所以我们再随手定义一个 <strong>祖父结点</strong></p> 
<pre><code class="prism language-java"><span class="token class-name">RBTreeNode</span> grandparent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent
</code></pre> 
<p>（需要注意：只有 <code>parent.color = RED</code> 的时候，才会进入循环，而又<font color="red">因为根节点是黑色的，所以 parent 不可能为根节点，因而进入循环后，祖父结点必然存在不为空</font>）</p> 
<h3><a id="_10_103"></a>情况 1.0</h3> 
<p>第一大情况，如下，也就是 parent 是「左树」</p> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">==</span> grandparent<span class="token punctuation">.</span>left<span class="token punctuation">)</span>
</code></pre> 
<p>然后基于这个条件下，还需要定义叔叔结点</p> 
<pre><code class="prism language-java"><span class="token class-name">RBTreeNode</span> uncle <span class="token operator">=</span> grandparent<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
</code></pre> 
<p>然后就有了以下三种情况</p> 
<h4><a id="_11_114"></a>情况 1.1</h4> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">)</span>
</code></pre> 
<p>也就是这种情况：<br> 原树是棵红黑树，现在插入了一个新节点，以至于连续出现两个红结点，而我们如果改变 cur 的颜色也是行不通的，这样的话从 parent 通向叶子节点的黑色结点数就不相等了。</p> 
<p><img src="https://images2.imgbox.com/0c/f3/a9vXnqWw_o.png" alt="在这里插入图片描述"><br> 所以首先我们需要将 parent 和 uncle 改成黑色<br> <code>parent.color = BLACK; uncle.color = BLACK;</code>，这样就满足红黑树的性质了。如下：</p> 
<p><img src="https://images2.imgbox.com/1e/5c/DYx5i3F3_o.png" alt="在这里插入图片描述"></p> 
<p>但是 grandparent 有可能是有父亲结点的，并且父亲结点可能是红，也可能是黑</p> 
<p>首先，如果 grandparent.parent 是黑色，那么各路径的黑色结点数就不相等了，如下图<br> <img src="https://images2.imgbox.com/09/aa/hDl0qnNe_o.png" alt="在这里插入图片描述"><br> 这时候如果<font color="red">我们将 grandparent 改成红色</font>，那可以解决这种情况</p> 
<p><img src="https://images2.imgbox.com/4e/d9/DUxBOznl_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>而 如果 grandparent.parent 是红色的，只将 parent 和 uncle 改成黑色还是会出现「路径黑色个数不等」的情况</p> 
<p><img src="https://images2.imgbox.com/64/38/AcqH1TfJ_o.png" alt="在这里插入图片描述"><br> 将 grandparent 改成红色，也会出现「连续两红」的问题，如下</p> 
<p><img src="https://images2.imgbox.com/1a/81/jsFkvqB4_o.png" alt="在这里插入图片描述"></p> 
<p>因此，正确的做法是：<font color="red">将 parent 和 uncle 改成黑色，grandparent 直接改成红色, 等到插入操作即将结束时再将 root 改为黑色</font></p> 
<p>如下图，我们将 parent 和 uncle 改成黑色，<font color="red">再将 grandparent 改成红色</font>，但是有可能grandparent上面的结点也都还需要调整，我们我们要重新调整 cur 的指向，让 cur = grandparent，于是当轮调整结束，再进入一次 while 循环，但是这次 parent 不为红色了，于是退出 while，调整结束，但是由于刚刚将 grandparent 改成了红色（也就是下图中根节点被我们改成了红色），所以我们在调整过程结束时再让 root 变成黑色。</p> 
<p><img src="https://images2.imgbox.com/6c/45/TQ3YbBg0_o.png" alt="在这里插入图片描述"></p> 
<p>情况 1.1执行完后，<strong>别忘了 有可能上面的结点也需要进行调整</strong>，所以我们也需要更新 cur 和 parent 的位置：</p> 
<pre><code class="prism language-java">cur <span class="token operator">=</span> grandparent<span class="token punctuation">;</span>
parent <span class="token operator">=</span> cur<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
</code></pre> 
<p>综上所述情况 1.1 代码如下</p> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
    uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span> <span class="token comment">// 修改颜色</span>

    cur <span class="token operator">=</span> grandparent<span class="token punctuation">;</span> <span class="token comment">// 调整 cur 引用位置</span>
    parent <span class="token operator">=</span> cur<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
    <span class="token comment">// grandparent 先统一改红，调整结束再做处理</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_12_172"></a>情况 1.2</h4> 
<p>1.1 的情况是 <strong>uncle 存在且为红色</strong>，那么剩下的情况就是 uncle 不存在，或 uncle 为黑色<br> 并且 cur 为 parent 的左孩子（这个条件暂时不用太关注，后面会讲到）</p> 
<pre><code class="prism language-java">进入 <span class="token keyword">else</span> 语句， 也就是<span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">BLACK</span><span class="token punctuation">)</span>
</code></pre> 
<p><font color="red">这种情况下普通的直接插入是无法达成这种状态的，这种状态只会出现在调整的过程中</font>，因为 uncle 为黑色，为了保证黑色结点数量，parent 也得是黑色的结点(因为新插入的 cur 为红色)，而 parent 硬要是红色的话那么这棵树也就不是红黑树了</p> 
<p><img src="https://images2.imgbox.com/04/00/hr8N5hys_o.png" alt="在这里插入图片描述"><br> 我们拿这个图举一个👇需要进行情况 1.2 进行调整的例子，针对下图：现在我们插入了 cur 这个新节点</p> 
<p><img src="https://images2.imgbox.com/8b/7c/4WcTnncR_o.png" alt="在这里插入图片描述">很明显这触发了状态 1.1，我们需要调整 <code>parent.color = BLACK; uncle.color = BLACK; grandparent.color = RED;</code>然后再调整 cur 和 parent 的引用位置，方便继续向上调整： <code>cur = grandparent; parent = cur.parent</code> ，就是下面这种情况</p> 
<p><img src="https://images2.imgbox.com/88/6f/Ct0etJd8_o.png" alt="在这里插入图片描述"></p> 
<p>这就是「调整红黑树过程中出现的情况 1.2」</p> 
<pre><code class="prism language-java">情况 <span class="token number">1.2</span><span class="token operator">:</span> uncle <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">BLACK</span><span class="token punctuation">,</span> 并且 cur <span class="token operator">==</span> parent<span class="token punctuation">.</span>left
</code></pre> 
<blockquote> 
 <p>（这里需要用到右旋，不了解右旋的建议先学一下 AVL 树，可以参考我上一篇博客<a href="https://blog.csdn.net/weixin_63519461/article/details/127887791">AVL的旋转</a>）</p> 
</blockquote> 
<p><font color="red">这种情况下我们就要对 grandparent 进行右旋，然后将 grandparent 变为红色，parent 变为黑色</font>，如下</p> 
<p><img src="https://images2.imgbox.com/a1/e2/7TlyVQ6o_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_13_204"></a>情况 1.3</h4> 
<p>这种情况也是建立在上一情况的 else 语句中的 —— <code>uncle == null || uncle.color = BLACK</code>，这也是出现在调整过程中的</p> 
<p>但是情况 1.3 中，<font color="red"> cur 是 parent 的右孩子</font>，这种情况可以通过左旋转换成情况 1.2，我们来具体看看<br> 例如下图是情况 1.3</p> 
<p><img src="https://images2.imgbox.com/06/a7/1OI226zw_o.png" alt="在这里插入图片描述"><br> 首先需要对 parent 进行左旋 👇：</p> 
<p><img src="https://images2.imgbox.com/b1/00/Akzi20f3_o.png" alt="在这里插入图片描述">好，现在我们将这个左旋后的图和情况 1.2 的图对比一下 👇，除了最下方的孩子结点位置不太一样之外，还有 cur 和 parent 的引用反了，<font color="red">所以这里我们将左图中的 parent 和 cur 交换一下引用就可以变成需要进行情况 1.2 操作的状态</font></p> 
<p><img src="https://images2.imgbox.com/5f/57/ETXhrF21_o.png" alt="在这里插入图片描述"><br> <font color="red">所以对于情况 1.3 我们只需要进行左旋 + 交换 cur 和 parent 引用就可以变成情况 1.2 了 ！</font>，于是再交给 情况 1.2 处理即可</p> 
<p>至此就是情况 1 的全部情况了, 以下是情况 1 的代码</p> 
<pre><code class="prism language-java">    <span class="token comment">// 插入一个新节点</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBTreeNode</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RBTreeNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            root <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
            root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span> <span class="token comment">// 根节点颜色为 黑</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 寻找插入位置</span>
        <span class="token class-name">RBTreeNode</span> parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 重复节点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 至此 cur 为空，parent 为 cur 的父节点</span>
        <span class="token comment">// 完成节点的插入</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>val <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            parent<span class="token punctuation">.</span>left <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            parent<span class="token punctuation">.</span>right <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        newNode<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span> <span class="token comment">// 双向连接</span>
        <span class="token comment">// parent = cur.parent;</span>
        cur <span class="token operator">=</span> newNode<span class="token punctuation">;</span>

        <span class="token comment">// 至此开始「向上调整颜色」</span>
        <span class="token comment">// 新插入的结点是红色的, 如果父亲结点还是红色的, 就需要调整颜色</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 定义祖父结点</span>
            <span class="token class-name">RBTreeNode</span> grandparent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span> <span class="token comment">// 因为根节点必须是黑色, 所以祖父结点不可能为空</span>
            <span class="token comment">// 第一种情况, parent 是 grandparent 的 左孩子</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">==</span> grandparent<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">RBTreeNode</span> uncle <span class="token operator">=</span> grandparent<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
                <span class="token comment">// 情况 1.1: parent 红色, uncle 不为空, 并且红色</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                    uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span> <span class="token comment">// 修改颜色</span>

                    cur <span class="token operator">=</span> grandparent<span class="token punctuation">;</span>
                    parent <span class="token operator">=</span> cur<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 这里有还有两种情况</span>
                    <span class="token comment">// 情况 1.3: cur 是 parent 的右孩子, 并且 uncle 为空, 或者 uncle 为黑色</span>
                    <span class="token comment">// 左旋后交换引用就可以变成情况 1.2</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> parent<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// 这时候需要先左旋</span>
                        <span class="token function">rotateLeft</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">RBTreeNode</span> temp <span class="token operator">=</span> parent<span class="token punctuation">;</span>
                        parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                        cur <span class="token operator">=</span> temp<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// 情况 1.2: cur 是 parent 的左孩子, 并且 uncle 为空, 或者 uncle 为黑色</span>
                    <span class="token comment">// 需要 向右旋转</span>
                    <span class="token function">rotateRight</span><span class="token punctuation">(</span>grandparent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 再修改颜色</span>
                    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            	<span class="token comment">// 情况 2</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span><span class="token comment">// 插入操作结束前再将 root 改为黑色</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_20_298"></a>情况 2.0</h3> 
<p>情况 2.0 和 情况 1.0 是很像的, 基本上改个方向就对了, 我们再简单过一次</p> 
<p>既然进入了 2.0 情况, 那么就是进入了 else 语句了，也就是这种情况</p> 
<pre><code class="prism language-java">parent <span class="token operator">==</span> grandparent<span class="token punctuation">.</span>right
</code></pre> 
<h4><a id="_21_307"></a>情况 2.1</h4> 
<p>和 1.1 一样， 也就是当：</p> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span>
</code></pre> 
<p>对应着这种情况</p> 
<p><img src="https://images2.imgbox.com/8a/7d/8NQzPnLr_o.png" alt="在这里插入图片描述"><br> <font color="red">此时我们需要将 uncle 和 parent 都改成黑色，并且由于 grandparent 可能是有父亲的，而且不知道是黑色还是红色，如果父亲结点是 黑色，那么我们再将 grandparent 改成红色就可以了。但是如果是红色，将 grandparent 改成红色虽然可能没法直接符合黑红树的性质，但是这样能够通过触发其他情况来解决。</font></p> 
<p>所以做法是：将 parent 和 uncle 改成黑色，将 grandparent 改成红色，等到插入即将结束的时候，再将 grandparent 改成黑色（防止根节点是红色）</p> 
<p><img src="https://images2.imgbox.com/8f/a7/3GA5cIyj_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_22_321"></a>情况 2.2</h4> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">BLACK</span><span class="token punctuation">)</span> 
</code></pre> 
<p>该情况状态图和 2.2 也很像，直接给出需要进行情况 2.2 的图 👇<br> 操作步骤是：<font color="red">左旋后修改 grandparent 和 parent 的颜色</font></p> 
<p><img src="https://images2.imgbox.com/7e/e2/W2CHJxcc_o.png" alt="在这里插入图片描述"></p> 
<p>具体操作如下：</p> 
<p><img src="https://images2.imgbox.com/1b/5e/4JLo9eqj_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_23_334"></a>情况 2.3</h4> 
<p>这个情况的触发条件和 2.2 很像，但是 cur 还需要是 parent 的左孩子，这样的话可以通过其他操作再触发 2.2 的状态</p> 
<pre><code class="prism language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> parent<span class="token punctuation">.</span>left<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">BLACK</span><span class="token punctuation">)</span>
</code></pre> 
<p>状态图如下：</p> 
<p><img src="https://images2.imgbox.com/b3/ec/jAMxQGe7_o.png" alt="在这里插入图片描述"></p> 
<p>操作步骤：先对 parent 进行右旋，然后交换 parent 和 cur 引用，就可以变成情况 2.2 了</p> 
<p><img src="https://images2.imgbox.com/ae/a4/f6USn0E8_o.png" alt="在这里插入图片描述"></p> 
<p>再进行 情况 2.2 要进行的操作即可</p> 
<p><img src="https://images2.imgbox.com/ed/73/r3v7bKMT_o.png" alt="在这里插入图片描述"></p> 
<p>至此情况 2.0 也结束了<br> 情况 2.0 的代码：</p> 
<pre><code class="prism language-java"><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// parent = grandparent.right;</span>
    <span class="token class-name">RBTreeNode</span> uncle <span class="token operator">=</span> grandparent<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
        uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
        grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span> <span class="token comment">// 先变为 红色, 方便后续操作, 最后再统一变成 黑色</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> parent<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">rotateRight</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">RBTreeNode</span> temp <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
            cur <span class="token operator">=</span> temp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">rotateLeft</span><span class="token punctuation">(</span>grandparent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>插入过程完整代码如下：</p> 
<h2><a id="_380"></a>完整代码</h2> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RBTree</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">RBTreeNode</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> <span class="token class-name">RBTreeNode</span> parent<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">RBTreeNode</span> left<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">RBTreeNode</span> right<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">COLOR</span> color<span class="token punctuation">;</span>
        <span class="token keyword">int</span> val <span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">RBTreeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token comment">// 新节点默认都为 红色</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">RBTreeNode</span> root <span class="token punctuation">;</span>

    <span class="token comment">// 插入一个新节点</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBTreeNode</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RBTreeNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            root <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
            root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span> <span class="token comment">// 根节点颜色为 黑</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 寻找插入位置</span>
        <span class="token class-name">RBTreeNode</span> parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 重复节点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 至此 cur 为空，parent 为 cur 的父节点</span>
        <span class="token comment">// 完成节点的插入</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>val <span class="token operator">&gt;</span> val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            parent<span class="token punctuation">.</span>left <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            parent<span class="token punctuation">.</span>right <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        newNode<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span> <span class="token comment">// 双向连接</span>
        <span class="token comment">// parent = cur.parent;</span>
        cur <span class="token operator">=</span> newNode<span class="token punctuation">;</span>

        <span class="token comment">// 至此开始「向上调整颜色」</span>
        <span class="token comment">// 新插入的结点是红色的, 如果父亲结点还是红色的, 就需要调整颜色</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 定义祖父结点</span>
            <span class="token class-name">RBTreeNode</span> grandparent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span> <span class="token comment">// 因为根节点必须是黑色, 所以祖父结点不可能为空</span>
            <span class="token comment">// 第一种情况, parent 是 grandparent 的 左孩子</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">==</span> grandparent<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">RBTreeNode</span> uncle <span class="token operator">=</span> grandparent<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
                <span class="token comment">// 情况 1.1: parent 红色, uncle 不为空, 并且红色</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                    uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span> <span class="token comment">// 修改颜色</span>

                    cur <span class="token operator">=</span> grandparent<span class="token punctuation">;</span>
                    parent <span class="token operator">=</span> cur<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 这里有还有两种情况</span>
                    <span class="token comment">// 情况 1.3: cur 是 parent 的右孩子, 并且 uncle 为空, 或者 uncle 为黑色</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> parent<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// 这时候需要先左旋</span>
                        <span class="token function">rotateLeft</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">RBTreeNode</span> temp <span class="token operator">=</span> parent<span class="token punctuation">;</span>
                        parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                        cur <span class="token operator">=</span> temp<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// 情况 1.2: cur 是 parent 的左孩子, 并且 uncle 为空, 或者 uncle 为黑色</span>
                    <span class="token comment">// 需要 向右旋转</span>
                    <span class="token function">rotateRight</span><span class="token punctuation">(</span>grandparent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 再修改颜色</span>
                    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// parent = grandparent.right;</span>
                <span class="token class-name">RBTreeNode</span> uncle <span class="token operator">=</span> grandparent<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                    uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span> <span class="token comment">// 先变为 红色, 方便后续操作, 最后再统一变成 黑色</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur <span class="token operator">==</span> parent<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">rotateRight</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">RBTreeNode</span> temp <span class="token operator">=</span> parent<span class="token punctuation">;</span>
                        parent <span class="token operator">=</span> cur<span class="token punctuation">;</span>
                        cur <span class="token operator">=</span> temp<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token function">rotateLeft</span><span class="token punctuation">(</span>grandparent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span>
                    parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 最后再将根节点统一修改为 黑色</span>
        root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token comment">// 左旋</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">rotateLeft</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBTreeNode</span> rson <span class="token operator">=</span> parent<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> rsonLeft <span class="token operator">=</span> rson<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> grandparent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>

        parent<span class="token punctuation">.</span>right <span class="token operator">=</span> rsonLeft<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rsonLeft <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            rsonLeft<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        parent<span class="token punctuation">.</span>parent <span class="token operator">=</span> rson<span class="token punctuation">;</span>
        rson<span class="token punctuation">.</span>left <span class="token operator">=</span> parent<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            root <span class="token operator">=</span> rson<span class="token punctuation">;</span>
            rson<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>grandparent<span class="token punctuation">.</span>right <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                grandparent<span class="token punctuation">.</span>right <span class="token operator">=</span> rson<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                grandparent<span class="token punctuation">.</span>left <span class="token operator">=</span> rson<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            rson<span class="token punctuation">.</span>parent <span class="token operator">=</span> grandparent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
	<span class="token comment">// 右旋</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">rotateRight</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBTreeNode</span> lson <span class="token operator">=</span> parent<span class="token punctuation">.</span>left<span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> lsonRight <span class="token operator">=</span> lson<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
        <span class="token class-name">RBTreeNode</span> grandparent <span class="token operator">=</span> parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>

        parent<span class="token punctuation">.</span>left <span class="token operator">=</span> lsonRight<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lsonRight <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            lsonRight<span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        lson<span class="token punctuation">.</span>right <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        parent<span class="token punctuation">.</span>parent <span class="token operator">=</span> lson<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            root <span class="token operator">=</span> lson<span class="token punctuation">;</span>
            lson<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>grandparent<span class="token punctuation">.</span>left <span class="token operator">==</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                grandparent<span class="token punctuation">.</span>left <span class="token operator">=</span> lson<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                grandparent<span class="token punctuation">.</span>right <span class="token operator">=</span> lson<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            lson<span class="token punctuation">.</span>parent <span class="token operator">=</span> grandparent<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_548"></a>红黑树的检验</h2> 
<p>要检验一棵树是不是红黑树，我们就判断这棵树是不是符合红黑树的所有性质就好了</p> 
<blockquote> 
 <ol><li>结点只有红，黑两种属性（显而易见对吧，红黑树嘛）</li><li>根节点为黑色</li><li>叶子结点视为黑色，这里的叶子结点指的是最底层的空节点</li><li>不能存在两个连续的红色节点</li><li>从「任意节点开始到其后代叶子节点」简单的路径上，有「相同数量的黑色节点」</li></ol> 
</blockquote> 
<p><strong><font color="blue">根节点为黑色</font></strong><br> 只需要在函数开头特殊判断一下即可<br> <strong><font color="blue">不能存在两个连续的结点</font></strong><br> 通过递归实现即可，如果当前结点为红色，那就判断一下父亲结点是不是红色，如果是，那就返回 false</p> 
<pre><code class="prism language-java">	<span class="token comment">// 判断有没有 两个连续 的红色节点</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong><font color="blue">从「任意节点开始到其后代叶子节点」简单的路径上，有「相同数量的黑色节点」</font></strong><br> 我们依旧可以递归实现这个验证，这个递归的方法体为：<br> <code>public boolean checkBlackNode(RBTreeNode root, int pathBlackNum, int neededBlackNum)</code></p> 
<p>pathBlackNum 是当前路径上黑色结点个数，neededBlackNum 是以某一条路径为准的黑色结点个数，如果某条路径上的 <code>pathBlackNum != neededBlackNum</code> ，那就不是红黑树。</p> 
<p>如何计算 neededBlackNum ? 我们可以以这棵红黑树最左边的那条路径为准，这样的话就有多种计算方法</p> 
<ol><li>我们可以在进入这个函数之前，再把最左边的那条路径上的黑色结点算出来，然后把这个值传参传给 neededBlackNum</li><li>也可以直接将 -1 传给 neededBlackNum，如果某条路径走完了，neededBlackNum 还是 -1，那就说明这个路径是第一次达到的，就将 <code>neededBlackNum = pathBlackNum</code>，而 needBlackNum 不为 -1了，说明已经有一条路径上的黑色结点数被算出来了，以这个值为基准进行比较即可</li></ol> 
<pre><code class="prism language-java">	<span class="token comment">/**
     * 检查黑色的结点符不符合要求
     * @param pathBlackNum 当前路径的 黑色结点数, 刚开始默认是 -1, 第一次到达更结点的时候更新 neededBlackNum
     * @param neededBlackNum 总共需要的黑色结点数量
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> pathBlackNum<span class="token punctuation">,</span> <span class="token keyword">int</span> neededBlackNum<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">BLACK</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pathBlackNum <span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 到达根节点的时候检查一下</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>left <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>neededBlackNum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 第一次走完一条完整路径的时候, 更新一下 neededBlackNum</span>
                neededBlackNum <span class="token operator">=</span> pathBlackNum<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// pathBlackNum 更新完了</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>neededBlackNum <span class="token operator">!=</span> pathBlackNum<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 不相等就不是了</span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
		<span class="token comment">// 左子树和右子树都要满足题意</span>
        <span class="token keyword">return</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span> pathBlackNum<span class="token punctuation">,</span> neededBlackNum<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span> pathBlackNum<span class="token punctuation">,</span> neededBlackNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_612"></a>验证代码和用例</h3> 
<p>这里先提供一个用例</p> 
<pre><code class="prism language-java">		<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">RBTree</span> rbTree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RBTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            rbTree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>除此之外，我们也可以中序遍历一下，看一下是不是有序的。上总代码：</p> 
<pre><code class="prism language-java">	<span class="token comment">// 判断一棵树 是不是 红黑树</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isRBTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>color <span class="token operator">!=</span> <span class="token constant">BLACK</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 根节点必须为 黑色</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		<span class="token comment">// 分别检查红色 和 黑色结点合不合格</span>
        <span class="token keyword">return</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 判断有没有 两个连续 的红色节点</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkRedNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 检查黑色的结点符不符合要求
     * @param pathBlackNum 当前路径的 黑色结点数, 刚开始默认是 -1, 第一次到达更结点的时候更新 neededBlackNum
     * @param neededBlackNum 总共需要的黑色结点数量
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> pathBlackNum<span class="token punctuation">,</span> <span class="token keyword">int</span> neededBlackNum<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">BLACK</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pathBlackNum <span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 到达叶子节点的时候检查一下</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>left <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> root<span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>neededBlackNum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 第一次走完一条完整路径的时候, 更新一下 neededBlackNum</span>
                neededBlackNum <span class="token operator">=</span> pathBlackNum<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 否则已经有某一条路径走完了</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>neededBlackNum <span class="token operator">!=</span> pathBlackNum<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span> pathBlackNum<span class="token punctuation">,</span> neededBlackNum<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">checkBlackNode</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span> pathBlackNum<span class="token punctuation">,</span> neededBlackNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	<span class="token comment">// 中序遍历观察是否是有序的</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">inorder</span><span class="token punctuation">(</span><span class="token class-name">RBTreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">inorder</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">inorder</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>完</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/911ab84a3dcef59982edb4b201a57698/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JAVA代码编译流程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1edbe9b326664ba8ed23c33679053c1d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python算法刷题常用函数备忘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>