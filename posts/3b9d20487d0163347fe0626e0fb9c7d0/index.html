<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>slurm配置安装 本地源制作&#43;SSH&#43;NFS&#43;NTP&#43;NIS - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="slurm配置安装 本地源制作&#43;SSH&#43;NFS&#43;NTP&#43;NIS" />
<meta property="og:description" content="slurm配置安装 基础配置 控制节点 配置静态IP地址 修改文件
vi /etc/sysconfig/network-scripts/ifcfg-ens33 BOOTPROTO=&#34;static&#34; ONBOOT=yes IPADDR=192.168.100.11 #静态地址 NETMASK=255.255.255.0 #子网掩码 GATEWAY=192.168.100.1 #网关地址 DNS1=8.8.8.8 #dns地址 重新打开网卡
systemctl restart network SSH连接不上或者卡顿 修改文件
vi /etc/ssh/sshd_config UsePAM yes #需要打开 PasswordAuthentication yes #需要打开 ChallengeResponseAuthentication yes #需要打开 重新打开sshd服务
systemctl restart sshd 修改主机名 第一种方法： 修改主机名文件
vi /etc/sysconfig/network 添加下面内容
NETWORKING=yes NAME=centos11 #主机名 临时修改主机名，两者结合可以不关机永久修改
hostname centos11 第二种方法 hostnamectl set-hostname centos11 修改主机hosts文件
vi /etc/hosts 添加下面内容
192.168.100.11 centos11 192.168.100.12 centos02 关闭防火墙，禁用selinux systemctl stop firewalld systemctl disable firewalld sed -i &#39;s/=enforcing/=disable/&#39; /etc/selinux/config setenforce 0 getenforce “Permissive” #最后显示 制作本地源 下载地址" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3b9d20487d0163347fe0626e0fb9c7d0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-12T15:34:27+08:00" />
<meta property="article:modified_time" content="2022-08-12T15:34:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">slurm配置安装 本地源制作&#43;SSH&#43;NFS&#43;NTP&#43;NIS</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><a id="slurm_0"></a>slurm配置安装</h2> 
<h4><a id="_2"></a>基础配置</h4> 
<h5><a id="_4"></a>控制节点</h5> 
<h6><a id="IP_6"></a>配置静态IP地址</h6> 
<p>修改文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/sysconfig/network-scripts/ifcfg-ens33
</code></pre> 
<pre><code class="prism language-bash"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span><span class="token string">"static"</span>

<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes 

<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span>.100.11 <span class="token comment">#静态地址</span>

<span class="token assign-left variable">NETMASK</span><span class="token operator">=</span><span class="token number">255.255</span>.255.0 <span class="token comment">#子网掩码</span>

<span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token number">192.168</span>.100.1 <span class="token comment">#网关地址</span>

<span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token number">8.8</span>.8.8 <span class="token comment">#dns地址</span>
</code></pre> 
<p>重新打开网卡</p> 
<pre><code class="prism language-bash">systemctl restart network
</code></pre> 
<h6><a id="SSH_36"></a>SSH连接不上或者卡顿</h6> 
<p>修改文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span>  /etc/ssh/sshd_config
</code></pre> 
<pre><code class="prism language-bash">UsePAM <span class="token function">yes</span> <span class="token comment">#需要打开</span>
PasswordAuthentication <span class="token function">yes</span>  <span class="token comment">#需要打开</span>
ChallengeResponseAuthentication <span class="token function">yes</span> <span class="token comment">#需要打开</span>

</code></pre> 
<p>重新打开sshd服务</p> 
<pre><code class="prism language-bash">systemctl restart sshd
</code></pre> 
<h6><a id="_61"></a>修改主机名</h6> 
<h6><a id="_63"></a>第一种方法：</h6> 
<p>修改主机名文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/sysconfig/network
</code></pre> 
<p>添加下面内容</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">NETWORKING</span><span class="token operator">=</span>yes
<span class="token assign-left variable">NAME</span><span class="token operator">=</span>centos11 <span class="token comment">#主机名</span>
</code></pre> 
<p>临时修改主机名，两者结合可以不关机永久修改</p> 
<pre><code class="prism language-bash"><span class="token function">hostname</span> centos11
</code></pre> 
<h6><a id="_84"></a>第二种方法</h6> 
<pre><code class="prism language-bash">hostnamectl set-hostname centos11
</code></pre> 
<hr> 
<p>修改主机hosts文件</p> 
<pre><code class="prism language-bash"> <span class="token function">vi</span>  /etc/hosts 
</code></pre> 
<p>添加下面内容</p> 
<pre><code class="prism language-bash"><span class="token number">192.168</span>.100.11 centos11

<span class="token number">192.168</span>.100.12 centos02
</code></pre> 
<h6><a id="selinux_110"></a>关闭防火墙，禁用selinux</h6> 
<pre><code class="prism language-bash">systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sed</span> -i <span class="token string">'s/=enforcing/=disable/'</span> /etc/selinux/config
setenforce <span class="token number">0</span>
getenforce
“Permissive” <span class="token comment">#最后显示</span>

</code></pre> 
<h6><a id="_122"></a>制作本地源</h6> 
<p>下载地址</p> 
<pre><code class="prism language-bash">http://mirrors.cqu.edu.cn/CentOS/7.9.2009/isos/x86_64/CentOS-7-x86_64-Everything-2009.iso
</code></pre> 
<p>创建ios存放目录及挂载目录</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> -p /date/centos
<span class="token function">mkdir</span> -p /mnt/centos
</code></pre> 
<p>将iso镜像文件使用xftp上传至/data/centos路径</p> 
<p>将/data/centos下的iso文件挂载到/mnt/centos目录下</p> 
<pre><code class="prism language-bash"><span class="token function">mount</span> -o loop /date/centos/CentOS-7-x86_64-Everything-2009.iso  /mnt/centos/
</code></pre> 
<p>#-o指定选项，loop用来把一个文件当成硬盘分区mount到目录</p> 
<p>把/etc/yum.repos.d/里的除了要编辑的repo文件以外，后缀改掉或者删除</p> 
<p>修改文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/yum.repos.d/CentOS-Media.repo
<span class="token comment">#CentOS-Media 这个是使用光盘挂载后调用的文件</span>
<span class="token comment">#CentOS-Base 这个是联网后基础的源，一般都用这个</span>
<span class="token comment">#CentOS-Vault 这个是最近新版本的加入的老版本的yum源配置</span>
<span class="token comment">#CentOS-Debuginfo debug包尤其和内核相关的更新和软件安装</span>
</code></pre> 
<p>修改下面内容</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Media
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>file:///mnt/centos
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///mnt/centos/RPM-GPG-KEY-CentOS-7

<span class="token comment">#其中RPM-GPG-KEY-CentOS-7可以在/mnt/centos/下找到复制粘贴到这里就可以了。</span>
</code></pre> 
<p>清除yum缓存</p> 
<pre><code class="prism language-bash">yum clean all
yum makecache
</code></pre> 
<p>可以关闭网络后尝试安装httpd</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> httpd
</code></pre> 
<p>查看文件类型</p> 
<pre><code class="prism language-bash">lsblk -f 
</code></pre> 
<p>配置自动挂载</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'/date/centos/CentOS-7-x86_64-Everything-2009.iso  /mnt/centos/ iso9660 loop 0 0'</span> <span class="token operator">&gt;&gt;</span> /etc/fstab
</code></pre> 
<p>配置fstab导致开不了机并且不能修改fstab内容,输入下面内容再进行修改</p> 
<pre><code class="prism language-bash"><span class="token function">mount</span> -o remount,rw /
</code></pre> 
<p>重启后查看挂载信息</p> 
<pre><code class="prism language-bash"><span class="token function">df</span> -h
</code></pre> 
<h5><a id="_210"></a>计算节点</h5> 
<h6><a id="IP_212"></a>配置静态IP地址</h6> 
<p>修改文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/sysconfig/network-scripts/ifcfg-ens33
</code></pre> 
<pre><code class="prism language-bash"><span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span><span class="token string">"static"</span>

<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes 

<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">192.168</span>.100.11 <span class="token comment">#静态地址</span>

<span class="token assign-left variable">NETMASK</span><span class="token operator">=</span><span class="token number">255.255</span>.255.0 <span class="token comment">#子网掩码</span>

<span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token number">192.168</span>.100.1 <span class="token comment">#网关地址</span>

<span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token number">8.8</span>.8.8 <span class="token comment">#dns地址</span>
</code></pre> 
<p>重新打开网卡</p> 
<pre><code class="prism language-bash">systemctl restart network
</code></pre> 
<h6><a id="_240"></a>修改主机名</h6> 
<h6><a id="_242"></a>第一种方法：</h6> 
<p>修改主机名文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/sysconfig/network
</code></pre> 
<p>添加下面内容</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">NETWORKING</span><span class="token operator">=</span>yes
<span class="token assign-left variable">NAME</span><span class="token operator">=</span>centos11 <span class="token comment">#主机名</span>
</code></pre> 
<p>临时修改主机名，两者结合可以不关机永久修改</p> 
<pre><code class="prism language-bash"><span class="token function">hostname</span> centos11
</code></pre> 
<h6><a id="_263"></a>第二种方法</h6> 
<pre><code class="prism language-bash">hostnamectl set-hostname centos11

</code></pre> 
<hr> 
<p>修改主机hosts文件</p> 
<pre><code class="prism language-bash"> <span class="token function">vi</span>  /etc/hosts 
</code></pre> 
<p>添加下面内容</p> 
<pre><code class="prism language-bash"><span class="token number">192.168</span>.100.11 centos11

<span class="token number">192.168</span>.100.12 centos02
</code></pre> 
<h6><a id="selinux_290"></a>关闭防火墙，禁用selinux</h6> 
<pre><code class="prism language-bash">systemctl stop firewalld
systemctl disable firewalld
<span class="token function">sed</span> -i <span class="token string">'s/=enforcing/=disable/'</span> /etc/selinux/config
setenforce <span class="token number">0</span>
getenforce
“Permissive” <span class="token comment">#最后显示</span>
</code></pre> 
<h6><a id="_301"></a>制作本地源</h6> 
<p>下载地址</p> 
<pre><code class="prism language-bash">http://mirrors.cqu.edu.cn/CentOS/7.9.2009/isos/x86_64/CentOS-7-x86_64-Everything-2009.iso
</code></pre> 
<p>创建ios存放目录及挂载目录</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> -p /date/centos
<span class="token function">mkdir</span> -p /mnt/centos
</code></pre> 
<p>在控制节点将iso镜像文件使用scp传至/data/centos路径</p> 
<pre><code class="prism language-bash"><span class="token function">scp</span> /date/centos/CentOS-7-x86_64-Everything-2009.iso <span class="token number">192.168</span>.100.12:/date/centos/
</code></pre> 
<p>将/data/centos下的iso文件挂载到/mnt/centos目录下</p> 
<pre><code class="prism language-bash"><span class="token function">mount</span> -o loop /date/centos/CentOS-7-x86_64-Everything-2009.iso  /mnt/centos/
<span class="token comment">#-o指定选项，loop用来把一个文件当成硬盘分区mount到目录</span>
</code></pre> 
<p>把/etc/yum.repos.d/里的除了要编辑的repo文件以外，后缀改掉或者删除</p> 
<p>修改/etc/yum.repos.d/CentOS-Media.repo文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/yum.repos.d/CentOS-Media.repo
<span class="token comment">#CentOS-Media 这个是使用光盘挂载后调用的文件</span>
CentOS-Base 这个是联网后基础的源，一般都用这个
CentOS-Vault 这个是最近新版本的加入的老版本的yum源配置
CentOS-Debuginfo debug包尤其和内核相关的更新和软件安装
</code></pre> 
<p>修改下面内容</p> 
<pre><code class="prism language-bash"><span class="token assign-left variable">name</span><span class="token operator">=</span>CentOS-<span class="token variable">$releasever</span> - Media
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>file:///mnt/centos
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>file:///mnt/centos/RPM-GPG-KEY-CentOS-7

<span class="token comment">#其中RPM-GPG-KEY-CentOS-7可以在/mnt/centos/下找到复制粘贴到这里就可以了。</span>
</code></pre> 
<p>清除yum缓存</p> 
<pre><code class="prism language-bash">yum clean all
yum makecache
</code></pre> 
<p>可以关闭网络后尝试安装httpd</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> httpd
</code></pre> 
<p>查看文件类型</p> 
<pre><code class="prism language-bash">lsblk -f 
</code></pre> 
<p>配置自动挂载</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'/date/centos/CentOS-7-x86_64-Everything-2009.iso  /mnt/centos/ iso9660 loop 0 0'</span> <span class="token operator">&gt;&gt;</span> /etc/fstab
</code></pre> 
<p>配置fstab导致开不了机并且不能修改fstab内容,输入下面内容再进行修改</p> 
<pre><code class="prism language-bash"><span class="token function">mount</span> -o remount,rw /
</code></pre> 
<p>重启后查看挂载信息</p> 
<pre><code class="prism language-bash"><span class="token function">df</span> -h
</code></pre> 
<h4><a id="SSH_390"></a>SSH免密登录配置</h4> 
<h5><a id="_392"></a>控制节点</h5> 
<p>设置秘钥</p> 
<pre><code class="prism language-bash">ssh-keygen -t rsa
</code></pre> 
<p>进入秘钥位置</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /root/.ssh
</code></pre> 
<p>将秘钥添加到钥匙库</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> id_rsa.pub  <span class="token operator">&gt;&gt;</span> authorized_keys
</code></pre> 
<p>通过scp将秘钥传到计算节点</p> 
<pre><code class="prism language-bash"><span class="token function">scp</span> id_rsa.pub <span class="token number">192.168</span>.100.12:/opt
</code></pre> 
<h5><a id="_418"></a>计算节点</h5> 
<p>设置秘钥</p> 
<pre><code class="prism language-bash">ssh-keygen -t rsa
</code></pre> 
<p>进入秘钥位置</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /root/.ssh
</code></pre> 
<p>将控制节点秘钥添加到计算节点钥匙库</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /opt/id_rsa.pub <span class="token operator">&gt;&gt;</span>authorized_keys
</code></pre> 
<p>将秘钥添加到钥匙库</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> id_rsa.pub  <span class="token operator">&gt;&gt;</span> authorized_keys
</code></pre> 
<p>通过scp将秘钥传到控制节点</p> 
<pre><code class="prism language-bash"><span class="token function">scp</span> id_rsa.pub <span class="token number">192.168</span>.100.11:/opt
</code></pre> 
<p>测试</p> 
<pre><code class="prism language-bash"><span class="token function">ssh</span> centos11
</code></pre> 
<h5><a id="_458"></a>控制节点</h5> 
<p>将计算节点秘钥传到控制节点钥匙库</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /opt/id_rsa.pub <span class="token operator">&gt;&gt;</span> /root/.ssh/authorized_keys
</code></pre> 
<p>测试</p> 
<pre><code class="prism language-bash"><span class="token function">ssh</span> centos12
</code></pre> 
<h4><a id="NTP_472"></a>NTP时间服务安装配置</h4> 
<ul><li>NTP 只考虑 UTC 时间，不考虑时区，不考虑夏令时等。</li><li>NTP使用UDP，端口123</li></ul> 
<h5><a id="_477"></a>控制节点</h5> 
<p>安装NTP服务软件</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> ntp ntpdate -y
</code></pre> 
<p>修改时区为上海</p> 
<pre><code class="prism language-bash">timedatectl set-timezone Asia/Shanghai 
</code></pre> 
<p>修改/etc/ntp.conf配置文件</p> 
<p>在未修改ntp.conf配置文件可用</p> 
<pre><code class="prism language-bash"><span class="token function">sed</span> -i s/^ser/<span class="token comment">#ser/  /etc/ntp.conf</span>
<span class="token function">sed</span> -i <span class="token string">'/#server 0/i fudge 127.127.1.0'</span> /etc/ntp.conf
<span class="token function">sed</span> -i <span class="token string">'/fudge/i server 127.127.1.0'</span> /etc/ntp.conf
</code></pre> 
<p>若已经修改按照下面内容参考</p> 
<p>查看去除“#” 并带行号的/etc/ntp.conf文件</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /etc/ntp.conf <span class="token operator">|</span><span class="token function">grep</span> -vn <span class="token string">"#"</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment"># vim /etc/ntp.conf</span>
注释掉如下行
server <span class="token number">0</span>.centos.pool.ntp.org iburst
server <span class="token number">1</span>.centos.pool.ntp.org iburst
server <span class="token number">2</span>.centos.pool.ntp.org iburst
server <span class="token number">3</span>.centos.pool.ntp.org iburst
添加如下行
restrict <span class="token number">192.168</span>.100.0 mask <span class="token number">255.255</span>.255.0 nomodify notrap
<span class="token function">service</span> <span class="token number">192.168</span>.100.11
server <span class="token number">127.127</span>.1.0 iburst
fudge <span class="token number">127.127</span>.1.0 stratum <span class="token number">10</span>
添加防火墙端口
firewall-cmd --permanent --add-port<span class="token operator">=</span><span class="token number">123</span>/udp


</code></pre> 
<p>启动NTP服务成功后设置NTP服务自启动</p> 
<pre><code class="prism language-bash">systemctl start ntpd <span class="token operator">&amp;&amp;</span> systemctl <span class="token builtin class-name">enable</span> ntpd
</code></pre> 
<p>关闭chronyd服务</p> 
<pre><code class="prism language-bash">systemctl disable chronyd.service
</code></pre> 
<p>从当前系统时间设置硬件时钟</p> 
<pre><code class="prism language-bash">hwclock -w
</code></pre> 
<p>验证配置</p> 
<pre><code class="prism language-bash"> ntpq -p
</code></pre> 
<h5><a id="_551"></a>计算节点</h5> 
<p>安装NTP服务软件</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> ntp ntpdate -y
</code></pre> 
<p>修改时区为上海</p> 
<pre><code class="prism language-bash">timedatectl set-timezone Asia/Shanghai 
</code></pre> 
<p>与centos时间一致</p> 
<pre><code class="prism language-bash">ntpdate centos11
</code></pre> 
<p>从当前系统时间设置硬件时钟</p> 
<pre><code class="prism language-bash">hwclock -w
</code></pre> 
<p>修改/etc/ntp.conf配置文件</p> 
<p>在未修改ntp.conf配置文件可用</p> 
<pre><code class="prism language-bash"><span class="token function">sed</span> -i s/^ser/<span class="token comment">#ser/  /etc/ntp.conf</span>
<span class="token function">sed</span> -i <span class="token string">'/#server 0/iserver centos11'</span> /etc/ntp.conf
</code></pre> 
<p>若已经修改按照下面内容参考</p> 
<pre><code class="prism language-bash">注释掉如下行
server <span class="token number">0</span>.centos.pool.ntp.org iburst
server <span class="token number">1</span>.centos.pool.ntp.org iburst
server <span class="token number">2</span>.centos.pool.ntp.org iburst
server <span class="token number">3</span>.centos.pool.ntp.org iburst
<span class="token comment">#配置上游时间服务器为本地的ntpd Server服务器</span>
server <span class="token number">192.168</span>.100.11
<span class="token comment">#配置允许上游时间服务器主动修改本机的时间</span>
restrict <span class="token number">192.168</span>.100.11 nomodify notrap noquery
</code></pre> 
<p>关闭chronyd服务</p> 
<pre><code class="prism language-bash">systemctl disable chronyd.service
</code></pre> 
<p>启动NTP服务成功后设置NTP服务自启动</p> 
<pre><code class="prism language-bash">systemctl start ntpd <span class="token operator">&amp;&amp;</span> systemctl <span class="token builtin class-name">enable</span> ntpd
</code></pre> 
<p>验证</p> 
<pre><code class="prism language-bash">ntpq -p
</code></pre> 
<h4><a id="NFSNIS_618"></a>NFS共享储存服务和NIS账号共享服务配置</h4> 
<h5><a id="_620"></a>控制节点</h5> 
<p>安装软件</p> 
<pre><code class="prism language-bash">yum -y <span class="token function">install</span> authconfig<span class="token punctuation">\</span>* sssd<span class="token punctuation">\</span>* krb5<span class="token punctuation">\</span>* autofs ypbind nfs-utils ypserv rpcbind yp-tools
</code></pre> 
<p>设置 NIS 域名</p> 
<pre><code class="prism language-bash">nisdomainname centos11
<span class="token builtin class-name">echo</span> <span class="token string">"nisdomainname centos11"</span> <span class="token operator">&gt;&gt;</span> /etc/rc.d/rc.local
<span class="token function">chmod</span> +x /etc/rc.local
<span class="token builtin class-name">echo</span> <span class="token string">"NISDOMAIN=centos11"</span> <span class="token operator">&gt;&gt;</span> /etc/sysconfig/network
</code></pre> 
<p>修改ypserv.conf配置文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/ypserv.conf
</code></pre> 
<p>添加下面内容</p> 
<pre><code class="prism language-bash">dns:no
<span class="token number">127.0</span>.0.1/255.255.255.0      :* :* :none
<span class="token number">192.168</span>.100.0/255.255.255.0  :* :* :none
*                            :* :* :deny
</code></pre> 
<p>开启 ypserv、ypxfrd、yppasswdd、rpcbind服务</p> 
<pre><code class="prism language-bash">systemctl start ypserv
systemctl start ypxfrd
systemctl start yppasswdd
systemctl start rpcbind
systemctl <span class="token builtin class-name">enable</span> ypserv
systemctl <span class="token builtin class-name">enable</span> ypxfrd
systemctl <span class="token builtin class-name">enable</span> yppasswdd
systemctl <span class="token builtin class-name">enable</span> rpcbind
</code></pre> 
<p>初始化数据库</p> 
<pre><code class="prism language-bash">/usr/lib64/yp/ypinit -m
</code></pre> 
<p>#按Ctrl + D，再按y确认</p> 
<p>更新数据库(每次更新账户信息后都需要更新数据库)</p> 
<pre><code class="prism language-bash"> <span class="token function">make</span> -C /var/yp
</code></pre> 
<p>创建nis用户目录</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> -p /home/nisusers
<span class="token function">chmod</span> <span class="token number">775</span> -R /home/nisusers
</code></pre> 
<p>修改exports文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> /etc/exports
</code></pre> 
<p>添加下面内容把home共享出来</p> 
<pre><code class="prism language-bash">/home <span class="token number">192.168</span>.100.0/24<span class="token punctuation">(</span>rw,sync<span class="token punctuation">)</span>
</code></pre> 
<p>启动服务并验证</p> 
<pre><code class="prism language-bash">systemctl start nfs.service
systemctl <span class="token builtin class-name">enable</span> nfs.service
exportfs -rv
</code></pre> 
<p>创建两个测试用户</p> 
<pre><code class="prism language-bash"><span class="token function">useradd</span> -u <span class="token number">1001</span> -m -d /home/nisusers/user1 user1
<span class="token function">passwd</span> user1
<span class="token function">useradd</span> -u <span class="token number">1002</span> -m -d /home/nisusers/user2 user2
<span class="token function">passwd</span> user2
<span class="token function">make</span> -C /var/yp
</code></pre> 
<h5><a id="_718"></a>计算节点</h5> 
<p>安装软件</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> -y ypserv rpcbind yp-tools
</code></pre> 
<p>设置 NIS 域名</p> 
<pre><code class="prism language-bash">nisdomainname centos11
<span class="token builtin class-name">echo</span> <span class="token string">"nisdomainname centos11"</span> <span class="token operator">&gt;&gt;</span> /etc/rc.d/rc.local
<span class="token function">chmod</span> +x /etc/rc.local
<span class="token builtin class-name">echo</span> <span class="token string">"NISDOMAIN=centos11"</span> <span class="token operator">&gt;&gt;</span> /etc/sysconfig/network
</code></pre> 
<p>用图形化界面配置NIS</p> 
<pre><code class="prism language-bash">authconfig-tui
</code></pre> 
<p><img src="https://images2.imgbox.com/5d/8d/mhl9g38F_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f9/d0/lDK1Llzd_o.png" alt="在这里插入图片描述"></p> 
<p>开启服务</p> 
<pre><code class="prism language-bash">systemctl start rpcbind
systemctl start ypbind
systemctl <span class="token builtin class-name">enable</span> ypbind
</code></pre> 
<p>安装软件</p> 
<pre><code class="prism language-bash">yum -y <span class="token function">install</span> authconfig<span class="token punctuation">\</span>* sssd<span class="token punctuation">\</span>* krb5<span class="token punctuation">\</span>* autofs ypbind nfs-utils ypserv rpcbind yp-tools
</code></pre> 
<p>创建每个节点准备挂载NFS的目录</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> -p /home/nisusers
<span class="token function">chmod</span> <span class="token number">775</span> -R /home/nisusers
</code></pre> 
<p>编辑autofs配置文件</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"/home /etc/auto.nis"</span> <span class="token operator">&gt;</span>/etc/auto.master
</code></pre> 
<p>编辑auto配置文件</p> 
<pre><code class="prism language-bash"><span class="token function">cp</span> /etc/auto.misc /etc/auto.nis
<span class="token function">vi</span>  /etc/auto.nis
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment">#user1	192.168.100.11:/home/nisusers/user1</span>
*		<span class="token number">192.168</span>.100.11:/home/<span class="token operator">&amp;</span>
</code></pre> 
<p>重启autofs服务</p> 
<pre><code class="prism language-bash">systemctl restart autofs
</code></pre> 
<p>测试</p> 
<p>输入yptest测试，如果能看到master上的用户则表明client的nis设置成功</p> 
<pre><code class="prism language-bash">yptest
<span class="token function">su</span> -l user1
<span class="token builtin class-name">exit</span>
<span class="token function">su</span> -l user2
<span class="token builtin class-name">exit</span>
</code></pre> 
<pre><code class="prism language-bash">ypwhich -x
</code></pre> 
<pre><code class="prism language-bash">显示下面内容
Use <span class="token string">"ethers"</span>    <span class="token keyword">for</span> map <span class="token string">"ethers.byname"</span>
Use <span class="token string">"aliases"</span>   <span class="token keyword">for</span> map <span class="token string">"mail.aliases"</span>
Use <span class="token string">"services"</span>  <span class="token keyword">for</span> map <span class="token string">"services.byname"</span>
Use <span class="token string">"protocols"</span> <span class="token keyword">for</span> map <span class="token string">"protocols.bynumber"</span>
Use <span class="token string">"s"</span>     <span class="token keyword">for</span> map <span class="token string">"s.byname"</span>
Use <span class="token string">"networks"</span>  <span class="token keyword">for</span> map <span class="token string">"networks.byaddr"</span>
Use <span class="token string">"group"</span>     <span class="token keyword">for</span> map <span class="token string">"group.byname"</span>
Use <span class="token string">"passwd"</span>    <span class="token keyword">for</span> map <span class="token string">"passwd.byname"</span>
</code></pre> 
<pre><code class="prism language-bash">ypwhich
</code></pre> 
<p>显示结果为主服务名字</p> 
<h4><a id="MUNGE_825"></a>MUNGE安装配置</h4> 
<h5><a id="_827"></a>控制节点</h5> 
<p>创建munge和Slurm全局用户</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">MUNGEUSER</span><span class="token operator">=</span><span class="token number">1190</span>
<span class="token function">groupadd</span> -g <span class="token variable">$MUNGEUSER</span> munge
<span class="token function">useradd</span> -m -c <span class="token string">"MUNGE Uid 'N' Gid Emporium"</span> -d /var/lib/munge -u <span class="token variable">$MUNGEUSER</span> -g munge -s /sbin/nologin munge
<span class="token builtin class-name">export</span> <span class="token assign-left variable">SlurmUSER</span><span class="token operator">=</span><span class="token number">1191</span>
<span class="token function">groupadd</span> -g <span class="token variable">$SlurmUSER</span> slurm
<span class="token function">useradd</span> -m -c <span class="token string">"Slurm workload manager"</span> -d /var/lib/slurm -u <span class="token variable">$SlurmUSER</span> -g slurm -s /bin/bash slurm
<span class="token function">make</span> -C /var/yp
</code></pre> 
<h6><a id="MUNGE_843"></a>安装MUNGE</h6> 
<p>所用到的munge安装包：munge-0.5.11-3.el7.x86_64.rpm munge-libs-0.5.11-3.el7.x86_64.rpm munge-devel-0.5.11-3.el7.x86_64.rpm 可到阿里开源镜像站找到</p> 
<pre><code class="prism language-bash">https://developer.aliyun.com/packageSearch <span class="token assign-left variable">spm</span><span class="token operator">=</span>a2c6h.12908639.J_1365437.1.1f326886cnPWff
</code></pre> 
<p>安装munge的rpm</p> 
<pre><code class="prism language-bash"><span class="token function">rpm</span> -ivh munge-*
</code></pre> 
<p>rngd使用方法：如果你的硬件支持/dev/hwrng硬件真随机数，那么直接运行就可以自动默认设置为后台daemon程序，会增加系统的熵值，在很多例如加密的应用中非常有用。</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> rng-tools -y
</code></pre> 
<p>为系统新增熵池</p> 
<pre><code class="prism language-bash">rngd -r /dev/urandom
</code></pre> 
<h5><a id="_869"></a>计算节点</h5> 
<h6><a id="MUNGE_871"></a>安装MUNGE</h6> 
<p>所用到的munge安装包：munge-0.5.11-3.el7.x86_64.rpm munge-libs-0.5.11-3.el7.x86_64.rpm munge-devel-0.5.11-3.el7.x86_64.rpm 可到阿里开源镜像站找到</p> 
<pre><code class="prism language-bash">https://developer.aliyun.com/packageSearch <span class="token assign-left variable">spm</span><span class="token operator">=</span>a2c6h.12908639.J_1365437.1.1f326886cnPWff
</code></pre> 
<p>安装munge的rpm</p> 
<pre><code class="prism language-bash"><span class="token function">rpm</span> -ivh munge-*
</code></pre> 
<p>rngd使用方法：如果你的硬件支持/dev/hwrng硬件真随机数，那么直接运行就可以自动默认设置为后台daemon程序，会增加系统的熵值，在很多例如加密的应用中非常有用。</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> rng-tools -y
</code></pre> 
<p>为系统新增熵池</p> 
<pre><code class="prism language-bash">rngd -r /dev/urandom
</code></pre> 
<h5><a id="_897"></a>控制节点</h5> 
<h6><a id="MUNGE_899"></a>配置MUNGE</h6> 
<p>创建全局密钥 在控制节点进行设置，创建一个在每个结点全局使用的密钥</p> 
<pre><code class="prism language-bash">/usr/sbin/create-munge-key -r
</code></pre> 
<p>执行完以后，在/etc/munge/下面会生成munge.key，需修改munge.key的权限以及所属用户，把所属用户改成munge。</p> 
<p>在Master Node创建全局使用的密钥</p> 
<pre><code class="prism language-bash"><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/urandom <span class="token assign-left variable">bs</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">1024</span> <span class="token operator">&gt;</span> /etc/munge/munge.key
</code></pre> 
<p>munge文件权限赋予munge用户</p> 
<pre><code class="prism language-bash"><span class="token function">chown</span>  munge: /etc/munge/munge.key
</code></pre> 
<p>赋予munge文件权限</p> 
<pre><code class="prism language-bash"><span class="token function">chmod</span> <span class="token number">400</span> /etc/munge/munge.key
</code></pre> 
<p>通过scp把munge秘钥传给节点</p> 
<pre><code class="prism language-bash"><span class="token function">scp</span> /etc/munge/munge.key centos12:/etc/munge/
</code></pre> 
<p>munge文件权限赋予munge用户，赋予munge文件权限，开启munge服务</p> 
<pre><code class="prism language-bash"><span class="token function">chown</span> -R munge: /etc/munge/ /var/log/munge/
<span class="token function">chmod</span> 0700 /etc/munge/ /var/log/munge/
systemctl <span class="token builtin class-name">enable</span> munge
systemctl start munge
</code></pre> 
<h5><a id="_942"></a>计算节点</h5> 
<p>munge文件权限赋予munge用户，赋予munge文件权限，开启munge服务</p> 
<pre><code class="prism language-bash"><span class="token function">chown</span> -R munge: /etc/munge/ /var/log/munge/
<span class="token function">chmod</span> 0700 /etc/munge/ /var/log/munge/
systemctl <span class="token builtin class-name">enable</span> munge
systemctl start munge
</code></pre> 
<p>测试</p> 
<pre><code class="prism language-bash">munge -n
munge -n <span class="token operator">|</span>unmunge
munge -n <span class="token operator">|</span><span class="token function">ssh</span> centos11 unmunge
</code></pre> 
<h4><a id="slurm_961"></a>slurm安装配置</h4> 
<h5><a id="_963"></a>控制节点</h5> 
<p>安装所需软件包</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> openssl openssl-devel pam-devel numactl numactl-devel hwloc hwlocdevel lua lua-devel readline-devel rrdtool-devel ncurses-devel man2html libibmad libibumad rpm-build cpanm* -y
</code></pre> 
<p>下载 perl-Switch-2.16-7.el7.noarch.rpm 可在阿里找到</p> 
<p>安装软件</p> 
<pre><code class="prism language-bash"><span class="token function">rpm</span> -ivh perl-Switch-2.16-7.el7.noarch.rpm
</code></pre> 
<h5><a id="_979"></a>计算节点</h5> 
<p>安装所需软件包</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> openssl openssl-devel pam-devel numactl numactl-devel hwloc hwlocdevel lua lua-devel readline-devel rrdtool-devel ncurses-devel man2html libibmad libibumad rpm-build cpanm* -y
</code></pre> 
<p>下载 perl-Switch-2.16-7.el7.noarch.rpm 可在阿里找到</p> 
<p>安装软件</p> 
<pre><code class="prism language-bash"><span class="token function">rpm</span> -ivh perl-Switch-2.16-7.el7.noarch.rpm
</code></pre> 
<h5><a id="_995"></a>控制节点</h5> 
<p>安装所需要的软件包</p> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> openssl openssl-devel pam-devel numactl numactl-devel hwloc hwlocdevel lua lua-devel readline-devel rrdtool-devel ncurses-devel man2html libibmad libibumad rpm-build cpanm* python3 gcc <span class="token function">bzip2</span> gcc-c++ -y python3 readline-devel pam-devel json-c json-c-devel http-parser http-parser-devel perl-Switch rpm-build rpmdevtools bzip2-devel openssl-devel zlib-devel readline-devel pam-devel perl-DBI perl-ExtUtils-MakeMaker mariadb*
</code></pre> 
<p>安装slurm，安装包均在阿里云或者这个网址https://download.schedmd.com/slurm/slurm-22.05.2.tar.bz2</p> 
<pre><code>rpmbuild -ta slurm-21.08.8-2.tar.bz2
cd /root/rpmbuild/RPMS/x86_64/
yum --nogpgcheck localinstall slurm-*
</code></pre> 
<h5><a id="_1011"></a>计算节点</h5> 
<p>安装slurm</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> /opt/slurm
<span class="token function">scp</span> centos11:/root/rpmbuild/RPMS/x86_64/slurm-* /opt/slurm/
<span class="token builtin class-name">cd</span> /opt/slurm
yum --nogpgcheck localinstall slurm-*
</code></pre> 
<h5><a id="_1022"></a>控制节点</h5> 
<p>配置slurm</p> 
<p>使用命令得到各节点配置</p> 
<pre><code class="prism language-bash">slurmd -C								
</code></pre> 
<p>配置文件可以通过拷贝默认的模版文件来获得：slurm.conf.example</p> 
<pre><code class="prism language-bash"><span class="token function">cp</span> /etc/slurm/slurm.conf.example /etc/slurm/slurm.conf
</code></pre> 
<p>修改slurm.conf配置文件</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> slurm.conf
</code></pre> 
<pre><code class="prism language-bash"><span class="token assign-left variable">ClusterName</span><span class="token operator">=</span>slurm-cluster
    <span class="token comment">#集群名称；默认为”linux”；可保持默认，按需配置；</span>
<span class="token assign-left variable">ControlMachine</span><span class="token operator">=</span>slurm-master
    <span class="token comment">#主控端主机名；默认”linux0″；根据Master端的实际主机名配置；</span>
<span class="token assign-left variable">ControlAddr</span><span class="token operator">=</span><span class="token number">192.168</span>.80.250
    <span class="token comment">#主控端IP地址；默认注释状态；当集群环境有DNS服务时可保持默认即可，如没有DNS服务时则需要根据Master端的实际IP地址配置；建议不管有无DNS服务都配置</span>
 <span class="token assign-left variable">SlurmUser</span><span class="token operator">=</span>slurm
    <span class="token comment">#Slurm Service服务运行专用账户；默认”slurm”；保持默认即可；表示该服务并不是以root用户或其它用户来运行管理的，而是专用账户slurm来运行管理的；</span>
<span class="token assign-left variable">SlurmctldPort</span><span class="token operator">=</span><span class="token number">6817</span>
    <span class="token comment">#主控端服务(slurmctld.service)默认端口号；保持默认即可；</span>
<span class="token assign-left variable">SlurmdPort</span><span class="token operator">=</span><span class="token number">6818</span>
    <span class="token comment">#节点端服务(slurmd.service)默认端口号；保持默认即可；</span>
<span class="token assign-left variable">AuthType</span><span class="token operator">=</span>auth/munge
    <span class="token comment">#主控端与节点端之间认证授权通信方式；默认”munge”，保持默认即可；</span>
<span class="token assign-left variable">StateSaveLocation</span><span class="token operator">=</span>/var/spool/slurm/ctld
    <span class="token comment">#主控端状态文件存放的目录路径，保持默认即可；</span>
<span class="token assign-left variable">SlurmdSpoolDir</span><span class="token operator">=</span>/var/spool/slurm/d
    <span class="token comment">#节点端状态文件存放的目录路径，保持默认即可；</span>
<span class="token assign-left variable">SlurmctldPidFile</span><span class="token operator">=</span>/var/run/slurmctld.pid
    <span class="token comment">#主控端PID文件存放的目录路径，保持默认即可；</span>
<span class="token assign-left variable">SlurmdPidFile</span><span class="token operator">=</span>/var/run/slurmd.pid
    <span class="token comment">#节点端PID文件存放的目录路径，保持默认即可</span>
<span class="token assign-left variable">ReturnToService</span><span class="token operator">=</span><span class="token number">2</span>
    <span class="token comment">#避免节点端意外重启处于Down状态，默认”0″；建议”2″，重启后自动恢复成idle状态；</span>
<span class="token assign-left variable">SlurmctldLogFile</span><span class="token operator">=</span>/var/log/slurmctld.log
    <span class="token comment">#主控端日志文件存放的目录路径，保持默认即可；</span>
<span class="token assign-left variable">SlurmdLogFile</span><span class="token operator">=</span>/var/log/slurmd.log
    <span class="token comment">#节点端日志文件存放的目录路径，保持默认即可；</span>
<span class="token assign-left variable">NodeName</span><span class="token operator">=</span>linux<span class="token punctuation">[</span><span class="token number">1</span>-32<span class="token punctuation">]</span> <span class="token assign-left variable">Procs</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">State</span><span class="token operator">=</span>UNKNOWN
    <span class="token comment">#节点端的资源配置；默认值；详情见下面的节点端资源配置说明</span>

节点端资源配置说明：表示计算节点在进行计算任务时可以使用到节点的最大资源
<span class="token assign-left variable">NodeName</span><span class="token operator">=</span>NodeHostName    <span class="token comment">#配置节点主机名；编号格式：独立的”NodeName1″、连续的(含不连续的)”NodeName[2-3,4,6,7-10]”；连续的节点用”-“来表示，不连续的节点用”,”表示；</span>
<span class="token assign-left variable">NodeAddr</span><span class="token operator">=</span>x.x.x.x    <span class="token comment">#配置对应节点的IPv4地址；当集群环境有DNS服务时此项可不配置；</span>
<span class="token assign-left variable">CPUs</span><span class="token operator">=</span>N    <span class="token comment">#N为数字；表示CPU逻辑核数(总核数)；</span>
<span class="token assign-left variable">Sockets</span><span class="token operator">=</span>N    <span class="token comment">#N为数字；表示CPU实际物理插槽数</span>
<span class="token assign-left variable">CoresPerSocket</span><span class="token operator">=</span>N    <span class="token comment">#N为数字；表示每个CPU插槽核数(每颗物理CPU核数)</span>
<span class="token assign-left variable">ThreadsPerCore</span><span class="token operator">=</span>N    <span class="token comment">#N为数字；表示每个CPU核心线程数；不配置默认为单线程；</span>
<span class="token assign-left variable">Procs</span><span class="token operator">=</span>N    <span class="token comment">#N为数字；表示实际分配CPU核数</span>
<span class="token assign-left variable">RealMemory</span><span class="token operator">=</span>N    <span class="token comment">#N为数字，表示分配内存容量(默认单位MB)</span>
<span class="token assign-left variable">State</span><span class="token operator">=</span>UNKNOWN    <span class="token comment">#表示节点端状态；默认”UNKNOWN”表示不知；保持默认即可；</span>
<span class="token assign-left variable">PartitionName</span><span class="token operator">=</span>debug <span class="token assign-left variable">Nodes</span><span class="token operator">=</span>ALL <span class="token assign-left variable">Default</span><span class="token operator">=</span>YES <span class="token assign-left variable">MaxTime</span><span class="token operator">=</span>INFINITE <span class="token assign-left variable">State</span><span class="token operator">=</span>UP
    <span class="token comment">#计算节点分区队列的属性配置；默认值；详情见下面的节点端资源配置说明</span>

计算节点分区队列配置说明：表示进行计算任务时可以指定不同的计算节点的分区队列进行不同的计算
<span class="token assign-left variable">PartitionName</span><span class="token operator">=</span>debug    <span class="token comment">#计算分区队列；默认”debug”；可按需自定义；</span>
<span class="token assign-left variable">Nodes</span><span class="token operator">=</span>ALL    <span class="token comment">#表示分区队列内包含的计算节点数量；默认”ALL”；可按需自定义，节点编号格式：独立的”NodeName1″、连续的(含不连续的)”NodeName[2-3,4,6,7-10]”；连续的节点用”-“来表示，不连续的节点用”,”表示；</span>
<span class="token assign-left variable">Default</span><span class="token operator">=</span>YES    <span class="token comment">#是否为计算队列分区，默认”YES”，反之则”NO”；表示Slurm在提交任务时不指定分区队列时默认使用的计算分区队列；多分区队列模式下只能一个分区配置YES模式；</span>
<span class="token assign-left variable">MaxTime</span><span class="token operator">=</span>INFINITE    <span class="token comment">#计算任务的最大时间限制(默认单位为分钟)，默认”INFINITE”无限；保持默认即可；</span>
<span class="token assign-left variable">State</span><span class="token operator">=</span>UP    <span class="token comment">#分区队列状态，默认”UP”有效；保持默认即可</span>
</code></pre> 
<pre><code class="prism language-bash"><span class="token number">5</span>:ClusterName<span class="token operator">=</span>cluster
<span class="token number">6</span>:ControlMachine<span class="token operator">=</span>centos01
<span class="token number">7</span>:ControlAddr<span class="token operator">=</span><span class="token number">192.168</span>.8.101
<span class="token number">28</span>:MpiDefault<span class="token operator">=</span>none
<span class="token number">33</span>:ProctrackType<span class="token operator">=</span>proctrack/cgroup
<span class="token number">41</span>:ReturnToService<span class="token operator">=</span><span class="token number">2</span>
<span class="token number">42</span>:SlurmctldPidFile<span class="token operator">=</span>/var/run/slurmctld.pid
<span class="token number">43</span>:SlurmctldPort<span class="token operator">=</span><span class="token number">6817</span>
<span class="token number">44</span>:SlurmdPidFile<span class="token operator">=</span>/var/run/slurmd.pid
<span class="token number">45</span>:SlurmdPort<span class="token operator">=</span><span class="token number">6818</span>
<span class="token number">46</span>:SlurmdSpoolDir<span class="token operator">=</span>/var/spool/slurmd
<span class="token number">47</span>:SlurmUser<span class="token operator">=</span>slurm
<span class="token number">51</span>:StateSaveLocation<span class="token operator">=</span>/var/spool/slurmctld
<span class="token number">52</span>:SwitchType<span class="token operator">=</span>switch/none
<span class="token number">54</span>:TaskPlugin<span class="token operator">=</span>task/affinity
<span class="token number">71</span>:InactiveLimit<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">72</span>:KillWait<span class="token operator">=</span><span class="token number">30</span>
<span class="token number">75</span>:MinJobAge<span class="token operator">=</span><span class="token number">300</span>
<span class="token number">77</span>:SlurmctldTimeout<span class="token operator">=</span><span class="token number">120</span>
<span class="token number">78</span>:SlurmdTimeout<span class="token operator">=</span><span class="token number">300</span>
<span class="token number">81</span>:Waittime<span class="token operator">=</span><span class="token number">0</span>
<span class="token number">88</span>:SchedulerType<span class="token operator">=</span>sched/backfill
<span class="token number">89</span>:SelectType<span class="token operator">=</span>select/cons_tres
<span class="token number">90</span>:SelectTypeParameters<span class="token operator">=</span>CR_Core
<span class="token number">113</span>:AccountingStorageType<span class="token operator">=</span>accounting_storage/none
<span class="token number">120</span>:JobCompType<span class="token operator">=</span>jobcomp/none
<span class="token number">123</span>:JobAcctGatherFrequency<span class="token operator">=</span><span class="token number">30</span>
<span class="token number">124</span>:JobAcctGatherType<span class="token operator">=</span>jobacct_gather/none
<span class="token number">125</span>:SlurmctldDebug<span class="token operator">=</span>info
<span class="token number">126</span>:SlurmctldLogFile<span class="token operator">=</span>/var/log/slurmctld.log
<span class="token number">127</span>:SlurmdDebug<span class="token operator">=</span>info
<span class="token number">128</span>:SlurmdLogFile<span class="token operator">=</span>/var/log/slurmd.log
<span class="token number">147</span>:NodeName<span class="token operator">=</span>centos02 <span class="token assign-left variable">CPUs</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">Boards</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">SocketsPerBoard</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">CoresPerSocket</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ThreadsPerCore</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">RealMemory</span><span class="token operator">=</span><span class="token number">972</span> <span class="token assign-left variable">State</span><span class="token operator">=</span>UNKNOWN
<span class="token number">148</span>:PartitionName<span class="token operator">=</span>debug <span class="token assign-left variable">Nodes</span><span class="token operator">=</span>centos02 <span class="token assign-left variable">Default</span><span class="token operator">=</span>YES <span class="token assign-left variable">MaxTime</span><span class="token operator">=</span>INFINITE <span class="token assign-left variable">State</span><span class="token operator">=</span>UP

</code></pre> 
<p>通过scp传到节点</p> 
<pre><code class="prism language-bash"><span class="token function">scp</span> -p /etc/slurm/slurm.conf centos12:/etc/slurm/
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> -p /var/spool/slurmctld
<span class="token function">chown</span> slurm: /var/spool/slurmctld
<span class="token function">chmod</span> <span class="token number">755</span> /var/spool/slurmctld
<span class="token function">touch</span> /var/log/slurmctld.log
<span class="token function">chown</span> slurm: /var/log/slurmctld.log
<span class="token function">touch</span> /var/log/slurm_jobacct.log /var/log/slurm_jobcomp.log
<span class="token function">chown</span> slurm: /var/log/slurm_jobacct.log /var/log/slurm_jobcomp.log 
</code></pre> 
<h5><a id="_1155"></a>计算节点</h5> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> /var/spool/slurmd
<span class="token function">chown</span> slurm: /var/spool/slurmd
<span class="token function">chmod</span> <span class="token number">755</span> /var/spool/slurmd
<span class="token function">touch</span> /var/log/slurmd.log
<span class="token function">chown</span> slurm: /var/log/slurmd.log
</code></pre> 
<p>开启服务</p> 
<pre><code>systemctl enable slurmd.service
systemctl start slurmd.service
systemctl status slurmd.service
</code></pre> 
<h5><a id="_1175"></a>控制节点</h5> 
<pre><code class="prism language-bash">systemctl <span class="token builtin class-name">enable</span> slurmctld.service
systemctl start slurmdctld.service
systemctl status slurmctld.service
systemctl <span class="token builtin class-name">enable</span> slurmd.service
systemctl start slurmd.service
systemctl status slurmd.service
</code></pre> 
<p>测试</p> 
<pre><code class="prism language-bash">scontrol show <span class="token function">node</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5e206eda1b50f81b644d7d55b0c7205e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pthread和信号量的简单例子</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c9cf58faed8e0939f445dbfb3b6ac048/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">citus 和 greenplum 实施对比</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>