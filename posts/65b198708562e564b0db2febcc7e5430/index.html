<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>QT积累 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="QT积累" />
<meta property="og:description" content="用户对应用程序经常有这样的要求：要求它能记住它的settings，比如窗口大小，位置，一些别的设置，还有一个经常用的，就是recent files，等等这些都可以通过Qsettings来实现。
我们知道，这些settings一般都是存在系统里的，比如windows一般都写在系统注册表或者写INI文件，mac系统一般都在XML文件里，那么按照一般的标准来说，许多应用程序是用INI文件来实现的。而Qsettings就是提供了一种方便的方法来存储和恢复应用程序的settings。
QSettings的API是基于Qvariant，Qvariant是一种数据类型的集合，它包含了大部分通常的Qt数据类型，比如QString，QRec，QImage，等等。
当我们创建一个Qsettings的对象时，我们需要传递给它两个参数，第一个是你公司或者组织的名称，第二个事你的应用程序的名称。比如：
Settings = Qsettings(“MySoft”,”QtPad”)
公司名称：MySoft，程序名称：QtPad
假如我们在应用程序中多次要用到Qsettings，为了简单其间，我们可以在主程序中先如下声明。
QtCore.QCoreApplication.setOrganizationName(&#34;MySoft&#34;)
QtCore.QCoreApplication.setOrganizationDomain(&#34;mysoft.com&#34;)
QtCore.QCoreApplication.setApplicationName(&#34;QtPad&#34;)
当然前提是已经from PyQt4 import QtCore
然后在应用程序的任何地方想要声明一个Qsettings类型的变量，便不需要书写两个参数了，直接用settings = Qsettings即可。
那么如何用它来保持应用程序的settings信息呢？我们以字典数据类型与之类比，它也有key，以及对应的value。比如下面例子：
settings = Qsettings(“MySoft”,”QtPad”)
Mainwindow = QmainWindow()
settings.setValue(“pos”,QVariant(Mainwindow.pos())
settings.setValue(“size”,QVariant(Mainwindow.size())
上面两句就是把当前窗口的位置，和大小两个信息记录到了settings中，其中的key就是”pos”和”size”两个Qstring类型，而它所对应的值就是QVariant类型的。当然如果我们要写的key已在settings中存在的话，则会覆盖原来的值，写入新值。
如何读取Qsettings里的内容呢？如下：
Pos = settngs.value(“pos”).toPoint()
Size = settings.value(“size”).toSize()
当然如果key所对应的value是int型的，也可toInt(),如果没有我们要找的key，则会返回一个null QVariant如果用toInt的话会得到0。
那么实际应用中我们一般会如下：
pos= settings.value(&#34;pos&#34;, QVariant(QPoint(200, 200))).toPoint()
size= settings.value(&#34;size&#34;, QVariant(QSize(400, 400))).toSize()
self.resize(size)
self.move(pos)
意思是，如果settings里有以前存下的(用setValue设置的)pos和size的值，则读取，如果没有，不会返回null，而会使用我们给它的起始值——default value——即应用程序第一次运行时的情况。
注意：因为QVariant是不会提供所有数据类型的转化的，比如有toInt(),toPoint(),toSize(),但是却没有对Qcolor，Qimage和Qpixmap等数据类型的转化，此时我们可以用QVariant.value（），具体参看QVariant模块说明。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/65b198708562e564b0db2febcc7e5430/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-05-05T10:19:47+08:00" />
<meta property="article:modified_time" content="2014-05-05T10:19:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">QT积累</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 用户对应用程序经常有这样的要求：要求它能记住它的settings，比如窗口大小，位置，一些别的设置，还有一个经常用的，就是recent files，等等这些都可以通过Qsettings来实现。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">    我们知道，这些settings一般都是存在系统里的，比如windows一般都写在系统注册表或者写INI文件，mac系统一般都在XML文件里，那么按照一般的标准来说，许多应用程序是用INI文件来实现的。而Qsettings就是提供了一种方便的方法来存储和恢复应用程序的settings。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">    QSettings的API是基于Qvariant，Qvariant是一种数据类型的集合，它包含了大部分通常的Qt数据类型，比如QString，QRec，QImage，等等。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">    当我们创建一个Qsettings的对象时，我们需要传递给它两个参数，第一个是你公司或者组织的名称，第二个事你的应用程序的名称。比如：</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">     Settings = Qsettings(“MySoft”,”QtPad”)</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">    公司名称：MySoft，程序名称：QtPad</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">    假如我们在应用程序中多次要用到Qsettings，为了简单其间，我们可以在主程序中先如下声明。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">    QtCore.QCoreApplication.setOrganizationName("MySoft")</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> QtCore.QCoreApplication.setOrganizationDomain("mysoft.com")</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> QtCore.QCoreApplication.setApplicationName("QtPad")</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 当然前提是已经from PyQt4 import QtCore</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 然后在应用程序的任何地方想要声明一个Qsettings类型的变量，便不需要书写两个参数了，直接用settings = Qsettings即可。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 那么如何用它来保持应用程序的settings信息呢？我们以字典数据类型与之类比，它也有key，以及对应的value。比如下面例子：</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> settings = Qsettings(“MySoft”,”QtPad”)</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> Mainwindow = QmainWindow()<br>     settings.setValue(“pos”,QVariant(Mainwindow.pos())</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> settings.setValue(“size”,QVariant(Mainwindow.size())</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 上面两句就是把当前窗口的位置，和大小两个信息记录到了settings中，其中的key就是”pos”和”size”两个Qstring类型，而它所对应的值就是QVariant类型的。当然如果我们要写的key已在settings中存在的话，则会覆盖原来的值，写入新值。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 如何读取Qsettings里的内容呢？如下：</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> Pos = settngs.value(“pos”).toPoint()</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> Size = settings.value(“size”).toSize()</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 当然如果key所对应的value是int型的，也可toInt(),如果没有我们要找的key，则会返回一个null QVariant如果用toInt的话会得到0。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 那么实际应用中我们一般会如下：</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> pos= settings.value("pos", QVariant(QPoint(200, 200))).toPoint()</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> size= settings.value("size", QVariant(QSize(400, 400))).toSize()</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> self.resize(size)</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> self.move(pos)</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 意思是，如果settings里有以前存下的(用setValue设置的)pos和size的值，则读取，如果没有，不会返回null，而会使用我们给它的起始值——default value——即应用程序第一次运行时的情况。</p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px">  </p> 
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(69,69,69); font-family:tahoma,helvetica,arial; font-size:14px; line-height:21px"> 注意：因为QVariant是不会提供所有数据类型的转化的，比如有toInt(),toPoint(),toSize(),但是却没有对Qcolor，Qimage和Qpixmap等数据类型的转化，此时我们可以用QVariant.value（），具体参看QVariant模块说明。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1e0671b297672da3462b8f943356910a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Mariadb源码编译过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/04157a9afae230c2b84c3857b19897f9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vs使用(引用)第三方库的四种方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>