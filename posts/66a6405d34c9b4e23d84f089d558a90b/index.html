<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel中实现模糊查询-LOOKUP&#43;FIND函数 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Excel中实现模糊查询-LOOKUP&#43;FIND函数" />
<meta property="og:description" content="Excel中实现模糊查询-LOOKUP&#43;FIND函数 LOOKUP函数函数简介函数使用方法 FIND函数函数简介函数语法 示例 LOOKUP函数 函数简介 LOOKUP函数是Excel中的一种运算函数，实质是返回向量或数组中的数值，要求数值必须按升序排序。
------粘百度百科
函数使用方法 （1）向量形式：公式为
=LOOKUP(lookup_value,lookup_vector,result_vector)
式中 lookup_value—函数LOOKUP在第一个向量中所要查找的数值，它可以为数字、文本、逻辑值或包含数值的名称或引用；
lookup_vector—只包含一行或一列的区域，其可以是文本、数字或逻辑值；
result_vector—只包含一行或一列的区域，其大小必须与 lookup_vector 相同。
（2）数组形式：公式为
= LOOKUP(lookup_value,array)
式中 array—包含文本、数字或逻辑值的单元格区域或数组它的值用于与 lookup_value 进行比较。
例如：LOOKUP(5.2,{4.2,5,7,9,10})=5。
注意：
array和lookup_vector的数据必须按升序排列，否则函数LOOKUP不能返回正确的结果。文本不区分大小写。
如果函数LOOKUP找不到lookup_value，则查找array和 lookup_vector中小于lookup_value的最大数值。如果lookup_value小于array和 lookup_vector中的最小值，函数LOOKUP返回错误值#N/A。另外还要注意：函数LOOKUP在查找字符方面是不支持通配符的，但可以使用FIND函数的形式来代替。 ------粘百度百科
FIND函数 函数简介 Find函数用来对原始数据中某个字符串进行定位，以确定其位置。Find函数进行定位时，总是从指定位置开始，返回找到的第一个匹配字符串的位置，而不管其后是否还有相匹配的字符串。
------粘百度百科
函数语法 该函数的语法规则如下：
=FIND(find_text,within_text,start_num)
Find_text 是要查找的字符串。
Within_text 是包含要查找关键字的单元格。就是说要在这个单元格内查找关键字。
Start_num 指定开始进行查找的字符数。比如Start_num为1，则从单元格内第一个字符开始查找关键字。如果忽略 start_num，则假设其为 1。
注意：
使用find函数可从文本字符串中查找特定的文本，并返回查找文本的起始位置。查找时，要区分大小写。全角和半角字符。查找结果的字符位置不分全角和半角，作为一个字符来计算。可以单独使用find函数，例如。按照查找字符的起始位置分开文本字符串，或替换部分文本字符串等，也多用于处理其他信息。计数单位如果不是字符而是字节时，请使用findb函数。find函数和findb函数具有相同的功能，但它们的计数单位不同。 [2]
使用 start_num 可跳过指定数目的字符。例如，假定使用文本字符串“AYF0093.YoungMensApparel”，如果要查找文本字符串中说明部分的第一个“Y”的编号，则可将 start_num 设置为 8，这样就不会查找文本的序列号部分。FIND 将从第 8 个字符开始查找，而在下一个字符处即可找到 find_text，于是返回编号 9。FIND 总是从 within_text 的起始处返回字符编号，如果 start_num 大于 1，也会对跳过的字符进行计数。 [3]
如果 find_text 是空文本 ()，则 FIND 则会返回数值1。Find_text 中不能包含通配符。如果within_text 中没有 find_text，则 FIND返回错误值 #VALUE!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/66a6405d34c9b4e23d84f089d558a90b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-05T14:34:56+08:00" />
<meta property="article:modified_time" content="2022-10-05T14:34:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Excel中实现模糊查询-LOOKUP&#43;FIND函数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Excel中实现模糊查询-LOOKUP+FIND函数</h4> 
 <ul><li><a href="#LOOKUP_2" rel="nofollow">LOOKUP函数</a></li><li><ul><li><a href="#_5" rel="nofollow">函数简介</a></li><li><a href="#_11" rel="nofollow">函数使用方法</a></li></ul> 
  </li><li><a href="#FIND_37" rel="nofollow">FIND函数</a></li><li><ul><li><a href="#_40" rel="nofollow">函数简介</a></li><li><a href="#_46" rel="nofollow">函数语法</a></li></ul> 
  </li><li><a href="#_69" rel="nofollow">示例</a></li></ul> 
</div> 
<p></p> 
<h2><a id="LOOKUP_2"></a>LOOKUP函数</h2> 
<h3><a id="_5"></a>函数简介</h3> 
<p>  LOOKUP函数是Excel中的一种运算函数，实质是返回向量或数组中的数值，要求数值必须按升序排序。</p> 
<p>------粘百度百科</p> 
<h3><a id="_11"></a>函数使用方法</h3> 
<p>（1）向量形式：公式为</p> 
<blockquote> 
 <p><strong>=LOOKUP(lookup_value,lookup_vector,result_vector)</strong></p> 
</blockquote> 
<p>式中 <strong>lookup_value</strong>—函数LOOKUP在第一个向量中所要查找的数值，它可以为数字、文本、逻辑值或包含数值的名称或引用；<br> <strong>lookup_vector</strong>—只包含一行或一列的区域，其可以是文本、数字或逻辑值；<br> <strong>result_vector</strong>—只包含一行或一列的区域，其大小必须与 lookup_vector 相同。<br> （2）数组形式：公式为</p> 
<blockquote> 
 <p><strong>= LOOKUP(lookup_value,array)</strong></p> 
</blockquote> 
<p>式中 <strong>array</strong>—包含文本、数字或逻辑值的单元格区域或数组它的值用于与 lookup_value 进行比较。<br> 例如：LOOKUP(5.2,{4.2,5,7,9,10})=5。<br>  <br> <strong>注意：</strong><br>   array和lookup_vector的数据必须按<strong>升序</strong>排列，否则函数LOOKUP不能返回正确的结果。文本不区分大小写。</p> 
<ul><li>如果函数LOOKUP找不到lookup_value，则查找array和 lookup_vector中小于lookup_value的最大数值。</li><li>如果lookup_value小于array和 lookup_vector中的最小值，函数LOOKUP返回错误值#N/A。</li><li>另外还要注意：函数LOOKUP在查找字符方面是不支持通配符的，但可以使用FIND函数的形式来代替。</li></ul> 
<p>------粘百度百科</p> 
<p> </p> 
<h2><a id="FIND_37"></a>FIND函数</h2> 
<h3><a id="_40"></a>函数简介</h3> 
<p>  Find函数用来对原始数据中某个字符串进行定位，以确定其位置。Find函数进行定位时，总是从指定位置开始，返回找到的第一个匹配字符串的位置，而不管其后是否还有相匹配的字符串。</p> 
<p>------粘百度百科</p> 
<h3><a id="_46"></a>函数语法</h3> 
<p>该函数的语法规则如下：</p> 
<blockquote> 
 <p><strong>=FIND(find_text,within_text,start_num)</strong></p> 
</blockquote> 
<p><strong>Find_text</strong> 是要查找的字符串。<br> <strong>Within_text</strong> 是包含要查找关键字的单元格。就是说要在这个单元格内查找关键字。<br> <strong>Start_num</strong> 指定开始进行查找的字符数。比如Start_num为1，则从单元格内第一个字符开始查找关键字。如果忽略 start_num，则假设其为 1。<br>  <br> <strong>注意：</strong><br>   使用find函数可从文本字符串中查找特定的文本，并返回查找文本的起始位置。查找时，要区分大小写。全角和半角字符。查找结果的字符位置不分全角和半角，作为一个字符来计算。可以单独使用find函数，例如。按照查找字符的起始位置分开文本字符串，或替换部分文本字符串等，也多用于处理其他信息。计数单位如果不是字符而是字节时，请使用findb函数。find函数和findb函数具有相同的功能，但它们的计数单位不同。 [2]<br>   使用 start_num 可跳过指定数目的字符。例如，假定使用文本字符串“AYF0093.YoungMensApparel”，如果要查找文本字符串中说明部分的第一个“Y”的编号，则可将 start_num 设置为 8，这样就不会查找文本的序列号部分。FIND 将从第 8 个字符开始查找，而在下一个字符处即可找到 find_text，于是返回编号 9。FIND 总是从 within_text 的起始处返回字符编号，如果 start_num 大于 1，也会对跳过的字符进行计数。 [3]</p> 
<ul><li>如果 find_text 是空文本 ()，则 FIND 则会返回数值1。</li><li>Find_text 中不能包含通配符。</li><li>如果within_text 中没有 find_text，则 FIND返回错误值 #VALUE!。</li><li>如果 start_num 不大于 0，则FIND返回错误值 #VALUE!。</li><li>如果 start_num 大于 within_text 的长度，则 FIND 返回错误值#VALUE!。</li></ul> 
<p>------粘百度百科</p> 
<h2><a id="_69"></a>示例</h2> 
<p>表格字段信息展示如下：</p> 
<table><thead><tr><th>姓名</th><th>手机型号</th><th>精准匹配</th><th>模糊匹配</th></tr></thead><tbody><tr><td>张1</td><td>三星Galaxy S21 Ultra</td><td>#N/A</td><td></td></tr><tr><td>张2</td><td>华为 MATE 9</td><td>华为 MATE 9</td><td></td></tr><tr><td>张3</td><td>华为 MATE Xs</td><td>#N/A</td><td></td></tr><tr><td>张4</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td><td></td></tr><tr><td>张5</td><td>三星Note8</td><td>#N/A</td><td></td></tr><tr><td>张6</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td><td></td></tr><tr><td>张7</td><td>iPhone 13 PRO Max</td><td>#N/A</td><td></td></tr><tr><td>张8</td><td>华为 P40</td><td>华为 P40</td><td></td></tr><tr><td>张9</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td><td></td></tr><tr><td>张10</td><td>iPhone 7 Plus</td><td>#N/A</td><td></td></tr><tr><td>张11</td><td>华为 NOVA 2 Plus</td><td>华为 NOVA 2 Plus</td><td></td></tr><tr><td>张12</td><td>华为 NOVA 2s</td><td>华为 NOVA 2s</td><td></td></tr><tr><td>张13</td><td>华为 NOVA 4e</td><td>华为 NOVA 4e</td><td></td></tr><tr><td>张14</td><td>华为 P10 Plus</td><td>华为 P10 Plus</td><td></td></tr></tbody></table> 
<p>  其中精准匹配的语句在上篇文章有详细讲解，这里用的数据也是上篇文章表格信息。</p> 
<p>  现在要查看sheet1子表中B列手机型号与sheet3子表中A列手机型号模糊匹配结果：</p> 
<ul><li>匹配的话，在sheet1子表中C列返回模糊匹配上的手机型号；</li><li>不匹配的话，在sheet1子表中C列返回#N/A。</li></ul> 
<p>  这便使用到了LOOKUP函数和FIND函数，在D2单元格中写==LOOKUP(1,0/FIND(Sheet3!A$1:A$15,B2),Sheet3!A$1:A$15)并按下回车键，对应文本便自动匹配，匹配后信息展示如下所示：</p> 
<blockquote> 
 <p><strong>=LOOKUP(1,0/FIND(Sheet3!A$1:A$15,B2),Sheet3!A$1:A$15)</strong><br> //其中<strong>Sheet3!A$1:A$15</strong>是对应要匹配查找的字符串，该字符串要<strong>升序排序</strong><br> //其中<strong>B2</strong>是当前sheet1子表中要查找关键字的单元格</p> 
</blockquote> 
<table><thead><tr><th>姓名</th><th>手机型号</th><th>精准匹配</th><th>模糊匹配</th></tr></thead><tbody><tr><td>张1</td><td>三星Galaxy S21 Ultra</td><td>#N/A</td><td>#N/A</td></tr><tr><td>张2</td><td>华为 MATE 9</td><td>华为 MATE 9</td><td>华为 MATE 9</td></tr><tr><td>张3</td><td>华为 MATE Xs</td><td>#N/A</td><td>#N/A</td></tr><tr><td>张4</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td></tr><tr><td>张5</td><td>三星Note8</td><td>#N/A</td><td>#N/A</td></tr><tr><td>张6</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td></tr><tr><td>张7</td><td>iPhone 13 PRO Max</td><td>#N/A</td><td>#N/A</td></tr><tr><td>张8</td><td>华为 P40</td><td>华为 P40</td><td>华为 P40</td></tr><tr><td>张9</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td><td>华为 MATE 30 PRO</td></tr><tr><td>张10</td><td>iPhone 7 Plus</td><td>#N/A</td><td>#N/A</td></tr><tr><td><strong>张11</strong></td><td><strong>华为 NOVA 2 Plus</strong></td><td><strong>华为 NOVA 2 Plus</strong></td><td><strong>华为 NOVA 2</strong></td></tr><tr><td><strong>张12</strong></td><td><strong>华为 NOVA 2s</strong></td><td><strong>华为 NOVA 2s</strong></td><td><strong>华为 NOVA 2</strong></td></tr><tr><td><strong>张13</strong></td><td><strong>华为 NOVA 4e</strong></td><td><strong>华为 NOVA 4e</strong></td><td><strong>华为 NOVA 4</strong></td></tr><tr><td><strong>张14</strong></td><td><strong>华为 P10 Plus</strong></td><td><strong>华为 P10 Plus</strong></td><td><strong>华为 P10</strong></td></tr></tbody></table> 
<blockquote> 
 <p>  由“精准匹配”和“模糊匹配”两列对比可以看出，模糊查询对比是返回大于自身值的上一个单元格中的字符串。<br> <strong>模糊查询举例：</strong><br>   sheet3子表中部分展示顺序如下图所示：<br> <img src="https://images2.imgbox.com/8d/6c/xD1yV2XN_o.png" alt="在这里插入图片描述"><br>   当前姓名为“张11”对应的手机型号为“华为 NOVA 2 Plus”。<br> 1、“华为 NOVA 2 Plus”先与“华为 NOVA 2”比对，“华为 NOVA 2 Plus”比“华为 NOVA 2”大，继续往下顺序对比；<br> 2、“华为 NOVA 2 Plus”和“华为 NOVA 2 PLUS”对比，“华为 NOVA 2 Plus”比“华为 NOVA 2 PLUS”小；<br> 3、所以返回的是比自身值“华为 NOVA 2 Plus”大的“华为 NOVA 2 PLUS”上一个单元格中的字符串“华为 NOVA 2”。</p> 
</blockquote> 
<p>sheet1和sheet3子表具体如下图所示：<br> <img src="https://images2.imgbox.com/d1/81/ixwBxCES_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fc/76/XhB6AFTi_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d241cdbd8c7df08caabbca7c6a07697e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Pycharm启动失败的可能原因之一</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b5cdc5d2a1313ac1e30a12d7957888f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python使用小教程01——[h264 @ 0x55abeda05080] error while decoding MB 0 14, bytestream 104435</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>