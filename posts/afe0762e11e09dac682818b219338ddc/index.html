<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AP与mAP的详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AP与mAP的详解" />
<meta property="og:description" content="AP和mAP是图像分类任务中的评价方法。
mAP的计算方法：
1、首先使用训练好的模型获得所有测试样本的confideutnce score，每个类别（如person、car等）都会获得一组confidence score，假设现在共有20个测试样本，如下给出这20个样本的id、confidence score、真实标签ground truth label。
2、按照上图中的score值从大到小对所有样本进行排序，排序后结果如下图所示：
3、计算precision和recall值
在计算之前首先举个例子通俗地解释一下什么是precision和recall。
precision（精确率）：你预测出的结果有多少是正确的。
recall（召回率）：正确的结果有多少被你给出来了。
假设一个不透明的盒子里有8个红球和3个蓝球，现在让你取出了所有红球，你取出来了5个球，但里面有3个红球，2个蓝球。
precision=3/5 指你取出来的5个球里面只有3个是正确的。
recall=3/8 指8个红球只有3个被你取出来了。
用（True Positive&#43;False Positive）来表示分类任务中我们取出来的结果，如在测试集上取出Top-5的结果为
其中id为4和2的样本图片为True Positive，id为13、19、6的样本为False Positive。剩余排在Top-5之外的元素时我们没有取出来的。如下：
这个例子中precision=2/5，recall=2/6。
实际的任务中通常不会满足只用Top-5来衡量模型的好坏。
4、计算AP
设总数为N的样本中总共有M个正样本，则从Top-1至Top-N可以有M个recall值，分别为（1/M,2/M,...,M/M），对于每个recall值r，可以从对应的（r&#39;&gt;=r）中计算出一个最大的precision，对这M个precision求平均得到AP，如下图所示：
在上图所示中，共有6个正例，因此共有6个recall值，分别为1/6、2/6、3/6、4/6、5/6、6/6，
当recall=1/6时，r&#39;为1/6、2/6、3/6、4/6、5/6、6/6，最大的precision=1；
当recall=2/6时，r&#39;为2/6、3/6、4/6、5/6、6/6，最大的precision=2/2=1；
当recall=3/6时，r&#39;为3/6、4/6、5/6、6/6，最大的precision=4/7；
当recall=4/6时，r&#39;为4/6、5/6、6/6，最大的precision=4/7；
当recall=5/6时，r&#39;为5/6、6/6，最大的precision=5/11；
当recall=6/6时，r&#39;为6/6，最大的precision=6/16。
。
此时AP表示训练出来的模型在当前类别上的好坏。
5、计算mAP
按照第4步的方法对每个类别都计算出AP，求均值得到mAP。
参考文献：
https://blog.csdn.net/zdh2010xyz/article/details/54293298" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/afe0762e11e09dac682818b219338ddc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-05T18:34:42+08:00" />
<meta property="article:modified_time" content="2019-03-05T18:34:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AP与mAP的详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>AP和mAP是图像分类任务中的评价方法。</p> 
<p><strong>mAP的计算方法：</strong></p> 
<p style="text-indent:0;">1、首先使用训练好的模型获得所有测试样本的confideutnce score，每个类别（如person、car等）都会获得一组confidence score，假设现在共有20个测试样本，如下给出这20个样本的id、confidence score、真实标签ground truth label。</p> 
<p style="text-indent:50px;"><img alt="" class="has" src="https://images2.imgbox.com/a4/99/V88WIZ07_o.png"></p> 
<p style="text-indent:0;">2、按照上图中的score值从大到小对所有样本进行排序，排序后结果如下图所示：</p> 
<p style="text-indent:50px;"><img alt="" class="has" src="https://images2.imgbox.com/9f/f4/PuwUk5Gz_o.jpg"></p> 
<p style="text-indent:0;">3、计算precision和recall值</p> 
<p style="text-indent:50px;">在计算之前首先举个例子通俗地解释一下什么是precision和recall。</p> 
<p style="text-indent:50px;">precision（精确率）：你预测出的结果有多少是正确的。</p> 
<p style="text-indent:50px;">recall（召回率）：正确的结果有多少被你给出来了。</p> 
<blockquote> 
 <p style="text-indent:50px;">假设一个不透明的盒子里有8个红球和3个蓝球，现在让你取出了所有红球，你取出来了5个球，但里面有3个红球，2个蓝球。</p> 
 <p style="text-indent:50px;"><span style="color:#f33b45;">precision=3/5 指你取出来的5个球里面只有3个是正确的</span>。</p> 
 <p style="text-indent:50px;"><span style="color:#f33b45;">recall=3/8 指8个红球只有3个被你取出来了。</span></p> 
</blockquote> 
<p style="text-indent:50px;"> <img alt="" class="has" height="133" src="https://images2.imgbox.com/3b/ef/ZDKmviOZ_o.png" width="632"></p> 
<p style="text-indent:50px;">用（True Positive+False Positive）来表示分类任务中我们取出来的结果，如在测试集上取出Top-5的结果为</p> 
<p style="text-indent:50px;"><img alt="" class="has" src="https://images2.imgbox.com/ad/71/eQH4dovT_o.png"></p> 
<p style="text-indent:50px;">其中id为4和2的样本图片为True Positive，id为13、19、6的样本为False Positive。剩余排在Top-5之外的元素时我们没有取出来的。如下：</p> 
<p style="text-indent:50px;"><img alt="" class="has" src="https://images2.imgbox.com/8f/df/E2fg8UXX_o.png"></p> 
<p style="text-indent:50px;">这个例子中precision=2/5，recall=2/6。</p> 
<p style="text-indent:50px;">实际的任务中通常不会满足只用Top-5来衡量模型的好坏。</p> 
<p style="text-indent:0;">4、计算AP</p> 
<p style="text-indent:50px;">设总数为N的样本中总共有M个正样本，则从Top-1至Top-N可以有M个recall值，分别为（1/M,2/M,...,M/M），对于每个recall值r，可以从对应的（r'&gt;=r）中计算出一个最大的precision，对这M个precision求平均得到AP，如下图所示：</p> 
<p style="text-indent:50px;"><img alt="" class="has" src="https://images2.imgbox.com/bc/d3/3MYpu0C0_o.jpg"></p> 
<p style="text-indent:50px;">在上图所示中，共有6个正例，因此共有6个recall值，分别为1/6、2/6、3/6、4/6、5/6、6/6，</p> 
<p style="text-indent:50px;">当recall=1/6时，r'为1/6、2/6、3/6、4/6、5/6、6/6，最大的precision=1；</p> 
<p style="text-indent:50px;">当recall=2/6时，r'为2/6、3/6、4/6、5/6、6/6，最大的precision=2/2=1；</p> 
<p style="text-indent:50px;">当recall=3/6时，r'为3/6、4/6、5/6、6/6，最大的precision=4/7；</p> 
<p style="text-indent:50px;">当recall=4/6时，r'为4/6、5/6、6/6，最大的precision=4/7；</p> 
<p style="text-indent:50px;">当recall=5/6时，r'为5/6、6/6，最大的precision=5/11；</p> 
<p style="text-indent:50px;">当recall=6/6时，r'为6/6，最大的precision=6/16。</p> 
<p style="text-indent:50px;"><img alt="AP=\frac{1+1+4/7+4/7+5/11+6/16}{6}=0.6621" class="mathcode" src="https://images2.imgbox.com/b8/50/zPcdXZsX_o.gif">。</p> 
<p style="text-indent:50px;">此时AP表示训练出来的模型在当前类别上的好坏。</p> 
<p style="text-indent:0;">5、计算mAP</p> 
<p style="text-indent:50px;">按照第4步的方法对每个类别都计算出AP，求均值得到mAP。</p> 
<p style="text-indent:50px;"> </p> 
<p style="text-indent:0;">参考文献：</p> 
<p style="text-indent:0;"><a href="https://blog.csdn.net/zdh2010xyz/article/details/54293298">https://blog.csdn.net/zdh2010xyz/article/details/54293298</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a86cf1569a4569d9a9f625a6087c0bae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring Boot之使用指定的JDK版本</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/301d7668c1142e479e7def733b6f7a97/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Ubuntu下解决apt update时签名无效问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>