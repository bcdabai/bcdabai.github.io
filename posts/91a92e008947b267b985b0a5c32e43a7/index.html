<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GDB图形数据库/Tinkerpop gremlin使用总结 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="GDB图形数据库/Tinkerpop gremlin使用总结" />
<meta property="og:description" content="什么是gdb? 图数据库（Graph Database，简称GDB）是一种支持Property Graph图模型、用于处理高度连接数据查询与存储的实时、可靠的在线数据库服务。它支持Apache TinkerPop Gremlin查询语言，可以帮您快速构建基于高度连接的数据集的应用程序。GDB非常适合社交网络、欺诈检测、推荐引擎、实时图谱、网络/IT运营这类高度互连数据集的场景。例如，在一个典型的社交网络中，常常会存在“谁认识谁，上过什么学校，常住什么地方，喜欢什么餐馆之类的查询”，传统关系型数据库对于超过3度的查询十分低效难以胜任，但图数据库可轻松应对社交网络的各种复杂存储和查询场景。
gdb 基本用法 1.添加点
g.addV(&#39;gdb_sample_person&#39;).property(id, &#39;gdb_sample_marko&#39;).property(&#39;age&#39;, 28).property(&#39;name&#39;, &#39;marko&#39;) g.addV(&#39;gdb_sample_person&#39;).property(id, &#39;gdb_sample_vadas&#39;).property(&#39;age&#39;, 27).property(&#39;name&#39;, &#39;vadas&#39;) g.addV(&#39;gdb_sample_person&#39;).property(id, &#39;gdb_sample_josh&#39;).property(&#39;age&#39;, 32).property(&#39;name&#39;, &#39;josh&#39;) g.addV(&#39;gdb_sample_person&#39;).property(id, &#39;gdb_sample_peter&#39;).property(&#39;age&#39;, 35).property(&#39;name&#39;, &#39;peter&#39;) g.addV(&#39;gdb_sample_software&#39;).property(id, &#39;gdb_sample_lop&#39;).property(&#39;lang&#39;, &#39;java&#39;).property(&#39;name&#39;, &#39;lop&#39;) g.addV(&#39;gdb_sample_software&#39;).property(id, &#39;gdb_sample_ripple&#39;).property(&#39;lang&#39;, &#39;java&#39;).property(&#39;name&#39;, &#39;ripple&#39;) 说明： 操作点 用 g.addV() 操作边 用 g.addE() 后边用点来跟相加的property 属性值。 有点像lambda表达式。 g.V().drop() 这个操作是删除点
g.addV(&#34;Metric&#34;).property(T.id, &#34;metric-111&#34;) g.addV(&#34;Metric&#34;).property(T.id, &#34;metric-222&#34;) g.addV(&#34;Metric&#34;).property(T.id, &#34;metric-333&#34;) g.addV(&#34;Source&#34;).property(T.id, &#34;source-111&#34;) g.addE(&#39;flow&#39;).from(V(&#39;source-111&#39;)).to(V(&#39;metric-111&#39;)) g.addE(&#39;flow&#39;).from(V(&#39;metric-111&#39;)).to(V(&#39;metric-222&#39;)) g.addE(&#39;flow&#39;).from(V(&#39;metric-111&#39;)).to(V(&#39;metric-333&#39;)) 基础语法 V()：查询顶点，一般作为图查询的第1步，后面可以续接的语句种类繁多。例，g.V()，g.V(&#39;v_id&#39;)，查询所有点和特定点； E()：查询边，一般作为图查询的第1步，后面可以续接的语句种类繁多； id()：获取顶点、边的id。例：g.V().id()，查询所有顶点的id； label()：获取顶点、边的 label。例：g.V().label()，可查询所有顶点的label。 key() / values()：获取属性的key/value的值。 properties()：获取顶点、边的属性；可以和 key()、value()搭配使用，以获取属性的名称或值。例：g.V().properties(&#39;name&#39;)，查询所有顶点的 name 属性； valueMap()：获取顶点、边的属性，以Map的形式体现，和properties()比较像； values()：获取顶点、边的属性值。例，g." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/91a92e008947b267b985b0a5c32e43a7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-14T13:06:26+08:00" />
<meta property="article:modified_time" content="2020-06-14T13:06:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">GDB图形数据库/Tinkerpop gremlin使用总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="gdb_0"></a>什么是gdb?</h4> 
<p>图数据库（Graph Database，简称GDB）是一种支持Property Graph图模型、用于处理高度连接数据查询与存储的实时、可靠的在线数据库服务。它支持Apache TinkerPop Gremlin查询语言，可以帮您快速构建基于高度连接的数据集的应用程序。GDB非常适合社交网络、欺诈检测、推荐引擎、实时图谱、网络/IT运营这类高度互连数据集的场景。例如，在一个典型的社交网络中，常常会存在“谁认识谁，上过什么学校，常住什么地方，喜欢什么餐馆之类的查询”，传统关系型数据库对于超过3度的查询十分低效难以胜任，但图数据库可轻松应对社交网络的各种复杂存储和查询场景。</p> 
<h4><a id="gdb__4"></a>gdb 基本用法</h4> 
<p>1.添加点</p> 
<pre><code class="prism language-bash">g.addV<span class="token punctuation">(</span><span class="token string">'gdb_sample_person'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span>id, <span class="token string">'gdb_sample_marko'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'age'</span>, 28<span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'name'</span>, <span class="token string">'marko'</span><span class="token punctuation">)</span>
g.addV<span class="token punctuation">(</span><span class="token string">'gdb_sample_person'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span>id, <span class="token string">'gdb_sample_vadas'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'age'</span>, 27<span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'name'</span>, <span class="token string">'vadas'</span><span class="token punctuation">)</span>
g.addV<span class="token punctuation">(</span><span class="token string">'gdb_sample_person'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span>id, <span class="token string">'gdb_sample_josh'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'age'</span>, 32<span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'name'</span>, <span class="token string">'josh'</span><span class="token punctuation">)</span>
g.addV<span class="token punctuation">(</span><span class="token string">'gdb_sample_person'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span>id, <span class="token string">'gdb_sample_peter'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'age'</span>, 35<span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'name'</span>, <span class="token string">'peter'</span><span class="token punctuation">)</span>
g.addV<span class="token punctuation">(</span><span class="token string">'gdb_sample_software'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span>id, <span class="token string">'gdb_sample_lop'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'lang'</span>, <span class="token string">'java'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'name'</span>, <span class="token string">'lop'</span><span class="token punctuation">)</span>
g.addV<span class="token punctuation">(</span><span class="token string">'gdb_sample_software'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span>id, <span class="token string">'gdb_sample_ripple'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'lang'</span>, <span class="token string">'java'</span><span class="token punctuation">)</span>.property<span class="token punctuation">(</span><span class="token string">'name'</span>, <span class="token string">'ripple'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-c">说明： 操作点  用 g<span class="token punctuation">.</span><span class="token function">addV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  操作边 用 g<span class="token punctuation">.</span><span class="token function">addE</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
后边用点来跟相加的property 属性值。 有点像lambda表达式。
</code></pre> 
<p>g.V().drop() 这个操作是删除点</p> 
<pre><code class="prism language-c">g<span class="token punctuation">.</span><span class="token function">addV</span><span class="token punctuation">(</span><span class="token string">"Metric"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">property</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">"metric-111"</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addV</span><span class="token punctuation">(</span><span class="token string">"Metric"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">property</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">"metric-222"</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addV</span><span class="token punctuation">(</span><span class="token string">"Metric"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">property</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">"metric-333"</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addV</span><span class="token punctuation">(</span><span class="token string">"Source"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">property</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">"source-111"</span><span class="token punctuation">)</span>

g<span class="token punctuation">.</span><span class="token function">addE</span><span class="token punctuation">(</span><span class="token string">'flow'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-111'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'metric-111'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addE</span><span class="token punctuation">(</span><span class="token string">'flow'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'metric-111'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'metric-222'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">addE</span><span class="token punctuation">(</span><span class="token string">'flow'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'metric-111'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'metric-333'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_33"></a>基础语法</h5> 
<pre><code class="prism language-c"><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：查询顶点，一般作为图查询的第<span class="token number">1</span>步，后面可以续接的语句种类繁多。例，g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'v_id'</span><span class="token punctuation">)</span>，查询所有点和特定点；
<span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：查询边，一般作为图查询的第<span class="token number">1</span>步，后面可以续接的语句种类繁多；
<span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取顶点、边的id。例：g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，查询所有顶点的id；
<span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取顶点、边的 label。例：g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，可查询所有顶点的label。
<span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取属性的key<span class="token operator">/</span>value的值。
<span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取顶点、边的属性；可以和 <span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span>、<span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span>搭配使用，以获取属性的名称或值。例：g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>，查询所有顶点的 name 属性；
<span class="token function">valueMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取顶点、边的属性，以Map的形式体现，和<span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span>比较像；
<span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取顶点、边的属性值。例，g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 等于 g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_45"></a>点的比遍历操作</h4> 
<h6><a id="vertex_id_46"></a>根据vertex id找到子图所有的点</h6> 
<p>g.V(“metric-111”).repeat(both()).emit()</p> 
<h6><a id="vertex_id_48"></a>根据vertex id找到子图所有的边</h6> 
<p>g.V(“metric-111”).repeat(both()).emit().bothE()</p> 
<h6><a id="metric222Source_50"></a>找到metric-222到Source的最短路径中的其中一条</h6> 
<pre><code class="prism language-c"><span class="token comment">// 从流中获取每个点的属性</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>

<span class="token comment">// 获取叶子节点</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">"source-111"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">union</span><span class="token punctuation">(</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">not</span><span class="token punctuation">(</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasId</span><span class="token punctuation">(</span><span class="token string">'source-111'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">inV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unfold</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//获取所有的边的id</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-111'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment">// 根据根找到所有的叶子节点</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-111'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">union</span><span class="token punctuation">(</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">not</span><span class="token punctuation">(</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 查询所有的点</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-9ae24e62fb7b43849e2ab9f8c6d47ef4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token string">'have'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unfold</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-5e38c945ca6e4c13aaeb31aaaa943f0c'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token string">'created'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">both</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unfold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dedup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment">// 查询所有的边</span>

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasId</span><span class="token punctuation">(</span><span class="token string">'cen_cmdb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">inV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unfold</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
e<span class="token punctuation">[</span>daeda8e9<span class="token operator">-</span><span class="token number">001f</span><span class="token operator">-</span><span class="token number">4f</span><span class="token number">14</span><span class="token operator">-</span><span class="token number">86f</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">10</span>a2b387f1dd<span class="token punctuation">]</span><span class="token punctuation">[</span>source<span class="token operator">-</span><span class="token number">111</span><span class="token operator">-</span>flow<span class="token operator">-&gt;</span>metric<span class="token operator">-</span><span class="token number">111</span><span class="token punctuation">]</span>
</code></pre> 
<h4><a id="_82"></a>举个例子:</h4> 
<p>有图会更直观一些<br> <img src="https://images2.imgbox.com/1e/10/0BQoSSqC_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-java">顶点为基准的Steps（如上图中的顶点“<span class="token number">4</span>”）：

<span class="token function">out</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token operator">:</span> 根据指定的EdgeLabel来访问顶点的OUT方向邻接点（可以是零个EdgeLabel，代表所有类型边；也可以一个或多个EdgeLabel，代表任意给定EdgeLabel的边，下同）
<span class="token function">in</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token operator">:</span> 根据指定的EdgeLabel来访问顶点的IN方向邻接点
<span class="token function">both</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token operator">:</span> 根据指定的EdgeLabel来访问顶点的双向邻接点
<span class="token function">outE</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token operator">:</span> 根据指定的EdgeLabel来访问顶点的OUT方向邻接边
<span class="token function">inE</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token operator">:</span> 根据指定的EdgeLabel来访问顶点的IN方向邻接边
<span class="token function">bothE</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token operator">:</span> 根据指定的EdgeLabel来访问顶点的双向邻接边
边为基准的Steps（如上图中的边“knows”）：

<span class="token function">outV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 访问边的出顶点（注意：这里是以边为基准，上述Step均以顶点为基准），出顶点是指边的起始顶点
<span class="token function">inV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 访问边的入顶点，入顶点是指边的目标顶点，也就是箭头指向的顶点
<span class="token function">bothV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 访问边的双向顶点
<span class="token function">otherV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 访问边的伙伴顶点，即相对于基准顶点而言的另一端的顶点
</code></pre> 
<h4><a id="1__105"></a>1. 遍历操作</h4> 
<pre><code class="prism language-c">顶点为基准：

<span class="token function">out</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span>：根据指定的 Edge Label 来访问顶点的 OUT 方向邻接点（可以是零个 Edge Label，代表所有类型边；也可以一个或多个 Edge Label，代表任意给定 Edge Label 的边，下同）；
<span class="token function">in</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span>：根据指定的 Edge Label 来访问顶点的 IN 方向邻接点；
<span class="token function">both</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span>：根据指定的 Edge Label 来访问顶点的双向邻接点 
这个在拓扑中有维表的节点 查询维表 使用比较方便。；
<span class="token function">outE</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span>： 根据指定的 Edge Label 来访问顶点的 OUT 方向邻接边；
<span class="token function">inE</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span>：根据指定的 Edge Label 来访问顶点的 IN 方向邻接边；
<span class="token function">bothE</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span>：根据指定的 Edge Label 来访问顶点的双向邻接边；

边为基准的：

<span class="token function">outV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：访问边的出顶点，出顶点是指边的起始顶点；
<span class="token function">inV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：访问边的入顶点，入顶点是指边的目标顶点，也就是箭头指向的顶点；
<span class="token function">bothV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：访问边的双向顶点；
<span class="token function">otherV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：访问边的伙伴顶点，即相对于基准顶点而言的另一端的顶点；
</code></pre> 
<h4><a id="2__126"></a>2. 过滤操作</h4> 
<pre><code class="prism language-c">在众多Gremlin的语句中，有一大类是filter类型，顾名思义，就是对输入的对象进行条件判断，只有满足过滤条件的对象才可以通过filter进入下一步。
has
has语句是filter类型语句的代表，能够以顶点和边的属性作为过滤条件，决定哪些对象可以通过。常用的有下面几种<span class="token punctuation">:</span>
<span class="token function">hasId</span><span class="token punctuation">(</span>ids…​<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过 id 来过滤顶点或者边，满足id列表中的一个即可通过；
<span class="token function">hasKey</span><span class="token punctuation">(</span>keys…​<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过 properties 中的若干 key 过滤顶点或边；
<span class="token function">hasValue</span><span class="token punctuation">(</span>values…​<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过 properties 中的若干 value 过滤顶点或边；
<span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span> properties 中存在 key 这个属性则通过，等价于<span class="token function">hasKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>；
<span class="token function">hasNot</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span> 和 <span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> 相反

<span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过属性的名字和值来过滤顶点或边；
<span class="token function">has</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过label和属性的名字和值过滤顶点和边；
<span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>predicate<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过对指定属性用条件过滤顶点和边，例：g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token function">gt</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>，可得到年龄大于<span class="token number">20</span>的顶点；
<span class="token function">hasLabel</span><span class="token punctuation">(</span>labels…​<span class="token punctuation">)</span><span class="token punctuation">:</span> 通过 label 来过滤顶点或边，满足label列表中一个即可通过；
</code></pre> 
<h4><a id="3__144"></a>3. 路径</h4> 
<pre><code class="prism language-c"><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 返回当前遍历过的所有路径。有时需要对路径进行过滤，只选择没有环路的路径或者选择包含环路的路径，Gremlin针对这种需求提供了两种过滤路径的step：<span class="token function">simplePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 和<span class="token function">cyclicPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>。

<span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：获取当前遍历过的所有路径；
<span class="token function">simplePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：过滤掉路径中含有环路的对象，只保留路径中不含有环路的对象；
<span class="token function">cyclicPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：过滤掉路径中不含有环路的对象，只保留路径中含有环路的对象。
</code></pre> 
<p>g.V(“metric-222”).repeat(__.in().simplePath()).until(hasLabel(“Source”)).path().limit(1)</p> 
<p>g.V().fold() // 查询所有的点</p> 
<p>g.V().out().out().path() // 显示所有的 点之间的路径<br> g.V(‘source-111’).out().out().path() // 可指定数据源id 来获取数据</p> 
<p>path[v[source-111], v[metric-111], v[metric-222]]<br> path[v[source-111], v[metric-111], v[metric-333]]</p> 
<p>g.V(1).both().both().path() //所有路径</p> 
<p>g.V(1).both().both().simplePath().path() //非重复路径</p> 
<p>g.V(1).both().both().cyclicPath().path() //重复路径</p> 
<p>图形数据结构 这里处理是 点个边有rds 和 gdb 两个来维护起来。</p> 
<h4><a id="4_173"></a>4.迭代遍历</h4> 
<pre><code class="prism language-c"><span class="token number">1.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：指定要重复执行的语句；
<span class="token number">2.</span><span class="token function">times</span><span class="token punctuation">(</span><span class="token punctuation">)</span>： 指定要重复执行的次数，如执行<span class="token number">3</span>次；
<span class="token number">3.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：指定循环终止的条件，如一直找到某个名字的朋友为止；
<span class="token number">4.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：指定循环语句的执行过程中收集数据的条件，每一步的结果只要符合条件则被收集，不指定条件时收集所有结果；
<span class="token number">5.</span><span class="token function">loops</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：当前循环的次数，可用于控制最大循环次数等，如最多执行<span class="token number">3</span>次。
<span class="token number">6.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 和 <span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 的位置不同，决定了不同的循环效果：
<span class="token number">7.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：等同 <span class="token keyword">do</span><span class="token operator">-</span><span class="token keyword">while</span>；
<span class="token number">8.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：等同 <span class="token keyword">while</span><span class="token operator">-</span><span class="token keyword">do</span>。
<span class="token number">9.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 和 <span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 的位置不同，决定了不同的循环效果：
<span class="token number">10.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：先执行后收集；
<span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">repeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：表示先收集再执行

注意细节：

<span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>与<span class="token function">times</span><span class="token punctuation">(</span><span class="token punctuation">)</span>搭配使用时，是“或”的关系而不是“与”的关系，满足两者间任意一个即可。
<span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>与<span class="token function">until</span><span class="token punctuation">(</span><span class="token punctuation">)</span>搭配使用时，是“或”的关系而不是“与”的关系，满足两者间任意一个即可。
</code></pre> 
<h4><a id="5_194"></a>5.转换</h4> 
<pre><code class="prism language-c">注意：
<span class="token number">1.</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：可以接受一个遍历器 Step 或 Lamda 表达式，将遍历器中的元素映射（转换）成另一个类型的某个对象（一对一），以便进行下一步处理
<span class="token number">2.</span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：可以接受一个遍历器 Step 或 Lamda 表达式，将遍历器中的元素映射（转换）成另一个类型的某个对象流或迭代器（一对多）。
</code></pre> 
<h4><a id="6__201"></a>6.逻辑 操作和排序操作</h4> 
<pre><code class="prism language-c">逻辑操作

<span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：可以接受一个对象（能判断相等）或一个判断语句（如：P<span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>、P<span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>、P<span class="token punctuation">.</span><span class="token function">inside</span><span class="token punctuation">(</span><span class="token punctuation">)</span>等），当接受的是对象时，原遍历器中的元素必须与对象相等才会保留；当接受的是判断语句时，原遍历器中的元素满足判断才会保留，其实接受一个对象相当于P<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>；
<span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：可以接受任意数量的遍历器（traversal），原遍历器中的元素，只有在每个新遍历器中都能生成至少一个输出的情况下才会保留，相当于过滤器组合的与条件；
<span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：可以接受任意数量的遍历器（traversal），原遍历器中的元素，只要在全部新遍历器中能生成至少一个输出的情况下就会保留，相当于过滤器组合的或条件；
<span class="token function">not</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：仅能接受一个遍历器（traversal），原遍历器中的元素，在新遍历器中能生成输出时会被移除，不能生成输出时则会保留，相当于过滤器的非条件。
</code></pre> 
<pre><code class="prism language-c">排序操作

<span class="token function">order</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
排序比较简单，直接看例子吧。

<span class="token comment">// 默认升序排列</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 按照元素属性age的值升序排列，并只输出姓名</span>
g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasLabel</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> asc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="7_225"></a>7.分支</h4> 
<pre><code class="prism language-c"><span class="token number">1.</span> <span class="token function">choose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ：分支选择<span class="token punctuation">,</span> 常用使用场景为： <span class="token function">choose</span><span class="token punctuation">(</span>predicate<span class="token punctuation">,</span> true<span class="token operator">-</span>traversal<span class="token punctuation">,</span> false<span class="token operator">-</span>traversal<span class="token punctuation">)</span>，根据 predicate 判断，当前对象满足时，继续 true<span class="token operator">-</span>traversal，否则继续 false<span class="token operator">-</span>traversal；
<span class="token number">2.</span> <span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：类似于 <span class="token function">by</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 无实际意义，搭配 <span class="token function">choose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 使用；
</code></pre> 
<p>/*</p> 
<ul><li>节点<br> */<br> uuid: ‘ndef_3fa6856e20344104aa3723117a2466db’,<br> label: ‘slb.proxy.vs.1m’, // 展示节点名称<br> type: ‘root’, // 节点类型 根 metric 维表<br> status: ‘rootNode’, // 是可编辑 是 不是<br> state: ‘working’, // 状态 （运行中、关闭中。。。。）<br> x: 300, // x轴坐标<br> y: 50, // y轴坐标</li></ul> 
<p>/*</p> 
<ul><li>线<br> */<br> uuid: ‘nrltn_551c292dfacb4f188d17f70725966759’,<br> source: ‘ndef_3fa6856e20344104aa3723117a2466db’, // 起始点<br> target: ‘ndef_f5844444ee87499caf067990dbf92f46’, // 结束点</li></ul> 
<pre><code class="prism language-c"><span class="token comment">// 遍历查询 所有的点</span>

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-09d635e5968943fc83ca61636f0437e0'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>  <span class="token comment">// 把有顶点查询的所有点放到一个临时容器</span>
<span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token string">'created'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 根据边的出方向去遍历</span>
<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment">// 在放到一个新的临时容器  新的容器也包含 上个容器的内容</span>
<span class="token punctuation">.</span><span class="token function">both</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>                  <span class="token comment">// both() 的作用 找到与之 相关联的点 不分出和入方向</span>
<span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>  
<span class="token punctuation">.</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unfold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>   <span class="token comment">// 通过cap(label)来获取该结果集合   此外还可通过select(label)或without(label)等其它方式读取。</span>
<span class="token function">dedup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// 去重</span>

</code></pre> 
<pre><code class="prism language-bash">功能名词解释：
aggregate   临时存储 store 也可临时存储
①repeat<span class="token punctuation">..</span>.until<span class="token punctuation">..</span>.   until<span class="token punctuation">..</span>.repeat    相当于do<span class="token punctuation">..</span>.while 和 while<span class="token punctuation">..</span>.do
union合并结果集
dedup 删除重复行

store<span class="token punctuation">(</span><span class="token punctuation">)</span>: 类似aggregate<span class="token punctuation">(</span><span class="token punctuation">)</span>，只是以Lazy的方式来收集。
unfold<span class="token punctuation">(</span><span class="token punctuation">)</span>: 将集合展开平铺，路径将扩张。
fold<span class="token punctuation">(</span><span class="token punctuation">)</span>: 将多个元素折叠为一个集合，路径将收缩。
</code></pre> 
<h5><a id="8_277"></a>8.获取顶点到叶子节点所有路径</h5> 
<pre><code class="prism language-c">g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">'source-209232d14e6b45e39322d05dacc5960e'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

查询一个顶点到所有叶子节点的所有路径

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>

查询一个顶点到指定节点的所有路径

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">simplePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token function">hasId</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>


查询所有起始点到指定点的 加上深度遍历的 写法 加深度限制的写法，建议这么写

g<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span>fromVertexId<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token function">outE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">simplePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token function">hasId</span><span class="token punctuation">(</span>toVertexId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loops</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token function">lte</span><span class="token punctuation">(</span>deepLimit<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">hasId</span><span class="token punctuation">(</span>toVertexId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>

</code></pre> 
<p><a href="https://help.aliyun.com/document_detail/107477.html?spm=a2c4g.11186623.6.586.44b76581iIhdW6" rel="nofollow">java 操作gdb详情</a></p> 
<p><a href="https://tinkerpop.apache.org/docs/current/recipes/#traversal-induced-values" rel="nofollow">Apache gremlin 官网</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bc7cd213e7415fe0c8920510a7832d2c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python爬虫实战练习（疫情数据获取）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b831ab74e5f1f32af8bcfdbf19a8bed0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">什么是自动化运维？自动化运维必备技能有哪些？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>