<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>leetcode题库学习系列——168. Excel表列名称 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="leetcode题库学习系列——168. Excel表列名称" />
<meta property="og:description" content="原题地址：
https://leetcode-cn.com/problems/excel-sheet-column-title/
原题如下： 给你一个整数 columnNumber ，返回它在 Excel 表中相对应的列名称。
例如：
A -&gt; 1
B -&gt; 2
C -&gt; 3
…
Z -&gt; 26
AA -&gt; 27
AB -&gt; 28
…
示例 1：
输入：columnNumber = 1
输出：“A”
示例 2：
输入：columnNumber = 28
输出：“AB”
示例 3：
输入：columnNumber = 701
输出：“ZY”
示例 4：
输入：columnNumber = 2147483647
输出：“FXSHRXW”
提示：
1 &lt;= columnNumber &lt;= 231 - 1
记录解题思路： 打眼看去是个26进制的题（想到这点的思路很快，这算是我的一个进步），同时应该很快的联想到进制的换算，以10进制为枢纽，10进制写成N进制，M进制写成10进制等等，应该马上联想到这些才对。
然后进行了区域演算，如下：
A=1
Z=26
AA=27=1&#43;26*1
AZ=52
BA=53=1&#43;26*2=B*26^1&#43;A*26^0" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ea1d1a96c126345bb212b20084ca7350/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-29T23:20:00+08:00" />
<meta property="article:modified_time" content="2021-06-29T23:20:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">leetcode题库学习系列——168. Excel表列名称</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>原题地址：<br> <a href="https://leetcode-cn.com/problems/excel-sheet-column-title/" rel="nofollow">https://leetcode-cn.com/problems/excel-sheet-column-title/</a></p> 
<h3><a id="_3"></a>原题如下：</h3> 
<p>给你一个整数 columnNumber ，返回它在 Excel 表中相对应的列名称。</p> 
<p>例如：</p> 
<p>A -&gt; 1<br> B -&gt; 2<br> C -&gt; 3<br> …<br> Z -&gt; 26<br> AA -&gt; 27<br> AB -&gt; 28<br> …</p> 
<p>示例 1：</p> 
<p>输入：columnNumber = 1<br> 输出：“A”<br> 示例 2：</p> 
<p>输入：columnNumber = 28<br> 输出：“AB”<br> 示例 3：</p> 
<p>输入：columnNumber = 701<br> 输出：“ZY”<br> 示例 4：</p> 
<p>输入：columnNumber = 2147483647<br> 输出：“FXSHRXW”</p> 
<p>提示：</p> 
<p>1 &lt;= columnNumber &lt;= 231 - 1</p> 
<hr> 
<hr> 
<h3><a id="_44"></a>记录解题思路：</h3> 
<p>打眼看去是个26进制的题（想到这点的思路很快，这算是我的一个进步），同时应该很快的联想到进制的换算，以10进制为枢纽，10进制写成N进制，M进制写成10进制等等，应该马上联想到这些才对。<br> 然后进行了区域演算，如下：<br> A=1<br> Z=26<br> AA=27=1+26*1<br> AZ=52<br> BA=53=1+26*2=B*26^1+A*26^0<br> BZ=78=B*26^1+Z*26^0<br> ZA=1+26*26=677<br> ZZ=702=Z*26^1+Z*26^0<br> ……<br> A~Z有26个字母，A和Z的索引相差25等信息也随之而来。<br> 看起来就是进制运算，题目也就是将10进制数字转化成26进制，那么用短除笔算，发现了大问题。<br> 比如ZZ=702在转化成26进制数字的时候，结果等于110，变换对应字符，是AA0，并不是ZZ；<br> 比如BZ=78，转化结果为30，变换对应字符，是C0，也不是BZ。</p> 
<p>此时我发现，原文中A~Z是1~26，没有0，这里知道出现问题了，同时也发现了问题规律，就是如果得到了AA0，那么减1就是ZZ；如果得到了C0，减1就是BZ，但问题是我们知道AA0可以减1，但是计算机代码不知道AA0是什么，这是我们为了解题而思考出来的26进制表示方法，另外，是不是A0A0就要减2了呢？</p> 
<p>这里卡住了我很久，原因就是我固执地想把得到的结果AA0怎样处理一下，就可以得到真正的结果ZZ，因为我脑中的思路就是10进制转化26进制的过程，这个过程是神圣不可侵犯的，不可更改的，所以我想当然的要从结果AA0入手去转换为ZZ，这困扰了我很久，因为我找不到一个能说服我的转换思路，不论是遇到0就减1还是其他的什么。</p> 
<p>后来我仔细分析了一下短除的过程，为什么会出现0这个余数，怎样能得到正确的结果，我用最基础的Z=26来除以26重新短除捋思路，发现26短除26的第一阶，商为1，余数就为0，然后考虑题中A为1，那么0应该就是A的前一个字符Z，Z也即是26所指，问题是还有一个商1没有被除尽，然后思考了一下题目并不是完整的10进制转换为26进制的问题，原题本身就少了0这个因子，所以把这个商减1处理，既在形式上得到了正确的结果，也在意义上算是补充低位的0形成Z这个值。</p> 
<p>因此，短除多了一个重要的，针对于该题的步骤：<br> 当短除到某阶，余数为0时，此时将商减1处理，继续短除直至商为0。余数为0的对应字符为Z。</p> 
<h3><a id="_71"></a>代码如下：</h3> 
<pre><code>class Solution {

    private char int2Char(int letterInt){
        return (char)(64+(letterInt==0?26:letterInt));
    }
  
    public String convertToTitle(int columnNumber) {
       StringBuffer sb=new StringBuffer();
        int shang=0;
        int chushu=columnNumber;
        do{
            shang=chushu/26;
            int yushu=chushu%26;
            if(yushu==0)
            {
                shang--;
            }
            sb.append(int2Char(yushu));
            chushu=shang;
        }while(shang!=0);
        return sb.reverse().toString();
    }
    
}
</code></pre> 
<p>看到一个消耗内存最少的大神的代码如下：<br> 值得学习</p> 
<pre><code>class Solution {
    public String convertToTitle(int n) {
	StringBuilder stringBuilder = new StringBuilder();
	while (n != 0) {
		n--; // 依次获取 26 进制逻辑上的个位、十位、百位…（虽然在 26 进制中不这么叫）
		stringBuilder.append((char) ('A' + n % 26));
		n /= 26;
	}
	return stringBuilder.reverse().toString();
    }
}
</code></pre> 
<h3><a id="_117"></a>反思</h3> 
<p>卡了很久的地方，为了尽快解题而选择碰运气来处理result，是不对的，应该回归解题思路与步骤，从步骤中寻找突破口。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f10252d6180c54f507e27d0949b008f2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【预测模型】BP神经网络的预测</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8eb78ec59051b89dd38bf12c1a77ee80/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Vivado那些事】FPGA的配置方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>