<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python根据视频帧按秒从视频中提取图片 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python根据视频帧按秒从视频中提取图片" />
<meta property="og:description" content="看到有按照帧提取视频中的图片的例子，但是个人只需用到每秒的图片。
以下是用到的代码：
import os import cv2 def save_img2(): # 提取视频中图片 按照每秒提取 间隔是视频帧率 video_path = r&#39;C:/Users/Louise喵/Desktop/video1/&#39; # 视频所在的路径 f_save_path = &#39;D:/image/&#39; # 保存图片的上级目录 videos = os.listdir(video_path) # 返回指定路径下的文件和文件夹列表。 for video_name in videos: # 依次读取视频文件 file_name = video_name.split(&#39;.&#39;)[0] # 拆分视频文件名称 ，剔除后缀 folder_name = f_save_path &#43; file_name # 保存图片的上级目录&#43;对应每条视频名称 构成新的目录存放每个视频的 os.makedirs(folder_name, exist_ok=True) # 创建存放视频的对应目录 vc = cv2.VideoCapture(video_path &#43; video_name) # 读入视频文件 fps = vc.get(cv2.CAP_PROP_FPS) # 获取帧率 print(fps) # 帧率可能不是整数 需要取整 rval = vc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/460d95e997ff4028590799636ae530a4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-12T10:14:56+08:00" />
<meta property="article:modified_time" content="2022-05-12T10:14:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python根据视频帧按秒从视频中提取图片</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a></h2> 
<p>看到有按照帧提取视频中的图片的例子，但是个人只需用到每秒的图片。<br> 以下是用到的代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> cv2

<span class="token keyword">def</span> <span class="token function">save_img2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 提取视频中图片 按照每秒提取   间隔是视频帧率</span>
    video_path <span class="token operator">=</span> <span class="token string">r'C:/Users/Louise喵/Desktop/video1/'</span>  <span class="token comment"># 视频所在的路径</span>
    f_save_path <span class="token operator">=</span> <span class="token string">'D:/image/'</span>  <span class="token comment"># 保存图片的上级目录</span>
    videos <span class="token operator">=</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>video_path<span class="token punctuation">)</span>  <span class="token comment"># 返回指定路径下的文件和文件夹列表。</span>
    <span class="token keyword">for</span> video_name <span class="token keyword">in</span> videos<span class="token punctuation">:</span>  <span class="token comment"># 依次读取视频文件</span>
        file_name <span class="token operator">=</span> video_name<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 拆分视频文件名称 ，剔除后缀</span>
        folder_name <span class="token operator">=</span> f_save_path <span class="token operator">+</span> file_name  <span class="token comment"># 保存图片的上级目录+对应每条视频名称 构成新的目录存放每个视频的</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>folder_name<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 创建存放视频的对应目录</span>
        vc <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span>video_path <span class="token operator">+</span> video_name<span class="token punctuation">)</span>  <span class="token comment"># 读入视频文件</span>
        fps <span class="token operator">=</span> vc<span class="token punctuation">.</span>get<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>CAP_PROP_FPS<span class="token punctuation">)</span>  <span class="token comment"># 获取帧率</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>fps<span class="token punctuation">)</span>  <span class="token comment"># 帧率可能不是整数  需要取整</span>
        rval <span class="token operator">=</span> vc<span class="token punctuation">.</span>isOpened<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 判断视频是否打开  返回True或False</span>
        c <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">while</span> rval<span class="token punctuation">:</span>  <span class="token comment"># 循环读取视频帧</span>
            rval<span class="token punctuation">,</span> frame <span class="token operator">=</span> vc<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># videoCapture.read() 函数，第一个返回值为是否成功获取视频帧，第二个返回值为返回的视频帧：</span>
            pic_path <span class="token operator">=</span> folder_name <span class="token operator">+</span> <span class="token string">'/'</span>
            <span class="token keyword">if</span> rval<span class="token punctuation">:</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">%</span> <span class="token builtin">round</span><span class="token punctuation">(</span>fps<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 每隔fps帧进行存储操作   ,可自行指定间隔</span>
                    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>pic_path <span class="token operator">+</span> <span class="token string">'video_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>c<span class="token operator">/</span>fps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.png'</span><span class="token punctuation">,</span> frame<span class="token punctuation">)</span> <span class="token comment">#存储为图像的命名 video_数字（第几个文件）.png</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'video_'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">(</span>c<span class="token operator">/</span>fps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.png'</span><span class="token punctuation">)</span>
                cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># waitKey()--这个函数是在一个给定的时间内(单位ms)等待用户按键触发;如果用户没有按下键,则接续等待(循环)</span>
                c <span class="token operator">=</span> c <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        vc<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'save_success'</span> <span class="token operator">+</span> folder_name<span class="token punctuation">)</span>


save_img2<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>有几点需要注意：</p> 
<ol><li>提取出的图片位置不要放在C盘，放在C盘会显示文件夹为空，涉及到权限问题没有将图片存入文件夹中。</li><li>逻辑上是读取视频帧率，然后根据FPS来指定间隔进行存储图片，从而达到每秒存储一次图片。</li><li>以上代码可以批量读取多个视频，前提是在同一个路径下。一个视频对应的图集均以视频名存于指定位置。</li><li>视频存储的路径下最好只有需要处理的视频，以防报错。</li></ol> 
<p>以下是一个读取一个视频后的显示，最后显示成功存储在指定路径下。<br> <img src="https://images2.imgbox.com/1b/6b/13fORtPv_o.png" alt="在这里插入图片描述"><br> 文件夹显示如下：<br> <img src="https://images2.imgbox.com/86/05/JYZFFYFY_o.png" alt="在这里插入图片描述"><br> 提取成功。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab231c020889856149d15e7b235900e5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python中join的使用方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eab371164f4b7b4b519deb43a5ac2eba/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SVN图标丢失解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>