<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在云服务器上搭建个人版chatGPT及后端Spring Boot集成chat GPT - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在云服务器上搭建个人版chatGPT及后端Spring Boot集成chat GPT" />
<meta property="og:description" content="本文分成两部分，包括【国内服务器上搭建chat GPT】和【后端Spring Boot集成chat GPT】。
无论是在【国内服务器上搭建chat GPT】和【后端Spring Boot集成chat GPT】，两个方式都需要魔法访问，否则是无法正常使用的，即需要具备正常访问谷歌或者 api.openai.com的能力。
至于什么是魔法访问，以及如何搭建魔法访问，请自行研究哈。
下面就开始讲解两部分的教程。
一、国内服务器上搭建chat GPT 首先，你需要准备以下东西：
1、一台可以访问公网的Linux云服务器，最低配置1核2G即可（当然，有钱可以任性，买最高配置）
2、chatGPT的密钥
3、开源的仿chatGPT的Docker镜像
1.1、准备一台云服务器 可以是腾讯云、阿里云或者华为云等，我分别在阿里云和华为云上都能正常搭建。
1.2、设置网络代理 在部署魔法访问的服务器上，需要在/etc/profile增加代理，确保通过密钥方式的chatGPT接口调用能正常访问：
export all_proxy=http://127.0.0.1:8889
export http_proxy=http://127.0.0.1:8889
export https_proxy=https://127.0.0.1:8889
export all_proxy=socks5://127.0.0.1:1080
这里的8889和1080需要根据你的魔法访问里的config.json来相应设置。
配置完成后，执行source /etc/profile，检验一下curl https://api.openai.com/
可以访问即没问题。可以继续往下走。
1.3、安装Docker 搭建完成后，因为Docker的对外访问若需要走所在宿主的代理话，还需要设置以下操作——
创建一个~/.docker/目录，然后在该目录下新建一个config.json文件，在该文件里添加以下命令——
{ &#34;default&#34;: { &#34;httpProxy&#34;: &#34;http://127.0.0.1:8889&#34;, &#34;httpsProxy&#34;: &#34;http://127.0.0.1:8889&#34;, &#34;noProxy&#34;: &#34;*.test.example.com,.example2.com,127.0.0.0/8&#34; } } } 1.4、Docker镜像 目前网上GitHub已经开源了许多优秀的仿写chatGPT 页面的应用，我们无需再额外造轮子，只需要挑选其中一款用来打包部署成Docker容器运行即可。
我使用的是chatgpt-mirror这个开源项目。
直接克隆项目到对应的Linux服务器——
git clone https://github.com/yuezk/chatgpt-mirror.git 在基于该开源项目以Dockerfile形式打包前，需要执行以下被依赖到的镜像——
docker pull node:18-alpine docker pull node:18-slim 接下来，就可以执行以下操作来创建一个Docker镜像了——
cd chatgpt-mirror #--network host表示与宿主公用网络，即走代理，然后留意下最后有一个 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/56b9baf87f68cc59265f1d85982ac280/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-20T09:30:00+08:00" />
<meta property="article:modified_time" content="2023-07-20T09:30:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在云服务器上搭建个人版chatGPT及后端Spring Boot集成chat GPT</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文分成两部分，包括【<strong>国内服务器上搭建chat GPT</strong>】和【<strong>后端Spring Boot集成chat GPT</strong>】。</p> 
<p>无论是在【国内服务器上搭建chat GPT】和【后端Spring Boot集成chat GPT】，两个方式都需要魔法访问，否则是无法正常使用的，即需要具备正常访问谷歌或者 api.openai.com的能力。</p> 
<p>至于什么是魔法访问，以及如何搭建魔法访问，请自行研究哈。</p> 
<p>下面就开始讲解两部分的教程。<br>  </p> 
<h3 id="一国内服务器上搭建chat-gpt">一、国内服务器上搭建chat GPT</h3> 
<p>首先，你需要准备以下东西：</p> 
<p>1、一台可以访问公网的Linux云服务器，最低配置1核2G即可（当然，有钱可以任性，买最高配置）</p> 
<p>2、chatGPT的密钥</p> 
<p>3、开源的仿chatGPT的Docker镜像</p> 
<p><br>  </p> 
<h4 id="11准备一台云服务器">1.1、准备一台云服务器</h4> 
<p>可以是腾讯云、阿里云或者华为云等，我分别在阿里云和华为云上都能正常搭建。<br>  </p> 
<h4 id="12设置网络代理">1.2、设置网络代理</h4> 
<p>在部署魔法访问的服务器上，需要在/etc/profile增加代理，确保通过密钥方式的chatGPT接口调用能正常访问：</p> 
<p>export all_proxy=http://127.0.0.1:8889<br> export http_proxy=http://127.0.0.1:8889<br> export https_proxy=https://127.0.0.1:8889<br> export all_proxy=socks5://127.0.0.1:1080</p> 
<p>这里的8889和1080需要根据你的魔法访问里的config.json来相应设置。</p> 
<p>配置完成后，执行source /etc/profile，检验一下curl <a href="https://api.openai.com/" rel="nofollow" title="https://api.openai.com/">https://api.openai.com/</a><br> 可以访问即没问题。可以继续往下走。</p> 
<p></p> 
<h4 id="13安装docker">1.3、安装Docker</h4> 
<p>搭建完成后，因为Docker的对外访问若需要走所在宿主的代理话，还需要设置以下操作——</p> 
<p>创建一个~/.docker/目录，然后在该目录下新建一个config.json文件，在该文件里添加以下命令——</p> 
<pre><code>{
   "default":
   {
     "httpProxy": "http://127.0.0.1:8889",
     "httpsProxy": "http://127.0.0.1:8889",
     "noProxy": "*.test.example.com,.example2.com,127.0.0.0/8"
   }
 }
}
</code></pre> 
<p></p> 
<h4 id="14docker镜像">1.4、Docker镜像</h4> 
<p>目前网上GitHub已经开源了许多优秀的仿写chatGPT 页面的应用，我们无需再额外造轮子，只需要挑选其中一款用来打包部署成Docker容器运行即可。</p> 
<p>我使用的是chatgpt-mirror这个开源项目。</p> 
<p>直接克隆项目到对应的Linux服务器——</p> 
<pre><code>git clone https://github.com/yuezk/chatgpt-mirror.git
</code></pre> 
<p>在基于该开源项目以Dockerfile形式打包前，需要执行以下被依赖到的镜像——</p> 
<pre><code>docker pull node:18-alpine 
docker pull node:18-slim
</code></pre> 
<p>接下来，就可以执行以下操作来创建一个Docker镜像了——</p> 
<pre><code>cd chatgpt-mirror
#--network host表示与宿主公用网络，即走代理，然后留意下最后有一个 .
docker build --network host  -t chatgpt-mirror . 
#正常执行成功后，通过该指令能看到一个新镜像
docker images
</code></pre> 
<p>具体情况如下：</p> 
<p></p> 
<p class="img-center"><img alt="image" height="368" src="https://images2.imgbox.com/65/2f/zCoqTpqz_o.png" width="1200"></p> 
<p>然后需要在cd chatgpt-mirror环境里新增一个文件env，该文件里写入chatGPT密钥与宿主机器的代理：</p> 
<pre><code>OPENAI_API_KEY=你的chatGPT密钥
HTTP_PROXY=http://127.0.0.1:8889
</code></pre> 
<p>完成以上操作后，最后在该目录chatgpt-mirror里执行——</p> 
<p>docker run -itd --net host -p 3000:3000 -v /app/config.json:/app/config/app.config --env-file env chatgpt-mirror</p> 
<p>正常执行完成后，即可在浏览上输入http://你的服务器ip:3000，就能出来一个外表仿chatGPT但内在是调用真实chatGPT接口的应用。</p> 
<p><strong>重点是，如此一来，你的电脑、平台、手机等终端都无需魔法访问，就能直接使用chatGPT了，而且响应速度比直连官网快一倍左右速度，无比丝滑！而且，没有像chatGPT官网直连那样经常出现响应异常以及断开的问题，协助效率大大增加。</strong></p> 
<p>以下就是访问搭建在我自己服务器上的chatGPT页面，是不是跟真实的很像。</p> 
<p></p> 
<p class="img-center"><img alt="image" height="914" src="https://images2.imgbox.com/29/76/VA3kZYoe_o.png" width="1200"></p> 
<p></p> 
<h3 id="二后端spring-boot集成chat-gpt">二、后端Spring Boot集成chat GPT</h3> 
<p>注意，该方式同样需要魔法访问。</p> 
<p>首先，在maven依赖引入以下配置——</p> 
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.theokanning.openai-gpt3-java&lt;/groupId&gt;
    &lt;artifactId&gt;service&lt;/artifactId&gt;
    &lt;version&gt;0.11.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<p>编写以下代码——</p> 
<pre><code>@GetMapping("/ai")
public void sendMsg() throws InterruptedException {
    System.out.println("开始提问题～");
    System.out.println("你是一个工作助手，情帮忙设计一份活动策划书" );
  //GPT_TOKEN即你的代码密钥
    OpenAiService service = new OpenAiService(GPT_TOKEN,Duration.ofSeconds(10000));
    CompletionRequest completionRequest = CompletionRequest.builder()
      			//使用的模型
            .model("text-davinci-003")
            //输入提示语
            .prompt("设计一份活动策划书")
            //该值越大每次返回的结果越随机，即相似度越小，可选参数，默认值为 1，取值 0-2
            .temperature(0.5)
            //返回结果最大分词数
            .maxTokens(2048)
            //与temperature类似
            .topP(1D)
            .build();
    service.createCompletion(completionRequest).getChoices().forEach(System.out::println);
    Thread.sleep(6000);
}
</code></pre> 
<p>CompletionRequest的属性文档介绍在这里——</p> 
<p><a href="https://platform.openai.com/docs/api-reference/completions/create" rel="nofollow" title="https://platform.openai.com/docs/api-reference/completions/create">https://platform.openai.com/docs/api-reference/completions/create</a></p> 
<p>启动，调用该接口，即可正常使用chat GPT集成到SpringBoot后端代码里——</p> 
<p class="img-center"><img alt="image" height="1200" src="https://images2.imgbox.com/77/d7/tdLRZSTb_o.png" width="1200"></p> 
<p>需要注意的是，若是部署在有魔法访问的Linux云服务，代码需要相应做一下调整，否则是无法访问到chatGPT的，会出现以下异常提示：java.net.ConnectException:Failed to connect to api.openai.com/2a03:2880:f10c:283:face:b00c:0:25de:443]</p> 
<p>故而，需要做以下调整：</p> 
<pre><code>public void send1Msg() throws InterruptedException {

        System.out.println("开始提问题～");
        System.out.println("你是一个工作助手，情帮忙设计一份活动策划书" );
        //需要额外设置一个能访问chatGPT的魔法访问代理
        ObjectMapper mapper = defaultObjectMapper();
        Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress("127.0.0.1", 8889));
        OkHttpClient client =  defaultClient(GPT_TOKEN,Duration.ofSeconds(10000))
                .newBuilder()
                .proxy(proxy)
                .build();
        Retrofit retrofit = defaultRetrofit(client, mapper);
        OpenAiApi api = retrofit.create(OpenAiApi.class);

				//将设置的代理传给OpenAiService即可
        OpenAiService service = new OpenAiService(api);
        CompletionRequest completionRequest = CompletionRequest.builder()
                .model("text-davinci-003")
                .prompt("设计一份活动策划书")
                .temperature(0.5)
                .maxTokens(2048)
                .topP(1D)
                .build();
        service.createCompletion(completionRequest).getChoices().forEach(System.out::println);
        Thread.sleep(6000);
}
</code></pre> 
<p>部署在Linux云服务上的聊天返回打印效果——</p> 
<p></p> 
<p class="img-center"><img alt="image" height="900" src="https://images2.imgbox.com/f6/ee/bRlOjsdb_o.png" width="1200"></p> 
<p>以上就是关于【国内服务器上搭建chat GPT】和【后端Spring Boot集成chat GPT】教程，更多好玩的关于chat GPT相关的内容，可以关注我，因为我对这块很感兴趣，接下来会分享更多相关内容。有不懂的也可以后台问我。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d06fece80da1741147af381660a7c8b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">第十二章： 面向对象实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0d6e8639f48d8033bb81a7a22a7dacfc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RK3568 MIPI DSI单通道/双通道支持最大分辨率</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>