<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Centos7 搭建 GitLab - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Centos7 搭建 GitLab" />
<meta property="og:description" content="Centos7 搭建 GitLab 一：安装sshd 1.1 安装sshd yum install -y curl policycoreutils-python openssh-server 2.2 接下来我们启用并启动 sshd： systemctl enable sshd systemctl start sshd 2.3 接下来我们配置下防火墙： 2.3.1 打开 /etc/sysctl.conf 文件，在文件最后添加新的一行 net.ipv4.ip_forward = 1 vim /etc/sysctl.conf 2.3.2 启用并启动防火墙 systemctl enable firewalld systemctl start firewalld 2.3.4 防火墙对http放行 firewall-cmd --permanent --add-service=http 2.3.5 重启防火墙 systemctl reload firewalld 二：安装 postfix GitLab 需要使用 postfix 来发送邮件。当然，也可以使用 SMTP 服务器。
2.1 安装postfix yum install -y postfix 打开 /etc/postfix/main.cf 文件，在第 119 行附近找到 inet_protocols = all，将 all 改为 ipv4" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/452cf39dce98a9b984fd33d55292733b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-17T17:23:20+08:00" />
<meta property="article:modified_time" content="2023-05-17T17:23:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Centos7 搭建 GitLab</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Centos7__GitLab_0"></a>Centos7 搭建 GitLab</h2> 
<h3><a id="sshd_2"></a>一：安装sshd</h3> 
<h4><a id="11_sshd_4"></a>1.1 安装sshd</h4> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> -y <span class="token function">curl</span> policycoreutils-python openssh-server
</code></pre> 
<h5><a id="22__sshd_10"></a>2.2 接下来我们启用并启动 sshd：</h5> 
<pre><code class="prism language-bash">systemctl <span class="token builtin class-name">enable</span> sshd
systemctl start sshd
</code></pre> 
<h5><a id="23__17"></a>2.3 接下来我们配置下防火墙：</h5> 
<h6><a id="231__etcsysctlconf__19"></a>2.3.1 打开 /etc/sysctl.conf 文件，在文件最后添加新的一行</h6> 
<pre><code class="prism language-powershell">net<span class="token punctuation">.</span>ipv4<span class="token punctuation">.</span>ip_forward = 1
</code></pre> 
<pre><code class="prism language-bash"><span class="token function">vim</span> /etc/sysctl.conf
</code></pre> 
<h6><a id="232__29"></a>2.3.2 启用并启动防火墙</h6> 
<pre><code class="prism language-bash">systemctl <span class="token builtin class-name">enable</span> firewalld
systemctl start firewalld
</code></pre> 
<h6><a id="234_http_36"></a>2.3.4 防火墙对http放行</h6> 
<pre><code class="prism language-bash">firewall-cmd --permanent --add-service<span class="token operator">=</span>http
</code></pre> 
<h6><a id="235__42"></a>2.3.5 重启防火墙</h6> 
<pre><code class="prism language-bash">systemctl reload firewalld
</code></pre> 
<h3><a id="_postfix_50"></a>二：安装 postfix</h3> 
<blockquote> 
 <p>GitLab 需要使用 postfix 来发送邮件。当然，也可以使用 SMTP 服务器。</p> 
</blockquote> 
<h4><a id="21_postfix_54"></a>2.1 安装postfix</h4> 
<pre><code class="prism language-bash">yum <span class="token function">install</span> -y postfix
</code></pre> 
<blockquote> 
 <p>打开 /etc/postfix/main.cf 文件，在第 119 行附近找到 inet_protocols = all，将 all 改为 ipv4</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">vim</span> /etc/postfix/main.cf
inet_protocols <span class="token operator">=</span> ipv4
</code></pre> 
<h4><a id="22_postfix_67"></a>2.2 启用并启动postfix</h4> 
<pre><code class="prism language-bash">systemctl <span class="token builtin class-name">enable</span> postfix 
systemctl start postfix
</code></pre> 
<h4><a id="23__swap__74"></a>2.3 配置 swap 交换分区</h4> 
<blockquote> 
 <p>由于 GitLab 较为消耗资源，我们需要先创建交换分区，以降低物理内存的压力。 在实际生产环境中，如果服务器配置够高，则不必配置交换分区。</p> 
</blockquote> 
<h4><a id="24__2_GB__78"></a>2.4 新建 2 GB 大小的交换分区：</h4> 
<pre><code class="prism language-bash"><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>/root/swapfile <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">2048</span>
</code></pre> 
<h4><a id="25__84"></a>2.5 接下来我们对其格式化</h4> 
<pre><code class="prism language-bash"><span class="token function">mkswap</span> /root/swapfile
<span class="token function">swapon</span> /root/swapfile
</code></pre> 
<blockquote> 
 <p>添加自启用。打开 /etc/fstab 文件，在文件最后添加新的一行</p> 
 <pre><code class="prism language-powershell">vim <span class="token operator">/</span>etc<span class="token operator">/</span>fstab
<span class="token operator">/</span>root<span class="token operator">/</span>swapfile swap swap defaults 0 0
</code></pre> 
</blockquote> 
<h3><a id="_GitLab_100"></a>三: 安装GitLab</h3> 
<h4><a id="31_git_102"></a>3.1 创建git安装配置文件</h4> 
<blockquote> 
 <p>将软件源修改为国内源 由于网络环境的原因，将 repo 源修改为清华大学 。</p> 
</blockquote> 
<blockquote> 
 <p>在 /etc/yum.repos.d 目录下新建 gitlab-ce.repo 文件并保存。内容如下：</p> 
 <pre><code class="prism language-powershell"><span class="token namespace">[gitlab-ce]</span>
name=Gitlab CE Repository
baseurl=https:<span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>gitlab<span class="token operator">-</span>ce<span class="token operator">/</span>yum<span class="token operator">/</span>el<span class="token variable">$releasever</span><span class="token operator">/</span>
gpgcheck=0
enabled=1
</code></pre> 
</blockquote> 
<h4><a id="32__yum__116"></a>3.2 修改完 yum 源，因此先重新生成缓存：</h4> 
<blockquote> 
 <p>（此步骤执行时间较长，一般需要 3~5 分钟左右，请耐心等待）</p> 
</blockquote> 
<pre><code class="prism language-bash">yum makecache
</code></pre> 
<h3><a id="_GitLab_126"></a>四: 初始化GitLab</h3> 
<h4><a id="41__GitLab__128"></a>4.1 配置 GitLab 的域名（非必需）</h4> 
<blockquote> 
 <p>打开 /etc/gitlab/gitlab.rb 文件，在第 13 行附近找到 external_url '<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fgitlab.example.com'%20rel=">http://gitlab.example.com’</a>，将单引号中的内容改为自己的域名（带上协议头，末尾无斜杠）</p> 
</blockquote> 
<pre><code class="prism language-powershell">external_url <span class="token string">'http://119.29.102.85'</span>
</code></pre> 
<h4><a id="42__GitLab__136"></a>4.2 初始化 GitLab <mark>特别重要！</mark></h4> 
<p>使用如下命令初始化 GitLab：</p> 
<blockquote> 
 <p>（此步骤执行时间较长，一般需要 5~10 分钟左右，请耐心等待）</p> 
 <pre><code class="prism language-bash"><span class="token function">sudo</span> gitlab-ctl reconfigure
</code></pre> 
</blockquote> 
<p><img src="https://images2.imgbox.com/f9/41/r21b2ROt_o.png" alt="初始化GitLab
"></p> 
<p>当看到这个就说明我们gitlab已经安装成功了</p> 
<blockquote> 
 <p>gitlab 启停相关操作</p> 
 <p>启动服务：gitlab -ctl start<br> 查看状态：gitlab -ctl status<br> 停掉服务：gitlab -ctl stop<br> 重启服务：gitlab -ctl restart<br> 让配置生效：gitlab -ctl reconfigure。</p> 
</blockquote> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> gitlab-ctl reconfigure
<span class="token function">sudo</span> gitlab-ctl stop
<span class="token function">sudo</span> gitlab-ctl start
<span class="token function">sudo</span> gitlab -ctl restart
</code></pre> 
<h4><a id="53__169"></a>5.3 启动成功之后我们通过浏览器访问下</h4> 
<h3><a id="__173"></a>五: 初始化管理员密码</h3> 
<h4><a id="51_175"></a>5.1</h4> 
<p>sudo gitlab-ctl reconfigure<br> sudo gitlab-ctl stop<br> sudo gitlab-ctl start<br> sudo gitlab -ctl restart</p> 
<pre><code>


### 5.3 启动成功之后我们通过浏览器访问下



## 五: 初始化管理员密码

### 5.1 



</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a22eabc643900a33173603bb6d2267c4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">已知一个C类网络地址为192.189.25.0，现要将其划为不同的子网，其要求是：每个子网的主机不超过25台，则最少能分多少个子网？子网掩码是？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0331b5a252a1795cfb1bf4d91d36f887/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">修改 HttpServletRequest 里面的 Parameter 参数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>