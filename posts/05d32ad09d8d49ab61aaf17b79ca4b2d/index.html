<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>模板文件导出Excel【EasyPoi实战系列】- 第478篇 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="模板文件导出Excel【EasyPoi实战系列】- 第478篇" />
<meta property="og:description" content="​历史文章（文章累计470&#43;）
《国内最全的Spring Boot系列之一》
《国内最全的Spring Boot系列之二》
《国内最全的Spring Boot系列之三》
《国内最全的Spring Boot系列之四》
《国内最全的Spring Boot系列之五》
《国内最全的Spring Boot系列之六》
【EasyPoi实战系列】Spring Boot使用EasyPoi动态控制导出的列 - 第471篇
100万数据导出，居然爆炸了OutOfMemoryError？【EasyPoi实战系列】- 第472篇
导出下拉列表的两种小技巧【EasyPoi实战系列】- 第473篇
数据脱敏/换行/枚举的处理【EasyPoi实战系列】- 第474篇
悟纤：师傅，我发现一个挺麻烦的问题。
师傅：怎么说？
悟纤：就是这个很多时候，这个Excel的样式是很复杂的，用代码生成Excel的方式对于处理比较复杂的样式，就有点爱莫能助。
师傅：这个时候，使用模板导出的方式就很有必要了，定义好一个模板，然后使用类似el表达的方式指定单元格的位置，这样样式就可以在模板文件进行编辑了。
悟纤：如果可以这么实现真的是再好不过了，师傅我已经按耐不住了，赶紧带我飞。
师傅：扶好把手，准备启程。
导读
Hi，大家好，我是悟纤。
我就是我，不一样的烟火。我就是我，与众不同的小苹果。
模板是处理复杂Excel的简单方法，复杂的Excel样式，可以用Excel直接编辑，完美的避开了代码编写样式的雷区，同时指令的支持，也提了模板的有效性。
说明：本节的例子的导出实体类是基于前面的章节的实体类进行使用的，所以看的有点蒙圈的小伙伴可以查看前面的文章：
👇🏻👇🏻👇🏻EasyPoi实战系列：
01.《【EasyPoi实战系列】Spring Boot集成EasyPoi - 第467篇》
02.《【EasyPoi实战系列】Spring Boot使用EasyPoi的注解让表格更漂亮以及图片的导出 - 第468篇》
03.《【EasyPoi实战系列】Spring Boot使用EasyPoi实现一对多的导出 - 第469篇》
04.《【EasyPoi实战系列】Spring Boot使用EasyPoi实现多Sheet导出 - 第470篇》
05.《【EasyPoi实战系列】Spring Boot使用EasyPoi动态控制导出的列 - 第471篇》
06.《100万数据导出，居然爆炸了OutOfMemoryError？【EasyPoi实战系列】- 第472篇》
07.《导出下拉列表的两种小技巧【EasyPoi实战系列】- 第473篇》
08.《数据脱敏/换行/枚举的处理【EasyPoi实战系列】- 第474篇》
一、EasyPoi支持的指令
EasyPoi支持的指令以及作用，最主要的就是各种fe的用法：
· 空格分割
· 三目运算 {{test ? obj:obj2}}" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/05d32ad09d8d49ab61aaf17b79ca4b2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-21T09:35:17+08:00" />
<meta property="article:modified_time" content="2023-06-21T09:35:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">模板文件导出Excel【EasyPoi实战系列】- 第478篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="img-center"><img alt="" src="https://images2.imgbox.com/e1/77/Vfif0Pw6_o.png"></p> 
<p><strong>​历史文章（<strong>文章</strong>累计470+）</strong></p> 
<p>《<a href="https://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447533342&amp;idx=1&amp;sn=7fe54ec9948ace1c8e1568531d55678b&amp;chksm=843bb90fb34c3019aa7f654da387d30aaf7c14e2798fc1dc846ea05521ba9e8fc108e97c99e9&amp;token=848719710&amp;lang=zh_CN&amp;scene=21#wechat_redirect" rel="nofollow" title="国内最全的Spring Boot系列之一">国内最全的Spring Boot系列之一</a>》</p> 
<p>《<a href="https://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447533861&amp;idx=1&amp;sn=11f6e9afb4cf3ba0aca4330f5b11dc0e&amp;scene=21#wechat_redirect" rel="nofollow" title="国内最全的Spring Boot系列之二">国内最全的Spring Boot系列之二</a>》</p> 
<p>《<a href="https://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447534510&amp;idx=1&amp;sn=05079e6c4a355dfde41cbd36aed36b03&amp;scene=21#wechat_redirect" rel="nofollow" title="国内最全的Spring Boot系列之三">国内最全的Spring Boot系列之三</a>》</p> 
<p>《<a href="https://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447535839&amp;idx=1&amp;sn=21776e7ceee5a705d588e647590cea27&amp;scene=21#wechat_redirect" rel="nofollow" title="国内最全的Spring Boot系列之四">国内最全的Spring Boot系列之四</a>》</p> 
<p>《<a href="http://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447536783&amp;idx=1&amp;sn=82677579faabd7e7bf71756835f5139f&amp;chksm=843bae9eb34c2788a1a02e09850cf973660686a9a541f708e319d8060f97f4483e31b4f7b881&amp;scene=21#wechat_redirect" rel="nofollow" title="国内最全的Spring Boot系列之">国内最全的Spring Boot系列之</a>五》</p> 
<p>《<a href="https://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447537498&amp;idx=1&amp;sn=c267be1701285f7ed2d24ed1054df0a4&amp;scene=21#wechat_redirect" rel="nofollow" title="国内最全的Spring Boot系列之六">国内最全的Spring Boot系列之六</a>》</p> 
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447537976&amp;idx=1&amp;sn=860b231e997c0235d1b74d51128ec1e3&amp;chksm=843bab29b34c223f6c6dc8eeba10eaec3d8d2488469aa67ebe464c41a8b5f8073be6908332ec&amp;scene=21#wechat_redirect" rel="nofollow" title="【EasyPoi实战系列】Spring Boot使用EasyPoi动态控制导出的列 - 第471篇">【EasyPoi实战系列】Spring Boot使用EasyPoi动态控制导出的列 - 第471篇</a></p> 
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447538009&amp;idx=1&amp;sn=42220083684070cbb9343b6a67b74912&amp;chksm=843bab48b34c225e1853861af89d7d92e7c3736bc9d81d5e399899605246df07e752e78285bb&amp;scene=21#wechat_redirect" rel="nofollow" title="100万数据导出，居然爆炸了OutOfMemoryError？【EasyPoi实战系列】- 第472篇">100万数据导出，居然爆炸了OutOfMemoryError？【EasyPoi实战系列】- 第472篇</a></p> 
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447538040&amp;idx=1&amp;sn=ea5e3371cc435b4136afb5ec91969e4a&amp;chksm=843bab69b34c227fa48ee48ecb46229863dc24159ac82fffab05e62cf1bdc8c2073b561aa75f&amp;scene=21#wechat_redirect" rel="nofollow" title="导出下拉列表的两种小技巧【EasyPoi实战系列】- 第473篇">导出下拉列表的两种小技巧【EasyPoi实战系列】- 第473篇</a></p> 
<p><a href="http://mp.weixin.qq.com/s?__biz=MzA4ODIyMzEwMg==&amp;mid=2447538051&amp;idx=1&amp;sn=1fc031911b6b8060ae325a2f5b3d0dea&amp;chksm=843bab92b34c2284157e8188a8761c597ef3584babc00bf8fc0389fc38c559be2a2cea10f37b&amp;scene=21#wechat_redirect" rel="nofollow" title="数据脱敏/换行/枚举的处理【EasyPoi实战系列】- 第474篇">数据脱敏/换行/枚举的处理【EasyPoi实战系列】- 第474篇</a></p> 
<p></p> 
<p>悟纤：师傅，我发现一个挺麻烦的问题。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/29/cc/sJqHcPXM_o.png"></p> 
<p>师傅：怎么说？</p> 
<p>悟纤：就是这个很多时候，这个Excel的样式是很复杂的，用代码生成Excel的方式对于处理比较复杂的样式，就有点爱莫能助。</p> 
<p>师傅：这个时候，使用模板导出的方式就很有必要了，定义好一个模板，然后使用类似el表达的方式指定单元格的位置，这样样式就可以在模板文件进行编辑了。</p> 
<p>悟纤：如果可以这么实现真的是再好不过了，师傅我已经按耐不住了，赶紧带我飞。</p> 
<p>师傅：扶好把手，准备启程。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/76/75/PjBtojoe_o.png"></p> 
<p></p> 
<p></p> 
<p><strong>导读</strong></p> 
<p>Hi，大家好，我是<strong>悟纤</strong>。</p> 
<p>我就是我，不一样的烟火。我就是我，与众不同的小苹果。</p> 
<p></p> 
<p><strong>模板是处理复杂</strong>Excel的简单方法，复杂的Excel样式，可以用Excel直接编辑，完美的避开了代码编写样式的雷区，同时指令的支持，也提了模板的有效性。</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/ac/eb/aPPK7cYp_o.png"></p> 
<p></p> 
<p><strong>说明</strong>：本节的例子的导出实体类是基于前面的章节的实体类进行使用的，所以看的有点蒙圈的小伙伴可以查看前面的文章：</p> 
<p>👇🏻👇🏻👇🏻<strong>EasyPoi</strong><strong>实战系列</strong>：</p> 
<p>01.《【EasyPoi实战系列】Spring Boot集成EasyPoi - 第467篇》</p> 
<p>02.《【EasyPoi实战系列】Spring Boot使用EasyPoi的注解让表格更漂亮以及图片的导出 - 第468篇》</p> 
<p>03.《【EasyPoi实战系列】Spring Boot使用EasyPoi实现一对多的导出 - 第469篇》</p> 
<p>04.《【EasyPoi实战系列】Spring Boot使用EasyPoi实现多Sheet导出 - 第470篇》</p> 
<p>05.《【EasyPoi实战系列】Spring Boot使用EasyPoi动态控制导出的列 - 第471篇》</p> 
<p>06.《100万数据导出，居然爆炸了OutOfMemoryError？【EasyPoi实战系列】- 第472篇》</p> 
<p>07.《导出下拉列表的两种小技巧【EasyPoi实战系列】- 第473篇》</p> 
<p>08.《数据脱敏/换行/枚举的处理【EasyPoi实战系列】- 第474篇》</p> 
<p></p> 
<p></p> 
<p><strong>一、EasyPoi支持的指令</strong></p> 
<p>EasyPoi支持的指令以及作用，最主要的就是各种fe的用法：</p> 
<p>· 空格分割</p> 
<p>· 三目运算 {<!-- -->{test ? obj:obj2}}</p> 
<p>· n: 表示 这个cell是数值类型 {<!-- -->{n:}}</p> 
<p>· le: 代表长度{<!-- -->{le:()}} 在if/else 运用{<!-- -->{le:() &gt; 8 ? obj1 : obj2}}</p> 
<p>· fd: 格式化时间 {<!-- -->{fd:(obj;yyyy-MM-dd)}}</p> 
<p>· fn: 格式化数字 {<!-- -->{fn:(obj;###.00)}}</p> 
<p>· fe: 遍历数据,创建row</p> 
<p>· !fe: 遍历数据不创建row</p> 
<p>· $fe: 下移插入,把当前行,下面的行全部下移.size()行,然后插入</p> 
<p>· #fe: 横向遍历</p> 
<p>· v_fe: 横向遍历值</p> 
<p>· !if: 删除当前列 {<!-- -->{!if:(test)}}</p> 
<p>· 单引号表示常量值 ‘’ 比如’1’ 那么输出的就是 1</p> 
<p>· &amp;NULL&amp; 空格</p> 
<p>· &amp;INDEX&amp; 表示循环中的序号,自动添加</p> 
<p>· ]] 换行符 多行遍历导出</p> 
<p>· sum： 统计数据</p> 
<p>· cal: 基础的+-X% 计算</p> 
<p>· dict: 字典</p> 
<p>· i18n: 国际化</p> 
<p><strong>二、模板基本导出</strong></p> 
<p>看一个常见的到处模板–专项支出用款申请书：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/f3/d2/8VZJvDMZ_o.png"></p> 
<p></p> 
<p>这里面有正常的标签以及$fe遍历，$fe遍历应该是使用最广的遍历，用来解决遍历后下面还有数据的处理方式，我们要生成的是这个需要一些list集合和一些单纯的数据。</p> 
<p>fe的写法 fe标志 冒号 list数据 单个元素数据（默认t，可以不写） 第一个元素</p> 
<p>{<!-- -->{$fe: maplist t t.id }}</p> 
<p>看下数据代码，主要是构造数据TemplateExportParams是主要的参数数据：</p> 
<pre><code>/**</code><code> * 模板导出</code><code> * /demoTemplate/exportExcel</code><code> * @param response</code><code> */</code><code>@GetMapping("/exportExcel")</code><code>public void exportExcel(HttpServletResponse response) throws IOException {<!-- --></code><code>    TemplateExportParams params = new TemplateExportParams(</code><code>            "WEB-INF/doc/专项支出用款申请书_map.xls");</code><code>​</code><code>    Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();</code><code>    map.put("date", "2014-12-25");//申请日期.</code><code>    map.put("money", 2000000.00);//合计</code><code>    map.put("upperMoney", "贰佰万");//核定金额合计（大写）</code><code>    map.put("company", "悟纤科技有限公司");//申请支付单位</code><code>    map.put("bureau", "财政局");//××局</code><code>    map.put("person", "悟纤");//联系人</code><code>    map.put("phone", "1388888****");//联系电话</code><code>    List&lt;Map&lt;String, String&gt;&gt; listMap = new ArrayList&lt;Map&lt;String, String&gt;&gt;();</code><code>    for (int i = 0; i &lt; 4; i++) {<!-- --></code><code>        Map&lt;String, String&gt; lm = new HashMap&lt;&gt;();</code><code>        lm.put("id", i + 1 + "");</code><code>        lm.put("zijin", i * 10000 + "");</code><code>        lm.put("bianma", "A001");//编码</code><code>        lm.put("mingcheng", "设计");//名称</code><code>        lm.put("xiangmumingcheng", "EasyPoi " + i + "期");//项目名称</code><code>        lm.put("quancheng", "开源项目");//全称</code><code>        lm.put("sqje", i * 10000 + "");//申请金额</code><code>        lm.put("hdje", i * 10000 + "");//核定金额</code><code>​</code><code>        listMap.add(lm);</code><code>    }</code><code>    map.put("maplist", listMap);</code><code>​</code><code>    Workbook workbook = ExcelExportUtil.exportExcel(params, map);</code><code>    ExcelUtil.downLoadExcel("专项支出用款申请书.xlsx",response,workbook);</code><code>}</code><code>​</code></pre> 
<p>说明：要准备模板文件《专项支出用款申请书_map.xls》</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e2/aa/epf0BExR_o.png"></p> 
<p>输出的效果：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e4/3d/AYcc9L6i_o.png"></p> 
<pre><code>我就是我，是颜色不一样的烟火。
我就是我，是与众不同的小苹果。</code></pre> 
<p></p> 
<p>à悟纤学院：https://t.cn/Rg3fKJD</p> 
<p>学院中有<strong>Spring Boot</strong>相关的课程！点击「<strong>阅读原文</strong>」进行查看！</p> 
<p>SpringBoot视频：http://t.cn/A6ZagYTi</p> 
<p>SpringBoot交流平台：https://t.cn/R3QDhU0</p> 
<p>SpringSecurity5.0视频：http://t.cn/A6ZadMBe</p> 
<p>ShardingJDBC分库分表：http://t.cn/A6ZarrqS</p> 
<p>分布式事务解决方案：http://t.cn/A6ZaBnIr</p> 
<p>JVM内存模型调优实战：http://t.cn/A6wWMVqG</p> 
<p>Spring入门到精通：https://t.cn/A6bFcDh4</p> 
<p>大话设计模式之爱你：https://dwz.cn/wqO0MAy7</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b95a5bcff6393d99c713fa9ad2d47a95/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">图片转为ASCII字符画的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/343f2b1150e145fa01a25bcf9b2de0c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python代码示例，可以生成烟花表演效果</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>