<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于ATT-ABCNet 改进CRNN的火车票实时识别系统 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于ATT-ABCNet 改进CRNN的火车票实时识别系统" />
<meta property="og:description" content="1.研究背景与意义 项目参考AAAI Association for the Advancement of Artificial Intelligence
研究背景与意义
随着科技的不断发展，人工智能技术在各个领域得到了广泛的应用。其中，图像识别技术在实际生活中的应用越来越广泛，其中之一就是火车票实时识别系统。火车票实时识别系统可以通过识别火车票上的信息，实现自动化的售票、验票等功能，提高了火车站的工作效率，方便了乘客的出行。
然而，火车票实时识别系统面临着一些挑战。首先，火车票的样式和格式多种多样，包括不同的颜色、字体、布局等。这使得传统的基于规则的方法很难适应各种不同的火车票样式。其次，火车票上的信息需要高精度的识别，以确保售票和验票的准确性。然而，由于火车票上的信息通常是印刷体，存在一定的模糊和变形，这增加了识别的难度。因此，开发一种高效准确的火车票实时识别系统对于提高火车站的工作效率和服务质量具有重要意义。
近年来，深度学习技术在图像识别领域取得了巨大的突破。其中，卷积神经网络（Convolutional Neural Network，CNN）和循环神经网络（Recurrent Neural Network，RNN）是两种常用的深度学习模型。CNN可以有效地提取图像的特征，而RNN可以处理序列数据，适用于文本识别任务。因此，将CNN和RNN相结合的CRNN模型成为了文本识别领域的研究热点。
然而，传统的CRNN模型在火车票实时识别任务中存在一些问题。首先，传统的CRNN模型对于小尺寸的文本识别效果较差，而火车票上的信息通常较小。其次，传统的CRNN模型对于文本的上下文信息利用不充分，导致识别准确率不高。因此，有必要对CRNN模型进行改进，以提高火车票实时识别系统的性能。
基于以上背景和问题，本研究旨在基于ATT-ABCNet改进CRNN模型，实现高效准确的火车票实时识别系统。具体来说，本研究将引入注意力机制（Attention Mechanism）和自适应二维卷积（Adaptive 2D Convolution）来改进CRNN模型。注意力机制可以帮助模型更好地关注文本的重要部分，提高识别准确率。自适应二维卷积可以适应不同尺寸的文本，提高模型对小尺寸文本的识别效果。
本研究的意义主要体现在以下几个方面。首先，通过改进CRNN模型，可以提高火车票实时识别系统的准确性和鲁棒性，提高火车站的工作效率和服务质量。其次，本研究引入的注意力机制和自适应二维卷积可以为其他文本识别任务提供借鉴和参考，拓展了深度学习在文本识别领域的应用。最后，本研究对于推动火车站数字化转型，提高火车站信息化水平具有重要意义。
综上所述，基于ATT-ABCNet改进CRNN的火车票实时识别系统的研究具有重要的背景和意义，对于提高火车站的工作效率和服务质量具有积极的影响。
2.图片演示 3.视频演示 基于ATT-ABCNet 改进CRNN的火车票实时识别系统
4.ABCNet 模型文本识别模型 ABCNet 模型框架 ABCNet模型的网络架构如图3.1所示，模型主要由检测模块、贝塞尔网络以及识别模块组成。检测模块利用ResNet-50作为主干网络，使用FPN融合特征图，并在此基础上预测文本框的位置信息。在回归坐标点时，输入进基于贝塞尔曲线检测算法的 anchor-free 网络，使用坐标点的参数信息对图像中的文本形成文本框。ABCNet模型的识别模块包括六个卷积层、BLSTM网络和CTC层，属于轻量级的识别分支，这样可以保证模型的识别速度。
ABCNet模型采用的贝塞尔曲线检测网络，使其代替传统长方形文本框，对任意形状的文本进行拟合，实现自适应的对图像中的文本进行检测。贝塞尔曲线的计算公式如下，主要由一系列支点b,和关于t的参数方程表示，详见公式4.1和 4.2所示。
其中n为贝塞尔曲线的阶数，因为b的指数是从О开始，所以这里的支点个数为n&#43;1。参数t由0至1进行演化，形成了一条完整的曲线。曲线上的任意一点T(t)的坐标，就是由曲线上全部支点坐标的加权平均值计算得到，T(t)的权重是上述公式中的B。B的方程在数学中叫做伯恩斯坦多项式(Bernstein polynomials）[51l，它也是t的函数，也由支点决定。
基于深度学习的自然场景文本识别算法改进框利用贝塞尔曲线回归，短边是直线段。ABCNet模型使用三阶贝塞尔曲线，每边有四个支点，上下两条曲线需要的总共八个支点坐标，就是检测网络预测的目标。由于采用贝塞尔曲线网络并不会增加太多的参数，因此后续在模型改进时保留了这一部分，在其检测模块和识别模块进行改进。
5.核心代码讲解 5.1 collect_env.py 根据代码，我将其封装为一个名为EnvironmentInfo的类，其中包含一个静态方法collect_env_info用于收集环境信息。
class EnvironmentInfo: @staticmethod def collect_env_info(): def collect_torch_env(): try: import torch.__config__ return torch.__config__.show() except ImportError: # compatible with older versions of pytorch from torch.utils.collect_env import get_pretty_env_info return get_pretty_env_info() def get_env_module(): var_name = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7127d2bb56dec2b41d7ed441752a9a15/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-07T10:50:53+08:00" />
<meta property="article:modified_time" content="2023-11-07T10:50:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于ATT-ABCNet 改进CRNN的火车票实时识别系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_1"></a>1.研究背景与意义</h2> 
<p>项目参考<a href="https://www.zhihu.com/people/2-38-73-10/posts" rel="nofollow">AAAI Association for the Advancement of Artificial Intelligence</a></p> 
<p>研究背景与意义</p> 
<p>随着科技的不断发展，人工智能技术在各个领域得到了广泛的应用。其中，图像识别技术在实际生活中的应用越来越广泛，其中之一就是火车票实时识别系统。火车票实时识别系统可以通过识别火车票上的信息，实现自动化的售票、验票等功能，提高了火车站的工作效率，方便了乘客的出行。</p> 
<p>然而，火车票实时识别系统面临着一些挑战。首先，火车票的样式和格式多种多样，包括不同的颜色、字体、布局等。这使得传统的基于规则的方法很难适应各种不同的火车票样式。其次，火车票上的信息需要高精度的识别，以确保售票和验票的准确性。然而，由于火车票上的信息通常是印刷体，存在一定的模糊和变形，这增加了识别的难度。因此，开发一种高效准确的火车票实时识别系统对于提高火车站的工作效率和服务质量具有重要意义。</p> 
<p>近年来，深度学习技术在图像识别领域取得了巨大的突破。其中，卷积神经网络（Convolutional Neural Network，CNN）和循环神经网络（Recurrent Neural Network，RNN）是两种常用的深度学习模型。CNN可以有效地提取图像的特征，而RNN可以处理序列数据，适用于文本识别任务。因此，将CNN和RNN相结合的CRNN模型成为了文本识别领域的研究热点。</p> 
<p>然而，传统的CRNN模型在火车票实时识别任务中存在一些问题。首先，传统的CRNN模型对于小尺寸的文本识别效果较差，而火车票上的信息通常较小。其次，传统的CRNN模型对于文本的上下文信息利用不充分，导致识别准确率不高。因此，有必要对CRNN模型进行改进，以提高火车票实时识别系统的性能。</p> 
<p>基于以上背景和问题，本研究旨在基于ATT-ABCNet改进CRNN模型，实现高效准确的火车票实时识别系统。具体来说，本研究将引入注意力机制（Attention Mechanism）和自适应二维卷积（Adaptive 2D Convolution）来改进CRNN模型。注意力机制可以帮助模型更好地关注文本的重要部分，提高识别准确率。自适应二维卷积可以适应不同尺寸的文本，提高模型对小尺寸文本的识别效果。</p> 
<p>本研究的意义主要体现在以下几个方面。首先，通过改进CRNN模型，可以提高火车票实时识别系统的准确性和鲁棒性，提高火车站的工作效率和服务质量。其次，本研究引入的注意力机制和自适应二维卷积可以为其他文本识别任务提供借鉴和参考，拓展了深度学习在文本识别领域的应用。最后，本研究对于推动火车站数字化转型，提高火车站信息化水平具有重要意义。</p> 
<p>综上所述，基于ATT-ABCNet改进CRNN的火车票实时识别系统的研究具有重要的背景和意义，对于提高火车站的工作效率和服务质量具有积极的影响。</p> 
<h2><a id="2_22"></a>2.图片演示</h2> 
<p><img src="https://images2.imgbox.com/69/2e/jshe3oyB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f2/06/6kbtUwGP_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/41/7f/xse3GndR_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_27"></a>3.视频演示</h2> 
<p><a href="https://www.bilibili.com/video/BV1FQ4y1n7Eh/?spm_id_from=333.999.0.0&amp;vd_source=ff015de2d29cbe2a9cdbfa7064407a08" rel="nofollow">基于ATT-ABCNet 改进CRNN的火车票实时识别系统</a></p> 
<h2><a id="4ABCNet__30"></a>4.ABCNet 模型文本识别模型</h2> 
<h5><a id="ABCNet__31"></a>ABCNet 模型框架</h5> 
<p>ABCNet模型的网络架构如图3.1所示，模型主要由检测模块、贝塞尔网络以及识别模块组成。检测模块利用ResNet-50作为主干网络，使用FPN融合特征图，并在此基础上预测文本框的位置信息。在回归坐标点时，输入进基于贝塞尔曲线检测算法的 anchor-free 网络，使用坐标点的参数信息对图像中的文本形成文本框。ABCNet模型的识别模块包括六个卷积层、BLSTM网络和CTC层，属于轻量级的识别分支，这样可以保证模型的识别速度。<br> ABCNet模型采用的贝塞尔曲线检测网络，使其代替传统长方形文本框，对任意形状的文本进行拟合，实现自适应的对图像中的文本进行检测。贝塞尔曲线的计算公式如下，主要由一系列支点b,和关于t的参数方程表示，详见公式4.1和 4.2所示。<br> <img src="https://images2.imgbox.com/0f/25/4FBppnJc_o.png" alt="在这里插入图片描述"></p> 
<p>其中n为贝塞尔曲线的阶数，因为b的指数是从О开始，所以这里的支点个数为n+1。参数t由0至1进行演化，形成了一条完整的曲线。曲线上的任意一点T(t)的坐标，就是由曲线上全部支点坐标的加权平均值计算得到，T(t)的权重是上述公式中的B。B的方程在数学中叫做伯恩斯坦多项式(Bernstein polynomials）[51l，它也是t的函数，也由支点决定。<br> <img src="https://images2.imgbox.com/e1/c1/UpOx4xzW_o.png" alt="在这里插入图片描述"></p> 
<p>基于深度学习的自然场景文本识别算法改进框利用贝塞尔曲线回归，短边是直线段。ABCNet模型使用三阶贝塞尔曲线，每边有四个支点，上下两条曲线需要的总共八个支点坐标，就是检测网络预测的目标。由于采用贝塞尔曲线网络并不会增加太多的参数，因此后续在模型改进时保留了这一部分，在其检测模块和识别模块进行改进。</p> 
<h2><a id="5_42"></a>5.核心代码讲解</h2> 
<h5><a id="51_collect_envpy_44"></a>5.1 collect_env.py</h5> 
<p>根据代码，我将其封装为一个名为<code>EnvironmentInfo</code>的类，其中包含一个静态方法<code>collect_env_info</code>用于收集环境信息。</p> 
<pre><code class="prism language-python">

<span class="token keyword">class</span> <span class="token class-name">EnvironmentInfo</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">collect_env_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">collect_torch_env</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">import</span> torch<span class="token punctuation">.</span>__config__

                <span class="token keyword">return</span> torch<span class="token punctuation">.</span>__config__<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
                <span class="token comment"># compatible with older versions of pytorch</span>
                <span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>collect_env <span class="token keyword">import</span> get_pretty_env_info

                <span class="token keyword">return</span> get_pretty_env_info<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">get_env_module</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            var_name <span class="token operator">=</span> <span class="token string">"DETECTRON2_ENV_MODULE"</span>
            <span class="token keyword">return</span> var_name<span class="token punctuation">,</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span>var_name<span class="token punctuation">,</span> <span class="token string">"&lt;not set&gt;"</span><span class="token punctuation">)</span>

        <span class="token keyword">def</span> <span class="token function">detect_compute_compatibility</span><span class="token punctuation">(</span>CUDA_HOME<span class="token punctuation">,</span> so_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                cuobjdump <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>CUDA_HOME<span class="token punctuation">,</span> <span class="token string">"bin"</span><span class="token punctuation">,</span> <span class="token string">"cuobjdump"</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>cuobjdump<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    output <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span>
                        <span class="token string">"'{}' --list-elf '{}'"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cuobjdump<span class="token punctuation">,</span> so_file<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span>
                    <span class="token punctuation">)</span>
                    output <span class="token operator">=</span> output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
                    sm <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                    <span class="token keyword">for</span> line <span class="token keyword">in</span> output<span class="token punctuation">:</span>
                        line <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"\.sm_[0-9]*\."</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                        sm<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    sm <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>sm<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>sm<span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> so_file <span class="token operator">+</span> <span class="token string">"; cannot find cuobjdump"</span>
            <span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
                <span class="token comment"># unhandled failure</span>
                <span class="token keyword">return</span> so_file

        has_gpu <span class="token operator">=</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># true for both CUDA &amp; ROCM</span>
        torch_version <span class="token operator">=</span> torch<span class="token punctuation">.</span>__version__

        <span class="token comment"># NOTE: the use of CUDA_HOME and ROCM_HOME requires the CUDA/ROCM build deps, though in</span>
        <span class="token comment"># theory detectron2 should be made runnable with only the corresponding runtimes</span>
        <span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>cpp_extension <span class="token keyword">import</span> CUDA_HOME

        has_rocm <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> torch_version<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>cpp_extension <span class="token keyword">import</span> ROCM_HOME

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>version<span class="token punctuation">,</span> <span class="token string">"hip"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>ROCM_HOME <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                has_rocm <span class="token operator">=</span> <span class="token boolean">True</span>
        has_cuda <span class="token operator">=</span> has_gpu <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token keyword">not</span> has_rocm<span class="token punctuation">)</span>

        data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"sys.platform"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>platform<span class="token punctuation">)</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Python"</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>version<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"numpy"</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">import</span> detectron2  <span class="token comment"># noqa</span>

            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                <span class="token punctuation">(</span><span class="token string">"detectron2"</span><span class="token punctuation">,</span> detectron2<span class="token punctuation">.</span>__version__ <span class="token operator">+</span> <span class="token string">" @"</span> <span class="token operator">+</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>detectron2<span class="token punctuation">.</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"detectron2"</span><span class="token punctuation">,</span> <span class="token string">"failed to import"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">from</span> detectron2 <span class="token keyword">import</span> _C
        <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"detectron2._C"</span><span class="token punctuation">,</span> <span class="token string">"failed to import"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment"># print system compilers when extension fails to build</span>
            <span class="token keyword">if</span> sys<span class="token punctuation">.</span>platform <span class="token operator">!=</span> <span class="token string">"win32"</span><span class="token punctuation">:</span>  <span class="token comment"># don't know what to do for windows</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    <span class="token comment"># this is how torch/utils/cpp_extensions.py choose compiler</span>
                    cxx <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"CXX"</span><span class="token punctuation">,</span> <span class="token string">"c++"</span><span class="token punctuation">)</span>
                    cxx <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"'{}' --version"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cxx<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
                    cxx <span class="token operator">=</span> cxx<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token keyword">except</span> subprocess<span class="token punctuation">.</span>SubprocessError<span class="token punctuation">:</span>
                    cxx <span class="token operator">=</span> <span class="token string">"Not found"</span>
                data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Compiler"</span><span class="token punctuation">,</span> cxx<span class="token punctuation">)</span><span class="token punctuation">)</span>

                <span class="token keyword">if</span> has_cuda <span class="token keyword">and</span> CUDA_HOME <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                    <span class="token keyword">try</span><span class="token punctuation">:</span>
                        nvcc <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>CUDA_HOME<span class="token punctuation">,</span> <span class="token string">"bin"</span><span class="token punctuation">,</span> <span class="token string">"nvcc"</span><span class="token punctuation">)</span>
                        nvcc <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"'{}' -V"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>nvcc<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
                        nvcc <span class="token operator">=</span> nvcc<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                    <span class="token keyword">except</span> subprocess<span class="token punctuation">.</span>SubprocessError<span class="token punctuation">:</span>
                        nvcc <span class="token operator">=</span> <span class="token string">"Not found"</span>
                    data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"CUDA compiler"</span><span class="token punctuation">,</span> nvcc<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># print compilers that are used to build extension</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Compiler"</span><span class="token punctuation">,</span> _C<span class="token punctuation">.</span>get_compiler_version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"CUDA compiler"</span><span class="token punctuation">,</span> _C<span class="token punctuation">.</span>get_cuda_version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># cuda or hip</span>
            <span class="token keyword">if</span> has_cuda<span class="token punctuation">:</span>
                data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token string">"detectron2 arch flags"</span><span class="token punctuation">,</span> detect_compute_compatibility<span class="token punctuation">(</span>CUDA_HOME<span class="token punctuation">,</span> _C<span class="token punctuation">.</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>

        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>get_env_module<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"PyTorch"</span><span class="token punctuation">,</span> torch_version <span class="token operator">+</span> <span class="token string">" @"</span> <span class="token operator">+</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"PyTorch debug build"</span><span class="token punctuation">,</span> torch<span class="token punctuation">.</span>version<span class="token punctuation">.</span>debug<span class="token punctuation">)</span><span class="token punctuation">)</span>

        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"GPU available"</span><span class="token punctuation">,</span> has_gpu<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> has_gpu<span class="token punctuation">:</span>
            devices <span class="token operator">=</span> defaultdict<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>device_count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                devices<span class="token punctuation">[</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>get_device_name<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> name<span class="token punctuation">,</span> devids <span class="token keyword">in</span> devices<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"GPU "</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>devids<span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> has_rocm<span class="token punctuation">:</span>
                data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"ROCM_HOME"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ROCM_HOME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"CUDA_HOME"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>CUDA_HOME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

                cuda_arch_list <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"TORCH_CUDA_ARCH_LIST"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> cuda_arch_list<span class="token punctuation">:</span>
                    data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"TORCH_CUDA_ARCH_LIST"</span><span class="token punctuation">,</span> cuda_arch_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Pillow"</span><span class="token punctuation">,</span> PIL<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                <span class="token punctuation">(</span>
                    <span class="token string">"torchvision"</span><span class="token punctuation">,</span>
                    <span class="token builtin">str</span><span class="token punctuation">(</span>torchvision<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" @"</span> <span class="token operator">+</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>torchvision<span class="token punctuation">.</span>__file__<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">if</span> has_cuda<span class="token punctuation">:</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    torchvision_C <span class="token operator">=</span> importlib<span class="token punctuation">.</span>util<span class="token punctuation">.</span>find_spec<span class="token punctuation">(</span><span class="token string">"torchvision._C"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>origin
                    msg <span class="token operator">=</span> detect_compute_compatibility<span class="token punctuation">(</span>CUDA_HOME<span class="token punctuation">,</span> torchvision_C<span class="token punctuation">)</span>
                    data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"torchvision arch flags"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
                    data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"torchvision._C"</span><span class="token punctuation">,</span> <span class="token string">"failed to find"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> AttributeError<span class="token punctuation">:</span>
            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"torchvision"</span><span class="token punctuation">,</span> <span class="token string">"unknown"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">import</span> fvcore

            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"fvcore"</span><span class="token punctuation">,</span> fvcore<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">import</span> cv2

            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"cv2"</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        env_str <span class="token operator">=</span> tabulate<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span>
        env_str <span class="token operator">+=</span> collect_torch_env<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> env_str

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">import</span> detectron2  <span class="token comment"># noqa</span>
    <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>EnvironmentInfo<span class="token punctuation">.</span>collect_env_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">from</span> detectron2<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>collect_env <span class="token keyword">import</span> collect_env_info

        <span class="token keyword">print</span><span class="token punctuation">(</span>collect_env_info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>该程序文件名为collect_env.py，主要功能是收集环境信息。程序首先导入了一些必要的库，包括importlib、numpy、os、re、subprocess、sys、collections、PIL、torch、torchvision和tabulate。然后定义了一个collect_torch_env函数，用于收集torch环境信息。接下来定义了一个get_env_module函数，用于获取环境变量DETECTRON2_ENV_MODULE的值。然后定义了一个detect_compute_compatibility函数，用于检测CUDA环境的兼容性。最后定义了一个collect_env_info函数，用于收集整个环境信息。在该函数中，首先判断是否有GPU可用，并获取torch的版本号。然后收集一些基本的环境信息，如sys.platform、Python版本和numpy版本。接着尝试导入detectron2库，并获取其版本号和路径。如果导入失败，则打印收集到的环境信息。如果导入成功，则继续导入detectron2.utils.collect_env模块，并打印收集到的环境信息。最后，在程序的主函数中，首先尝试导入detectron2库，如果导入失败，则打印收集到的环境信息。如果导入成功，则调用collect_env_info函数，并打印收集到的环境信息。</p> 
<h5><a id="52_demopy_220"></a>5.2 demo.py</h5> 
<pre><code class="prism language-python">
<span class="token keyword">class</span> <span class="token class-name">OCRProcessor</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">"KMP_DUPLICATE_LIB_OK"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"TRUE"</span>

    <span class="token keyword">def</span> <span class="token function">single_pic_proc</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> image_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        image <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_file<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">'RGB'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        result<span class="token punctuation">,</span> image_framed <span class="token operator">=</span> ocr<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
        <span class="token keyword">return</span> result<span class="token punctuation">,</span> image_framed

    <span class="token keyword">def</span> <span class="token function">process_images</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> image_dir<span class="token punctuation">,</span> result_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        image_files <span class="token operator">=</span> glob<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>image_dir<span class="token punctuation">,</span> <span class="token string">'*.*'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> image_file <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>image_files<span class="token punctuation">)</span><span class="token punctuation">:</span>
            t <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>image_file<span class="token punctuation">)</span>
            result<span class="token punctuation">,</span> image_framed <span class="token operator">=</span> self<span class="token punctuation">.</span>single_pic_proc<span class="token punctuation">(</span>image_file<span class="token punctuation">)</span>
            output_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>result_dir<span class="token punctuation">,</span> image_file<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>output_file<span class="token punctuation">)</span>
            txt_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>result_dir<span class="token punctuation">,</span> image_file<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.txt'</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>txt_file<span class="token punctuation">)</span>
            txt_f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>txt_file<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
            Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>image_framed<span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span>output_file<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Mission complete, it took {:.3f}s"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nRecognition Result:\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> key <span class="token keyword">in</span> result<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                txt_f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>result<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
            txt_f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


</code></pre> 
<p>这个程序文件名为demo.py，它的功能是对指定文件夹中的图片进行OCR识别，并将识别结果保存到指定文件夹中。</p> 
<p>程序首先导入了所需的库，包括os、ocr、time、shutil、numpy和PIL。然后设置了环境变量。</p> 
<p>接下来定义了一个函数single_pic_proc，用于处理单张图片。该函数首先将图片转换为RGB格式的数组，然后调用OCR函数进行识别，返回识别结果和带有识别框的图片。</p> 
<p>在主程序中，首先使用glob函数获取指定文件夹中的所有图片文件路径，并指定了结果保存的文件夹路径。然后遍历每个图片文件，对每个文件调用single_pic_proc函数进行处理。</p> 
<p>处理过程中，程序会打印当前处理的图片文件路径，并计算处理时间。然后将带有识别框的图片保存到结果文件夹中，并根据图片文件名生成对应的txt文件路径。</p> 
<p>接下来，程序会打印识别结果，并将结果写入到对应的txt文件中。</p> 
<p>最后，程序会关闭txt文件，打印处理完成的信息，并继续处理下一张图片。</p> 
<h2><a id="6_271"></a>6.系统整体结构</h2> 
<p>以下是每个文件的功能概述：</p> 
<table><thead><tr><th>文件路径</th><th>功能概述</th></tr></thead><tbody><tr><td>collect_env.py</td><td>收集环境信息</td></tr><tr><td>demo.py</td><td>对指定文件夹中的图片进行OCR识别</td></tr><tr><td>ocr.py</td><td>进行OCR（光学字符识别）</td></tr><tr><td>pytorch_on_gpu.py</td><td>在GPU上运行PyTorch代码</td></tr><tr><td>setup.py</td><td>安装AdelaiDet软件包</td></tr><tr><td>test_one.py</td><td>处理单张图片进行OCR识别</td></tr><tr><td>test_pth.py</td><td>对模型进行测试</td></tr><tr><td>ui.py</td><td>用户界面相关功能</td></tr><tr><td>adet_<em>init</em>_.py</td><td>AdelaiDet软件包的初始化文件</td></tr><tr><td>adet\checkpoint\adet_checkpoint.py</td><td>检查点相关功能</td></tr><tr><td>adet\checkpoint_<em>init</em>_.py</td><td>检查点相关功能</td></tr><tr><td>adet\config\config.py</td><td>配置文件相关功能</td></tr><tr><td>adet\config\defaults.py</td><td>默认配置文件</td></tr><tr><td>adet\config_<em>init</em>_.py</td><td>配置文件相关功能</td></tr><tr><td>adet\data\augmentation.py</td><td>数据增强相关功能</td></tr><tr><td>adet\data\builtin.py</td><td>内置数据集相关功能</td></tr><tr><td>adet\data\dataset_mapper.py</td><td>数据集映射器</td></tr><tr><td>adet\data\detection_utils.py</td><td>检测工具函数</td></tr><tr><td>adet\data_<em>init</em>_.py</td><td>数据相关功能</td></tr><tr><td>adet\data\datasets\text.py</td><td>文本数据集相关功能</td></tr><tr><td>adet\evaluation\rrc_evaluation_funcs.py</td><td>RRC评估函数</td></tr><tr><td>adet\evaluation\text_evaluation.py</td><td>文本评估功能</td></tr><tr><td>adet\evaluation\text_eval_script.py</td><td>文本评估脚本</td></tr><tr><td>adet\evaluation\text_eval_script2.py</td><td>文本评估脚本</td></tr><tr><td>adet\evaluation_<em>init</em>_.py</td><td>评估相关功能</td></tr><tr><td>adet\layers\bezier_align.py</td><td>Bezier对齐层</td></tr><tr><td>adet\layers\conv_with_kaiming_uniform.py</td><td>带有Kaiming均匀初始化的卷积层</td></tr></tbody></table> 
<h2><a id="7ABCNet__305"></a>7.ABCNet 模型改进思路</h2> 
<p>ABCNet模型在Total-Text数据集上识别效果部分可视化结果如图所示，图中包含部分错检、漏检的示例。根据ABCNet模型论文的局限分析以及本文复现ABCNet模型测试其在数据集上的检测和识别效果时发现，ABCNet模型存在仍然有两点局限:<br> (1）对于复杂背景下的文本，在检测时会出现漏检、错检，影响检测准确率，同时导致文本识别准确率下降;<br> (2）对于弯曲变形的文本等识别难度大的文本区域，难以准确识别出来。<br> <img src="https://images2.imgbox.com/bd/ad/uCvvQE9M_o.png" alt="在这里插入图片描述"></p> 
<p>本文认为原因主要有以下几点:<br> (1)ABCNet模型特征提取网络生成训练标签时受到图像背景影响，使得特征图的聚焦能力不强，同时模型原本的BLSTM 网络对于长序列的识别，会产生性能问题，因此对于复杂背景下的文本易出现漏检、错检。<br> (2）模型在特征融合过程中采用了传统特征金字塔的策略，但是效果不佳，容易导致特征丢失文本语义特征和边界信息。<br> (3）对于部分弯曲变形的文本，模型前段的检测算法形成的文本检测框没有紧密包围文本，将会影响后续识别网络效果。</p> 
<p>针对上述原因，对ABCNet模型提出如下改进思路:<br> (1) 针对复杂背景下文本，在模型的检测和识别模块中分别引入注意力机制，减轻了自然场景文本复杂背景干扰，缓解原模型在识别含有长文本的自然场景图片时性能较差的问题。<br> (2) 在特征金字塔结构基础上增加特征增强模块，保留底层特征信息和上下文语义信息，提升网络检测效果。<br> (3) 在文本识别网络之前增加空间矫正模块，能够矫正变形的文本，有利于提升后续识别性能。</p> 
<h2><a id="8ATTABCNet__323"></a>8.ATT-ABCNet 模型</h2> 
<p><a href="https://mbd.pub/o/bread/ZZaUmp5u" rel="nofollow">谷歌大脑提出的ATT-ABCNet模型</a>整体架构如图所示。其主要由文本检测模块和文本识别模块两部分组成。检测模块利用ResNet-50作为主干网络，并在此基础上引入注意力机制，使用FPN融合特征图，并在此基础上预测文本框的位置信息。在回归坐标点时，将特征图输入基于贝塞尔曲线检测算法的anchor-free网络，使用坐标点的参数信息对图像中的文本构建文本框。文本识别模块分为Encoder和 Decoder。Encoder主要功能是对输入提取特征，ATT-ABCNet模型的该部分使用卷积层作为特征提取层，再送入BLSTM网络编码特征序列，得到包含文字特征的编码序列。Decoder使用结合注意力机制的LSTM网络结构，生成预测标签。</p> 
<p><img src="https://images2.imgbox.com/52/ab/lupFyjtr_o.png" alt="在这里插入图片描述"></p> 
<p>ATT-ABCNet模型在检测模块引入注意力机制，使得网络能提高对小尺度文本的关注度，关注重要特征并抑制不重要的特征，并有效定位密集型文本，更多的文本语义特征和边界信息得到保留，减少检测复杂背景下的文本时出现漏检的情况;在识别模块采用结合注意力机制的网络，注意力机制能够算出特征的对齐评分来权衡其贡献<br> 基于深度学习的自然场景文本识别算法改进度，并根据不同特征的权重生成概率分布，递归单元根据权重值组合和配置网络中的序列。对序列重构，使输出预测的序列与实际标签更大程度上接近，从而纠正了在检测复杂背景中的文本时容易出现的文本错检，并缓解了BLSTM网络在长序列文本识别任务中的性能下降。</p> 
<h5><a id="_331"></a>文本检测模块</h5> 
<p>ATT-ABCNet模型在文本检测模块的主干网络，采用ResNet 与注意力机制结合的结构，分别引入通道注意力SENet以及混合注意力CBAM两种注意力模块，融入ResNet网络形成新的网络结构，通过分配不同的特征以权重，可以区分不同特征的重要性。在该模块对比SENet和 CBAM注意力对残差网络的增益效果。再通过特征金字塔网络进行自顶向下融合特征，将得到的特征图送入贝塞尔曲线检测网络模块，通<br> 过anchor-free网络回归坐标点，使用坐标点的参数信息对图像中的文本形成文本框，得到输出结果。<br> ATT-ABCNet模型的文本检测模块去除了区域选择、非文本区域过滤、文本后处理等中间环节，从而实现文本位置的自动定位。从而缩短了计算时间，并能处理词级和行级别的文本。引入注意力机制模块，使得改进后的网络关注重要特征，并抑制不重要的特征，能有效地从不同规模的文本中抽取特征，从而降低背景信息的干扰。改善了检测背景复杂图像文本时常常在生成训练标签时受到图像背景影响，使得特征图的聚焦能力不强，导致学习的文本区域特征不完整，造成文本漏检的问题。</p> 
<p><img src="https://images2.imgbox.com/be/e1/xygp2bia_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_337"></a>文本识别模块</h5> 
<p>ATT-ABCNet模型的文本识别模块将原模型循环层的BLSTM 网络替换为LSTM与注意力机制结合的网络结构，卷积层保留原本的CNN 以及 BLSTM 网络。文本识别模块由卷积层，BLSTM层和结合注意力机制的LSTM层组成。卷积层主要用于提取特征，并通过BLSTM层将特征向量编码为特征序列，注意力机制利用BLSTM 网络的输出计算权重和文本向量，再由LSTM和注意力层对输入的特征序列进行解码，注意力机制的作用是计算特征的贡献度，并根据不同特征的权重生成概率分布，递归单元根据权重值组合和配置网络中的序列。对序列重构，使输出预测的序列与实际标签更大程度上接近，从而生成较为精准的预测标签。<br> <img src="https://images2.imgbox.com/71/2d/NzWjnFaC_o.png" alt="在这里插入图片描述"></p> 
<p>为了提升ATT-ABCNet模型文本识别模块的性能，AAAI选择了引入常与神经网络相结合使用的 <a href="https://afdian.net/item/d9d37b7e7c8211eeae2a52540025c377" rel="nofollow">Luong注意力和 Bahdanau注意力机制</a>。在此基础上，对比了两种注意力对LSTM网络的增益效果，选择更适用于文本序列识别的注意力机制用于构建ATT-ABCNet模型。注意力机制与文本识别模块LSTM网络的结合，改善了复杂背景下的文本容易在检测时产生的错检问题，同时对循环神经网络在识别长序列文本会出现性能下降的问题也有所缓解，提升了场景文本识别的准确率。</p> 
<h2><a id="9_343"></a>9.训练结果分析</h2> 
<h5><a id="_344"></a>算法性能指标解释</h5> 
<p>精确率（Precision）：此指标衡量的是算法检测到的正确文本数量占算法认为是文本的总数量的比例。高精确率意味着较少的误报。</p> 
<p>召回率（Recall）：召回率衡量的是算法正确检测到的文本数量占实际文本总数的比例。高召回率表明算法能够捕捉到更多的真实文本。</p> 
<p>F测量（F-measure）：F分数是精确率和召回率的调和平均，是评估算法整体性能的重要指标，平衡了精确率和召回率的权衡。</p> 
<h5><a id="ATTABCNet_351"></a>ATT-ABCNet算法与增强版对比</h5> 
<p>基础版ATT-ABCNet性能<br> 在Total Text数据集上，该算法展示出较为平衡的精确率和召回率，但仍有提升空间。</p> 
<p>在CTW1500数据集上，尽管精确率略高，但召回率有所下降，这可能意味着算法对于长文本行的检测能力不如对于多样形态文本的检测。<br> <img src="https://images2.imgbox.com/ae/cc/pP5EKYWH_o.png" alt="在这里插入图片描述"></p> 
<p>增强版ATT-ABCNet性能<br> 增强版在Total Text数据集上的精确率和召回率都有明显提升，说明算法对于多样形态文本的检测能力增强。<br> <img src="https://images2.imgbox.com/95/eb/IRXvjazl_o.png" alt="在这里插入图片描述"></p> 
<p>在CTW1500数据集上，增强版同样表现出更好的精确率和召回率，尤其是在精确率上的提升更为突出，这表明算法在减少误报方面取得了进步。<br> <img src="https://images2.imgbox.com/d1/68/aRkPhkda_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_365"></a>性能提升的分析</h5> 
<p>增强版算法可能引入了新的特征提取机制，如改进的卷积神经网络架构，更有效的特征融合技术或是更先进的后处理步骤。</p> 
<p>算法可能通过更复杂的数据预处理和增强，能更好地处理文本的变形和遮挡问题。</p> 
<p>增强版算法也可能使用了更深的网络结构或更复杂的优化策略，例如注意力机制的改进，来更好地聚焦于文本特征。</p> 
<p>性能提升表明了持续算法创新的重要性。通过持续的迭代和改进，算法能够更好地适应复杂多变的现实世界文本检测任务。</p> 
<p>同时，精确率和召回率之间的平衡仍然是场景文本检测算法设计中的一个关键挑战，未来的工作可以考虑如何在保持高精确率的同时进一步提高召回率。</p> 
<p>增强版ATT-ABCNet在Total Text和CTW1500数据集上展示了较原版算法更为出色的性能，特别是在精确率上的提升更为显著。这一结果不仅展示了算法改进的潜力，也为文本检测领域的研究提供了宝贵的参考。尽管如此，算法开发者需要持续探索新的方法，以应对更多样化的文本场景和挑战。</p> 
<h2><a id="10_378"></a>10.系统整合</h2> 
<p>下图<a href="https://s.xiaocichang.com/s/540889" rel="nofollow">完整源码＆数据集＆环境部署视频教程＆自定义UI界面</a><br> <img src="https://images2.imgbox.com/3a/d7/DWjVxWW9_o.png" alt="在这里插入图片描述"></p> 
<p>参考博客<a href="https://zhuanlan.zhihu.com/p/665463086" rel="nofollow">《基于ATT-ABCNet 改进CRNN的火车票实时识别系统》</a></p> 
<h2><a id="11_386"></a>11参考文献</h2> 
<hr> 
<p>[1]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%9D%8E%E7%9B%8A%E7%BA%A2%22" rel="nofollow">李益红</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E9%99%88%E8%A2%81%E5%AE%87%22" rel="nofollow">陈袁宇</a>.<a href="https://d.wanfangdata.com.cn/periodical/jsjgcyyy202106005" rel="nofollow">深度学习场景文本检测方法综述</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/jsjgcyyy" rel="nofollow">计算机工程与应用</a>.2021,(6).DOI:10.3778/j.issn.1002-8331.2010-0468 .</p> 
<p>[2]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E5%AE%AB%E6%B3%95%E6%98%8E%22" rel="nofollow">宫法明</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E5%88%98%E8%8A%B3%E5%8D%8E%22" rel="nofollow">刘芳华</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%9D%8E%E5%8E%A5%E7%91%BE%22" rel="nofollow">李厥瑾</a>,等.<a href="https://d.wanfangdata.com.cn/periodical/jsjxtyy202108024" rel="nofollow">基于深度学习的场景文本检测与识别</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/jsjxtyy" rel="nofollow">计算机系统应用</a>.2021,(8).DOI:10.15888/j.cnki.csa.008038 .</p> 
<p>[3]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E7%99%BD%E5%BF%97%E7%A8%8B%22" rel="nofollow">白志程</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%9D%8E%E6%93%8E%22" rel="nofollow">李擎</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E9%99%88%E9%B9%8F%22" rel="nofollow">陈鹏</a>,等.<a href="https://d.wanfangdata.com.cn/periodical/bjkjdxxb202011005" rel="nofollow">自然场景文本检测技术研究综述</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/bjkjdxxb" rel="nofollow">工程科学学报</a>.2020,(11).</p> 
<p>[4]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E7%86%8A%E6%B5%B7%E6%9C%8B%22" rel="nofollow">熊海朋</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E9%99%88%E6%B4%8B%E6%B4%8B%22" rel="nofollow">陈洋洋</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E9%99%88%E6%98%A5%E7%8E%AE%22" rel="nofollow">陈春玮</a>.<a href="https://d.wanfangdata.com.cn/periodical/dzkj201801013" rel="nofollow">基于卷积神经网络的场景图像文本定位研究</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/dzkj" rel="nofollow">电子科技</a>.2018,(1).DOI:10.16180/j.cnki.issn1007-7820.2018.01.013 .</p> 
<p>[5]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E7%8E%8B%E6%B6%A6%E6%B0%91%22" rel="nofollow">王润民</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%A1%91%E5%86%9C%22" rel="nofollow">桑农</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E4%B8%81%E4%B8%81%22" rel="nofollow">丁丁</a>,等.<a href="https://d.wanfangdata.com.cn/periodical/zdhxb201812001" rel="nofollow">自然场景图像中的文本检测综述</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/zdhxb" rel="nofollow">自动化学报</a>.2018,(12).DOI:10.16383/j.aas.2018.c170572 .</p> 
<p>[6]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%9D%A8%E9%A3%9E%22" rel="nofollow">杨飞</a>.<a href="https://d.wanfangdata.com.cn/periodical/dzsjgc201624047" rel="nofollow">自然场景图像中的文字检测综述</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/dzsjgc" rel="nofollow">电子设计工程</a>.2016,(24).</p> 
<p>[7]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E5%BC%A0%E4%BC%9F%E4%BC%9F%22" rel="nofollow">张伟伟</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%B1%A4%E5%85%89%E6%98%8E%22" rel="nofollow">汤光明</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E5%AD%99%E6%80%A1%E5%B3%B0%22" rel="nofollow">孙怡峰</a>,等.<a href="https://d.wanfangdata.com.cn/periodical/xxgcdxxb201406015" rel="nofollow">一种针对汉字特点的场景图像中文文本定位算法</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/xxgcdxxb" rel="nofollow">信息工程大学学报</a>.2014,(6).DOI:10.3969/j.issn.1671-0673.2014.06.015 .</p> 
<p>[8]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E7%99%BD%E7%BF%94%22" rel="nofollow">白翔</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E6%9D%A8%E6%98%8E%E9%94%9F%22" rel="nofollow">杨明锟</a>,<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E7%9F%B3%E8%91%86%E5%85%89%22" rel="nofollow">石葆光</a>,等.<a href="https://d.wanfangdata.com.cn/periodical/zgkx-fc201805006" rel="nofollow">基于深度学习的场景文字检测与识别</a>[J].<a href="https://sns.wanfangdata.com.cn/perio/zgkx-fc" rel="nofollow">中国科学（信息科学）</a>.2018,(5).</p> 
<p>[9]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E5%8D%A2%E7%8E%89%E8%8E%B9%22" rel="nofollow">卢玉莹</a>.<a href="https://d.wanfangdata.com.cn/thesis/D02711038" rel="nofollow">基于改进DRRG算法的自然场景文本定位与识别</a>[D].2022.</p> 
<p>[10]<a href="https://s.wanfangdata.com.cn/paper?q=%E4%BD%9C%E8%80%85:%22%E5%B4%94%E5%BF%97%E6%96%8C%22" rel="nofollow">崔志斌</a>.<a href="https://d.wanfangdata.com.cn/thesis/D02716828" rel="nofollow">基于深度学习的自然场景下管线文本的检测与识别系统研究开发</a>[D].2022.</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/90b56add51867f9a5d8508371f084036/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">20个CSS面试题和答案的示例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6e8d9b2e96a9c47d0b2ef2a4319ec2bb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【发布的微信小程序源码丢失怎么办】【微信小程序反编译】记录一次小程序源码找回经历</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>