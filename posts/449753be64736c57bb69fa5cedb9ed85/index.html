<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>php 访问ftp服务器文件夹权限,我无法使用PHP在FTP服务器上工作，连接有效，但我无法获取文件或其他内容。它适用于FileZilla... - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="php 访问ftp服务器文件夹权限,我无法使用PHP在FTP服务器上工作，连接有效，但我无法获取文件或其他内容。它适用于FileZilla..." />
<meta property="og:description" content="我有一个问题。我使用PHP连接到FTP服务器，以获取存储在服务器上的文件列表。我可以正常连接(使用ftp_connect，也可以使用ftp_login登录，我也使用被动模式)。当我只是连接时，Everthing工作。当我向我的代码添加ftp_nlist或其他操作时，它不起作用。该页面只是无休止地加载。我可以使用FileZilla连接并在服务器上工作，但我想自动执行此操作。它适用于FileZilla但不适用于PHP，你能帮助我吗？
它尝试连接到另一台FTP服务器，效果很好。我可以得到文件列表。但我无法使用我想要的服务器。
这是我的代码：
$ftpStream=ftp_connect($hostname,$port);
if($ftpStream==false)
echo &#39;No connection &#39;;
else {
echo &#39;Connected &#39;;
if(ftp_login($ftpStream,$ftpUsername,$ftpPassword)!=false) {
echo &#39;Logged &#39;;
if(ftp_pasv($ftpStream,true)!=false)
echo &#39;Passive mode on &#39;;
$list=ftp_nlist($ftpStream,&#39;.&#39;);
}
else echo &#39;Wrong ftpUsername or ftpPassword&#39;;
}
我检查了文件权限，我可以读取，写入和执行，所以问题并非来自我认为的文件权限。
这是日志文件：
2018-05-04 09:28:10 248 1 Suivi : CControlSocket::SendNextCommand()
2018-05-04 09:28:10 248 1 Suivi : CFtpLogonOpData::Send() in state 0
2018-05-04 09:28:10 248 1 Statut : Connexion à ... //Connecting to the FTP server
2018-05-04 09:28:10 248 1 Statut : Connexion établie, attente du message d&#39;accueil." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/449753be64736c57bb69fa5cedb9ed85/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-10T08:28:56+08:00" />
<meta property="article:modified_time" content="2021-08-10T08:28:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">php 访问ftp服务器文件夹权限,我无法使用PHP在FTP服务器上工作，连接有效，但我无法获取文件或其他内容。它适用于FileZilla...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>我有一个问题。我使用PHP连接到FTP服务器，以获取存储在服务器上的文件列表。我可以正常连接(使用ftp_connect，也可以使用ftp_login登录，我也使用被动模式)。当我只是连接时，Everthing工作。当我向我的代码添加ftp_nlist或其他操作时，它不起作用。该页面只是无休止地加载。我可以使用FileZilla连接并在服务器上工作，但我想自动执行此操作。它适用于FileZilla但不适用于PHP，你能帮助我吗？</p> 
 <p>它尝试连接到另一台FTP服务器，效果很好。我可以得到文件列表。但我无法使用我想要的服务器。</p> 
 <p>这是我的代码：</p> 
 <p>$ftpStream=ftp_connect($hostname,$port);</p> 
 <p>if($ftpStream==false)</p> 
 <p>echo 'No connection ';</p> 
 <p>else {<!-- --></p> 
 <p>echo 'Connected ';</p> 
 <p>if(ftp_login($ftpStream,$ftpUsername,$ftpPassword)!=false) {<!-- --></p> 
 <p>echo 'Logged ';</p> 
 <p>if(ftp_pasv($ftpStream,true)!=false)</p> 
 <p>echo 'Passive mode on ';</p> 
 <p>$list=ftp_nlist($ftpStream,'.');</p> 
 <p>}</p> 
 <p>else echo 'Wrong ftpUsername or ftpPassword';</p> 
 <p>}</p> 
 <p>我检查了文件权限，我可以读取，写入和执行，所以问题并非来自我认为的文件权限。</p> 
 <p>这是日志文件：</p> 
 <p>2018-05-04 09:28:10 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:10 248 1 Suivi : CFtpLogonOpData::Send() in state 0</p> 
 <p>2018-05-04 09:28:10 248 1 Statut : Connexion à ... //Connecting to the FTP server</p> 
 <p>2018-05-04 09:28:10 248 1 Statut : Connexion établie, attente du message d'accueil... //Connection established, waiting for the welcome message</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:11 248 1 Réponse : 220 Service ready for new user.</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 1</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpLogonOpData::Send() in state 2</p> 
 <p>2018-05-04 09:28:11 248 1 Commande : AUTH TLS</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:11 248 1 Réponse : 500 Syntax error, command unrecognized.</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 2</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpLogonOpData::Send() in state 3</p> 
 <p>2018-05-04 09:28:11 248 1 Commande : AUTH SSL</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:11 248 1 Réponse : 500 Syntax error, command unrecognized.</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 3</p> 
 <p>2018-05-04 09:28:11 248 1 Statut : Serveur non sécurisé, celui-ci ne supporte pas FTP sur TLS.// No TLS</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:11 248 1 Suivi : CFtpLogonOpData::Send() in state 5</p> 
 <p>2018-05-04 09:28:11 248 1 Commande : USER user</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:12 248 1 Réponse : 331 User name okay, need password.</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 5</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpLogonOpData::Send() in state 5</p> 
 <p>2018-05-04 09:28:12 248 1 Commande : PASS ****</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:12 248 1 Réponse : 230 User logged in, proceed.</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 5</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpLogonOpData::Send() in state 6</p> 
 <p>2018-05-04 09:28:12 248 1 Commande : SYST</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:12 248 1 Réponse : 215 Windows_CE version 6.0.</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 6</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:12 248 1 Suivi : CFtpLogonOpData::Send() in state 7</p> 
 <p>2018-05-04 09:28:12 248 1 Commande : FEAT</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:13 248 1 Réponse : 211- Features supported</p> 
 <p>2018-05-04 09:28:13 248 1 Réponse : REST SIZE STREAM</p> 
 <p>2018-05-04 09:28:13 248 1 Réponse : 211 End</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpLogonOpData::ParseResponse() in state 7</p> 
 <p>2018-05-04 09:28:13 248 1 Statut : Le serveur ne supporte pas les caractères non-ASCII. //Doesn't support non ASCII characters</p> 
 <p>2018-05-04 09:28:13 248 1 Statut : Connecté // Connected</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : Measured latency of 296 ms</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:13 248 1 Statut : Récupération du contenu du dossier... //Getting directory content</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpListOpData::ListSend() in state 0</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpChangeDirOpData::Send() in state 0</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpChangeDirOpData::Send() in state 1</p> 
 <p>2018-05-04 09:28:13 248 1 Commande : PWD</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:13 248 1 Réponse : 257 "/".</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpChangeDirOpData::ParseResponse() in state 1</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::ParseSubcommandResult(0)</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpListOpData::SubcommandResult() in state 1</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpListOpData::ListSend() in state 2</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpRawTransferOpData::Send() in state 1</p> 
 <p>2018-05-04 09:28:13 248 1 Commande : TYPE I</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:13 248 1 Réponse : 200 Command okay.</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpRawTransferOpData::ParseResponse() in state 1</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpRawTransferOpData::Send() in state 2</p> 
 <p>2018-05-04 09:28:13 248 1 Commande : PASV</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:13 248 1 Réponse : 227 Entering Passive Mode (x,x,x,x,200,64).</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpRawTransferOpData::ParseResponse() in state 2</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : CFtpRawTransferOpData::Send() in state 4</p> 
 <p>2018-05-04 09:28:13 248 1 Suivi : Binding data connection source IP to control connection source IP (myIP)</p> 
 <p>2018-05-04 09:28:13 248 1 Commande : LIST</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CTransferSocket::OnConnect</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:14 248 1 Réponse : 125 Data connection already open; transfer starting.</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpRawTransferOpData::ParseResponse() in state 4</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpRawTransferOpData::Send() in state 5</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpControlSocket::OnReceive()</p> 
 <p>2018-05-04 09:28:14 248 1 Réponse : 226 Closing data connection.</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpRawTransferOpData::ParseResponse() in state 5</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CControlSocket::SendNextCommand()</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpRawTransferOpData::Send() in state 8</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CTransferSocket::OnClose(0)</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CTransferSocket::TransferEnd(1)</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpControlSocket::TransferEnd()</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CControlSocket::ParseSubcommandResult(0)</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpListOpData::SubcommandResult() in state 3</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CFtpControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:14 248 1 Suivi : CControlSocket::ResetOperation(0)</p> 
 <p>2018-05-04 09:28:14 248 1 Statut : Contenu du dossier "/" affiché avec succès // "/" directory successfully displayed</p> 
 <p>我继续搜索，发现一些奇怪的东西。数据连接在FileZilla中立即关闭，但它仍然可以获取文件列表，也许我应该使用PHP来处理它：</p> 
 <p>Commande : PASV</p> 
 <p>Réponse : 227 Entering Passive Mode (x,x,x,x,19,201)</p> 
 <p>Commande : LIST</p> 
 <p>Réponse : 150 File status okay; about to open data connection.</p> 
 <p>Réponse : 226 Closing data connection.</p> 
 <p>Statut : Contenu du dossier affiché avec succès // The directory's content is well displayed</p> 
 <p>这就是它与另一台服务器的合作方式</p> 
 <p>Commande : PASV</p> 
 <p>Réponse : 227 Entering Passive Mode (x,x,x,x,15,73)</p> 
 <p>Commande : LIST</p> 
 <p>Réponse : 150 File status okay; about to open data connection.</p> 
 <p>Réponse : 226 Transfer complete</p> 
 <p>Statut : Contenu du dossier affiché avec succès //Sucessfully displayed</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5324598ff201c8a8f6beac7c91433146/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">王者营地登录服务器维护,王者荣耀王者营地账号登录不了怎么办  王者营地登录后没有显示账号...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/883dd6bde3f92b7cf931102b1c3698d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">电脑启动项,电脑启动项设置,详细教您怎么设置开机启动项</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>