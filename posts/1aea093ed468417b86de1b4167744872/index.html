<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第6期 两地三中心解决方案SDRS&#43;CBR - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="第6期 两地三中心解决方案SDRS&#43;CBR" />
<meta property="og:description" content="第6期 两地三中心解决方案SDRS&#43;CBR 1.方案概述什么是两地三中心什么是SDRS什么是CBR什么是两地三中心容灾方案（SDRS&#43;CBR）应用场景方案优势三种容灾方案对比 2.两地三中心方案原理生产站点正常工作生产站点故障生产站点和跨可用区容灾站点同时故障 3.资源和成本规划部署跨可用区容灾部署跨区域容灾 1.方案概述 什么是两地三中心 两地三中心是一种业务连续性容灾方案。三数据中心并存的特性，能在任意两个数据中心受损的情况下保障核心业务的连续，大大提高容灾方案的可用性。
将华为云的SDRS与CBR结合使用，可以较快地响应小范围的故障和较大范围的自然灾害，保全业务数据，保障业务的连续性
两地三中心容灾方案包括了生产中心、同城灾备中心和异地灾备中心：
生产中心：对外提供服务同城灾备中心：通常在离生产中心几十公里的距离建立同城灾备中心，应用可在不丢失数据的情况下切换到同城灾备中心运行，是两地三中心容灾方案的第一级容灾保护异地灾备中心：通常在离生产中心几百或者上千公里的地方建立异地灾备中心，应对区域性重大灾难，实现周期性异步复制灾备，是两地三中心容灾方案的第二级容灾保护 什么是SDRS 存储容灾服务（Storage Disaster Recovery Service，SDRS）是一种为弹性云服务器、云硬盘和专属分布式存储等服务提供容灾的服务。通过存储复制、数据冗余和缓存加速等多项技术，保障用户数据的可靠性以及业务的连续性。
什么是CBR 云备份（Cloud Backup and Recovery，CBR）是一种为云内的弹性云服务器、云耀云服务器、裸金属服务器、云硬盘、SFS Turbo文件系统、云下VMware虚拟化环境和云下主机上的单个或多个文件以及数据库，提供简单易用备份的服务。针对病毒入侵、人为误删除、软硬件故障等场景，可将数据恢复到任意备份点，保障用户数据的安全性和正确性，确保业务安全。
什么是两地三中心容灾方案（SDRS&#43;CBR） 两地三中心容灾方案（SDRS&#43;CBR）通过SDRS将生产站点的数据同步复制到同区域下的不同可用区，形成跨可用区容灾站点；通过CBR将生产站点的数据周期性备份到不同区域，形成跨区域容灾站点。生产站点、跨可用区容灾站点、跨区域容灾站点共同组成两地三中心架构，满足两地三中心容灾方案的诉求。
这里的跨可用区容灾站点，对应上述两地三中心中的同城灾备中心，跨区域容灾站点对应两地三中心中的异地灾备中心。
下文中两地三中心容灾方案（SDRS&#43;CBR）简称为SDRS&#43;CBR容灾方案。
两地三中心容灾方案（SDRS&#43;CBR）中，“两地”是指容灾方案部署在两个区域，“三中心”分别是一个生产站点、一个同区域跨可用区容灾站点（下文简称为跨可用区容灾站点）和一个跨区域容灾站点。
两地三中心容灾方案（SDRS&#43;CBR）分别通过SDRS将生产站点的数据同步地复制到跨可用区容灾站点，通过CBR将生产站点的数据周期性地备份到跨区域容灾站点，满足两地三中心的诉求。
应用场景 SDRS&#43;CBR容灾方案适用于使用弹性云服务器和云硬盘运行业务的场景。
方案优势 相比跨可用区容灾和跨区域容灾的“双站点”容灾方案，SDRS&#43;CBR容灾方案结合两者的优势，可以同时应对可用区级别故障和区域级别灾难。
对于可用区级别故障，容灾切换时保证磁盘数据一致性。对于区域级别灾难，该方案可将业务恢复至最近一次备份时间点，尽可能保全业务数据不丢失。 三种容灾方案对比 容灾方案是否可以应对可用区级别故障可用区级别故障切换后，是否可以恢复至崩溃时的状态是否可以应对区域级别灾难跨可用区容灾（SDRS）√√×跨区域容灾（CBR）√×√两地三中心容灾方案（SDRS&#43;CBR）√√√ 2.两地三中心方案原理 本章节分别通过生产站点正常工作、生产站点故障以及生产站点和跨可用区容灾站点同时故障三个场景，介绍在不同的故障情况下，本方案如何接管用户的业务
生产站点正常工作 当生产站点正常工作时，状态如图1所示。
通过SDRS，在区域A内将可用区1的生产站点服务器的数据、配置信息同步复制到可用区2的跨可用区容灾站点，为跨可用区容灾做准备。日常可定期进行容灾演练，模拟真实故障恢复场景，制定应急恢复预案。通过CBR，对位于区域A的生产站点服务器进行周期性整机备份，然后周期性将整机备份复制到区域B的跨区域容灾站点，为跨区域容灾做准备。
图1 生产站点正常工作
生产站点故障 在出现设备故障等小范围的故障，造成生产站点不可用时，应用可在不丢失数据的情况下切换到跨可用区容灾站点运行，如图2所示。
该阶段的容灾RPO（Recovery Point Objective）等于0，RTO（Recovery Time Objective）在30分钟内。
说明：
RPO：最多可能丢失的数据的时长。
RTO：从灾难发生到整个系统恢复正常所需要的最大时长。
图2 生产站点故障
生产站点和跨可用区容灾站点同时故障 在出现自然灾害地震等大范围灾难，造成生产站点和跨可用区容灾站点同时不可用时，应用可以切换到跨区域容灾站点。通过周期性复制到区域B的整机备份创建整机镜像，然后使用整机镜像创建云服务器，在跨区域容灾站点恢复应用，保证业务连续运行，如图3所示。
该阶段的容灾RPO取值为0 ~ 周期性备份间隔，当前备份间隔最小为1小时，RTO在30分钟内。
说明：
跨区域容灾阶段，RPO = 发生灾难时间点 - 最新的备份文件时间点。
图3 生产站点和跨可用区容灾站点同时故障
3.资源和成本规划 本章节介绍最佳实践中资源规划情况，实际业务中还需要考虑资源规格的不同每月费用的变化或是每年费用才能实现资源和成本的最佳规划。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1aea093ed468417b86de1b4167744872/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-03T13:16:35+08:00" />
<meta property="article:modified_time" content="2023-06-03T13:16:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第6期 两地三中心解决方案SDRS&#43;CBR</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>第6期 两地三中心解决方案SDRS+CBR</h4> 
 <ul><li><a href="#1_3" rel="nofollow">1.方案概述</a></li><li><ul><li><a href="#_4" rel="nofollow">什么是两地三中心</a></li><li><a href="#SDRS_13" rel="nofollow">什么是SDRS</a></li><li><a href="#CBR_15" rel="nofollow">什么是CBR</a></li><li><a href="#SDRSCBR_17" rel="nofollow">什么是两地三中心容灾方案（SDRS+CBR）</a></li><li><a href="#_28" rel="nofollow">应用场景</a></li><li><a href="#_30" rel="nofollow">方案优势</a></li><li><a href="#_35" rel="nofollow">三种容灾方案对比</a></li></ul> 
  </li><li><a href="#2_42" rel="nofollow">2.两地三中心方案原理</a></li><li><ul><li><a href="#_46" rel="nofollow">生产站点正常工作</a></li><li><a href="#_57" rel="nofollow">生产站点故障</a></li><li><a href="#_70" rel="nofollow">生产站点和跨可用区容灾站点同时故障</a></li></ul> 
  </li><li><a href="#3_79" rel="nofollow">3.资源和成本规划</a></li><li><ul><li><a href="#_81" rel="nofollow">部署跨可用区容灾</a></li><li><a href="#_89" rel="nofollow">部署跨区域容灾</a></li></ul> 
 </li></ul> 
</div> 
<br> 
<img src="https://images2.imgbox.com/da/84/ME1NQggN_o.png" alt="在这里插入图片描述"> 
<p></p> 
<h2><a id="1_3"></a>1.方案概述</h2> 
<h3><a id="_4"></a>什么是两地三中心</h3> 
<p>两地三中心是一种<strong>业务连续性容灾</strong>方案。<strong>三数据中心并存</strong>的特性，能在任意两个数据中心受损的情况下保障核心业务的连续，大大提高容灾方案的可用性。<br> <em>将华为云的SDRS与CBR结合使用，可以较快地响应小范围的故障和较大范围的自然灾害，保全业务数据，保障业务的连续性</em></p> 
<p>两地三中心容灾方案包括了<strong>生产中心</strong>、<strong>同城灾备中心</strong>和<strong>异地灾备中心</strong>：</p> 
<ul><li>生产中心：对外提供服务</li><li>同城灾备中心：通常在离生产中心几十公里的距离建立同城灾备中心，应用可在不丢失数据的情况下切换到同城灾备中心运行，是两地三中心容灾方案的第一级容灾保护</li><li>异地灾备中心：通常在离生产中心几百或者上千公里的地方建立异地灾备中心，应对区域性重大灾难，实现周期性异步复制灾备，是两地三中心容灾方案的第二级容灾保护</li></ul> 
<h3><a id="SDRS_13"></a>什么是SDRS</h3> 
<p>存储容灾服务（Storage Disaster Recovery Service，SDRS）是一种为弹性云服务器、云硬盘和专属分布式存储等服务提供容灾的服务。通过存储复制、数据冗余和缓存加速等多项技术，保障用户数据的可靠性以及业务的连续性。</p> 
<h3><a id="CBR_15"></a>什么是CBR</h3> 
<p>云备份（Cloud Backup and Recovery，CBR）是一种为云内的弹性云服务器、云耀云服务器、裸金属服务器、云硬盘、SFS Turbo文件系统、云下VMware虚拟化环境和云下主机上的单个或多个文件以及数据库，提供简单易用备份的服务。针对病毒入侵、人为误删除、软硬件故障等场景，可将数据恢复到任意备份点，保障用户数据的安全性和正确性，确保业务安全。</p> 
<h3><a id="SDRSCBR_17"></a>什么是两地三中心容灾方案（SDRS+CBR）</h3> 
<p>两地三中心容灾方案（SDRS+CBR）通过SDRS将生产站点的数据同步复制到同区域下的不同可用区，形成跨可用区容灾站点；通过CBR将生产站点的数据周期性备份到不同区域，形成跨区域容灾站点。生产站点、跨可用区容灾站点、跨区域容灾站点共同组成两地三中心架构，满足两地三中心容灾方案的诉求。</p> 
<p>这里的跨可用区容灾站点，对应上述两地三中心中的同城灾备中心，跨区域容灾站点对应两地三中心中的异地灾备中心。</p> 
<p>下文中两地三中心容灾方案（SDRS+CBR）简称为SDRS+CBR容灾方案。<br> <img src="https://images2.imgbox.com/4d/38/VXKL0ecZ_o.png" alt="在这里插入图片描述"></p> 
<p>两地三中心容灾方案（SDRS+CBR）中，“两地”是指容灾方案部署在两个区域，“三中心”分别是一个生产站点、一个同区域跨可用区容灾站点（下文简称为跨可用区容灾站点）和一个跨区域容灾站点。</p> 
<p>两地三中心容灾方案（SDRS+CBR）分别通过SDRS将生产站点的数据同步地复制到跨可用区容灾站点，通过CBR将生产站点的数据周期性地备份到跨区域容灾站点，满足两地三中心的诉求。</p> 
<h3><a id="_28"></a>应用场景</h3> 
<p>SDRS+CBR容灾方案适用于使用弹性云服务器和云硬盘运行业务的场景。</p> 
<h3><a id="_30"></a>方案优势</h3> 
<p>相比跨可用区容灾和跨区域容灾的“双站点”容灾方案，SDRS+CBR容灾方案结合两者的优势，可以同时应对可用区级别故障和区域级别灾难。</p> 
<ul><li>对于可用区级别故障，容灾切换时保证磁盘数据一致性。</li><li>对于区域级别灾难，该方案可将业务恢复至最近一次备份时间点，尽可能保全业务数据不丢失。</li></ul> 
<h3><a id="_35"></a>三种容灾方案对比</h3> 
<table><thead><tr><th>容灾方案</th><th>是否可以应对可用区级别故障</th><th>可用区级别故障切换后，是否可以恢复至崩溃时的状态</th><th>是否可以应对区域级别灾难</th></tr></thead><tbody><tr><td>跨可用区容灾（SDRS）</td><td>√</td><td>√</td><td>×</td></tr><tr><td>跨区域容灾（CBR）</td><td>√</td><td>×</td><td>√</td></tr><tr><td>两地三中心容灾方案（SDRS+CBR）</td><td>√</td><td>√</td><td>√</td></tr></tbody></table> 
<h2><a id="2_42"></a>2.两地三中心方案原理</h2> 
<p>本章节分别通过生产站点正常工作、生产站点故障以及生产站点和跨可用区容灾站点同时故障三个场景，介绍在不同的故障情况下，本方案如何接管用户的业务</p> 
<h3><a id="_46"></a>生产站点正常工作</h3> 
<p>当生产站点正常工作时，状态如图1所示。</p> 
<ul><li>通过SDRS，在区域A内将可用区1的生产站点服务器的数据、配置信息同步复制到可用区2的跨可用区容灾站点，为跨可用区容灾做准备。日常可定期进行容灾演练，模拟真实故障恢复场景，制定应急恢复预案。</li><li>通过CBR，对位于区域A的生产站点服务器进行周期性整机备份，然后周期性将整机备份复制到区域B的跨区域容灾站点，为跨区域容灾做准备。<br> 图1 生产站点正常工作<br> <img src="https://images2.imgbox.com/33/fe/95NKdBB6_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="_57"></a>生产站点故障</h3> 
<p>在出现设备故障等小范围的故障，造成生产站点不可用时，应用可在不丢失数据的情况下切换到跨可用区容灾站点运行，如图2所示。</p> 
<p>该阶段的容灾RPO（Recovery Point Objective）等于0，RTO（Recovery Time Objective）在30分钟内。<br> <strong>说明：</strong></p> 
<p><em>RPO：最多可能丢失的数据的时长。</em></p> 
<p><em>RTO：从灾难发生到整个系统恢复正常所需要的最大时长。</em><br> 图2 生产站点故障<br> <img src="https://images2.imgbox.com/0c/e1/CDgzZdzu_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_70"></a>生产站点和跨可用区容灾站点同时故障</h3> 
<p>在出现自然灾害地震等大范围灾难，造成生产站点和跨可用区容灾站点同时不可用时，应用可以切换到跨区域容灾站点。通过周期性复制到区域B的整机备份创建整机镜像，然后使用整机镜像创建云服务器，在跨区域容灾站点恢复应用，保证业务连续运行，如图3所示。</p> 
<p>该阶段的容灾RPO取值为0 ~ 周期性备份间隔，当前备份间隔最小为1小时，RTO在30分钟内。<br> <strong>说明：</strong></p> 
<p><em>跨区域容灾阶段，RPO = 发生灾难时间点 - 最新的备份文件时间点。</em><br> 图3 生产站点和跨可用区容灾站点同时故障<br> <img src="https://images2.imgbox.com/59/fa/fBy0jsZk_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3_79"></a>3.资源和成本规划</h2> 
<p>本章节介绍最佳实践中资源规划情况，实际业务中还需要考虑资源规格的不同每月费用的变化或是每年费用才能实现资源和成本的最佳规划。</p> 
<h3><a id="_81"></a>部署跨可用区容灾</h3> 
<p><em>部署跨可用区容灾资源规划说明</em></p> 
<table><thead><tr><th>区域</th><th>资源</th><th>资源名称</th><th>资源说明</th><th>数量</th><th>每月费用（元）</th></tr></thead><tbody><tr><td>华北-北京四(生产站点)</td><td>弹性云服务器ECS</td><td>ecs-test1</td><td>规格：s6.small.1 可用区：az-01 可同时选择多个生产站点服务器，最多可同时选择5个。</td><td>1</td><td>46.20</td></tr><tr><td></td><td>虚拟私有云VPC</td><td>vpc1</td><td>VPC网段：10.0.0.0/16</td><td>1</td><td>00.00</td></tr><tr><td>华北-北京四(容灾站点)</td><td>弹性云服务器ECS</td><td>ecs-test2</td><td>规格：s6.small.1 可用区：az-02</td><td>1</td><td>46.20</td></tr><tr><td></td><td>虚拟私有云VPC</td><td>vpc1</td><td>VPC网段：10.0.0.0/16 扩展网卡（可选）：subnet-01 (192.168.0.0/24)</td><td>1</td><td>00.00</td></tr></tbody></table> 
<h3><a id="_89"></a>部署跨区域容灾</h3> 
<p>*部署跨区域容灾资源规划说明 *</p> 
<table><thead><tr><th>区域</th><th>资源</th><th>资源名称</th><th>资源说明</th><th>数量</th><th>每月费用（元）</th></tr></thead><tbody><tr><td>华北-北京四(生产站点)</td><td>弹性云服务器ECS</td><td>ecs-test1</td><td>规格：s6.small.1 可用区：az-01 可同时选择多个生产站点服务器，最多可同时选择5个。</td><td>1</td><td>46.20</td></tr><tr><td></td><td>虚拟私有云VPC</td><td>vpc1</td><td>VPC网段：10.0.0.0/16</td><td>1</td><td>00.00</td></tr><tr><td></td><td>云备份CBR</td><td>backup_policy</td><td>备份策略：按周备份，每周一、周三、周五、周天 00:00执行备份</td><td>1</td><td>00.00</td></tr><tr><td></td><td></td><td>replication_0001</td><td>复制策略：按周备份，每周一、周三、周五、周日 03:00执行复制，目标区域：华南-广州，目标存储库：vault_replication</td><td>1</td><td>00.00</td></tr><tr><td></td><td></td><td>vault-f61e</td><td>备份存储库：容量500GB，绑定弹性云服务器ecs-test，和备份策略backup_policy，以及复制策略replication_0001</td><td>1</td><td>100.00</td></tr><tr><td>华南-广州(容灾站点)</td><td>虚拟私有云VPC</td><td>vpc1</td><td>VPC网段：10.0.0.0/16</td><td>1</td><td>00.00</td></tr><tr><td></td><td>云备份 CBR</td><td>vault_replication</td><td>复制存储库：容量500GB</td><td>1</td><td>60.00</td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/deb132bc8e1774b66e9ccd3e5424b951/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PostgreSql根据给的时间范围统计15分钟粒度、小时粒度、天粒度、周粒度、月粒度工单</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6c2a6624a61ed60bb6de400de33d6b18/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue-Rate评分组件的相关使用.</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>