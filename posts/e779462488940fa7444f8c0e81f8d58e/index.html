<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>讲讲关于跨域的问题,什么是跨域?怎么办? - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="讲讲关于跨域的问题,什么是跨域?怎么办?" />
<meta property="og:description" content="文章目录 什么是跨域如果非同源，共有三种行为受到限浏览器客户端和向服务器跨域请求的判定流程 跨域问题演示参考 以下内容为我结合他人知识进行的自我总结, 如有错误欢迎指出~
什么是跨域 跨域就是不同的域名下的资源访问，会被浏览器的本地安全策略阻止；
跨域是由浏览器的同源策略造成的，是浏览器施加的安全限制。是浏览器的一种保护机制，它的初衷是为了保证用户的安全，防止恶意网站窃取数据。
同源：是指相同的协议（例如http、https等）、域名（例如www.baidu.com,其中www是子域名即服务器名，baidu.com是主域名即网站名）、端口(8080)，三者都相同才属于同源。同源策略：指A 网页设置的 Cookie，B 网页不能打开，除非这两个网页“同源”，才能互相传递cookies，浏览器出于互联网安全考虑，不同源的网站之间是不能互相访问的；同源政策的目的，是为了保证用户信息的安全，防止恶意的网站窃取数据。跨域：由于浏览器同源策略，凡是发送请求的url的协议、域名、端口三者之间任意一个与当前页面地址不同则视为跨域。 （简单的讲法：不同域之间相互请求资源）。 设想这样一种情况：A 网站是一家银行，用户登录以后，A 网站在用户的机器上设置了一个 Cookie，包含了一些隐私信息（比如存款总额）。用户离开 A 网站以后，又去访问 B 网站，如果没有同源限制，B 网站可以读取 A 网站的 Cookie，那么隐私信息就会泄漏。更可怕的是，Cookie 往往用来保存用户的登录状态，如果用户没有退出登录，其他网站就可以冒充用户，为所欲为。因为浏览器同时还规定，提交表单不受同源政策的限制。
如果非同源，共有三种行为受到限 1.无法获取非同源网页的 cookie、localstorage
比如A项目里 iframe(嵌入式框架) 了一个B项目，A跳转B项目时，浏览器本身的特点会自动检查两个域名是否同源，来判断是否能传递cookies给请求的B项目；除了不能传递cookie还是可以正常引用并跳转到B项目页面的，其实iframe的src就是浏览器顶部的url链接，拿到链接先去请求html，html编译后就是各种DOM树标签对象，也能请求接口等资源，因为在B自己的项目中，那如何避免DOM- iframe被访问呢，就用到第二点、如何避免A如果直接调B接口，就用到第三条；如果想要让AB传递cookies，则需要特别设置，比如AB两个项目都通过设置document.domain为相同的父级域名，则不会跨域了，两个项目交互时都会检查domain是否一致；前提需要AB主域名相同，否则设置了domain也没有用，不过前端可以通过postMessage，实质是HTML5的API，不同域下的页面在满足一定关系的条件下可以通过此API跨域传送数据，即传送cookies等信息；
2.DOM同源策略即，无法访问非同源网页的 DOM （iframe）
即B被嵌入到A的iframe中的时候，可以正常打开B页面渲染html，但是A无法获取B页面的DOM树以及请求的数据；如果配置了X-iframe-option=拒绝，那么页面是打不开的，可以防止点击劫持；
3.Ajax 的同源策略(即请求接口时判断是否同源，不同源则不允许请求)；
无法向非同源地址发送 AJAX 请求 或 fetch 请求（可以发送，但浏览器拒绝接受响应），因为浏览器自己的机制会检测是否同源，不同源的话，会发送跨域请求给后端，后端再给予该请求返回Access-Control-Allow-Origin，根据Access-Control-Allow-Origin配置的域名，来判断是否允许进行ajax接口请求，如果没有配置跨域资源共享（CORS）机制，那么会报错如下图：
贴一个 cors跨域请求的处理过程：https://www.cnblogs.com/xfenfen/p/9378393.html
然后我们要明确一个问题, 请求跨域了，请求到底发出去没有？答案是肯定发出去了，但是浏览器拦截了响应。
浏览器客户端和向服务器跨域请求的判定流程 浏览器先根据同源策略对前端页面和后台交互地址做匹配，若同源，则直接发送数据请求；若不同源，则发送跨域请求。
服务器解析程序收到浏览器跨域请求后，根据自身配置返回对应文件头即addHeader(‘Access-Control-Allow-Origin:*’);//允许所有来源访问 。若未配置过任何允许跨域，则文件头里不包含Access-Control-Allow-origin字段，若配置过域名，则在response header中返回Access-Control-Allow-origin&#43; 对应配置规则里的域名的方式。Access-Control-Allow-Origin指定支持访问的域名，不指定的网站不能访问；
浏览器根据接受到的http文件头里response header的Access-Control-Allow-origin字段做匹配，若无该字段，说明不允许跨域；若有该字段，则对字段内容和当前想要请求后端服务的来源域名Origin:https://cloud.mengxiang.com做比对，如果同源，则说明可以跨域，浏览器发送该请求；若不同源，则说明该域名不可跨域，不发送请求
（但是不能仅仅根据服务器返回的文件头里是否包含Access-Control-Allow-origin来判断其是否允许跨域，因为服务器端配置多域名跨域的时候，也会出现不能跨域的域名返回包里没有Access-Control-Allow-origin字段的情况。下文配置说明里会讲。)
注：header中Access-Control-Allow- credentials该项标志着请求当中是否包含cookies信息
跨域问题演示 下面链接的博客中演示了如何跨域 和 如何解决跨域问题
面试突击81：什么是跨域问题？如何解决？
参考 关于cookies网站跨域单点登录的原理 cookie的作用域以及跨域设置" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e779462488940fa7444f8c0e81f8d58e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-11T22:00:16+08:00" />
<meta property="article:modified_time" content="2024-01-11T22:00:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">讲讲关于跨域的问题,什么是跨域?怎么办?</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">什么是跨域</a></li><li><ul><li><a href="#_15" rel="nofollow">如果非同源，共有三种行为受到限</a></li><li><a href="#_31" rel="nofollow">浏览器客户端和向服务器跨域请求的判定流程</a></li></ul> 
  </li><li><a href="#_42" rel="nofollow">跨域问题演示</a></li><li><a href="#_45" rel="nofollow">参考</a></li></ul> 
</div> 
<p></p> 
<p><strong>以下内容为我结合他人知识进行的自我总结, 如有错误欢迎指出~</strong></p> 
<h2><a id="_3"></a>什么是跨域</h2> 
<p>跨域就是不同的域名下的资源访问，会被浏览器的本地安全策略阻止；<br> 跨域是由浏览器的同源策略造成的，是浏览器施加的安全限制。是浏览器的一种保护机制，它的初衷是为了保证用户的安全，防止恶意网站窃取数据。</p> 
<ul><li>同源：是指相同的<strong>协议</strong>（例如http、https等）、<strong>域名</strong>（例如www.baidu.com,其中www是子域名即服务器名，baidu.com是主域名即网站名）、<strong>端口</strong>(8080)，三者都相同才属于同源。</li><li>同源策略：指A 网页设置的 Cookie，B 网页不能打开，除非这两个网页“同源”，才能互相传递cookies，浏览器出于互联网安全考虑，不同源的网站之间是不能互相访问的；同源政策的目的，是为了保证用户信息的安全，防止恶意的网站窃取数据。</li><li>跨域：由于浏览器同源策略，凡是发送请求的url的<strong>协议、域名、端口</strong>三者之间任意一个与当前页面地址不同则视为<strong>跨域</strong>。 （简单的讲法：不同域之间相互请求资源）。</li></ul> 
<p>设想这样一种情况：A 网站是一家银行，用户登录以后，A 网站在用户的机器上设置了一个 Cookie，包含了一些隐私信息（比如存款总额）。用户离开 A 网站以后，又去访问 B 网站，如果没有同源限制，B 网站可以读取 A 网站的 Cookie，那么隐私信息就会泄漏。更可怕的是，Cookie 往往用来保存用户的登录状态，如果用户没有退出登录，其他网站就可以冒充用户，为所欲为。因为浏览器同时还规定，提交表单不受同源政策的限制。<br> <img src="https://images2.imgbox.com/6d/60/ALDMgMPC_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_15"></a>如果非同源，共有三种行为受到限</h3> 
<blockquote> 
 <p>1.无法获取非同源网页的 cookie、localstorage<br> 比如A项目里 iframe(嵌入式框架) 了一个B项目，A跳转B项目时，浏览器本身的特点会自动检查两个域名是否同源，来判断是否能传递cookies给请求的B项目；除了不能传递cookie还是可以正常引用并跳转到B项目页面的，其实iframe的src就是浏览器顶部的url链接，拿到链接先去请求html，html编译后就是各种DOM树标签对象，也能请求接口等资源，因为在B自己的项目中，那如何避免DOM- iframe被访问呢，就用到第二点、如何避免A如果直接调B接口，就用到第三条；如果想要让AB传递cookies，则需要特别设置，比如AB两个项目都通过设置document.domain为相同的父级域名，则不会跨域了，两个项目交互时都会检查domain是否一致；前提需要AB主域名相同，否则设置了domain也没有用，不过前端可以通过postMessage，实质是HTML5的API，不同域下的页面在满足一定关系的条件下可以通过此API跨域传送数据，即传送cookies等信息；</p> 
</blockquote> 
<blockquote> 
 <p>2.DOM同源策略即，无法访问非同源网页的 DOM （iframe）<br> 即B被嵌入到A的iframe中的时候，可以正常打开B页面渲染html，但是A无法获取B页面的DOM树以及请求的数据；如果配置了X-iframe-option=拒绝，那么页面是打不开的，可以防止点击劫持；</p> 
</blockquote> 
<blockquote> 
 <p>3.Ajax 的同源策略(即请求接口时判断是否同源，不同源则不允许请求)；<br> 无法向非同源地址发送 AJAX 请求 或 fetch 请求（可以发送，但浏览器拒绝接受响应），因为浏览器自己的机制会检测是否同源，不同源的话，会发送跨域请求给后端，后端再给予该请求返回Access-Control-Allow-Origin，根据Access-Control-Allow-Origin配置的域名，来判断是否允许进行ajax接口请求，如果没有配置跨域资源共享（CORS）机制，那么会报错如下图：<br> <img src="https://images2.imgbox.com/de/56/A16dbYNH_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>贴一个 cors跨域请求的处理过程：https://www.cnblogs.com/xfenfen/p/9378393.html</p> 
<p><font color="red">然后我们要明确一个问题, 请求跨域了，请求到底发出去没有？答案是<strong>肯定发出去了，但是浏览器拦截了响应</strong>。</font></p> 
<h3><a id="_31"></a>浏览器客户端和向服务器跨域请求的判定流程</h3> 
<ol><li> <p>浏览器先根据同源策略对前端页面和后台交互地址做匹配，<strong>若同源</strong>，则直接发送数据请求；<strong>若不同源</strong>，则发送跨域请求。</p> </li><li> <p>服务器解析程序收到浏览器跨域请求后，根据自身配置返回对应文件头即addHeader(‘Access-Control-Allow-Origin:*’);//允许所有来源访问 。若未配置过任何允许跨域，则文件头里不包含Access-Control-Allow-origin字段，若配置过域名，则在response header中返回Access-Control-Allow-origin+ 对应配置规则里的域名的方式。Access-Control-Allow-Origin指定支持访问的域名，不指定的网站不能访问；</p> </li><li> <p>浏览器根据接受到的http文件头里response header的Access-Control-Allow-origin字段做匹配，若无该字段，说明<strong>不允许跨域</strong>；若有该字段，则对字段内容和当前想要请求后端服务的来源域名Origin:https://cloud.mengxiang.com做比对，如果<strong>同源</strong>，则说明<strong>可以跨域</strong>，浏览器发送该请求；若<strong>不同源</strong>，则说明该域名<strong>不可跨域</strong>，不发送请求</p> </li></ol> 
<p>（但是不能仅仅根据服务器返回的文件头里是否包含Access-Control-Allow-origin来判断其是否允许跨域，因为服务器端配置多域名跨域的时候，也会出现不能跨域的域名返回包里没有Access-Control-Allow-origin字段的情况。下文配置说明里会讲。)</p> 
<p>注：header中Access-Control-Allow- credentials该项标志着请求当中是否包含cookies信息</p> 
<h2><a id="_42"></a>跨域问题演示</h2> 
<p>下面链接的博客中演示了如何跨域 和 如何解决跨域问题<br> <a href="https://www.cnblogs.com/vipstone/p/16667239.html" rel="nofollow">面试突击81：什么是跨域问题？如何解决？</a></p> 
<h2><a id="_45"></a>参考</h2> 
<p><a href="https://www.cnblogs.com/T-CYP/p/15425839.html" rel="nofollow">关于cookies网站跨域单点登录的原理 </a><br> <a href="https://www.jianshu.com/p/4b165fecf157" rel="nofollow">cookie的作用域以及跨域设置</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0956ec84b2a775580b9866e192e1f985/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vim基本操作命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/91b0360f333020f64c48559784420078/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">清晰讲解Cookie、Session、Token、JWT之间的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>