<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>爬虫获取电影数据----以沈腾参演电影为例 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="爬虫获取电影数据----以沈腾参演电影为例" />
<meta property="og:description" content="数据可视化&amp;分析实战 1.1 沈腾参演电影数据获取
1.2 电影数据可视化分析
文章目录 数据可视化&amp;分析实战前言1. 网页分析2. 构建数据获取函数2.1 网页数据获取函数2.2 网页照片获取函数 3. 获取参演影视作品基本数据4. 电影详细数据获取4.1 导演、演员、描述、类型、投票人数、评分信息、电影海报获取4.1.1 电影海报获取（以超能一家人为例）：4.1.2 导演、演员信息获取：4.1.3 描述、类型、投票人数、评分信息获取： 4.2 IMDb号、感兴趣的人数，看过的人数信息获取4.2.1 IMDb号获取：4.2.2 感兴趣的人数，看过的人数信息获取: 4.3 详细信息获取全代码 总结 前言 大家好✨，这里是bio🦖。今天为大家带来的是数据获取的一种方法，网络爬虫（Web Crawler）。是一种自动化程序，用于在互联网上获取信息、抓取网页内容并进行数据收集。网络爬虫通过访问网页的链接，并从中提取信息和数据，然后将这些数据保存或用于后续处理和分析。可视化分析已更新：1.2 电影数据可视化分析
网络爬虫的工作流程通常包括以下几个步骤：
发送请求：网络爬虫首先发送HTTP请求到指定的URL，请求获取网页内容。获取响应：网站服务器接收到请求后，会返回相应的网页内容作为HTTP响应。爬虫会获取并接收这个响应内容。解析网页：爬虫会对网页内容进行解析，提取出需要的数据和信息。通常使用HTML解析器或XPath等技术来解析网页的结构和元素。数据提取：从解析的网页中，爬虫会提取出感兴趣的数据，如文字、图片、链接等。存储数据：爬虫将提取的数据保存到数据库、文件或其他存储介质中，以备后续分析和应用。 通过本文获取电影数据信息，为后续的数据可视化提供数据支撑~
1. 网页分析 数据来源于豆瓣电影网，在豆瓣电影网搜索演员沈腾，找到他参演的所有作品（沈腾参演作品）。打开页面发现沈腾一共参演134部作品，其中第一页所有作品均未上映，所以之后获取数据时，可以不用关注第一页。其次应该关注网页链接，查看不同网页链接之间的差异，以便于批量获取数据。
下面是各个页面的链接，通过观察不难看出各个链接之间的差异在start=后的数字，第一页是0，第二页是1，第三页是2……最后一页是13。在上文中说到第一页的所有电影均未上映，未上映的电影没有后续数据可视化可用的数据，故不用获取。使用1到13的循环，便可获取沈腾参演的所有电影数据。
https://movie.douban.com/celebrity/1325700/movies?start=0&amp;format=pic&amp;sortby=time&amp;
https://movie.douban.com/celebrity/1325700/movies?start=10&amp;format=pic&amp;sortby=time&amp;
https://movie.douban.com/celebrity/1325700/movies?start=20&amp;format=pic&amp;sortby=time&amp;
…
https://movie.douban.com/celebrity/1325700/movies?start=130&amp;format=pic&amp;sortby=time&amp;
2. 构建数据获取函数 2.1 网页数据获取函数 由于网络爬虫的访问网站的速度很快，会给网站服务器增加负担，因此网站会设置反爬机制。
为了防止网站检测出来，使用header参数伪造浏览器信号。
然后使用requests包获取网页数据，对获得的文本数据使用gbk编码，同时遗忘不能被gbk编码的数据
最后使用BeautifulSoup对获取的数据转化成html格式。
# time: 2023.07.26 # author: bio大恐龙 # define a function to get website infomation with html format import requests from bs4 import BeautifulSoup def get_url_info(url): headers = {&#39;User-Agent&#39;:&#39;Mozilla/5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3f53a9b51352c4e7b00fbeff3bfc8982/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-15T14:28:12+08:00" />
<meta property="article:modified_time" content="2023-08-15T14:28:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">爬虫获取电影数据----以沈腾参演电影为例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>数据可视化&amp;分析实战</h2> 
<p><a href="https://editor.csdn.net/md/?articleId=132016703" rel="nofollow">1.1 沈腾参演电影数据获取</a><br> <a href="https://editor.csdn.net/md/?articleId=132131218" rel="nofollow">1.2 电影数据可视化分析</a></p> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">数据可视化&amp;分析实战</a></li><li><a href="#_10" rel="nofollow">前言</a></li><li><a href="#1__23" rel="nofollow">1. 网页分析</a></li><li><a href="#2__35" rel="nofollow">2. 构建数据获取函数</a></li><li><ul><li><a href="#21__36" rel="nofollow">2.1 网页数据获取函数</a></li><li><a href="#22__60" rel="nofollow">2.2 网页照片获取函数</a></li></ul> 
  </li><li><a href="#3__74" rel="nofollow">3. 获取参演影视作品基本数据</a></li><li><a href="#4__122" rel="nofollow">4. 电影详细数据获取</a></li><li><ul><li><a href="#41__127" rel="nofollow">4.1 导演、演员、描述、类型、投票人数、评分信息、电影海报获取</a></li><li><ul><li><a href="#411__128" rel="nofollow">4.1.1 电影海报获取（以超能一家人为例）：</a></li><li><a href="#412__136" rel="nofollow">4.1.2 导演、演员信息获取：</a></li><li><a href="#413__143" rel="nofollow">4.1.3 描述、类型、投票人数、评分信息获取：</a></li></ul> 
   </li><li><a href="#42_IMDb_216" rel="nofollow">4.2 IMDb号、感兴趣的人数，看过的人数信息获取</a></li><li><ul><li><a href="#421_IMDb_217" rel="nofollow">4.2.1 IMDb号获取：</a></li><li><a href="#422__226" rel="nofollow">4.2.2 感兴趣的人数，看过的人数信息获取:</a></li></ul> 
   </li><li><a href="#43__245" rel="nofollow">4.3 详细信息获取全代码</a></li></ul> 
  </li><li><a href="#_334" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_10"></a>前言</h2> 
<p>大家好✨，这里是bio🦖。今天为大家带来的是数据获取的一种方法，网络爬虫（Web Crawler）。是一种自动化程序，用于在互联网上获取信息、抓取网页内容并进行数据收集。网络爬虫通过访问网页的链接，并从中提取信息和数据，然后将这些数据保存或用于后续处理和分析。可视化分析已更新：<a href="https://editor.csdn.net/md/?articleId=132131218" rel="nofollow">1.2 电影数据可视化分析</a><br> 网络爬虫的工作流程通常包括以下几个步骤：</p> 
<ol><li>发送请求：网络爬虫首先发送HTTP请求到指定的URL，请求获取网页内容。</li><li>获取响应：网站服务器接收到请求后，会返回相应的网页内容作为HTTP响应。爬虫会获取并接收这个响应内容。</li><li>解析网页：爬虫会对网页内容进行解析，提取出需要的数据和信息。通常使用HTML解析器或XPath等技术来解析网页的结构和元素。</li><li>数据提取：从解析的网页中，爬虫会提取出感兴趣的数据，如文字、图片、链接等。</li><li>存储数据：爬虫将提取的数据保存到数据库、文件或其他存储介质中，以备后续分析和应用。</li></ol> 
<p>通过本文获取电影数据信息，为后续的数据可视化提供数据支撑~</p> 
<hr> 
<h2><a id="1__23"></a>1. 网页分析</h2> 
<p>数据来源于豆瓣电影网，在豆瓣电影网搜索演员沈腾，找到他参演的所有作品（<a href="https://movie.douban.com/celebrity/1325700/movies?start=0&amp;format=pic&amp;sortby=time&amp;" rel="nofollow">沈腾参演作品</a>）。打开页面发现沈腾一共参演134部作品，其中第一页所有作品均未上映，所以之后获取数据时，可以不用关注第一页。其次应该关注网页链接，查看<strong>不同网页链接之间的差异</strong>，以便于批量获取数据。<br> <img src="https://images2.imgbox.com/8c/92/nTUk4Aah_o.png" alt="在这里插入图片描述"></p> 
<p>下面是各个页面的链接，通过观察不难看出各个链接之间的差异在<code>start=</code>后的数字，第一页是<code>0</code>，第二页是<code>1</code>，第三页是<code>2</code>……最后一页是<code>13</code>。在上文中说到第一页的所有电影均未上映，未上映的电影没有后续数据可视化可用的数据，故不用获取。使用<strong>1</strong>到<strong>13</strong>的循环，便可获取沈腾参演的所有电影数据。</p> 
<blockquote> 
 <p>https://movie.douban.com/celebrity/1325700/movies?start=<strong>0</strong>&amp;format=pic&amp;sortby=time&amp;<br> https://movie.douban.com/celebrity/1325700/movies?start=<strong>10</strong>&amp;format=pic&amp;sortby=time&amp;<br> https://movie.douban.com/celebrity/1325700/movies?start=<strong>20</strong>&amp;format=pic&amp;sortby=time&amp;<br> …<br> https://movie.douban.com/celebrity/1325700/movies?start=<strong>130</strong>&amp;format=pic&amp;sortby=time&amp;</p> 
</blockquote> 
<h2><a id="2__35"></a>2. 构建数据获取函数</h2> 
<h3><a id="21__36"></a>2.1 网页数据获取函数</h3> 
<p>由于网络爬虫的访问网站的速度很快，会给网站服务器增加负担，因此网站会设置反爬机制。<br> 为了防止网站检测出来，使用<code>header</code>参数伪造浏览器信号。<br> 然后使用<code>requests</code>包获取网页数据，对获得的文本数据使用<code>gbk</code>编码，同时遗忘不能被<code>gbk</code>编码的数据<br> 最后使用<code>BeautifulSoup</code>对获取的数据转化成<code>html</code>格式。</p> 
<pre><code class="prism language-python"><span class="token comment"># time: 2023.07.26</span>
<span class="token comment"># author: bio大恐龙</span>

<span class="token comment"># define a function to get website infomation with html format</span>
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup

<span class="token keyword">def</span> <span class="token function">get_url_info</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 QIHU 360SE'</span><span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        info <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">,</span> <span class="token string">'ignore'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>info<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> soup
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Sorry! The film information is not got'</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h3><a id="22__60"></a>2.2 网页照片获取函数</h3> 
<p>每个电影都有自己的海报，具有观赏价值。获取的图片数据是二进制数据，所有当保存照片是使用<code>b</code>（二进制写入）。其他代码注释同网页数据获取函数。</p> 
<pre><code class="prism language-python"><span class="token comment"># define a function to download film poster</span>
<span class="token keyword">def</span> <span class="token function">download_image</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> save_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 QIHU 360SE'</span><span class="token punctuation">}</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        image <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>content
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Sorry! failure to download the image'</span><span class="token punctuation">)</span>
</code></pre> 
<hr> 
<h2><a id="3__74"></a>3. 获取参演影视作品基本数据</h2> 
<p>通过网页数据获取函数<code>get_url_info()</code>获取一个任意一个网页的信息，这里以最后一页为例。首先获取参演影视作品（不一定是电影）的名字，URL和年份，之后根据影视作品的URL获取具体信息。<br> 在获取的网页信息中发现，想获得的数据在<code>h6</code>下，因此可以使用<code>BeautifulSoup</code>的<code>find()</code>去获取我们想要的信息。例如，获取年份信息可以使用<code>html_content.find('span').text.strip('()')</code>，其中<code>.text</code>是返回文本信息，<code>strip('()')</code>是去除括号。(假设你已经使用了<code>find(h6)</code>得到了下面html的内容)，</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>案发现场2<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://img1.doubanio.com/view/photo/s_ratio_poster/public/p2466501379.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>案发现场2<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dt</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h6</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://movie.douban.com/subject/3151813/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>案发现场2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>(2007)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>[ 演员 (饰 夏晓强) ]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h6</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>同理，可以获得影视数据的名字、URL。获取第二页到第十四页所有影视作品的基本信息，代码如下，思路与寻找一致。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> time

<span class="token comment"># construct a dataframe to store movies shenteng involved in information</span>
shenteng_movies_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Film_Name'</span><span class="token punctuation">,</span> <span class="token string">'URL'</span><span class="token punctuation">,</span> <span class="token string">'Year'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
the urls of website were constructed as following url with difference in "start" and total pages are 13
'https://movie.douban.com/celebrity/1325700/movies?start=10&amp;format=pic&amp;sortby=time&amp;'
'https://movie.douban.com/celebrity/1325700/movies?start=20&amp;format=pic&amp;sortby=time&amp;'
'''</span>
df_index <span class="token operator">=</span> <span class="token number">0</span>
website_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> website_list<span class="token punctuation">:</span>
    movie_info <span class="token operator">=</span> get_url_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'https://movie.douban.com/celebrity/1325700/movies?start=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">0&amp;format=pic&amp;sortby=time&amp;'</span></span><span class="token punctuation">)</span>
    interest_info <span class="token operator">=</span> movie_info<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'h6'</span><span class="token punctuation">)</span>
    <span class="token comment">#print(interest_info[0].find('span'))</span>
    <span class="token comment">#break</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>interest_info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        movie_year <span class="token operator">=</span> interest_info<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'()'</span><span class="token punctuation">)</span>
        movie_url <span class="token operator">=</span> interest_info<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
        movie_name <span class="token operator">=</span> interest_info<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text
        shenteng_movies_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df_index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>movie_name<span class="token punctuation">,</span> movie_url<span class="token punctuation">,</span> movie_year<span class="token punctuation">]</span>
        df_index <span class="token operator">+=</span> <span class="token number">1</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> 
<p>获取的结果如下，对应的CSV文件可以从CSDN资源库中下载——<a href="https://download.csdn.net/download/ouyangk1026/88152948">沈腾参演影视作品基础信息</a>。<br> <img src="https://images2.imgbox.com/e9/88/LmlyYoQb_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h2><a id="4__122"></a>4. 电影详细数据获取</h2> 
<p>由于后续是想做数据可视化，故拟获取电影名称、URL、年份、导演、演员、类型、投票人数、评分、IMDb号、描述、感兴趣的人数，看过的人数。名称、URL、年份在上一步中已经获取了，这一步主要是为了获取剩余信息，由于部分信息不是电影、且部分电影信息不含有投票人数、感兴趣人数等，需要不断调试，故对最后的全部代码解释可能不全面，如果你没有看懂，欢迎留言or私信。</p> 
<hr> 
<h3><a id="41__127"></a>4.1 导演、演员、描述、类型、投票人数、评分信息、电影海报获取</h3> 
<h4><a id="411__128"></a>4.1.1 电影海报获取（以超能一家人为例）：</h4> 
<p>通过2.1、2.2定义的<code>get_url_info()</code>，<code>download_iamge()</code>函数，在下面的html信息中可以看到<code>"image": "https://img9.doubanio.com/view/photo/s_ratio_poster/public/p2890369636.jpg"</code>在<code>&lt;script type="application/ld+json"&gt;</code>一栏下，所以首先通过<code>find()</code>函数提取这部分信息，然后通过<code>json.load()</code>函数将html格式转换为字典形式，然后根据键名提取对应的值。代码如下：</p> 
<pre><code class="prism language-python">json_data <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"application/ld+json"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 假设movie_info你通过get_url_info()获取的电影信息数据</span>
image_url <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span> <span class="token comment"># 提取图片url</span>
downloaw_image<span class="token punctuation">(</span>image_url<span class="token punctuation">,</span> save_path<span class="token punctuation">)</span> <span class="token comment"># 下载图片</span>
</code></pre> 
<p>获取的海报共计27张，也就是说总共27部电影~~<img src="https://images2.imgbox.com/bf/97/HGiVjDtK_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="412__136"></a>4.1.2 导演、演员信息获取：</h4> 
<p>通过之前转换的字典格式数据，可以轻松获取导演、演员信息。这里只获取中文名</p> 
<pre><code class="prism language-python">director <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'director'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
actors <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> json_data<span class="token punctuation">[</span><span class="token string">'actor'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'[]'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="413__143"></a>4.1.3 描述、类型、投票人数、评分信息获取：</h4> 
<p>同理，运用字典的键值对提取信息即可</p> 
<pre><code class="prism language-python">genre <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>json_data<span class="token punctuation">[</span><span class="token string">'genre'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'[]'</span><span class="token punctuation">)</span> <span class="token comment"># 类型</span>
rating_count <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'aggregateRating'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ratingCount'</span><span class="token punctuation">]</span> <span class="token comment"># 投票人数</span>
rating_value <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'aggregateRating'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ratingValue'</span><span class="token punctuation">]</span> <span class="token comment"># 评分</span>
description <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span> <span class="token comment"># 描述</span>
</code></pre> 
<p>html信息：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>application/ld+json<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
{
  "@context": "http://schema.org",
  "name": "超能一家人",
  "url": "/subject/35228789/",
  "image": "https://img9.doubanio.com/view/photo/s_ratio_poster/public/p2890369636.jpg",
  "director": 
  [
    {
      "@type": "Person",
      "url": "/celebrity/1350407/",
      "name": "宋阳 Yang Song"
    }
  ]
,
  "author": 
  [
    {
      "@type": "Person",
      "url": "/celebrity/1350407/",
      "name": "宋阳 Yang Song"
    }
    ,
    {
      "@type": "Person",
      "url": "/celebrity/1375192/",
      "name": "毕慷 Kang Bi"
    }
  ]
,
  "actor": 
  [
    {
      "@type": "Person",
      "url": "/celebrity/1350408/",
      "name": "艾伦 Allen"
    }
    ,
    {
      "@type": "Person",
      "url": "/celebrity/1325700/",
      "name": "沈腾 Teng Shen"
    }
  ]
,
  "datePublished": "2023-07-21",
  "genre": ["\u559c\u5267", "\u5bb6\u5ead", "\u5947\u5e7b"],
  "duration": "PT1H53M",
  "description": "郑前（艾伦 饰）新开发的APP被狡猾又诚实的反派乞乞科夫（沈腾 饰）盯上了。幸好郑前一家人意外获得了超能力，姐姐会飞天，爸爸能隐身，爷爷不死术，妹妹力大无穷。郑前本指望家人们出手帮忙，一家人却常常出糗...",
  "@type": "Movie",
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingCount": "60348",
    "bestRating": "10",
    "worstRating": "2",
    "ratingValue": "4.0"
  }
}
</code></pre> 
<hr> 
<h3><a id="42_IMDb_216"></a>4.2 IMDb号、感兴趣的人数，看过的人数信息获取</h3> 
<h4><a id="421_IMDb_217"></a>4.2.1 IMDb号获取：</h4> 
<p>IMDb在html信息中如下所示，在<code>span class="pl"</code>下，所以通过<code>find()</code>函数获取该信息所在位置，然后使用<code>next_sibling</code>获取兄弟节点的信息即可，代码如下</p> 
<pre><code class="prism language-python">movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'pl'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"IMDb:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>next_sibling<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>html信息：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pl<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>IMDb:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span> tt12787014<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
</code></pre> 
<h4><a id="422__226"></a>4.2.2 感兴趣的人数，看过的人数信息获取:</h4> 
<p>该信息位于<code>&lt;div class="subject-others-interests-ft"&gt;</code>下，所以先通过find_all()找到信息所在位置，然后提取相关信息即可，代码如下：</p> 
<pre><code class="prism language-python">tem_info <span class="token operator">=</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"subject-others-interests-ft"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
interest_count <span class="token operator">=</span> tem_info<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'人'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
watched_count <span class="token operator">=</span> tem_info<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'人'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> 
<p>html信息：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>subject-others-interests-ft<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://movie.douban.com/subject/35228789/comments?status=P<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>62456人看过<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                 / 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://movie.douban.com/subject/35228789/comments?status=F<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>36999人想看<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<hr> 
<h3><a id="43__245"></a>4.3 详细信息获取全代码</h3> 
<p>其中很多过滤条件是为了筛选掉不属于电影类型的数据，同时为了防止部分电影数据信息缺失造成脚本报错，引入了<code>Tag</code>，是beautifulsoup中的一种类型。</p> 
<p>其中<code>[\x00-\x1F\x7F-\x9F]</code>是不能被转义的符号，故进行替换，防止脚本报错。</p> 
<pre><code class="prism language-python">json_data <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'[\x00-\x1F\x7F-\x9F]'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"application/ld+json"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>最后获得的表现如图所示，对应的CSV文件可以从CSDN资源库中下载——<a href="https://download.csdn.net/download/ouyangk1026/88152949">沈腾参演电影详细信息</a>：</p> 
<p><img src="https://images2.imgbox.com/6c/a0/0pYtz3q7_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> json
<span class="token keyword">import</span> os
<span class="token keyword">from</span> bs4<span class="token punctuation">.</span>element <span class="token keyword">import</span> Tag
<span class="token keyword">import</span> re

<span class="token comment"># create a directory to store the posters of film</span>
dir_path <span class="token operator">=</span> <span class="token string">'/mnt/c/Users/ouyangkang/Desktop/film_poster/'</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>dir_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>dir_path<span class="token punctuation">)</span>
    
<span class="token comment"># construct a dataframe to store new infomation of films</span>
films_detail_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Film_name'</span><span class="token punctuation">,</span> <span class="token string">'URL'</span><span class="token punctuation">,</span> <span class="token string">'Year'</span><span class="token punctuation">,</span> <span class="token string">'Director'</span><span class="token punctuation">,</span> <span class="token string">'Actors'</span><span class="token punctuation">,</span> <span class="token string">'Genre'</span><span class="token punctuation">,</span> <span class="token string">'Rating_count'</span><span class="token punctuation">,</span> <span class="token string">'Rating_value'</span><span class="token punctuation">,</span> <span class="token string">'IMDb'</span><span class="token punctuation">,</span> <span class="token string">'Description'</span><span class="token punctuation">,</span> <span class="token string">'Interesting_count'</span><span class="token punctuation">,</span> <span class="token string">'Watched_count'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># index</span>
initial_number <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> single_movie_url <span class="token keyword">in</span> shenteng_movies_df<span class="token punctuation">[</span><span class="token string">'URL'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    movie_info <span class="token operator">=</span> get_url_info<span class="token punctuation">(</span>single_movie_url<span class="token punctuation">)</span>

    <span class="token comment"># screen non-film infomation and not yet shown</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_sum"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tag<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token string">"暂无"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_sum"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token keyword">and</span> <span class="token string">"尚未"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_sum"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">:</span> 
            <span class="token comment"># construct directory data foramt</span>
            json_data <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'[\x00-\x1F\x7F-\x9F]'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"application/ld+json"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            json_data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>json_data<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> json_data<span class="token punctuation">[</span><span class="token string">'@type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Movie'</span> <span class="token keyword">and</span> json_data<span class="token punctuation">[</span><span class="token string">'aggregateRating'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ratingValue'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">and</span> json_data<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">""</span> <span class="token keyword">and</span> <span class="token string">"真人秀"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> json_data<span class="token punctuation">[</span><span class="token string">'genre'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">"脱口秀"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> json_data<span class="token punctuation">[</span><span class="token string">'genre'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">'歌舞'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> json_data<span class="token punctuation">[</span><span class="token string">'genre'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token comment"># name</span>
                name <span class="token operator">=</span> shenteng_movies_df<span class="token punctuation">[</span>shenteng_movies_df<span class="token punctuation">[</span><span class="token string">"URL"</span><span class="token punctuation">]</span> <span class="token operator">==</span> single_movie_url<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Film_Name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token comment"># url</span>
                url <span class="token operator">=</span> single_movie_url
                <span class="token comment"># year</span>
                year <span class="token operator">=</span> shenteng_movies_df<span class="token punctuation">[</span>shenteng_movies_df<span class="token punctuation">[</span><span class="token string">"URL"</span><span class="token punctuation">]</span> <span class="token operator">==</span> single_movie_url<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Year'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token comment"># director</span>
                director <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'director'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token comment"># actors</span>
                actors <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> json_data<span class="token punctuation">[</span><span class="token string">'actor'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'[]'</span><span class="token punctuation">)</span> <span class="token comment"># only chinese name</span>
                <span class="token comment"># genre</span>
                genre <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>json_data<span class="token punctuation">[</span><span class="token string">'genre'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'[]'</span><span class="token punctuation">)</span>
                <span class="token comment"># rating count</span>
                rating_count <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'aggregateRating'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ratingCount'</span><span class="token punctuation">]</span>
                <span class="token comment"># rating value</span>
                rating_value <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'aggregateRating'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ratingValue'</span><span class="token punctuation">]</span>
                <span class="token comment"># IMDb</span>
                <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'pl'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"IMDb:"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tag<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    imdb <span class="token operator">=</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'pl'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"IMDb:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>next_sibling<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    imdb <span class="token operator">=</span> <span class="token boolean">None</span>
                <span class="token comment"># description</span>
                description <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span>
                <span class="token comment"># how many people are interested in the film and had watched</span>
                <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"subject-others-interests-ft"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Tag<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    tem_info <span class="token operator">=</span> movie_info<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"subject-others-interests-ft"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
                    interest_count <span class="token operator">=</span> tem_info<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'人'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                    watched_count <span class="token operator">=</span> tem_info<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'人'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    interest_count <span class="token operator">=</span> <span class="token boolean">None</span>
                    watched_count <span class="token operator">=</span> <span class="token boolean">None</span>
                <span class="token comment"># poster url</span>
                image_url <span class="token operator">=</span> json_data<span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span>
                
                films_detail_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>initial_number<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> url<span class="token punctuation">,</span> year<span class="token punctuation">,</span> director<span class="token punctuation">,</span> actors<span class="token punctuation">,</span> genre<span class="token punctuation">,</span> rating_count<span class="token punctuation">,</span> rating_value<span class="token punctuation">,</span> imdb<span class="token punctuation">,</span> description<span class="token punctuation">,</span> interest_count<span class="token punctuation">,</span> watched_count<span class="token punctuation">]</span>
                initial_number <span class="token operator">+=</span> <span class="token number">1</span>

                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
                save_path <span class="token operator">=</span> dir_path <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'.jpg'</span>
                download_image<span class="token punctuation">(</span>image_url<span class="token punctuation">,</span> save_path<span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>

films_detail_df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># conserve file</span>
<span class="token comment"># films_detail_df.to_csv('/mnt/c/Users/ouyangkang/Desktop/films_info.csv', index=None, encoding='gbk')</span>
</code></pre> 
<hr> 
<h2><a id="_334"></a>总结</h2> 
<p>本文向大家介绍如何获取网页信息（以电影信息为例），但是相关的函数功能并没有详细介绍，如果你有疑问可以留言、私信或者自行百度，这里向大家提供的是一个思路，先定位信息的位置，然后通过将html数据转换为字典数据提取相关信息，当然你也可以使用正则表达式提取你想提取的信息。</p> 
<p>感谢大家的观看，如果期待后续的可视化文章（已更新<a href="https://editor.csdn.net/md/?articleId=132131218" rel="nofollow">1.2 电影数据可视化分析</a>），点点关注不迷路~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ba720969efb4b9dfac00d6d8e3bf3c73/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">抖音小程序页面链接/导航</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/87a845cbd7f212b5074db4f14ec37373/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">day8 STM32数据搬运工 - DMA</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>