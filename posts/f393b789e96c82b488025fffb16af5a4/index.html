<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PHP的cURL库简单和有效地抓网页 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PHP的cURL库简单和有效地抓网页" />
<meta property="og:description" content="核心提示：使用PHP的cURL库可以简单和有效地去抓网页。你只需要运行一个脚本，然后分析一下你所抓取的网页，然后就可以以程序的方式得到你想要的数据了。
使用PHP的cURL库可以简单和有效地去抓网页。你只需要运行一个脚本，然后分析一下你所抓取的网页，然后就可以以程序的方式得到你想要的数据了。无论是你想从从一个链接上取部分数据，或是取一个XML文件并把其导入数据库，那怕就是简单的获取网页内容，cURL 是一个功能强大的PHP库。本文主要讲述如果使用这个PHP库。
启用 cURL 设置
首先，我们得先要确定我们的PHP是否开启了这个库，你可以通过使用php_info()函数来得到这一信息。
&lt;?php
phpinfo();
?&gt;
如果你可以在网页上看到下面的输出，那么表示cURL库已被开启。
如果你看到的话，那么你需要设置你的PHP并开启这个库。如果你是在Windows平台下，那么非常简单，你需要改一改你的php.ini文件的设置，找到php_curl.dll，并取消前面的分号注释就行了。如下所示：
//取消下在的注释
extension=php_curl.dll
如果你是在Linux下面，那么，你需要重新编译你的PHP了，编辑时，你需要打开编译参数——在configure命令上加上“–with-curl” 参数。
一个小示例
如果一切就绪，下面是一个小例程：
&lt;?php
// 初始化一个 cURL 对象
$curl = curl_init();
// 设置你需要抓取的URL
curl_setopt($curl, CURLOPT_URL, &#39;http://cocre.com&#39;);
// 设置header
curl_setopt($curl, CURLOPT_HEADER, 1);
// 设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上。
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
// 运行cURL，请求网页
$data = curl_exec($curl);
// 关闭URL请求
curl_close($curl);
// 显示获得的数据
var_dump($data);
?&gt;
如何POST数据
上面是抓取网页的代码，下面则是向某个网页POST数据。假设我们有一个处理表单的网址http://www.example.com/sendSMS.php，其可以接受两个表单域，一个是电话号码，一个是短信内容。
&lt;?php
$phoneNumber = &#39;13912345678&#39;;
$message = &#39;This message was generated by curl and php&#39;;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f393b789e96c82b488025fffb16af5a4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-11T09:58:57+08:00" />
<meta property="article:modified_time" content="2021-01-11T09:58:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PHP的cURL库简单和有效地抓网页</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>核心提示：</strong>使用PHP的cURL库可以简单和有效地去抓网页。你只需要运行一个脚本，然后分析一下你所抓取的网页，然后就可以以程序的方式得到你想要的数据了。</p> 
<p>使用PHP的cURL库可以简单和有效地去抓网页。你只需要运行一个脚本，然后分析一下你所抓取的网页，然后就可以以程序的方式得到你想要的数据了。无论是你想从从一个链接上取部分数据，或是取一个XML文件并把其导入数据库，那怕就是简单的获取网页内容，cURL 是一个功能强大的PHP库。本文主要讲述如果使用这个PHP库。</p> 
<p> </p> 
<p>启用 cURL 设置</p> 
<p> </p> 
<p>首先，我们得先要确定我们的PHP是否开启了这个库，你可以通过使用php_info()函数来得到这一信息。</p> 
<p> </p> 
<p>&lt;?php<br> phpinfo();<br> ?&gt;</p> 
<p> </p> 
<p>如果你可以在网页上看到下面的输出，那么表示cURL库已被开启。</p> 
<p> </p> 
<p>如果你看到的话，那么你需要设置你的PHP并开启这个库。如果你是在Windows平台下，那么非常简单，你需要改一改你的php.ini文件的设置，找到php_curl.dll，并取消前面的分号注释就行了。如下所示：</p> 
<p> </p> 
<p>//取消下在的注释<br> extension=php_curl.dll</p> 
<p> </p> 
<p>如果你是在Linux下面，那么，你需要重新编译你的PHP了，编辑时，你需要打开编译参数——在configure命令上加上“–with-curl” 参数。</p> 
<p> </p> 
<p>一个小示例</p> 
<p> </p> 
<p>如果一切就绪，下面是一个小例程：</p> 
<p> </p> 
<p>&lt;?php<br> // 初始化一个 cURL 对象<br> $curl = curl_init();</p> 
<p>// 设置你需要抓取的URL<br> curl_setopt($curl, CURLOPT_URL, 'http://cocre.com');</p> 
<p>// 设置header<br> curl_setopt($curl, CURLOPT_HEADER, 1);</p> 
<p>// 设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上。<br> curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);</p> 
<p>// 运行cURL，请求网页<br> $data = curl_exec($curl);</p> 
<p>// 关闭URL请求<br> curl_close($curl);</p> 
<p>// 显示获得的数据<br> var_dump($data);<br> ?&gt;</p> 
<p> </p> 
<p>如何POST数据</p> 
<p> </p> 
<p>上面是抓取网页的代码，下面则是向某个网页POST数据。假设我们有一个处理表单的网址http://www.example.com/sendSMS.php，其可以接受两个表单域，一个是电话号码，一个是短信内容。</p> 
<p> </p> 
<p>&lt;?php<br> $phoneNumber = '13912345678';<br> $message = 'This message was generated by curl and php';<br> $curlPost = 'pNUMBER=' . urlencode($phoneNumber) . '&amp;MESSAGE=' . urlencode($message) . '&amp;SUBMIT=Send';<br> $ch = curl_init();<br> curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/sendSMS.php');<br> curl_setopt($ch, CURLOPT_HEADER, 1);<br> curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);<br> curl_setopt($ch, CURLOPT_POST, 1);<br> curl_setopt($ch, CURLOPT_POSTFIELDS, $curlPost);<br> $data = curl_exec();curl_close($ch);<br> ?&gt;</p> 
<p> </p> 
<p>从上面的程序我们可以看到，使用CURLOPT_POST设置HTTP协议的POST方法，而不是GET方法，然后以CURLOPT_POSTFIELDS设置POST的数据。</p> 
<p> </p> 
<p>关于代理服务器</p> 
<p> </p> 
<p>下面是一个如何使用代理服务器的示例。请注意其中高亮的代码，代码很简单，我就不用多说了。</p> 
<p> </p> 
<p>&lt;?php<br> $ch = curl_init();<br> curl_setopt($ch, CURLOPT_URL, 'http://www.example.com');<br> curl_setopt($ch, CURLOPT_HEADER, 1);<br> curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);<br> curl_setopt($ch, CURLOPT_HTTPPROXYTUNNEL, 1);<br> curl_setopt($ch, CURLOPT_PROXY, 'fakeproxy.com:1080');<br> curl_setopt($ch, CURLOPT_PROXYUSERPWD, 'user:password');<br> $data = curl_exec();curl_close($ch);<br> ?&gt;</p> 
<p> </p> 
<p>关于SSL和Cookie</p> 
<p> </p> 
<p>关于SSL也就是HTTPS协议，你只需要把CURLOPT_URL连接中的http://变成https://就可以了。当然，还有一个参数叫CURLOPT_SSL_VERIFYHOST可以设置为验证站点。</p> 
<p> </p> 
<p>关于Cookie，你需要了解下面三个参数：</p> 
<p> </p> 
<p>CURLOPT_COOKIE，在当面的会话中设置一个cookie</p> 
<p>CURLOPT_COOKIEJAR，当会话结束的时候保存一个Cookie</p> 
<p>CURLOPT_COOKIEFILE，Cookie的文件。</p> 
<p> </p> 
<p>HTTP服务器认证</p> 
<p> </p> 
<p>最后，我们来看一看HTTP服务器认证的情况。</p> 
<p> </p> 
<p>&lt;?php<br> $ch = curl_init();<br> curl_setopt($ch, CURLOPT_URL, 'http://www.example.com');<br> curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);<br> curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);<br> curl_setopt(CURLOPT_USERPWD, '[username]:[password]')</p> 
<p>$data = curl_exec();<br> curl_close($ch);<br> ?&gt;</p> 
<p> </p> 
<p>关于其它更多的内容，请参看相关的cURL手册。</p> 
<p><br> 关于更多<strong>php教程</strong>内容，可以收藏本网页。<br><a href="http://www.82te.com/" rel="nofollow">上海财经</a>上海财经网是上海新闻门户网，每天发布财经信息！股市行情,服务与上海百姓息息相关的理财生活.通过上海财经网让更多人了解上海,让上海本土更好的了解本地资讯。</p> 
<p>转载请说明来源于"<a href="http://www.96096.cc/" rel="nofollow">厦门SEO</a>"</p> 
<p>本文地址：<a href="http://www.96096.cc/Article/5834.html" rel="nofollow">http://www.96096.cc/Article/5834.html</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/51693455cb7b89c9f30be25b97907687/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">PHP基础配置:PHP最常用的ini函数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5e776bdea7a5a66beb8edbf55f5a7f4e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mac技巧|如何阻止 iCloud 同步某个文件夹？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>