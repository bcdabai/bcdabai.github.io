<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>漫画网站爬虫详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="漫画网站爬虫详解" />
<meta property="og:description" content="下面对 http://www.svmhz.com/shaonvmanhua/进行爬取，对大神的博客（ http://www.jianshu.com/p/8b4a589f7980）进行详解： 根据网页图片查看响应代码，选中√的地方 查看源代码的方法，浏览器页面按下F12，然后鼠标移动到某个图片时，下面的代码就会变暗 如下，选中网页上的图片时，下面的响应代码就会变暗 鼠标挪动到图片上就出现了 下面对爬虫的代码进行逐行解释 ------------------------------ 下面解释get_index_page(offset)函数----------------------------- url = &#39;http://www.svmhz.com/shaonvmanhua/list_4_%s.html&#39; % offset 解释： 以上两张图的3是对应的 该图中的3是对漫画列表提供索引 offset相当于形参，把数据传给s，所以两者前面都有%s 该代码大意比较清楚，如果等待时间比较长，则响应异常，输出相关异常信息 ------------------------------get_index_page(offset)函数------------------------- ######## 下面解释parser_index_page(html)函数----------- 入口参数html代表的是网页源代码 listcon_tag = soup.find(&#39;ul&#39;, class_=&#39;listcon&#39;)#属性为listcon的列表 列表中的元素&lt;li&gt;........&lt;/li&gt;是每本漫画书的入口 随便打开列表中的一个元素，会发现以下内容 url_list = listcon_tag.find_all(&#39;a&#39;, attrs={&#39;href&#39;: True}) 这句话是对网页源代码中 包含的所有漫画书连接 进行提取，得到满足需要的部分网页源代码 urls = [&#39;http://www.svmhz.com&#39; &#43; url[&#39;href&#39;] for url in url_list]#遍历子网页的子网页，遍历干净为止。 上述代码也就是说，从url_list集合（当前网页的部分源代码）中提取出对链接修饰的部分，拼接到当前网址： http://www.svmhz.com 拼接后的结果传给urls集合 该函数的目的是为了获取每本漫画的入口地址，也就是漫画的第一页的地址 函数解释结束 ########parser_index_page(html)函数解释结束######### ##############get_image_page(url, total)函数讲解############ 入口参数url举例： http://www.svmhz.com/shaonvmanhua/9894.html total举例(纯数字) ：89 list_url = [ ] 解释： 创建一个列表 list_url.append(url) 在列表中加入每一本漫画入口地址 url = url." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0fddf2724d4acf3755a93540bc8d4f51/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-04-28T00:16:49+08:00" />
<meta property="article:modified_time" content="2017-04-28T00:16:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">漫画网站爬虫详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  下面对 
 <a target="_blank" href="http://www.svmhz.com/shaonvmanhua/" rel="nofollow noopener noreferrer" style="color:rgb(49,148,208); font-size:16px">http://www.svmhz.com/shaonvmanhua/</a>进行爬取，对大神的博客（ 
 <a target="_blank" href="http://blog.csdn.net/appleyuchi/article/details/70881055" style='color:rgb(34,0,0); text-decoration:none; font-family:微软雅黑,"MS Sans Serif",sans-serif; font-size:13px; background-color:rgb(255,237,196)' rel="noopener noreferrer">http://www.jianshu.com/p/8b4a589f7980</a>）进行详解： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  根据网页图片查看响应代码，选中√的地方 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  查看源代码的方法，浏览器页面按下F12，然后鼠标移动到某个图片时，下面的代码就会变暗 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDD4rBTP61" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/d5/23/Ei2OnzuK_o.gif" id="image_operate_8361493309459573" alt="" style="border:0px"></a> 
</div> 
<br style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  如下，选中网页上的图片时，下面的响应代码就会变暗 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDD5LZKle5" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/e9/ac/eT90nkpo_o.gif" id="image_operate_60731493309010557" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  鼠标挪动到图片上就出现了 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  下面对爬虫的代码进行逐行解释 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <hr> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  ------------------------------ 下面解释get_index_page(offset)函数----------------------------- 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  url  
 <span style="line-height:1.5; font-weight:bold">= </span> 
 <span style="line-height:1.5; font-weight:bold">'http://www.svmhz.com/shaonvmanhua/list_4_%s.html' </span> 
 <span style="line-height:1.5; font-weight:bold">% </span>offset 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  解释： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDbEWAefe" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/8c/c5/LUHLbC6e_o.gif" id="image_operate_9441493309089165" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDaeEdpef" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/08/a6/CBsoCLLY_o.gif" id="image_operate_93731493309088964" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  以上两张图的3是对应的 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  该图中的3是对漫画列表提供索引 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  offset相当于形参，把数据传给s，所以两者前面都有%s 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  该代码大意比较清楚，如果等待时间比较长，则响应异常，输出相关异常信息 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  ------------------------------get_index_page(offset)函数------------------------- 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(65,0,125)"><strong>######## 下面解释parser_index_page(html)函数-----------</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  入口参数html代表的是网页源代码 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  listcon_tag = soup.find('ul', class_='listcon')#属性为listcon的列表 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDh5TEY90" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/63/65/aa4Wlrvx_o.gif" id="image_operate_45511493309097749" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  列表中的元素&lt;li&gt;........&lt;/li&gt;是每本漫画书的入口 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDhVmQU50" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/b3/d4/po6fcVnH_o.gif" id="image_operate_54321493309115108" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  随便打开列表中的一个元素，会发现以下内容 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDiTLjEc6" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/88/cb/yUJtHfKj_o.gif" id="image_operate_25841493309121780" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
   url_list = listcon_tag.find_all('a', attrs={'href': True}) 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  这句话是对网页源代码中  包含的所有漫画书连接 进行提取，得到满足需要的部分网页源代码 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
   urls = ['http://www.svmhz.com' + url['href'] for url in url_list]#遍历子网页的子网页，遍历干净为止。 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  上述代码也就是说，从url_list集合（当前网页的部分源代码）中提取出对链接修饰的部分，拼接到当前网址： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://www.svmhz.com/" rel="nofollow noopener noreferrer">http://www.svmhz.com</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  拼接后的结果传给urls集合 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  该函数的目的是为了获取每本漫画的入口地址，也就是漫画的第一页的地址 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  函数解释结束 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(65,0,125)"><strong>########parser_index_page(html)函数解释结束#########</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(65,0,125)"><strong>##############get_image_page(url, total)函数讲解############</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  入口参数url举例： 
 <a target="_blank" href="http://www.svmhz.com/shaonvmanhua/9894.html" rel="nofollow noopener noreferrer">http://www.svmhz.com/shaonvmanhua/9894.html</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  total举例(纯数字) ：89 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  list_url = [ ] 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  解释： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  创建一个列表 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
    list_url.append(url) 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  在列表中加入每一本漫画入口地址 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  url = url.split('.html', 2)[0] 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  把这个url以.html为标记切割2次，切割结果中取第一个 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  for i in range(2,total+1): 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  解释： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  total+1是取不到的，所以循环的区间是[2,total+1) 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  urls = url + '_' + str(i) + '.html' 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  ulrs举例： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://www.svmhz.com/shaonvmanhua/6952_165.html%EF%BC%8C" rel="nofollow noopener noreferrer">http://www.svmhz.com/shaonvmanhua/6952_165.html，</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  这个已经是具体到了某特定漫画书的具体某一页了 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  也就是说该函数的大意是：首先获得每本函数的入口地址，切割改地址后， 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  后面拼接上页码和html，形成新的地址。 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  也就是说该函数的目的是：从漫画入口地址=&gt;漫画具体某一页的地址。 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  新地址存入list_url集合 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(65,0,125)"><strong>############get_image_page(url, total)函数讲解结束######</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(65,0,125)">##############parser_image_page(url)讲解#############</span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  该函数的目的是为了获取带有总页数信息 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  函数的前面部分是为了判断响应是否超时 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  htmls = etree.HTML(html) 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  total = htmls.xpath('//*[@id="mh_content"]/div[@class="dede_pages_all"]/div/ul/li[1]/a/text()')[0]#右键复制网页源码中的Xpath，然后粘贴 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  粘贴的办法是： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDmQabs8e" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/83/81/y3lRVB3k_o.gif" id="image_operate_93741493309185108" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  粘贴结果是：//*[@id="mh_content"]/div[4]/div/ul/li[1]/a 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  对上述结果进行修改，用 text()函数获取内容 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  div[4]修改为: 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  div[@class="dede_pages_all"] 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  div[@class="dede_pages_all"]要作为一个整体来看，也算是特征匹配 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  dede_pages_all来自下图： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDnS31cf6" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/72/ea/hAQSoFAl_o.gif" id="image_operate_13161493309230373" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  此类路径成为xpath，用于对页面的对象存储的所在路径进行定位。 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style='font-family:微软雅黑,"MS Sans Serif",sans-serif; line-height:1.5; font-size:17px'>xpath就是js代码中存储某个标签对应的类对象的路径,根据该路径直达图片的存储网址</span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; font-size:17px"><span style='font-family:微软雅黑,"MS Sans Serif",sans-serif; line-height:1.5'><br style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'> </span></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  最终该函数返回total，也即漫画的总页数 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)">-----------------</span><span style="line-height:1.5; color:rgb(65,0,125)">parser_image_page(url)函数讲解结束</span><span style="line-height:1.5; color:rgb(118,0,216)">---------------------------------</span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)">---------------------------------get_image_src(url)讲解</span><span style="line-height:1.5; color:rgb(118,0,216)">---------------------------------</span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>入口的链接举例：</strong> 
 <a target="_blank" href="http://www.svmhz.com/shaonvmanhua/9370_4.html" rel="nofollow noopener noreferrer"></a> 
 <a target="_blank" href="http://www.svmhz.com/shaonvmanhua/9370_4.html" rel="nofollow noopener noreferrer">http://www.svmhz.com/shaonvmanhua/9370_4.html</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  该链接是漫画的具体第几页的链接 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  该函数的作用是向链接发送请求，并且获得响应。 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)">---------------------------------</span><span style="line-height:1.5; color:rgb(118,0,216)">---</span><span style="line-height:1.5; color:rgb(118,0,216)">get_imag<span style="line-height:1.5; color:rgb(106,0,129)">e_src(url)</span></span><span style="line-height:1.5; color:rgb(106,0,129)"> 讲解结束</span><span style="line-height:1.5; color:rgb(118,0,216)"><span style="line-height:1.5; color:rgb(106,0,129)">-----</span>------------------</span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>-------------------------------</strong></span>  
 <strong><span style="line-height:1.5; color:rgb(118,0,216)">parser_img_src(html)讲解</span></strong> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>-------------------------------</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>if语句前出现的变量所代表的对象的具体举例：</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>titles=【日本漫画】色列本子之[U.R.C] 慧ちゃん限定(13)_少女漫画站</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>title_page= 【日本漫画】色列本子之[U.R.C] 慧ちゃん限定(13)</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>title= 【日本漫画】色列本子之[U.R.C] 慧ちゃん限定</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>if语句后出现的变量的含义如图示</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDsu3Mf6b" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/06/7c/b13z6ENy_o.gif" id="image_operate_99771493309260245" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  如上图， 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDte0A1f9" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/76/1a/xYU7cMYp_o.gif" id="image_operate_73911493309276396" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style="font-family:宋体; line-height:1.5; background-color:rgb(64,64,64); color:rgb(155,194,142); font-size:14.3pt"> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; background-color:rgb(77,68,77)'>img_span</span>  
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>= </strong></span>soup.find 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>(</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,181,128)'><strong>'ul'</strong></span>,  
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(216,246,156)'><strong>{<!-- --></strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,181,128)'><strong>'class'</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>: </strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,181,128)'><strong>'mnlt'</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(216,246,156)'><strong>}</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>)</strong></span> 
</div> 
<div style="font-family:宋体; line-height:1.5; background-color:rgb(64,64,64); color:rgb(155,194,142); font-size:14.3pt"> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>用于在网页源代码中找到图片的存储地址所在的范围</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>可以看到，上图中有个&lt;img src&gt;接下来进行正则提取，</strong> 
 <div style="line-height:1.5">
   进一步锁定范围 
 </div> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  锁定符合特征的&lt;img src&gt; 
</div> 
<div style="font-family:宋体; line-height:1.5; background-color:rgb(64,64,64); color:rgb(155,194,142); font-size:14.3pt">
  img_src  
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>= </strong></span>img_span.find_all 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>(</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,181,128)'><strong>'img'</strong></span>,  
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(102,0,153)'>src</span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>=</strong></span>re.compile 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>(</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,181,128)'><strong>'^http://tu.goldlevi.com/svmhz/uploads2/allimg/[0-9]{1,}/(.*?).jpg$'</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>))</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style='font-family:微软雅黑,"MS Sans Serif",sans-serif; line-height:1.5; font-size:13px'>上面的（。*？）是贪婪匹配</span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  for url in img_src: 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
      urls = url['src'] 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
      down_image(urls, title, titles)#调用了down_image函数 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  从url中进一步提取src部分然后赋值给urls，这样urls就得到了图片的存储地址 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  这里必须一步步搜索范围，否则会把其他不相关的图片包括进来 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>-------------------------------</strong></span> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)">parser_img_src(html)讲解结束</span></strong> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>---------------------------</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>---------------------------</strong></span>  
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"> down_image(url, title, titles)</span></strong> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>-------------------------------</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>入口参数举例</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>url = http: // tu.goldlevi.com / svmhz / uploads2 / allimg / 161129 / 2 - 161129102620.jpg</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>title = 莲子酱绅士福利本 动漫本子邪恶少女漫画</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>titles = 莲子酱绅士福利本 动漫本子邪恶少女漫画_少女漫画站</strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><br style="line-height:1.5"> </strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong>调用</strong> 
 <span style="line-height:1.5; color:rgb(134,0,164)"><strong>save_image函数进行下载，本函数还进行请求，判断请求是否会超时</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><br style="line-height:1.5"> </strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><br style="line-height:1.5"> </strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>------------------</strong></span>  
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"> down_image(url, title, titles)讲解结束</span></strong> 
 <span style="line-height:1.5; color:rgb(118,0,216)"><strong>-------------------------------</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(118,0,216)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(134,0,164)"><strong>------------------------save_image(content, title, url, titles)讲解----------------</strong></span> 
</div> 
<div style="font-family:宋体; line-height:1.5; background-color:rgb(64,64,64); color:rgb(155,194,142); font-size:14.3pt">
  path  
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>= </strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,181,128)'><strong>'D:/pic/' </strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>+ </strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(0,204,204)'>str</span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>(</strong></span>title 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>)</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,102,102)'>#确定保存在哪个文件夹下面<br style="line-height:1.5"> </span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(204,153,0)'><strong>if not </strong></span>os.path.exists 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>(</strong></span>path 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5'><strong>)</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,255,255)'><strong>:</strong></span> 
 <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,102,102)'>#如果文件夹不存在，就进行保存</span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; font-size:14.3pt"><span style="font-family:宋体; line-height:1.5"><span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(255,102,102)'>   </span> <span style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; color:rgb(155,194,142)'>os.mkdir<span style="line-height:1.5; font-weight:bold">(</span>path<span style="line-height:1.5; font-weight:bold">)</span></span></span></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDx7fix71" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/2e/67/bBt6HPnE_o.gif" id="image_operate_90301493309342635" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  file_name的开头是结构，后面是path,titles和.jpg，分别替换用彩色线条连接的部分 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <strong><span style="line-height:1.5; color:rgb(209,0,255)"><br style="line-height:1.5"> </span></strong> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <span style="line-height:1.5; color:rgb(209,0,255)"><strong>------------------------------save_image(content, title, url, titles)结束----------------</strong></span> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  #########################结尾################### 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  if __name__ == '__main__': 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
      groups = [x for x in range(1, 86)]#爬http://www.svmhz.com/shaonvmanhua/的一部分，总共有85页 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
      pool = Pool() 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
      pool.map(main, groups)# 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://album.sina.com.cn/pic/0028Ht2Kzy7aDDz2dnVff" rel="nofollow noopener noreferrer"><img src="https://images2.imgbox.com/a8/52/rcUn7HKz_o.gif" id="image_operate_39671493309564909" alt="" style="border:0px"></a> 
 <br style="line-height:1.5"> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  ########################结尾讲解结束################### 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  ——————————————————————附上Python3.6源代码—————————————————————————— 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <pre><code class="language-python">#-*- coding: utf-8 -*-#-*- coding: utf-8 -*-
from requests.exceptions import RequestException
from bs4 import BeautifulSoup
from multiprocessing import Pool
from lxml import etree
import requests, os, re


def get_index_page(offset):#√
    url = 'http://www.svmhz.com/shaonvmanhua/list_4_%s.html' % offset#offset是形参，用来传给s
    try:
        response = requests.get(url)
        response.encoding = response.apparent_encoding
        if response.status_code == 200:
            return response.text
        print('链接返回出现异常')
        return None
    except RequestException:
        print('爬虫出现异常')
        return None


def parser_index_page(html):#√该函数是为了找到漫画对应的连接在什么地方
    soup = BeautifulSoup(html, 'lxml')
    listcon_tag = soup.find('ul', class_='listcon')#属性为listcon的列表
#在源码中被ui包起来的部分，也就是找到被ul包围起来的列表
    if listcon_tag:
        url_list = listcon_tag.find_all('a', attrs={'href': True})#找到所有的修正部分
        #print("url_list",url_list)
        if url_list:
            urls = ['http://www.svmhz.com' + url['href'] for url in url_list]#遍历子网页的子网页，遍历干净为止。
            return urls#获得各个漫画本的入口的集合,例如http://www.svmhz.com/shaonvmanhua/9642.html


def get_image_page(url, total):#√该函数是为了获取所有子网页的集合
    list_url = []#python的列表创建
    list_url.append(url)
    #print("################")
    #print("url = ",url)
    #print("################")
    #print("total = ",total)
    url = url.split('.html', 2)[0]#把这个url以.html为标记切割2次，切割结果中取第一个
    for i in range(2,total+1):#total+1是取不到的


        urls = url + '_' + str(i) + '.html'#ulrs举例：http://www.svmhz.com/shaonvmanhua/6952_165.html，这个已经是具体到了某特定漫画书的具体某一页了
        list_url.append(urls)
    return list_url#这个函数之所以这么处理，并且序号从2开始，是因为漫画打开后的第一页是没有页码的，页数从每本漫画的第2页才开始


def parser_image_page(url):#获取带有总页数信息的字符串
    try:
        response = requests.get(url)
        response.encoding = response.apparent_encoding
        if response.status_code == 200:
            html = response.text
            htmls = etree.HTML(html)#提取页面数据
            total = htmls.xpath('//*[@id="mh_content"]/div[@class="dede_pages_all"]/div/ul/li[1]/a/text()')[0]#右键复制网页源码中的Xpath，然后粘贴
            if total:
                return total#这里返回的信息举例：“本漫画共69页”
        print('链接异常')
        return None
    except RequestException:
        print('爬虫异常')
        return None


def get_image_src(url):
    #print("此处的url",url)#举例：http://www.svmhz.com/shaonvmanhua/9370_4.html
    try:
        response = requests.get(url)
        print("response",response)
        response.encoding = response.apparent_encoding
        if response.status_code == 200:
            return response.text
        print('链接异常')
        return None
    except RequestException:
        print('爬虫异常')
        return None


def parser_img_src(html):#这里html是网页源码
    soup = BeautifulSoup(html, 'lxml')#soup是beautifulsoup解析过的html
    titles = soup.select('title')[0].get_text()#有可能会有其他的title，但是不需要,这里指需要第一个,
    #print("这里分割：", titles)#日本漫画】色列本子之[U.R.C] 慧ちゃん限定(2)_少女漫画站,(2)是页码
    title_page = titles.split('_', 2)[0]#titles是创立图片时需要使用的名字，title是创立文件夹需要的名字
    #print("title_page=",title_page)
    title = title_page.split('(', 2)[0]#保留（左边的部分
    #print("title=", title)
    img_span = soup.find('ul', {'class': 'mnlt'})
    if img_span:
        img_src = img_span.find_all('img', src=re.compile('^http://tu.goldlevi.com/svmhz/uploads2/allimg/[0-9]{1,}/(.*?).jpg$'))
        if img_src:
            for url in img_src:
                urls = url['src']
                down_image(urls, title, titles)#调用了down_image函数


def down_image(url, title, titles):#根据入口链接对漫画进行下载
    #url = http: // tu.goldlevi.com / svmhz / uploads2 / allimg / 161129 / 2 - 161129102620.j
    #title = 莲子酱绅士福利本 动漫本子邪恶少女漫画
    #titles = 莲子酱绅士福利本 动漫本子邪恶少女漫画_少女漫画站
    try:
        response = requests.get(url)
        if response.status_code == 200:
            save_image(response.content, title, url, titles)#调用函数进行对图片的保存
        print('链接异常')
        return None
    except RequestException:
        print('爬虫异常')
        return None


def save_image(content, title, url, titles):
    path = 'D:/pic/' + str(title)#确定保存在哪个文件夹下面
    if not os.path.exists(path):#如果文件夹不存在，就进行保存
        os.mkdir(path)
    file_name = '{0}/{1}.{2}'.format(path, titles, '.jpg')#{1}.{2}中{1}是名字，{2}是后缀，{0}是文件夹路径
    #print("file_name=",file_name)
    if not os.path.exists(file_name):#如果以该文件为名义的文件不存在
        with open(file_name, 'wb') as f:#读写建立一个新的二进制文件
            f.write(content)
            print('保存漫画成功', title, url)
            f.close()


def main(offset):
    html = get_index_page(offset)#html初始化
    for url in parser_index_page(html):#这里的html是按了F12之后出现的网页源代码，in后面是深层次便利后的 子网页连接的集合
        html = parser_image_page(url)#html代表总页码相关的字符串，例如“本漫画共有89页”
        total = int(re.compile('(\d+)').search(html).group(1))#从带有总页码信息的文字字符串中提取出纯数字信息，提取后结果为：89
        for img_url in get_image_page(url, total):#传入参数，url=某本特定的漫画书入口网址，total：该漫画书页码，该句对哪本漫画书中的第几页进行了精确的确定
            #该函数返回该特定的漫画书中各个页码对应的连接的集合****
            htmls = get_image_src(img_url)#get_image_src是获取url并且在函数里面调用下载函数
            parser_img_src(htmls)
            ##两重for循环的话
##第一个for循环把某个特定漫画的总页码数total和该特定漫画在首页的入口url递给第二个for循环
##那么有一重是负责遍历首页的各种连接的
##有一重是用来遍历该连接中的各种子连接的
##第二个for循环是用来遍历某个特定漫画的各个页并进行下载的
##第一个for是用来遍历首页推荐的各种漫画的


if __name__ == '__main__':
    groups = [x for x in range(1, 86)]#爬http://www.svmhz.com/shaonvmanhua/的一部分，总共有85页
    pool = Pool()
    pool.map(main, groups)#</code></pre> 
 <br> 
 <br> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  ———————————————————————————————————————————————————— 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <br style="line-height:1.5"> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'>
  Reference： 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="" rel="nofollow noopener noreferrer" style='font-family:微软雅黑,"MS Sans Serif",sans-serif; font-size:13px; background-color:rgb(255,237,196)'>http://www.jianshu.com/p/8b4a589f7980</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://www.jianshu.com/p/8b4a589f7980" rel="nofollow noopener noreferrer">http://www.jianshu.com/p/8b4a589f7980</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://www.w3school.com.cn/xpath/xpath_axes.asp" rel="nofollow noopener noreferrer">http://www.w3school.com.cn/xpath/xpath_axes.asp</a> 
</div> 
<div style='font-family:"Microsoft YaHei",SimSun,Verdana,Arial,Helvetica,sans-serif; line-height:1.5; font-size:14px'> 
 <a target="_blank" href="http://www.svmhz.com/shaonvmanhua/" rel="nofollow noopener noreferrer" style="color:rgb(49,148,208); font-size:16px">http://www.svmhz.com/shaonvmanhua/</a> 
</div> 
<div> 
 <br> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8041aae807052358cee759468a1df8a0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">android组件GridView简单使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53b5eb4d5ab1936784941b1578ebc1d7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">c&#43;&#43; 使用WinHTTP实现文件下载功能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>