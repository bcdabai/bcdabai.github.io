<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SMOTE实例代码 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SMOTE实例代码" />
<meta property="og:description" content="原理 采用KNN算法，计算出每个少数类样本的K个邻近；从K个邻近中随机挑选N个样本进行随机线性插值；构造新的少数类样本；将新样本放入原数据，产生新的训练集； 实现 from sklearn.neighbors import NearestNeighbors import numpy as np import random class Smote: #samples的最后一列是类标，都是1 def __init__(self, samples, N=10,k=5): self.n_samples, self.n_attrs=samples.shape self.N=N self.k=k self.samples=samples def over_sampling(self): if self.N&lt;100: old_n_samples=self.n_samples print &#34;old_n_samples&#34;, old_n_samples self.n_samples=int(float(self.N)/100*old_n_samples) print &#34;n_samples&#34;, self.n_samples keep=np.random.permutation(old_n_samples)[:self.n_samples] print &#34;keep&#34;, keep new_samples=self.samples[keep] print &#34;new_samples&#34;, new_samples self.samples=new_samples print &#34;self.samples&#34;, self.samples self.N=100 N=int(self.N/100) #每个少数类样本应该合成的新样本个数 self.synthetic=np.zeros((self.n_samples*N, self.n_attrs)) self.new_index=0 neighbors=NearestNeighbors(n_neighbors=self.k).fit(self.samples) print &#34;neighbors&#34;, neighbors for i in range(len(self.samples)): nnarray=neighbors.kneighbors(self.samples[i],return_distance=False)[0] #存储k个近邻的下标 self.__populate(N, i, nnarray ) return self." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8b666fd0b1e1fe7d682f64fa855ab8f3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-19T13:16:45+08:00" />
<meta property="article:modified_time" content="2017-12-19T13:16:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SMOTE实例代码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4 id="原理">原理</h4> 
<ul><li>采用KNN算法，计算出每个少数类样本的K个邻近；</li><li>从K个邻近中随机挑选N个样本进行随机线性插值；</li><li>构造新的少数类样本；</li><li>将新样本放入原数据，产生新的训练集；</li></ul> 
<h4 id="实现">实现</h4> 
<pre class="prettyprint"><code class="language-python hljs "><span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> NearestNeighbors
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> random
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Smote</span>:</span>
    <span class="hljs-comment">#samples的最后一列是类标，都是1</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, samples, N=<span class="hljs-number">10</span>,k=<span class="hljs-number">5</span>)</span>:</span>
        self.n_samples, self.n_attrs=samples.shape
        self.N=N
        self.k=k
        self.samples=samples

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">over_sampling</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">if</span> self.N&lt;<span class="hljs-number">100</span>:
            old_n_samples=self.n_samples
            <span class="hljs-keyword">print</span> <span class="hljs-string">"old_n_samples"</span>, old_n_samples
            self.n_samples=int(float(self.N)/<span class="hljs-number">100</span>*old_n_samples)
            <span class="hljs-keyword">print</span> <span class="hljs-string">"n_samples"</span>, self.n_samples
            keep=np.random.permutation(old_n_samples)[:self.n_samples]
            <span class="hljs-keyword">print</span> <span class="hljs-string">"keep"</span>, keep
            new_samples=self.samples[keep]
            <span class="hljs-keyword">print</span> <span class="hljs-string">"new_samples"</span>, new_samples
            self.samples=new_samples
            <span class="hljs-keyword">print</span> <span class="hljs-string">"self.samples"</span>, self.samples
            self.N=<span class="hljs-number">100</span>

        N=int(self.N/<span class="hljs-number">100</span>) <span class="hljs-comment">#每个少数类样本应该合成的新样本个数</span>
        self.synthetic=np.zeros((self.n_samples*N, self.n_attrs))
        self.new_index=<span class="hljs-number">0</span>

        neighbors=NearestNeighbors(n_neighbors=self.k).fit(self.samples)
        <span class="hljs-keyword">print</span> <span class="hljs-string">"neighbors"</span>, neighbors
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(self.samples)):
            nnarray=neighbors.kneighbors(self.samples[i],return_distance=<span class="hljs-keyword">False</span>)[<span class="hljs-number">0</span>]
            <span class="hljs-comment">#存储k个近邻的下标</span>
            self.__populate(N, i, nnarray )
        <span class="hljs-keyword">return</span> self.synthetic

    <span class="hljs-comment">#从k个邻居中随机选取N次，生成N个合成的样本</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__populate</span><span class="hljs-params">(self, N, i, nnarray)</span>:</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(N):
            nn = np.random.randint(<span class="hljs-number">0</span>, self.k)
            dif=self.samples[nnarray[nn]]-self.samples[i]    <span class="hljs-comment">#包含类标</span>
            gap=np.random.rand(<span class="hljs-number">1</span>,self.n_attrs)
            self.synthetic[self.new_index]=self.samples[i]+gap.flatten()*dif
            self.new_index+=<span class="hljs-number">1</span> </code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/613e870f85c5fb1b305a8835dc9de033/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">摩拜单车红包骑行引发的潮汐问题思考</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bf94dd332238093b0f583ffebdb35369/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux下增加Sawp分区</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>