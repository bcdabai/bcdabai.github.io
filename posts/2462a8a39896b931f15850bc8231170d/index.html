<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>全网最牛，Appium自动化测试框架-关键字驱动&#43;数据驱动实战（二） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="全网最牛，Appium自动化测试框架-关键字驱动&#43;数据驱动实战（二）" />
<meta property="og:description" content="目录：导读 前言一、Python编程入门到精通二、接口自动化项目实战三、Web自动化项目实战四、App自动化项目实战五、一线大厂简历六、测试开发DevOps体系七、常用自动化测试工具八、JMeter性能测试九、总结（尾部小惊喜） 前言 util 包
util 包属于第一层的测试工具层：用于实现测试过程中调用的工具类方法，例如读取配置文件、页面元素的操作方法、操作 Excel 文件、生成测试报告、发送邮件等。
global_var.py
本模块用于定义测试过程中所需的全局变量。
import os PROJECT_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) # APP配置信息路径 INI_FILE_PATH = os.path.join(PROJECT_DIR, &#34;conf&#34;, &#34;desired_caps_config.ini&#34;) # 异常截图路径 EXCEPION_PIC_PATH = os.path.join(PROJECT_DIR, &#34;exception_pic&#34;) # 日志配置文件路径 LOG_CONF_FILE_PATH = os.path.join(PROJECT_DIR, &#34;conf&#34;, &#34;logger.conf&#34;) # 测试数据文件路径 TEST_DATA_FILE_PATH = os.path.join(PROJECT_DIR, &#34;test_data&#34;, &#34;test_case.xlsx&#34;) # 测试报告存放路径 TEST_REPORT_FILE_DIR = os.path.join(PROJECT_DIR, &#34;test_report&#34;) # Appium server地址 APPIUM_SERVER = &#39;http://localhost:4723/wd/hub&#39; # 测试数据文件中，测试用例sheet中部分列对应的数字序号 TESTCASE_CASE_NAME_COL_NO = 0 TESTCASE_FRAMEWORK_TYPE_COL_NO = 1 TESTCASE_CASE_STEP_SHEET_NAME_COL_NO = 2 TESTCASE_DATA_SOURCE_SHEET_NAME_COL_NO = 3 TESTCASE_IS_EXECUTE_COL_NO = 4 TESTCASE_TEST_TIME_COL_NO = 5 TESTCASE_TEST_RESULT_COL_NO = 6 # 用例步骤sheet中，部分列对应的数字序号 CASESTEP_NAME_COL_NO = 0 CASESTEP_ACTION_COL_NO = 1 CASESTEP_LOCATE_METHOD_COL_NO = 2 CASESTEP_LOCATE_EXPRESSION_COL_NO = 3 CASESTEP_OPERATION_VALUE_COL_NO = 4 CASESTEP_IS_EXECUTE_COL_NO = 5 CASESTEP_TEST_TIME_COL_NO = 6 CASESTEP_TEST_RESULT_COL_NO = 7 CASESTEP_EXCEPTION_INFO_COL_NO = 8 CASESTEP_EXCEPTION_PIC_DIR_COL_NO = 9 # 数据源sheet中，是否执行列对应的数字编号 DATASOURCE_DATA = 0 DATASOURCE_KEYWORD = 1 DATASOURCE_IS_EXECUTE = 2 DATASOURCE_TEST_TIME = 3 DATASOURCE_TEST_RESULT = 4 # 测试执行结果统计 TOTAL_CASE = 0 PASS_CASE = 0 FAIL_CASE = 0 if __name__ == &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2462a8a39896b931f15850bc8231170d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-14T19:25:54+08:00" />
<meta property="article:modified_time" content="2023-08-14T19:25:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">全网最牛，Appium自动化测试框架-关键字驱动&#43;数据驱动实战（二）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录：导读</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#Python_656" rel="nofollow">一、Python编程入门到精通</a></li><li><a href="#_659" rel="nofollow">二、接口自动化项目实战</a></li><li><a href="#Web_662" rel="nofollow">三、Web自动化项目实战</a></li><li><a href="#App_665" rel="nofollow">四、App自动化项目实战</a></li><li><a href="#_668" rel="nofollow">五、一线大厂简历</a></li><li><a href="#DevOps_671" rel="nofollow">六、测试开发DevOps体系</a></li><li><a href="#_674" rel="nofollow">七、常用自动化测试工具</a></li><li><a href="#JMeter_677" rel="nofollow">八、JMeter性能测试</a></li><li><a href="#_680" rel="nofollow">九、总结（尾部小惊喜）</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h3><a id="_2"></a>前言</h3> 
<p><strong>util 包</strong></p> 
<p>util 包属于第一层的测试工具层：用于实现测试过程中调用的工具类方法，例如读取配置文件、页面元素的操作方法、操作 Excel 文件、生成测试报告、发送邮件等。</p> 
<p>global_var.py<br> 本模块用于定义测试过程中所需的全局变量。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os


PROJECT_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># APP配置信息路径</span>
INI_FILE_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>PROJECT_DIR<span class="token punctuation">,</span> <span class="token string">"conf"</span><span class="token punctuation">,</span> <span class="token string">"desired_caps_config.ini"</span><span class="token punctuation">)</span>

<span class="token comment"># 异常截图路径</span>
EXCEPION_PIC_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>PROJECT_DIR<span class="token punctuation">,</span> <span class="token string">"exception_pic"</span><span class="token punctuation">)</span>

<span class="token comment"># 日志配置文件路径</span>
LOG_CONF_FILE_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>PROJECT_DIR<span class="token punctuation">,</span> <span class="token string">"conf"</span><span class="token punctuation">,</span> <span class="token string">"logger.conf"</span><span class="token punctuation">)</span>

<span class="token comment"># 测试数据文件路径</span>
TEST_DATA_FILE_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>PROJECT_DIR<span class="token punctuation">,</span> <span class="token string">"test_data"</span><span class="token punctuation">,</span> <span class="token string">"test_case.xlsx"</span><span class="token punctuation">)</span>

<span class="token comment"># 测试报告存放路径</span>
TEST_REPORT_FILE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>PROJECT_DIR<span class="token punctuation">,</span> <span class="token string">"test_report"</span><span class="token punctuation">)</span>

<span class="token comment"># Appium server地址</span>
APPIUM_SERVER <span class="token operator">=</span> <span class="token string">'http://localhost:4723/wd/hub'</span>

<span class="token comment"># 测试数据文件中，测试用例sheet中部分列对应的数字序号</span>
TESTCASE_CASE_NAME_COL_NO <span class="token operator">=</span> <span class="token number">0</span>
TESTCASE_FRAMEWORK_TYPE_COL_NO <span class="token operator">=</span> <span class="token number">1</span>
TESTCASE_CASE_STEP_SHEET_NAME_COL_NO <span class="token operator">=</span> <span class="token number">2</span>
TESTCASE_DATA_SOURCE_SHEET_NAME_COL_NO <span class="token operator">=</span> <span class="token number">3</span>
TESTCASE_IS_EXECUTE_COL_NO <span class="token operator">=</span> <span class="token number">4</span>
TESTCASE_TEST_TIME_COL_NO <span class="token operator">=</span> <span class="token number">5</span>
TESTCASE_TEST_RESULT_COL_NO <span class="token operator">=</span> <span class="token number">6</span>

<span class="token comment"># 用例步骤sheet中，部分列对应的数字序号</span>
CASESTEP_NAME_COL_NO <span class="token operator">=</span> <span class="token number">0</span>
CASESTEP_ACTION_COL_NO <span class="token operator">=</span> <span class="token number">1</span>
CASESTEP_LOCATE_METHOD_COL_NO <span class="token operator">=</span> <span class="token number">2</span>
CASESTEP_LOCATE_EXPRESSION_COL_NO <span class="token operator">=</span> <span class="token number">3</span>
CASESTEP_OPERATION_VALUE_COL_NO <span class="token operator">=</span> <span class="token number">4</span>
CASESTEP_IS_EXECUTE_COL_NO <span class="token operator">=</span> <span class="token number">5</span>
CASESTEP_TEST_TIME_COL_NO <span class="token operator">=</span> <span class="token number">6</span>
CASESTEP_TEST_RESULT_COL_NO <span class="token operator">=</span> <span class="token number">7</span>
CASESTEP_EXCEPTION_INFO_COL_NO <span class="token operator">=</span> <span class="token number">8</span>
CASESTEP_EXCEPTION_PIC_DIR_COL_NO <span class="token operator">=</span> <span class="token number">9</span>

<span class="token comment"># 数据源sheet中，是否执行列对应的数字编号</span>
DATASOURCE_DATA <span class="token operator">=</span> <span class="token number">0</span>
DATASOURCE_KEYWORD <span class="token operator">=</span> <span class="token number">1</span>
DATASOURCE_IS_EXECUTE <span class="token operator">=</span> <span class="token number">2</span>
DATASOURCE_TEST_TIME <span class="token operator">=</span> <span class="token number">3</span>
DATASOURCE_TEST_RESULT <span class="token operator">=</span> <span class="token number">4</span>

<span class="token comment"># 测试执行结果统计</span>
TOTAL_CASE <span class="token operator">=</span> <span class="token number">0</span>
PASS_CASE <span class="token operator">=</span> <span class="token number">0</span>
FAIL_CASE <span class="token operator">=</span> <span class="token number">0</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>PROJECT_DIR<span class="token punctuation">)</span>
</code></pre> 
<p><strong>find_element_util.py</strong></p> 
<p>本模块封装了基于显式等待的界面元素定位方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait


<span class="token comment"># 显式等待一个元素</span>
<span class="token keyword">def</span> <span class="token function">find_element</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> locate_method<span class="token punctuation">,</span> locate_exp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 显式等待对象（最多等10秒，每0.2秒判断一次等待的条件）</span>
    <span class="token keyword">return</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>locate_method<span class="token punctuation">,</span> locate_exp<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 显式等待一组元素</span>
<span class="token keyword">def</span> <span class="token function">find_elements</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> locate_method<span class="token punctuation">,</span> locate_exp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 显式等待对象（最多等10秒，每0.2秒判断一次等待的条件）</span>
    <span class="token keyword">return</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>locate_method<span class="token punctuation">,</span> locate_exp<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>excel_util.py</strong></p> 
<p>本模块封装了对 excel 的读写操作（openpyxl 版本：3.0.4）。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> PatternFill<span class="token punctuation">,</span> Font<span class="token punctuation">,</span> Side<span class="token punctuation">,</span> Border
<span class="token keyword">from</span> util<span class="token punctuation">.</span>datetime_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token comment"># 支持excel读写操作的工具类</span>
<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">:</span>

    <span class="token comment"># 初始化读取excel文件</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        self<span class="token punctuation">.</span>wb <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        <span class="token comment"># 初始化默认sheet</span>
        self<span class="token punctuation">.</span>ws <span class="token operator">=</span> self<span class="token punctuation">.</span>wb<span class="token punctuation">.</span>active
        self<span class="token punctuation">.</span>data_file_path <span class="token operator">=</span> file_path
        <span class="token comment"># 初始化颜色字典，供设置样式用</span>
        self<span class="token punctuation">.</span>color_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"red"</span><span class="token punctuation">:</span> <span class="token string">"FFFF3030"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">:</span> <span class="token string">"FF008B00"</span><span class="token punctuation">}</span>

    <span class="token keyword">def</span> <span class="token function">get_all_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>wb<span class="token punctuation">.</span>get_sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 打开指定sheet</span>
    <span class="token keyword">def</span> <span class="token function">get_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> sheet_name <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>get_all_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"sheet名称【%s】不存在！"</span> <span class="token operator">%</span> sheet_name<span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        self<span class="token punctuation">.</span>ws <span class="token operator">=</span> self<span class="token punctuation">.</span>wb<span class="token punctuation">.</span>get_sheet_by_name<span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token comment"># 获取最大行号</span>
    <span class="token keyword">def</span> <span class="token function">get_max_row_no</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># openpyxl的API的行、列索引默认都从1开始</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>max_row

    <span class="token comment"># 获取最大列号</span>
    <span class="token keyword">def</span> <span class="token function">get_max_col_no</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>max_column

    <span class="token comment"># 获取所有行数据</span>
    <span class="token keyword">def</span> <span class="token function">get_all_row_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> head_line<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 是否需要标题行数据的标识，默认需要</span>
        <span class="token keyword">if</span> head_line<span class="token punctuation">:</span>
            min_row <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 行号从1开始，即1为标题行</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            min_row <span class="token operator">=</span> <span class="token number">2</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># min_row=None：默认获取标题行数据</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> self<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>min_row<span class="token operator">=</span>min_row<span class="token punctuation">,</span> max_row<span class="token operator">=</span>self<span class="token punctuation">.</span>get_max_row_no<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span>self<span class="token punctuation">.</span>get_max_col_no<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>cell<span class="token punctuation">.</span>value <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> result

    <span class="token comment"># 获取指定行数据</span>
    <span class="token keyword">def</span> <span class="token function">get_row_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> row_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 0 为标题行</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>cell<span class="token punctuation">.</span>value <span class="token keyword">for</span> cell <span class="token keyword">in</span> self<span class="token punctuation">.</span>ws<span class="token punctuation">[</span>row_num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

    <span class="token comment"># 获取指定列数据</span>
    <span class="token keyword">def</span> <span class="token function">get_col_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> col_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 索引从0开始</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>cell<span class="token punctuation">.</span>value <span class="token keyword">for</span> cell <span class="token keyword">in</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>columns<span class="token punctuation">)</span><span class="token punctuation">[</span>col_num<span class="token punctuation">]</span><span class="token punctuation">]</span>

    <span class="token comment"># 追加行数据且可以设置样式</span>
    <span class="token keyword">def</span> <span class="token function">write_row_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">,</span> font_color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fill_color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">,</span> <span class="token builtin">tuple</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"写入数据失败：数据不为列表或元组类型！【%s】"</span> <span class="token operator">%</span> data<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        <span class="token comment"># 设置字体颜色</span>
        <span class="token keyword">if</span> font_color<span class="token punctuation">:</span>
            <span class="token keyword">if</span> font_color<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>color_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                font_color <span class="token operator">=</span> self<span class="token punctuation">.</span>color_dict<span class="token punctuation">[</span>font_color<span class="token punctuation">]</span>
        <span class="token comment"># 设置单元格填充颜色</span>
        <span class="token keyword">if</span> fill_color<span class="token punctuation">:</span>
            <span class="token keyword">if</span> fill_color<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>color_dict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                fill_color <span class="token operator">=</span> self<span class="token punctuation">.</span>color_dict<span class="token punctuation">[</span>fill_color<span class="token punctuation">]</span>
        <span class="token comment"># 设置单元格边框</span>
        <span class="token keyword">if</span> border<span class="token punctuation">:</span>
            bd <span class="token operator">=</span> Side<span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token string">"thin"</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"000000"</span><span class="token punctuation">)</span>
        <span class="token comment"># 记录数据长度（否则会默认与之前行最长数据行的长度相同，导致样式超过了该行实际长度）</span>
        count <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> self<span class="token punctuation">.</span>ws<span class="token punctuation">[</span>self<span class="token punctuation">.</span>get_max_row_no<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token comment"># 设置完该行的实际数据长度样式后，则退出</span>
            <span class="token keyword">if</span> count <span class="token operator">&gt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            <span class="token keyword">if</span> font_color<span class="token punctuation">:</span>
                cell<span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>color<span class="token operator">=</span>font_color<span class="token punctuation">)</span>
            <span class="token comment"># 如果没有设置字体颜色，则默认给执行结果添加字体颜色</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> cell<span class="token punctuation">.</span>value <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"pass"</span> <span class="token keyword">or</span> cell<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">"成功"</span><span class="token punctuation">:</span>
                        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>color<span class="token operator">=</span>self<span class="token punctuation">.</span>color_dict<span class="token punctuation">[</span><span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">elif</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"fail"</span> <span class="token keyword">or</span> cell<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token string">"失败"</span><span class="token punctuation">:</span>
                        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>color<span class="token operator">=</span>self<span class="token punctuation">.</span>color_dict<span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> border<span class="token punctuation">:</span>
                cell<span class="token punctuation">.</span>border <span class="token operator">=</span> Border<span class="token punctuation">(</span>left<span class="token operator">=</span>bd<span class="token punctuation">,</span> right<span class="token operator">=</span>bd<span class="token punctuation">,</span> top<span class="token operator">=</span>bd<span class="token punctuation">,</span> bottom<span class="token operator">=</span>bd<span class="token punctuation">)</span>
            <span class="token keyword">if</span> fill_color<span class="token punctuation">:</span>
                cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> PatternFill<span class="token punctuation">(</span>fill_type<span class="token operator">=</span><span class="token string">"solid"</span><span class="token punctuation">,</span> fgColor<span class="token operator">=</span>fill_color<span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token comment"># 指定行插入数据（行索引从0开始）</span>
    <span class="token keyword">def</span> <span class="token function">insert_row_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> row_no<span class="token punctuation">,</span> data<span class="token punctuation">,</span> font_color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> border<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fill_color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">,</span> <span class="token builtin">tuple</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"写入数据失败：数据不为列表或元组类型！【%s】"</span> <span class="token operator">%</span> data<span class="token punctuation">)</span>
        <span class="token keyword">for</span> idx<span class="token punctuation">,</span> cell <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>ws<span class="token punctuation">[</span>row_no<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 此处行索引从1开始</span>
            cell<span class="token punctuation">.</span>value <span class="token operator">=</span> data<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>

    <span class="token comment"># 生成写入了测试结果的excel数据文件</span>
    <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> save_file_name<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">:</span>
        save_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>TEST_REPORT_FILE_DIR<span class="token punctuation">,</span> get_chinese_date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>save_dir<span class="token punctuation">)</span>
        save_file <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>save_dir<span class="token punctuation">,</span> save_file_name <span class="token operator">+</span> <span class="token string">"_"</span> <span class="token operator">+</span> timestamp <span class="token operator">+</span> <span class="token string">".xlsx"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>save_file<span class="token punctuation">)</span>
        info<span class="token punctuation">(</span><span class="token string">"生成测试结果文件：%s"</span> <span class="token operator">%</span> save_file<span class="token punctuation">)</span>
        <span class="token keyword">return</span> save_file


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
    <span class="token keyword">from</span> util<span class="token punctuation">.</span>datetime_util <span class="token keyword">import</span> <span class="token operator">*</span>
    excel <span class="token operator">=</span> Excel<span class="token punctuation">(</span>TEST_DATA_FILE_PATH<span class="token punctuation">)</span>
    excel<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token string">"测试结果统计"</span><span class="token punctuation">)</span>
    <span class="token comment"># print(excel.get_all_row_data())</span>
    <span class="token comment"># excel.write_row_data(["4", None, "嘻哈"], "green", True, "red")</span>
    excel<span class="token punctuation">.</span>insert_row_data<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    excel<span class="token punctuation">.</span>save<span class="token punctuation">(</span>get_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>ini_reader.py</strong></p> 
<p>本模块封装了对 ini 配置文件的读取操作。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> configparser


<span class="token comment"># 读取ini文件的工具类</span>
<span class="token keyword">class</span> <span class="token class-name">IniParser</span><span class="token punctuation">:</span>

    <span class="token comment"># 初始化打开ini文件</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ini文件【%s】不存在！"</span> <span class="token operator">%</span> file_path<span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        self<span class="token punctuation">.</span>cf <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>

    <span class="token comment"># 获取所有分组</span>
    <span class="token keyword">def</span> <span class="token function">get_sections</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 获取指定分组的所有键</span>
    <span class="token keyword">def</span> <span class="token function">get_options</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> section<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>options<span class="token punctuation">(</span>section<span class="token punctuation">)</span>  <span class="token comment"># 注意，获取的键会自动转小写</span>

    <span class="token comment"># 获取指定分组的所有键值对</span>
    <span class="token keyword">def</span> <span class="token function">get_items</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> section<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>items<span class="token punctuation">(</span>section<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 注意，获取的键会自动转小写</span>

    <span class="token comment"># 获取指定分组指定键的值</span>
    <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> section<span class="token punctuation">,</span> option<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cf<span class="token punctuation">.</span>get<span class="token punctuation">(</span>section<span class="token punctuation">,</span> option<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
    p <span class="token operator">=</span> IniParser<span class="token punctuation">(</span>INI_FILE_PATH<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>get_sections<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>get_options<span class="token punctuation">(</span><span class="token string">"desired_caps"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>get_items<span class="token punctuation">(</span><span class="token string">"desired_caps"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>get_value<span class="token punctuation">(</span><span class="token string">"desired_caps"</span><span class="token punctuation">,</span> <span class="token string">"deviceName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>email_util.py</strong></p> 
<p>本模块封装了邮件发送功能。（示例代码中的用户名/密码已隐藏）</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> yagmail
<span class="token keyword">import</span> traceback
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token keyword">def</span> <span class="token function">send_mail</span><span class="token punctuation">(</span>attachments_report_name<span class="token punctuation">,</span> receiver<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 连接邮箱服务器</span>
        <span class="token comment"># 注意：若使用QQ邮箱，则password为授权码而非邮箱密码；使用其它邮箱则为邮箱密码</span>
        <span class="token comment"># encoding设置为GBK，否则中文附件名会乱码</span>
        yag <span class="token operator">=</span> yagmail<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span>user<span class="token operator">=</span><span class="token string">"*****@163.com"</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">"*****"</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">"smtp.163.com"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'GBK'</span><span class="token punctuation">)</span>

        <span class="token comment"># 收件人、标题、正文、附件（若多个收件人或多个附件，则可使用列表）</span>
        yag<span class="token punctuation">.</span>send<span class="token punctuation">(</span>to<span class="token operator">=</span>receiver<span class="token punctuation">,</span> subject<span class="token operator">=</span>subject<span class="token punctuation">,</span> contents<span class="token operator">=</span>content<span class="token punctuation">,</span> attachments<span class="token operator">=</span>attachments_report_name<span class="token punctuation">)</span>

        <span class="token comment"># 可简写：yag.send("****@163.com", subject, contents, report)</span>

        info<span class="token punctuation">(</span><span class="token string">"测试报告邮件发送成功!【邮件标题：%s】【邮件附件：%s】【收件人：%s】"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>subject<span class="token punctuation">,</span> attachments_report_name<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        error<span class="token punctuation">(</span><span class="token string">"测试报告邮件发送失败!【邮件标题：%s】【邮件附件：%s】【收件人：%s】"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>subject<span class="token punctuation">,</span> attachments_report_name<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">)</span>
        error<span class="token punctuation">(</span>traceback<span class="token punctuation">.</span>format_exc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
   send_mail<span class="token punctuation">(</span><span class="token string">"e:\\code.txt"</span><span class="token punctuation">,</span> <span class="token string">"xxxxxx@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"测试邮件"</span><span class="token punctuation">,</span> <span class="token string">"正文"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>datetime_util.py</strong></p> 
<p>本模块实现了获取各种格式的当前日期时间。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time


<span class="token comment"># 返回中文格式的日期：xxxx年xx月xx日</span>
<span class="token keyword">def</span> <span class="token function">get_chinese_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    year <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_year
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        year <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
    month <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_mon
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        month <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
    day <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_mday
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        day <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"{}年{}月{}日"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span>


<span class="token comment"># 返回英文格式的日期：xxxx/xx/xx</span>
<span class="token keyword">def</span> <span class="token function">get_english_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    year <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_year
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        year <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
    month <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_mon
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        month <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
    day <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_mday
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        day <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"{}/{}/{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span>


<span class="token comment"># 返回中文格式的时间：xx时xx分xx秒</span>
<span class="token keyword">def</span> <span class="token function">get_chinese_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    hour <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_hour
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>hour<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        hour <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>hour<span class="token punctuation">)</span>
    minute <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_min
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>minute<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        minute <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>minute<span class="token punctuation">)</span>
    second <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_sec
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        second <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"{}时{}分{}秒"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>hour<span class="token punctuation">,</span> minute<span class="token punctuation">,</span> second<span class="token punctuation">)</span>


<span class="token comment"># 返回英文格式的时间：xx:xx:xx</span>
<span class="token keyword">def</span> <span class="token function">get_english_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    hour <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_hour
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>hour<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        hour <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>hour<span class="token punctuation">)</span>
    minute <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_min
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>minute<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        minute <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>minute<span class="token punctuation">)</span>
    second <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_sec
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        second <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"{}:{}:{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>hour<span class="token punctuation">,</span> minute<span class="token punctuation">,</span> second<span class="token punctuation">)</span>


<span class="token comment"># 返回中文格式的日期时间</span>
<span class="token keyword">def</span> <span class="token function">get_chinese_datetime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> get_chinese_date<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> get_chinese_time<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 返回英文格式的日期时间</span>
<span class="token keyword">def</span> <span class="token function">get_english_datetime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> get_english_date<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> get_english_time<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># 返回时间戳</span>
<span class="token keyword">def</span> <span class="token function">get_timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    year <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_year
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        year <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
    month <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_mon
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        month <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
    day <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_mday
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        day <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
    hour <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_hour
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>hour<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        hour <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>hour<span class="token punctuation">)</span>
    minute <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_min
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>minute<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        minute <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>minute<span class="token punctuation">)</span>
    second <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tm_sec
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        second <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">"{}{}{}_{}{}{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">,</span> hour<span class="token punctuation">,</span> minute<span class="token punctuation">,</span> second<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>get_chinese_datetime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>get_english_datetime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>get_desired_caps.py</strong></p> 
<p>本模块实现了获取 ini 配置文件中的 Appium 创建 Session 的配置信息。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> util<span class="token punctuation">.</span>ini_reader <span class="token keyword">import</span> IniParser
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> INI_FILE_PATH


<span class="token keyword">def</span> <span class="token function">get_desired_caps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    pcf <span class="token operator">=</span> IniParser<span class="token punctuation">(</span>INI_FILE_PATH<span class="token punctuation">)</span>
    items <span class="token operator">=</span> pcf<span class="token punctuation">.</span>get_items<span class="token punctuation">(</span><span class="token string">"desired_caps"</span><span class="token punctuation">)</span>  <span class="token comment"># 获取的键会自动转成小写</span>
    desired_caps <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"platformName"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"platformname"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"platformVersion"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"platformversion"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"deviceName"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"devicename"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"appPackage"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"apppackage"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"appActivity"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"appactivity"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"unicodeKeyboard"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"unicodekeyboard"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"autoAcceptAlerts"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"autoacceptalerts"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"resetKeyboard"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"resetkeyboard"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"noReset"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"noreset"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">"newCommandTimeout"</span><span class="token punctuation">:</span> items<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"newcommandtimeout"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> desired_caps


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>get_desired_caps<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>log_util.py</strong></p> 
<p>封装了日志打印输出、级别设定等功能。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> logging
<span class="token keyword">import</span> logging<span class="token punctuation">.</span>config
<span class="token keyword">from</span> util<span class="token punctuation">.</span>global_var <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token comment"># 日志配置文件：多个logger，每个logger指定不同的handler</span>
<span class="token comment"># handler：设定了日志输出行的格式</span>
<span class="token comment">#          以及设定写日志到文件（是否回滚）？还是到屏幕</span>
<span class="token comment">#          还定了打印日志的级别</span>
logging<span class="token punctuation">.</span>config<span class="token punctuation">.</span>fileConfig<span class="token punctuation">(</span>LOG_CONF_FILE_PATH<span class="token punctuation">)</span>
logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">"example01"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>debug<span class="token punctuation">(</span>message<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>message<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">warning</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>message<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>error<span class="token punctuation">(</span>message<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    debug<span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span>
    info<span class="token punctuation">(</span><span class="token string">"gloryroad"</span><span class="token punctuation">)</span>
    warning<span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span>
    error<span class="token punctuation">(</span><span class="token string">"这是一个error日志"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>report_util.py</strong></p> 
<p>生成测试结果文件并发送邮件。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> util<span class="token punctuation">.</span>email_util <span class="token keyword">import</span> send_mail
<span class="token keyword">from</span> util<span class="token punctuation">.</span>log_util <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>datetime_util <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token comment"># 生成测试报告并发送邮件</span>
<span class="token keyword">def</span> <span class="token function">create_excel_report_and_send_email</span><span class="token punctuation">(</span>excel_obj<span class="token punctuation">,</span> receiver<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    :param excel_obj: excel对象用于保存文件
    :param timestamp: 用于文件命名的时间戳
    :return: 返回excel测试报告文件名
    """</span>
    time_stamp <span class="token operator">=</span> get_timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span>
    report_path <span class="token operator">=</span> excel_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span>subject<span class="token punctuation">,</span> time_stamp<span class="token punctuation">)</span>
    send_mail<span class="token punctuation">(</span>report_path<span class="token punctuation">,</span> receiver<span class="token punctuation">,</span> subject<span class="token operator">+</span><span class="token string">"_"</span><span class="token operator">+</span>time_stamp<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
</code></pre> 
<p><strong>conf 目录</strong></p> 
<p>conf 目录属于第一层测试工具层，用于存储各配置文件。</p> 
<p>desired_caps_config.ini<br> 本配置文件存储了 Appium 创建 Session 的配置信息。</p> 
<pre><code class="prism language-ini">[desired_caps]
platformName=Android
platformVersion=6
deviceName=3DN6T16B26001805
appPackage=com.xsteach.appedu
appActivity=com.xsteach.appedu.StartActivity
unicodeKeyboard=True
autoAcceptAlerts=True
resetKeyboard=True
noReset=True
newCommandTimeout=6000
</code></pre> 
<p>logger.conf<br> 本配置文件用于日志功能的具体配置。</p> 
<pre><code class="prism language-python"><span class="token comment">###############################################</span>
<span class="token punctuation">[</span>loggers<span class="token punctuation">]</span>
keys<span class="token operator">=</span>root<span class="token punctuation">,</span>example01<span class="token punctuation">,</span>example02
<span class="token punctuation">[</span>logger_root<span class="token punctuation">]</span>
level<span class="token operator">=</span>DEBUG
handlers<span class="token operator">=</span>hand01<span class="token punctuation">,</span>hand02

<span class="token punctuation">[</span>logger_example01<span class="token punctuation">]</span>
handlers<span class="token operator">=</span>hand01<span class="token punctuation">,</span>hand02
qualname<span class="token operator">=</span>example01
propagate<span class="token operator">=</span><span class="token number">0</span>

<span class="token punctuation">[</span>logger_example02<span class="token punctuation">]</span>
handlers<span class="token operator">=</span>hand01<span class="token punctuation">,</span>hand03
qualname<span class="token operator">=</span>example02
propagate<span class="token operator">=</span><span class="token number">0</span>

<span class="token comment">###############################################</span>
<span class="token punctuation">[</span>handlers<span class="token punctuation">]</span>
keys<span class="token operator">=</span>hand01<span class="token punctuation">,</span>hand02<span class="token punctuation">,</span>hand03

<span class="token punctuation">[</span>handler_hand01<span class="token punctuation">]</span>
<span class="token keyword">class</span><span class="token operator">=</span>StreamHandler
level<span class="token operator">=</span>INFO
formatter<span class="token operator">=</span>form01
args<span class="token operator">=</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stderr<span class="token punctuation">,</span><span class="token punctuation">)</span>

<span class="token punctuation">[</span>handler_hand02<span class="token punctuation">]</span>
<span class="token keyword">class</span><span class="token operator">=</span>FileHandler
level<span class="token operator">=</span>DEBUG
formatter<span class="token operator">=</span>form01
args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'E:\\pycharm_project_dir\\AppAutoTest\\log\\app_test.log'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span>

<span class="token punctuation">[</span>handler_hand03<span class="token punctuation">]</span>
<span class="token keyword">class</span><span class="token operator">=</span>handlers<span class="token punctuation">.</span>RotatingFileHandler
level<span class="token operator">=</span>INFO
formatter<span class="token operator">=</span>form01
args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'E:\\pycharm_project_dir\\AppAutoTest\\log\\app_test.log'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment">###############################################</span>
<span class="token punctuation">[</span>formatters<span class="token punctuation">]</span>
keys<span class="token operator">=</span>form01<span class="token punctuation">,</span>form02

<span class="token punctuation">[</span>formatter_form01<span class="token punctuation">]</span>
<span class="token builtin">format</span><span class="token operator">=</span><span class="token operator">%</span><span class="token punctuation">(</span>asctime<span class="token punctuation">)</span>s <span class="token punctuation">[</span><span class="token operator">%</span><span class="token punctuation">(</span>levelname<span class="token punctuation">)</span>s<span class="token punctuation">]</span> <span class="token operator">%</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>s
datefmt<span class="token operator">=</span><span class="token operator">%</span>Y<span class="token operator">-</span><span class="token operator">%</span>m<span class="token operator">-</span><span class="token operator">%</span>d <span class="token operator">%</span>H<span class="token punctuation">:</span><span class="token operator">%</span>M<span class="token punctuation">:</span><span class="token operator">%</span>S

<span class="token punctuation">[</span>formatter_form02<span class="token punctuation">]</span>
<span class="token builtin">format</span><span class="token operator">=</span><span class="token operator">%</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token operator">-</span>12s<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">%</span><span class="token punctuation">(</span>levelname<span class="token punctuation">)</span><span class="token operator">-</span>8s<span class="token punctuation">]</span> <span class="token operator">%</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>s
datefmt<span class="token operator">=</span><span class="token operator">%</span>Y<span class="token operator">-</span><span class="token operator">%</span>m<span class="token operator">-</span><span class="token operator">%</span>d <span class="token operator">%</span>H<span class="token punctuation">:</span><span class="token operator">%</span>M<span class="token punctuation">:</span><span class="token operator">%</span>S
</code></pre> 
<p><strong>test_data 目录</strong></p> 
<p>test_data 目录用于存放测试数据文件（Excel），存储了用例步骤、用例执行关键字、数据源等测试数据。</p> 
<p><img src="https://images2.imgbox.com/dd/dd/4eFkmYGT_o.png" alt="31"></p> 
<p><img src="https://images2.imgbox.com/48/a6/MWy4y4Uf_o.png" alt="32"></p> 
<p><img src="https://images2.imgbox.com/24/e7/7HNNQX9U_o.png" alt="33"></p> 
<p><strong>main.py</strong></p> 
<p>本模块是本框架的运行主入口，属于第四层“测试场景层”，将测试用例组织成测试场景，实现各种级别 cases 的管理，如冒烟，回归等测试场景。</p> 
<p>基于 business_process/main_process.py 中的模块用例 sheet 执行函数或主 sheet 执行函数，组装测试场景。</p> 
<p>可直接用代码组装测试场景，也可根据 excel 数据文件的用例集合和用例步骤的维护来设定测试场景。<br> 完成测试执行后生成测试结果文件并发送邮件。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> bussiness_process<span class="token punctuation">.</span>main_process <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> util<span class="token punctuation">.</span>report_util <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token comment"># 组装测试场景</span>
<span class="token comment"># 冒烟测试</span>
<span class="token keyword">def</span> <span class="token function">smoke_test</span><span class="token punctuation">(</span>report_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    excel<span class="token punctuation">,</span> _ <span class="token operator">=</span> suite_process<span class="token punctuation">(</span>TEST_DATA_FILE_PATH<span class="token punctuation">,</span> <span class="token string">"进入主页"</span><span class="token punctuation">)</span>
    excel<span class="token punctuation">,</span> _ <span class="token operator">=</span> suite_process<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> <span class="token string">"登录"</span><span class="token punctuation">)</span>
    excel<span class="token punctuation">,</span> _ <span class="token operator">=</span> suite_process<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> <span class="token string">"退出"</span><span class="token punctuation">)</span>
    <span class="token comment"># 生成测试报告并发送邮件</span>
    create_excel_report_and_send_email<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'xxxxxxxxx@163.com'</span><span class="token punctuation">,</span> <span class="token string">'xxxxxxxx@qq.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> report_name<span class="token punctuation">,</span> <span class="token string">"请查收附件：app自动化测试报告"</span><span class="token punctuation">)</span>


<span class="token comment"># 全量测试：执行主sheet的用例集</span>
<span class="token keyword">def</span> <span class="token function">suite_test</span><span class="token punctuation">(</span>report_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    excel <span class="token operator">=</span> main_suite_process<span class="token punctuation">(</span>TEST_DATA_FILE_PATH<span class="token punctuation">,</span> <span class="token string">"测试用例集"</span><span class="token punctuation">)</span>
    create_excel_report_and_send_email<span class="token punctuation">(</span>excel<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'xxxxxxx@163.com'</span><span class="token punctuation">,</span> <span class="token string">'xxxxxxx@qq.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> report_name<span class="token punctuation">,</span> <span class="token string">"请查收附件：app自动化测试报告"</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># smoke_test("APP自动化测试报告_冒烟测试")</span>
    suite_test<span class="token punctuation">(</span><span class="token string">"APP自动化测试报告_全量测试"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>test_report 目录</strong></p> 
<p>本目录用于存放测试结果文件。</p> 
<p><img src="https://images2.imgbox.com/fe/9a/rqY5OxVv_o.png" alt="34"></p> 
<p><img src="https://images2.imgbox.com/44/af/ODRd868q_o.png" alt="35"></p> 
<p><img src="https://images2.imgbox.com/67/e9/yijRyKdj_o.png" alt="36"></p> 
<p><strong>exception_pic 目录</strong></p> 
<p>本目录用于存放失败用例的截图。</p> 
<p><img src="https://images2.imgbox.com/55/17/2VcQw7oc_o.png" alt="37"></p> 
<p><strong>log 目录</strong></p> 
<p>本目录用于存放日志输出文件（日志内容同时也会输出到控制台）。<br> log/app_test.log：</p> 
<p><img src="https://images2.imgbox.com/b9/58/iUE4wRDo_o.png" alt="38"></p> 
<table><tbody><tr><td bgcolor="yellow"><font size="4"><b>下面是我整理的2023年最全的软件测试工程师学习知识架构体系图</b></font></td></tr></tbody></table> 
<h3><a id="Python_656"></a>一、Python编程入门到精通</h3> 
<p><img src="https://images2.imgbox.com/83/b4/isn0OHQ5_o.png" alt="请添加图片描述"></p> 
<h3><a id="_659"></a>二、接口自动化项目实战</h3> 
<p><img src="https://images2.imgbox.com/e0/6d/VckTcLWE_o.png" alt="请添加图片描述"></p> 
<h3><a id="Web_662"></a>三、Web自动化项目实战</h3> 
<p><img src="https://images2.imgbox.com/b9/d7/bicX633B_o.png" alt="请添加图片描述"></p> 
<h3><a id="App_665"></a>四、App自动化项目实战</h3> 
<p><img src="https://images2.imgbox.com/48/ed/iGH1HQyO_o.png" alt="请添加图片描述"></p> 
<h3><a id="_668"></a>五、一线大厂简历</h3> 
<p><img src="https://images2.imgbox.com/e3/85/uKI2uJmL_o.png" alt="请添加图片描述"></p> 
<h3><a id="DevOps_671"></a>六、测试开发DevOps体系</h3> 
<p><img src="https://images2.imgbox.com/e4/b6/ebusTUXt_o.png" alt="请添加图片描述"></p> 
<h3><a id="_674"></a>七、常用自动化测试工具</h3> 
<p><img src="https://images2.imgbox.com/83/01/f3PHiNVj_o.png" alt="请添加图片描述"></p> 
<h3><a id="JMeter_677"></a>八、JMeter性能测试</h3> 
<p><img src="https://images2.imgbox.com/12/d8/0JYLixGJ_o.png" alt="请添加图片描述"></p> 
<h3><a id="_680"></a>九、总结（尾部小惊喜）</h3> 
<p>不论起点如何，只要拥有激情与毅力，奋斗就是通往成功的道路；不论困难多大，只要心怀信念与勇气，挑战就是成长的机会。努力奋斗，追逐梦想，将创造属于自己的辉煌人生！</p> 
<p>每一次努力，都是迈向辉煌的一步；每一次奋斗，都是砥砺前行的力量。不辜负青春，铭记初心，扬起梦想的风帆，执着追逐，终将驶向成功的彼岸。</p> 
<p>不论身处何地，只要心怀梦想，就别停止追逐；不管困难多大，只要坚持奋斗，就能开创未来。披荆斩棘，勇往直前，舞动青春的旋律，绽放人生的辉煌！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/25b5025f863fddb8d9bb9a9199800d24/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">write javaBean error, fastjson version 1.2.76</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2fee294db01ada35a59270fb1b52050/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2023牛客暑期多校训练营9 I.Non-Puzzle: Segment Pair(tag:差分)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>