<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C#】 三种计算程序运行时间的方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【C#】 三种计算程序运行时间的方法" />
<meta property="og:description" content="文章目录 System.DateTime.NowStopwatchc&#43;&#43; API System.DateTime.Now 属性 Now 返回一个 DateTime 值，该值表示本地计算机上的当前日期和时间。 请注意，值（表示自 0001 年 1 月 1 日午夜以来经过的计时周期数）与该值DateTime的字符串表示形式（以特定于区域性的格式表示日期和时间值）之间存在DateTime差异。
准确性受服务器时间影响
DateTime dt1 = System.DateTime.Now; System.Threading.Thread.Sleep(time_cap); DateTime dt2 = System.DateTime.Now; TimeSpan ts = dt2.Subtract(dt1); Console.WriteLine(&#34;example1 time {0}&#34;, ts.TotalMilliseconds); Stopwatch Stopwatch 在基础计时器机制中对计时器的计时周期进行计数，从而测量运行时间。 如果安装的硬件和操作系统支持高分辨率性能计数器，则 Stopwatch 类将使用该计数器来测量运行时间； 否则，Stopwatch 类将使用系统计数器来测量运行时间。 使用 Frequency 和 IsHighResolution 字段可以确定实现 Stopwatch 计时的精度和分辨率。
System.Diagnostics.Stopwatch sw = new System.Diagnostics.Stopwatch(); sw.Start(); System.Threading.Thread.Sleep(time_cap); sw.Stop(); //这个是实例运行的毫秒数 //sw.ElapsedMilliseconds TimeSpan ts2 = sw.Elapsed; Console.WriteLine(&#34;example2 time {0}&#34;, ts2.TotalMilliseconds); c&#43;&#43; API 如果已安装的硬件支持高分辨率性能计数器，则返回值为非零值。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c1e833e92d15665a2e8a3bfaf09c2387/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-10T10:05:58+08:00" />
<meta property="article:modified_time" content="2023-01-10T10:05:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C#】 三种计算程序运行时间的方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#SystemDateTimeNow_1" rel="nofollow">System.DateTime.Now</a></li><li><a href="#Stopwatch_15" rel="nofollow">Stopwatch</a></li><li><a href="#c_API_29" rel="nofollow">c++ API</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="SystemDateTimeNow_1"></a>System.DateTime.Now</h3> 
<p>属性 Now 返回一个 DateTime 值，该值表示本地计算机上的当前日期和时间。 请注意，值（表示自 0001 年 1 月 1 日午夜以来经过的计时周期数）与该值DateTime的字符串表示形式（以特定于区域性的格式表示日期和时间值）之间存在DateTime差异。</p> 
<p>准确性受服务器时间影响</p> 
<pre><code class="prism language-csharp"><span class="token class-name">DateTime</span> dt1 <span class="token operator">=</span> System<span class="token punctuation">.</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">;</span>
System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time_cap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DateTime</span> dt2 <span class="token operator">=</span> System<span class="token punctuation">.</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">;</span>

<span class="token class-name">TimeSpan</span> ts <span class="token operator">=</span> dt2<span class="token punctuation">.</span><span class="token function">Subtract</span><span class="token punctuation">(</span>dt1<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"example1 time {0}"</span><span class="token punctuation">,</span> ts<span class="token punctuation">.</span>TotalMilliseconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="Stopwatch_15"></a>Stopwatch</h3> 
<p>Stopwatch 在基础计时器机制中对计时器的计时周期进行计数，从而测量运行时间。 如果安装的硬件和操作系统支持高分辨率性能计数器，则 Stopwatch 类将使用该计数器来测量运行时间； 否则，Stopwatch 类将使用系统计数器来测量运行时间。 使用 Frequency 和 IsHighResolution 字段可以确定实现 Stopwatch 计时的精度和分辨率。</p> 
<pre><code class="prism language-csharp"><span class="token class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Stopwatch</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Stopwatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sw<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time_cap<span class="token punctuation">)</span><span class="token punctuation">;</span>
sw<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//这个是实例运行的毫秒数</span>
<span class="token comment">//sw.ElapsedMilliseconds</span>
<span class="token class-name">TimeSpan</span> ts2 <span class="token operator">=</span> sw<span class="token punctuation">.</span>Elapsed<span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"example2 time {0}"</span><span class="token punctuation">,</span> ts2<span class="token punctuation">.</span>TotalMilliseconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="c_API_29"></a>c++ API</h3> 
<p><img src="https://images2.imgbox.com/f7/d7/iWksqj33_o.png" alt="在这里插入图片描述"><br> 如果已安装的硬件支持高分辨率性能计数器，则返回值为非零值。</p> 
<p>如果函数失败，则返回值为零。 要获得更多的错误信息，请调用 GetLastError。 在运行 Windows XP 或更高版本的系统上，该函数将始终成功，因此永远不会返回零。</p> 
<pre><code class="prism language-csharp"><span class="token class-name"><span class="token keyword">long</span></span> count1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">long</span></span> count2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">long</span></span> freq <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">double</span></span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token function">QueryPerformanceFrequency</span><span class="token punctuation">(</span><span class="token keyword">ref</span> freq<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">QueryPerformanceCounter</span><span class="token punctuation">(</span><span class="token keyword">ref</span> count1<span class="token punctuation">)</span><span class="token punctuation">;</span>
System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time_cap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">QueryPerformanceCounter</span><span class="token punctuation">(</span><span class="token keyword">ref</span> count2<span class="token punctuation">)</span><span class="token punctuation">;</span>

result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span>count2 <span class="token operator">-</span> count1<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>freq<span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"example3 time {0}"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>最后，推荐使用Stopwatch</strong></p> 
<ul><li>代码可读性高</li><li>精度ok</li><li>便捷</li></ul> 
<blockquote> 
 <p>没有粉丝，没有评论，甚至连读者都没有。因为自己写的烂，因为自己水平有限，所以自己的作品一经发出就石沉大海了，得不到任何的回信，就好像自己写的东西是给自己看的。自己的作品怎么看都好像不够完美，全身的毛病，所以读者不喜欢也很正常对吧！</p> 
</blockquote> 
<blockquote> 
 <p>其实最让我开心的是有些读者们夸我文笔不错，或许是有人第一次这样夸我的缘故吧！又或许是我写的东西没什么人认可，我感受到了一种前所未有的激动，对于未来的憧憬，对自己写下去的动力。</p> 
</blockquote> 
<blockquote> 
 <p>因为有你们，我的写作之路才不孤独，因为有你们，我才能坚持到现在，如果有一天我真的写出圈了，或许我们可以整个交流会之类的，到时候促膝长谈。</p> 
</blockquote> 
<blockquote> 
 <p>“书山有路勤为径，学海无涯苦作舟。”写作苦是苦了点，整得我差点就想放弃了，不过还好有你们。我也不急着成功，因为没有个几十年如一日的坚持，哪能轻易成功？</p> 
</blockquote> 
<blockquote> 
 <p>茫茫文海无人意，天下有君识吾心。文海很孤独，但是有诸君，便足以令我至千里。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ae27e4cb82493aefe7118dcc0ec3d24e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL 字符串的排序规则解析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b46b950f9f3c48336c78a9619442695/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python 求2个正整数的最小公倍数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>