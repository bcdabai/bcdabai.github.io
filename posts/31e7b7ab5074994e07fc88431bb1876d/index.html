<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32F1xx HAL库 中文详解 之 ADC篇 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32F1xx HAL库 中文详解 之 ADC篇" />
<meta property="og:description" content="本文主要从ADC中用到的结构体、函数以及用法讲解。
目录
一、结构体
1.ADC_InitTypeDef
2.ADC_ChannelConfTypeDef
3.ADC_AnalogWDGConfTypeDef
4.ADC_HandleTypeDef
二、函数
2.1所有函数的概括及功能
三、ADC的使用
3.1配置ADC相关的顶级参数：
ADC外围功能：
●12位分辨率 ●常规转换结束时产生中断，注入转换结束时产生中断，以及发生模拟看门狗或溢出事件时产生中断。 ●单、连续转换模式。 ●扫描模式，多通道顺序转换。 ●内置数据一致性的数据对齐。 ●可编程采样时间(通道) ●常规组与注射组ADC转换。 ●常规组和注射组的外部触发器(定时器或EXTI)。 ●DMA请求生成，用于传输常规组的转换数据。 ●多模双模(可用于2台或更多adc的设备)。 ●可配置多模式双模式DMA数据存储(可用于2个或更多DCs的设备)。 ●双交错模式转换之间的可配置延迟(可用于2个或更多DCs的设备)。 ●ADC校准 ●ADC电源要求:全速时2.4 V到3.6 V，低速时降低到1.8 V。 ●ADC输入范围:从Vref-(连接到vsa)到Vref&#43;(连接到Vdda或外部参考电压)。
一、结构体 1.ADC_InitTypeDef typedef struct { uint32_t DataAlign uint32_t ScanConvMode uint32_t ContinuousConvMode uint32_t NbrOfConversion uint32_t	DiscontinuousConvMode uint32_t NbrOfDiscConversion uint32_t	ExternalTrigConv } ADC_InitTypeDef 每个参数的含义：
DataAlign：表示对齐模式,因为我们ADC采集的数据放在ADC_DR 寄存器,ADC分辨率是12所以只能放12位,但是ADC_DR寄存器是16位的,所以要选择向左对齐还是向右对齐
宏定义：
ADC_DATAALIGN_RIGHT 右对齐
ADC_DATAALIGN_LEFT 左对齐
ScanConvMode： ADC的扫描模式,配置ADC_CR1的SCAN位,扫描模式指的是不断扫描ADC1,2,3,扫描多用在多通道上
宏定义：
Enable 使能
Disable 失能
ContinuousConvMode：连续转换模式,配置的是ADC_CR2的CON位,表示ADC通道连续采集,一次采集转化完继续采集
宏定义：
Enable 使能" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/31e7b7ab5074994e07fc88431bb1876d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-14T15:24:04+08:00" />
<meta property="article:modified_time" content="2021-10-14T15:24:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32F1xx HAL库 中文详解 之 ADC篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文主要从ADC中用到的结构体、函数以及用法讲解。</p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93" rel="nofollow" title="一、结构体">一、结构体</a></p> 
<p id="1.ADC_InitTypeDef-toc" style="margin-left:40px;"><a href="#1.ADC_InitTypeDef" rel="nofollow" title="1.ADC_InitTypeDef">1.ADC_InitTypeDef</a></p> 
<p id="2.ADC_ChannelConfTypeDef-toc" style="margin-left:40px;"><a href="#2.ADC_ChannelConfTypeDef" rel="nofollow" title="2.ADC_ChannelConfTypeDef">2.ADC_ChannelConfTypeDef</a></p> 
<p id="3.ADC_AnalogWDGConfTypeDef-toc" style="margin-left:40px;"><a href="#3.ADC_AnalogWDGConfTypeDef" rel="nofollow" title="3.ADC_AnalogWDGConfTypeDef">3.ADC_AnalogWDGConfTypeDef</a></p> 
<p id="4.ADC_HandleTypeDef-toc" style="margin-left:40px;"><a href="#4.ADC_HandleTypeDef" rel="nofollow" title="4.ADC_HandleTypeDef">4.ADC_HandleTypeDef</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%87%BD%E6%95%B0-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%87%BD%E6%95%B0" rel="nofollow" title="二、函数">二、函数</a></p> 
<p id="2.1%E6%89%80%E6%9C%89%E5%87%BD%E6%95%B0%E7%9A%84%E6%A6%82%E6%8B%AC%E5%8F%8A%E5%8A%9F%E8%83%BD-toc" style="margin-left:40px;"><a href="#2.1%E6%89%80%E6%9C%89%E5%87%BD%E6%95%B0%E7%9A%84%E6%A6%82%E6%8B%AC%E5%8F%8A%E5%8A%9F%E8%83%BD" rel="nofollow" title="2.1所有函数的概括及功能">2.1所有函数的概括及功能</a></p> 
<p id="%E4%B8%89%E3%80%81ADC%E7%9A%84%E4%BD%BF%E7%94%A8-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81ADC%E7%9A%84%E4%BD%BF%E7%94%A8" rel="nofollow" title="三、ADC的使用">三、ADC的使用</a></p> 
<p id="3.1%E9%85%8D%E7%BD%AEADC%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A1%B6%E7%BA%A7%E5%8F%82%E6%95%B0%EF%BC%9A-toc" style="margin-left:40px;"><a href="#3.1%E9%85%8D%E7%BD%AEADC%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A1%B6%E7%BA%A7%E5%8F%82%E6%95%B0%EF%BC%9A" rel="nofollow" title="3.1配置ADC相关的顶级参数：">3.1配置ADC相关的顶级参数：</a></p> 
<hr id="hr-toc"> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><strong><span style="color:#666666;">ADC</span></strong><strong><span style="color:#666666;">外围功能：</span></strong></span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●12</span><span style="color:#333333;">位分辨率</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">常规转换结束时产生中断，注入转换结束时产生中断，以及发生模拟看门狗或溢出事件时产生中断。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">单、连续转换模式。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">扫描模式，多通道顺序转换。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">内置数据一致性的数据对齐。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">可编程采样时间</span><span style="color:#333333;">(</span><span style="color:#333333;">通道</span><span style="color:#333333;">)  </span></span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">常规组与注射组</span><span style="color:#333333;">ADC</span><span style="color:#333333;">转换。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">常规组和注射组的外部触发器</span><span style="color:#333333;">(</span><span style="color:#333333;">定时器或</span><span style="color:#333333;">EXTI)</span><span style="color:#333333;">。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●DMA</span><span style="color:#333333;">请求生成，用于传输常规组的转换数据。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">多模双模</span><span style="color:#333333;">(</span><span style="color:#333333;">可用于</span><span style="color:#333333;">2</span><span style="color:#333333;">台或更多</span><span style="color:#333333;">adc</span><span style="color:#333333;">的设备</span><span style="color:#333333;">)</span><span style="color:#333333;">。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">可配置多模式双模式</span><span style="color:#333333;">DMA</span><span style="color:#333333;">数据存储</span><span style="color:#333333;">(</span><span style="color:#333333;">可用于</span><span style="color:#333333;">2</span><span style="color:#333333;">个或更多</span><span style="color:#333333;">DCs</span><span style="color:#333333;">的设备</span><span style="color:#333333;">)</span><span style="color:#333333;">。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●</span><span style="color:#333333;">双交错模式转换之间的可配置延迟</span><span style="color:#333333;">(</span><span style="color:#333333;">可用于</span><span style="color:#333333;">2</span><span style="color:#333333;">个或更多</span><span style="color:#333333;">DCs</span><span style="color:#333333;">的设备</span><span style="color:#333333;">)</span><span style="color:#333333;">。</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●ADC</span><span style="color:#333333;">校准</span>  </span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">●ADC</span><span style="color:#333333;">电源要求</span><span style="color:#333333;">:</span><span style="color:#333333;">全速时</span><span style="color:#333333;">2.4 V</span><span style="color:#333333;">到</span><span style="color:#333333;">3.6 V</span><span style="color:#333333;">，低速时降低到</span><span style="color:#333333;">1.8 V</span><span style="color:#333333;">。</span>  </span></p> 
<p><span style="color:#333333;">●ADC</span><span style="color:#333333;">输入范围</span><span style="color:#333333;">:</span><span style="color:#333333;">从</span><span style="color:#333333;">Vref-(</span><span style="color:#333333;">连接到</span><span style="color:#333333;">vsa)</span><span style="color:#333333;">到</span><span style="color:#333333;">Vref+(</span><span style="color:#333333;">连接到</span><span style="color:#333333;">Vdda</span><span style="color:#333333;">或外部参考电压</span><span style="color:#333333;">)</span><span style="color:#333333;">。</span></p> 
<h2 id="%E4%B8%80%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93">一、结构体</h2> 
<h3 id="1.ADC_InitTypeDef">1.ADC_InitTypeDef</h3> 
<pre><code class="language-cpp">typedef struct 
{
uint32_t 	DataAlign 
uint32_t 	ScanConvMode 
uint32_t 	ContinuousConvMode 
uint32_t 	NbrOfConversion 
uint32_t		 DiscontinuousConvMode 
uint32_t 	NbrOfDiscConversion 
uint32_t		 ExternalTrigConv 

} ADC_InitTypeDef
</code></pre> 
<p style="margin-left:.0001pt;"><strong>每个参数的含义：</strong></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><strong><em>DataAlign</em></strong><strong><em>：</em></strong>表示对齐模式,因为我们ADC采集的数据放在ADC_DR 寄存器,ADC分辨率是12所以只能放12位,但是ADC_DR寄存器是16位的,所以要选择向左对齐还是向右对齐</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">宏定义：</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_DATAALIGN_RIGHT          右对齐</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_DATAALIGN_LEFT             左对齐</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><strong><em>ScanConvMode</em></strong><strong><em>：</em></strong><strong><em> </em></strong><em>ADC的扫描模式,配置ADC_CR1的SCAN位,扫描模式指的是不断扫描ADC1,2,3,扫描多用在多通道上</em></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">宏定义：</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">       Enable           使能</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">       Disable          失能</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><strong><em>ContinuousConvMode</em></strong><strong><em>：</em></strong>连续转换模式,配置的是ADC_CR2的CON位,表示ADC通道连续采集,一次采集转化完继续采集</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">宏定义：</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">       Enable           使能</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">       Disable          失能</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><strong><em>NbrOfConversion</em></strong><strong><em>：</em></strong>ADC要转化的通道数目,可以设置为1-16，<span style="color:#ff0000;">直接填写数字</span><span style="color:#ff0000;"> 1-16</span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><strong><em>DiscontinuousConvMode</em></strong><strong><em>：</em></strong>指定正则组的转换序列是否在全序/不连续序(主序又分为连续的部分)。 只有在启用了音序器时才使用不连续模式(参数“ScanConvMode”)。 如果sequencer被禁用，该参数将被丢弃。 只有在禁用连续模式的情况下，才能启用不连续模式。 如果连续模式开启时，该参数将被丢弃。 该参数可以设置为启用或禁用。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">宏定义：</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">       Enable           使能</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">       Disable          失能</span></p> 
<p style="margin-left:0;"><span style="background-color:#f7f8fa;"><strong><em><span style="color:#000000;">NbrOfDiscConversion</span></em></strong><strong><em><span style="color:#000000;">：</span></em></strong><span style="color:#000000;">指定主序列的不连续转换的次数</span><span style="color:#000000;">regular group(</span><span style="color:#000000;">参数</span><span style="color:#000000;">NbrOfConversion)</span><span style="color:#000000;">将被细分。</span> <span style="color:#000000;">如果参数</span><span style="color:#000000;">DiscontinuousConvMode</span><span style="color:#000000;">被禁用，该参数将被丢弃。</span> <span style="color:#000000;">这个参数必须是</span><span style="color:#000000;">Min_Data = 1</span><span style="color:#000000;">和</span><span style="color:#000000;">Max_Data = 8</span><span style="color:#000000;">之间的一个数字，</span><span style="color:#ff0000;">即必须是</span><span style="color:#ff0000;">1-8</span><span style="color:#ff0000;">之间的数字。</span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><strong><em>ExternalTrigConv</em></strong><strong><em>：</em></strong>外部触发转换选择, 配置ADC_CR2的EXTTRIG和EXTSEL[2:0],EXTTRIG使能触发源,EXTSEL[2:0]选择哪一个触发源,如果不选择外部触发,可以选择软件触发 </span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC External trigger selection for regular group</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T1_CC1             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T1_CC2             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">2</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T2_CC2             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">2</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">2</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T3_TRGO          <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">3</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">TRGO</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T4_CC4             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">4</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">4</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_EXT_IT11         <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择外部中断线</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">11</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">事件作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T2_CC3             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">2</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">3</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T3_CC1             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">3</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T5_CC1             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">5</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T5_CC3             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">5</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">3</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T8_CC1             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">8</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T1_CC3             <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">1</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的捕获比较</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">3</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_EXTERNALTRIGCONV_T8_TRGO          <span style="background-color:#f7f8fa;"><span style="color:#333333;">选择定时器</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">8</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">的</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">TRGO</span></span><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为转换外部触发</span></span></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SOFTWARE_START                                   选择软件触发</span></p> 
<h3 id="2.ADC_ChannelConfTypeDef" style="margin-left:.0001pt;"><span style="color:#0d0016;">2.<strong>ADC_ChannelConfTypeDef</strong></span></h3> 
<pre><code class="language-cpp">typedef struct 
{
uint32_t 	Channel;	    //转换通道配置
uint32_t	 	Rank;		//转换序列排序
uint32_t 	SamplingTime;	//采样时间设置
} ADC_ChannelConfTypeDef;
</code></pre> 
<p>每个参数的含义：</p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><em><span style="color:#000000;">Channel</span></em></strong><strong><em><span style="color:#000000;">：</span></em></strong><span style="color:#000000;">配置转换通道。</span><span style="color:#000000;">根据设备的不同，有些通道可能在封装引脚上不可用。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_0                通道0</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_1                通道1</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_2                通道2</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_3                通道3</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_4                通道4</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_5                通道5</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_6                通道6</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_7                通道7</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_8                通道8</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_9                通道9</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_10                通道10</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_11                通道11</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_12                通道12</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_13                通道13</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_14                通道14</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_15                通道15</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_16                通道16</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_17                通道17</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_TEMPSENSOR        </span>ADC内部通道(在设备引脚上没有连接)</p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#000000;">ADC_CHANNEL_VREFINT                   </span>ADC内部通道(在设备引脚上没有连接)</p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">Rank：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">用于配置规则通道的转换顺序，如果想禁止一个通道或者改变一个通道的顺序，可以使用新配置覆盖。</span></span><span style="color:#fe2c24;">写的时候可以直接写数值，不用写宏定义，以为宏定义的通道和数值是对应的，通道1的值就是1，通道2的值就是2…以此类推</span><span style="color:#4d4d4d;">，例如：</span><span style="color:#4d4d4d;">ADC1_ChanConf.Rank=1;</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_1               1</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_2               2</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_3               3</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_4               4</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_5               5</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_6               6</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_7               7  </span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_8               8</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_9               9</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_10            10</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_11             11  </span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_12             12</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_13             13</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_14             14</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_15             15 </span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_REGULAR_RANK_16             16</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">SamplingTime：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">用于所选通道的采样时间配置，ADC</span><span style="color:#4d4d4d;">的采样速度是由采样时间和转换时间同决定。用于内部通道测量时（</span><span style="color:#4d4d4d;">VrefInt/Vbat/TempSensor</span><span style="color:#4d4d4d;">），务必要遵循数据手册要求的参数范围。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_1CYCLE_5                <strong>采样时间1.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_7CYCLES_5              <strong>采样时间7.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_13CYCLES_5            <strong>采样时间13.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_28CYCLES_5            <strong>采样时间28.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_41CYCLES_5            <strong>采样时间41.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_55CYCLES_5            <strong>采样时间55.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_71CYCLES_5            <strong>采样时间71.5 ADC</strong><strong>时钟周期</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;">ADC_SAMPLETIME_239CYCLES_5          <strong>采样时间239.5 ADC</strong><strong>时钟周期</strong></span></p> 
<h3 id="3.ADC_AnalogWDGConfTypeDef" style="margin-left:.0001pt;text-align:left;"><span style="color:#0d0016;"><strong>3.ADC_AnalogWDGConfTypeDef</strong></span></h3> 
<pre><code class="language-cpp">typedef struct
{
    uint32_t		 WatchdogMode; 
    uint32_t 	     Channel; 
    FunctionalState  ITMode; 
    uint32_t 	     HighThreshold; 
    uint32_t 	     LowThreshold; 
    uint32_t 	     WatchdogNumber; 
}ADC_AnalogWDGConfTypeDef;
</code></pre> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">WatchdogMode：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">此参数用于设置模拟看门狗模式。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC analog watchdog mode</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_NONE</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_SINGLE_REG</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_SINGLE_INJEC</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_SINGLE_REGINJEC</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_ALL_REG</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_ALL_INJEC</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_ALL_REGINJEC</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">Channel：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">用于配置要监测的通道。</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">对于模拟看门狗1</span><span style="color:#4d4d4d;">，参数成员</span><span style="color:#4d4d4d;">WatchdogMode</span><span style="color:#4d4d4d;">配置为单个通道时，此参数才有意义。</span> <span style="color:#4d4d4d;">对于模拟看门狗</span><span style="color:#4d4d4d;">2</span><span style="color:#4d4d4d;">和</span><span style="color:#4d4d4d;">3</span><span style="color:#4d4d4d;">，每调用一次函数</span><span style="color:#4d4d4d;">HAL_ADC_AnalogWDGConfig</span><span style="color:#4d4d4d;">可以指定一个通道，如果要复位那个通道，将参数</span><span style="color:#4d4d4d;">WatchdogMode</span><span style="color:#4d4d4d;">配置为</span><span style="color:#4d4d4d;">ADC_ANALOGWATCHDOG_NONE</span><span style="color:#4d4d4d;">即可。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">ITMode：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">用于配置模拟看门狗为中断方式或者查询方式。</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">配置为ENABEL</span><span style="color:#4d4d4d;">表示使用中断方式，配置为</span><span style="color:#4d4d4d;">DISABLE</span><span style="color:#4d4d4d;">表示查询方式。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">HighThreshold：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">用于配置模拟看门狗高阀值。根据配置的ADC</span><span style="color:#4d4d4d;">的分辨率</span><span style="color:#4d4d4d;">16, 14, 12, 10</span><span style="color:#4d4d4d;">或者</span><span style="color:#4d4d4d;">8bit</span><span style="color:#4d4d4d;">，高阀值最小都是</span><span style="color:#4d4d4d;">0x0000</span><span style="color:#4d4d4d;">，最大值分别是</span><span style="color:#4d4d4d;">0xFFFF, 0x3FFF, 0xFFF, 0x3FF </span><span style="color:#4d4d4d;">和</span><span style="color:#4d4d4d;"> 0xFF</span><span style="color:#4d4d4d;">。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;"> LowThreshold：</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">用于配置模拟看门狗低阀值。根据配置的ADC</span><span style="color:#4d4d4d;">的分辨率</span><span style="color:#4d4d4d;">16, 14, 12, 10</span><span style="color:#4d4d4d;">或者</span><span style="color:#4d4d4d;">8bit</span><span style="color:#4d4d4d;">，高阀值最小都是</span><span style="color:#4d4d4d;">0x0000</span><span style="color:#4d4d4d;">，最大值分别是</span><span style="color:#4d4d4d;">0xFFFF, 0x3FFF, 0xFFF, 0x3FF </span><span style="color:#4d4d4d;">和</span><span style="color:#4d4d4d;"> 0xFF</span><span style="color:#4d4d4d;">。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">WatchdogNumber：</span></strong></span><span style="color:#4d4d4d;">此参数成员用于配置选择那个看门狗监测通道。</span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">ADC_ANALOGWATCHDOG_1       </span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;">ADC_ANALOGWATCHDOG_2     </span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;"> ADC_ANALOGWATCHDOG_3      </span></p> 
<h3 id="4.ADC_HandleTypeDef" style="margin-left:.0001pt;text-align:left;"><span style="color:#0d0016;"><strong>4.ADC_HandleTypeDef</strong></span></h3> 
<pre><code class="language-cpp">typedef struct __ADC_HandleTypeDef
{
    ADC_TypeDef	        *Instance; 
    ADC_InitTypeDef 	Init; 
    DMA_HandleTypeDef	*DMA_Handle; 
    HAL_LockTypeDef    	Lock; 
    __IO uint32_t		State; 
    __IO uint32_t		ErrorCode;  
}ADC_HandleTypeDef;
</code></pre> 
<p style="text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#333333;">*Instance</span></strong></span>：<span style="background-color:#ffffff;"><span style="color:#4d4d4d;">这个参数是寄存器的例化，方便操作寄存器，比如使能</span><span style="color:#4d4d4d;">ADC</span><span style="color:#4d4d4d;">内部稳压器。</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">SET_BIT(hadc-&gt;Instance-&gt;CR,  ADC_CR_ADVREGEN);</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#333333;"><strong>Init: </strong></span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">这个参数是用户接触最多的，用于配置ADC</span><span style="color:#4d4d4d;">的基本参数，像</span><span style="color:#4d4d4d;">ADC</span><span style="color:#4d4d4d;">时钟、分辨率、扫描模式、过采样等。</span></span></p> 
<p style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#333333;"><strong>*DMA_Handle:</strong></span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">如果ADC</span><span style="color:#4d4d4d;">使用</span><span style="color:#4d4d4d;">DMA</span><span style="color:#4d4d4d;">模式的话，此参数用于关联</span><span style="color:#4d4d4d;">DMA</span><span style="color:#4d4d4d;">的句柄，方便</span><span style="color:#4d4d4d;">DMA</span><span style="color:#4d4d4d;">的配置。</span></span></p> 
<p style="text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#333333;">        HAL_LockTypeDef   Lock</span></strong></span></p> 
<p style="text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#333333;">        __IO uint32_t    State;</span></strong></span></p> 
<p style="text-align:left;"><span style="background-color:#ffffff;"><strong><span style="color:#333333;">        __IO uint32_t    ErrorCode</span></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#000000;"><span style="color:#4d4d4d;">这三个变量主要供函数内部使用。</span><span style="color:#4d4d4d;">Lock</span><span style="color:#4d4d4d;">用于设置锁状态，</span><span style="color:#4d4d4d;">State</span><span style="color:#4d4d4d;">用于设置</span><span style="color:#4d4d4d;">ADC</span><span style="color:#4d4d4d;">通信状态，而</span><span style="color:#4d4d4d;">ErrorCode</span><span style="color:#4d4d4d;">用于配置代码错误。</span></span></p> 
<p style="margin-left:.0001pt;"><span style="background-color:#ffffff;"><strong><span style="color:#333333;"> InjectionConfig:</span></strong></span><span style="color:#4d4d4d;">用于配置ADC</span><span style="color:#4d4d4d;">注入模式。</span></p> 
<h2 id="%E4%BA%8C%E3%80%81%E5%87%BD%E6%95%B0" style="margin-left:.0001pt;">二、函数</h2> 
<h3 id="2.1%E6%89%80%E6%9C%89%E5%87%BD%E6%95%B0%E7%9A%84%E6%A6%82%E6%8B%AC%E5%8F%8A%E5%8A%9F%E8%83%BD">2.1所有函数的概括及功能</h3> 
<table border="1" cellpadding="1" cellspacing="1" style="width:700px;"><tbody><tr><td style="text-align:center;"><span style="color:#0d0016;">函数</span></td><td style="text-align:center;"><span style="color:#0d0016;">功能</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Init()</span></td><td style="text-align:center;"><span style="color:#0d0016;">根据结构“ADC InitTvpeDef”中指定的参数初始化ADC外围和常规组</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_DeInit()</span></td><td style="text-align:center;"><span style="color:#0d0016;">通过对ADC MSP的初始化，将ADC外围寄存器初始化为它们的默认重置值</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_MspInit()</span></td><td style="text-align:center;"><span style="color:#0d0016;">初始化ADC MSP</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_MspDeInit()</span></td><td style="text-align:center;"><span style="color:#0d0016;">重置ADC MSP</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Start()</span></td><td style="text-align:center;"><span style="color:#0d0016;">启用ADC，开始常规组转换</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Stop()</span></td><td style="text-align:center;"><span style="color:#0d0016;">停止常规组ADC转换(自动注入模式下停止注入通道)，关闭ADC外设</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_PollForConversion()</span></td><td style="text-align:center;"><span style="color:#0d0016;">等待规则组转换完成</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_PollForEvent()</span></td><td style="text-align:center;"><span style="color:#0d0016;">转换事件轮询</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Start_IT()</span></td><td style="text-align:center;"><span style="color:#0d0016;">启用ADC，开始有中断的常规组转换</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Stop_IT()</span></td><td style="text-align:center;"><span style="color:#0d0016;">停止常规组(自动注入组和注入组)的ADC转换，禁用转换结束中断，禁用ADC外设</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Start_DMA()</span></td><td style="text-align:center;"><span style="color:#0d0016;">启用ADC，开始常规组转换，并通过DMA传输结果</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_Stop_DMA()</span></td><td style="text-align:center;"><span style="color:#0d0016;">停止常规组(自动注入组和注入组)的ADC转换，禁用ADC DMA传输。禁用ADC外围</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_GetValue()</span></td><td style="text-align:center;"><span style="color:#0d0016;">得到ADC常规组转换结果</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_IRQHandler()</span></td><td style="text-align:center;"><span style="color:#0d0016;">处理ADC中断请求</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_ConvCpltCallback()</span></td><td style="text-align:center;"><span style="color:#0d0016;">转换完成回调在非阻塞模式</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_ConvHalfCpltCallback()</span></td><td style="text-align:center;"><span style="color:#0d0016;">在非阻塞模式下转换DMA半转移回调</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_LevelOutOfWindowCallback()</span></td><td style="text-align:center;"><span style="color:#0d0016;">模拟看门狗回叫在非阻塞模式</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_ErrorCallback()</span></td><td style="text-align:center;"><span style="color:#0d0016;">非阻塞模式下的ADC错误回调(带有中断或DMA传输的ADC转换)</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_ConfigChannel()</span></td><td style="text-align:center;"><span style="color:#0d0016;">配置要链接到正规组的所选通道</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_AnalogWDGConfig()</span></td><td style="text-align:center;"><span style="color:#0d0016;">配置模拟看门狗</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_GetState()</span></td><td style="text-align:center;"><span style="color:#0d0016;">返回ADC状态</span></td></tr><tr><td style="text-align:center;"><span style="color:#0d0016;">HAL_ADC_GetError()</span></td><td style="text-align:center;"><span style="color:#0d0016;">返回ADC错误码</span></td></tr></tbody></table> 
<p></p> 
<h2 id="%E4%B8%89%E3%80%81ADC%E7%9A%84%E4%BD%BF%E7%94%A8">三、ADC的使用</h2> 
<h3 id="3.1%E9%85%8D%E7%BD%AEADC%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A1%B6%E7%BA%A7%E5%8F%82%E6%95%B0%EF%BC%9A" style="margin-left:0px;"><span style="background-color:#f7f8fa;"><strong><span style="color:#666666;">3.1配置</span></strong><strong><span style="color:#666666;">ADC</span></strong><strong><span style="color:#666666;">相关的顶级参数：</span></strong></span></h3> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#f7f8fa;"><strong><span style="color:#666666;">1.</span></strong><strong><span style="color:#666666;">启用</span></strong><strong><span style="color:#666666;">ADC</span></strong><strong><span style="color:#666666;">接口</span></strong></span></p> 
<ul><li><span style="background-color:#f7f8fa;"><span style="color:#333333;">作为先决条件，</span><span style="color:#333333;">ADC</span><span style="color:#333333;">时钟必须配置在</span><span style="color:#333333;">RCC</span><span style="color:#333333;">顶级。</span> <span style="color:#333333;">注意</span><span style="color:#333333;">:</span><span style="color:#333333;">在</span><span style="color:#333333;">STM32F1, ADC</span><span style="color:#333333;">时钟频率最大值为</span><span style="color:#333333;">14MHz(</span><span style="color:#333333;">参考设备数据表</span><span style="color:#333333;">)</span><span style="color:#333333;">。因此，在</span><span style="color:#333333;">ADC</span><span style="color:#333333;">时钟功能中必须配置</span><span style="color:#333333;">ADC</span><span style="color:#333333;">时钟预分器源频率保持在这个最大频率以下。</span>  </span></li><li><span style="background-color:#f7f8fa;"><span style="color:#333333;">一个时钟设置是强制性的</span><span style="color:#333333;">:ADC</span><span style="color:#333333;">时钟</span><span style="color:#333333;">(</span><span style="color:#333333;">核心时钟，也可能转换钟</span><span style="color:#333333;">)</span><span style="color:#333333;">。</span></span></li></ul> 
<p style="margin-left:36pt;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">示例</span><span style="color:#333333;">:Into HAL_ADC_MspInit()(</span><span style="color:#333333;">推荐的代码位置</span><span style="color:#333333;">)</span><span style="color:#333333;">或</span><span style="color:#333333;">with</span><span style="color:#333333;">其他设备时钟参数配置</span><span style="color:#333333;">:</span> </span></p> 
<p style="margin-left:36pt;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">RCC_PeriphCLKInitTypeDef PeriphClkInit;</span></span></p> 
<p style="margin-left:36pt;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">__ADC1_CLK_ENABLE();</span></span></p> 
<p style="margin-left:36pt;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_ADC;</span></span></p> 
<p style="margin-left:36pt;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">PeriphClkInit.AdcClockSelection = RCC_ADCPCLK2_DIV2;</span></span></p> 
<p style="margin-left:36pt;"><span style="background-color:#f7f8fa;"><span style="color:#333333;">HAL_RCCEx_PeriphCLKConfig(&amp;PeriphClkInit);</span></span></p> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#f7f8fa;"><strong><span style="color:#666666;">2. ADC</span></strong><strong><span style="color:#666666;">引脚配置</span></strong></span></p> 
<ul><li><span style="background-color:#f7f8fa;">使用宏 <span style="color:#333333;">__HAL_RCC_GPIOx_CLK_ENABLE() </span>为ADC gpio启用时钟</span></li><li><span style="background-color:#f7f8fa;">使用函数HAL_GPIO_Init()在模拟模式下配置这些ADC引脚</span></li></ul> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#f7f8fa;"><strong><span style="color:#666666;">3. </span></strong><strong><span style="color:#666666;">可选地，在</span></strong><strong><span style="color:#666666;">ADC</span></strong><strong><span style="color:#666666;">使用中断的情况下</span></strong><strong><span style="color:#666666;">: </span></strong></span></p> 
<ul><li><span style="background-color:#f7f8fa;">使用功能HAL_NVIC_EnableIRQ(ADCx_IRQn)配置ADC的NVIC  </span></li><li><span style="background-color:#f7f8fa;">将ADC中断处理函数HAL_ADC_IRQHandler()插入对应ADC中断向量ADCx_IRQHandler()的函数。  </span></li></ul> 
<p style="margin-left:.0001pt;text-align:left;"><span style="background-color:#f7f8fa;"><strong><span style="color:#666666;">4. </span></strong><strong><span style="color:#666666;">可选地，在使用</span></strong><strong><span style="color:#666666;">DMA</span></strong><strong><span style="color:#666666;">时</span></strong><strong><span style="color:#666666;">:</span></strong></span></p> 
<ul><li><span style="background-color:#f7f8fa;">配置DMA (DMA通道，模式正常或循环，…)使用功能HAL_DMA_Init()。  </span></li><li><span style="background-color:#f7f8fa;">配置NVIC for DMA using功能HAL_NVIC_EnableIRQ (DMAx_Channelx_IRQn)  </span></li></ul> 
<p>将ADC中断处理函数HAL_ADC_IRQHandler()插入对应DMA中断向量的函数DMAx_Channelx_IRQHandler()。</p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fa07724f23cc9bd15b9a3326eff84544/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二进制部署K8s集群:(2) 设定自签证书</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7704ccea6b19e4e451d578f2ffaa8e80/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何在线快速修改图片、转换图片格式？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>