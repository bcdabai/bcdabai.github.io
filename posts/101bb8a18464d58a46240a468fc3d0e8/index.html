<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>认识DLL动态链接库，以及如何用VS创建并调用一个DLL - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="认识DLL动态链接库，以及如何用VS创建并调用一个DLL" />
<meta property="og:description" content="认识DLL动态链接库 DLL是安全人不可缺少的一项技能
要认识动态链接库，首先要认识库这一概念：简单来说，库就是能够提供给使用者包含一些开箱即用的变量、函数或类的可执行代码的二进制形式，它可以被操作系统载入内存执行。
库分为两种，静态库（windows中后缀.lib）与动态库（win中后缀.dll）
这两类库的区别体现在程序的链接阶段：静态库在程序的链接阶段被直接复制到了程序中；动态库则没有，而是在程序运行时由系统动态加载到内存中供程序调用。
由此，动态链接库的优势体现了出来，那就是它相比于静态链接库来说非常节省内存，在程序运行时只需要动态加载一次即可，这也是如今动态链接库被高频使用在大型软件中的原因（用户在更新时只需要更新动态库即可，增量更新）。
实现工具：Visual Studio 2022
编程实现Dll 在此我们编写两个函数，一个函数返回斐波那契数列前n项之和，另一个函数返回输入值的阶乘
打开vs创建dll动态链接库新项目，项目名为Dll1
之后分别添加头文件mydll.h和源文件mydll.cpp
编写头文件：
在编写头文件时，通常都会加第3，4行代码，这是为了防止头文件的重复调用；由于要用C编写函数代码，所以要用exturn “C”声明在链接时使用C库函数规范来链接。在函数定义前面的__declspec(dllexport)用于导出符号，也就是定义该函数的dll；
编写源文件：
编写实现输出斐波那契数列前N项和的函数Fibonacci_Sum（）
（注意在文件头要加上刚才编写好的头文件，这样编写好的函数才能被导出为dll）
编写返回输入值阶乘的函数Factorial（）
编写完成，右键项目生成方案：
编程，调用实现的DLL 添加新项目，选择控制台应用
由于要调用DLL，所以需要设置此项目的属性：
首先，由于需要包括mydll.h这个头文件，需要在包含路径中设置：
其次，需要引入lib符号文件：
在链接器属性一栏中添加符号文件作为依赖项
然后给符号文件添加搜索路径：
最后，添加源文件编写调用代码调用DLL:
调用代码分别调用了两个函数，分别输出前5项斐波那契数列之和以及5的阶乘：
调用成功！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/101bb8a18464d58a46240a468fc3d0e8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-30T09:36:19+08:00" />
<meta property="article:modified_time" content="2022-09-30T09:36:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">认识DLL动态链接库，以及如何用VS创建并调用一个DLL</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 style="margin-left:0px;">认识DLL动态链接库</h4> 
<p>DLL是安全人不可缺少的一项技能</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">要认识动态链接库，首先要认识库这一概念：简单来说，库就是能够提供给使用者包含一些开箱即用的变量、函数或类的可执行代码的二进制形式，它可以被操作系统载入内存执行。</p> 
<p style="margin-left:0;text-align:justify;">库分为两种，静态库（windows中后缀.lib）与动态库（win中后缀.dll）</p> 
<p style="margin-left:0;text-align:justify;">这两类库的区别体现在程序的链接阶段：静态库在程序的链接阶段被直接复制到了程序中；动态库则没有，而是在程序运行时由系统动态加载到内存中供程序调用。</p> 
<p style="margin-left:0;text-align:justify;">由此，动态链接库的优势体现了出来，那就是它相比于静态链接库来说非常节省内存，在程序运行时只需要动态加载一次即可，这也是如今动态链接库被高频使用在大型软件中的原因（用户在更新时只需要更新动态库即可，增量更新）。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">实现工具：Visual Studio 2022</p> 
<h4 style="text-align:justify;">编程实现Dll</h4> 
<p style="text-align:justify;">在此我们编写两个函数，一个函数返回斐波那契数列前n项之和，另一个函数返回输入值的阶乘</p> 
<p style="margin-left:0;text-align:justify;">打开vs创建dll动态链接库新项目，项目名为Dll1</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="574" src="https://images2.imgbox.com/2c/d6/ZvCCaQDP_o.png" width="865"></p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">之后分别添加头文件mydll.h和源文件mydll.cpp</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="596" src="https://images2.imgbox.com/f3/0d/Ydn43NJG_o.png" width="865"></p> 
<p> <img alt="" height="589" src="https://images2.imgbox.com/c5/75/A55f4o2I_o.png" width="865"></p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;">编写头文件：</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="307" src="https://images2.imgbox.com/a0/23/Na0Q7Tzt_o.png" width="865"></p> 
<p> 在编写头文件时，通常都会加第3，4行代码，这是为了防止头文件的重复调用；由于要用C编写函数代码，所以要用exturn “C”声明在链接时使用C库函数规范来链接。在函数定义前面的__declspec(dllexport)用于导出符号，也就是定义该函数的dll；</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">编写源文件：</p> 
<p style="margin-left:0;text-align:justify;">编写实现输出斐波那契数列前N项和的函数Fibonacci_Sum（）</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="456" src="https://images2.imgbox.com/0e/16/L6zWkHFV_o.png" width="865"></p> 
<p> （注意在文件头要加上刚才编写好的头文件，这样编写好的函数才能被导出为dll）</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">编写返回输入值阶乘的函数Factorial（）</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="451" src="https://images2.imgbox.com/dd/5f/WorKYHL6_o.png" width="523"></p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;">编写完成，右键项目生成方案：</p> 
<p style="margin-left:0;text-align:justify;"> <img alt="" height="1051" src="https://images2.imgbox.com/bc/a8/ePSUs9bu_o.png" width="588"></p> 
<p><img alt="" height="71" src="https://images2.imgbox.com/e6/f5/YhJzW2yp_o.png" width="753"> </p> 
<p> </p> 
<h4 style="text-align:justify;">编程，调用实现的DLL</h4> 
<p style="margin-left:0;text-align:justify;">添加新项目，选择控制台应用</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="555" src="https://images2.imgbox.com/2a/3a/x8hF6rpT_o.png" width="865"></p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;">由于要调用DLL，所以需要设置此项目的属性：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">首先，由于需要包括mydll.h这个头文件，需要在包含路径中设置：</p> 
<p style="margin-left:0;text-align:justify;"> <img alt="" height="601" src="https://images2.imgbox.com/4d/b0/qidwP3Zg_o.png" width="865"></p> 
<p><img alt="" height="593" src="https://images2.imgbox.com/33/dc/40PVtoOo_o.png" width="655"> </p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">其次，需要引入lib符号文件：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;">在链接器属性一栏中添加符号文件作为依赖项</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="591" src="https://images2.imgbox.com/5a/ce/3aLtUaNe_o.png" width="865"></p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;">然后给符号文件添加搜索路径：</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="445" src="https://images2.imgbox.com/0f/52/BUkMl2eI_o.png" width="865"></p> 
<p><img alt="" height="599" src="https://images2.imgbox.com/fe/ba/nAUnntBP_o.png" width="865"> </p> 
<p> </p> 
<p style="margin-left:0;text-align:justify;">最后，添加源文件编写调用代码调用DLL:</p> 
<p style="margin-left:0;text-align:justify;"><img alt="" height="267" src="https://images2.imgbox.com/f7/6e/8IIb4J7l_o.png" width="865"></p> 
<p> 调用代码分别调用了两个函数，分别输出前5项斐波那契数列之和以及5的阶乘：</p> 
<p><img alt="" height="200" src="https://images2.imgbox.com/a0/b1/Ky2w59QJ_o.png" width="865"></p> 
<p> </p> 
<p>调用成功！</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3a5f0fc8c63bbde6171e6150ecb59ca1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">电信中兴光猫ZXHN F650超管密码获取工具</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a31620ccb45ae8aabc15ed67cf661da4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue拉取项目regenerator-runtime.js报错</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>