<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【模型评估】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【模型评估】" />
<meta property="og:description" content="本文目录 2.1 评估指标的局限性2.1.1 准确率的局限性2.1.2 精确率与召回率的权衡2.1.3 平方根误差的“意外” 2.2 ROC曲线2.2.1 什么是ROC曲线？2.2.2 如何绘制ROC曲线？2.2.3 如何计算AUC?2.2.4 ROC曲线与P-R曲线有什么特点？ 2.3 余弦距离的应用2.3.1 为什么一些场景要使用余弦相似度，而非欧氏距离？2.3.2 余弦距离是否是一个严格定义的距离？ 2.4 A/B测试的陷阱2.4.1 在对模型进行充分评估之后，为什么还需要进行A/B测试？2.4.2 如何进行线上A/B测试2.4.3 如何划分实验组和对照组 2.5 模型评估的方法2.5.1 在模型评估过程中，有哪些主要的验证方法，它们的优缺点是什么？2.5.2 对 n n n个样本进行 n n n次自助采样，当 n → ∞ n\rightarrow\infty n→∞时，有多少数据未被选择过？ 2.6 超参数调优2.7 过拟合与欠拟合 模型的评估主要分为离线评估和在线评估两个阶段。针对分类、排序、回归、序列等不同类型的机器学习问题，评估的指标选择也不同。知道每种评估指标的精确定义、有针对性的选择合适的评估指标、根据指标的反馈来调整模型，是很关键的问题。 2.1 评估指标的局限性 大部分评估指标只能片面的反应模型的一部分性能。如果不能合理的运用评估指标，不仅不能发现模型本身的问题，而且还会得出错误的结论。
2.1.1 准确率的局限性 问题场景：
HULU的奢侈品广告主们希望把广告定向投放给奢侈品用户。HULU通过第三方数据管理平台拿到了一部分奢侈品用户的数据，并且利用该数据进行了模型训练，训练准确率达到了95%，但在实际投放过程中，该模型还是把大部分广告投放给了费奢侈品用户，这是为什么？
在回答这个问题之前，我们先来看一下准确率的定义。准确率是指分类正确的样本数量占总样本数量的比例，即：
a c c u r a c y = n c o r r e c t n t o t a l accuracy=\frac{n_{correct}}{n_{total}} accuracy=ntotal​ncorrect​​" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d36647412d846f7d590b979bdd4f18ce/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-19T17:05:03+08:00" />
<meta property="article:modified_time" content="2022-07-19T17:05:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【模型评估】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>本文目录</h4> 
 <ul><li><ul><li><a href="#21__5" rel="nofollow">2.1 评估指标的局限性</a></li><li><ul><li><a href="#211__9" rel="nofollow">2.1.1 准确率的局限性</a></li><li><a href="#212__26" rel="nofollow">2.1.2 精确率与召回率的权衡</a></li><li><a href="#213__80" rel="nofollow">2.1.3 平方根误差的“意外”</a></li></ul> 
   </li><li><a href="#22_ROC_112" rel="nofollow">2.2 ROC曲线</a></li><li><ul><li><a href="#221_ROC_114" rel="nofollow">2.2.1 什么是ROC曲线？</a></li><li><a href="#222_ROC_129" rel="nofollow">2.2.2 如何绘制ROC曲线？</a></li><li><a href="#223_AUC_139" rel="nofollow">2.2.3 如何计算AUC?</a></li><li><a href="#224_ROCPR_148" rel="nofollow">2.2.4 ROC曲线与P-R曲线有什么特点？</a></li></ul> 
   </li><li><a href="#23__153" rel="nofollow">2.3 余弦距离的应用</a></li><li><ul><li><a href="#231__160" rel="nofollow">2.3.1 为什么一些场景要使用余弦相似度，而非欧氏距离？</a></li><li><a href="#232__180" rel="nofollow">2.3.2 余弦距离是否是一个严格定义的距离？</a></li></ul> 
   </li><li><a href="#24_AB_216" rel="nofollow">2.4 A/B测试的陷阱</a></li><li><ul><li><a href="#241_AB_218" rel="nofollow">2.4.1 在对模型进行充分评估之后，为什么还需要进行A/B测试？</a></li><li><a href="#242_AB_226" rel="nofollow">2.4.2 如何进行线上A/B测试</a></li><li><a href="#243__231" rel="nofollow">2.4.3 如何划分实验组和对照组</a></li></ul> 
   </li><li><a href="#25__247" rel="nofollow">2.5 模型评估的方法</a></li><li><ul><li><a href="#251__251" rel="nofollow">2.5.1 在模型评估过程中，有哪些主要的验证方法，它们的优缺点是什么？</a></li><li><a href="#252_nnnrightarrowinfty_278" rel="nofollow">2.5.2 对<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              n 
             
            
           
             n 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>个样本进行<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              n 
             
            
           
             n 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>次自助采样，当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              n 
             
            
              → 
             
            
              ∞ 
             
            
           
             n\rightarrow\infty 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord">∞</span></span></span></span></span>时，有多少数据未被选择过？</a></li></ul> 
   </li><li><a href="#26__291" rel="nofollow">2.6 超参数调优</a></li><li><a href="#27__319" rel="nofollow">2.7 过拟合与欠拟合</a></li></ul> 
 </li></ul> 
</div> 
<br>    
<strong>模型的评估主要分为离线评估和在线评估两个阶段。针对分类、排序、回归、序列等不同类型的机器学习问题，评估的指标选择也不同。知道每种评估指标的精确定义、有针对性的选择合适的评估指标、根据指标的反馈来调整模型，是很关键的问题。</strong> 
<p></p> 
<h3><a id="21__5"></a>2.1 评估指标的局限性</h3> 
<p>  <strong>大部分评估指标只能片面的反应模型的一部分性能。如果不能合理的运用评估指标，不仅不能发现模型本身的问题，而且还会得出错误的结论。</strong></p> 
<h4><a id="211__9"></a>2.1.1 准确率的局限性</h4> 
<p>问题场景：</p> 
<p>  HULU的奢侈品广告主们希望把广告定向投放给奢侈品用户。HULU通过第三方数据管理平台拿到了一部分奢侈品用户的数据，并且利用该数据进行了模型训练，训练准确率达到了95%，但在实际投放过程中，该模型还是把大部分广告投放给了费奢侈品用户，这是为什么？</p> 
<p>在回答这个问题之前，我们先来看一下准确率的定义。准确率是指分类正确的样本数量占总样本数量的比例，即：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          a 
         
        
          c 
         
        
          c 
         
        
          u 
         
        
          r 
         
        
          a 
         
        
          c 
         
        
          y 
         
        
          = 
         
         
          
          
            n 
           
           
           
             c 
            
           
             o 
            
           
             r 
            
           
             r 
            
           
             e 
            
           
             c 
            
           
             t 
            
           
          
          
          
            n 
           
           
           
             t 
            
           
             o 
            
           
             t 
            
           
             a 
            
           
             l 
            
           
          
         
        
       
         accuracy=\frac{n_{correct}}{n_{total}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">cc</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0359em;">cy</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.9436em; vertical-align: -0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right: 0.0197em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">correc</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.836em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<ul><li> <p>准确率是分类问题中最简单也是最直观的一个指标，但存在明显的缺陷：<mark>当负样本占99%时，即使分类器把所有样本都预测为负样本，也可以获得99%的准确率。因此，当正负样本比例及其不均衡时，占比大的类别往往成为影响准确率最重要的因素。</mark></p> </li><li> <p>因此前面的问题就迎刃而解，奢侈品用户只占全体用户的一小部分，整体准确率高，不代表对奢侈品用户的分类正确率也高。</p> </li><li> <p>为了解决这个问题，可以使用==平均准确率（每个类别下准确率的算术平均）==作为评价指标</p> </li></ul> 
<p>但另一方面，这个问题的造成原因也不一定仅仅是评估指标的问题，也有可能是<mark>模型的过拟合或者欠拟合、测试集和训练集划分不合理、线下评估与线上测试的样本分布存在差异等等。</mark></p> 
<h4><a id="212__26"></a>2.1.2 精确率与召回率的权衡</h4> 
<p>问题场景：</p> 
<p>  HULU提供视频的模糊搜索功能，搜索排序模型返回的Top5精确率非常高，但在实际使用过程中，用户还是经常找不到想要搜索的视频，特别是对于一些冷门的剧集，这是为什么呢？</p> 
<p>同样我们要搞清楚精确率和召回率就要先搞清楚混淆矩阵</p> 
<p>二分类问题的混淆矩阵由 4 个数构成。</p> 
<ul><li> <p>真正例（TP）：算法预测为正例（T），实际上也是正例（P）的个数，即算法预测对了；</p> </li><li> <p>真负例（TN）：算法预测为负例（F），实际上也是负例（N）的个数，即算法预测对了；</p> </li><li> <p>假负例（FN）： 算法预测为负例（F），实际上是正例（P）的个数，即算法预测错了；</p> </li><li> <p>假正例（FP）：算法预测为正例（T），实际上是负例（P）的个数，即算法预测错了。</p> </li></ul> 
<p>混淆矩阵定义如下：</p> 
<table><thead><tr><th align="center"></th><th align="center">预测值：1</th><th align="center">预测值：0</th></tr></thead><tbody><tr><td align="center"><strong>真实值：1</strong></td><td align="center">TP</td><td align="center">FN</td></tr><tr><td align="center"><strong>真实值：0</strong></td><td align="center">FP</td><td align="center">TN</td></tr></tbody></table> 
<ul><li>精确率是指分类正确的正样本个数占分类器判定为正样本的样本个数比例，即：</li></ul> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          p 
         
        
          r 
         
        
          e 
         
        
          c 
         
        
          i 
         
        
          s 
         
        
          i 
         
        
          o 
         
        
          n 
         
        
          = 
         
         
          
          
            T 
           
          
            P 
           
          
          
          
            T 
           
          
            P 
           
          
            + 
           
          
            F 
           
          
            P 
           
          
         
        
       
         precision=\frac{TP}{TP+FP} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">FP</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<ul><li>召回率是指分类正确的样本个数占真正的正样本个数的比例，即：</li></ul> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          r 
         
        
          e 
         
        
          c 
         
        
          a 
         
        
          l 
         
        
          l 
         
        
          = 
         
         
          
          
            T 
           
          
            P 
           
          
          
          
            T 
           
          
            P 
           
          
            + 
           
          
            F 
           
          
            N 
           
          
         
        
       
         recall=\frac{TP}{TP+FN} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">rec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.1297em; vertical-align: -0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">FN</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7693em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>  在排序问题中，通常没有一个直接的阈值把得到的结果判定为正样本或负样本，而是根据TopN返回结果的Precision值和Recall值来衡量模型的性能，即默认TopN返回的结果就是模型判定的正样本，而后计算前N个位置上的精确率Precision@N和召回率Recall@N。</p> 
<p>  Precision和Recall是两个既矛盾又统一的指标，为了提高Precisson值，<mark>模型通常在“更有把握”时才会把样本预测为正样本，但此时往往会因为保守而漏掉很多“没有足够把握”的正样本，导致Recall值降低。</mark></p> 
<ul><li>因此对于这个问题模型返回的Precision@5非常好，也就是说排序模型Top5的返回值质量都是很高的，但在实际中，用户为了寻找冷门视频，<mark>往往会寻找排序中较为靠后的位置的结果</mark>，根据问题描述，用户往往找不到想要的视频，说明模型没有把相关视频都呈现出来给用户，<mark>问题出在召回率上。</mark></li></ul> 
<p>  在实际问题中，我们为了更好地综合衡量这两个指标，往往采用<strong>P-R曲线</strong>。</p> 
<ul><li>P-R曲线的横轴是召回率，纵轴是精确率，对于一个排序模型来说，P-R曲线的每一个点代表在某一阈值下，模型将大于该阈值的结果判定为正样本，反之则为负样本，此时返回结果对应的召回率和精确率。</li><li>整条P-R曲线是通过将阈值从高到低移动而生成的</li><li>其中原点附近代表阈值最高时对应的召回率和精确率</li></ul> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-a0ClrvOx-1658221280435)(D:\Typora\Typora\image\src=http___img.it610.com_image_info8_a41990d3d49c4ea88e2e122486fa0768.png&amp;refer=http___img.it610.webp)]</p> 
<p>  此外，F1-score和ROC曲线也能综合的反映一个排序模型的性能。F1-score是精确率和召回率的调和平均值，他的定义为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          F 
         
        
          1 
         
        
          = 
         
         
          
          
            2 
           
          
            × 
           
          
            p 
           
          
            r 
           
          
            e 
           
          
            c 
           
          
            i 
           
          
            s 
           
          
            i 
           
          
            o 
           
          
            n 
           
          
            × 
           
          
            r 
           
          
            e 
           
          
            c 
           
          
            a 
           
          
            l 
           
          
            l 
           
          
          
          
            p 
           
          
            r 
           
          
            e 
           
          
            c 
           
          
            i 
           
          
            s 
           
          
            i 
           
          
            o 
           
          
            n 
           
          
            + 
           
          
            r 
           
          
            e 
           
          
            c 
           
          
            a 
           
          
            l 
           
          
            l 
           
          
         
        
       
         F1=\frac{2\times precision\times recall}{precision+recall} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">F</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.2519em; vertical-align: -0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">rec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">rec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">ll</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8804em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<p>ROC曲线后面会单独讨论，这里不赘述。</p> 
<h4><a id="213__80"></a>2.1.3 平方根误差的“意外”</h4> 
<p>问题描述：</p> 
<p>  HULU是一家流媒体公司，预测每部美剧的流量趋势对于广告投放、用户增长都十分重要。因此HULU特地构建了一个回归模型来预测某部美剧的流量趋势，但是无论采用哪种回归模型，得到的RMSE指标都非常高。然而事实是，模型在95%的时间区间内的预测误差都小于1%，取得了相当不错的成果，那么RMSE居高不下的原因是什么？、</p> 
<p>RMSE是衡量回归模型最常用的指标之一，其公式为:</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          M 
         
        
          S 
         
        
          E 
         
        
          = 
         
         
          
           
            
            
              ∑ 
             
             
             
               i 
              
             
               = 
              
             
               1 
              
             
            
              n 
             
            
           
             ( 
            
            
            
              y 
             
            
              i 
             
            
           
             − 
            
            
             
             
               y 
              
             
               ^ 
              
             
            
              i 
             
            
            
            
              ) 
             
            
              2 
             
            
           
          
            n 
           
          
         
        
       
         RMSE=\sqrt{\frac{\sum\limits_{i=1}^n(y_i-\hat y_i)^2}{n}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">RMSE</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.6328em; vertical-align: -0.686em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.9468em;"><span class="svg-align" style="top: -5.5928em;"><span class="pstrut" style="height: 5.5928em;"></span><span class="mord" style="padding-left: 1.056em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.7191em;"><span class="" style="top: -2.6654em;"><span class="pstrut" style="height: 3.3514em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.5814em;"><span class="pstrut" style="height: 3.3514em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -4.7191em;"><span class="pstrut" style="height: 3.3514em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3514em;"><span class="" style="top: -2.1223em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop op-symbol small-op">∑</span></span></span><span class="" style="top: -3.95em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9777em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -4.9068em;"><span class="pstrut" style="height: 5.5928em;"></span><span class="hide-tail" style="min-width: 0.742em; height: 3.6728em;"> 
            <svg width="400em" height="3.6728em" viewbox="0 0 400000 3672" preserveaspectratio="xMinYMin slice"> 
             <path d="M702 80H40000040
H742v3538l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 80H400000v40H742z"></path> 
            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
<ul><li> <p>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
          
            y 
           
          
            i 
           
          
         
        
          y_i 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为底<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           i 
          
         
        
          i 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>个样本的真实值，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             y 
            
           
             ^ 
            
           
          
            i 
           
          
         
        
          \hat y_i 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>是第<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           i 
          
         
        
          i 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>个样本的预测值，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           n 
          
         
        
          n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>是样本个数</p> </li><li> <p>一般情况下RMSE都能正确反映回归模型预测值与真实值之间的偏离程度，<mark>但如果存在个别偏离程度非常大的离群点时，即使离群点的数量非常少，也会让RMSE变得很差。</mark></p> </li><li> <p>那么这个问题很有可能就是由于离群点的存在而造成的，那么我们该如何处理呢？</p> 
  <ul><li> <p>首先我们可以在数据预处理的阶段就将这些噪声点过滤掉。</p> </li><li> <p>如果不过滤，需要提高模型的预测能力，将离群点产生的机制建模进去。</p> </li><li> <p>第三，采用其他指标，比如平均绝对百分比误差(MAPE)，它定义为：</p> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              M 
             
            
              A 
             
            
              P 
             
            
              E 
             
            
              = 
             
             
             
               ∑ 
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
             
               n 
              
             
            
              ∣ 
             
             
              
               
               
                 y 
                
               
                 i 
                
               
              
                − 
               
               
                
                
                  y 
                 
                
                  ^ 
                 
                
               
                 i 
                
               
              
              
              
                y 
               
              
                i 
               
              
             
            
              ∣ 
             
            
              × 
             
             
             
               100 
              
             
               n 
              
             
            
           
             MAPE=\sum\limits_{i=1}^n|\frac{y_i-\hat y_i}{y_i}|\times\frac{100}{n} 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.109em;">M</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.0576em;">PE</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.9291em; vertical-align: -1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1944em;"><span class=""></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.8804em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">100</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> <p>相比较于RMSE，<mark>他将每个点的误差进行了归一化</mark>，降低了离群点带来的影响</p> </li></ul> </li></ul> 
<p><strong>总结：每个评估指标都有其价值，但如果只从单一的评估指标出发去评估模型，往往会得出片面甚至于错误的结论。只有通过一组互补的指标去评估模型，才能更好地发现并解决问题。</strong></p> 
<h3><a id="22_ROC_112"></a>2.2 ROC曲线</h3> 
<h4><a id="221_ROC_114"></a>2.2.1 什么是ROC曲线？</h4> 
<p>  二值分类器是最常见也是应用最广泛的分类器。它的评价指标有很多，前面有介绍，但这些指标或多或少只能反应模型在某一方面的性能。相比而言，ROC曲线则有很多优点，是二分类器最重要的指标之一。</p> 
<p><strong>ROC曲线是Receiver Operating Characteristic Curve的简称，直译为“受试者工作特征曲线”</strong>。</p> 
<ul><li> <p>ROC曲线的横坐标为假阳性率（FPR）；纵坐标为真阳性率（TPR）：</p> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            F 
           
          
            P 
           
          
            R 
           
          
            = 
           
           
            
            
              F 
             
            
              P 
             
            
           
             N 
            
           
          
            , 
           
          
            T 
           
          
            P 
           
          
            R 
           
          
            = 
           
           
            
            
              T 
             
            
              P 
             
            
           
             P 
            
           
          
         
           FPR=\frac{FP}{N},TPR=\frac{TP}{P} 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">FPR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0463em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.109em;">N</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">FP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">TPR</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.0463em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1389em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
  <ul><li>其中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            P 
           
          
         
           P 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span></span></span></span></span>是真实正样本的数量</li><li>N是真实负样本的数量</li><li>TP是正样本中被预测为正的个数</li><li>FP为负样本中被预测为正的个数</li></ul> </li></ul> 
<h4><a id="222_ROC_129"></a>2.2.2 如何绘制ROC曲线？</h4> 
<p>  <strong>ROC曲线是通过不断移动分类器的截断点来生成曲线上一个点的，在二分类问题中，模型的输出一般都是预测样本为正例的概率，因此我们就可以通过不断调整阈值，根据概率与阈值的大小关系来对样本进行分类，从而计算FPR和TPR，进而画出ROC曲线。</strong></p> 
<ul><li> <p>与P-R曲线类似，这个阈值也是从1到0不断调整来进行曲线的绘制</p> </li><li> <p>起始于(0,0)点，结束于(1,1)点</p> </li></ul> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-FY8hQyRm-1658221280436)(D:\Typora\Typora\image\src=http___pic4.zhimg.com_v2-67bcf812f2a74c36f7a60087534c4c13_b.jpg&amp;refer=http___pic4.zhimg.webp)]</p> 
<h4><a id="223_AUC_139"></a>2.2.3 如何计算AUC?</h4> 
<p>  <strong>AUC(Area Under Curve)，即为曲线下的面积</strong></p> 
<ul><li>该值能够量化的反映基于ROC曲线衡量出的模型性能</li><li>计算AUC只需要对ROC曲线沿着横轴做积分即可</li><li>一般ROC曲线都位于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          x 
         
        
       
         y=x 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>这条直线的上方，如果不是，将模型的预测概率翻转成<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          1 
         
        
          − 
         
        
          p 
         
        
       
         1-p 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></span>即可得到一个更好的模型</li><li>因此AUC的取值一般在<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          0.5 
         
        
          ∼ 
         
        
          1 
         
        
       
         0.5\sim1 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.5</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>之间。<mark>AUC越大，说明分类器越可能把真正的正样本排在前面，分类器性能越好</mark></li></ul> 
<h4><a id="224_ROCPR_148"></a>2.2.4 ROC曲线与P-R曲线有什么特点？</h4> 
<ul><li>相比于P-R曲线，ROC曲线的一个显著特征就是当正负样本的分布发生变化时，ROC曲线的形状基本保持不变，而P-R曲线的形状变化较为剧烈</li><li>因此ROC曲线可以降低不同的测试集带来的干扰。更加客观地衡量模型本身的性能</li></ul> 
<h3><a id="23__153"></a>2.3 余弦距离的应用</h3> 
<p>  在机器学习中，通常将特征表示为向量的形式，所以在分析两个向量的相似性时通常用余弦相似度来表示。</p> 
<ul><li>余弦相似度的取值范围为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          [ 
         
        
          − 
         
        
          1 
         
        
          , 
         
        
          1 
         
        
          ] 
         
        
       
         [-1,1] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>，相同的两个向量之间的相似度为1</li><li>如果想要得到类似于距离的表示，将1减去余弦相似度即为余弦距离。因此余弦距离的取值范围为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          [ 
         
        
          0 
         
        
          , 
         
        
          2 
         
        
          ] 
         
        
       
         [0,2] 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span>，相同的两个向量余弦距离为0</li></ul> 
<h4><a id="231__160"></a>2.3.1 为什么一些场景要使用余弦相似度，而非欧氏距离？</h4> 
<p>  对于两个向量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         A 
        
       
      
        A 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         B 
        
       
      
        B 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span>，其余弦相似度定义为：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          o 
         
        
          s 
         
        
          ( 
         
        
          A 
         
        
          , 
         
        
          B 
         
        
          ) 
         
        
          = 
         
         
          
          
            A 
           
          
            ⋅ 
           
          
            B 
           
          
          
          
            ∣ 
           
          
            ∣ 
           
          
            A 
           
          
            ∣ 
           
           
           
             ∣ 
            
           
             2 
            
           
          
            ∣ 
           
          
            ∣ 
           
          
            B 
           
          
            ∣ 
           
           
           
             ∣ 
            
           
             2 
            
           
          
         
        
       
         cos(A,B)=\frac{A\cdot B}{||A||_2||B||_2} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.2963em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<ul><li> <p>即两个向量夹角的余弦</p> </li><li> <p><mark>其所关注的是两个向量之间的角度关系，并不关注绝对大小</mark></p> </li></ul> 
<p>  假设我们现在做的是文本相似度分析，当两个文本的内容相似，但是长度距离很大时，如果使用词频或词向量作为特征，<mark>他们在特征空间中的欧氏距离往往很大</mark>，但如果是用余弦相似度分析，他们的夹角可能很小，因而相似度高。</p> 
<p>  此外在文本、视频、图像等领域，研究对象的维度往往很高，而余弦相似度仍能保持“相同为1，正交为0，相反为-1”的特点，而欧氏距离则受维度的影响，范围不固定，含义也较为模糊。</p> 
<p>  <mark>总体来看，欧氏距离体现的是数值上的绝对差异，而余弦距离体现的是方向上的绝对差异，至于选择什么距离作为衡量标准要根据实际需求灵活选择。</mark></p> 
<h4><a id="232__180"></a>2.3.2 余弦距离是否是一个严格定义的距离？</h4> 
<p>首先我们来看距离的定义：</p> 
<ul><li> <p>在一个集合中，如果每一对元素均可唯一确定一个实数，使得三条距离公理（正定型，对称性，三角不等式）成立，则该实数可以称为这对元素之间的距离。</p> </li><li> <p>==余弦距离满足正定性和对称性，但是不满足三角不等式，因此不是严格定义的距离。==下面给出证明：</p> 
  <ul><li> <p>正定性：根据余弦距离的定义，有</p> <p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
          
           
            
            
              d 
             
            
              i 
             
            
              s 
             
            
              t 
             
            
              ( 
             
            
              A 
             
            
              , 
             
            
              B 
             
            
              ) 
             
            
              = 
             
            
              1 
             
            
              − 
             
            
              cos 
             
            
              ⁡ 
             
            
              θ 
             
            
              = 
             
             
              
              
                ∣ 
               
              
                ∣ 
               
              
                A 
               
              
                ∣ 
               
               
               
                 ∣ 
                
               
                 2 
                
               
              
                ∣ 
               
              
                ∣ 
               
              
                B 
               
              
                ∣ 
               
               
               
                 ∣ 
                
               
                 2 
                
               
              
                − 
               
              
                A 
               
              
                B 
               
              
              
              
                ∣ 
               
              
                ∣ 
               
              
                A 
               
              
                ∣ 
               
               
               
                 ∣ 
                
               
                 2 
                
               
              
                ∣ 
               
              
                ∣ 
               
              
                B 
               
              
                ∣ 
               
               
               
                 ∣ 
                
               
                 2 
                
               
              
             
            
           
             dist(A,B)=1-\cos\theta=\frac{||A||_2||B||_2-AB}{||A||_2||B||_2} 
            
           
         </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.363em; vertical-align: -0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.936em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> <p>因为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             1 
            
           
             − 
            
           
             cos 
            
           
             ⁡ 
            
           
             θ 
            
           
             ≥ 
            
           
             0 
            
           
          
            1-\cos\theta\ge0 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8304em; vertical-align: -0.136em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>，因此有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             s 
            
           
             i 
            
           
             t 
            
           
             ( 
            
           
             A 
            
           
             , 
            
           
             B 
            
           
             ) 
            
           
             ≥ 
            
           
             0 
            
           
          
            dsit(A,B)\ge0 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>恒成立</p> <p>特别地，当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             = 
            
           
             0 
            
           
          
            dist=0 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>时，有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             ∣ 
            
           
             ∣ 
            
           
             A 
            
           
             ∣ 
            
            
            
              ∣ 
             
            
              2 
             
            
           
             ∣ 
            
           
             ∣ 
            
           
             B 
            
           
             ∣ 
            
            
            
              ∣ 
             
            
              2 
             
            
           
             = 
            
           
             A 
            
           
             B 
            
           
          
            ||A||_2||B||_2=AB 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣∣</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span>，因此可以得到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             A 
            
           
             = 
            
           
             B 
            
           
          
            A=B 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span></p> <p>因此余弦距离满足正定性</p> </li><li> <p>对称性：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             A 
            
           
             , 
            
           
             B 
            
           
             ) 
            
           
             = 
            
            
             
             
               ∣ 
              
             
               ∣ 
              
             
               A 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
               ∣ 
              
             
               ∣ 
              
             
               B 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
               − 
              
             
               A 
              
             
               B 
              
             
             
             
               ∣ 
              
             
               ∣ 
              
             
               A 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
               ∣ 
              
             
               ∣ 
              
             
               B 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
            
           
             = 
            
            
             
             
               ∣ 
              
             
               ∣ 
              
             
               B 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
               ∣ 
              
             
               ∣ 
              
             
               A 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
               − 
              
             
               A 
              
             
               B 
              
             
             
             
               ∣ 
              
             
               ∣ 
              
             
               B 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
               ∣ 
              
             
               ∣ 
              
             
               A 
              
             
               ∣ 
              
              
              
                ∣ 
               
              
                2 
               
              
             
            
           
          
            dist(A,B)=\frac{||A||_2||B||_2-AB}{||A||_2||B||_2}=\frac{||B||_2||A||_2-AB}{||B||_2||A||_2} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.53em; vertical-align: -0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight">A</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right: 0.0502em;">B</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight">A</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right: 0.0502em;">B</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right: 0.0502em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.53em; vertical-align: -0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right: 0.0502em;">B</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight">A</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight" style="margin-right: 0.0502em;">B</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight">∣∣</span><span class="mord mathnormal mtight">A</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right: 0.0502em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.52em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p>因此余弦距离满足对称性</p> </li><li> <p>三角不等式：通过反例证明</p> <p>给定<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             A 
            
           
             = 
            
           
             ( 
            
           
             1 
            
           
             , 
            
           
             0 
            
           
             ) 
            
           
             , 
            
           
             B 
            
           
             = 
            
           
             ( 
            
           
             1 
            
           
             , 
            
           
             1 
            
           
             ) 
            
           
             , 
            
           
             C 
            
           
             = 
            
           
             ( 
            
           
             0 
            
           
             , 
            
           
             1 
            
           
             ) 
            
           
          
            A=(1,0),B=(1,1),C=(0,1) 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             A 
            
           
             , 
            
           
             B 
            
           
             ) 
            
           
             = 
            
           
             1 
            
           
             − 
            
            
             
             
               2 
              
             
            
              2 
             
            
           
          
            dist(A,B)=1-\frac{\sqrt{2}}{2} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.383em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.038em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.399em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9128em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mtight" style="padding-left: 0.833em;"><span class="mord mtight">2</span></span></span><span class="" style="top: -2.8728em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail mtight" style="min-width: 0.853em; height: 1.08em;"> 
                       <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                        <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1272em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             B 
            
           
             , 
            
           
             C 
            
           
             ) 
            
           
             = 
            
           
             1 
            
           
             − 
            
            
             
             
               2 
              
             
            
              2 
             
            
           
          
            dist(B,C)=1-\frac{\sqrt{2}}{2} 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.383em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.038em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.399em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9128em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mtight" style="padding-left: 0.833em;"><span class="mord mtight">2</span></span></span><span class="" style="top: -2.8728em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail mtight" style="min-width: 0.853em; height: 1.08em;"> 
                       <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                        <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
                       </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1272em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             A 
            
           
             , 
            
           
             C 
            
           
             ) 
            
           
             = 
            
           
             1 
            
           
          
            dist(A,C)=1 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span></p> <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
         
          
           
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             A 
            
           
             , 
            
           
             B 
            
           
             ) 
            
           
             + 
            
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             B 
            
           
             , 
            
           
             C 
            
           
             ) 
            
           
             = 
            
           
             2 
            
           
             − 
            
            
            
              2 
             
            
           
             &lt; 
            
           
             1 
            
           
             = 
            
           
             d 
            
           
             i 
            
           
             s 
            
           
             t 
            
           
             ( 
            
           
             A 
            
           
             , 
            
           
             C 
            
           
             ) 
            
           
          
            dist(A,B)+dist(B,C)=2-\sqrt{2}&lt;1=dist(A,C) 
           
          
        </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.04em; vertical-align: -0.1328em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9072em;"><span class="svg-align" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord" style="padding-left: 0.833em;"><span class="mord">2</span></span></span><span class="" style="top: -2.8672em;"><span class="pstrut" style="height: 3em;"></span><span class="hide-tail" style="min-width: 0.853em; height: 1.08em;"> 
               <svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"> 
                <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path> 
               </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.1328em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mclose">)</span></span></span></span></span></p> <p>因此余弦距离不满足三角不等式</p> </li></ul> </li></ul> 
<h3><a id="24_AB_216"></a>2.4 A/B测试的陷阱</h3> 
<h4><a id="241_AB_218"></a>2.4.1 在对模型进行充分评估之后，为什么还需要进行A/B测试？</h4> 
<p>原因如下：</p> 
<ul><li>离线评估无法完全消除模型的过拟合所带来的影响，因此离线评估的结果无法完全替代线上评估效果</li><li>离线评估无法完全还原线上的工程环境。<mark>线上环境的延迟、数据丢失、标签丢失等特殊情况有可能会发生</mark></li><li>线上系统的某些商业指标在离线评估中无法计算</li></ul> 
<h4><a id="242_AB_226"></a>2.4.2 如何进行线上A/B测试</h4> 
<ul><li>进行A/B测试的主要手段是进行用户分桶，即将用户分成实验组和对照组，对实验组的用户施以新模型，对对照组的用户施以旧模型。</li><li>在分桶的过程中要注意样本的独立性和采样方式的无偏性，确保同一用户每次只能分到同一个桶中</li></ul> 
<h4><a id="243__231"></a>2.4.3 如何划分实验组和对照组</h4> 
<p>  HULU的算法工程师针对系统中的“美国用户”新开发了一套推荐系统A，旧的推荐模型为B，现在要进行线上A/B测试，下面三种划分方法哪种正确？</p> 
<ul><li>（1）根据user_id（user_id完全随机生成）个位数的奇偶性来划分</li><li>（2）将user_id为奇数且为美国用户的作为实验组，其余为对照组</li><li>（3）将user_id为奇数且为美国用户的作为实验组，其余中user_id为奇数的作为对照组</li></ul> 
<p><strong>答案是都错误</strong></p> 
<p><img src="https://images2.imgbox.com/07/51/ptqx81Cf_o.png" alt="在这里插入图片描述"></p> 
<p>因为新模型是针对美国用户开发的，因此实验组和对照组应该都是针对美国用户而言的，如图四所示</p> 
<h3><a id="25__247"></a>2.5 模型评估的方法</h3> 
<p>  在机器学习的过程中，我们通常把样本分为训练集和测试集，训练集用于训练模型，测试集用于评估模型。在样本划分和模型验证的过程中，存在着不同的抽样方法和验证方法，我们应该如何进行选择？</p> 
<h4><a id="251__251"></a>2.5.1 在模型评估过程中，有哪些主要的验证方法，它们的优缺点是什么？</h4> 
<p>① Holdout检验</p> 
<ul><li>Holdout检验是最简单也是最直接的验证方法，即将原始数据随机划分成训练集和验证集两部分</li><li>用训练集去训练模型，用检验集来测试模型</li><li>但其缺点也很明显，<mark>验证集的评估指标与原始分组有很大关系</mark>，为了消除随机性，引入了交叉验证</li></ul> 
<p>② 交叉验证</p> 
<ul><li><strong>K-fold交叉验证</strong> 
  <ul><li>将样本划分成大小相等的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            k 
           
          
         
           k 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>份</li><li>第一次留出第一份做为验证集，其余作为训练集，第二次留出第二份作为训练集…一共进行<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            k 
           
          
         
           k 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>次训练</li><li>最后取这<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            k 
           
          
         
           k 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span>次实验评估指标的平均值作为最终的评估指标</li></ul> </li><li><strong>留一验证</strong> 
  <ul><li>留一验证与<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            k 
           
          
            − 
           
          
            f 
           
          
            o 
           
          
            l 
           
          
            d 
           
          
         
           k-fold 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span><span class="mord mathnormal">d</span></span></span></span></span>验证过程相似，只不过每次只留下一个样本</li><li>在实际中往往不进行使用，因为样本数量较多时开销极大</li></ul> </li></ul> 
<p>③ 自助法</p> 
<ul><li>前面两种验证方式都要把原始样本划分成训练集和验证集</li><li>但是如果原始样本较少，再进行划分会使得训练样本不足，影响训练效果</li><li>自助法是基于自助采样法的检验方法。</li><li>对于样本数量为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
       
         n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>的样本集，进行<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
       
         n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>次有放回的随机采样，得到大小为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          n 
         
        
       
         n 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>的训练集</li><li>由于是有放回的采样，总有样本会重复采样，有些样本没被采样</li><li><mark>使用没被采样过的样本做为验证集进行验证</mark></li></ul> 
<h4><a id="252_nnnrightarrowinfty_278"></a>2.5.2 对<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>个样本进行<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
      
        n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>次自助采样，当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         n 
        
       
         → 
        
       
         ∞ 
        
       
      
        n\rightarrow\infty 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord">∞</span></span></span></span></span>时，有多少数据未被选择过？</h4> 
<ul><li> <p>一个样本在一次抽样过程中未被抽中的概率为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
         
           1 
          
         
           − 
          
          
          
            1 
           
          
            n 
           
          
         
           ) 
          
         
        
          (1-\frac1n) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1901em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           n 
          
         
        
          n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>次抽样均未抽中的概率为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           ( 
          
         
           1 
          
         
           − 
          
          
          
            1 
           
          
            n 
           
          
          
          
            ) 
           
          
            n 
           
          
         
        
          (1-\frac1n)^n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1901em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p> </li><li> <p>当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           n 
          
         
           → 
          
         
           ∞ 
          
         
        
          n\rightarrow\infty 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord">∞</span></span></span></span></span>时，概率为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             lim 
            
           
             ⁡ 
            
           
           
           
             n 
            
           
             → 
            
           
             ∞ 
            
           
          
         
           ( 
          
         
           1 
          
         
           − 
          
          
          
            1 
           
          
            n 
           
          
          
          
            ) 
           
          
            n 
           
          
         
        
          \lim\limits_{n\rightarrow\infty}(1-\frac1n)^n 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.45em; vertical-align: -0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1901em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p> </li><li> <p>根据重要极限<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             lim 
            
           
             ⁡ 
            
           
           
           
             n 
            
           
             → 
            
           
             ∞ 
            
           
          
         
           ( 
          
         
           1 
          
         
           + 
          
          
          
            1 
           
          
            n 
           
          
          
          
            ) 
           
          
            n 
           
          
         
           = 
          
         
           e 
          
         
        
          \lim\limits_{n\rightarrow\infty}(1+\frac1n)^n=e 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.45em; vertical-align: -0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.1901em; vertical-align: -0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.6644em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span></span></p> </li></ul> 
<p>  <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
           
            
             
              
              
                lim 
               
              
                ⁡ 
               
              
              
              
                n 
               
              
                → 
               
              
                ∞ 
               
              
             
            
              ( 
             
            
              1 
             
            
              − 
             
             
             
               1 
              
             
               n 
              
             
             
             
               ) 
              
             
               n 
              
             
            
           
          
          
           
            
             
            
              = 
             
             
              
              
                lim 
               
              
                ⁡ 
               
              
              
              
                n 
               
              
                → 
               
              
                ∞ 
               
              
             
             
             
               1 
              
              
              
                ( 
               
              
                1 
               
              
                + 
               
               
               
                 1 
                
                
                
                  n 
                 
                
                  − 
                 
                
                  1 
                 
                
               
               
               
                 ) 
                
               
                 n 
                
               
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              = 
             
             
              
              
                lim 
               
              
                ⁡ 
               
              
              
              
                n 
               
              
                → 
               
              
                ∞ 
               
              
             
             
             
               1 
              
              
              
                ( 
               
              
                1 
               
              
                + 
               
               
               
                 1 
                
                
                
                  n 
                 
                
                  − 
                 
                
                  1 
                 
                
               
               
               
                 ) 
                
                
                
                  n 
                 
                
                  − 
                 
                
                  1 
                 
                
               
              
             
             
              
              
                lim 
               
              
                ⁡ 
               
              
              
              
                n 
               
              
                → 
               
              
                ∞ 
               
              
             
             
             
               1 
              
              
              
                ( 
               
              
                1 
               
              
                + 
               
               
               
                 1 
                
                
                
                  n 
                 
                
                  − 
                 
                
                  1 
                 
                
               
              
                ) 
               
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              = 
             
             
             
               1 
              
             
               e 
              
             
            
           
          
         
         
          
           
            
           
          
          
           
            
             
            
              ≈ 
             
            
              0.368 
             
            
           
          
         
        
       
         \begin{aligned}\lim\limits_{n\rightarrow\infty}(1-\frac1n)^n&amp;=\lim\limits_{n\rightarrow\infty}\frac{1}{(1+\frac{1}{n-1})^n}\\&amp;=\lim\limits_{n\rightarrow\infty}\frac{1}{(1+\frac{1}{n-1})^{n-1}}\lim\limits_{n\rightarrow\infty}\frac{1}{(1+\frac{1}{n-1})}\\&amp;=\frac1e\\&amp;\approx0.368\end{aligned} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 9.3272em; vertical-align: -4.4136em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.9136em;"><span class="" style="top: -6.9136em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7144em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.1537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: -1.3938em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span><span class="" style="top: 0.4322em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.4136em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.9136em;"><span class="" style="top: -6.9136em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4033em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.5904em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.1384em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -4.1537em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4033em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.1384em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.6944em;"><span class="" style="top: -2.4em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.2649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8451em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4033em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.1384em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -1.3938em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: 0.4322em;"><span class="pstrut" style="height: 3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mord">0.368</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.4136em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<ul><li><mark>因此当样本数量很大时，大约有<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           36.8 
          
         
        
          36.8% 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">36.8</span></span></span></span></span>的数据从未被选择过</mark></li></ul> 
<h3><a id="26__291"></a>2.6 超参数调优</h3> 
<p>  为了进行超参数调优，我们一般会采用网格搜索、随机匹配、贝叶斯优化等算法，下面一一介绍：</p> 
<p>① 网格搜索</p> 
<ul><li> <p>网格搜索是最简单、应用最广的超参数搜索算法，他通过查找搜索范围内的所有的点来确定最优值</p> </li><li> <p>如果采用较大的搜索范围和较小的步长，网格搜索有很大概率可以找到全局最优值，但是这种搜索方式十分耗费资源和时间</p> </li><li> <p>在实际应用中，<mark>往往一开始采用较大的步长和较广的搜索范围，来寻找全局最优解可能的位置，然后逐渐缩小步长和搜索范围</mark></p> </li><li> <p><mark>但一般目标函数是非凸的，很有可能错过全局最优解</mark></p> </li></ul> 
<p>② 随机搜索</p> 
<ul><li>随机搜索和网格搜索的思想很像，只不过不再测试上界和下界之间的所有值，而是随机选取样本点。</li><li>他的理论依据是如果样本点集足够大，那么通过随机采样也能大概率找到最优值或近似值</li><li>但同样不能保证结果</li></ul> 
<p>③ 贝叶斯优化算法</p> 
<ul><li>贝叶斯优化算法在寻找最优值参数时，采用的方法与前两种方法完全不同，他不会忽略前一个搜索点的信息，他通过对目标函数形状进行学习，找到使目标函数向全局最优值提升的参数</li><li>首先根据先验分布，假设一个搜集函数</li><li>然后每一次使用新的采样点来测试目标函数时，利用这个信息来更新目标函数的先验分布</li><li>最后，算法测试由后验分布给出的全局最优值可能出现的位置</li><li><mark>使用贝叶斯优化算法，一旦找到了一个局部最优解，很容易不断采样从而陷入局部最优解</mark></li></ul> 
<h3><a id="27__319"></a>2.7 过拟合与欠拟合</h3> 
<p><img src="https://images2.imgbox.com/03/f5/vJwpyMQK_o.jpg" alt="在这里插入图片描述"></p> 
<p>① 降低过拟合风险的方法</p> 
<ul><li><strong>获取更多的训练数据</strong></li><li><strong>降低模型复杂度</strong></li><li><strong>加入正则项</strong></li><li><strong>采用集成学习方法</strong></li></ul> 
<p>② 降低过欠合风险的方法</p> 
<ul><li>添加新特征</li><li>增加模型的复杂度</li><li>减小正则化系数</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8713e757f55f99ff950b5446f4c834d0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pytorch训练过程中释放显存</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/52895e30e8dd56af3b992f59f9d3d151/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringCloudAlibaba 2021.0.1.0 版本整合分布式事务Seata</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>