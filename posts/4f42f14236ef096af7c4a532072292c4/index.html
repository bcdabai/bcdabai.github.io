<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python基础教程——用Python处理Excel！ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python基础教程——用Python处理Excel！" />
<meta property="og:description" content="Excel是一种常见的电子表格文件格式，广泛用于数据记录和处理。Python提供了多个第三方库，可以方便地对Excel文件进行读写、数据操作和处理。本文将介绍如何使用Python对Excel文件进行处理，并提供相应的代码示例和详细说明。
一、安装第三方库 在开始之前，我们需要安装一些Python第三方库，用于对Excel文件进行处理。以下是常用的库：
pandas：用于数据分析和处理，支持读写Excel文件。
openpyxl：用于读写Excel文件。
xlrd：用于读取Excel文件。
xlwt：用于写入Excel文件。
可以使用pip命令进行安装：
pip install pandas openpyxl xlrd xlwt 安装完成后，我们可以开始使用这些库来处理Excel文件。
二、读取Excel文件 首先，我们需要导入相应的库。使用以下代码导入pandas和openpyxl：
import pandas as pd import openpyxl 2.1读取Excel文件到DataFrame 使用pandas库可以将Excel文件读取到DataFrame对象中，方便进行数据分析和处理。以下是一个示例代码：
# 读取Excel文件 data = pd.read_excel(&#34;data.xlsx&#34;) # 打印DataFrame print(data) 这段代码将data.xlsx文件读取到data变量中，并将其打印输出。你可以根据实际文件名和路径进行修改。
2.2读取指定Sheet的Excel文件 如果Excel文件中包含多个Sheet，你可以通过指定Sheet名称或索引来读取指定的Sheet。以下是一个示例代码：
# 读取指定Sheet的Excel文件 data = pd.read_excel(&#34;data.xlsx&#34;, sheet_name=&#34;Sheet1&#34;) # 打印DataFrame print(data) 这段代码将data.xlsx文件中名为&#34;Sheet1&#34;的Sheet读取到data变量中，并将其打印输出。你可以根据实际情况修改Sheet的名称或使用Sheet的索引。
三、写入Excel文件 除了读取Excel文件，我们还可以使用Python将数据写入Excel文件。以下是一个示例代码：
# 创建数据 data = { &#39;Name&#39;: [&#39;Alice&#39;, &#39;Bob&#39;, &#39;Charlie&#39;], &#39;Age&#39;: [25, 30, 35], &#39;City&#39;: [&#39;New York&#39;, &#39;London&#39;, &#39;Paris&#39;] } # 创建DataFrame df = pd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4f42f14236ef096af7c4a532072292c4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-10T17:38:19+08:00" />
<meta property="article:modified_time" content="2024-01-10T17:38:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python基础教程——用Python处理Excel！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>Excel是一种常见的电子表格文件格式，广泛用于数据记录和处理。Python提供了多个第三方库，可以方便地对Excel文件进行读写、数据操作和处理。本文将介绍如何使用Python对Excel文件进行处理，并提供相应的代码示例和详细说明。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1a/d8/yZnv4IB5_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="_5"></a>一、安装第三方库</h3> 
<p>在开始之前，我们需要安装一些Python第三方库，用于对Excel文件进行处理。以下是常用的库：</p> 
<ul><li> <p>pandas：用于数据分析和处理，支持读写Excel文件。</p> </li><li> <p>openpyxl：用于读写Excel文件。</p> </li><li> <p>xlrd：用于读取Excel文件。</p> </li><li> <p>xlwt：用于写入Excel文件。</p> </li></ul> 
<p>可以使用pip命令进行安装：</p> 
<pre><code class="prism language-python">    pip install pandas openpyxl xlrd xlwt    
</code></pre> 
<p>安装完成后，我们可以开始使用这些库来处理Excel文件。</p> 
<h3><a id="Excel_27"></a>二、读取Excel文件</h3> 
<p>首先，我们需要导入相应的库。使用以下代码导入pandas和openpyxl：</p> 
<pre><code class="prism language-python">    <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd   <span class="token keyword">import</span> openpyxl    
</code></pre> 
<h4><a id="21ExcelDataFrame_36"></a>2.1读取Excel文件到DataFrame</h4> 
<p>使用pandas库可以将Excel文件读取到DataFrame对象中，方便进行数据分析和处理。以下是一个示例代码：</p> 
<pre><code class="prism language-python">    <span class="token comment"># 读取Excel文件   </span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 打印DataFrame   print(data)    </span>
</code></pre> 
<p>这段代码将data.xlsx文件读取到data变量中，并将其打印输出。你可以根据实际文件名和路径进行修改。</p> 
<h4><a id="22SheetExcel_48"></a>2.2读取指定Sheet的Excel文件</h4> 
<p>如果Excel文件中包含多个Sheet，你可以通过指定Sheet名称或索引来读取指定的Sheet。以下是一个示例代码：</p> 
<pre><code class="prism language-python">    <span class="token comment"># 读取指定Sheet的Excel文件   </span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 打印DataFrame   print(data)    </span>
</code></pre> 
<p>这段代码将data.xlsx文件中名为"Sheet1"的Sheet读取到data变量中，并将其打印输出。你可以根据实际情况修改Sheet的名称或使用Sheet的索引。</p> 
<h3><a id="Excel_60"></a>三、写入Excel文件</h3> 
<p>除了读取Excel文件，我们还可以使用Python将数据写入Excel文件。以下是一个示例代码：</p> 
<pre><code class="prism language-python">    <span class="token comment"># 创建数据   </span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>       
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       
    <span class="token string">'City'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Paris'</span><span class="token punctuation">]</span>   
    <span class="token punctuation">}</span>      
    <span class="token comment"># 创建DataFrame   </span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>      
    <span class="token comment"># 写入Excel文件   df.to_excel("output.xlsx", index=False)    </span>
</code></pre> 
<p>这段代码首先创建了一个包含姓名、年龄和城市的数据字典。然后，通过pd.DataFrame()创建DataFrame对象df。最后，使用to_excel()方法将DataFrame写入到output.xlsx文件中。index=False表示不将索引写入文件。</p> 
<h3><a id="Excel_79"></a>四、修改Excel文件</h3> 
<p>除了读取和写入，我们还可以使用Python修改Excel文件中的数据、添加新的Sheet等。以下是一个示例代码：</p> 
<pre><code class="prism language-python">    <span class="token comment"># 打开Excel文件   </span>
    wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 获取指定Sheet   </span>
    sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">"Sheet1"</span><span class="token punctuation">]</span>      
    <span class="token comment"># 修改单元格数据   </span>
    sheet<span class="token punctuation">[</span><span class="token string">"A1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Updated Value"</span>      
    <span class="token comment"># 添加新的Sheet   </span>
    new_sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">"Sheet2"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 保存修改后的Excel文件   </span>
    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"data_modified.xlsx"</span><span class="token punctuation">)</span>    
</code></pre> 
<p>这段代码首先使用openpyxl.load_workbook()方法打开data.xlsx文件，返回一个Workbook对象wb。然后，通过指定Sheet的名称或索引获取指定的Sheet，这里我们获取名为"Sheet1"的Sheet。接下来，我们可以修改Sheet中的单元格数据，例如将"A1"单元格的值修改为"Updated Value"。然后，使用create_sheet()方法添加一个新的Sheet，这里我们创建名为"Sheet2"的Sheet。最后，使用wb.save()方法保存修改后的Excel文件。</p> 
<h3><a id="_99"></a>五、完整代码示例</h3> 
<pre><code class="prism language-python">    <span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd   
    <span class="token keyword">import</span> openpyxl      
    <span class="token comment"># 读取Excel文件   </span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 打印DataFrame   </span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>      
    <span class="token comment"># 创建数据   </span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>       
    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Charlie'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       
    <span class="token string">'City'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Paris'</span><span class="token punctuation">]</span>   
    <span class="token punctuation">}</span>      
    <span class="token comment"># 创建DataFrame   </span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>      
    <span class="token comment"># 写入Excel文件   </span>
    df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">"output.xlsx"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>      
    <span class="token comment"># 打开Excel文件   </span>
    wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 获取指定Sheet   </span>
    sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span><span class="token string">"Sheet1"</span><span class="token punctuation">]</span>      
    <span class="token comment"># 修改单元格数据   </span>
    sheet<span class="token punctuation">[</span><span class="token string">"A1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Updated Value"</span>      
    <span class="token comment"># 添加新的Sheet   </span>
    new_sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">"Sheet2"</span><span class="token punctuation">)</span>      
    <span class="token comment"># 保存修改后的Excel文件   </span>
    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"data_modified.xlsx"</span><span class="token punctuation">)</span>    
</code></pre> 
<h3><a id="_131"></a>六、结语</h3> 
<p>通过pandas和openpyxl等第三方库，我们可以方便地读取、写入和修改Excel文件。本文介绍了Python对Excel文件处理的基本方法，并提供了相应的代码示例和详细说明。你可以根据实际需求，进一步探索这些库的其他功能和特性。Excel文件的处理能力将为你的Python应用程序带来更多可能性，帮助你更好地处理和分析数据。</p> 
<p><strong>最后这里</strong>免费<strong>分享给大家一份Python学习资料，包含视频、源码。课件，希望能帮到那些不满现状，想提升自己却又没有方向的朋友，也可以和我一起来学习交流呀。<br> 编程资料、学习路线图、源代码、软件安装包等！</strong></p> 
<h3><a id="_139"></a>看下方图片哦（掉落）<strong>↓↓↓</strong></h3> 
<p>① <strong><code>Python所有方向的学习路线图</code></strong>，清楚各个方向要学什么东西<br> ② <strong><code>100多节Python课程视频</code></strong>，涵盖必备基础、爬虫和数据分析<br> ③ <strong><code>100多个Python实战案例</code></strong>，学习不再是只会理论<br> ④ <strong><code>华为出品独家Python漫画教程</code></strong>，手机也能学习<br> ⑤ <strong><code>历年互联网企业Python面试真题</code></strong>,复习时非常方便****</p> 
<p><img src="https://images2.imgbox.com/ba/27/vZFhhs1G_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4ce9933fb6b57646a2c75d3507754b54/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Springcloud和shiro的一种权限实现方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9acc4996f7c83ffcd3d84c97979f258c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">竞赛保研 基于深度学习的植物识别算法 - cnn opencv python</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>