<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>TimesNet：Temporal 2D-variation modeling for general time series analysis 论文要点 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="TimesNet：Temporal 2D-variation modeling for general time series analysis 论文要点" />
<meta property="og:description" content="文章目录 摘要问题分析数据层面方法层面 本文方法整体框架TimesBlock1D to 2D选择最显著频率维度转换 捕捉2D特征自适应聚合 实验结果短期预测长期预测imputation分类异常检测 文章获取： https://openreview.net/pdf?id=ju_Uqw384Oq 代码地址： https://github.com/thuml/Time-Series-Library 摘要 时间序列分析在天气预报、异常检测、动作识别等领域有着广泛的应用。时间变化建模是大量分析任务中常见的关键问题。以前的方法试图直接从1D时间序列中完成这一点，由于复杂的时间模式，这是极具挑战性的。通过对时间序列多周期性的观察，我们将复杂的时间变化分解为多个周期内变化和周期间变化。为了解决一维时间序列在表示能力上的局限性，我们将一维时间序列转换为一组基于多个周期的二维张量，从而将时间变化分析扩展到二维空间。这种变换可以将周期内变化和周期间变化分别嵌入到二维张量的列和行中，使得二维变化可以很容易地用二维核来建模。从技术上讲，我们提出了以时间块作为时间序列分析的任务通用骨干的时间网。TimesBlock可以自适应地发现多周期性，并通过参数高效的初始块从转换后的二维张量中提取复杂的时间变化。我们提出的TimesNet在五个主流时间序列分析任务中达到了一致的最先进水平，包括短期和长期预测、imputation、分类和异常检测。
问题分析 数据层面 数据特征上，不同于自然语言、视频等序列数据，时间序列中单个时刻仅保存了一些标量，其关键信息更多地被蕴含在时序变化中
方法层面 近年来，应用于时间序列分析的方法大致可以分为基于卷积的方法和基于transformer的方法
基于卷积的方法主要关注捕捉临近时刻之间的变化，在长期依赖上建模能力不足。
基于transformer的方法虽然在建模长期依赖上具有天然优势，但是由于现实世界的时序变化极其复杂，仅仅依靠离散时间点之间的注意力难以挖掘出可靠的时序依赖。
本文方法 TimeNet从周期角度出发，从多种不同粒度提取数据在周期内以及周期间的变化
将数据进行FFT快速傅里叶变换，找出幅值最高的k个频率，并按照不同频率对数据进行多组采样将同一频率采样的多组数据拼在一起，将数据从一个一维数据转换为多个二维数据使用具有二维核的TimesBlock（基于Inception）对每一组二维数据进行特征提取将k组二维数据的特征使用自适应聚合进行拼接，得到时间序列的整体特征以残差形式多次叠加步骤1-4（TImesBlock） 整体框架 基于时间序列的多周期性，提出了具有模块化架构的时间网，以捕获来自不同周期的时间模式
对于每个周期，为了捕获相应的周期内和周期间变化，在TImesNet中设计了一个TimesBlock，它可以将1D时间序列转换为2D空间，并通过共享参数的InceptionBlock同时对两种类型的变化进行建模
TimesBlock TimesNet以残差模式组织TimesBlock，可以在二维空间中通过参数高效的Inception Block捕获k个不同的重塑张量的各种时间二维变化，并根据归一化的振幅值进行融合，除第一层外每一个TimesBlock中数据的变化都是1D-&gt;2D-&gt;1D
对于第1层，使用嵌入层将原始数据投影到一维深度特征空间
对于第l个TimesBlock，整个过程包括两个连续的部分：捕获时态2d变化和自适应聚合来自不同时期的表示
每一个TimesBlock都需要进行FFT变换，转为2D提取特征，再自适应聚合为1D
1D to 2D 每个时间点与相邻区域同时存在两种时间变化类型，即周期内变化和周期间变化。然而，原始的时间序列一维结构只能表现相邻时间点之间的变化
时间变化的二维结构，它可以明确地表示周期内和周期间的变化，从而在表示能力上更有优势，有利于后续的表示学习
选择最显著频率 有C个长度为T的时间序列，原始1D数据为X1D。为了表示周期间的变化，首先通过快速傅立叶变换(FFT)在频域对时间序列进行如下分析，发现数据周期
FFT(·)和Amp(·)表示FFT和振幅值的计算。A∈RT表示每个频率的计算振幅，由Avg(·)从C维取平均
考虑到频域的稀疏性，避免无意义高频带来的噪声，我们只选取前k个振幅值，得到了非归一化振幅{Af1，···，Afk}的最显著频率{f1，···，fk}，其中k为超参数。这些选定的频率也对应k个周期长度{p1，···，pk}
由于频域的共轭性，只考虑{1，···，[t/2]}范围内的频率
维度转换 基于所选频率{f1 , · · · , fk}和同期长度{p1 , · · · , pk}，可以将一个一维时间序列reshape多个二维张量
实现，若无法恰好根据频率完成采样，则对时间序列填充0到fi*pi长度
二维张量的列、行分别表示pi（长度）和fi（频率），对应周期长度pi下的周期内变化和周期间变化
基于所选择的频率和估计的周期，我们得到了一组二维张量{X12D，···，Xk2D}，它表示了不同周期推导出的k个不同的时域二维变化
二维张量带来了两种类型的位置，即相邻时间点(列，周期内变化)和相邻周期(行，周期间变化)之间的位置。因此，二维核可以很容易地处理时序二维变化
捕捉2D特征 使用参数高效InceptionBlock对2D特征进行捕捉
首先获取一个2D数据然后通过FFT转换为多个2D数据转换后，我们通过一个共享参数的inceptionBlock处理2D张量，即inception(·)，使得模型大小对超参数k的选择不变然后我们将学习到的二维表示转换回1D空间进行聚合，其中我们使用Trunc(·)将长度为pi × fi的填充级数截断为原始长度T 自适应聚合 作用：融合k个不同的1D表示
振幅A可以反映所选频率和周期的相对重要性，从而对应于每个转换的2D张量的重要性，因此基于振幅聚合1D表示
实验结果 为了验证TimesNet的通用性，对5个主流分析任务进行了广泛的实验，包括短期和长期预测、imputation、分类和异常检测。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a2f83d9d8a8af8478ac4777f82342ef6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-10T18:51:26+08:00" />
<meta property="article:modified_time" content="2023-03-10T18:51:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">TimesNet：Temporal 2D-variation modeling for general time series analysis 论文要点</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_6" rel="nofollow">摘要</a></li><li><a href="#_11" rel="nofollow">问题分析</a></li><li><ul><li><a href="#_12" rel="nofollow">数据层面</a></li><li><a href="#_15" rel="nofollow">方法层面</a></li></ul> 
   </li><li><a href="#_22" rel="nofollow">本文方法</a></li><li><a href="#_31" rel="nofollow">整体框架</a></li><li><ul><li><a href="#TimesBlock_36" rel="nofollow">TimesBlock</a></li><li><ul><li><a href="#1D_to_2D_46" rel="nofollow">1D to 2D</a></li><li><ul><li><a href="#_51" rel="nofollow">选择最显著频率</a></li><li><a href="#_60" rel="nofollow">维度转换</a></li></ul> 
     </li><li><a href="#2D_72" rel="nofollow">捕捉2D特征</a></li><li><a href="#_82" rel="nofollow">自适应聚合</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_92" rel="nofollow">实验结果</a></li><li><ul><li><a href="#_96" rel="nofollow">短期预测</a></li><li><a href="#_99" rel="nofollow">长期预测</a></li><li><a href="#imputation_102" rel="nofollow">imputation</a></li><li><a href="#_105" rel="nofollow">分类</a></li><li><a href="#_108" rel="nofollow">异常检测</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<br> 
<img src="https://images2.imgbox.com/a0/6c/lZQJTZsP_o.png" alt="在这里插入图片描述"> 
<br> 文章获取： 
<a href="https://openreview.net/pdf?id=ju_Uqw384Oq" rel="nofollow">https://openreview.net/pdf?id=ju_Uqw384Oq</a> 
<br> 代码地址： 
<a href="https://github.com/thuml/Time-Series-Library">https://github.com/thuml/Time-Series-Library</a> 
<p></p> 
<h3><a id="_6"></a>摘要</h3> 
<p>时间序列分析在天气预报、异常检测、动作识别等领域有着广泛的应用。时间变化建模是大量分析任务中常见的关键问题。以前的方法试图直接从1D时间序列中完成这一点，由于复杂的时间模式，这是极具挑战性的。通过对时间序列多周期性的观察，我们将复杂的时间变化分解为多个<strong>周期内变化</strong>和<strong>周期间变化</strong>。为了解决一维时间序列在表示能力上的局限性，我们将一维时间序列转换为一组<strong>基于多个周期的二维张量</strong>，从而将时间变化分析扩展到二维空间。这种变换可以将周期内变化和周期间变化分别嵌入到二维张量的列和行中，使得二维变化可以很容易地用<strong>二维核来建模</strong>。从技术上讲，我们提出了以时间块作为时间序列分析的任务通用骨干的时间网。TimesBlock可以自适应地发现多周期性，并通过参数高效的初始块从转换后的二维张量中提取复杂的时间变化。我们提出的TimesNet在五个主流时间序列分析任务中达到了一致的最先进水平，包括短期和长期预测、imputation、分类和异常检测。</p> 
<p><img src="https://images2.imgbox.com/bb/e1/C5MsQLk4_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_11"></a>问题分析</h3> 
<h4><a id="_12"></a>数据层面</h4> 
<p>数据特征上，不同于自然语言、视频等序列数据，时间序列中单个时刻仅保存了一些标量，其关键信息更多地被蕴含在<strong>时序变化</strong>中</p> 
<h4><a id="_15"></a>方法层面</h4> 
<p>近年来，应用于时间序列分析的方法大致可以分为<strong>基于卷积</strong>的方法和<strong>基于transformer</strong>的方法</p> 
<ul><li> <p>基于卷积的方法主要关注捕捉临近时刻之间的变化，在长期依赖上建模能力不足。</p> </li><li> <p>基于transformer的方法虽然在建模长期依赖上具有天然优势，但是由于现实世界的时序变化极其复杂，仅仅依靠离散时间点之间的注意力难以挖掘出可靠的时序依赖。</p> </li></ul> 
<h3><a id="_22"></a>本文方法</h3> 
<p>TimeNet从<strong>周期</strong>角度出发，从多种不同粒度提取数据在周期内以及周期间的变化</p> 
<ol><li>将数据进行FFT快速傅里叶变换，找出幅值最高的k个频率，并按照不同频率对数据进行多组采样</li><li>将同一频率采样的多组数据拼在一起，将数据从一个一维数据转换为多个二维数据</li><li>使用具有二维核的TimesBlock（基于Inception）对每一组二维数据进行特征提取</li><li>将k组二维数据的特征使用自适应聚合进行拼接，得到时间序列的整体特征</li><li>以残差形式多次叠加步骤1-4（TImesBlock）</li></ol> 
<h3><a id="_31"></a>整体框架</h3> 
<p>基于时间序列的多周期性，提出了<strong>具有模块化架构的时间网</strong>，以捕获来自<strong>不同周期的时间模式</strong></p> 
<p>对于每个周期，为了捕获相应的周期内和周期间变化，在TImesNet中设计了一个TimesBlock，它可以将1D时间序列转换为2D空间，并通过共享参数的InceptionBlock同时对两种类型的变化进行建模</p> 
<h4><a id="TimesBlock_36"></a>TimesBlock</h4> 
<p>TimesNet以<strong>残差</strong>模式组织TimesBlock，可以在二维空间中通过参数高效的Inception Block捕获k个不同的重塑张量的各种时间二维变化，并根据归一化的振幅值进行融合，<strong>除第一层外每一个TimesBlock中数据的变化都是1D-&gt;2D-&gt;1D</strong><br> <img src="https://images2.imgbox.com/39/26/enGyOJ7x_o.png" alt="在这里插入图片描述"></p> 
<p>对于第1层，使用嵌入层将原始数据投影到一维深度特征空间<br> 对于第l个TimesBlock，整个过程包括两个连续的部分：<strong>捕获时态2d变化</strong>和<strong>自适应聚合</strong>来自不同时期的表示</p> 
<p><strong>每一个TimesBlock都需要进行FFT变换，转为2D提取特征，再自适应聚合为1D</strong><br> <img src="https://images2.imgbox.com/ac/e9/TQIwxF1k_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="1D_to_2D_46"></a>1D to 2D</h5> 
<p><img src="https://images2.imgbox.com/36/06/6aoDTLkP_o.png" alt="在这里插入图片描述"><br> 每个时间点与相邻区域同时存在两种时间变化类型，即周期内变化和周期间变化。然而，原始的时间序列一维结构只能表现相邻时间点之间的变化</p> 
<p>时间变化的二维结构，它可以明确地表示周期内和周期间的变化，从而在表示能力上更有优势，有利于后续的表示学习</p> 
<h6><a id="_51"></a>选择最显著频率</h6> 
<p>有C个长度为T的时间序列，原始1D数据为X1D。为了表示周期间的变化，首先通过快速傅立叶变换(FFT)在频域对时间序列进行如下分析，发现数据周期<br> <img src="https://images2.imgbox.com/6e/b0/6WkqEMq9_o.png" alt="在这里插入图片描述"><br> FFT(·)和Amp(·)表示<strong>FFT</strong>和<strong>振幅值</strong>的计算。A∈RT表示每个频率的计算振幅，由Avg(·)从C维取平均</p> 
<p>考虑到频域的稀疏性，避免无意义高频带来的噪声，我们<strong>只选取前k个振幅值</strong>，得到了非归一化<strong>振幅</strong>{Af1，···，Afk}的<strong>最显著频率</strong>{f1，···，fk}，其中k为超参数。这些选定的频率也对应<strong>k个周期长度</strong>{p1，···，pk}</p> 
<p>由于频域的共轭性，<strong>只考虑{1，···，[t/2]}范围内的频率</strong></p> 
<h6><a id="_60"></a>维度转换</h6> 
<p>基于所选频率{f1 , · · · , fk}和同期长度{p1 , · · · , pk}，可以将一个一维时间序列<strong>reshape</strong>多个二维张量<br> 实现，若无法恰好根据频率完成采样，则对时间序列<strong>填充0</strong>到fi*pi长度</p> 
<p>二维张量的列、行分别表示pi（长度）和fi（频率），对应周期长度pi下的周期内变化和周期间变化</p> 
<p>基于所选择的频率和估计的周期，我们得到了一组二维张量{X12D，···，Xk2D}，它表示了不同周期推导出的k个不同的时域二维变化</p> 
<p>二维张量带来了两种类型的位置，即<strong>相邻时间点</strong>(列，周期内变化)和<strong>相邻周期</strong>(行，周期间变化)之间的位置。因此，二维核可以很容易地处理时序二维变化</p> 
<h5><a id="2D_72"></a>捕捉2D特征</h5> 
<p>使用参数高效InceptionBlock对2D特征进行捕捉<br> <img src="https://images2.imgbox.com/e6/84/sT0SDCcB_o.png" alt="在这里插入图片描述"></p> 
<ol><li>首先获取一个2D数据</li><li>然后通过FFT转换为多个2D数据</li><li>转换后，我们通过一个<strong>共享参数</strong>的inceptionBlock处理2D张量，即inception(·)，使得模型大小对超参数k的选择不变</li><li>然后我们将学习到的二维表示转换回1D空间进行聚合，其中我们使用Trunc(·)将长度为pi × fi的填充级数<strong>截断</strong>为原始长度T</li></ol> 
<h5><a id="_82"></a>自适应聚合</h5> 
<p>作用：融合k个不同的1D表示</p> 
<p>振幅A可以反映所选频率和周期的相对重要性，从而对应于每个转换的2D张量的重要性，因此<strong>基于振幅</strong>聚合1D表示</p> 
<p><img src="https://images2.imgbox.com/9c/41/Kp0udDJX_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_92"></a>实验结果</h3> 
<p>为了验证TimesNet的通用性，对5个主流分析任务进行了广泛的实验，包括短期和长期预测、imputation、分类和异常检测。</p> 
<p><img src="https://images2.imgbox.com/ff/e4/8y4Vb458_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_96"></a>短期预测</h4> 
<p><img src="https://images2.imgbox.com/1e/58/IQGdZE97_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_99"></a>长期预测</h4> 
<p><img src="https://images2.imgbox.com/10/e1/y62erwlc_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="imputation_102"></a>imputation</h4> 
<p><img src="https://images2.imgbox.com/0f/a7/q8DEbM0X_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_105"></a>分类</h4> 
<p><img src="https://images2.imgbox.com/5e/de/JZ9Ymqay_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_108"></a>异常检测</h4> 
<p><img src="https://images2.imgbox.com/c4/8f/wqGKaUwM_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e2d44233c7a5387a2f61ce4ce0137b31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Docker】如何在内网快速搭建docker并安装Oracle11g</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4676b17b1fb93eb9f8eaadf757ac23bf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数字识别实例两种实现方式(tensorflow2.x)：1.调用高级API 2.手写简单神经网络 3.手写深度神经网络（DNN）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>