<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java-c3p0原生写法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Java-c3p0原生写法" />
<meta property="og:description" content="目录
1.项目整体结构
2.新建c3p0-config.xml文件
3.新建JDBCUtil工具类
4.数据库操作
简易版的c3p0连接。
1.项目整体结构 这里的两个c3p0jar包必须有。
可以去http://mvnrepository.com/搜索jar包名下载，别浪费积分去csdn里面下载了...小编以前被坑过很多次。
2.新建c3p0-config.xml文件 命名必须为c3p0-config.xml,
必须放在src目录下，c3p0包会默认加载src目录下的c3p0-config.xml文件。
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;c3p0-config&gt; &lt;!-- 这是默认配置信息 --&gt; &lt;default-config&gt; &lt;!-- 连接四大参数配置 --&gt; &lt;property name=&#34;jdbcUrl&#34;&gt;jdbc:mysql://localhost:3306/jdbctest&lt;/property&gt; &lt;property name=&#34;driverClass&#34;&gt;com.mysql.jdbc.Driver&lt;/property&gt; &lt;property name=&#34;user&#34;&gt;root&lt;/property&gt; &lt;property name=&#34;password&#34;&gt;root&lt;/property&gt; &lt;!-- 池参数配置 --&gt; &lt;property name=&#34;acquireIncrement&#34;&gt;3&lt;/property&gt; &lt;property name=&#34;initialPoolSize&#34;&gt;10&lt;/property&gt; &lt;property name=&#34;minPoolSize&#34;&gt;2&lt;/property&gt; &lt;property name=&#34;maxPoolSize&#34;&gt;10&lt;/property&gt; &lt;/default-config&gt; &lt;!-- 专门为oracle提供的配置信息 --&gt; &lt;named-config name=&#34;oracle-config&#34;&gt; &lt;property name=&#34;jdbcUrl&#34;&gt;jdbc:mysql://localhost:3306/mydb1&lt;/property&gt; &lt;property name=&#34;driverClass&#34;&gt;com.mysql.jdbc.Driver&lt;/property&gt; &lt;property name=&#34;user&#34;&gt;root&lt;/property&gt; &lt;property name=&#34;password&#34;&gt;123&lt;/property&gt; &lt;property name=&#34;acquireIncrement&#34;&gt;3&lt;/property&gt; &lt;property name=&#34;initialPoolSize&#34;&gt;10&lt;/property&gt; &lt;property name=&#34;minPoolSize&#34;&gt;2&lt;/property&gt; &lt;property name=&#34;maxPoolSize&#34;&gt;10&lt;/property&gt; &lt;/named-config&gt; &lt;/c3p0-config&gt; 3.新建JDBCUtil工具类 package com.test.uitls; import java." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e18a6b3252623c8c6558c52f484a5cf3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-01T15:57:56+08:00" />
<meta property="article:modified_time" content="2018-08-01T15:57:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java-c3p0原生写法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%E9%A1%B9%E7%9B%AE%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84-toc" style="margin-left:0px;"><a href="#1.%E9%A1%B9%E7%9B%AE%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84" rel="nofollow">1.项目整体结构</a></p> 
<p id="2.%E6%96%B0%E5%BB%BAc3p0-config.xml%E6%96%87%E4%BB%B6-toc" style="margin-left:0px;"><a href="#2.%E6%96%B0%E5%BB%BAc3p0-config.xml%E6%96%87%E4%BB%B6" rel="nofollow">2.新建c3p0-config.xml文件</a></p> 
<p id="3.%E6%96%B0%E5%BB%BAJDBCUtil%E5%B7%A5%E5%85%B7%E7%B1%BB-toc" style="margin-left:0px;"><a href="#3.%E6%96%B0%E5%BB%BAJDBCUtil%E5%B7%A5%E5%85%B7%E7%B1%BB" rel="nofollow">3.新建JDBCUtil工具类</a></p> 
<p id="4.%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C-toc" style="margin-left:0px;"><a href="#4.%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C" rel="nofollow">4.数据库操作</a></p> 
<hr id="hr-toc"> 
<p><span style="color:#f33b45;">简易版的c3p0连接。</span></p> 
<h2 id="1.%E9%A1%B9%E7%9B%AE%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84">1.项目整体结构</h2> 
<p><img alt="" class="has" height="348" src="https://images2.imgbox.com/a4/a0/r8fKUZVQ_o.png" width="303"></p> 
<p>这里的两个c3p0jar包必须有。</p> 
<p>可以去<a href="http://mvnrepository.com/" rel="nofollow">http://mvnrepository.com/</a>搜索jar包名下载，别浪费积分去csdn里面下载了...小编以前被坑过很多次。</p> 
<p><img alt="" class="has" height="313" src="https://images2.imgbox.com/f0/c1/ejpSS7yg_o.png" width="1200"></p> 
<h2 id="2.%E6%96%B0%E5%BB%BAc3p0-config.xml%E6%96%87%E4%BB%B6">2.新建c3p0-config.xml文件</h2> 
<p><span style="color:#f33b45;">   命名必须为c3p0-config.xml,</span></p> 
<p><span style="color:#f33b45;">   必须放在src目录下，c3p0包会默认加载src目录下的c3p0-config.xml文件。</span></p> 
<pre class="has"><code class="language-java">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;c3p0-config&gt;
	&lt;!-- 这是默认配置信息 --&gt;
	&lt;default-config&gt;
		&lt;!-- 连接四大参数配置 --&gt;
		&lt;property name="jdbcUrl"&gt;jdbc:mysql://localhost:3306/jdbctest&lt;/property&gt;
		&lt;property name="driverClass"&gt;com.mysql.jdbc.Driver&lt;/property&gt;
		&lt;property name="user"&gt;root&lt;/property&gt;
		&lt;property name="password"&gt;root&lt;/property&gt;
		&lt;!-- 池参数配置 --&gt;
		&lt;property name="acquireIncrement"&gt;3&lt;/property&gt;
		&lt;property name="initialPoolSize"&gt;10&lt;/property&gt;
		&lt;property name="minPoolSize"&gt;2&lt;/property&gt;
		&lt;property name="maxPoolSize"&gt;10&lt;/property&gt;
	&lt;/default-config&gt;
	
	&lt;!-- 专门为oracle提供的配置信息 --&gt;
	&lt;named-config name="oracle-config"&gt;
	&lt;property name="jdbcUrl"&gt;jdbc:mysql://localhost:3306/mydb1&lt;/property&gt;
	&lt;property name="driverClass"&gt;com.mysql.jdbc.Driver&lt;/property&gt;
	&lt;property name="user"&gt;root&lt;/property&gt;
	&lt;property name="password"&gt;123&lt;/property&gt;
	&lt;property name="acquireIncrement"&gt;3&lt;/property&gt;
	&lt;property name="initialPoolSize"&gt;10&lt;/property&gt;
	&lt;property name="minPoolSize"&gt;2&lt;/property&gt;
	&lt;property name="maxPoolSize"&gt;10&lt;/property&gt;
	&lt;/named-config&gt;
&lt;/c3p0-config&gt;</code></pre> 
<p> </p> 
<h2 id="3.%E6%96%B0%E5%BB%BAJDBCUtil%E5%B7%A5%E5%85%B7%E7%B1%BB">3.新建JDBCUtil工具类</h2> 
<pre class="has"><code class="language-java">package com.test.uitls;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import javax.sql.DataSource;
import com.mchange.v2.c3p0.ComboPooledDataSource;

public class JDBCUtil {
	private static DataSource ds = new ComboPooledDataSource();

// 获取连接池
	public static DataSource getDataSource() {
		return ds;
	}

// 获取连接
	public static Connection getConnection() throws SQLException {
		return ds.getConnection();
	}

	/**
	 * 关闭连接
	 * @param resultSet
	 * @param pst
	 * @param connection
	 */
	public static void close(ResultSet resultSet, PreparedStatement pst, Connection connection) {
		if (resultSet != null) {
			try {
				resultSet.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
		if (pst != null) {
			try {
				pst.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
		if (connection != null) {
			try {
				connection.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}
	}

}
</code></pre> 
<p> </p> 
<h2 id="4.%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C">4.数据库操作</h2> 
<pre class="has"><code class="language-java">package com.test.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import com.test.uitls.JDBCUtil;

public class JDBCDao {
	/**
	 *  * 增加，删除，修改  
	 */
	public static void insertOrDeleteOrUpdate(String sql) {
		try {
			Connection connection = JDBCUtil.getConnection();
			PreparedStatement pst = connection.prepareStatement(sql);
			int execute = pst.executeUpdate();
			System.out.println("执行语句：" + sql + "," + execute + "行数据受影响");
			JDBCUtil.close(null, pst, connection);
		} catch (SQLException e) {
			System.out.println("异常提醒：" + e);
		}
	}

	/**
	 *  * 查询，返回结果集  
	 */
	public static List&lt;Map&lt;String, Object&gt;&gt; select(String sql) {
		List&lt;Map&lt;String, Object&gt;&gt; returnResultToList = null;
		try {
			Connection connection = JDBCUtil.getConnection();
			PreparedStatement pst = connection.prepareStatement(sql);
			ResultSet resultSet = pst.executeQuery();
//	returnResultToList = returnResultToList(resultSet);
			JDBCUtil.close(resultSet, pst, connection);
		} catch (SQLException e) {

			System.out.println("异常提醒：" + e);
		}
		return returnResultToList;
	}

	/**
	 *  * 数据返回集合  * @param resultSet  * @return  * @throws SQLException  
	 */
	public static List&lt;Map&lt;String, Object&gt;&gt; returnResultToList(ResultSet resultSet) {
		List&lt;Map&lt;String, Object&gt;&gt; values = null;
		try {
			// 键: 存放列的别名, 值: 存放列的值.
			values = new ArrayList&lt;&gt;();
			// 存放字段名
			List&lt;String&gt; columnName = new ArrayList&lt;&gt;();
			ResultSetMetaData rsmd = resultSet.getMetaData();
			for (int i = 0; i &lt; rsmd.getColumnCount(); i++) {
				// 字段名
				columnName.add(rsmd.getColumnLabel(i + 1));
			}

			System.out.println("表字段为：");
			System.out.println(columnName);
			System.out.println("表数据为：");
			Map&lt;String, Object&gt; map = null;
			// 处理 ResultSet, 使用 while 循环
			while (resultSet.next()) {
				map = new HashMap&lt;&gt;();
				for (String column : columnName) {
					Object value = resultSet.getObject(column);
					map.put(column, value);
					System.out.print(value + "\t");
				}
				// 把一条记录的 Map 对象放入准备的 List 中
				values.add(map);
				System.out.println();
			}
		} catch (SQLException e) {
			System.out.println("异常提醒：" + e);
		}
		return values;
	}
}
</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ffd0a44896ddc137f19839fddf5ef6f2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">堆溢出off-by-one(asis-ctf-2016 pwn 之 b00ks)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f9a3d6dfc22d56d79f50f623a3029408/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">intellij idea快速通过mapper跳转到xml文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>