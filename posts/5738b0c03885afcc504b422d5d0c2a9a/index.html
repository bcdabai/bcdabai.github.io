<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 实现二维码详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# 实现二维码详解" />
<meta property="og:description" content="二维码是什么 二维码 QR Code，全称为：Quick Response Code，最早用于日本汽车制造业追踪零部件。QR现有40个标准版本，4个微型版本。相比一维码（也就是我们目前还在常用的条码），拥有更高密度的编码，可存储的信息量更大。一维码只能存储字母和数字，二维码可容纳多达1850个大写字母或者2710个数字或者1108个字符或者500多个汉字，比条码存储量多了几十倍。另外，二维码可以把图片、声音、文字、等可以数字化的信息进行编码。
除此之外：二维码比一维码译码错误率要低得多（误码率不超过千分之一），保密性、防伪性更好，成本低廉，容易制作，让二维码使用更加广泛，越来越流行。
除了存储编码的数据，QR码里还含有一些基本标准里钦定的图样来帮助扫描软件快速识别和解码。
标准（ISO/IEC 18004）里是这样说的
更多的详解请查看这篇博客
C# 实现 首先在NuGet引入ThoughtWorks.QRCode
生产二维码的时候用到ThoughtWorks.QRCode 的 QRCodeEncoder类
namespace ThoughtWorks.QRCode.Codec { public class QRCodeEncoder { public QRCodeEncoder(); public virtual Color QRCodeBackgroundColor { get; set; } public virtual ENCODE_MODE QRCodeEncodeMode { get; set; } public virtual ERROR_CORRECTION QRCodeErrorCorrect { get; set; } public virtual Color QRCodeForegroundColor { get; set; } public virtual int QRCodeScale { get; set; } public virtual int QRCodeVersion { get; set; } public virtual bool[][] calQrcode(byte[] qrcodeData); public virtual int calStructureappendParity(sbyte[] originaldata); public virtual Bitmap Encode(string content); public virtual Bitmap Encode(string content, Encoding encoding); public virtual void setStructureappend(int m, int n, int p); public enum ENCODE_MODE { ALPHA_NUMERIC = 0, NUMERIC = 1, BYTE = 2 } public enum ERROR_CORRECTION { L = 0, M = 1, Q = 2, H = 3 } } } ENCODE_MODE枚举是编码方式，因为我们的字符串里面可能存在中文，所以这里使用了BYTE，ALPHA_NUMERIC与NUMERIC只能编码数字" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5738b0c03885afcc504b422d5d0c2a9a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-06T10:36:04+08:00" />
<meta property="article:modified_time" content="2021-09-06T10:36:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 实现二维码详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>二维码是什么</h2> 
<p>二维码 QR Code，全称为：Quick Response Code，最早用于日本汽车制造业追踪零部件。QR现有40个标准版本，4个微型版本。相比一维码（也就是我们目前还在常用的条码），拥有更高密度的编码，可存储的信息量更大。一维码只能存储字母和数字，二维码可容纳多达1850个大写字母或者2710个数字或者1108个字符或者500多个汉字，比条码存储量多了几十倍。另外，二维码可以把图片、声音、文字、等可以数字化的信息进行编码。</p> 
<p>除此之外：二维码比一维码译码错误率要低得多（误码率不超过千分之一），保密性、防伪性更好，成本低廉，容易制作，让二维码使用更加广泛，越来越流行。</p> 
<p>除了存储编码的数据，QR码里还含有一些基本标准里钦定的图样来帮助扫描软件快速识别和解码。</p> 
<p><img alt="" height="357" src="https://images2.imgbox.com/47/12/k5egUL4w_o.png" width="630"></p> 
<p>标准（ISO/IEC 18004）里是这样说的</p> 
<p><img alt="" height="495" src="https://images2.imgbox.com/13/6f/7Lf7mu7c_o.png" width="834"></p> 
<p> 更多的详解请查看<a href="https://www.cnblogs.com/sddai/p/5675041.html" rel="nofollow">这篇博客</a></p> 
<h2>C# 实现</h2> 
<p>首先在NuGet引入ThoughtWorks.QRCode</p> 
<p><img alt="" height="422" src="https://images2.imgbox.com/b4/59/E475qHrk_o.png" width="1200"></p> 
<p> 生产二维码的时候用到ThoughtWorks.QRCode 的 QRCodeEncoder类</p> 
<pre><code class="language-cs">namespace ThoughtWorks.QRCode.Codec
{
    public class QRCodeEncoder
    {
        public QRCodeEncoder();

        public virtual Color QRCodeBackgroundColor { get; set; }
        public virtual ENCODE_MODE QRCodeEncodeMode { get; set; }
        public virtual ERROR_CORRECTION QRCodeErrorCorrect { get; set; }
        public virtual Color QRCodeForegroundColor { get; set; }
        public virtual int QRCodeScale { get; set; }
        public virtual int QRCodeVersion { get; set; }

        public virtual bool[][] calQrcode(byte[] qrcodeData);
        public virtual int calStructureappendParity(sbyte[] originaldata);
        public virtual Bitmap Encode(string content);
        public virtual Bitmap Encode(string content, Encoding encoding);
        public virtual void setStructureappend(int m, int n, int p);

        public enum ENCODE_MODE
        {
            ALPHA_NUMERIC = 0,
            NUMERIC = 1,
            BYTE = 2
        }
        public enum ERROR_CORRECTION
        {
            L = 0,
            M = 1,
            Q = 2,
            H = 3
        }
    }
}</code></pre> 
<p>ENCODE_MODE枚举是编码方式，因为我们的字符串里面可能存在中文，所以这里使用了BYTE，ALPHA_NUMERIC与NUMERIC只能编码数字</p> 
<p>数字编码（NUMERIC）：可编码0-9，10个数字，如果需要编码的数字的个数不是3的倍数，最后剩下的1或2位数会被转成4或7bits，其它的每3位数字会根据不同版本被编成 10，12，14bits</p> 
<p>字符编码（ALPHA_NUMERIC) ：可编码0-9,大写的A-Z,以及9个其他的字符(space $ % * + – . / :);</p> 
<p>8位字节模式(BYTE) ：可编码JIS X 0201的8位Latin/Kana字符集</p> 
<p>除此之外，QR还提供了其他的编码方式，每一个编码方式都有其独有的id进行标识，这些标识会记录在数据区的前端，使得解码器可以根据二维码使用的编码方式对数据进行解码</p> 
<p>      <img alt="" height="332" src="https://images2.imgbox.com/99/0b/Val46gb8_o.jpg" width="442"></p> 
<p> ERROR_CORRECTION枚举是容错级别</p> 
<pre><code class="language-XML">L : 最大 7% 的错误能够被纠正；

M : 最大 15% 的错误能够被纠正；

Q : 最大 25% 的错误能够被纠正；

H : 最大 30% 的错误能够被纠正；</code></pre> 
<p>版本信息：即二维码的规格，QR码符号共有40种规格的矩阵（一般为黑白色），从21x21（版本1），到177x177（版本40），每一版本符号比前一版本每边增加4个模块。</p> 
<p>177 ＝ 21+（40-1）＋4 ＝ 21 ＋156.</p> 
<p> <img alt="" height="1200" src="https://images2.imgbox.com/ed/1f/0YBpVRx9_o.jpg" width="741"></p> 
<p> C#调用生成二维码</p> 
<pre><code class="language-cs">        /// &lt;summary&gt;
        /// 生成二维码
        /// &lt;/summary&gt;
        /// &lt;param name="strContent"&gt;二维码内容&lt;/param&gt;
        /// &lt;param name="qrCodeEncodeMode"&gt;编码方式&lt;/param&gt;
        /// &lt;param name="qrCodeScale"&gt;大小&lt;/param&gt;
        /// &lt;param name="qrCodeVersion"&gt;版本&lt;/param&gt;
        /// &lt;param name="qrCodeErrorCorrect"&gt;错误效验、错误更正&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public Bitmap CreateQRCodeBimap(string strContent, int qrCodeEncodeMode,int qrCodeScale,int qrCodeVersion,int qrCodeErrorCorrect)
        {
            QRCodeEncoder qrCodeEncoder = new QRCodeEncoder();
            //编码方式(BYTE能支持中文)
            qrCodeEncodeMode = qrCodeEncodeMode &gt; 2 ? 2 : qrCodeEncodeMode;
            qrCodeEncoder.QRCodeEncodeMode = (QRCodeEncoder.ENCODE_MODE)qrCodeEncodeMode;
            //大小(值越大生成的二维码图片像素越高)
            qrCodeEncoder.QRCodeScale = qrCodeScale;
            //版本
            qrCodeEncoder.QRCodeVersion = qrCodeVersion;
            //错误效验、错误更正
            qrCodeErrorCorrect = qrCodeErrorCorrect &gt; 3 ? 3 : qrCodeErrorCorrect;
            qrCodeEncoder.QRCodeErrorCorrect = (QRCodeEncoder.ERROR_CORRECTION)qrCodeErrorCorrect;

            return qrCodeEncoder.Encode(strContent, Encoding.GetEncoding("UTF-8"));//GB2312
        }</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/93a94cf85f316ae6b059c4c2dfeb9340/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">容器内安装CDH 6.3.2</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/eb0b142ef5a1339127f541c435ca9807/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VM导入windows镜像</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>