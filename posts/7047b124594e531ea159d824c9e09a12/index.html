<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用java调用谷歌浏览器驱动进行网页截图 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用java调用谷歌浏览器驱动进行网页截图" />
<meta property="og:description" content="最近做项目，需要用到截图的功能，就是给一个url地址，然后自动打开，截取出一个封面图片，保存到服务器上。前端有js可以支持截图，像phantomjs等js插件都可以实现，但是效果不是很好，有些页面渲染不出来。
phantom.js使用方法https://www.jianshu.com/p/074d7ab370e3
本次就介绍java使用chromedriver.exe谷歌浏览器驱动进行网页截图。
创建一个maven项目，在pom文件中加入以下依赖：
&lt;!--网页自动化测试--&gt; &lt;dependency&gt; &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt; &lt;artifactId&gt;selenium-java&lt;/artifactId&gt; &lt;version&gt;3.9.1&lt;/version&gt; &lt;/dependency&gt; &lt;!--commons.io文件拷贝用--&gt; &lt;dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;version&gt;2.4&lt;/version&gt; &lt;/dependency&gt; 在resources目录下新建一个driver目录：
然后在ChromeDriver Mirror下载与电脑谷歌浏览器对应版本的驱动，解压放到此driver目录下
编写main方法
public static void main(String[] args)throws Exception { String url = &#34;http://echarts.baidu.com/examples/&#34;; Integer sleepTime = 5*1000;// 截图等待时间 String targetPath = &#34;D:/test.jpg&#34;;// 生成图片文件路径 // 设置是否启用headless模式 System. setProperty(&#34;java.awt.headless&#34;, &#34;true&#34;); // 加载谷歌浏览器驱动 URL resource = Test.class.getClassLoader().getResource(&#34;&#34;); String driverPath = java.net.URLDecoder.decode(resource.getPath(), &#34;UTF-8&#34;) &#43; &#34;driver/chromedriver.exe&#34;; ChromeOptions option=new ChromeOptions(); option.addArguments(&#34;disable-infobars&#34;); System.setProperty(&#34;webdriver.chrome.driver&#34;, driverPath); WebDriver driver = new ChromeDriver(option); driver." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7047b124594e531ea159d824c9e09a12/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-13T18:57:45+08:00" />
<meta property="article:modified_time" content="2018-12-13T18:57:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用java调用谷歌浏览器驱动进行网页截图</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>最近做项目，需要用到截图的功能，就是给一个url地址，然后自动打开，截取出一个封面图片，保存到服务器上。前端有js可以支持截图，像phantomjs等js插件都可以实现，但是效果不是很好，有些页面渲染不出来。</p> 
<p>phantom.js使用方法<a href="https://www.jianshu.com/p/074d7ab370e3" rel="nofollow" title="https://www.jianshu.com/p/074d7ab370e3">https://www.jianshu.com/p/074d7ab370e3</a></p> 
<p></p> 
<p>本次就介绍java使用chromedriver.exe谷歌浏览器驱动进行网页截图。</p> 
<p></p> 
<p>创建一个maven项目，在pom文件中加入以下依赖：</p> 
<pre class="has"><code>        &lt;!--网页自动化测试--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;
            &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;
            &lt;version&gt;3.9.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!--commons.io文件拷贝用--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;commons-io&lt;/groupId&gt;
            &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
            &lt;version&gt;2.4&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<p></p> 
<p>在resources目录下新建一个driver目录：</p> 
<p>然后在<a href="http://npm.taobao.org/mirrors/chromedriver/" rel="nofollow" title="ChromeDriver Mirror">ChromeDriver Mirror</a>下载与电脑谷歌浏览器对应版本的驱动，解压放到此driver目录下</p> 
<p>编写main方法</p> 
<pre class="has"><code> public static void main(String[] args)throws Exception  {
        String url = "http://echarts.baidu.com/examples/";
        Integer sleepTime = 5*1000;// 截图等待时间
        String targetPath = "D:/test.jpg";// 生成图片文件路径
        // 设置是否启用headless模式
        System. setProperty("java.awt.headless", "true");
        // 加载谷歌浏览器驱动
        URL resource = Test.class.getClassLoader().getResource("");
        String driverPath = java.net.URLDecoder.decode(resource.getPath(), "UTF-8") + "driver/chromedriver.exe";
        ChromeOptions option=new ChromeOptions();
        option.addArguments("disable-infobars");
        System.setProperty("webdriver.chrome.driver", driverPath);
        WebDriver driver = new ChromeDriver(option);
        driver.manage().window().maximize();
        driver.get(url);
        Thread.sleep(sleepTime);
        File srcFile = ((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);
        // 全屏
        FileUtils.copyFile(srcFile, new File(targetPath));
        System.out.println("===&gt;截图完成...正在同步数据" + new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()));
//        robot.delay(3000);
        driver.quit();
    }</code></pre> 
<p>运行即可在D盘下生成一张jpg图片文件，我这里截的是echarts的网页，下面是截出来的效果图：</p> 
<p><img alt="" class="has" height="408" src="https://images2.imgbox.com/78/63/bGKyNNM0_o.png" width="800"></p> 
<p></p> 
<p>此方法截出来的图还算清晰，唯一的缺点就是调用方法的时候会打开一个浏览器窗口。如果有朋友还有其他更好的截图方法，欢迎交流。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2963a874da46e9f434070c7555f2aab8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java内嵌浏览器的几种方式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6243f9d79f2e815c7e35a32f924d196a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">xshell破解(包括5和6)免费下载</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>