<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用php为html页面创建登录验证码 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用php为html页面创建登录验证码" />
<meta property="og:description" content="使用php为html页面创建登录验证码 效果
验证码的创建
&lt;?php //1.创建画布 $canvas=imagecreatetruecolor(100,30); //2.创建背景颜色 $bg_color=imagecolorallocate($canvas, 0xCC, 0xCC, 0xCC); //3.填充颜色(注意：上面的第二步只是创建对应的颜色，第一个参数放画布是因为，画布分为rgb和真彩，所对应的rgb值有所不同) imagefill($canvas, 0, 0, $bg_color); //4.生成验证码的字符 $charCode=&#34;ZXCVBNMASDFGHJKLQWERTYUIOP23456789zxcvbnmkjhgfdsaqwertyuip&#34;; $charCode_len=strlen($charCode)-1; $code=&#34;&#34;;//最终生成的验证码 for($i=0;$index=4,$i&lt;$index;$i&#43;&#43;){ $code.=$charCode[mt_rand(0, $charCode_len)]; } //将code发布到session上用于页面核对验证码 session_start(); $_SESSION[&#39;vCode&#39;]=$code; or($i=0;$index=4,$i&lt;$index;$i&#43;&#43;){ //随机创建一个真彩色，用于添加到字体颜色 $fontColor=imagecolorallocate($canvas, mt_rand(0, 100), mt_rand(0, 50), mt_rand(0, 50)); //设置字体的其他属性 imagettftext($canvas,//作用的背景图 16,//字体大小 mt_rand(0, 45),//字体的倾斜角度 16*$i&#43;15,mt_rand(20, 30),//字体再x、y轴上的浮动范围 $fontColor, &#39;D:\php\http\Apache24\htdocs\Task345\fonts\SourceCodePro-Bold.ttf&#39;, $code[$i]); } /设置干扰元素 小点点 for($i=0;$index=300,$i&lt;$index;$i&#43;&#43;){ $dotColor=imagecolorallocate($canvas, mt_rand(0, 255), mt_rand(0, 255), mt_rand(0, 255)); imagesetpixel($canvas, mt_rand(0, 100), mt_rand(0, 30), $dotColor); } //设置干扰元素 线 for($i=0;$index=12,$i&lt;$index;$i&#43;&#43;){ $lineColor=imagecolorallocate($canvas, mt_rand(0, 255), mt_rand(0, 255), mt_rand(0, 255)); imageline($canvas, mt_rand(0, 100), mt_rand(0, 30), mt_rand(0, 100), mt_rand(0, 30), $lineColor); } //设置verifyCode." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c1bfe0676cf4a95a7abf9e82d43aeb18/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-09T14:36:11+08:00" />
<meta property="article:modified_time" content="2021-05-09T14:36:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用php为html页面创建登录验证码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="phphtml_0"></a>使用php为html页面创建登录验证码</h3> 
<p><em>效果</em><br> <img src="https://images2.imgbox.com/30/83/9ymUU06i_o.png" alt="在这里插入图片描述"><br> <em>验证码的创建</em></p> 
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>php
<span class="token comment">//1.创建画布</span>
$canvas<span class="token operator">=</span><span class="token function">imagecreatetruecolor</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2.创建背景颜色</span>
$bg_color<span class="token operator">=</span><span class="token function">imagecolorallocate</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xCC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3.填充颜色(注意：上面的第二步只是创建对应的颜色，第一个参数放画布是因为，画布分为rgb和真彩，所对应的rgb值有所不同)</span>
<span class="token function">imagefill</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> $bg_color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//4.生成验证码的字符</span>
$charCode<span class="token operator">=</span><span class="token string">"ZXCVBNMASDFGHJKLQWERTYUIOP23456789zxcvbnmkjhgfdsaqwertyuip"</span><span class="token punctuation">;</span>
$charCode_len<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>$charCode<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
$code<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">//最终生成的验证码</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>$i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>$index<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>$i<span class="token operator">&lt;</span>$index<span class="token punctuation">;</span>$i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 $code<span class="token punctuation">.</span>=$charCode<span class="token punctuation">[</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> $charCode_len<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//将code发布到session上用于页面核对验证码</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$_SESSION<span class="token punctuation">[</span><span class="token string">'vCode'</span><span class="token punctuation">]</span><span class="token operator">=</span>$code<span class="token punctuation">;</span>
<span class="token function">or</span><span class="token punctuation">(</span>$i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>$index<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>$i<span class="token operator">&lt;</span>$index<span class="token punctuation">;</span>$i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 <span class="token comment">//随机创建一个真彩色，用于添加到字体颜色</span>
 $fontColor<span class="token operator">=</span><span class="token function">imagecolorallocate</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">//设置字体的其他属性</span>
 <span class="token function">imagettftext</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span><span class="token comment">//作用的背景图</span>
   <span class="token number">16</span><span class="token punctuation">,</span><span class="token comment">//字体大小</span>
   <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//字体的倾斜角度</span>
   <span class="token number">16</span><span class="token operator">*</span>$i<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//字体再x、y轴上的浮动范围</span>
   $fontColor<span class="token punctuation">,</span>
   <span class="token string">'D:\php\http\Apache24\htdocs\Task345\fonts\SourceCodePro-Bold.ttf'</span><span class="token punctuation">,</span>
   $code<span class="token punctuation">[</span>$i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">/</span>设置干扰元素 小点点
<span class="token keyword">for</span><span class="token punctuation">(</span>$i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>$index<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>$i<span class="token operator">&lt;</span>$index<span class="token punctuation">;</span>$i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 $dotColor<span class="token operator">=</span><span class="token function">imagecolorallocate</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">imagesetpixel</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> $dotColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//设置干扰元素 线</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>$i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>$index<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span>$i<span class="token operator">&lt;</span>$index<span class="token punctuation">;</span>$i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 $lineColor<span class="token operator">=</span><span class="token function">imagecolorallocate</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">imageline</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> $lineColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//设置verifyCode.php文件的响应头类型，用于再html页面上引用验证码图</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Content-Type:image/gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//生成gif图</span>
<span class="token function">imagegif</span><span class="token punctuation">(</span>$canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><em>html页面调用</em></p> 
<pre><code class="prism language-java"><span class="token comment">//调用只需要将php文档放到图片链接里即可，需注意路径</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./verifyCode.php"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<p><strong>另外，在实际操作中需要核对验证码时，只需要利用$_SESSION来获取对应的数据</strong><br> 对应上例：</p> 
<pre><code class="prism language-java"><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">//获取用户填的验证码</span>
 $userVCode<span class="token operator">=</span><span class="token function">isset</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'captcha'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token function">trim</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'captcha'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">;</span>
 <span class="token comment">//判断验证码是否存在</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span>$_SESSION<span class="token punctuation">[</span><span class="token string">'vCode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"验证码以过期"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">//核对验证码</span>
 $vcode<span class="token operator">=</span>$_SESSION<span class="token punctuation">[</span><span class="token string">'vCode'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 <span class="token function">unset</span><span class="token punctuation">(</span>$_SESSION<span class="token punctuation">[</span><span class="token string">'vCode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用过后删除验证码</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strtolower</span><span class="token punctuation">(</span>$userVCode<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">=</span><span class="token function">strtolower</span><span class="token punctuation">(</span>$vcode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//函数strtolower()将所有字母转换成小写，变相不用区分大小写</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">'验证码输入错误'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4cfe68c50fe292866758ded4819f65b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【密码学】Base64 编码 ( Base64 简介 | Base64 编码原理 | 最后编码组字节不足时补位 ‘=‘ 符号 | Base64 编码实现参考 )</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a4117d7fe8d01915893f6082d9f42bc8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ElasticSearch十三--ES--自定义Analyzer分词器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>