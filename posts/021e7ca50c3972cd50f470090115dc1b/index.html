<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>coalesce函数的用法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="coalesce函数的用法" />
<meta property="og:description" content="coalesce函数的参数是列，结果是取出第一个不为空的列的数据。 postgre数据库中某个视图建立时使用: &#39;002&#39;::text || COALESCE(parent_id, &#39;&#39;::character varying)::text AS parent_id
把某棵树的parent_id置为002或者002&#43;数据表.parent_id(字段）
首先，建一个视图：
CREATE OR REPLACE VIEW v AS SELECT NULL AS c1,NULL AS c2,1 AS c3,NULL AS c4,2 AS c5,NULL AS c6 FROM dual UNION ALL SELECT NULL AS c1,NULL AS c2,NULL AS c3,3 AS c4,NULL AS c5,2 AS c6 FROM dual; 查看视图结果：
使用coalesce函数查结果：
SELECT COALESCE (c1,c2,c3,c4,c5,c6) AS c FROM v; 结果竟是：
难道coalesce函数不支持number类型？带着这个疑问，给转换一下，结果：
SELECT COALESCE (c1,c2,to_char(c3),to_char(c4),to_char(c5),to_char(c6)) AS c FROM v; 好像是真的，那么对date类型的支持呢？试一试" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/021e7ca50c3972cd50f470090115dc1b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-13T15:24:27+08:00" />
<meta property="article:modified_time" content="2018-12-13T15:24:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">coalesce函数的用法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3><span style="color:#f33b45;"><strong>coalesce函数的参数是列，结果是取出第一个不为空的列的数据。</strong></span></h3> 
<p><strong>postgre数据库中某个视图建立时使用: '002'::text || COALESCE(parent_id, ''::character varying)::text AS parent_id</strong></p> 
<p>把某棵树的parent_id置为002或者002+数据表.parent_id(字段）</p> 
<p>首先，建一个视图：</p> 
<pre class="has"><code>CREATE OR REPLACE VIEW v AS SELECT NULL AS c1,NULL AS c2,1 AS c3,NULL AS c4,2 AS c5,NULL AS c6 FROM dual UNION ALL SELECT NULL AS c1,NULL AS c2,NULL AS c3,3 AS c4,NULL AS c5,2 AS c6 FROM dual;
</code></pre> 
<p>查看视图结果：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/1a/5a/KBfDepf6_o.png"></p> 
<p>使用coalesce函数查结果：</p> 
<pre class="has"><code class="language-sql">SELECT COALESCE (c1,c2,c3,c4,c5,c6) AS c FROM v;
</code></pre> 
<p>结果竟是：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/37/fe/kwxJBSjH_o.jpg"></p> 
<p>难道coalesce函数不支持number类型？带着这个疑问，给转换一下，结果：</p> 
<pre class="has"><code>SELECT COALESCE (c1,c2,to_char(c3),to_char(c4),to_char(c5),to_char(c6)) AS c FROM v;
</code></pre> 
<p><br><img alt="" class="has" src="https://images2.imgbox.com/bf/73/qg58Msoo_o.png"></p> 
<p>好像是真的，那么对date类型的支持呢？试一试</p> 
<pre class="has"><code>CREATE OR REPLACE VIEW v AS
SELECT to_date('20150101','YYYYMMDD') AS c1,NULL AS c2,1 AS c3,NULL AS c4,2 AS c5,NULL AS c6 FROM dual
UNION ALL
SELECT NULL AS c1,NULL AS c2,NULL AS c3,3 AS c4,NULL AS c5,2 AS c6 FROM dual;
</code></pre> 
<p> </p> 
<p>结果竟然：</p> 
<p><br> 到这里就不禁要想，应该不是不支持某种数据类型，而是把第一列的数据类型，作为整个函数的数据类型了。</p> 
<p>这样试试就行了</p> 
<p>最后，既然coalesce函数里面是列，那么用*代表所有列行不行呢？</p> 
<p>显然是不行的。</p> 
<h3><span style="color:#f33b45;"><strong>总结：</strong></span></h3> 
<h3><span style="color:#f33b45;">1、coalesce函数是用来获取第一个不为空的列的值</span></h3> 
<h3><span style="color:#f33b45;">2、coalesce函数里面的数据类型，必须全部都跟第一列的数据类型一致</span></h3> 
<h3><span style="color:#f33b45;">3、CREATE OR REPLACE VIEW v AS SELECT NULL AS c FROM dual;这样建立的视图，列c的数据类型是char</span></h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b09169e50aa793141d9b109cd41910e5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java开发笔记（三十七）利用正则串分割字符串</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/422f78a92d404c57df6ad740098f18ea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在js还没有加载上来的时候，怎么给dom 绑定事件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>