<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VUE数据共享 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VUE数据共享" />
<meta property="og:description" content="父与子之间数据共享 父 =&gt; 子 属性绑定 父组件向子组件传值:v-bind属性绑定，子组件props接收
&lt;template&gt; &lt;div id=&#34;app&#34;&gt; &lt;school&gt;&lt;/school&gt; &lt;!--App props 配置方式 --&gt; &lt;student id=&#34;002&#34; name=&#34;小寻&#34; age=&#34;18&#34; sex=&#34;男&#34;&gt;&lt;/student&gt; &lt;student id=&#34;003&#34; name=&#34;老王&#34; sex=&#34;女&#34;&gt;&lt;/student&gt; &lt;/div&gt; &lt;/template&gt; &lt;template&gt; &lt;div id=&#34;student&#34;&gt; &lt;h2 &gt;学生ID:{{ id }}&lt;/h2&gt; &lt;h2&gt;学生姓名:{{ name }}&lt;/h2&gt; &lt;h2&gt;学生性别:{{ sex }}&lt;/h2&gt; &lt;h2&gt;学生年龄:{{ age }}&lt;/h2&gt; &lt;button @click=&#34;showName&#34;&gt;显示名称&lt;/button&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import {mixin} from &#39;../assets/js/mixin&#39; export default { name: &#34;student&#34;, data(){ return{} },mixins:[mixin], // 声明 接收app传递过来的数据 props:[&#39;id&#39;&#43;&#39;name&#39;&#43;&#39;sex&#39;&#43;&#39;age&#39;] } &lt;/script&gt; &lt;style scoped&gt; &lt;/style&gt; 子 =&gt; 父 事件绑定 子组件向父组件传值：v-on事件绑定" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6d7d7d71022bd3bffc57632371f31d56/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-25T20:36:14+08:00" />
<meta property="article:modified_time" content="2022-09-25T20:36:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VUE数据共享</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<h3>父与子之间数据共享</h3> 
<h4> <br> 父  =&gt;  子  属性绑定</h4> 
<p>父组件向子组件传值:v-bind属性绑定，子组件props接收</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div id="app"&gt;
  &lt;school&gt;&lt;/school&gt;
    &lt;!--App props 配置方式    --&gt;
    &lt;student id="002" name="小寻" age="18" sex="男"&gt;&lt;/student&gt;
    &lt;student id="003" name="老王" sex="女"&gt;&lt;/student&gt;
  &lt;/div&gt;
&lt;/template&gt;</code></pre> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div id="student"&gt;
    &lt;h2 &gt;学生ID:{<!-- -->{ id }}&lt;/h2&gt;
    &lt;h2&gt;学生姓名:{<!-- -->{ name }}&lt;/h2&gt;
    &lt;h2&gt;学生性别:{<!-- -->{ sex }}&lt;/h2&gt;
    &lt;h2&gt;学生年龄:{<!-- -->{ age }}&lt;/h2&gt;
    &lt;button @click="showName"&gt;显示名称&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import {mixin} from '../assets/js/mixin'

export default {
  name: "student",
  data(){
    return{}
  },mixins:[mixin],
  // 声明  接收app传递过来的数据
  props:['id'+'name'+'sex'+'age']
}
&lt;/script&gt;

&lt;style scoped&gt;

&lt;/style&gt;</code></pre> 
<h4><br> 子  =&gt;   父  事件绑定</h4> 
<p>子组件向父组件传值：v-on事件绑定</p> 
<pre><code class="language-html">&lt;!DOCTYPE html&gt;

&lt;html lang="en"&gt;

&lt;head&gt;

    &lt;meta charset="UTF-8"&gt;

    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;

    &lt;title&gt;Document&lt;/title&gt;

    &lt;script src="https://unpkg.com/vue/dist/vue.min.js"&gt;&lt;/script&gt;

&lt;/head&gt;

&lt;body&gt;

    &lt;div id="app"&gt;

        &lt;com1 @func123="show"&gt;

        &lt;/com1&gt;

    &lt;/div&gt;

    &lt;template id="mytemplate"&gt;

        &lt;div&gt;

            &lt;h1&gt;这是子组件的button&lt;/h1&gt;

            &lt;input type="button" value="click" @click="myclick"&gt;

        &lt;/div&gt;

    &lt;/template&gt;

    &lt;script&gt;

        var com1={

            template:'#mytemplate',

            data (){

                return{msg:'test'}

            },

            methods:{

                myclick(){

                    this.$emit('func123',123,'wetest')

                }

            }

        };

        var vm = new Vue({

            el:'#app',

            data:{

                name:'mj',age:28

            },

            methods:{

                show(data1,data2){

                    console.log("这是父组件的方法,参数："+data1+data2);

                }

            },

            components:{

                com1

            }

        }) 

    &lt;/script&gt;

&lt;/body&gt;

&lt;/html&gt;</code></pre> 
<h4><br> 父  &lt;=&gt;  子   组件上的v-model</h4> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div&gt;
      &lt;h1&gt;user-edit&lt;/h1&gt;
      &lt;input type="text" v-model="message"&gt;
      &lt;h2&gt;{<!-- -->{message}}&lt;/h2&gt;
  &lt;/div&gt;
&lt;/template&gt;
 
&lt;script&gt;
export default {
    name:'UserEdit',
    props:{
        message:{
            type:String
        }
    },
    data(){
        return{
            message:''
        }
    }
}
&lt;/script&gt;
 
&lt;style&gt;
 
&lt;/style&gt;</code></pre> 
<h3><br> 兄弟之间数据共享</h3> 
<h4> <br> EventBus</h4> 
<p>EventBus 称为事件总线</p> 
<p>兄弟组件之间共享数据 EventBus :$on接收数据，$emit发送数据</p> 
<p>关于 EventBus 在开发中经常会选择使用它来进行模块间通信、解耦。平常使用这个库只是很浅显的操作三部曲，register，post，unregister。来达到开发目的。始终有种不明确，模糊的操作感。因此准备对EventBus进行一个深入，全面的理解，消除模糊，片面感，让以后在使用这个库的时候，有更好的掌握和使用。并记录下来，方便以后查阅。关于EventBus会分两章进行记录，本篇文章，是对EventBus的使用做一个全面的介绍，另一篇文章则会对EventBus库的源码进行分析，看看他的实现原理是什么样的。</p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;学校名称：{<!-- -->{ name }}&lt;/h2&gt;
    &lt;h2&gt;学校地址：{<!-- -->{ address }}&lt;/h2&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import pubsub from 'pubsub-js'
export default {
  name: "School",
  data() {
    return {
      name: '法云寺',
      address: '山中山',
      pubId:''
    }
  }, methods: {
    myShowInfo(msg,data) {
      console.log("这是School组件,收到了数据:"+msg+data);
    }
  },
  mounted() { //钩子
    // this.$bus.$on('showInfo',this.myShowInfo)
    // console.log(this.$bus)

    // 订阅消息
    this.pubId=pubsub.subscribe('myShowInfo',this.myShowInfo);
  },beforeDestroy() {
      // this.$bus.$off('showInfo');
    pubsub.unsubscribe(this.pubId);
  }
}
&lt;/script&gt;</code></pre> 
<p></p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;学生姓名:{<!-- -->{ name }} &lt;/h2&gt;
    &lt;h2&gt;学生性别:{<!-- -->{ sex }} &lt;/h2&gt;
    &lt;button @click="sendStudentName"&gt;点我传递学生信息&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import pubsub from "pubsub-js";
export default {
  name: "Student",
  data() {
    return {
      name: '张三',
      sex: '男'
    }
  },methods:{
    sendStudentName(){
      //  $emit 触发事件   &gt;&gt;&gt; $emit(eventName)
      // this.$emit('showInfo',this.name);

      //提供数据
      pubsub.publish('myShowInfo',this.name);
    }

  }
}
&lt;/script&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</code></pre> 
<p>也有用缓存来传值的，比如sessionStorage.localStorage等</p> 
<h3><br> 后代之间数据共享</h3> 
<h4><br> provide和inject</h4> 
<p>现在我存在两个父子组件，相互之间嵌套了很多层，想要父组件中的方法。之前是通过$parent去实现的，现在我准备使用provide和inject实现<br>  </p> 
<p>在父组件中provide<br> 因为我是想要调用父组件中的showTopic方法，所以在provide中返回这个方法即可<br> 代码如下：</p> 
<pre><code class="language-javascript">provide() { return { showTopic: this.showTopic, } },</code></pre> 
<p>在子组件中inject<br> 在定义data的上方，插入代码inject</p> 
<pre><code class="language-javascript">inject:["showTopic"],</code></pre> 
<p> 尝试调用</p> 
<pre><code class="language-javascript">async testCase(){
console.log('修改的Id ', this.topicId)

const dataTest = await api.test.test({

    accountId: window. localStorage.getItem( ' accountId '),topicId: this.topicId,
    topicId：this.topicId，
    topicTypeId: this.selectTopic.topicTypeId,})

if (dataTest.code === 200){
    this.showTopic(this.topicId)
}},</code></pre> 
<p>但是一旦页面上有多个组件控制某个属性变化时，其余组件都要跟着变化时，这个时候用上述方式就过于繁琐，这个时候用vuex数据共享解决，就不用反复传值。</p> 
<h3><br> 全局数据共享</h3> 
<p><br> vuex<img alt="" height="551" src="https://images2.imgbox.com/f3/2b/FrgvDvwb_o.png" width="701"></p> 
<p>vuex数据共享的优势：</p> 
<p>1.能够在vuex中集中管理共享的数据，便于后续维护和开发（所有共享的数据都可以放在一块）</p> 
<p>2.能够高效地统筹组件之间的数据共享，提高开发效率</p> 
<p>3存储在vuex中的数据都是响应式的，能够实时保持数据与页面的同步</p> 
<p>当然vuex也有其劣势，在一个页面重新渲染或者刷新页面时，vuex里面更新的数据会回复初始值</p> 
<p>vuex的简单使用</p> 
<p> <strong>安装</strong></p> 
<p><img alt="" height="172" src="https://images2.imgbox.com/6b/83/dzfxf2HK_o.png" width="982"></p> 
<p> 创建 store 的index.js文件</p> 
<pre><code class="language-javascript">import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex);

//准备三个对象
const actions = {
    addOdd(context, value) {
        console.log('进入了actions的addOdd，value：' + value);
        context.commit('ADDODD', value);
    },
    addWait(context, value) {
        console.log('进入了actions的addWait，value：' + value);
        context.commit('ADDWAIT', value);
    }
}
const mutations = {
    JIA(state, value) {
        console.log('进入了mutations的 JIA，value：' + value);
        state.sum += value;
    },
    JIAN(state, value) {
        console.log('进入了mutations的 JIAN，value：' + value);
        state.sum -= value;
    },
    ADDODD(state, value) {
        console.log('进入了mutations的 ADDODD，value：' + value);
        if (state.sum % 2) {
            state.sum += value;
        }
    },
    ADDWAIT(state, value) {
        console.log('进入了mutations的 ADDWAIT，value：' + value);
        window.setTimeout(() =&gt; {
            state.sum += value;
        }, 1000);
    }
}
// 准备 state 对象  用于保存具体的数据 (初始化数据存放：变量)
const state = {sum: 0,
    schoolName:'家里蹲'
}

// 准备getters 用于将state中的数据进行再次加工
const getters = {
    bigSum() {
        return state.sum * 10;
    }
}

// 创建并公开
export default new Vuex.Store({
    actions,
    mutations,
    state,
    getters
});
</code></pre> 
<p></p> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;当前求和结果为:{<!-- -->{ sum }}&lt;/h2&gt;
    &lt;h2&gt;当前的求和内容放大10倍：{<!-- -->{ bigSum }}&lt;/h2&gt;
    &lt;h2&gt;{<!-- -->{ schoolName }}&lt;/h2&gt;
    &lt;select v-model.number="n"&gt;
      &lt;option value="1"&gt;1&lt;/option&gt;
      &lt;option value="2"&gt;2&lt;/option&gt;
      &lt;option value="3"&gt;3&lt;/option&gt;
    &lt;/select&gt;
    &lt;button @click="increment(n)"&gt;
      +
    &lt;/button&gt;

    &lt;button @click="decrement(n)"&gt;
      -
    &lt;/button&gt;
    &lt;button @click="incrementOdd(n)"&gt;
      求和为奇数在加
    &lt;/button&gt;
    &lt;button @click="incrementWait(n)"&gt;
      延迟在加
    &lt;/button&gt;
  &lt;/div&gt;

&lt;/template&gt;

&lt;script&gt;
//map
import {mapState,mapGetters,mapActions,mapMutations} from 'vuex'
export default {
  name: "Count",
  data(){
    return{
      n:1
    }
  },methods:{
    ...mapMutations({
      increment:'JIA',
      decrement:'JIAN',
      incrementOdd:'ADDODD',
      incrementWait:'ADDWAIT'
    })
  },computed:{
      ...mapState(['sum','schoolName']),
      ...mapGetters(['bigSum'])
  }
}
&lt;/script&gt;

&lt;style scoped&gt;

&lt;/style&gt;</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/641f4a8eb83e70090089d07575949c2a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">KNN海伦约会</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b19974415a84578ec1a8ebd3fd03f015/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图片格式，内联框架，音视频的插入播放</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>