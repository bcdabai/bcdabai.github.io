<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python计算结果传给spark_python将csv数据发送到spark streaming - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python计算结果传给spark_python将csv数据发送到spark streaming" />
<meta property="og:description" content="我想尝试在python中加载一个csv数据，并通过spark流来流化每一行spark。在
我对网络很陌生。如果我要创建一个服务器python脚本，一旦它建立了连接(使用spark streaming)，它就会开始发送每一行。在Spark流媒体文档中，他们做了一个nc-l9999，如果im正确，这是一个netcat服务器监听9999端口。所以我尝试创建一个类似的python脚本来解析csv并发送到60000端口import socket # Import socket module
import csv
port = 60000 # Reserve a port for your service.
s = socket.socket() # Create a socket object
host = socket.gethostname() # Get local machine name
s.bind((host, port)) # Bind to the port
s.listen(5) # Now wait for client connection.
print(&#39;Server listening....&#39;)
while True:
conn, addr = s.accept() # Establish connection with client.
print(&#39;Got connection from&#39;, addr)
csvfile = open(&#39;Titantic." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2010ec2f7b4c2ca9c36e807b73cf6b00/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-30T02:28:16+08:00" />
<meta property="article:modified_time" content="2021-01-30T02:28:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python计算结果传给spark_python将csv数据发送到spark streaming</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>我想尝试在python中加载一个csv数据，并通过spark流来流化每一行spark。在</p> 
 <p>我对网络很陌生。如果我要创建一个服务器python脚本，一旦它建立了连接(使用spark streaming)，它就会开始发送每一行。在Spark流媒体文档中，他们做了一个nc-l9999，如果im正确，这是一个netcat服务器监听9999端口。所以我尝试创建一个类似的python脚本来解析csv并发送到60000端口import socket # Import socket module</p> 
 <p>import csv</p> 
 <p>port = 60000 # Reserve a port for your service.</p> 
 <p>s = socket.socket() # Create a socket object</p> 
 <p>host = socket.gethostname() # Get local machine name</p> 
 <p>s.bind((host, port)) # Bind to the port</p> 
 <p>s.listen(5) # Now wait for client connection.</p> 
 <p>print('Server listening....')</p> 
 <p>while True:</p> 
 <p>conn, addr = s.accept() # Establish connection with client.</p> 
 <p>print('Got connection from', addr)</p> 
 <p>csvfile = open('Titantic.csv', 'rb')</p> 
 <p>reader = csv.reader(csvfile, delimiter = ',')</p> 
 <p>for row in reader:</p> 
 <p>line = ','.join(row)</p> 
 <p>conn.send(line)</p> 
 <p>print(line)</p> 
 <p>csvfile.close()</p> 
 <p>print('Done sending')</p> 
 <p>conn.send('Thank you for connecting')</p> 
 <p>conn.close()</p> 
 <p>SPark流脚本-</p> 
 <p>^{pr2}$</p> 
 <p>当运行spark脚本(这是在Jupyter笔记本电脑btw)我得到这个错误-</p> 
 <p>IllegalArgumentException:“要求失败：未注册输出操作，因此没有要执行的内容”</p> 
 <p>我不认为我做了我的套接字脚本，但我真的不知道该怎么做我基本上尝试复制nc-lk 9999的功能，这样我就可以通过端口发送文本数据，然后spark streaming正在监听它并接收数据并处理它。在</p> 
 <p>任何帮助都将不胜感激</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/75fb7a2db9b40f4ac7c6553e744a17a4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu 18.04.4 卸载 php7并安装php5.6</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d44245d1d8dec70681732787afaa6b3d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python语言func_python中func什么意思</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>