<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zabbix6.0.5在lnmp环境上安装 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zabbix6.0.5在lnmp环境上安装" />
<meta property="og:description" content="NGINX：
#创建nginxyum仓库 vim /etc/yum.repos.d/nginx.repo [nginx-stable] name=nginx stable repo baseurl=http://nginx.org/packages/centos/7/$basearch/ gpgcheck=0 enabled=1 #清空缓存 yum clean all #安装依赖 yum -y install openssl-devel libxml2 libxml2-devel net-snmp-devel libevent-devel java-devel net-snmp-devel libcurl-devel #安装nginx yum install nginx -y #查看版本 nginx -v MySQL：
上传MySQL的rpm包到/opt:
在百度网盘 提取码：asje
依次安装：
rpm -ivh mysql-community-common-8.0.32-1.el7.x86_64.rpm rpm -ivh mysql-community-client-plugins-8.0.32-1.el7.x86_64.rpm rpm -ivh mysql-community-libs-8.0.32-1.el7.x86_64.rpm rpm -ivh mysql-community-client-8.0.32-1.el7.x86_64.rpm rpm -ivh mysql-community-icu-data-files-8.0.32-1.el7.x86_64.rpm rpm -ivh mysql-community-server-8.0.32-1.el7.x86_64.rpm rpm -ivh mysql-community-libs-compat-8.0.32-1.el7.x86_64.rpm 开启mysql
systemctl enable mysqld --now 查看版本：
mysql -V 如出现以下错误：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7801b2e51ade8848023b683958349654/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-08T19:29:12+08:00" />
<meta property="article:modified_time" content="2023-03-08T19:29:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zabbix6.0.5在lnmp环境上安装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>NGINX：</p> 
<pre><code class="language-bash">#创建nginxyum仓库
vim /etc/yum.repos.d/nginx.repo

[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/7/$basearch/
gpgcheck=0
enabled=1

#清空缓存
yum clean all

#安装依赖
yum -y install openssl-devel libxml2 libxml2-devel net-snmp-devel libevent-devel java-devel net-snmp-devel libcurl-devel

#安装nginx
yum install nginx -y 

#查看版本
nginx -v</code></pre> 
<p><img alt="" height="94" src="https://images2.imgbox.com/c8/39/8O4RK2wf_o.png" width="543"></p> 
<p></p> 
<p>MySQL：</p> 
<p>上传MySQL的rpm包到/opt:</p> 
<p><img alt="" height="593" src="https://images2.imgbox.com/e1/2f/m6DnbVD3_o.png" width="1164"></p> 
<p></p> 
<p>在<a class="link-info" href="https://pan.baidu.com/s/1q0hfzlCh0M_Zvv4UOrtySw" rel="nofollow" title="百度网盘">百度网盘</a>        提取码：asje</p> 
<p>依次安装：</p> 
<pre><code class="language-bash">rpm -ivh  mysql-community-common-8.0.32-1.el7.x86_64.rpm 

rpm -ivh  mysql-community-client-plugins-8.0.32-1.el7.x86_64.rpm 

rpm -ivh mysql-community-libs-8.0.32-1.el7.x86_64.rpm 

rpm -ivh mysql-community-client-8.0.32-1.el7.x86_64.rpm 

rpm -ivh mysql-community-icu-data-files-8.0.32-1.el7.x86_64.rpm 

rpm -ivh mysql-community-server-8.0.32-1.el7.x86_64.rpm 

rpm -ivh mysql-community-libs-compat-8.0.32-1.el7.x86_64.rpm </code></pre> 
<p>开启mysql</p> 
<pre><code class="language-bash">systemctl enable mysqld --now</code></pre> 
<p> 查看版本：</p> 
<pre><code class="language-bash">mysql -V
</code></pre> 
<p><img alt="" height="89" src="https://images2.imgbox.com/f5/ec/XpXJI2Gq_o.png" width="1200"></p> 
<p>如出现以下错误：</p> 
<p>错误</p> 
<p><img alt="" height="236" src="https://images2.imgbox.com/f4/76/3X1fDRoo_o.png" width="1200"></p> 
<blockquote> 
 <p> yum -y remove mysql-lib mariadb</p> 
</blockquote> 
<p>删除后重新装mysql-community-libs-8.0.32-1.el7.x86_64.rpm </p> 
<p>优化MySQL</p> 
<p>查看MySQL初始密码（mysql8.0版本后都有初始密码） </p> 
<pre><code class="language-bash">grep "password" /var/log/mysqld.log | awk '{print $NF}'</code></pre> 
<p><img alt="" height="365" src="https://images2.imgbox.com/f4/3d/CKbeNCCX_o.png" width="1200"></p> 
<pre><code class="language-bash">mysqladmin -uroot -p password

#写刚刚查看的密码
Enter password:

#新的密码             
New password:

#确认密码 
Confirm new password: </code></pre> 
<p><img alt="" height="323" src="https://images2.imgbox.com/c4/79/3EL4UWVD_o.png" width="1200">登录<img alt="" height="601" src="https://images2.imgbox.com/4d/f0/ni6Nk6TW_o.png" width="1200"></p> 
<p> PHP部分： </p> 
<pre><code class="language-bash">#获取rpm包
rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm

#安装PHP
yum -y install php72w php72w-cli php72w-common php72w-devel php72w-embedded php72w-gd php72w-mbstring php72w-pdo php72w-xml php72w-fpm php72w-mysqlnd php72w-opcache  php72w-redis

#开启PHP
systemctl enable php-fpm --now

#查看版本
php -v</code></pre> 
<p><img alt="" height="206" src="https://images2.imgbox.com/0b/ea/iNTQq9EL_o.png" width="1200"></p> 
<p>安装zabbix6.0.5</p> 
<p>上传包</p> 
<p><img alt="" height="91" src="https://images2.imgbox.com/7a/55/qSgf8BGs_o.png" width="680"></p> 
<pre><code class="language-bash">#解包
tar zxvf zabbix-6.0.5.tar.gz 

#进入zabbix-6.0.5
cd zabbix-6.0.5/

#安装（容易报错，报错信息在下面）
./configure --prefix=/usr/local/zabbix --enable-server --enable-agent --with-mysql --enable-ipv6 --with-net-snmp --with-libcurl --with-libxml2

#编译安装
make &amp;&amp; make install
</code></pre> 
<p>如果报一下错误</p> 
<p>错误一：</p> 
<p><img alt="" height="123" src="https://images2.imgbox.com/d5/1d/84mvooeE_o.png" width="822"></p> 
<p>解决方法</p> 
<pre><code class="language-bash">rpm -ivh /opt/mysql-community-devel-8.0.32-1.el7.x86_64.rpm </code></pre> 
<p> 错误二：</p> 
<p><img alt="" height="284" src="https://images2.imgbox.com/00/12/vDLyawpf_o.png" width="1200"></p> 
<p>或</p> 
<p><img alt="" height="143" src="https://images2.imgbox.com/dd/fd/u1vLHvu7_o.png" width="945"></p> 
<p> </p> 
<p> 解决方法：</p> 
<pre><code class="language-bash">#这个包在mysql-8.0的文件夹
rpm -ivh /opt/libevent-devel-2.0.21-4.el7.x86_64.rpm 

yum -y install /opt/libevent-devel-2.0.21-4.el7.x86_64.rpm 

yum install -y net-snmp-devel</code></pre> 
<p>编译完成后进入mysql</p> 
<pre><code class="language-bash">#进入数据库
mysql -uroot -pNihao123!	

#创建zabbix库
create database zabbix character set utf8 collate utf8_bin;

#进入zabbix库
use zabbix

#导入zabbix数据（在zabbix安装包内）
source /root/zabbix-6.0.5/database/mysql/schema.sql;
source /root/zabbix-6.0.5/database/mysql/images.sql;
source /root/zabbix-6.0.5/database/mysql/data.sql;

#创建用户 
create user zabbix@'192.168.100.%' identified by "Nihao123!";

#授权
grant all on zabbix.* to zabbix@'192.168.100.%' with grant option;

#刷新权限
flush privileges;

exit</code></pre> 
<pre><code class="language-bash">#创建组
groupadd zabbix

#创建用户
useradd -r -g zabbix zabbix

#创建目录
mkdir /usr/local/zabbix/logs

#更改权限
chown zabbix:zabbix /usr/local/zabbix/ -R </code></pre> 
<p> zabbix-server</p> 
<pre><code class="language-bash">编辑zabbix-server的配置文件
vim /usr/local/zabbix/etc/zabbix_server.conf

#清除注释行和空行
:%g/^#/d
:%g/^$/d

#修改
LogFile=/usr/local/zabbix/logs/zabbix_server.log
PidFile=/tmp/zabbix_server.pid
DBHost=192.168.100.5
DBName=zabbix
DBUser=zabbix
DBPassword=Nihao123!
DBSocket=/var/lib/mysql/mysql.sock
Include=/usr/local/zabbix/etc/zabbix_server.conf.d/*.conf
LogSlowQueries=3000
StatsAllowedIP=127.0.0.1,192.168.100.0/24



                                                                                            
</code></pre> 
<p>zabbix-agent</p> 
<pre><code class="language-bash">#编辑zabbix-agent配置文件
vim /usr/local/zabbix/etc/zabbix_agentd.conf

#清除注释行和空行
:%g/^#/d
:%g/^$/d

#修改
PidFile=/tmp/zabbix_agentd.pid
Server=192.168.100.5
Hostname=server.zabbix.com
LogFile=/usr/local/zabbix/logs/zabbix_agentd.log
Include=/usr/local/zabbix/etc/zabbix_agentd.conf.d/*.conf</code></pre> 
<p>启动查看</p> 
<pre><code class="language-bash">/usr/local/zabbix/sbin/zabbix_server
/usr/local/zabbix/sbin/zabbix_agentd
netstat -utpln |grep 10051
netstat -utpln |grep 10050</code></pre> 
<p><img alt="" height="478" src="https://images2.imgbox.com/f7/f4/8dWnRQQx_o.png" width="1200"></p> 
<p> 编辑nginx配置文件</p> 
<pre><code class="language-bash">vim /etc/nginx/conf.d/default.conf 

#修改第九行
location / {
          root   /usr/share/nginx/html;
          index  index.html index.htm index.php;
      }


#在36行插入
location ~ \.php$ {
        root           html;
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html$fastcgi_script_name;  
        include        fastcgi_params;
    }


#重启nginx
systemctl restart nginx


</code></pre> 
<p> 配置页面</p> 
<pre><code class="language-bash">#将zabbix页面移到nginx页面路径中
mv /root/zabbix-6.0.5/ui /usr/share/nginx/html/zabbix

#修改权限
chown -R nginx:nginx /usr/share/nginx/html/zabbix/
chown -R nginx:nginx /var/lib/php/session

</code></pre> 
<p>编辑php文件</p> 
<pre><code class="language-bash"> vi /etc/php.ini

#878行添加
date.timezone = Asia/Shanghai

#368行修改
max_execution_time = 300

#378行修改
max_input_time = 300

#656行修改
post_max_size = 32M


</code></pre> 
<p>php配置完成后重启PHP</p> 
<pre><code class="language-bash">systemctl restart php-fpm</code></pre> 
<p></p> 
<p>浏览器访问</p> 
<p><img alt="" height="930" src="https://images2.imgbox.com/56/e8/Vcfm7N8f_o.png" width="1200"></p> 
<p>看到有报错</p> 
<p><img alt="" height="937" src="https://images2.imgbox.com/71/59/FbtHStdZ_o.png" width="1200"></p> 
<p> 安装后重启php，刷新</p> 
<pre><code class="language-bash">yum -y install php-bcmath</code></pre> 
<p><img alt="" height="979" src="https://images2.imgbox.com/01/e9/P6348V1x_o.png" width="1200"></p> 
<p><img alt="" height="946" src="https://images2.imgbox.com/6f/e3/1Lqb46Ls_o.png" width="1200"></p> 
<p> 又报错</p> 
<p><img alt="" height="957" src="https://images2.imgbox.com/fc/0b/zBJB4piK_o.png" width="1200">解决方法</p> 
<pre><code class="language-bash">#修改配置文件
vi /etc/my.cnf
 
#在mysqld中插入一行
[mysqld]
default-authentication-plugin=mysql_native_password
 
#重启mysqld
systemctl restart mysqld
 
#进入mysql
mysql -u root -pNihao123!
 
#进入mysql库
use mysql
 
#修改授权
ALTER USER 'zabbix'@'192.168.100.%' IDENTIFIED WITH mysql_native_password BY 'Nihao123!';
 
#刷新权限
flush privileges;
 
 
 </code></pre> 
<p> 刷新页面</p> 
<p>主机名称随便写 </p> 
<p><img alt="" height="908" src="https://images2.imgbox.com/33/04/0iV2DbWE_o.png" width="1200"> 这个 报错点击下载配置文件，然后上传到/usr/share/nginx/html/zabbix/conf/<img alt="" height="942" src="https://images2.imgbox.com/16/59/vqMZYirg_o.png" width="1200"></p> 
<p><img alt="" height="412" src="https://images2.imgbox.com/2f/76/H1ZxQmJG_o.png" width="1200"></p> 
<p> 刷新页面</p> 
<p><img alt="" height="920" src="https://images2.imgbox.com/f8/0d/A3kocTOD_o.png" width="1200"></p> 
<p> 默认的账号密码</p> 
<p>账号：Admin</p> 
<p>密码：zabbix</p> 
<p><img alt="" height="836" src="https://images2.imgbox.com/a4/7c/iAGyi0r4_o.png" width="902"></p> 
<p> 有一个问题，就是在图形中有乱码</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/ab/db/clLVXn8k_o.png" width="1200"></p> 
<p>解决方法</p> 
<p>在/usr/share/nginx/html/zabbix/assets/fonts/中，将原有的.ttf文件改名，再将自己准备的.ttf文件上传到此目录，并把名称改为原有.ttf的名称，这个.ttf文件我放到了mysql-8.0的文件夹里了</p> 
<p><img alt="" height="567" src="https://images2.imgbox.com/7a/7f/kJurQ4qi_o.png" width="1200"></p> 
<p>刷新一下页面就OK了 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0e/b9/972Tk5wb_o.png" width="1200"></p> 
<p></p> 
<p>监控自己：</p> 
<p></p> 
<p>配置-》主机-》创建主机 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/c0/03/QnzNbrNJ_o.png" width="1200"></p> 
<p><img alt="" height="924" src="https://images2.imgbox.com/a7/20/eEWDIays_o.png" width="1200"></p> 
<p><img alt="" height="206" src="https://images2.imgbox.com/11/a7/J02l3oRh_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/36/44/EZrUEkNM_o.png" width="1200"></p> 
<p>  如果mysql在监控时没有数据</p> 
<pre><code class="language-bash">#在MySQL数据库中创建监控账号并授权
CREATE USER 'zabbix'@'%'IDENTIFIED BY 'Nihao123!';
GRANT USAGE,REPLICATION CLIENT,PROCESS,SHOW DATABASES,SHOW VIEW ON *.* TO 'zabbix'@'%';
flush privileges;

#创建目录
mkdir -p /var/lib/zabbix
#写入用户名和密码
vi /var/lib/zabbix/.my.cnf

[client]
user=zabbix
password=Nihao123!
socket=/var/lib/mysql/mysql.sock
 
[mysql]
user=zabbix
password=Nihao123!
socket=/var/lib/mysql/mysql.sock
 
[mysqladmin]
user=zabbix
password=Nihao123!
socket=/var/lib/mysql/mysql.sock

#修改zabbix目录权限
chown zabbix:zabbix /var/lib/zabbix -R
</code></pre> 
<pre><code class="language-bash">cd /root/zabbix-6.0.5/conf/zabbix_agentd/
vim userparameter_mysql.conf

</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/07/9e/DMuveSy3_o.png" width="1200"></p> 
<pre><code class="language-bash">vi /usr/local/zabbix/etc/zabbix_agentd.conf</code></pre> 
<p><img alt="" height="298" src="https://images2.imgbox.com/a8/0b/i13aVAvf_o.png" width="1149"></p> 
<pre><code class="language-bash">rm -rf /root/zabbix-6.0.5/conf/zabbix_agentd/userparameter_examples.conf

#重启zabbix_agent
killall -9 zabbix_agentd

/usr/local/zabbix/sbin/zabbix_agentd </code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/30/00/xljgNlnG_o.png" width="1200"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2046e4d996328df24c4de34644d05b52/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">dayjs使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b228123937769ef8b06168f75123b0c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">zabbix6.0.5在lamp中部署教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>