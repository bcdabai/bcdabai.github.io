<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>关于vue中使用indexDB的总结 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="关于vue中使用indexDB的总结" />
<meta property="og:description" content="老规矩，先挂官网链接
https://www.npmjs.com/package/idb-js
关于indexDB 是什么，用到什么地方我就不再解释，百度多得很，只说我在使用的过程中的一些问题
官网解释：
引入及简单使用 安装：
npm install idb-js --save 使用：
第一步：引入db import Idb from &#39;idb-js&#39; // 引入Idb 第二步：引入数据库配置 import db_student_config from &#39;./db_student_config&#39; 第三步：载入配置，数据库开启成功拿到数据库实例进行操作 Idb(db_student_config).then(student_db =&gt; {...}) 数据库实例 db 方法 （拣选几条常用）
close_db - 关闭数据库delete_db - 删除数据库clear_table - 清空某张表的数据insert - 添加单条或者多条数据query - 查询匹配到的数据queryAll - 查询某张表的所有数据delete - 删除数据update - 修改数据 官网举例 数据库配置
// in db_student_config.js export default { dbName: &#34;student&#34;, // *数据库名称 version: 1, // 数据库版本号（默认为当前时间戳） tables: [ // *数据库的表，即ObjectStore { tableName: &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/51197136964121afaec898a106405913/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-16T11:05:23+08:00" />
<meta property="article:modified_time" content="2021-08-16T11:05:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">关于vue中使用indexDB的总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>老规矩，先挂官网链接<br> <a href="https://www.npmjs.com/package/idb-js" rel="nofollow">https://www.npmjs.com/package/idb-js</a></p> 
<p>关于indexDB 是什么，用到什么地方我就不再解释，百度多得很，只说我在使用的过程中的一些问题</p> 
<p>官网解释：<br> <img src="https://images2.imgbox.com/81/57/AlmyNmda_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_7"></a>引入及简单使用</h3> 
<p><strong>安装：</strong></p> 
<pre><code class="prism language-javascript">npm install idb<span class="token operator">-</span>js <span class="token operator">--</span>save
</code></pre> 
<p><strong>使用：</strong></p> 
<ul><li>第一步：引入db</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> Idb <span class="token keyword">from</span> <span class="token string">'idb-js'</span>  <span class="token comment">//  引入Idb</span>
</code></pre> 
<ul><li>第二步：引入数据库配置</li></ul> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> db_student_config <span class="token keyword">from</span> <span class="token string">'./db_student_config'</span>
</code></pre> 
<ul><li>第三步：载入配置，数据库开启成功拿到数据库实例进行操作</li></ul> 
<pre><code class="prism language-javascript"><span class="token function">Idb</span><span class="token punctuation">(</span>db_student_config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">student_db</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_db__34"></a>数据库实例 db 方法</h3> 
<p>（拣选几条常用）</p> 
<ul><li>close_db - 关闭数据库</li><li>delete_db - 删除数据库</li><li>clear_table - 清空某张表的数据</li><li>insert - 添加单条或者多条数据</li><li>query - 查询匹配到的数据</li><li>queryAll - 查询某张表的所有数据</li><li>delete - 删除数据</li><li>update - 修改数据</li></ul> 
<h3><a id="_46"></a>官网举例</h3> 
<p><strong>数据库配置</strong></p> 
<pre><code class="prism language-javascript"> <span class="token comment">// in db_student_config.js</span>

    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
        dbName<span class="token operator">:</span> <span class="token string">"student"</span><span class="token punctuation">,</span>                          <span class="token comment">// *数据库名称</span>
        version<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>                                 <span class="token comment">// 数据库版本号（默认为当前时间戳）</span>
        tables<span class="token operator">:</span> <span class="token punctuation">[</span>                                   <span class="token comment">// *数据库的表，即ObjectStore</span>
            <span class="token punctuation">{<!-- --></span>
                tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>                 <span class="token comment">// *表名</span>
                option<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> keyPath<span class="token operator">:</span> <span class="token string">"id"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>          <span class="token comment">// 表配置，即ObjectStore配置，此处指明主键为id</span>
                indexs<span class="token operator">:</span> <span class="token punctuation">[</span>                           <span class="token comment">// 数据库索引（建议加上索引）</span>
                    <span class="token punctuation">{<!-- --></span>
                        key<span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>                  <span class="token comment">// *索引名</span>
                        option<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>                    <span class="token comment">// 索引配置，此处表示该字段不允许重复</span>
                            unique<span class="token operator">:</span> <span class="token boolean">true</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{<!-- --></span>
                        key<span class="token operator">:</span> <span class="token string">"name"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{<!-- --></span>
                        key<span class="token operator">:</span> <span class="token string">"score"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                tableName<span class="token operator">:</span> <span class="token string">"info"</span><span class="token punctuation">,</span>                      <span class="token comment">// *表名 另外一张表，同理</span>
                option<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> keyPath<span class="token operator">:</span> <span class="token string">"id"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                indexs<span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{<!-- --></span>
                        key<span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>
                        option<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
                            unique<span class="token operator">:</span> <span class="token boolean">true</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{<!-- --></span>
                         key<span class="token operator">:</span> <span class="token string">"name"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{<!-- --></span>
                         key<span class="token operator">:</span> <span class="token string">"age"</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{<!-- --></span>
                         key<span class="token operator">:</span> <span class="token string">"sex"</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>使用：</strong></p> 
<pre><code class="prism language-javascript"><span class="token comment">// 载入数据配置，数据库开启成功后会拿到db来对数据库进行操作</span>

    <span class="token keyword">import</span> Idb <span class="token keyword">from</span> <span class="token string">'idb-js'</span>  <span class="token comment">//  引入Idb</span>
    <span class="token keyword">import</span> db_student_config <span class="token keyword">from</span> <span class="token string">'./db_student_config'</span>   <span class="token comment">//  引入数据库配置</span>

    <span class="token function">Idb</span><span class="token punctuation">(</span>db_student_config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">student_db</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>     <span class="token comment">//  载入配置，数据库开启成功后返回该数据库实例</span>

       <span class="token comment">/**
        * @method close_db 关闭此数据库
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">close_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">/**
        * @method delete_db 删除此数据库
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">delete_db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">/**
        * @method 增加单条数据
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
                data<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    score<span class="token operator">:</span> <span class="token number">98</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">"小明"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"添加成功"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
       
       <span class="token comment">/**
        * @method 增加多条数据
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
                data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
                    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    score<span class="token operator">:</span> <span class="token number">98</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">"小明"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>
                    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    score<span class="token operator">:</span> <span class="token number">99</span><span class="token punctuation">,</span>
                    name<span class="token operator">:</span> <span class="token string">"小方"</span>
                <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"添加成功"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">/**
        * @method 查询数据（游标）
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
            <span class="token function-variable function">condition</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>score <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
       
        <span class="token comment">/**
        * @method 修改数据
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
            <span class="token function-variable function">condition</span><span class="token operator">:</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'小明'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">handle</span><span class="token operator">:</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                r<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"修改成功"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        


       <span class="token comment">/**
        * @method 删除数据
        * */</span>

        student_db<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
          <span class="token function-variable function">condition</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'小明'</span><span class="token punctuation">,</span>
          <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"删除成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



        <span class="token comment">/**
        * @method 查询某张表的所有数据
        * */</span>
        student_db<span class="token punctuation">.</span><span class="token function">queryAll</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



        <span class="token comment">/**
        * @method 根据主键查询某条数据
        * */</span>
        student_db<span class="token punctuation">.</span><span class="token function">query_by_primaryKey</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span><span class="token string">'grade'</span><span class="token punctuation">,</span>
            target<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>


        <span class="token comment">/**
        * @method 根据索引查询某条数据
        * */</span>
        student_db<span class="token punctuation">.</span><span class="token function">query_by_index</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span><span class="token string">'grade'</span><span class="token punctuation">,</span>
            indexName<span class="token operator">:</span><span class="token string">'name'</span><span class="token punctuation">,</span>
            target<span class="token operator">:</span><span class="token string">'小明'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">/**
        * @method 清空某张表的数据
        * */</span>
        student_db<span class="token punctuation">.</span><span class="token function">clear_table</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span><span class="token string">'grade'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">/**
        * @method 通过主键删除某条数据
        * */</span>
        student_db<span class="token punctuation">.</span><span class="token function">delete_by_primaryKey</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span><span class="token string">'grade'</span><span class="token punctuation">,</span>
            target<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除成功'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>


        <span class="token comment">/**
        * @method 通过主键更改某条数据
        * */</span>
        student_db<span class="token punctuation">.</span><span class="token function">update_by_primaryKey</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            tableName<span class="token operator">:</span> <span class="token string">"grade"</span><span class="token punctuation">,</span>
            target<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token function-variable function">handle</span><span class="token operator">:</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_267"></a>自用问题总结</h3> 
<p><strong>自用配置文件：</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  dbName<span class="token operator">:</span> <span class="token string">'peopleInfo'</span><span class="token punctuation">,</span>
  verison<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  tables<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
      tableName<span class="token operator">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token comment">// 表名</span>
      option<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        keyPath<span class="token operator">:</span> <span class="token string">'id'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 表配置</span>
      indexs<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          key<span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            unique<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
          key<span class="token operator">:</span> <span class="token string">'colCard'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            unique<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
          key<span class="token operator">:</span> <span class="token string">'colName'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
          key<span class="token operator">:</span> <span class="token string">'colPhone'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
          key<span class="token operator">:</span> <span class="token string">'type'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>问题：关于option: { keyPath: ‘id’ } 报错问题</li></ul> 
<p>这个也算是个遗留问题，刚开始看文档说明是主键就可以，根据数据库知识，主键叫啥名字都可以，所以我写成了 colCard 的字段，也就是身份证号，配置文件中就写成了 { keyPath: ‘colCard’ }，但是一直报错。<br> 后面没办法就还是写成了 id ，并且把数据序号 index 存成了 id。就成功了，置于为啥报错，这是不是最简洁的修改方式，欢迎大家跟我交流。</p> 
<ul><li>问题： 关于全局使用 idb 的问题</li></ul> 
<p>我们看到官网只是引入了，直接使用，根据官网代码我们看到 idb 是个异步的东西，直觉类似于 axios。<br> 此时我们想要全局使用，就可以参考 axios 的全局使用方式，进行全局封装。<br> 但是为了方便我没有封装，只是简单全局引入了一下，使用 then 进行处理结果。</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> Idb <span class="token keyword">from</span> <span class="token string">'idb-js'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$peopleDB <span class="token operator">=</span> <span class="token function">Idb</span><span class="token punctuation">(</span>peopleInfoDB<span class="token punctuation">)</span> <span class="token comment">// 挂载全局</span>
</code></pre> 
<p>然后我们在页面中直接使用：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">const</span> _vm <span class="token operator">=</span> <span class="token keyword">this</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$peopleDB<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  data<span class="token punctuation">.</span><span class="token function">queryAll</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    tableName<span class="token operator">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>length <span class="token operator">==</span> _vm<span class="token punctuation">.</span>raatio<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        _vm<span class="token punctuation">.</span>list <span class="token operator">=</span> result
        _vm<span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">"people/setPeopleInfo"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>其他使用方法同理，当然后续有时间完全可以二次封装。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a78f1d8bb3e06d5fbbca9e04fa050346/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数学建模】Matlab实现SEIR模型</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/688d031793246bcf103b29e92494b04a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">请求时，为什么要携带token？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>