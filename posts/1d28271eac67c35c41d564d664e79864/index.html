<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PyTorch 笔记Ⅸ——数据增强 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PyTorch 笔记Ⅸ——数据增强" />
<meta property="og:description" content="文章目录 数据增强说明导入必要的包读取图片并显示显示方式一显示方式二 Pytorch 数据增强transforms 之旋转transforms 之裁剪transforms.functional 之裁剪特殊数据增强方式 Augmentor导入 Augmentor 包读取图像并进行弹性形变 数据增强实践导入新需要的模块定义数据增强函数开始处理效果展示 数据增强说明 1.本次将演绎常用的Pytorch数据增强方式
2.本次将简单介绍数据增强模块Augmentor的使用方式
导入必要的包 import PIL.Image as Image import os from torchvision import transforms from IPython import display import matplotlib.pyplot as plt 读取图片并显示 transforms是对PIL图像进行处理(特殊函数除外RandomErasing)，因此我们需要导入PIL包进行图像读取
显示方式一 利用IPython.display模块展示图片
display.Image(&#39;./augmentation/Pytorch_logo.png&#39;) 显示方式二 读取图片
image = Image.open(&#39;./augmentation/Pytorch_logo.png&#39;) image.size (1025, 205) image Pytorch 数据增强 transforms 之旋转 随机水平（左右）翻转
torchvision.transforms.RandomHorizontalFlip(p=0.5)
以给定的概率水平翻转给定的图像。该图像可以是PIL图像或torch Tensor，在这种情况下，它应具有[…, H, W]形状，其中...表示任意数量的前导维度，比如...可以是通道数，或者是batchsize和通道数，最后两位必须指定高度与宽度
参数：
p(float)–图像被翻转的可能性。默认值为0.5
fig = plt.gcf() fig.set_size_inches(15, 4) for i in range(4): randomHorizontalFlip = transforms." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1d28271eac67c35c41d564d664e79864/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-29T20:17:26+08:00" />
<meta property="article:modified_time" content="2020-12-29T20:17:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PyTorch 笔记Ⅸ——数据增强</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">数据增强说明</a></li><li><a href="#_5" rel="nofollow">导入必要的包</a></li><li><a href="#_16" rel="nofollow">读取图片并显示</a></li><li><ul><li><a href="#_20" rel="nofollow">显示方式一</a></li><li><a href="#_37" rel="nofollow">显示方式二</a></li></ul> 
   </li><li><a href="#Pytorch__71" rel="nofollow">Pytorch 数据增强</a></li><li><ul><li><a href="#transforms__73" rel="nofollow">transforms 之旋转</a></li><li><a href="#transforms__166" rel="nofollow">transforms 之裁剪</a></li><li><a href="#transformsfunctional__368" rel="nofollow">transforms.functional 之裁剪</a></li><li><a href="#_501" rel="nofollow">特殊数据增强方式</a></li></ul> 
   </li><li><a href="#Augmentor_560" rel="nofollow">Augmentor</a></li><li><ul><li><a href="#_Augmentor__562" rel="nofollow">导入 Augmentor 包</a></li><li><a href="#_569" rel="nofollow">读取图像并进行弹性形变</a></li></ul> 
   </li><li><a href="#_620" rel="nofollow">数据增强实践</a></li><li><ul><li><a href="#_641" rel="nofollow">导入新需要的模块</a></li><li><a href="#_649" rel="nofollow">定义数据增强函数</a></li><li><a href="#_664" rel="nofollow">开始处理</a></li><li><a href="#_731" rel="nofollow">效果展示</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>数据增强说明</h3> 
<p>1.本次将演绎常用的<code>Pytorch</code>数据增强方式<br> 2.本次将简单介绍数据增强模块<code>Augmentor</code>的使用方式</p> 
<h3><a id="_5"></a>导入必要的包</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> PIL<span class="token punctuation">.</span>Image <span class="token keyword">as</span> Image
<span class="token keyword">import</span> os
<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms
<span class="token keyword">from</span> IPython <span class="token keyword">import</span> display
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> 
<h3><a id="_16"></a>读取图片并显示</h3> 
<p><code>transforms</code>是对<code>PIL</code>图像进行处理(特殊函数除外<code>RandomErasing</code>)，因此我们需要导入<code>PIL</code>包进行图像读取</p> 
<h4><a id="_20"></a>显示方式一</h4> 
<p>利用<code>IPython.display</code>模块展示图片</p> 
<pre><code class="prism language-python">display<span class="token punctuation">.</span>Image<span class="token punctuation">(</span><span class="token string">'./augmentation/Pytorch_logo.png'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/9b/zAKzzhM1_o.png" alt="1"></p> 
<h4><a id="_37"></a>显示方式二</h4> 
<p>读取图片</p> 
<pre><code class="prism language-python">image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./augmentation/Pytorch_logo.png'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">image<span class="token punctuation">.</span>size
</code></pre> 
<pre><code>(1025, 205)
</code></pre> 
<pre><code class="prism language-python">image
</code></pre> 
<p><img src="https://images2.imgbox.com/bd/6f/cQRGbKYj_o.png" alt="1"></p> 
<h3><a id="Pytorch__71"></a>Pytorch 数据增强</h3> 
<h4><a id="transforms__73"></a>transforms 之旋转</h4> 
<p><strong>随机水平（左右）翻转</strong></p> 
<p><strong>torchvision.transforms.RandomHorizontalFlip(p=0.5)</strong></p> 
<p>以给定的概率水平翻转给定的图像。该图像可以是PIL图像或torch Tensor，在这种情况下，它应具有[…, H, W]形状，其中<code>...</code>表示任意数量的前导维度，比如<code>...</code>可以是通道数，或者是<code>batchsize</code>和通道数，最后两位必须指定高度与宽度</p> 
<p>参数：<br>     p(<em>float</em>)–图像被翻转的可能性。默认值为0.5</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    randomHorizontalFlip <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomHorizontalFlip<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomHorizontalFlip<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/8e/TOtW8WhI_o.png" alt="1"></p> 
<p><strong>随机垂直（上下）翻转</strong></p> 
<p><strong>torchvision.transforms.RandomVerticalFlip(p=0.5)</strong></p> 
<p>含义与上面水平翻转相同，不过一个是水平翻转一个是垂直翻转</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    randomVerticalFlip <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomVerticalFlip<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomVerticalFlip<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d4/0c/rCW9Lfm1_o.png" alt="1"></p> 
<p><strong>随机角度翻转</strong></p> 
<p><strong>torchvision.transforms.RandomRotation(degrees, resample=False, expand=False, center=None, fill=None)</strong></p> 
<p>给图像旋转一个角度</p> 
<p>参数：<br>     degrees(<em>sequence或者float及int</em>) - 旋转角度的范围选取，如果使用<code>sequence</code>如<code>(min, max)</code>则会在此范围内随机旋转，如果只指定一个数A，那么旋转范围在<code>(-A, A)</code><br>     resample(<em>{PIL.Image.NEAREST, PIL.Image.BILINEAR, PIL.Image.BICUBIC}, optional</em>) - 图像重采样(插值)的方法，省略或图像模式指定为“1”或“P”，将采用PIL.Image.NEAREST(最近邻插值)【图像模式为“1”与“P”是PIL读取图像指定的，类似于RGB与BGR这种不同的模式，具体可以参见<a href="https://stackoverflow.com/questions/52307290/what-is-the-difference-between-images-in-p-and-l-mode-in-pil" rel="nofollow">此处介绍的“L”与“P”模式</a>】<br>     expand(<em>bool, optional</em>)-可选参数。如果为true，则扩展输出以使其足够大以容纳整个旋转的图像。如果为false或省略，则使输出图像与输入图像具有相同的尺寸。需要注意的是扩展过程中旋转中心并未平移<br>     center(<em>2-tuple, optional</em>)-可选参数，指定旋转的中心，默认值为图像中心为旋转中心<br>     fill(n-tuple or int or float)-可选参数，旋转图像外部区域的像素填充值。如果为int或float，则该值分别用于所有区域。默认为0，即默认填充白色。【注意此选项仅适用于<code>pillow&gt;=5.2.0</code>】</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> i<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">:</span>
        randomRotation <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomRotation<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        randomRotation <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomRotation<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomRotation<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2f/7b/FFK7kAE2_o.png" alt="1"></p> 
<h4><a id="transforms__166"></a>transforms 之裁剪</h4> 
<p><strong>中心裁剪</strong></p> 
<p><strong>torchvision.transforms.CenterCrop(size)</strong></p> 
<p>参数：<br>     size(<em>sequence或int</em>)-指定裁剪尺寸(h, w)</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    centerCrop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>CenterCrop<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>centerCrop<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3b/0e/LzK08YZw_o.png" alt="1"></p> 
<p><strong>四角与中心裁剪</strong></p> 
<p><strong>torchvision.transforms.FiveCrop(size)</strong></p> 
<p>参数：<br>     size(<em>sequence或int</em>)-指定裁剪尺寸，如果为<code>sequence</code>则指定长宽，为<code>int</code>则裁剪为正方形，宽高相同</p> 
<p><strong>此函数裁剪后返回五张图片，分别从四个角以及中心进行裁剪</strong></p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

fiveCrop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>FiveCrop<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>fiveCrop<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/19/74/jzYwqzEa_o.png" alt="1"></p> 
<pre><code class="prism language-python">fiveCrop
</code></pre> 
<pre><code>(&lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC7D3C3C8&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8FC8EB8&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8FD6400&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8FD6470&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8FD64E0&gt;)
</code></pre> 
<p><strong>随机位置裁剪指定尺寸</strong></p> 
<p><strong>torchvision.transforms.RandomCrop(size, padding=None, pad_if_needed=False, fill=0, padding_mode=‘constant’)</strong></p> 
<p>参数：<br>     size(<em>sequence或int</em>)-指定裁剪尺寸，如果为<code>sequence</code>则指定长宽，为<code>int</code>则裁剪为正方形，宽高相同<br>     padding(<em>int或sequence, optional</em>)-图像每个边框上的可选填充。默认为<code>None</code>，即无填充。如果提供了长度为4的序列，则将其分别用于填充左边界，上边界，右边界和下边界。如果提供了长度为2的序列，则将其分别用于填充左/右，上/下边框<br>     pad_if_needed(<em>boolean</em>)-如果小于所需大小，它将填充图像，以避免引发异常。由于裁剪是在填充之后完成的，因此填充似乎是在随机偏移下完成的【此参数非常重要】<br>     fill –恒定填充的像素填充值。默认值为0。如果一个元组的长度为3，则分别用于填充R，G，B通道。仅当padding_mode恒定时使用此值<br>     padding_mode-<br>         填充类型。应该是：常量，边缘，反射或对称。默认为常数。</p> 
<p>        constant(常数)：具有恒定值的填充，此值由填充指定</p> 
<p>        edge(边缘)：在图像边缘具有最后一个值的填充</p> 
<p>        reflect(反射)：具有图像反射的填充板（不重复边缘上的最后一个值）在反射模式下在两侧填充2个元素的[1、2、3、4]填充将导致[3、2、1、2、3、4、3、2]</p> 
<p>        symmetric(对称)：具有图像反射的垫（重复边缘上的最后一个值）在对称模式下在两侧填充2个元素的[1、2、3、4]填充将导致[2、1、1、2、3、4、4、3]</p> 
<p><strong>【特别注意剪裁越界问题】</strong></p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    randomCrop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomCrop<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomCrop<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e5/31/9Yi7mGKK_o.png" alt="1"></p> 
<p><strong>随机大小剪裁</strong></p> 
<p><strong>torchvision.transforms.RandomResizedCrop(size, scale=(0.08, 1.0), ratio=(0.75, 1.3333333333333333), interpolation=2)</strong></p> 
<p><strong>将给定的PIL图像裁剪为随机大小并缩放为指定纵横比</strong></p> 
<p>参数：<br>     size – 期望输出尺寸的大小<br>     scale – 裁剪原图尺寸的范围<br>     ratio – 裁剪图像的宽高比范围<br>     interpolation – 默认: PIL.Image.BILINEAR(线性插值)</p> 
<p>【<strong>注意：scale是裁剪原图尺寸范围，意味着在原图上裁剪区域的范围；ratio是需要裁剪图像的宽高比，即在原图上指定的裁剪范围内裁剪出一个指定宽高比的图片，最后通过缩放成指定的size输出</strong>】</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    randomResizedCrop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomResizedCrop<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
                                                     scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.08</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                     ratio<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">1.3333333333333333</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                                     interpolation<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomResizedCrop<span class="token punctuation">)</span>


plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/80/ff/IBHONjem_o.png" alt="1"></p> 
<p><strong>十种类裁剪</strong></p> 
<p><strong>torchvision.transforms.TenCrop(size, vertical_flip=False)</strong></p> 
<p><strong>与五种类裁剪相似，只是加上翻转操作，所以变为10种类，其中size指定大小，vertical_flip指定是垂直翻转还是水平翻转</strong></p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

tenCrop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>TenCrop<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>tenCrop<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/dc/KTQ9p5r5_o.png" alt="1"></p> 
<pre><code class="prism language-python">tenCrop
</code></pre> 
<pre><code>(&lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC93BECC0&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC93CF358&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDCA6616A0&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDCA661860&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDCA661668&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8EF60F0&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8EF6D68&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC8EFFCF8&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC5C8C9E8&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC5C8C908&gt;)
</code></pre> 
<h4><a id="transformsfunctional__368"></a>transforms.functional 之裁剪</h4> 
<p>与<code>transforms</code>对应功能相同，不做多的解释</p> 
<p>中心裁剪</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

functional_center_crop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>center_crop<span class="token punctuation">(</span>image<span class="token punctuation">,</span> output_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">900</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>functional_center_crop<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/3f/3a/v2Faq41w_o.png" alt="1"></p> 
<p>functional指定框裁剪</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

functional_crop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>crop<span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>functional_crop<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/55/b3/BIljy9Sw_o.png" alt="1"></p> 
<p>functional五种类裁剪（不能越界）</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

functional_five_crop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>five_crop<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>functional_five_crop<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/96/54/RqkyRX2S_o.png" alt="1"></p> 
<p>functional剪裁与尺寸调整</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

functional_resized_crop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>resized_crop<span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>functional_resized_crop<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/59/9A5jk9EQ_o.png" alt="1"></p> 
<p>functional十种类裁剪</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

functional_ten_crop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>ten_crop<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>functional_ten_crop<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/38/c4/Y26iZ8rD_o.png" alt="1"></p> 
<pre><code class="prism language-python">functional_ten_crop
</code></pre> 
<pre><code>(&lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5438&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5400&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5358&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5780&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5B70&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F55F8&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5BE0&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F56A0&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5C88&gt;,
 &lt;PIL.Image.Image image mode=RGBA size=700x170 at 0x1CDC90F5710&gt;)
</code></pre> 
<h4><a id="_501"></a>特殊数据增强方式</h4> 
<p><strong>随机擦除</strong></p> 
<p><strong>随机选择图像中的矩形区域并删除其像素</strong></p> 
<p><strong>torchvision.transforms.RandomErasing(p=0.5, scale=(0.02, 0.33), ratio=(0.3, 3.3), value=0, inplace=False)</strong></p> 
<p>参数：<br>     p – 执行擦除的概率</p> 
<p>    scale – 删除区域相对于输入图像的比例范围</p> 
<p>    ratio – 擦除区域的宽高比范围</p> 
<p>    value – 擦除像素的值，默认为0，如果为单个int，则用于擦除所有像素。如果元组的长度为3，则分别用于擦除R，G，B通道。如果str为“随机”，则使用随机值擦除每个像素</p> 
<p>    inplace – 默认为False，这个参数设置为False就行了</p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

image_jpg <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./augmentation/Pytorch_logo.jpg'</span><span class="token punctuation">)</span>
image_tensor <span class="token operator">=</span> transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image_jpg<span class="token punctuation">)</span>
randomErasing <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomErasing<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.33</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ratio<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image_tensor<span class="token punctuation">)</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomErasing<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bf/e1/uRDlhCF5_o.png" alt="1"></p> 
<p><strong>注意：</strong></p> 
<pre><code class="prism language-python">fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>gcf<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

image_png <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./augmentation/Pytorch_logo.png'</span><span class="token punctuation">)</span>
image_tensor <span class="token operator">=</span> transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image_png<span class="token punctuation">)</span>
randomErasing <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomErasing<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.33</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ratio<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image_tensor<span class="token punctuation">)</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>randomErasing<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>如果读取png格式的图片应采用这串代码，因为png格式具有4个通道</strong></p> 
<p><strong>其中还包括一些颜色变换，亮度调节，对比度等，这些可以通过查询官网文档进行详细了解</strong></p> 
<h3><a id="Augmentor_560"></a>Augmentor</h3> 
<h4><a id="_Augmentor__562"></a>导入 Augmentor 包</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> Augmentor
</code></pre> 
<h4><a id="_569"></a>读取图像并进行弹性形变</h4> 
<pre><code class="prism language-python">img <span class="token operator">=</span> Augmentor<span class="token punctuation">.</span>Pipeline<span class="token punctuation">(</span><span class="token string">'./augmentation'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>Initialised with 5 image(s) found.
Output directory set to ./augmentation\output.
</code></pre> 
<pre><code class="prism language-python">img<span class="token punctuation">.</span>random_distortion<span class="token punctuation">(</span>probability<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span> grid_width<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> grid_height<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> magnitude<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">img<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>Processing &lt;PIL.Image.Image image mode=RGBA size=1025x205 at 0x22EE90BA320&gt;: 100%|█| 20/20 [00:01&lt;00:00, 12.39 Samples/
</code></pre> 
<pre><code class="prism language-python">img<span class="token punctuation">.</span>status<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>Operations: 1
	0: Distort (probability=0.7 grid_width=4 grid_height=4 magnitude=6 randomise_magnitude=True )
Images: 5
Classes: 1
	Class index: 0 Class label: augmentation 
Dimensions: 5
	Width: 1574 Height: 520
	Width: 1579 Height: 776
	Width: 1025 Height: 205
	Width: 1024 Height: 204
	Width: 1600 Height: 874
Formats: 2
	 PNG
	 JPEG

You can remove operations using the appropriate index and the remove_operation(index) function.
</code></pre> 
<p><strong>程序会在指定的文件夹下创建一个output文件夹并将生成的图片保存进取</strong></p> 
<p><img src="https://images2.imgbox.com/f2/29/mFtfWvWN_o.png" alt="1"></p> 
<h3><a id="_620"></a>数据增强实践</h3> 
<p>本次数据增强为扩增<code>hymenoptera_data</code>数据集，原始的<code>hymenoptera_data</code>数据集是一个二分类数据集，其包含文件关系如下：</p> 
<pre><code>|--hymenoptera_data
|  |--train(245文件)
|  |  |---ants
|  |  |---bees
|  |--val(153文件)
|  |  |---ants
|  |  |---bees
</code></pre> 
<p>我们按照随机裁剪以及缩放的方式，扩增数据集为原来的11倍，也就是新增10倍数据集，为了方便数据的管理，我们将所有文件夹下的数据集重命名，重命名的bat文件编写参加我的另一篇博客<a href="https://blog.csdn.net/qq_39567427/article/details/107173316">Win10利用bat文件实现文件与文件夹批量重命名</a>，我们将所有图片命名为<code>i_0.jpg</code>的格式。<br> <strong>●注意图片可能有其它格式需要将这些格式全部转换成统一类型例如<code>jpg</code>格式，我一般使用格式工厂或自定义脚本进行，切勿直接重命名！可以通过图片按类型排序找出其它类型图片</strong><br> <strong>●注意图片是否能打开，可以通过图片按照大小排序可以很快找出不能打开的图片，因为往往这类图片的大小很小！</strong><br> <strong>●PIL读取png的模式为RGBA，不能保存为jpg格式只能保存为png格式，而PIL读取jpg的模式为RGB，可以保存为jpg格式以及png格式，因此同一数据集统一图片格式是很重要的</strong></p> 
<p><img src="https://images2.imgbox.com/5c/13/0YUpIBAo_o.png" alt="1"></p> 
<h4><a id="_641"></a>导入新需要的模块</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre> 
<h4><a id="_649"></a>定义数据增强函数</h4> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">augmentation</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ratio <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>low<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span> high<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    
    image <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomRotation<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    image <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomHorizontalFlip<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    image <span class="token operator">=</span> transforms<span class="token punctuation">.</span>RandomVerticalFlip<span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    functional_ten_crop <span class="token operator">=</span> transforms<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>ten_crop<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> ratio<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> ratio<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> functional_ten_crop
</code></pre> 
<h4><a id="_664"></a>开始处理</h4> 
<pre><code class="prism language-python">nums <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> train_val_dir <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">'hymenoptera_data'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> class_dir <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'hymenoptera_data'</span><span class="token punctuation">,</span> train_val_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        saved_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">'hymenoptera_data'</span><span class="token punctuation">,</span> train_val_dir<span class="token punctuation">,</span> class_dir<span class="token punctuation">)</span>
        <span class="token keyword">for</span> image_file <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>saved_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            nums <span class="token operator">+=</span> <span class="token number">1</span>
            image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>saved_dir<span class="token punctuation">,</span> image_file<span class="token punctuation">)</span><span class="token punctuation">)</span>
            image <span class="token operator">=</span> augmentation<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
            i <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> pic <span class="token keyword">in</span> image<span class="token punctuation">:</span>
                i <span class="token operator">+=</span> <span class="token number">1</span>
                pic<span class="token punctuation">.</span>save<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>saved_dir<span class="token punctuation">,</span> image_file<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'_'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> nums <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'INFO: '</span><span class="token punctuation">,</span> nums<span class="token punctuation">,</span> <span class="token string">' images have been dealt!'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'INFO: total '</span><span class="token punctuation">,</span> nums<span class="token punctuation">,</span> <span class="token string">' images have been dealt!\nData Augmentation finished!'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>INFO:  10  images have been dealt!
INFO:  20  images have been dealt!
INFO:  30  images have been dealt!
INFO:  40  images have been dealt!
INFO:  50  images have been dealt!
INFO:  60  images have been dealt!
INFO:  70  images have been dealt!
INFO:  80  images have been dealt!
INFO:  90  images have been dealt!
INFO:  100  images have been dealt!
INFO:  110  images have been dealt!
INFO:  120  images have been dealt!
INFO:  130  images have been dealt!
INFO:  140  images have been dealt!
INFO:  150  images have been dealt!
INFO:  160  images have been dealt!
INFO:  170  images have been dealt!
INFO:  180  images have been dealt!
INFO:  190  images have been dealt!
INFO:  200  images have been dealt!
INFO:  210  images have been dealt!
INFO:  220  images have been dealt!
INFO:  230  images have been dealt!
INFO:  240  images have been dealt!
INFO:  250  images have been dealt!
INFO:  260  images have been dealt!
INFO:  270  images have been dealt!
INFO:  280  images have been dealt!
INFO:  290  images have been dealt!
INFO:  300  images have been dealt!
INFO:  310  images have been dealt!
INFO:  320  images have been dealt!
INFO:  330  images have been dealt!
INFO:  340  images have been dealt!
INFO:  350  images have been dealt!
INFO:  360  images have been dealt!
INFO:  370  images have been dealt!
INFO:  380  images have been dealt!
INFO:  390  images have been dealt!
INFO: total  397  images have been dealt!
Data Augmentation finished!
</code></pre> 
<h4><a id="_731"></a>效果展示</h4> 
<p>最终生成的效果如下，原始图像一共397张图片，新扩增10倍后，数据集数量为原来的11倍，达到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         397 
        
       
         × 
        
       
         11 
        
       
         = 
        
       
         4367 
        
       
      
        397×11=4367 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">3</span><span class="mord">9</span><span class="mord">7</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">4</span><span class="mord">3</span><span class="mord">6</span><span class="mord">7</span></span></span></span></span>张</p> 
<p><img src="https://images2.imgbox.com/ba/1a/Y5ZTB8J6_o.png" alt="1"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c932eb8fe59fb94466b312fc50887533/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">adb 删除文件_adb 常用命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bb03512c868e42be78e0cdcf3c0f96d3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Vue2.0修饰符</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>