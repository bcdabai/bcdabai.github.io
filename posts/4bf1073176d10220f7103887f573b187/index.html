<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WVPPro&#43;ZLMediaKit&#43;大华相机推流&#43;安卓模拟GB28181设备推流 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="WVPPro&#43;ZLMediaKit&#43;大华相机推流&#43;安卓模拟GB28181设备推流" />
<meta property="og:description" content="wvp pro有三种部署方式
（1）wvp pro jar包&#43;ZLMediaKit。本文主要基于此种方式。
（2）docker hub直接下载docker，其内置了 wvp pro jar&#43;ZLMediaKit。第10小节讲解了此种方式。
（3）docker-compose运行。docker-compose 运行wvp-pro_fang·up·ad的博客-CSDN博客 1.项目源码 WVP Pro GitHub WVP是一个GB28181平台
ZLMediaKit GitHub
安装参考教程
国标GB28181介绍_嵌入彭于晏的博客-CSDN博客_28181
2. 部署WVP Pro项目 （1）下载WVP Pro源码
git clone https://gitee.com/pan648540858/wvp-GB28181-pro.git ♫）application.yml指定配置文件为application-dev.yml
spring: profiles: active: dev ♫）配置zlm节点
application-dev.yml中修改media.http-port为ZLMediaKit的config.ini配置文件http-port属性值一致；修改media.secret和config.ini的genaral.mediaServerId一致（一般情况下，如果删除节点，重新添加节点时才需要修改；如果日志报错zlm节点重复，那么需要删除wvp mysql数据库中media_server表中此节点的zlm配置信息即不会报错）。
这两个项目只需要配置这两个值。
#zlm 默认服务器配置 media: # [必须修改] zlm服务器的内网IP ip: 127.0.0.1 # [必须修改] zlm服务器的http.port http-port: 8091 # [可选] zlm服务器的hook.admin_params=secret secret: 035c73f7-bb6b-4889-a715-d9eb2d1925cc # 启用多端口模式, 多端口模式使用端口区分每路流，兼容性更好。 单端口使用流的ssrc区分， 点播超时建议使用多端口测试 rtp: # [可选] 是否启用多端口模式, 开启后会在portRange范围内选择端口用于媒体流传输 enable: true # [可选] 在此范围内选择端口用于媒体流传输, port-range: 30000,30500 # 端口范围 # [可选] 国标级联在此范围内选择端口发送媒体流, send-port-range: 30000,30500 # 端口范围 # 录像辅助服务， 部署此服务可以实现zlm录像的管理与下载， 0 表示不使用 record-assist-port: 18081 ♫）本项目需要安装 Redis" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4bf1073176d10220f7103887f573b187/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-27T11:00:54+08:00" />
<meta property="article:modified_time" content="2022-05-27T11:00:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">WVPPro&#43;ZLMediaKit&#43;大华相机推流&#43;安卓模拟GB28181设备推流</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>wvp pro有三种部署方式</p> 
<p>（1）wvp pro jar包+ZLMediaKit。本文主要基于此种方式。</p> 
<p>（2）docker hub直接下载docker，其内置了 wvp pro jar+ZLMediaKit。第10小节讲解了此种方式。</p> 
<p>（3）docker-compose运行。<a href="https://blog.csdn.net/qq_22310551/article/details/123331965" title="docker-compose 运行wvp-pro_fang·up·ad的博客-CSDN博客">docker-compose 运行wvp-pro_fang·up·ad的博客-CSDN博客</a> </p> 
<h2>1.项目源码</h2> 
<blockquote> 
 <p><a class="link-info" href="https://github.com/648540858/wvp-GB28181-pro" title="WVP Pro GitHub">WVP Pro GitHub</a> WVP是一个GB28181平台</p> 
 <p><a class="link-info" href="https://github.com/GB28181/ZLMediaKit" title="ZLMediaKit GitHub">ZLMediaKit GitHub</a></p> 
 <p><a class="link-info" href="https://notemi.cn/wvp---zlmedia-kit---mediaserverui-to-realize-streaming-playback-and-recording-of-camera-gb28181.html" rel="nofollow" title="安装参考教程">安装参考教程</a></p> 
 <p id="articleContentId"><a href="https://blog.csdn.net/weixin_38746576/article/details/106780001" title="国标GB28181介绍_嵌入彭于晏的博客-CSDN博客_28181">国标GB28181介绍_嵌入彭于晏的博客-CSDN博客_28181</a></p> 
</blockquote> 
<h2>2. 部署WVP Pro项目</h2> 
<p>（1）下载WVP Pro源码</p> 
<blockquote> 
 <pre>git clone https://gitee.com/pan648540858/wvp-GB28181-pro.git</pre> 
 <p>♫）application.yml指定配置文件为application-dev.yml</p> 
 <pre><code>spring:
  profiles:
    active: dev</code></pre> 
 <p>♫）配置zlm节点</p> 
 <p>        application-dev.yml中修改media.http-port为ZLMediaKit的config.ini配置文件http-port属性值一致；修改media.secret和config.ini的genaral.mediaServerId一致（一般情况下，如果删除节点，重新添加节点时才需要修改；如果日志报错zlm节点重复，那么需要删除wvp mysql数据库中media_server表中此节点的zlm配置信息即不会报错）。</p> 
 <p>        这两个项目只需要配置这两个值。</p> 
 <pre><code>#zlm 默认服务器配置
media:
    # [必须修改] zlm服务器的内网IP
    ip: 127.0.0.1
    # [必须修改] zlm服务器的http.port
    http-port: 8091
    # [可选] zlm服务器的hook.admin_params=secret
    secret: 035c73f7-bb6b-4889-a715-d9eb2d1925cc
    # 启用多端口模式, 多端口模式使用端口区分每路流，兼容性更好。 单端口使用流的ssrc区分， 点播超时建议使用多端口测试
    rtp:
        # [可选] 是否启用多端口模式, 开启后会在portRange范围内选择端口用于媒体流传输
        enable: true
        # [可选] 在此范围内选择端口用于媒体流传输,
        port-range: 30000,30500 # 端口范围
        # [可选] 国标级联在此范围内选择端口发送媒体流,
        send-port-range: 30000,30500 # 端口范围
    # 录像辅助服务， 部署此服务可以实现zlm录像的管理与下载， 0 表示不使用
    record-assist-port: 18081</code></pre> 
 <p> ♫）本项目需要安装 Redis</p> 
 <p>        安装好redis后，application-dev.yml 配置好redis的密码、ip、port等。</p> 
 <pre><code>spring:
    # REDIS数据库配置
    redis:
        # [必须修改] Redis服务器IP, REDIS安装在本机的,使用127.0.0.1
        host: 127.0.0.1
        # [必须修改] 端口号
        port: 6379
        # [可选] 数据库 DB
        database: 6
        # [可选] 访问密码,若你的redis服务器没有设置密码，就不需要用密码去连接
        password: face2020
        # [可选] 超时时间
        timeout: 10000</code></pre> 
</blockquote> 
<p>（2）编译静态页面</p> 
<blockquote> 
 <pre><code>cd wvp-GB28181-pro/web_src/
npm --registry=https://registry.npm.taobao.org install
npm run build</code></pre> 
 <p>编译如果报错, 一般都是网络问题, 导致的依赖包下载失败<br> 编译完成后在src/main/resources下出现static目录。此时打成的jar包包含了web页面，前端可以直接访问。</p> 
</blockquote> 
<p>（3）打包项目, 生成可执行jar</p> 
<blockquote> 
 <pre>cd wvp-GB28181-pro
mvn package</pre> 
 <p>编译如果报错, 一般都是网络问题, 导致的依赖包下载失败<br> 编译完成后在target目录下出现wvp-pro-x.x-xxxxxxxx.jar</p> 
</blockquote> 
<h2> 3.编译<a href="https://github.com/ZLMediaKit/ZLMediaKit" title="ZLMediaKit">ZLMediaKit</a></h2> 
<p>        <a class="link-info" href="https://github.com/ZLMediaKit/ZLMediaKit/wiki/%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B" title="参考官网编译">参考官网编译</a>教程</p> 
<blockquote> 
 <p>windows下编译</p> 
 <p>（1）获取代码</p> 
 <pre><code>#国内用户推荐从同步镜像网站gitee下载 
git clone --depth 1 https://gitee.com/xia-chu/ZLMediaKit
cd ZLMediaKit
#千万不要忘记执行这句命令
git submodule update --init</code></pre> 
 <p>（2）编译器</p> 
 <p>        如果你是windows用户，推荐安装vs2017或以上。</p> 
 <p>（3）下载后使用VS打开ZLMediaKit项目根文件夹，然后CMake点击全部生成即可在文件夹 <code>release/Windows64/Debug下生成</code>MediaServer</p> 
 <p>（4）运行</p> 
 <pre><code>1 进入ZLMediaKit/release/windows/Debug目录
2 双击MediaServer启动
3 你也可以在cmd或powershell中启动，通过MediaServer -h了解启动参数</code></pre> 
</blockquote> 
<blockquote> 
 <p>windows下 下载vscode2017 ，勾选C++桌面开发。</p> 
 <p>        链接：https://pan.baidu.com/s/1cjJCAzXQTPHSWezN6ICtuQ   提取码：1234</p> 
 <p>下载后使用VS打开ZLMediaKit项目根文件夹，然后CMake点击全部生成即可在文件夹 <code>release/Windows64/Debug下生成</code>MediaServer</p> 
 <p><img alt="" height="307" src="https://images2.imgbox.com/12/55/nPmEXMhQ_o.png" width="664"></p> 
</blockquote> 
<h2>4. zlm config.ini和wvp application的配置 </h2> 
<blockquote> 
 <p>构建好后打开 <code>release/xx/Debug</code> 目录，可以看到有 <code>config.ini</code> 是zlm的配置文件：<a href="https://github.com/xiongziliang/ZLMediaKit/blob/master/conf/config.ini" title="ZLMediaKit/config.ini at master · ZLMediaKit/ZLMediaKit · GitHub">ZLMediaKit/config.ini at master · ZLMediaKit/ZLMediaKit · GitHub</a></p> 
 <p></p> 
 <p>其中需要特别注意的有：</p> 
 <p>（1） [http] 的 port，config.ini http.port 和 wvp media.port 一样。因为 ZLMediaKit 项目也有很多 API 接口，都需要通过这个接口来访问，包括生成的播放的URL，都是这个端口，如遇到端口被你的其它服务占用，可自行配置。</p> 
 <p>（2） [rtp_proxy] 的 port，是我们上面 SIP 项目配置的 media.port</p> 
 <p>（3）config.ini配置文件的general.secret需要和wvp application的media.secret一致；</p> 
 <p>（4）zlm 的 genaral.mediaServerId 和 wvp 的 media.id一样。 wvp注册时需要判断是否一致。</p> 
 <p></p> 
 <p>配置好了就可以运行项目了。application中media就是配置zlm；</p> 
</blockquote> 
<h2>5.启动项目</h2> 
<blockquote> 
 <p>（1）启动ZLM  ZLM必须先启动</p> 
 <p>（2） 运行WVP</p> 
 <pre>        idea编译项目，生成jar包
        java -jar wvp-pro-*.jar 
</pre> 
 <p>        或者</p> 
 <p>                idea直接运行项目</p> 
 <p>（3）访问管理页面</p> 
 <pre><code>http://你的ip:18080
</code></pre> 
 <p>        比如我的部署的服务ip为192.168.1.44， server.port为18080， 那么访问地址为<a href="http://192.168.1.44/" rel="nofollow" title="http://192.168.1.44:108080">http://192.168.1.44:108080</a>, 会自动跳转到登陆页,默认用户名：admin， 密码：admin</p> 
 <p>（4）如果访问失败 关掉ZLM、WV 重新启动一下 注意启动顺序</p> 
</blockquote> 
<blockquote> 
 <p> 如果启动MediaServer，缺少libcrypto-1_1-x64.dll以及缺少libssl-1_1-x64.dll。那么下载这两个dll ，然后放在<code>release/Windows64/Debug 目录下，也就是</code>MediaServer同目录下。</p> 
 <p>链接：https://pan.baidu.com/s/1f9LjIVx7-PbGaQb79zf0hg <br> 提取码：1234</p> 
</blockquote> 
<h2>6.安装FFMPEG，并推流测试</h2> 
<blockquote> 
 <p><a class="link-info" href="https://github.com/ZLMediaKit/ZLMediaKit/wiki/ZLMediaKit%E6%8E%A8%E6%B5%81%E6%B5%8B%E8%AF%95" title="ZLMediaKit推流测试 ">ZLMediaKit推流测试 </a></p> 
 <p><a class="link-info" href="https://blog.csdn.net/qq_22310551/article/details/122098890" title="FFMPEG">FFMPEG</a></p> 
</blockquote> 
<h2>7.相机向WVP项目推送视频 </h2> 
<blockquote> 
 <p>不同厂商的相机，比如大华、海康、宇视等都有各自平台，难以实现跨平台视频传输。GB28181解决这个问题。WVP就是基于GB28181协议开发。</p> 
 <p>如下演示大华相机向WVP推送视频，推送到WVP的视频可以被其他平台接收、播放。</p> 
 <p>（1）WVP配置文件</p> 
 <p>       application.yml配置sip服务器的相关配置 。wvp项目相当于sip服务器，其他设备向本sip服务器推送数据。</p> 
 <p>        sip配置可以为127.0.0.1 也可以为本机的局域网ip</p> 
 <p><img alt="" height="413" src="https://images2.imgbox.com/a6/6d/VZBf3CJ2_o.png" width="1200"></p> 
 <p>（2）相机配置</p> 
 <p>        图中红框，填写WVP项目配置文件中配置的内容。</p> 
 <p>        SIP服务器编号对应id；SIP域对应domain；注册密码对应password。</p> 
 <p>        其余内容可根据需要自行填写。</p> 
 <p><img alt="" height="914" src="https://images2.imgbox.com/89/b0/bdb0dSbI_o.png" width="1200"></p> 
 <p>（3）此时从WVP项目前端页面便可以播放相机视频流</p> 
 <p>        设备列表--通道--播放</p> 
 <p><img alt="" height="914" src="https://images2.imgbox.com/e2/98/qeyuTnQk_o.png" width="1200"></p> 
 <p>（4）其他平台播放视频，比如VLC</p> 
 <p>        VLC可以通过资源地址播放视频，修改<a href="http://192.168.1.15:8091/rtp/0614727C.flv" rel="nofollow" title="图中的资源地址ws://192.168.1.15:8091/rtp/0614727C.flv">图中的资源地址ws://192.168.1.15:8091/rtp/0614727C.flv</a>为<a href="http://192.168.1.15:8091/rtp/0614727C.flv" rel="nofollow" title="http://192.168.1.15:8091/rtp/0614727C.flv即可播放。">http://192.168.1.15:8091/rtp/0614727C.flv即可播放。</a></p> 
 <p><img alt="" height="377" src="https://images2.imgbox.com/e7/62/YaP2M0y6_o.png" width="578"></p> 
</blockquote> 
<h3> 点击播放不播放问题</h3> 
<blockquote> 
 <p>注意：如果第3步报错 "<strong>收流超时，请稍候重试"或点击播放没有响应</strong> ，很大可能是因为ZLM节点有问题。拉流代理会调用ZLM播放拉流地址，故必须保证ZLM节点没有问题。</p> 
 <p>注意两点，一是wvp pro 的application-dev.yml 配置文件中的ip需要配置为内网地址，二是application-dev.yml中media.http-port和ZLMediaKit的http-port属性值需要一样，默认是一样的。</p> 
 <p>（1）vlc 或 ffplay 播放拉流地址，看能否正常播放。 拉流地址前后不能有空格。尽量部署最新版本wvp pro，旧版本存在一些bug，在不断完善。</p> 
 <p>（2）如下 wvp pro 的application-dev.yml 配置文件中的ip地址需要为内网ip地址。</p> 
 <p><img alt="" height="313" src="https://images2.imgbox.com/bd/3f/CTpiXRh3_o.png" width="632"></p> 
 <p> （3）节点是否配置正确</p> 
 <p>        web页面 节点管理 --  编辑。</p> 
 <p>        节点就是配置zlm播放相关的一些项。</p> 
 <p>        下面的IP、HOOK IP可以为127.0.0.1。但HTTP端口需要和application配置的http-port一样。 application-dev.yml中media.http-port和ZLMediaKit配置文件config.ini的http-port属性值必须相同。参考第三小节。</p> 
 <p>        SDP IP、流IP必须为公网IP或内网IP，不能是127.0.0.1。docker-compose 就是配置.env文件的SIP_IP以及STREAM_HOST为服务器外网IP地址即可。</p> 
 <p><img alt="" height="480" src="https://images2.imgbox.com/26/a1/vS90Nw5C_o.png" width="761"></p> 
 <p>         如果port不一样，需要添加节点。如下，测试通过就添加成功。 </p> 
 <p> <img alt="" height="314" src="https://images2.imgbox.com/9c/83/pmcokUPo_o.png" width="917"></p> 
 <p>下面是docker-compose设置节点。通过.env文件查看port，ip设置为127.0.0.1即可。</p> 
 <p><img alt="" height="403" src="https://images2.imgbox.com/ac/f5/bljHmlpG_o.png" width="759"></p> 
 <p></p> 
 <p>      注意：</p> 
 <p>          如果部署wvp pro 主机修改了ip， 需要重新编辑ZLM节点。否则播放无响应。</p> 
 <p></p> 
</blockquote> 
<h2> 8.安卓手机模拟支持GB28181协议的设备推流到平台</h2> 
<blockquote> 
 <p>（1）下载GB28281前端采集模拟软件 <a class="link-info" href="http://www.founu.com/a/product/gb28181/30.html" rel="nofollow" title="GbtDevice  ">GbtDevice  </a></p> 
 <p>       官网： <a href="http://www.founu.com/index.html" rel="nofollow" title="行业音视频解决方案专家 - 武汉视跃科技有限公司">行业音视频解决方案专家 - 武汉视跃科技有限公司</a> 官网查找 GBT28181音视频前端设备软件</p> 
 <p>        此程序的安卓开发参考文档：<a href="https://blog.csdn.net/wangjie_jack/article/details/102968738" title="用android实现GB28181的视音频前端设备_wangjie_jack的专栏-CSDN博客_gb28181 安卓">用android实现GB28181的视音频前端设备_wangjie_jack的专栏-CSDN博客_gb28181 安卓</a></p> 
 <p>（2）安卓手机安装GbtDevice后，填写WVP配置文件对应项</p> 
 <p>        国标服务器IP对应WVP项目部署在的电脑IP；服务器通信端口对应 配置文件中sip.port；服务器ID对应配置文件中sip.id；用户ID唯一标识，任意；用户密码对应sip.password。</p> 
 <p><img alt="" height="521" src="https://images2.imgbox.com/24/fa/gt3u2Lih_o.png" width="255"> <img alt="" height="324" src="https://images2.imgbox.com/18/30/zLxaKTEh_o.png" width="992"></p> 
 <p>（3）点击注册 然后点击开始录像</p> 
 <p>        此时在WVP前端页面上，可以通过设备列表---通道--播放 查看上传的视频流。</p> 
 <p>        如果此时<strong>通道页</strong>没有数据，可以在<strong>设备列表页</strong>，点击刷新重新连接设备。</p> 
 <p><img alt="" height="118" src="https://images2.imgbox.com/59/6d/6h5KI7kc_o.png" width="382"></p> 
 <p>         如果报错 "<strong>收流超时，请稍候重试"，</strong>请参考第6小节解决办法。</p> 
 <p> <img alt="" height="231" src="https://images2.imgbox.com/86/01/zzROcrsK_o.png" width="308"></p> 
</blockquote> 
<h2>9.wvp级联到其他gb28181平台</h2> 
<blockquote> 
 <p> （1）配置上级级联平台</p> 
 <p>        国际级联--添加，设置上级支持gb28181协议的平台的sip配置信息。</p> 
 <p><img alt="" height="249" src="https://images2.imgbox.com/df/a2/QrPhWlmW_o.png" width="1200"></p> 
 <p> <img alt="" height="602" src="https://images2.imgbox.com/60/35/vvsOlFFd_o.png" width="1200"></p> 
 <p>（2）设备推流或者拉流下级wvp项目的视频流</p> 
 <p>        本wvp项目可以接受设备推流，可以接受另外的wvp项目推流。</p> 
 <p>        推流走Gb28181协议的视频流，连接列表显示在设备列表，比如本wvp项目从下级wvp项目拉流、GbtDevice上传流，；如果相机推数据、或者rtmp推流等到本wvp，显示在推流列表；如果从其他视频流拉流，显示在拉流代理。</p> 
 <p>        其他设备推流上来，相当于生成了一个视频流通道。</p> 
 <p><img alt="" height="240" src="https://images2.imgbox.com/f9/48/AtBDAjOy_o.png" width="1200"></p> 
 <p>（3）通道和级联平台关联</p> 
 <p>        国际级联---选择通道，将平台和视频通道关联，此时视频便会推数据到上级级联平台上。</p> 
 <p><img alt="" height="469" src="https://images2.imgbox.com/23/57/9S1l60Ah_o.png" width="1200"></p> 
</blockquote> 
<h2>10.拉流代理</h2> 
<blockquote> 
 <p>（1）填写拉流地址，可以是rtmp等流媒体。主要是拉流地址、应用名、流ID，其余参数默认即可 </p> 
 <p><img alt="" height="513" src="https://images2.imgbox.com/c6/a4/Q2Kd3Qym_o.png" width="447"></p> 
 <p> （2）点击播放即可播放</p> 
 <p><img alt="" height="425" src="https://images2.imgbox.com/45/37/o26RxstR_o.png" width="892"></p> 
</blockquote> 
<h2>11.离线docker部署WVP</h2> 
<blockquote> 
 <p>（0）安装docker <a href="https://blog.csdn.net/qq_22310551/article/details/117328329" title="01 docker概述_fang.lovest.yang的博客-CSDN博客">01 docker概述_fang.lovest.yang的博客-CSDN博客</a></p> 
 <p>（1）互联网拉取wvp</p> 
 <p>        能够访问互联网的docker宿主机，从docker hub拉取wvp；或者如果已经下载了wvp项目的docker 直接导出wvp的tar包。如果已经有了wvp的tar包，可以直接看第3步。</p> 
 <pre><code class="language-bash">docker pull 648540858/wvp_pro

docker run  --env WVP_IP="你的IP" -it -p 18080:18080 -p 30000-30500:30000-30500/udp -p 30000-30500:30000-30500/tcp -p 80:80 -p 5060:5060 -p 5060:5060/udp 648540858/wvp_pro</code></pre> 
 <p>（2）互联网宿主机导出wvp项目</p> 
 <p>        使用镜像id导出。会直接保存在当前宿主机的当前目录下。</p> 
 <pre><code class="language-bash">docker save 0fdf2b4c26d3 &gt; hangge_server.tar</code></pre> 
 <p>        ps：如下命令将宿主机文件复制到docker指定目录下 如果参数交换位置，就实现了从docker里面向docker宿主机cp文件。【application.yml中sip的id 、password会读取环境变量值WVP_ID WVP_PWD，如果没有设置，会默认取值。环境变量值可以通过启动命令指定 --env key=value或-e key=value】</p> 
 <pre><code>docker cp /home/toy/wvp/application.yml c3b:/opt/wvp/config/application.yml</code></pre> 
 <p>（3）离线宿主机的docker导入wvp</p> 
 <pre><code>docker load &lt; wvp.tar</code></pre> 
 <p>     wvp的tar包百度云链接：https://pan.baidu.com/s/1DNlDoZRn4UM5EjB2_e7ztg  提取码：1234 </p> 
 <p>ps. Centos7启动docker </p> 
 <pre><code class="language-bash">systemctl start docker</code></pre> 
 <p>（4）新建并进入docker容器</p> 
 <pre><code>docker run  --env WVP_IP="你的IP" -it -p 18080:18080 -p 30000-30500:30000-30500/udp -p 30000-30500:30000-30500/tcp -p 80:80 -p 5060:5060 -p 5060:5060/udp 648540858/wvp_pro</code></pre> 
 <p><strong>使用的端口</strong></p> 
 <table align="left"><thead><tr><th>端口</th><th>描述</th><th>类型</th></tr></thead><tbody><tr><td>80</td><td>zlm的http端口</td><td>tcp</td></tr><tr><td>554</td><td>zlm的rtsp端口，非必须</td><td>tcp&amp;udp</td></tr><tr><td>1935</td><td>zlm的rtmp端口，非必须</td><td>tcp</td></tr><tr><td>5060</td><td>28181sip信令端口</td><td>tcp&amp;udp</td></tr><tr><td>6379</td><td>redis端口，非必须</td><td>tcp</td></tr><tr><td>18080</td><td>wvp的http端口</td><td>tcp</td></tr><tr><td>18081</td><td>录像管理服务端口，非必须</td><td>tcp</td></tr><tr><td>30000-30500</td><td>zlm接收视频推流端口</td><td>tcp&amp;udp</td></tr></tbody></table> 
 <p></p> 
 <p>ps:</p> 
 <p>        进入docker容器</p> 
 <pre><code class="language-bash">docker exec -it 43f /bin/bash</code></pre> 
 <p>        修改配置文件：如果docker里面没有vi软件，可以linux下vi修改，然后docker cp复制进docker容器，然后重启容器即可。</p> 
</blockquote> 
<h2><strong>12.遇见问题</strong></h2> 
<blockquote> 
 <p>部署后，web页面无法访问</p> 
 <p>（1）查看指定端口是否开启</p> 
 <ul><li>lsof -i:18082 或者netstat -antp | grep 18082 发现开启</li><li>其他电脑远程访问测试端口是否可通</li></ul> 
 <pre><code>1）windows上一般用telnet

    如telnet ip port

2）linux上可以用telnet，跟windows一样 telnet ip port

3）也可以用wget:如：wget ip:port

4）ssh:如ssh -v -p port username@ip  -v代表打开调试模式，username可随意指定</code></pre> 
 <p>（2）本机发现端口开启，但是远程访问端口不通。为什么？</p> 
 <p>        可以试下是否使用localhost可以访问，是的话，如果是部署在阿里云等云服务器上，一般是因为其本身的安全策略引起，需要登录云服务器管理页面，开启此接口。</p> 
</blockquote> 
<blockquote> 
 <p>虚拟机安装wvp-pro，报如下三种错 </p> 
 <pre><code>​
(1)Resource temporarily unavailable  


(2)Error starting userland proxy:.
​

(3)iptables failed: iptables --wait -t nat -A DOCKER -p tcp -d 0/0 --dport 80 -j DNAT ...</code></pre> 
 <p>解决：虚拟机分配内存1G，太小。修改为3G就可以解决问题。网上的其他解决方案，比如重建docker0网络恢复等无效。</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6486e3330a8e0567d50c441c9f236e49/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">yolov5中成功解决:subprocess.CalledProcessError: Command ‘pip install‘pycocotools ＞ =2.0 ‘ ‘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/12019e06c8361f2b60b7e9833de19293/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2022年安全员-C证试题及模拟考试</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>