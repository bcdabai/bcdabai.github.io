<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>å¤§æ•°æ®æ¯•è®¾é¡¹ç›® - æ·±åº¦å­¦ä¹  æœºå™¨è§†è§‰ äººè„¸è¯†åˆ«ç³»ç»Ÿ - opencv python - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="å¤§æ•°æ®æ¯•è®¾é¡¹ç›® - æ·±åº¦å­¦ä¹  æœºå™¨è§†è§‰ äººè„¸è¯†åˆ«ç³»ç»Ÿ - opencv python" />
<meta property="og:description" content="æ–‡ç« ç›®å½• 0 å‰è¨€1 æœºå™¨å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹äººè„¸æ£€æµ‹äººè„¸å¯¹å…¶äººè„¸ç‰¹å¾å‘é‡åŒ–äººè„¸è¯†åˆ« 2 æ·±åº¦å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹äººè„¸æ£€æµ‹äººè„¸è¯†åˆ«Metric Larning 3 æœ€å 0 å‰è¨€ ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚
ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯
ğŸš© æ·±åº¦å­¦ä¹  æœºå™¨è§†è§‰ äººè„¸è¯†åˆ«ç³»ç»Ÿ
ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)
éš¾åº¦ç³»æ•°ï¼š3åˆ†å·¥ä½œé‡ï¼š3åˆ†åˆ›æ–°ç‚¹ï¼š3åˆ† 1 æœºå™¨å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹ åŸºäºä¼ ç»Ÿå›¾åƒå¤„ç†å’Œæœºå™¨å­¦ä¹ æŠ€æœ¯çš„äººè„¸è¯†åˆ«æŠ€æœ¯ï¼Œå…¶ä¸­çš„æµç¨‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚
æœºå™¨å­¦ä¹ -äººè„¸è¯†åˆ«ç³»ç»Ÿéƒ½åŒ…æ‹¬ï¼š
äººè„¸æ£€æµ‹äººè„¸å¯¹å…¶äººè„¸ç‰¹å¾å‘é‡åŒ–äººè„¸è¯†åˆ«
äººè„¸æ£€æµ‹ äººè„¸æ£€æµ‹ç”¨äºç¡®å®šäººè„¸åœ¨å›¾åƒä¸­çš„å¤§å°å’Œä½ç½®ï¼Œå³è§£å†³â€œäººè„¸åœ¨å“ªé‡Œâ€çš„é—®é¢˜ï¼ŒæŠŠçœŸæ­£çš„äººè„¸åŒºåŸŸä»å›¾åƒä¸­è£å‰ªå‡ºæ¥ï¼Œä¾¿äºåç»­çš„äººè„¸ç‰¹å¾åˆ†æå’Œè¯†åˆ«ã€‚ä¸‹å›¾æ˜¯å¯¹ä¸€å¼ å›¾åƒçš„äººè„¸æ£€æµ‹ç»“æœï¼š
äººè„¸å¯¹å…¶ åŒä¸€ä¸ªäººåœ¨ä¸åŒçš„å›¾åƒåºåˆ—ä¸­å¯èƒ½å‘ˆç°å‡ºä¸åŒçš„å§¿æ€å’Œè¡¨æƒ…ï¼Œè¿™ç§æƒ…å†µæ˜¯ä¸åˆ©äºäººè„¸è¯†åˆ«çš„ã€‚
æ‰€ä»¥æœ‰å¿…è¦å°†äººè„¸å›¾åƒéƒ½å˜æ¢åˆ°ä¸€ä¸ªç»Ÿä¸€çš„è§’åº¦å’Œå§¿æ€ï¼Œè¿™å°±æ˜¯äººè„¸å¯¹é½ã€‚
å®ƒçš„åŸç†æ˜¯æ‰¾åˆ°äººè„¸çš„è‹¥å¹²ä¸ªå…³é”®ç‚¹ï¼ˆåŸºå‡†ç‚¹ï¼Œå¦‚çœ¼è§’ï¼Œé¼»å°–ï¼Œå˜´è§’ç­‰ï¼‰ï¼Œç„¶ååˆ©ç”¨è¿™äº›å¯¹åº”çš„å…³é”®ç‚¹é€šè¿‡ç›¸ä¼¼å˜æ¢ï¼ˆSimilarity Transformï¼Œæ—‹è½¬ã€ç¼©æ”¾å’Œå¹³ç§»ï¼‰å°†äººè„¸å°½å¯èƒ½å˜æ¢åˆ°æ ‡å‡†äººè„¸ã€‚
ä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„äººè„¸å›¾åƒå¯¹é½è¿‡ç¨‹ï¼š
è¿™å¹…å›¾å°±æ›´åŠ ç›´è§‚äº†ï¼š
äººè„¸ç‰¹å¾å‘é‡åŒ– è¿™ä¸€æ­¥æ˜¯å°†å¯¹é½åçš„äººè„¸å›¾åƒï¼Œç»„æˆä¸€ä¸ªç‰¹å¾å‘é‡ï¼Œè¯¥ç‰¹å¾å‘é‡ç”¨äºæè¿°è¿™å¼ äººè„¸ã€‚
ä½†ç”±äºï¼Œä¸€å¹…äººè„¸ç…§ç‰‡å¾€å¾€ç”±æ¯”è¾ƒå¤šçš„åƒç´ æ„æˆï¼Œå¦‚æœä»¥æ¯ä¸ªåƒç´ ä½œä¸º1ç»´ç‰¹å¾ï¼Œå°†å¾—åˆ°ä¸€ä¸ªç»´æ•°éå¸¸é«˜çš„ç‰¹å¾å‘é‡ï¼Œ è®¡ç®—å°†ååˆ†å›°éš¾ï¼›è€Œä¸”è¿™äº›åƒç´ ä¹‹é—´é€šå¸¸å…·æœ‰ç›¸å…³æ€§ã€‚
æ‰€ä»¥æˆ‘ä»¬å¸¸å¸¸åˆ©ç”¨PCAæŠ€æœ¯å¯¹äººè„¸æè¿°å‘é‡è¿›è¡Œé™ç»´å¤„ç†ï¼Œä¿ç•™æ•°æ®é›†ä¸­å¯¹æ–¹å·®è´¡çŒ®æœ€å¤§çš„äººè„¸ç‰¹å¾æ¥è¾¾åˆ°ç®€åŒ–æ•°æ®é›†çš„ç›®çš„
PCAäººè„¸ç‰¹å¾å‘é‡é™ç»´ç¤ºä¾‹ä»£ç ï¼š
#coding:utf-8 from numpy import * from numpy import linalg as la import cv2 import os def loadImageSet(add): FaceMat = mat(zeros((15,98*116))) j =0 for i in os.listdir(add): if i.split(&#39;.&#39;)[1] == &#39;normal&#39;: try: img = cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/81a0652c9bf325546aa96fbd6176c5a6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-30T11:32:00+08:00" />
<meta property="article:modified_time" content="2024-01-30T11:32:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">å¤§æ•°æ®æ¯•è®¾é¡¹ç›® - æ·±åº¦å­¦ä¹  æœºå™¨è§†è§‰ äººè„¸è¯†åˆ«ç³»ç»Ÿ - opencv python</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#0__4" rel="nofollow">0 å‰è¨€</a></li><li><a href="#1__23" rel="nofollow">1 æœºå™¨å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹</a></li><li><ul><li><a href="#_36" rel="nofollow">äººè„¸æ£€æµ‹</a></li><li><a href="#_43" rel="nofollow">äººè„¸å¯¹å…¶</a></li><li><a href="#_57" rel="nofollow">äººè„¸ç‰¹å¾å‘é‡åŒ–</a></li><li><a href="#_137" rel="nofollow">äººè„¸è¯†åˆ«</a></li></ul> 
  </li><li><a href="#2__287" rel="nofollow">2 æ·±åº¦å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹</a></li><li><ul><li><a href="#_298" rel="nofollow">äººè„¸æ£€æµ‹</a></li><li><a href="#_310" rel="nofollow">äººè„¸è¯†åˆ«</a></li><li><ul><li><ul><li><a href="#Metric_Larning_318" rel="nofollow">Metric Larning</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#3__332" rel="nofollow">3 æœ€å</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="0__4"></a>0 å‰è¨€</h2> 
<p>ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚</p> 
<p>ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p> 
<p>ğŸš© <strong>æ·±åº¦å­¦ä¹  æœºå™¨è§†è§‰ äººè„¸è¯†åˆ«ç³»ç»Ÿ</strong></p> 
<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p> 
<ul><li>éš¾åº¦ç³»æ•°ï¼š3åˆ†</li><li>å·¥ä½œé‡ï¼š3åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š3åˆ†</li></ul> 
<h2><a id="1__23"></a>1 æœºå™¨å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹</h2> 
<p>åŸºäºä¼ ç»Ÿå›¾åƒå¤„ç†å’Œæœºå™¨å­¦ä¹ æŠ€æœ¯çš„äººè„¸è¯†åˆ«æŠ€æœ¯ï¼Œå…¶ä¸­çš„æµç¨‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p> 
<p>æœºå™¨å­¦ä¹ -äººè„¸è¯†åˆ«ç³»ç»Ÿéƒ½åŒ…æ‹¬ï¼š</p> 
<ul><li>äººè„¸æ£€æµ‹</li><li>äººè„¸å¯¹å…¶</li><li>äººè„¸ç‰¹å¾å‘é‡åŒ–</li><li>äººè„¸è¯†åˆ«<br> <img src="https://images2.imgbox.com/c6/dc/HU4TVN2j_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li></ul> 
<h3><a id="_36"></a>äººè„¸æ£€æµ‹</h3> 
<p>äººè„¸æ£€æµ‹ç”¨äºç¡®å®šäººè„¸åœ¨å›¾åƒä¸­çš„å¤§å°å’Œä½ç½®ï¼Œå³è§£å†³â€œäººè„¸åœ¨å“ªé‡Œâ€çš„é—®é¢˜ï¼ŒæŠŠçœŸæ­£çš„äººè„¸åŒºåŸŸä»å›¾åƒä¸­è£å‰ªå‡ºæ¥ï¼Œä¾¿äºåç»­çš„äººè„¸ç‰¹å¾åˆ†æå’Œè¯†åˆ«ã€‚ä¸‹å›¾æ˜¯å¯¹ä¸€å¼ å›¾åƒçš„äººè„¸æ£€æµ‹ç»“æœï¼š</p> 
<p><img src="https://images2.imgbox.com/c1/55/2I6vhyyf_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_43"></a>äººè„¸å¯¹å…¶</h3> 
<p>åŒä¸€ä¸ªäººåœ¨ä¸åŒçš„å›¾åƒåºåˆ—ä¸­å¯èƒ½å‘ˆç°å‡ºä¸åŒçš„å§¿æ€å’Œè¡¨æƒ…ï¼Œè¿™ç§æƒ…å†µæ˜¯ä¸åˆ©äºäººè„¸è¯†åˆ«çš„ã€‚</p> 
<p>æ‰€ä»¥æœ‰å¿…è¦å°†äººè„¸å›¾åƒéƒ½å˜æ¢åˆ°ä¸€ä¸ªç»Ÿä¸€çš„è§’åº¦å’Œå§¿æ€ï¼Œè¿™å°±æ˜¯äººè„¸å¯¹é½ã€‚</p> 
<p>å®ƒçš„åŸç†æ˜¯æ‰¾åˆ°äººè„¸çš„è‹¥å¹²ä¸ªå…³é”®ç‚¹ï¼ˆåŸºå‡†ç‚¹ï¼Œå¦‚çœ¼è§’ï¼Œé¼»å°–ï¼Œå˜´è§’ç­‰ï¼‰ï¼Œç„¶ååˆ©ç”¨è¿™äº›å¯¹åº”çš„å…³é”®ç‚¹é€šè¿‡ç›¸ä¼¼å˜æ¢ï¼ˆSimilarity Transformï¼Œæ—‹è½¬ã€ç¼©æ”¾å’Œå¹³ç§»ï¼‰å°†äººè„¸å°½å¯èƒ½å˜æ¢åˆ°æ ‡å‡†äººè„¸ã€‚</p> 
<p>ä¸‹å›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„äººè„¸å›¾åƒå¯¹é½è¿‡ç¨‹ï¼š<br> <img src="https://images2.imgbox.com/43/1f/j9pw4zl0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> è¿™å¹…å›¾å°±æ›´åŠ ç›´è§‚äº†ï¼š<br> <img src="https://images2.imgbox.com/c6/be/RW1SBy9H_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_57"></a>äººè„¸ç‰¹å¾å‘é‡åŒ–</h3> 
<p>è¿™ä¸€æ­¥æ˜¯å°†å¯¹é½åçš„äººè„¸å›¾åƒï¼Œç»„æˆä¸€ä¸ªç‰¹å¾å‘é‡ï¼Œè¯¥ç‰¹å¾å‘é‡ç”¨äºæè¿°è¿™å¼ äººè„¸ã€‚</p> 
<p>ä½†ç”±äºï¼Œä¸€å¹…äººè„¸ç…§ç‰‡å¾€å¾€ç”±æ¯”è¾ƒå¤šçš„åƒç´ æ„æˆï¼Œå¦‚æœä»¥æ¯ä¸ªåƒç´ ä½œä¸º1ç»´ç‰¹å¾ï¼Œå°†å¾—åˆ°ä¸€ä¸ªç»´æ•°éå¸¸é«˜çš„ç‰¹å¾å‘é‡ï¼Œ è®¡ç®—å°†ååˆ†å›°éš¾ï¼›è€Œä¸”è¿™äº›åƒç´ ä¹‹é—´é€šå¸¸å…·æœ‰ç›¸å…³æ€§ã€‚</p> 
<p>æ‰€ä»¥æˆ‘ä»¬å¸¸å¸¸åˆ©ç”¨PCAæŠ€æœ¯å¯¹äººè„¸æè¿°å‘é‡è¿›è¡Œé™ç»´å¤„ç†ï¼Œä¿ç•™æ•°æ®é›†ä¸­å¯¹æ–¹å·®è´¡çŒ®æœ€å¤§çš„äººè„¸ç‰¹å¾æ¥è¾¾åˆ°ç®€åŒ–æ•°æ®é›†çš„ç›®çš„</p> 
<p>PCAäººè„¸ç‰¹å¾å‘é‡é™ç»´ç¤ºä¾‹ä»£ç ï¼š</p> 
<pre><code class="prism language-python"><span class="token comment">#coding:utf-8</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> numpy <span class="token keyword">import</span> linalg <span class="token keyword">as</span> la
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> os
 
<span class="token keyword">def</span> <span class="token function">loadImageSet</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">:</span>
    FaceMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token operator">*</span><span class="token number">116</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    j <span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'normal'</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>add<span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span> <span class="token string">'load %s failed'</span><span class="token operator">%</span>i
            FaceMat<span class="token punctuation">[</span>j<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> mat<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
            j <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> FaceMat
 
<span class="token keyword">def</span> <span class="token function">ReconginitionVector</span><span class="token punctuation">(</span>selecthr <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># step1: load the face image data ,get the matrix consists of all image</span>
    FaceMat <span class="token operator">=</span> loadImageSet<span class="token punctuation">(</span><span class="token string">'D:\python/face recongnition\YALE\YALE\unpadded/'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
    <span class="token comment"># step2: average the FaceMat</span>
    avgImg <span class="token operator">=</span> mean<span class="token punctuation">(</span>FaceMat<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment"># step3: calculate the difference of avgimg and all image data(FaceMat)</span>
    diffTrain <span class="token operator">=</span> FaceMat<span class="token operator">-</span>avgImg
    <span class="token comment">#step4: calculate eigenvector of covariance matrix (because covariance matrix will cause memory error)</span>
    eigvals<span class="token punctuation">,</span>eigVects <span class="token operator">=</span> linalg<span class="token punctuation">.</span>eig<span class="token punctuation">(</span>mat<span class="token punctuation">(</span>diffTrain<span class="token punctuation">.</span>T<span class="token operator">*</span>diffTrain<span class="token punctuation">)</span><span class="token punctuation">)</span>
    eigSortIndex <span class="token operator">=</span> argsort<span class="token punctuation">(</span><span class="token operator">-</span>eigvals<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>shape<span class="token punctuation">(</span>FaceMat<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>eigvals<span class="token punctuation">[</span>eigSortIndex<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">/</span>eigvals<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> selecthr<span class="token punctuation">:</span>
            eigSortIndex <span class="token operator">=</span> eigSortIndex<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span>
            <span class="token keyword">break</span>
    covVects <span class="token operator">=</span> diffTrain <span class="token operator">*</span> eigVects<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>eigSortIndex<span class="token punctuation">]</span> <span class="token comment"># covVects is the eigenvector of covariance matrix</span>
    <span class="token comment"># avgImg æ˜¯å‡å€¼å›¾åƒï¼ŒcovVectsæ˜¯åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼ŒdiffTrainæ˜¯åå·®çŸ©é˜µ</span>
    <span class="token keyword">return</span> avgImg<span class="token punctuation">,</span>covVects<span class="token punctuation">,</span>diffTrain
 
<span class="token keyword">def</span> <span class="token function">judgeFace</span><span class="token punctuation">(</span>judgeImg<span class="token punctuation">,</span>FaceVector<span class="token punctuation">,</span>avgImg<span class="token punctuation">,</span>diffTrain<span class="token punctuation">)</span><span class="token punctuation">:</span>
    diff <span class="token operator">=</span> judgeImg<span class="token punctuation">.</span>T <span class="token operator">-</span> avgImg
    weiVec <span class="token operator">=</span> FaceVector<span class="token punctuation">.</span>T<span class="token operator">*</span> diff
    res <span class="token operator">=</span> <span class="token number">0</span>
    resVal <span class="token operator">=</span> inf
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        TrainVec <span class="token operator">=</span> FaceVector<span class="token punctuation">.</span>T<span class="token operator">*</span>diffTrain<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span>
        <span class="token keyword">if</span>  <span class="token punctuation">(</span>array<span class="token punctuation">(</span>weiVec<span class="token operator">-</span>TrainVec<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> resVal<span class="token punctuation">:</span>
            res <span class="token operator">=</span>  i
            resVal <span class="token operator">=</span> <span class="token punctuation">(</span>array<span class="token punctuation">(</span>weiVec<span class="token operator">-</span>TrainVec<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res<span class="token operator">+</span><span class="token number">1</span>
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
 
    avgImg<span class="token punctuation">,</span>FaceVector<span class="token punctuation">,</span>diffTrain <span class="token operator">=</span> ReconginitionVector<span class="token punctuation">(</span>selecthr <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">)</span>
    nameList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'01'</span><span class="token punctuation">,</span><span class="token string">'02'</span><span class="token punctuation">,</span><span class="token string">'03'</span><span class="token punctuation">,</span><span class="token string">'04'</span><span class="token punctuation">,</span><span class="token string">'05'</span><span class="token punctuation">,</span><span class="token string">'06'</span><span class="token punctuation">,</span><span class="token string">'07'</span><span class="token punctuation">,</span><span class="token string">'08'</span><span class="token punctuation">,</span><span class="token string">'09'</span><span class="token punctuation">,</span><span class="token string">'10'</span><span class="token punctuation">,</span><span class="token string">'11'</span><span class="token punctuation">,</span><span class="token string">'12'</span><span class="token punctuation">,</span><span class="token string">'13'</span><span class="token punctuation">,</span><span class="token string">'14'</span><span class="token punctuation">,</span><span class="token string">'15'</span><span class="token punctuation">]</span>
    characteristic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'centerlight'</span><span class="token punctuation">,</span><span class="token string">'glasses'</span><span class="token punctuation">,</span><span class="token string">'happy'</span><span class="token punctuation">,</span><span class="token string">'leftlight'</span><span class="token punctuation">,</span><span class="token string">'noglasses'</span><span class="token punctuation">,</span><span class="token string">'rightlight'</span><span class="token punctuation">,</span><span class="token string">'sad'</span><span class="token punctuation">,</span><span class="token string">'sleepy'</span><span class="token punctuation">,</span><span class="token string">'surprised'</span><span class="token punctuation">,</span><span class="token string">'wink'</span><span class="token punctuation">]</span>
 
    <span class="token keyword">for</span> c <span class="token keyword">in</span> characteristic<span class="token punctuation">:</span>
 
        count <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>nameList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 
            <span class="token comment"># è¿™é‡Œçš„loadnameå°±æ˜¯æˆ‘ä»¬è¦è¯†åˆ«çš„æœªçŸ¥äººè„¸å›¾ï¼Œæˆ‘ä»¬é€šè¿‡15å¼ æœªçŸ¥äººè„¸æ‰¾å‡ºçš„å¯¹åº”è®­ç»ƒäººè„¸è¿›è¡Œå¯¹æ¯”æ¥æ±‚å‡ºæ­£ç¡®ç‡</span>
            loadname <span class="token operator">=</span> <span class="token string">'D:\python/face recongnition\YALE\YALE\unpadded\subject'</span><span class="token operator">+</span>nameList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'.'</span><span class="token operator">+</span>c<span class="token operator">+</span><span class="token string">'.pgm'</span>
            judgeImg <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>loadname<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> judgeFace<span class="token punctuation">(</span>mat<span class="token punctuation">(</span>judgeImg<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>FaceVector<span class="token punctuation">,</span>avgImg<span class="token punctuation">,</span>diffTrain<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>nameList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">print</span> <span class="token string">'accuracy of %s is %f'</span><span class="token operator">%</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">len</span><span class="token punctuation">(</span>nameList<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ±‚å‡ºæ­£ç¡®ç‡</span>
</code></pre> 
<h3><a id="_137"></a>äººè„¸è¯†åˆ«</h3> 
<p>è¿™ä¸€æ­¥çš„äººè„¸è¯†åˆ«ï¼Œå…¶å®æ˜¯å¯¹ä¸Šä¸€æ­¥äººè„¸å‘é‡è¿›è¡Œåˆ†ç±»ï¼Œä½¿ç”¨å„ç§åˆ†ç±»ç®—æ³•ã€‚</p> 
<p>æ¯”å¦‚ï¼šè´å¶æ–¯åˆ†ç±»å™¨ï¼Œå†³ç­–æ ‘ï¼ŒSVMç­‰æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚</p> 
<p>ä»è€Œè¾¾åˆ°è¯†åˆ«äººè„¸çš„ç›®çš„ã€‚</p> 
<p>è¿™é‡Œåˆ†äº«ä¸€ä¸ªsvmè®­ç»ƒçš„äººè„¸è¯†åˆ«æ¨¡å‹ï¼š</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function

<span class="token keyword">from</span> time <span class="token keyword">import</span> time
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cross_validation <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> fetch_lfw_people
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>grid_search <span class="token keyword">import</span> GridSearchCV
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> RandomizedPCA
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC


<span class="token keyword">print</span><span class="token punctuation">(</span>__doc__<span class="token punctuation">)</span>

<span class="token comment"># Display progress logs on stdout</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(message)s'</span><span class="token punctuation">)</span>


<span class="token comment">###############################################################################</span>
<span class="token comment"># Download the data, if not already on disk and load it as numpy arrays</span>

lfw_people <span class="token operator">=</span> fetch_lfw_people<span class="token punctuation">(</span>min_faces_per_person<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> resize<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span>

<span class="token comment"># introspect the images arrays to find the shapes (for plotting)</span>
n_samples<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w <span class="token operator">=</span> lfw_people<span class="token punctuation">.</span>images<span class="token punctuation">.</span>shape

<span class="token comment"># for machine learning we use the 2 data directly (as relative pixel</span>
<span class="token comment"># positions info is ignored by this model)</span>
X <span class="token operator">=</span> lfw_people<span class="token punctuation">.</span>data
n_features <span class="token operator">=</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment"># the label to predict is the id of the person</span>
y <span class="token operator">=</span> lfw_people<span class="token punctuation">.</span>target
target_names <span class="token operator">=</span> lfw_people<span class="token punctuation">.</span>target_names
n_classes <span class="token operator">=</span> target_names<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total dataset size:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n_samples: %d"</span> <span class="token operator">%</span> n_samples<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n_features: %d"</span> <span class="token operator">%</span> n_features<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n_classes: %d"</span> <span class="token operator">%</span> n_classes<span class="token punctuation">)</span>


<span class="token comment">###############################################################################</span>
<span class="token comment"># Split into a training set and a test set using a stratified k fold</span>

<span class="token comment"># split into a training and testing set</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>
    X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>


<span class="token comment">###############################################################################</span>
<span class="token comment"># Compute a PCA (eigenfaces) on the face dataset (treated as unlabeled</span>
<span class="token comment"># dataset): unsupervised feature extraction / dimensionality reduction</span>
n_components <span class="token operator">=</span> <span class="token number">80</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Extracting the top %d eigenfaces from %d faces"</span>
      <span class="token operator">%</span> <span class="token punctuation">(</span>n_components<span class="token punctuation">,</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
pca <span class="token operator">=</span> RandomizedPCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span>n_components<span class="token punctuation">,</span> whiten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in %0.3fs"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span>

eigenfaces <span class="token operator">=</span> pca<span class="token punctuation">.</span>components_<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>n_components<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Projecting the input data on the eigenfaces orthonormal basis"</span><span class="token punctuation">)</span>
t0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
X_train_pca <span class="token operator">=</span> pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test_pca <span class="token operator">=</span> pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in %0.3fs"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">###############################################################################</span>
<span class="token comment"># Train a SVM classification model</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Fitting the classifier to the training set"</span><span class="token punctuation">)</span>
t0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
param_grid <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">1e3</span><span class="token punctuation">,</span> <span class="token number">5e3</span><span class="token punctuation">,</span> <span class="token number">1e4</span><span class="token punctuation">,</span> <span class="token number">5e4</span><span class="token punctuation">,</span> <span class="token number">1e5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.0001</span><span class="token punctuation">,</span> <span class="token number">0.0005</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span>
clf <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> class_weight<span class="token operator">=</span><span class="token string">'balanced'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param_grid<span class="token punctuation">)</span>
clf <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_pca<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in %0.3fs"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Best estimator found by grid search:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_estimator_<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_estimator_<span class="token punctuation">.</span>n_support_<span class="token punctuation">)</span>
<span class="token comment">###############################################################################</span>
<span class="token comment"># Quantitative evaluation of the model quality on the test set</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Predicting people's names on the test set"</span><span class="token punctuation">)</span>
t0 <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test_pca<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in %0.3fs"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> target_names<span class="token operator">=</span>target_names<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token builtin">range</span><span class="token punctuation">(</span>n_classes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">###############################################################################</span>
<span class="token comment"># Qualitative evaluation of the predictions using matplotlib</span>

<span class="token keyword">def</span> <span class="token function">plot_gallery</span><span class="token punctuation">(</span>images<span class="token punctuation">,</span> titles<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> n_row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> n_col<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Helper function to plot a gallery of portraits"""</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.8</span> <span class="token operator">*</span> n_col<span class="token punctuation">,</span> <span class="token number">2.4</span> <span class="token operator">*</span> n_row<span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>bottom<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token number">.01</span><span class="token punctuation">,</span> right<span class="token operator">=</span><span class="token number">.99</span><span class="token punctuation">,</span> top<span class="token operator">=</span><span class="token number">.90</span><span class="token punctuation">,</span> hspace<span class="token operator">=</span><span class="token number">.35</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_row <span class="token operator">*</span> n_col<span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>n_row<span class="token punctuation">,</span> n_col<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment"># Show the feature face</span>
        plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>gray<span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>titles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># plot the result of the prediction on a portion of the test set</span>

<span class="token keyword">def</span> <span class="token function">title</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> target_names<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pred_name <span class="token operator">=</span> target_names<span class="token punctuation">[</span>y_pred<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    true_name <span class="token operator">=</span> target_names<span class="token punctuation">[</span>y_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token string">'predicted: %s\ntrue:      %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>pred_name<span class="token punctuation">,</span> true_name<span class="token punctuation">)</span>

prediction_titles <span class="token operator">=</span> <span class="token punctuation">[</span>title<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> target_names<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
                     <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

plot_gallery<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> prediction_titles<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span>

<span class="token comment"># plot the gallery of the most significative eigenfaces</span>

eigenface_titles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"eigenface %d"</span> <span class="token operator">%</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>eigenfaces<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
plot_gallery<span class="token punctuation">(</span>eigenfaces<span class="token punctuation">,</span> eigenface_titles<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/36/79/AGJbKjbe_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="2__287"></a>2 æ·±åº¦å­¦ä¹ -äººè„¸è¯†åˆ«è¿‡ç¨‹</h2> 
<p>ä¸åŒäºæœºå™¨å­¦ä¹ æ¨¡å‹çš„äººè„¸è¯†åˆ«ï¼Œæ·±åº¦å­¦ä¹ å°†äººè„¸ç‰¹å¾å‘é‡åŒ–ï¼Œä»¥åŠäººè„¸å‘é‡åˆ†ç±»ç»“åˆåˆ°äº†ä¸€èµ·ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œç®—æ³•ä¸€æ­¥åˆ°ä½ã€‚</p> 
<p>æ·±åº¦å­¦ä¹ -äººè„¸è¯†åˆ«ç³»ç»Ÿéƒ½åŒ…æ‹¬ï¼š</p> 
<ul><li>äººè„¸æ£€æµ‹</li><li>äººè„¸å¯¹å…¶</li><li>äººè„¸è¯†åˆ«</li></ul> 
<h3><a id="_298"></a>äººè„¸æ£€æµ‹</h3> 
<p>æ·±åº¦å­¦ä¹ åœ¨å›¾åƒåˆ†ç±»ä¸­çš„å·¨å¤§æˆåŠŸåå¾ˆå¿«è¢«ç”¨äºäººè„¸æ£€æµ‹çš„é—®é¢˜ï¼Œèµ·åˆè§£å†³è¯¥é—®é¢˜çš„æ€è·¯å¤§å¤šæ˜¯åŸºäºCNNç½‘ç»œçš„å°ºåº¦ä¸å˜æ€§ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œä¸åŒå°ºåº¦çš„ç¼©æ”¾ï¼Œç„¶åè¿›è¡Œæ¨ç†å¹¶ç›´æ¥å¯¹ç±»åˆ«å’Œä½ç½®ä¿¡æ¯è¿›è¡Œé¢„æµ‹ã€‚å¦å¤–ï¼Œç”±äºå¯¹feature mapä¸­çš„æ¯ä¸€ä¸ªç‚¹ç›´æ¥è¿›è¡Œä½ç½®å›å½’ï¼Œå¾—åˆ°çš„äººè„¸æ¡†ç²¾åº¦æ¯”è¾ƒä½ï¼Œå› æ­¤æœ‰äººæå‡ºäº†åŸºäºå¤šé˜¶æ®µåˆ†ç±»å™¨ç”±ç²—åˆ°ç»†çš„æ£€æµ‹ç­–ç•¥æ£€æµ‹äººè„¸ï¼Œä¾‹å¦‚ä¸»è¦æ–¹æ³•æœ‰Cascade CNNã€ DenseBoxå’ŒMTCNNç­‰ç­‰ã€‚</p> 
<p>MTCNNæ˜¯ä¸€ä¸ªå¤šä»»åŠ¡çš„æ–¹æ³•ï¼Œç¬¬ä¸€æ¬¡å°†äººè„¸åŒºåŸŸæ£€æµ‹å’Œäººè„¸å…³é”®ç‚¹æ£€æµ‹æ”¾åœ¨äº†ä¸€èµ·ï¼Œä¸Cascade CNNä¸€æ ·ä¹Ÿæ˜¯åŸºäºcascadeçš„æ¡†æ¶ï¼Œä½†æ˜¯æ•´ä½“æ€è·¯æ›´åŠ çš„å·§å¦™åˆç†ï¼ŒMTCNNæ€»ä½“æ¥è¯´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šPNetã€RNetå’ŒONetï¼Œç½‘ç»œç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p> 
<p><img src="https://images2.imgbox.com/43/b4/ShKLhCix_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="_310"></a>äººè„¸è¯†åˆ«</h3> 
<p>äººè„¸è¯†åˆ«é—®é¢˜æœ¬è´¨æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œå³æ¯ä¸€ä¸ªäººä½œä¸ºä¸€ç±»è¿›è¡Œåˆ†ç±»æ£€æµ‹ï¼Œä½†å®é™…åº”ç”¨è¿‡ç¨‹ä¸­ä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ã€‚ç¬¬ä¸€ï¼Œäººè„¸ç±»åˆ«å¾ˆå¤šï¼Œå¦‚æœè¦è¯†åˆ«ä¸€ä¸ªåŸé•‡çš„æ‰€æœ‰äººï¼Œé‚£ä¹ˆåˆ†ç±»ç±»åˆ«å°±å°†è¿‘åä¸‡ä»¥ä¸Šçš„ç±»åˆ«ï¼Œå¦å¤–æ¯ä¸€ä¸ªäººä¹‹é—´å¯è·å¾—çš„æ ‡æ³¨æ ·æœ¬å¾ˆå°‘ï¼Œä¼šå‡ºç°å¾ˆå¤šé•¿å°¾æ•°æ®ã€‚æ ¹æ®ä¸Šè¿°é—®é¢˜ï¼Œè¦å¯¹ä¼ ç»Ÿçš„CNNåˆ†ç±»ç½‘ç»œè¿›è¡Œä¿®æ”¹ã€‚</p> 
<p>æˆ‘ä»¬çŸ¥é“æ·±åº¦å·ç§¯ç½‘ç»œè™½ç„¶ä½œä¸ºä¸€ç§é»‘ç›’æ¨¡å‹ï¼Œä½†æ˜¯èƒ½å¤Ÿé€šè¿‡æ•°æ®è®­ç»ƒçš„æ–¹å¼å»è¡¨å¾å›¾ç‰‡æˆ–è€…ç‰©ä½“çš„ç‰¹å¾ã€‚å› æ­¤äººè„¸è¯†åˆ«ç®—æ³•å¯ä»¥é€šè¿‡å·ç§¯ç½‘ç»œæå–å‡ºå¤§é‡çš„äººè„¸ç‰¹å¾å‘é‡ï¼Œç„¶åæ ¹æ®ç›¸ä¼¼åº¦åˆ¤æ–­ä¸åº•åº“æ¯”è¾ƒå®Œæˆäººè„¸çš„è¯†åˆ«è¿‡ç¨‹ï¼Œå› æ­¤ç®—æ³•ç½‘ç»œèƒ½ä¸èƒ½å¯¹ä¸åŒçš„äººè„¸ç”Ÿæˆä¸åŒçš„ç‰¹å¾ï¼Œå¯¹åŒä¸€äººè„¸ç”Ÿæˆç›¸ä¼¼çš„ç‰¹å¾ï¼Œå°†æ˜¯è¿™ç±»embeddingä»»åŠ¡çš„é‡ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ€ä¹ˆæ ·èƒ½å¤Ÿæœ€å¤§åŒ–ç±»é—´è·ç¦»ä»¥åŠæœ€å°åŒ–ç±»å†…è·ç¦»ã€‚</p> 
<h5><a id="Metric_Larning_318"></a>Metric Larning</h5> 
<p>æ·±åº¦å­¦ä¹ ä¸­æœ€å…ˆåº”ç”¨metric learningæ€æƒ³ä¹‹ä¸€çš„ä¾¿æ˜¯DeepID2äº†ã€‚å…¶ä¸­DeepID2æœ€ä¸»è¦çš„æ”¹è¿›æ˜¯åŒä¸€ä¸ªç½‘ç»œåŒæ—¶è®­ç»ƒverificationå’Œclassificationï¼ˆæœ‰ä¸¤ä¸ªç›‘ç£ä¿¡å·ï¼‰ã€‚å…¶ä¸­åœ¨verification lossçš„ç‰¹å¾å±‚ä¸­å¼•å…¥äº†contrastive lossã€‚</p> 
<p>Contrastive lossä¸ä»…è€ƒè™‘äº†ç›¸åŒç±»åˆ«çš„è·ç¦»æœ€å°åŒ–ï¼Œä¹ŸåŒæ—¶è€ƒè™‘äº†ä¸åŒç±»åˆ«çš„è·ç¦»æœ€å¤§åŒ–ï¼Œé€šè¿‡å……åˆ†è¿ç”¨è®­ç»ƒæ ·æœ¬çš„labelä¿¡æ¯æå‡äººè„¸è¯†åˆ«çš„å‡†ç¡®æ€§ã€‚å› æ­¤ï¼Œè¯¥losså‡½æ•°æœ¬è´¨ä¸Šä½¿å¾—åŒä¸€ä¸ªäººçš„ç…§ç‰‡åœ¨ç‰¹å¾ç©ºé—´è·ç¦»è¶³å¤Ÿè¿‘ï¼Œä¸åŒäººåœ¨ç‰¹å¾ç©ºé—´é‡Œç›¸è·è¶³å¤Ÿè¿œç›´åˆ°è¶…è¿‡æŸä¸ªé˜ˆå€¼ã€‚(å¬èµ·æ¥å’Œtriplet lossæœ‰ç‚¹åƒ)ã€‚</p> 
<p><img src="https://images2.imgbox.com/3b/d6/FhkrWviK_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/9e/91/vu33mwax_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/91/38/K1SwyYla_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="3__332"></a>3 æœ€å</h2> 
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼š</strong> <a href="https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md" rel="nofollow">https://gitee.com/yaa-dc/warehouse-1/blob/master/python/README.md</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/20b7c17f65ab06f43475ab7f73a89eab/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">å¤§å…¬å¸å¦‚ä½•åš APPï¼šèƒŒåçš„å¼€å‘æµç¨‹å’ŒæŠ€æœ¯</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fa05227db366d042192540bfdd24d6ac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ç½‘ç»œå·¥ç¨‹java&#43;ssm&#43;vueé¡¹ç›® - åŸºäºSSMçš„è¯æºè¯å“å•†åŸä¿å¥å“è´­ç‰©ç½‘ç«™(å«æºç &#43;è®ºæ–‡)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>