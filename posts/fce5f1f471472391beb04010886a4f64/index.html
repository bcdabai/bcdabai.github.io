<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43; ifstream open 读取txt/json文件出现中文乱码的解决问题 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43; ifstream open 读取txt/json文件出现中文乱码的解决问题" />
<meta property="og:description" content="C&#43;&#43; ifstream open 读取txt/json文件出现中文乱码的解决方法 作者：虚坏叔叔
博客：https://xuhss.com
早餐店不会开到晚上，想吃的人早就来了！😄
在编程中，我们经常需要对txt/json文件进行读写操作，有时候由于编解码问题，txt读写会出现乱码问题。下面介绍一种基于ofstream和ifstream的txt文件读写方法，并介绍txt文件读写的乱码解决方案。
一、txt文件写入 #include &lt;fstream&gt; #include &lt;iostream&gt; using namespace std; int main() { ofstream outfile(&#34;1.txt&#34;,ios::ate); //打开文件，设置写入方式为覆盖写入 if(!outfile) { cout&lt;&lt;&#34;txt文件打开失败!&#34;&lt;&lt;endl; exit(0); } outfile&lt;&lt;&#34;写入txt文件示例.\n&#34;; outfile&lt;&lt;&#34;成功写入.\n&#34;; outfile.close(); } txt里面的写入内容如下：
成功写入。
二、txt文件读出 对上面读入内容的txt进行读出操作，代码如下：
#include &lt;fstream&gt; #include &lt;iostream&gt; using namespace std; int main() { char txt[100]; ifstream infile; infile.open(&#34;1.txt&#34;); if(!infile.is_open()) { cout&lt;&lt;&#34;txt文件打开失败&#34;&lt;&lt;endl; exit(0); } while(!infile.eof()) { infile.getline(txt,100); cout&lt;&lt;txt&lt;&lt;endl; } infile.close(); getchar(); } 读出结果为：
读出结果正确。
三、 txt读写乱码问题 有时候由于txt文件编码问题的不同，会导致读写的时候出现乱码，通常的txt编码方式有：
上面默认的编码方式为ANSI，如果我们现在将它另存为1.txt，但编码格式变为UTF-8，那么读出结果会变成：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fce5f1f471472391beb04010886a4f64/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-09T18:56:58+08:00" />
<meta property="article:modified_time" content="2022-05-09T18:56:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43; ifstream open 读取txt/json文件出现中文乱码的解决问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="C_ifstream_open_txtjson_0"></a>C++ ifstream open 读取txt/json文件出现中文乱码的解决方法</h2> 
<p>作者：虚坏叔叔<br> 博客：<a href="https://xuhss.com/" rel="nofollow">https://xuhss.com</a></p> 
<blockquote> 
 <p>早餐店不会开到晚上，想吃的人早就来了！😄</p> 
</blockquote> 
<p>在编程中，我们经常需要对txt/json文件进行读写操作，有时候由于编<a href="https://so.csdn.net/so/search?q=%E8%A7%A3%E7%A0%81&amp;spm=1001.2101.3001.7020">解码</a>问题，txt读写会出现乱码问题。下面介绍一种基于<code>ofstream</code>和<code>ifstream</code>的txt文件读写方法，并介绍<code>txt</code>文件读写的乱码解决方案。</p> 
<h3><a id="txt_9"></a>一、txt文件写入</h3> 
<pre><code>#include &lt;fstream&gt;
#include &lt;iostream&gt;
using namespace std;

int main()
{   
    ofstream outfile("1.txt",ios::ate);   //打开文件，设置写入方式为覆盖写入

    if(!outfile)
    {
        cout&lt;&lt;"txt文件打开失败!"&lt;&lt;endl;
        exit(0);
    }

    outfile&lt;&lt;"写入txt文件示例.\n";
    outfile&lt;&lt;"成功写入.\n";

    outfile.close();
}
</code></pre> 
<p><code>txt</code>里面的写入内容如下：</p> 
<p><img src="https://images2.imgbox.com/83/2c/JYQ9nm8G_o.jpg" alt="这里写图片描述"></p> 
<p>成功写入。</p> 
<h3><a id="txt_39"></a>二、txt文件读出</h3> 
<p>对上面读入内容的<code>txt</code>进行读出操作，代码如下：</p> 
<pre><code>#include &lt;fstream&gt;
#include &lt;iostream&gt;
using namespace std;

int main()
{   
    char txt[100];
    ifstream infile;
    infile.open("1.txt");

    if(!infile.is_open())
    {
        cout&lt;&lt;"txt文件打开失败"&lt;&lt;endl;
        exit(0);
    }

    while(!infile.eof())
    {       
        infile.getline(txt,100);
        cout&lt;&lt;txt&lt;&lt;endl;
    }

    infile.close();
    getchar();
}
</code></pre> 
<p>读出结果为：</p> 
<p><img src="https://images2.imgbox.com/cb/6d/gh62gNxS_o.jpg" alt="这里写图片描述"></p> 
<p>读出结果正确。</p> 
<h3><a id="_txthttpssocsdnnetsosearchqspm1001210130017020_77"></a>三、 txt读写<a href="https://so.csdn.net/so/search?q=%E4%B9%B1%E7%A0%81&amp;spm=1001.2101.3001.7020">乱码</a>问题</h3> 
<p>有时候由于txt文件编码问题的不同，会导致读写的时候出现乱码，通常的<code>txt</code>编码方式有：</p> 
<p><img src="https://images2.imgbox.com/51/d9/gxsCCTC0_o.jpg" alt="这里写图片描述"></p> 
<p>上面默认的编码方式为<code>ANSI</code>，如果我们现在将它另存为<code>1.txt</code>，但编码格式变为<code>UTF-8</code>，那么读出结果会变成：</p> 
<p><img src="https://images2.imgbox.com/77/ed/qpy7HRdV_o.jpg" alt="这里写图片描述"></p> 
<p>发现结果完全错误，这时候我们需要编解码转换，具体代码如下：</p> 
<pre><code>#include &lt;fstream&gt;
#include &lt;iostream&gt;
#include &lt;Windows.h&gt;
#include &lt;string&gt;
using namespace std;

string UTF8ToGB(const char* str)
{
     string result;
     WCHAR *strSrc;
     LPSTR szRes;

     //获得临时变量的大小
     int i = MultiByteToWideChar(CP_UTF8, 0, str, -1, NULL, 0);
     strSrc = new WCHAR[i+1];
     MultiByteToWideChar(CP_UTF8, 0, str, -1, strSrc, i);

     //获得临时变量的大小
     i = WideCharToMultiByte(CP_ACP, 0, strSrc, -1, NULL, 0, NULL, NULL);
     szRes = new CHAR[i+1];
     WideCharToMultiByte(CP_ACP, 0, strSrc, -1, szRes, i, NULL, NULL);

     result = szRes;
     delete []strSrc;
     delete []szRes;

     return result;
}

std::string readFile(std::string file)
{
	std::ifstream infile;
	infile.open(file.data());   //将文件流对象与文件连接起来 
	assert(infile.is_open());   //若失败,则输出错误消息,并终止程序运行 

	string s; string strAllLine;
	while (getline(infile, s)){
		string line = UTF8ToGB(s.c_str()).c_str();
		strAllLine += line;
	}


	infile.close();             //关闭文件输入流 
	return strAllLine;
	
}

int main()
{   
    string msg =readFile(2.txt)
    getchar();
}
</code></pre> 
<h3><a id="_144"></a>四、总结</h3> 
<ul><li>本文主要介绍读取中文文件乱码的问题。</li><li>如果觉得文章对你有用处，记得 <code>点赞</code> <code>收藏</code> <code>转发</code> 一波哦~</li></ul> 
<h3><a id="__149"></a>💬 往期优质文章分享</h3> 
<ul><li><a href="https://blog.csdn.net/biggbang/article/details/124215339">C++ QT结合FFmpeg实战开发视频播放器-01环境的安装和项目部署</a></li><li><a href="https://blog.csdn.net/biggbang/article/details/124226156">解决QT问题：运行qmake：Project ERROR: Cannot run compiler ‘cl‘. Output:</a></li><li><a href="https://blog.csdn.net/biggbang/article/details/124222839">解决安装QT后MSVC2015 64bit配置无编译器和调试器问题</a></li><li><a href="https://blog.csdn.net/biggbang/article/details/124213810">Qt中的套件提示no complier set in kit和no debugger，出现黄色感叹号问题解决（MSVC2017）</a></li><li><a href="https://blog.csdn.net/huangbangqing12/article/details/123939242">Python+selenium 自动化 - 实现自动导入、上传外部文件（不弹出windows窗口）</a></li></ul> 
<h3><a id="___157"></a>🚀 优质教程分享 🚀</h3> 
<ul><li>🎄如果感觉文章看完了不过瘾，可以来我的其他 专栏 看一下哦~</li><li>🎄比如以下几个专栏：Python实战微信订餐小程序、Python量化交易实战、C++ QT实战类项目 和 算法学习专栏</li><li>🎄可以学习更多的关于C++/Python的相关内容哦！直接点击下面颜色字体就可以跳转啦！</li></ul> 
<table><thead><tr><th>学习路线指引（点击解锁）</th><th>知识定位</th><th>人群定位</th></tr></thead><tbody><tr><td><a href="https://edu.csdn.net/course/detail/36074">🧡 Python实战微信订餐小程序 🧡</a></td><td>进阶级</td><td>本课程是python flask+微信小程序的完美结合，从项目搭建到腾讯云部署上线，打造一个全栈订餐系统。</td></tr><tr><td>💛<a href="https://download.csdn.net/course/detail/35475">Python量化交易实战</a> 💛</td><td>入门级</td><td>手把手带你打造一个易扩展、更安全、效率更高的<a href="https://so.csdn.net/so/search?q=%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93&amp;spm=1001.2101.3001.7020">量化交易</a>系统</td></tr><tr><td>❤️ <a href="https://blog.csdn.net/biggbang/category_11761704.html">C++ QT结合FFmpeg实战开发视频播放器</a>❤️</td><td>难度偏高</td><td>分享学习QT成品的视频播放器源码，需要有扎实的C++知识！</td></tr><tr><td>💚 游戏爱好者九万人社区💚</td><td>互助/吹水</td><td>九万人游戏爱好者社区，聊天互助，白嫖奖品</td></tr><tr><td>💙 Python零基础到入门 💙</td><td>Python初学者</td><td>针对没有经过系统学习的小伙伴，核心目的就是让我们能够快速学习Python的知识以达到入门</td></tr></tbody></table> 
<h3><a id="___171"></a>🚀 资料白嫖，<strong>温馨提示</strong> 🚀</h3> 
<p>关注下面卡片即刻获取更多编程知识，包括各种语言学习资料，上千套PPT模板和各种游戏源码素材等等资料。更多内容可自行查看哦！</p> 
<p><img src="https://images2.imgbox.com/4d/b9/5TyUl48K_o.gif" alt="请添加图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3622085cecb12cc19d329d68d52e6056/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Echarts官方实例地图不显示</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4b1b02565b6808cb4f375bcc8724f178/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">优麒麟系统中QtCreator无法输入中文</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>